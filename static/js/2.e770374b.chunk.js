/*! For license information please see 2.e770374b.chunk.js.LICENSE.txt */
(this["webpackJsonpmapbox-react2"]=this["webpackJsonpmapbox-react2"]||[]).push([[2],[function(t,e,n){"use strict";t.exports=n(38)},function(t,e,n){"use strict";n.r(e),function(t){function r(t){return null==t||""===t?null:t}function o(t,e){return void 0===e&&(e=!1),null!=t&&(""!==t||e)}function i(t){return!o(t)}function s(t){return null==t||0===t.length}function a(t){return null!=t&&"function"===typeof t.toString?t.toString():null}function l(t){if(void 0!==t){if(null===t||""===t)return null;if("number"===typeof t)return isNaN(t)?void 0:t;var e=parseInt(t,10);return isNaN(e)?void 0:e}}function u(t){if(void 0!==t)return null!==t&&""!==t&&("boolean"===typeof t?t:/true/i.test(t))}function c(t){if(t instanceof Set||t instanceof Map){var e=[];return t.forEach((function(t){return e.push(t)})),e}return Object.values(t)}n.d(e,"AbstractHeaderCellCtrl",(function(){return Vc})),n.d(e,"AgAbstractField",(function(){return Ko})),n.d(e,"AgAbstractLabel",(function(){return qo})),n.d(e,"AgAutocomplete",(function(){return Zd})),n.d(e,"AgCheckbox",(function(){return li})),n.d(e,"AgDialog",(function(){return Ld})),n.d(e,"AgGroupComponent",(function(){return yd})),n.d(e,"AgInputDateField",(function(){return Yh})),n.d(e,"AgInputNumberField",(function(){return Li})),n.d(e,"AgInputRange",(function(){return Qh})),n.d(e,"AgInputTextArea",(function(){return Xh})),n.d(e,"AgInputTextField",(function(){return Di})),n.d(e,"AgMenuItemComponent",(function(){return Rd})),n.d(e,"AgMenuList",(function(){return Cd})),n.d(e,"AgMenuPanel",(function(){return Ed})),n.d(e,"AgPanel",(function(){return Id})),n.d(e,"AgPickerField",(function(){return Qo})),n.d(e,"AgPromise",(function(){return fo})),n.d(e,"AgPromiseStatus",(function(){return so})),n.d(e,"AgRadioButton",(function(){return ci})),n.d(e,"AgRichSelect",(function(){return pd})),n.d(e,"AgSelect",(function(){return ri})),n.d(e,"AgSlider",(function(){return fd})),n.d(e,"AgStackComponentsRegistry",(function(){return Ue})),n.d(e,"AgToggleButton",(function(){return Wh})),n.d(e,"AlignedGridsService",(function(){return uf})),n.d(e,"AllCommunityModules",(function(){return sv})),n.d(e,"AnimateShowChangeCellRenderer",(function(){return Rs})),n.d(e,"AnimateSlideCellRenderer",(function(){return Is})),n.d(e,"AnimationFrameService",(function(){return ah})),n.d(e,"AutoScrollService",(function(){return Tl})),n.d(e,"AutoWidthCalculator",(function(){return ch})),n.d(e,"Autowired",(function(){return $})),n.d(e,"BarColumnLabelPlacement",(function(){return Tm})),n.d(e,"BaseComponentWrapper",(function(){return Zm})),n.d(e,"BaseCreator",(function(){return Uy})),n.d(e,"BaseGridSerializingSession",(function(){return Wy})),n.d(e,"Bean",(function(){return J})),n.d(e,"BeanStub",(function(){return jt})),n.d(e,"Beans",(function(){return Xl})),n.d(e,"BodyDropPivotTarget",(function(){return yc})),n.d(e,"BodyDropTarget",(function(){return xc})),n.d(e,"CHART_TOOLBAR_ALLOW_LIST",(function(){return $m})),n.d(e,"CHART_TOOL_PANEL_ALLOW_LIST",(function(){return Jm})),n.d(e,"CHART_TOOL_PANEL_MENU_OPTIONS",(function(){return ty})),n.d(e,"CellComp",(function(){return lc})),n.d(e,"CellCtrl",(function(){return ou})),n.d(e,"CellNavigationService",(function(){return of})),n.d(e,"CellPositionUtils",(function(){return Ng})),n.d(e,"CellRangeType",(function(){return Fl})),n.d(e,"ChangedPath",(function(){return Ah})),n.d(e,"CheckboxCellEditor",(function(){return Sa})),n.d(e,"CheckboxCellRenderer",(function(){return ba})),n.d(e,"CheckboxSelectionComponent",(function(){return Fs})),n.d(e,"ClientSideRowModelModule",(function(){return Dy})),n.d(e,"ClientSideRowModelSteps",(function(){return $a})),n.d(e,"ColDefUtil",(function(){return ue})),n.d(e,"Column",(function(){return ht})),n.d(e,"ColumnApi",(function(){return mf})),n.d(e,"ColumnFactory",(function(){return qt})),n.d(e,"ColumnGroup",(function(){return Kt})),n.d(e,"ColumnKeyCreator",(function(){return h})),n.d(e,"ColumnModel",(function(){return Ne})),n.d(e,"ColumnUtils",(function(){return Ge})),n.d(e,"Component",(function(){return Eo})),n.d(e,"ComponentUtil",(function(){return me})),n.d(e,"Context",(function(){return K})),n.d(e,"CssClassApplier",(function(){return Tc})),n.d(e,"CssClassManager",(function(){return wo})),n.d(e,"CsvCreator",(function(){return Qy})),n.d(e,"CsvExportModule",(function(){return ev})),n.d(e,"CtrlsService",(function(){return om})),n.d(e,"CustomTooltipFeature",(function(){return _o})),n.d(e,"DEFAULT_CHART_GROUPS",(function(){return Qm})),n.d(e,"DataTypeService",(function(){return zm})),n.d(e,"DateCellEditor",(function(){return ga})),n.d(e,"DateFilter",(function(){return bi})),n.d(e,"DateStringCellEditor",(function(){return _a})),n.d(e,"DisplayedGroupCreator",(function(){return ze})),n.d(e,"Downloader",(function(){return qy})),n.d(e,"DragAndDropService",(function(){return zs})),n.d(e,"DragService",(function(){return nl})),n.d(e,"DragSourceType",(function(){return Gi})),n.d(e,"Environment",(function(){return mg})),n.d(e,"EventService",(function(){return st})),n.d(e,"Events",(function(){return Yt})),n.d(e,"ExcelFactoryMode",(function(){return Vs})),n.d(e,"ExpressionService",(function(){return xf})),n.d(e,"FilterManager",(function(){return cl})),n.d(e,"FloatingFilterMapper",(function(){return Ka})),n.d(e,"FocusService",(function(){return pp})),n.d(e,"GROUP_AUTO_COLUMN_ID",(function(){return $t})),n.d(e,"Grid",(function(){return Xm})),n.d(e,"GridApi",(function(){return sl})),n.d(e,"GridBodyComp",(function(){return Xu})),n.d(e,"GridBodyCtrl",(function(){return kl})),n.d(e,"GridComp",(function(){return kf})),n.d(e,"GridCoreCreator",(function(){return Ym})),n.d(e,"GridCtrl",(function(){return Lf})),n.d(e,"GridHeaderComp",(function(){return Up})),n.d(e,"GridHeaderCtrl",(function(){return zp})),n.d(e,"GridOptionsService",(function(){return Rm})),n.d(e,"GridSerializer",(function(){return tv})),n.d(e,"GroupCellRenderer",(function(){return ta})),n.d(e,"GroupCellRendererCtrl",(function(){return Qs})),n.d(e,"GroupInstanceIdCreator",(function(){return Zt})),n.d(e,"HeaderCellCtrl",(function(){return fp})),n.d(e,"HeaderFilterCellComp",(function(){return gl})),n.d(e,"HeaderFilterCellCtrl",(function(){return Yc})),n.d(e,"HeaderGroupCellCtrl",(function(){return xp})),n.d(e,"HeaderNavigationDirection",(function(){return op})),n.d(e,"HeaderNavigationService",(function(){return Gp})),n.d(e,"HeaderPositionUtils",(function(){return Kg})),n.d(e,"HeaderRowComp",(function(){return Fc})),n.d(e,"HeaderRowContainerComp",(function(){return Np})),n.d(e,"HeaderRowContainerCtrl",(function(){return Dp})),n.d(e,"HeaderRowCtrl",(function(){return Rp})),n.d(e,"HeaderRowType",(function(){return fc})),n.d(e,"HorizontalDirection",(function(){return Vi})),n.d(e,"HorizontalResizeService",(function(){return Xp})),n.d(e,"InfiniteRowModelModule",(function(){return Hy})),n.d(e,"KeyCode",(function(){return Yr})),n.d(e,"LargeTextCellEditor",(function(){return gs})),n.d(e,"LayoutCssClasses",(function(){return il})),n.d(e,"LocaleService",(function(){return Im})),n.d(e,"Logger",(function(){return Af})),n.d(e,"LoggerFactory",(function(){return If})),n.d(e,"ManagedFocusFeature",(function(){return ko})),n.d(e,"ModuleNames",(function(){return z})),n.d(e,"ModuleRegistry",(function(){return W})),n.d(e,"MouseEventService",(function(){return $u})),n.d(e,"MoveColumnFeature",(function(){return wc})),n.d(e,"NavigationService",(function(){return rc})),n.d(e,"NumberCellEditor",(function(){return ha})),n.d(e,"NumberFilter",(function(){return zi})),n.d(e,"NumberSequence",(function(){return co})),n.d(e,"Optional",(function(){return tt})),n.d(e,"PaginationProxy",(function(){return Vh})),n.d(e,"PinnedRowModel",(function(){return Oh})),n.d(e,"PopupComponent",(function(){return hs})),n.d(e,"PopupEditorWrapper",(function(){return sc})),n.d(e,"PopupService",(function(){return jd})),n.d(e,"PositionableFeature",(function(){return Vo})),n.d(e,"PostConstruct",(function(){return Z})),n.d(e,"PreConstruct",(function(){return Y})),n.d(e,"PreDestroy",(function(){return Q})),n.d(e,"PropertyKeys",(function(){return he})),n.d(e,"ProvidedColumnGroup",(function(){return ft})),n.d(e,"ProvidedFilter",(function(){return Ho})),n.d(e,"Qualifier",(function(){return nt})),n.d(e,"QuerySelector",(function(){return So})),n.d(e,"RefSelector",(function(){return To})),n.d(e,"ResizeObserverService",(function(){return oh})),n.d(e,"RowAnimationCssClasses",(function(){return El})),n.d(e,"RowContainerComp",(function(){return gc})),n.d(e,"RowContainerCtrl",(function(){return Hu})),n.d(e,"RowContainerName",(function(){return uu})),n.d(e,"RowContainerType",(function(){return cu})),n.d(e,"RowCtrl",(function(){return hu})),n.d(e,"RowHighlightPosition",(function(){return Ja})),n.d(e,"RowNode",(function(){return Ds})),n.d(e,"RowNodeBlock",(function(){return Mh})),n.d(e,"RowNodeBlockLoader",(function(){return kh})),n.d(e,"RowNodeSorter",(function(){return em})),n.d(e,"RowPositionUtils",(function(){return Dg})),n.d(e,"RowRenderer",(function(){return bh})),n.d(e,"RowType",(function(){return py})),n.d(e,"ScalarFilter",(function(){return yi})),n.d(e,"ScrollVisibleService",(function(){return Zu})),n.d(e,"SelectCellEditor",(function(){return vs})),n.d(e,"SelectableService",(function(){return xg})),n.d(e,"SelectionHandleType",(function(){return Nl})),n.d(e,"ServerSideTransactionResultStatus",(function(){return eh})),n.d(e,"SetLeftFeature",(function(){return Hc})),n.d(e,"SimpleFilter",(function(){return gi})),n.d(e,"SortController",(function(){return jf})),n.d(e,"SortIndicatorComp",(function(){return os})),n.d(e,"StandardMenuFactory",(function(){return Zp})),n.d(e,"StylingService",(function(){return Hh})),n.d(e,"TabGuardClassNames",(function(){return Nc})),n.d(e,"TabGuardComp",(function(){return od})),n.d(e,"TabGuardCtrl",(function(){return ip})),n.d(e,"TabbedLayout",(function(){return $p})),n.d(e,"TemplateService",(function(){return Tf})),n.d(e,"TextCellEditor",(function(){return Es})),n.d(e,"TextFilter",(function(){return Wi})),n.d(e,"TextFloatingFilter",(function(){return ts})),n.d(e,"Timer",(function(){return go})),n.d(e,"TouchListener",(function(){return es})),n.d(e,"UserComponentFactory",(function(){return Qa})),n.d(e,"UserComponentRegistry",(function(){return Ia})),n.d(e,"ValueCache",(function(){return tg})),n.d(e,"ValueFormatterService",(function(){return Th})),n.d(e,"ValueParserService",(function(){return Um})),n.d(e,"ValueService",(function(){return _f})),n.d(e,"VanillaFrameworkOverrides",(function(){return $d})),n.d(e,"VerticalDirection",(function(){return Bi})),n.d(e,"VirtualList",(function(){return ad})),n.d(e,"XmlFactory",(function(){return nv})),n.d(e,"ZipContainer",(function(){return iv})),n.d(e,"_",(function(){return uo})),n.d(e,"__FORCE_MODULE_DETECTION",(function(){return ey})),n.d(e,"getRowContainerTypeForName",(function(){return Bu})),n.d(e,"simpleHttpRequest",(function(){return th}));var p=Object.freeze({__proto__:null,makeNull:r,exists:o,missing:i,missingOrEmpty:s,toStringOrNull:a,attrToNumber:l,attrToBoolean:u,attrToString:function(t){if(null!=t&&""!==t)return t},referenceCompare:function(t,e){return null==t&&null==e||(null!=t||null==e)&&((null==t||null!=e)&&t===e)},jsonEquals:function(t,e){return(t?JSON.stringify(t):null)===(e?JSON.stringify(e):null)},defaultComparator:function(t,e,n){void 0===n&&(n=!1);var r=null==t,o=null==e;if(t&&t.toNumber&&(t=t.toNumber()),e&&e.toNumber&&(e=e.toNumber()),r&&o)return 0;if(r)return-1;if(o)return 1;function i(t,e){return t>e?1:t<e?-1:0}if("string"!==typeof t)return i(t,e);if(!n)return i(t,e);try{return t.localeCompare(e)}catch(s){return i(t,e)}},values:c}),h=function(){function t(){this.existingKeys={}}return t.prototype.addExistingKeys=function(t){for(var e=0;e<t.length;e++)this.existingKeys[t[e]]=!0},t.prototype.getUniqueKey=function(t,e){t=a(t);for(var n=0;;){var r=void 0;if(t?(r=t,0!==n&&(r+="_"+n)):e?(r=e,0!==n&&(r+="_"+n)):r=n,!this.existingKeys[r])return this.existingKeys[r]=!0,String(r);n++}},t}(),d=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function g(t,e){var n,r;if(null!=t)if(Array.isArray(t))for(var o=0;o<t.length;o++)e(o.toString(),t[o]);else try{for(var i=d(Object.entries(t)),s=i.next();!s.done;s=i.next()){var a=f(s.value,2);e(a[0],a[1])}}catch(l){n={error:l}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function m(t){for(var e={},n=Object.keys(t),r=0;r<n.length;r++){var o=n[r],i=t[o];e[o]=i}return e}function y(t,e){if(t){var n=t,r={};return Object.keys(n).forEach((function(t){if(!(e&&e.indexOf(t)>=0)){var o=n[t],i=T(o)&&o.constructor===Object;r[t]=i?y(o):o}})),r}}function v(t,e){return t[e]}function _(t,e,n){t[e]=n}function w(t,e,n,r){var o=v(t,n);void 0!==o&&_(e,n,r?r(o):o)}function C(t){var e={};return t.filter((function(t){return null!=t})).forEach((function(t){Object.keys(t).forEach((function(t){return e[t]=null}))})),Object.keys(e)}function b(t){if(!t)return[];var e=Object;if("function"===typeof e.values)return e.values(t);var n=[];for(var r in t)t.hasOwnProperty(r)&&t.propertyIsEnumerable(r)&&n.push(t[r]);return n}function x(t,e,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1),o(e)&&g(e,(function(e,o){var i=t[e];if(i!==o){if(r)if(null==i&&null!=o)"object"===typeof o&&o.constructor===Object&&(i={},t[e]=i);T(o)&&T(i)&&!Array.isArray(i)?x(i,o,n,r):(n||void 0!==o)&&(t[e]=o)}}))}function E(t,e,n){if(e&&t){if(!n)return t[e];for(var r=e.split("."),o=t,i=0;i<r.length;i++){if(null==o)return;o=o[r[i]]}return o}}function S(t,e){Object.keys(t).forEach((function(e){"object"===typeof t[e]&&(t[e]=void 0)}));var n=Object.getPrototypeOf(t),r={};Object.keys(n).forEach((function(t){if("function"===typeof n[t]){r[t]={value:function(){console.warn("AG Grid: "+e+" function "+t+"() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.")},writable:!0}}})),Object.defineProperties(t,r)}function T(t){return"object"===typeof t&&null!==t}var R=Object.freeze({__proto__:null,iterateObject:g,cloneObject:m,deepCloneObject:function(t){return JSON.parse(JSON.stringify(t))},deepCloneDefinition:y,getProperty:v,setProperty:_,copyPropertiesIfPresent:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];n.forEach((function(n){return w(t,e,n)}))},copyPropertyIfPresent:w,getAllKeysInObjects:C,getAllValuesInObject:b,mergeDeep:x,missingOrEmptyObject:function(t){return i(t)||0===Object.keys(t).length},get:function(t,e,n){if(null==t)return n;for(var r=e.split("."),o=t;r.length>1;)if(null==(o=o[r.shift()]))return n;var i=o[r[0]];return null!=i?i:n},set:function(t,e,n){if(null!=t){var r=e.split("."),o=t;r.forEach((function(t,e){o[t]||(o[t]={}),e<r.length-1&&(o=o[t])})),o[r[r.length-1]]=n}},getValueUsingField:E,removeAllReferences:S,isNonNullObject:T}),P={};function O(t,e){P[e]||(t(),P[e]=!0)}function I(t){if(t.name)return t.name;var e=/function\s+([^\(]+)/.exec(t.toString());return e&&2===e.length?e[1].trim():null}function A(t){return!!(t&&t.constructor&&t.call&&t.apply)}function D(t){F(t,400)}var M=[],L=!1;function N(t){M.push(t),L||(L=!0,window.setTimeout((function(){var t=M.slice();M.length=0,L=!1,t.forEach((function(t){return t()}))}),0))}function F(t,e){void 0===e&&(e=0),t.length>0&&window.setTimeout((function(){return t.forEach((function(t){return t()}))}),e)}function k(t,e){var n;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=this;window.clearTimeout(n),n=window.setTimeout((function(){t.apply(i,r)}),e)}}function G(t,e){var n=0;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=this,s=(new Date).getTime();s-n<e||(n=s,t.apply(i,r))}}function B(t,e,n,r){void 0===n&&(n=100);var o=(new Date).getTime(),i=null,s=!1,a=function(){var a=(new Date).getTime()-o>n;(t()||a)&&(e(),s=!0,null!=i&&(window.clearInterval(i),i=null),a&&r&&console.warn(r))};a(),s||(i=window.setInterval(a,10))}function V(t){t&&t()}var z,j=Object.freeze({__proto__:null,doOnce:O,getFunctionName:I,isFunction:A,executeInAWhile:D,executeNextVMTurn:N,executeAfter:F,debounce:k,throttle:G,waitUntil:B,compose:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return t.reduce((function(t,e){return e(t)}),e)}},callIfPresent:V,noop:function(){}});!function(t){t.CommunityCoreModule="@ag-grid-community/core",t.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",t.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",t.CsvExportModule="@ag-grid-community/csv-export",t.EnterpriseCoreModule="@ag-grid-enterprise/core",t.RowGroupingModule="@ag-grid-enterprise/row-grouping",t.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",t.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",t.MenuModule="@ag-grid-enterprise/menu",t.SetFilterModule="@ag-grid-enterprise/set-filter",t.MultiFilterModule="@ag-grid-enterprise/multi-filter",t.StatusBarModule="@ag-grid-enterprise/status-bar",t.SideBarModule="@ag-grid-enterprise/side-bar",t.RangeSelectionModule="@ag-grid-enterprise/range-selection",t.MasterDetailModule="@ag-grid-enterprise/master-detail",t.RichSelectModule="@ag-grid-enterprise/rich-select",t.GridChartsModule="@ag-grid-enterprise/charts",t.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",t.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",t.ExcelExportModule="@ag-grid-enterprise/excel-export",t.ClipboardModule="@ag-grid-enterprise/clipboard",t.SparklinesModule="@ag-grid-enterprise/sparklines",t.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",t.AngularModule="@ag-grid-community/angular",t.ReactModule="@ag-grid-community/react",t.VueModule="@ag-grid-community/vue"}(z||(z={}));var H=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},U=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},W=function(){function t(){}return t.register=function(e){t.__register(e,!0,void 0)},t.registerModules=function(e){t.__registerModules(e,!0,void 0)},t.__register=function(e,n,r){t.runVersionChecks(e),void 0!==r?(t.areGridScopedModules=!0,void 0===t.gridModulesMap[r]&&(t.gridModulesMap[r]={}),t.gridModulesMap[r][e.moduleName]=e):t.globalModulesMap[e.moduleName]=e,t.setModuleBased(n)},t.__unRegisterGridModules=function(e){delete t.gridModulesMap[e]},t.__registerModules=function(e,n,r){t.setModuleBased(n),e&&e.forEach((function(e){return t.__register(e,n,r)}))},t.isValidModuleVersion=function(e){var n=H(e.version.split(".")||[],2),r=n[0],o=n[1],i=H(t.currentModuleVersion.split(".")||[],2),s=i[0],a=i[1];return r===s&&o===a},t.runVersionChecks=function(e){if(t.currentModuleVersion||(t.currentModuleVersion=e.version),e.version?t.isValidModuleVersion(e)||console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+e.moduleName+"' is version "+e.version+" but the other modules are version "+this.currentModuleVersion+". Please update all modules to the same version."):console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+e.moduleName+"' is incompatible. Please update all modules to the same version."),e.validate){var n=e.validate();if(!n.isValid){var r=n;console.error("AG Grid: "+r.message)}}},t.setModuleBased=function(e){void 0===t.moduleBased?t.moduleBased=e:t.moduleBased!==e&&O((function(){console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")}),"ModulePackageCheck")},t.__setIsBundled=function(){t.isBundled=!0},t.__assertRegistered=function(e,n,r){var o;if(this.__isRegistered(e,r))return!0;var i,s=n+e;if(t.isBundled)i="AG Grid: unable to use "+n+" as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src=\"https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js\"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise";else if(t.moduleBased||void 0===t.moduleBased){var a=null===(o=Object.entries(z).find((function(t){var n=H(t,2);return n[0],n[1]===e})))||void 0===o?void 0:o[0];i="AG Grid: unable to use "+n+" as the "+a+" is not registered"+(t.areGridScopedModules?" for gridId: "+r:"")+". Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { "+a+" } from '"+e+"';\n    \n    ModuleRegistry.registerModules([ "+a+" ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/"}else i="AG Grid: unable to use "+n+" as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/";return O((function(){console.warn(i)}),s),!1},t.__isRegistered=function(e,n){var r;return!!t.globalModulesMap[e]||!!(null===(r=t.gridModulesMap[n])||void 0===r?void 0:r[e])},t.__getRegisteredModules=function(e){return U(U([],H(c(t.globalModulesMap))),H(c(t.gridModulesMap[e]||{})))},t.__getGridRegisteredModules=function(e){var n;return c(null!==(n=t.gridModulesMap[e])&&void 0!==n?n:{})||[]},t.__isPackageBased=function(){return!t.moduleBased},t.globalModulesMap={},t.gridModulesMap={},t.areGridScopedModules=!1,t}(),q=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},X=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},K=function(){function t(t,e){if(this.beanWrappers={},this.destroyed=!1,t&&t.beanClasses){this.contextParams=t,this.logger=e,this.logger.log(">> creating ag-Application Context"),this.createBeans();var n=this.getBeanInstances();this.wireBeans(n),this.logger.log(">> ag-Application Context ready - component is alive")}}return t.prototype.getBeanInstances=function(){return c(this.beanWrappers).map((function(t){return t.beanInstance}))},t.prototype.createBean=function(t,e){if(!t)throw Error("Can't wire to bean since it is null");return this.wireBeans([t],e),t},t.prototype.wireBeans=function(t,e){this.autoWireBeans(t),this.methodWireBeans(t),this.callLifeCycleMethods(t,"preConstructMethods"),o(e)&&t.forEach(e),this.callLifeCycleMethods(t,"postConstructMethods")},t.prototype.createBeans=function(){var t=this;this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),g(this.beanWrappers,(function(e,n){var r;n.bean.__agBeanMetaData&&n.bean.__agBeanMetaData.autowireMethods&&n.bean.__agBeanMetaData.autowireMethods.agConstructor&&(r=n.bean.__agBeanMetaData.autowireMethods.agConstructor);var o=t.getBeansForParameters(r,n.bean.name),i=new(n.bean.bind.apply(n.bean,X([null],q(o))));n.beanInstance=i}));var e=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+e)},t.prototype.createBeanWrapper=function(t){var e=t.__agBeanMetaData;if(!e){var n=void 0;return n=t.prototype.constructor?I(t.prototype.constructor):""+t,void console.error("Context item "+n+" is not a bean")}var r={bean:t,beanInstance:null,beanName:e.beanName};this.beanWrappers[e.beanName]=r},t.prototype.autoWireBeans=function(t){var e=this;t.forEach((function(t){e.forEachMetaDataInHierarchy(t,(function(n,r){var o=n.agClassAttributes;o&&o.forEach((function(n){var o=e.lookupBeanInstance(r,n.beanName,n.optional);t[n.attributeName]=o}))}))}))},t.prototype.methodWireBeans=function(t){var e=this;t.forEach((function(t){e.forEachMetaDataInHierarchy(t,(function(n,r){g(n.autowireMethods,(function(n,o){if("agConstructor"!==n){var i=e.getBeansForParameters(o,r);t[n].apply(t,i)}}))}))}))},t.prototype.forEachMetaDataInHierarchy=function(t,e){for(var n=Object.getPrototypeOf(t);null!=n;){var r=n.constructor;if(r.hasOwnProperty("__agBeanMetaData"))e(r.__agBeanMetaData,this.getBeanName(r));n=Object.getPrototypeOf(n)}},t.prototype.getBeanName=function(t){if(t.__agBeanMetaData&&t.__agBeanMetaData.beanName)return t.__agBeanMetaData.beanName;var e=t.toString();return e.substring(9,e.indexOf("("))},t.prototype.getBeansForParameters=function(t,e){var n=this,r=[];return t&&g(t,(function(t,o){var i=n.lookupBeanInstance(e,o);r[Number(t)]=i})),r},t.prototype.lookupBeanInstance=function(t,e,n){if(void 0===n&&(n=!1),this.destroyed)return this.logger.log("AG Grid: bean reference "+e+" is used after the grid is destroyed!"),null;if("context"===e)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(e))return this.contextParams.providedBeanInstances[e];var r=this.beanWrappers[e];return r?r.beanInstance:(n||console.error("AG Grid: unable to find bean reference "+e+" while initialising "+t),null)},t.prototype.callLifeCycleMethods=function(t,e){var n=this;t.forEach((function(t){return n.callLifeCycleMethodsOnBean(t,e)}))},t.prototype.callLifeCycleMethodsOnBean=function(t,e,n){var r={};this.forEachMetaDataInHierarchy(t,(function(t){var o=t[e];o&&o.forEach((function(t){t!=n&&(r[t]=!0)}))})),Object.keys(r).forEach((function(e){return t[e]()}))},t.prototype.getBean=function(t){return this.lookupBeanInstance("getBean",t,!0)},t.prototype.destroy=function(){if(!this.destroyed){this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");var t=this.getBeanInstances();this.destroyBeans(t),this.contextParams.providedBeanInstances=null,W.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}},t.prototype.destroyBean=function(t){t&&this.destroyBeans([t])},t.prototype.destroyBeans=function(t){var e=this;return t?(t.forEach((function(t){e.callLifeCycleMethodsOnBean(t,"preDestroyMethods","destroy");var n=t;"function"===typeof n.destroy&&n.destroy()})),[]):[]},t.prototype.isDestroyed=function(){return this.destroyed},t.prototype.getGridId=function(){return this.contextParams.gridId},t}();function Y(t,e,n){var r=rt(t.constructor);r.preConstructMethods||(r.preConstructMethods=[]),r.preConstructMethods.push(e)}function Z(t,e,n){var r=rt(t.constructor);r.postConstructMethods||(r.postConstructMethods=[]),r.postConstructMethods.push(e)}function Q(t,e,n){var r=rt(t.constructor);r.preDestroyMethods||(r.preDestroyMethods=[]),r.preDestroyMethods.push(e)}function J(t){return function(e){rt(e).beanName=t}}function $(t){return function(e,n,r){et(e,t,!1,e,n,null)}}function tt(t){return function(e,n,r){et(e,t,!0,e,n,null)}}function et(t,e,n,r,o,i){if(null!==e)if("number"!==typeof i){var s=rt(t.constructor);s.agClassAttributes||(s.agClassAttributes=[]),s.agClassAttributes.push({attributeName:o,beanName:e,optional:n})}else console.error("AG Grid: Autowired should be on an attribute");else console.error("AG Grid: Autowired name should not be null")}function nt(t){return function(e,n,r){var o,i="function"==typeof e?e:e.constructor;if("number"===typeof r){var s=void 0;n?(o=rt(i),s=n):(o=rt(i),s="agConstructor"),o.autowireMethods||(o.autowireMethods={}),o.autowireMethods[s]||(o.autowireMethods[s]={}),o.autowireMethods[s][r]=t}}}function rt(t){return t.hasOwnProperty("__agBeanMetaData")||(t.__agBeanMetaData={}),t.__agBeanMetaData}var ot=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},it=function(t,e){return function(n,r){e(n,r,t)}},st=function(){function t(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}return t.prototype.setBeans=function(t,e,n,r){if(void 0===r&&(r=null),this.frameworkOverrides=n,this.gridOptionsService=e,r){var o=e.useAsyncEvents();this.addGlobalListener(r,o)}},t.prototype.getListeners=function(t,e,n){var r=e?this.allAsyncListeners:this.allSyncListeners,o=r.get(t);return!o&&n&&(o=new Set,r.set(t,o)),o},t.prototype.noRegisteredListenersExist=function(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size},t.prototype.addEventListener=function(t,e,n){void 0===n&&(n=!1),this.getListeners(t,n,!0).add(e)},t.prototype.removeEventListener=function(t,e,n){void 0===n&&(n=!1);var r=this.getListeners(t,n,!1);r&&(r.delete(e),0===r.size&&(n?this.allAsyncListeners:this.allSyncListeners).delete(t))},t.prototype.addGlobalListener=function(t,e){void 0===e&&(e=!1),(e?this.globalAsyncListeners:this.globalSyncListeners).add(t)},t.prototype.removeGlobalListener=function(t,e){void 0===e&&(e=!1),(e?this.globalAsyncListeners:this.globalSyncListeners).delete(t)},t.prototype.dispatchEvent=function(t){var e=t;if(this.gridOptionsService){var n=this.gridOptionsService,r=n.api,o=n.columnApi,i=n.context;e.api=r,e.columnApi=o,e.context=i}this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0},t.prototype.dispatchEventOnce=function(t){this.firedEvents[t.type]||this.dispatchEvent(t)},t.prototype.dispatchToListeners=function(t,e){var n=this,r=t.type;if(e&&"event"in t){var o=t.event;o instanceof Event&&(t.eventPath=o.composedPath())}var i=new Set(this.getListeners(r,e,!1));i&&function(r){r.forEach((function(r){e?n.dispatchAsync((function(){return r(t)})):r(t)}))}(i),new Set(e?this.globalAsyncListeners:this.globalSyncListeners).forEach((function(o){e?n.dispatchAsync((function(){return n.frameworkOverrides.dispatchEvent(r,(function(){return o(r,t)}),!0)})):n.frameworkOverrides.dispatchEvent(r,(function(){return o(r,t)}),!0)}))},t.prototype.dispatchAsync=function(t){this.asyncFunctionsQueue.push(t),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)},t.prototype.flushAsyncQueue=function(){this.scheduled=!1;var t=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],t.forEach((function(t){return t()}))},ot([it(0,nt("loggerFactory")),it(1,nt("gridOptionsService")),it(2,nt("frameworkOverrides")),it(3,nt("globalEventListener"))],t.prototype,"setBeans",null),t=ot([J("eventService")],t)}(),at=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},lt=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ut=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},ct=0;function pt(){return ct++}var ht=function(){function t(t,e,n,r){this.instanceId=pt(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new st,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=t,this.userProvidedColDef=e,this.colId=n,this.primary=r,this.setState(t)}return t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setState=function(t){void 0!==t.sort?"asc"!==t.sort&&"desc"!==t.sort||(this.sort=t.sort):"asc"!==t.initialSort&&"desc"!==t.initialSort||(this.sort=t.initialSort);var e=l(t.sortIndex),n=l(t.initialSortIndex);void 0!==e?null!==e&&(this.sortIndex=e):null!==n&&(this.sortIndex=n);var r=u(t.hide),o=u(t.initialHide);this.visible=void 0!==r?!r:!o,void 0!==t.pinned?this.setPinned(t.pinned):this.setPinned(t.initialPinned);var i=l(t.flex),s=l(t.initialFlex);void 0!==i?this.flex=i:void 0!==s&&(this.flex=s)},t.prototype.setColDef=function(t,e){this.colDef=t,this.userProvidedColDef=e,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))},t.prototype.getUserProvidedColDef=function(){return this.userProvidedColDef},t.prototype.setParent=function(t){this.parent=t},t.prototype.getParent=function(){return this.parent},t.prototype.setOriginalParent=function(t){this.originalParent=t},t.prototype.getOriginalParent=function(){return this.originalParent},t.prototype.initialise=function(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()},t.prototype.initDotNotation=function(){var t=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=o(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!t,this.tooltipFieldContainsDots=o(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!t},t.prototype.initMinAndMaxWidths=function(){var t=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(t),this.maxWidth=this.columnUtils.calculateColMaxWidth(t)},t.prototype.initTooltip=function(){this.tooltipEnabled=o(this.colDef.tooltipField)||o(this.colDef.tooltipValueGetter)||o(this.colDef.tooltipComponent)},t.prototype.resetActualWidth=function(t){void 0===t&&(t="api");var e=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(e,t,!0)},t.prototype.isEmptyGroup=function(){return!1},t.prototype.isRowGroupDisplayed=function(t){if(i(this.colDef)||i(this.colDef.showRowGroup))return!1;var e=!0===this.colDef.showRowGroup,n=this.colDef.showRowGroup===t;return e||n},t.prototype.isPrimary=function(){return this.primary},t.prototype.isFilterAllowed=function(){return!!this.colDef.filter},t.prototype.isFieldContainsDots=function(){return this.fieldContainsDots},t.prototype.isTooltipEnabled=function(){return this.tooltipEnabled},t.prototype.isTooltipFieldContainsDots=function(){return this.tooltipFieldContainsDots},t.prototype.validate=function(){var t=this.colDef;function e(t,e,n){O((function(){n?console.warn(t,n):O((function(){return console.warn(t)}),e)}),e)}if(this.gridOptionsService.isRowModelType("clientSide")&&!W.__isRegistered(z.RowGroupingModule,this.gridOptionsService.getGridId())){(n=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter((function(e){return o(t[e])}))).length>0&&W.__assertRegistered(z.RowGroupingModule,n.map((function(t){return"colDef."+t})).join(", "),this.gridOptionsService.getGridId())}if("agRichSelect"!==this.colDef.cellEditor&&"agRichSelectCellEditor"!==this.colDef.cellEditor||W.__assertRegistered(z.RichSelectModule,this.colDef.cellEditor,this.gridOptionsService.getGridId()),this.gridOptionsService.isTreeData()){(n=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter((function(e){return o(t[e])}))).length>0&&e("AG Grid: "+n.join()+" is not possible when doing tree data, your column definition should not have "+n.join(),"TreeDataCannotRowGroup")}if(o(t.menuTabs))if(Array.isArray(t.menuTabs)){var n,r=["filterMenuTab"],i=["columnsMenuTab","generalMenuTab"];(n=i.filter((function(e){return t.menuTabs.includes(e)}))).length>0&&W.__assertRegistered(z.MenuModule,"menuTab(s): "+n.map((function(t){return"'"+t+"'"})).join(),this.gridOptionsService.getGridId()),t.menuTabs.forEach((function(t){i.includes(t)||r.includes(t)||e("AG Grid: '"+t+"' is not valid for 'colDef.menuTabs'. Valid values are: "+ut(ut([],lt(r)),lt(i)).map((function(t){return"'"+t+"'"})).join()+".","wrongValue_menuTabs_"+t)}))}else e("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof t.menuTabs,"wrongType_menuTabs");o(t.columnsMenuParams)&&W.__assertRegistered(z.MenuModule,"columnsMenuParams",this.gridOptionsService.getGridId()),o(t.columnsMenuParams)&&W.__assertRegistered(z.ColumnsToolPanelModule,"columnsMenuParams",this.gridOptionsService.getGridId()),o(this.colDef.width)&&"number"!==typeof this.colDef.width&&e("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),o(t.columnGroupShow)&&"closed"!==t.columnGroupShow&&"open"!==t.columnGroupShow&&e("AG Grid: '"+t.columnGroupShow+"' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null","columnGroupShow_invalid")},t.prototype.addEventListener=function(t,e){this.eventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.eventService.removeEventListener(t,e)},t.prototype.createColumnFunctionCallbackParams=function(t){return{node:t,data:t.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}},t.prototype.isSuppressNavigable=function(t){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){var e=this.createColumnFunctionCallbackParams(t);return(0,this.colDef.suppressNavigable)(e)}return!1},t.prototype.isCellEditable=function(t){return!(t.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(t,this.colDef.editable)},t.prototype.isSuppressFillHandle=function(){return!!u(this.colDef.suppressFillHandle)},t.prototype.isAutoHeight=function(){return!!u(this.colDef.autoHeight)},t.prototype.isAutoHeaderHeight=function(){return!!u(this.colDef.autoHeaderHeight)},t.prototype.isRowDrag=function(t){return this.isColumnFunc(t,this.colDef.rowDrag)},t.prototype.isDndSource=function(t){return this.isColumnFunc(t,this.colDef.dndSource)},t.prototype.isCellCheckboxSelection=function(t){return this.isColumnFunc(t,this.colDef.checkboxSelection)},t.prototype.isSuppressPaste=function(t){return this.isColumnFunc(t,this.colDef?this.colDef.suppressPaste:null)},t.prototype.isResizable=function(){return!!u(this.colDef.resizable)},t.prototype.isColumnFunc=function(t,e){return"boolean"===typeof e?e:"function"===typeof e&&e(this.createColumnFunctionCallbackParams(t))},t.prototype.setMoving=function(t,e){void 0===e&&(e="api"),this.moving=t,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",e))},t.prototype.createColumnEvent=function(t,e){return{type:t,column:this,columns:[this],source:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},t.prototype.isMoving=function(){return this.moving},t.prototype.getSort=function(){return this.sort},t.prototype.setSort=function(t,e){void 0===e&&(e="api"),this.sort!==t&&(this.sort=t,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",e))),this.dispatchStateUpdatedEvent("sort")},t.prototype.setMenuVisible=function(t,e){void 0===e&&(e="api"),this.menuVisible!==t&&(this.menuVisible=t,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",e)))},t.prototype.isMenuVisible=function(){return this.menuVisible},t.prototype.isSortAscending=function(){return"asc"===this.sort},t.prototype.isSortDescending=function(){return"desc"===this.sort},t.prototype.isSortNone=function(){return i(this.sort)},t.prototype.isSorting=function(){return o(this.sort)},t.prototype.getSortIndex=function(){return this.sortIndex},t.prototype.setSortIndex=function(t){this.sortIndex=t,this.dispatchStateUpdatedEvent("sortIndex")},t.prototype.setAggFunc=function(t){this.aggFunc=t,this.dispatchStateUpdatedEvent("aggFunc")},t.prototype.getAggFunc=function(){return this.aggFunc},t.prototype.getLeft=function(){return this.left},t.prototype.getOldLeft=function(){return this.oldLeft},t.prototype.getRight=function(){return this.left+this.actualWidth},t.prototype.setLeft=function(t,e){void 0===e&&(e="api"),this.oldLeft=this.left,this.left!==t&&(this.left=t,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",e)))},t.prototype.isFilterActive=function(){return this.filterActive},t.prototype.setFilterActive=function(t,e,n){void 0===e&&(e="api"),this.filterActive!==t&&(this.filterActive=t,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",e)));var r=this.createColumnEvent("filterChanged",e);n&&x(r,n),this.eventService.dispatchEvent(r)},t.prototype.isHovered=function(){return this.columnHoverService.isHovered(this)},t.prototype.setPinned=function(t){this.pinned=!0===t||"left"===t?"left":"right"===t?"right":null,this.dispatchStateUpdatedEvent("pinned")},t.prototype.setFirstRightPinned=function(t,e){void 0===e&&(e="api"),this.firstRightPinned!==t&&(this.firstRightPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",e)))},t.prototype.setLastLeftPinned=function(t,e){void 0===e&&(e="api"),this.lastLeftPinned!==t&&(this.lastLeftPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",e)))},t.prototype.isFirstRightPinned=function(){return this.firstRightPinned},t.prototype.isLastLeftPinned=function(){return this.lastLeftPinned},t.prototype.isPinned=function(){return"left"===this.pinned||"right"===this.pinned},t.prototype.isPinnedLeft=function(){return"left"===this.pinned},t.prototype.isPinnedRight=function(){return"right"===this.pinned},t.prototype.getPinned=function(){return this.pinned},t.prototype.setVisible=function(t,e){void 0===e&&(e="api");var n=!0===t;this.visible!==n&&(this.visible=n,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",e))),this.dispatchStateUpdatedEvent("hide")},t.prototype.isVisible=function(){return this.visible},t.prototype.isSpanHeaderHeight=function(){var t=this.getColDef();return!t.suppressSpanHeaderHeight&&!t.autoHeaderHeight},t.prototype.getColDef=function(){return this.colDef},t.prototype.getColumnGroupShow=function(){return this.colDef.columnGroupShow},t.prototype.getColId=function(){return this.colId},t.prototype.getId=function(){return this.colId},t.prototype.getUniqueId=function(){return this.colId},t.prototype.getDefinition=function(){return this.colDef},t.prototype.getActualWidth=function(){return this.actualWidth},t.prototype.getAutoHeaderHeight=function(){return this.autoHeaderHeight},t.prototype.setAutoHeaderHeight=function(t){var e=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,e},t.prototype.createBaseColDefParams=function(t){return{node:t,data:t.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},t.prototype.getColSpan=function(t){if(i(this.colDef.colSpan))return 1;var e=this.createBaseColDefParams(t),n=this.colDef.colSpan(e);return Math.max(n,1)},t.prototype.getRowSpan=function(t){if(i(this.colDef.rowSpan))return 1;var e=this.createBaseColDefParams(t),n=this.colDef.rowSpan(e);return Math.max(n,1)},t.prototype.setActualWidth=function(t,e,n){void 0===e&&(e="api"),void 0===n&&(n=!1),null!=this.minWidth&&(t=Math.max(t,this.minWidth)),null!=this.maxWidth&&(t=Math.min(t,this.maxWidth)),this.actualWidth!==t&&(this.actualWidth=t,this.flex&&"flex"!==e&&"gridInitializing"!==e&&(this.flex=null),n||this.fireColumnWidthChangedEvent(e)),this.dispatchStateUpdatedEvent("width")},t.prototype.fireColumnWidthChangedEvent=function(t){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",t))},t.prototype.isGreaterThanMax=function(t){return null!=this.maxWidth&&t>this.maxWidth},t.prototype.getMinWidth=function(){return this.minWidth},t.prototype.getMaxWidth=function(){return this.maxWidth},t.prototype.getFlex=function(){return this.flex||0},t.prototype.setFlex=function(t){this.flex!==t&&(this.flex=t),this.dispatchStateUpdatedEvent("flex")},t.prototype.setMinimum=function(t){void 0===t&&(t="api"),o(this.minWidth)&&this.setActualWidth(this.minWidth,t)},t.prototype.setRowGroupActive=function(t,e){void 0===e&&(e="api"),this.rowGroupActive!==t&&(this.rowGroupActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",e))),this.dispatchStateUpdatedEvent("rowGroup")},t.prototype.isRowGroupActive=function(){return this.rowGroupActive},t.prototype.setPivotActive=function(t,e){void 0===e&&(e="api"),this.pivotActive!==t&&(this.pivotActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",e))),this.dispatchStateUpdatedEvent("pivot")},t.prototype.isPivotActive=function(){return this.pivotActive},t.prototype.isAnyFunctionActive=function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()},t.prototype.isAnyFunctionAllowed=function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()},t.prototype.setValueActive=function(t,e){void 0===e&&(e="api"),this.aggregationActive!==t&&(this.aggregationActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",e)))},t.prototype.isValueActive=function(){return this.aggregationActive},t.prototype.isAllowPivot=function(){return!0===this.colDef.enablePivot},t.prototype.isAllowValue=function(){return!0===this.colDef.enableValue},t.prototype.isAllowRowGroup=function(){return!0===this.colDef.enableRowGroup},t.prototype.getMenuTabs=function(t){var e=this.getColDef().menuTabs;return null==e&&(e=t),e},t.prototype.dispatchStateUpdatedEvent=function(e){this.eventService.dispatchEvent({type:t.EVENT_STATE_UPDATED,key:e})},t.EVENT_MOVING_CHANGED="movingChanged",t.EVENT_LEFT_CHANGED="leftChanged",t.EVENT_WIDTH_CHANGED="widthChanged",t.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",t.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",t.EVENT_VISIBLE_CHANGED="visibleChanged",t.EVENT_FILTER_CHANGED="filterChanged",t.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",t.EVENT_SORT_CHANGED="sortChanged",t.EVENT_COL_DEF_CHANGED="colDefChanged",t.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",t.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",t.EVENT_PIVOT_CHANGED="columnPivotChanged",t.EVENT_VALUE_CHANGED="columnValueChanged",t.EVENT_STATE_UPDATED="columnStateUpdated",at([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),at([$("columnUtils")],t.prototype,"columnUtils",void 0),at([$("columnHoverService")],t.prototype,"columnHoverService",void 0),at([Z],t.prototype,"initialise",null),t}(),dt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ft=function(){function t(t,e,n,r){this.localEventService=new st,this.expandable=!1,this.instanceId=pt(),this.expandableListenerRemoveCallback=null,this.colGroupDef=t,this.groupId=e,this.expanded=!!t&&!!t.openByDefault,this.padding=n,this.level=r}return t.prototype.destroy=function(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)},t.prototype.reset=function(t,e){this.colGroupDef=t,this.level=e,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setOriginalParent=function(t){this.originalParent=t},t.prototype.getOriginalParent=function(){return this.originalParent},t.prototype.getLevel=function(){return this.level},t.prototype.isVisible=function(){return!!this.children&&this.children.some((function(t){return t.isVisible()}))},t.prototype.isPadding=function(){return this.padding},t.prototype.setExpanded=function(e){this.expanded=void 0!==e&&e;var n={type:t.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(n)},t.prototype.isExpandable=function(){return this.expandable},t.prototype.isExpanded=function(){return this.expanded},t.prototype.getGroupId=function(){return this.groupId},t.prototype.getId=function(){return this.getGroupId()},t.prototype.setChildren=function(t){this.children=t},t.prototype.getChildren=function(){return this.children},t.prototype.getColGroupDef=function(){return this.colGroupDef},t.prototype.getLeafColumns=function(){var t=[];return this.addLeafColumns(t),t},t.prototype.addLeafColumns=function(e){this.children&&this.children.forEach((function(n){n instanceof ht?e.push(n):n instanceof t&&n.addLeafColumns(e)}))},t.prototype.getColumnGroupShow=function(){var t=this.colGroupDef;if(t)return t.columnGroupShow},t.prototype.setupExpandable=function(){var t=this;this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();var e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((function(t){return t.addEventListener("visibleChanged",e)})),this.expandableListenerRemoveCallback=function(){t.getLeafColumns().forEach((function(t){return t.removeEventListener("visibleChanged",e)})),t.expandableListenerRemoveCallback=null}},t.prototype.setExpandable=function(){if(!this.isPadding()){for(var e=!1,n=!1,r=!1,o=this.findChildrenRemovingPadding(),i=0,s=o.length;i<s;i++){var a=o[i];if(a.isVisible()){var l=a.getColumnGroupShow();"open"===l?(e=!0,r=!0):"closed"===l?(n=!0,r=!0):(e=!0,n=!0)}}var u=e&&n&&r;if(this.expandable!==u){this.expandable=u;var c={type:t.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(c)}}},t.prototype.findChildrenRemovingPadding=function(){var e=[],n=function(r){r.forEach((function(r){r instanceof t&&r.isPadding()?n(r.children):e.push(r)}))};return n(this.children),e},t.prototype.onColumnVisibilityChanged=function(){this.setExpandable()},t.prototype.addEventListener=function(t,e){this.localEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.localEventService.removeEventListener(t,e)},t.EVENT_EXPANDED_CHANGED="expandedChanged",t.EVENT_EXPANDABLE_CHANGED="expandableChanged",dt([Q],t.prototype,"destroy",null),t}(),gt={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function mt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++){var r=t[n];if(o(r))return r}return null}function yt(t){if(t&&t.length)return t[t.length-1]}function vt(t,e,n){return null==t&&null==e||null!=t&&null!=e&&t.length===e.length&&t.every((function(t,r){return n?n(t,e[r]):e[r]===t}))}function _t(t){return t.sort((function(t,e){return t-e}))}function wt(t,e){var n=t.indexOf(e);n>=0&&(t[n]=t[t.length-1],t.pop())}function Ct(t,e){var n=t.indexOf(e);n>=0&&t.splice(n,1)}function bt(t,e){for(var n=0;n<e.length;n++)wt(t,e[n])}function xt(t,e){for(var n=0;n<e.length;n++)Ct(t,e[n])}function Et(t,e,n){t.splice(n,0,e)}function St(t,e,n){xt(t,e),e.slice().reverse().forEach((function(e){return Et(t,e,n)}))}function Tt(t,e){return t.indexOf(e)>-1}function Rt(t){return[].concat.apply([],t)}function Pt(t,e){null!=e&&null!=t&&e.forEach((function(e){return t.push(e)}))}var Ot=Object.freeze({__proto__:null,firstExistingValue:mt,existsAndNotEmpty:function(t){return null!=t&&t.length>0},last:yt,areEqual:vt,shallowCompare:function(t,e){return vt(t,e)},sortNumerically:_t,removeRepeatsFromArray:function(t,e){if(t)for(var n=t.length-2;n>=0;n--){var r=t[n]===e,o=t[n+1]===e;r&&o&&t.splice(n+1,1)}},removeFromUnorderedArray:wt,removeFromArray:Ct,removeAllFromUnorderedArray:bt,removeAllFromArray:xt,insertIntoArray:Et,insertArrayIntoArray:function(t,e,n){if(null!=t&&null!=e)for(var r=e.length-1;r>=0;r--){Et(t,e[r],n)}},moveInArray:St,includes:Tt,flatten:Rt,pushAll:Pt,toStrings:function(t){return t.map(a)},forEachReverse:function(t,e){if(null!=t)for(var n=t.length-1;n>=0;n--)e(t[n],n)}}),It=["touchstart","touchend","touchmove","touchcancel","scroll"],At={};function Dt(t){t.__ag_Grid_Stop_Propagation=!0}function Mt(t){return!0===t.__ag_Grid_Stop_Propagation}var Lt=function(){var t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(e){if("boolean"===typeof At[e])return At[e];var n=document.createElement(t[e]||"div");return At[e="on"+e]=e in n}}();function Nt(t,e,n){for(var r=e;r;){var o=t.getDomData(r,n);if(o)return o;r=r.parentElement}return null}function Ft(t,e){return!(!e||!t)&&Gt(e).indexOf(t)>=0}function kt(t){for(var e=[],n=t.target;n;)e.push(n),n=n.parentElement;return e}function Gt(t){var e=t;return e.path?e.path:e.composedPath?e.composedPath():kt(e)}function Bt(t,e,n,r){var o=Tt(It,n)?{passive:!0}:void 0;t&&t.addEventListener&&t.addEventListener(e,n,r,o)}var Vt=Object.freeze({__proto__:null,stopPropagationForAgGrid:Dt,isStopPropagationForAgGrid:Mt,isEventSupported:Lt,getCtrlForEventTarget:Nt,isElementInEventPath:Ft,createEventPath:kt,getEventPath:Gt,addSafePassiveEventListener:Bt}),zt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jt=function(){function t(){var t=this;this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=function(){return!t.destroyed}}return t.prototype.getFrameworkOverrides=function(){return this.frameworkOverrides},t.prototype.getContext=function(){return this.context},t.prototype.destroy=function(){this.destroyFunctions.forEach((function(t){return t()})),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:t.EVENT_DESTROYED})},t.prototype.addEventListener=function(t,e){this.localEventService||(this.localEventService=new st),this.localEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.localEventService&&this.localEventService.removeEventListener(t,e)},t.prototype.dispatchEventAsync=function(t){var e=this;window.setTimeout((function(){return e.dispatchEvent(t)}),0)},t.prototype.dispatchEvent=function(t){this.localEventService&&this.localEventService.dispatchEvent(t)},t.prototype.addManagedListener=function(t,e,n){var r=this;if(!this.destroyed){t instanceof HTMLElement?Bt(this.getFrameworkOverrides(),t,e,n):t.addEventListener(e,n);var o=function(){return t.removeEventListener(e,n),r.destroyFunctions=r.destroyFunctions.filter((function(t){return t!==o})),null};return this.destroyFunctions.push(o),o}},t.prototype.addManagedPropertyListener=function(t,e){var n=this;if(!this.destroyed){this.gridOptionsService.addEventListener(t,e);var r=function(){return n.gridOptionsService.removeEventListener(t,e),n.destroyFunctions=n.destroyFunctions.filter((function(t){return t!==r})),null};return this.destroyFunctions.push(r),r}},t.prototype.addDestroyFunc=function(t){this.isAlive()?this.destroyFunctions.push(t):t()},t.prototype.createManagedBean=function(t,e){var n=this.createBean(t,e);return this.addDestroyFunc(this.destroyBean.bind(this,t,e)),n},t.prototype.createBean=function(t,e,n){return(e||this.getContext()).createBean(t,n)},t.prototype.destroyBean=function(t,e){return(e||this.getContext()).destroyBean(t)},t.prototype.destroyBeans=function(t,e){var n=this;return t&&t.forEach((function(t){return n.destroyBean(t,e)})),[]},t.EVENT_DESTROYED="destroyed",zt([$("frameworkOverrides")],t.prototype,"frameworkOverrides",void 0),zt([$("context")],t.prototype,"context",void 0),zt([$("eventService")],t.prototype,"eventService",void 0),zt([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),zt([$("localeService")],t.prototype,"localeService",void 0),zt([$("environment")],t.prototype,"environment",void 0),zt([Q],t.prototype,"destroy",null),t}(),Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ut=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Wt=function(t,e){return function(n,r){e(n,r,t)}},qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ht(e,t),e.prototype.setBeans=function(t){this.logger=t.create("ColumnFactory")},e.prototype.createColumnTree=function(t,e,n){var r=new h,o=this.extractExistingTreeData(n),i=o.existingCols,s=o.existingGroups,a=o.existingColKeys;r.addExistingKeys(a);var l=this.recursivelyCreateColumns(t,0,e,i,r,s),u=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+u);var c=this.balanceColumnTree(l,0,u,r);return this.columnUtils.depthFirstOriginalTreeSearch(null,c,(function(t,e){t instanceof ft&&t.setupExpandable(),t.setOriginalParent(e)})),{columnTree:c,treeDept:u}},e.prototype.extractExistingTreeData=function(t){var e=[],n=[],r=[];return t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,(function(t){if(t instanceof ft){var o=t;n.push(o)}else{var i=t;r.push(i.getId()),e.push(i)}})),{existingCols:e,existingGroups:n,existingColKeys:r}},e.prototype.createForAutoGroups=function(t,e){var n=this;return t.map((function(t){return n.createAutoGroupTreeItem(e,t)}))},e.prototype.createAutoGroupTreeItem=function(t,e){for(var n=this.findDepth(t),r=e,o=n-1;o>=0;o--){var i=new ft(null,"FAKE_PATH_"+e.getId()+"}_"+o,!0,o);this.createBean(i),i.setChildren([r]),r.setOriginalParent(i),r=i}return 0===n&&e.setOriginalParent(null),r},e.prototype.findDepth=function(t){for(var e=0,n=t;n&&n[0]&&n[0]instanceof ft;)e++,n=n[0].getChildren();return e},e.prototype.balanceColumnTree=function(t,e,n,r){for(var o=[],i=0;i<t.length;i++){var s=t[i];if(s instanceof ft){var a=s,l=this.balanceColumnTree(a.getChildren(),e+1,n,r);a.setChildren(l),o.push(a)}else{for(var u=void 0,c=void 0,p=n-1;p>=e;p--){var h=r.getUniqueKey(null,null),d=this.createMergedColGroupDef(null),f=new ft(d,h,!0,e);this.createBean(f),c&&c.setChildren([f]),c=f,u||(u=c)}if(u&&c){if(o.push(u),t.some((function(t){return t instanceof ft}))){c.setChildren([s]);continue}c.setChildren(t);break}o.push(s)}}return o},e.prototype.findMaxDept=function(t,e){for(var n=e,r=0;r<t.length;r++){var o=t[r];if(o instanceof ft){var i=o,s=this.findMaxDept(i.getChildren(),e+1);n<s&&(n=s)}}return n},e.prototype.recursivelyCreateColumns=function(t,e,n,r,o,i){if(!t)return[];for(var s=new Array(t.length),a=0;a<s.length;a++){var l=t[a];this.isColumnGroup(l)?s[a]=this.createColumnGroup(n,l,e,r,o,i):s[a]=this.createColumn(n,l,r,o)}return s},e.prototype.createColumnGroup=function(t,e,n,r,o,i){var s=this.createMergedColGroupDef(e),a=o.getUniqueKey(s.groupId||null,null),l=new ft(s,a,!1,n);this.createBean(l);var u=this.findExistingGroup(e,i);u&&Ct(i,u),u&&u.isExpanded()&&l.setExpanded(!0);var c=this.recursivelyCreateColumns(s.children,n+1,t,r,o,i);return l.setChildren(c),l},e.prototype.createMergedColGroupDef=function(t){var e={};return Object.assign(e,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(e,t),e},e.prototype.createColumn=function(t,e,n,r){var o=this.findExistingColumn(e,n);if(n&&o&&Ct(n,o),o){s=this.addColumnDefaultAndTypes(e,o.getColId());o.setColDef(s,e),this.applyColumnState(o,s)}else{var i=r.getUniqueKey(e.colId,e.field),s=this.addColumnDefaultAndTypes(e,i);o=new ht(s,e,i,t),this.context.createBean(o)}return this.dataTypeService.addColumnListeners(o),o},e.prototype.applyColumnState=function(t,e){var n=l(e.flex);if(void 0!==n&&t.setFlex(n),t.getFlex()<=0){var r=l(e.width);if(null!=r)t.setActualWidth(r);else{var o=t.getActualWidth();t.setActualWidth(o)}}void 0!==e.sort&&("asc"==e.sort||"desc"==e.sort?t.setSort(e.sort):t.setSort(void 0));var i=l(e.sortIndex);void 0!==i&&t.setSortIndex(i);var s=u(e.hide);void 0!==s&&t.setVisible(!s),void 0!==e.pinned&&t.setPinned(e.pinned)},e.prototype.findExistingColumn=function(t,e){if(e)for(var n=0;n<e.length;n++){var r=e[n].getUserProvidedColDef();if(r)if(null!=t.colId){if(e[n].getId()===t.colId)return e[n]}else if(null!=t.field){if(r.field===t.field)return e[n]}else if(r===t)return e[n]}},e.prototype.findExistingGroup=function(t,e){return e.find((function(e){return!!e.getColGroupDef()&&(!(null==t.groupId)&&e.getId()===t.groupId)}))},e.prototype.addColumnDefaultAndTypes=function(t,e){var n={};x(n,this.gridOptionsService.get("defaultColDef"),!1,!0);var r=this.dataTypeService.updateColDefAndGetColumnType(n,t,e);r&&this.assignColumnTypes(r,n),x(n,t,!1,!0);var o=this.gridOptionsService.get("autoGroupColumnDef"),i=this.gridOptionsService.isColumnsSortingCoupledToGroup();return t.rowGroup&&o&&i&&x(n,{sort:o.sort,initialSort:o.initialSort},!1,!0),this.dataTypeService.validateColDef(n),n},e.prototype.assignColumnTypes=function(t,e){if(t.length){var n=Object.assign({},gt);g(this.gridOptionsService.get("columnTypes")||{},(function(t,e){t in n?console.warn("AG Grid: the column type '"+t+"' is a default column type and cannot be overridden."):n[t]=e})),t.forEach((function(t){var r=n[t.trim()];r?x(e,r,!1,!0):console.warn("AG Grid: colDef.type '"+t+"' does not correspond to defined gridOptions.columnTypes")}))}},e.prototype.isColumnGroup=function(t){return void 0!==t.children},Ut([$("columnUtils")],e.prototype,"columnUtils",void 0),Ut([$("dataTypeService")],e.prototype,"dataTypeService",void 0),Ut([Wt(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=Ut([J("columnFactory")],e)}(jt),Xt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Kt=function(){function t(t,e,n,r){this.displayedChildren=[],this.localEventService=new st,this.groupId=e,this.partId=n,this.providedColumnGroup=t,this.pinned=r}return t.createUniqueId=function(t,e){return t+"_"+e},t.prototype.reset=function(){this.parent=null,this.children=null,this.displayedChildren=null},t.prototype.getParent=function(){return this.parent},t.prototype.setParent=function(t){this.parent=t},t.prototype.getUniqueId=function(){return t.createUniqueId(this.groupId,this.partId)},t.prototype.isEmptyGroup=function(){return 0===this.displayedChildren.length},t.prototype.isMoving=function(){var t=this.getProvidedColumnGroup().getLeafColumns();return!(!t||0===t.length)&&t.every((function(t){return t.isMoving()}))},t.prototype.checkLeft=function(){if(this.displayedChildren.forEach((function(e){e instanceof t&&e.checkLeft()})),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){var e=yt(this.displayedChildren).getLeft();this.setLeft(e)}else{var n=this.displayedChildren[0].getLeft();this.setLeft(n)}else this.setLeft(null)},t.prototype.getLeft=function(){return this.left},t.prototype.getOldLeft=function(){return this.oldLeft},t.prototype.setLeft=function(e){this.oldLeft=e,this.left!==e&&(this.left=e,this.localEventService.dispatchEvent(this.createAgEvent(t.EVENT_LEFT_CHANGED)))},t.prototype.getPinned=function(){return this.pinned},t.prototype.createAgEvent=function(t){return{type:t}},t.prototype.addEventListener=function(t,e){this.localEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.localEventService.removeEventListener(t,e)},t.prototype.getGroupId=function(){return this.groupId},t.prototype.getPartId=function(){return this.partId},t.prototype.isChildInThisGroupDeepSearch=function(e){var n=!1;return this.children.forEach((function(r){e===r&&(n=!0),r instanceof t&&r.isChildInThisGroupDeepSearch(e)&&(n=!0)})),n},t.prototype.getActualWidth=function(){var t=0;return this.displayedChildren&&this.displayedChildren.forEach((function(e){t+=e.getActualWidth()})),t},t.prototype.isResizable=function(){if(!this.displayedChildren)return!1;var t=!1;return this.displayedChildren.forEach((function(e){e.isResizable()&&(t=!0)})),t},t.prototype.getMinWidth=function(){var t=0;return this.displayedChildren.forEach((function(e){t+=e.getMinWidth()||0})),t},t.prototype.addChild=function(t){this.children||(this.children=[]),this.children.push(t)},t.prototype.getDisplayedChildren=function(){return this.displayedChildren},t.prototype.getLeafColumns=function(){var t=[];return this.addLeafColumns(t),t},t.prototype.getDisplayedLeafColumns=function(){var t=[];return this.addDisplayedLeafColumns(t),t},t.prototype.getDefinition=function(){return this.providedColumnGroup.getColGroupDef()},t.prototype.getColGroupDef=function(){return this.providedColumnGroup.getColGroupDef()},t.prototype.isPadding=function(){return this.providedColumnGroup.isPadding()},t.prototype.isExpandable=function(){return this.providedColumnGroup.isExpandable()},t.prototype.isExpanded=function(){return this.providedColumnGroup.isExpanded()},t.prototype.setExpanded=function(t){this.providedColumnGroup.setExpanded(t)},t.prototype.addDisplayedLeafColumns=function(e){this.displayedChildren.forEach((function(n){n instanceof ht?e.push(n):n instanceof t&&n.addDisplayedLeafColumns(e)}))},t.prototype.addLeafColumns=function(e){this.children.forEach((function(n){n instanceof ht?e.push(n):n instanceof t&&n.addLeafColumns(e)}))},t.prototype.getChildren=function(){return this.children},t.prototype.getColumnGroupShow=function(){return this.providedColumnGroup.getColumnGroupShow()},t.prototype.getProvidedColumnGroup=function(){return this.providedColumnGroup},t.prototype.getPaddingLevel=function(){var t=this.getParent();return this.isPadding()&&t&&t.isPadding()?1+t.getPaddingLevel():0},t.prototype.calculateDisplayedColumns=function(){var e=this;this.displayedChildren=[];for(var n=this;null!=n&&n.isPadding();)n=n.getParent();if(!(!!n&&n.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(t.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach((function(r){if(!(r instanceof t&&(!r.displayedChildren||!r.displayedChildren.length)))switch(r.getColumnGroupShow()){case"open":n.providedColumnGroup.isExpanded()&&e.displayedChildren.push(r);break;case"closed":n.providedColumnGroup.isExpanded()||e.displayedChildren.push(r);break;default:e.displayedChildren.push(r)}})),this.localEventService.dispatchEvent(this.createAgEvent(t.EVENT_DISPLAYED_CHILDREN_CHANGED))},t.EVENT_LEFT_CHANGED="leftChanged",t.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",Xt([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),t}(),Yt=function(){function t(){}return t.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",t.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",t.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",t.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",t.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",t.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",t.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",t.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",t.EVENT_COLUMN_MOVED="columnMoved",t.EVENT_COLUMN_VISIBLE="columnVisible",t.EVENT_COLUMN_PINNED="columnPinned",t.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",t.EVENT_COLUMN_RESIZED="columnResized",t.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",t.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",t.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",t.EVENT_ROW_GROUP_OPENED="rowGroupOpened",t.EVENT_ROW_DATA_CHANGED="rowDataChanged",t.EVENT_ROW_DATA_UPDATED="rowDataUpdated",t.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",t.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",t.EVENT_CHART_CREATED="chartCreated",t.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",t.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",t.EVENT_CHART_DESTROYED="chartDestroyed",t.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",t.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",t.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",t.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",t.EVENT_MODEL_UPDATED="modelUpdated",t.EVENT_CUT_START="cutStart",t.EVENT_CUT_END="cutEnd",t.EVENT_PASTE_START="pasteStart",t.EVENT_PASTE_END="pasteEnd",t.EVENT_FILL_START="fillStart",t.EVENT_FILL_END="fillEnd",t.EVENT_RANGE_DELETE_START="rangeDeleteStart",t.EVENT_RANGE_DELETE_END="rangeDeleteEnd",t.EVENT_UNDO_STARTED="undoStarted",t.EVENT_UNDO_ENDED="undoEnded",t.EVENT_REDO_STARTED="redoStarted",t.EVENT_REDO_ENDED="redoEnded",t.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",t.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",t.EVENT_CELL_CLICKED="cellClicked",t.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",t.EVENT_CELL_MOUSE_DOWN="cellMouseDown",t.EVENT_CELL_CONTEXT_MENU="cellContextMenu",t.EVENT_CELL_VALUE_CHANGED="cellValueChanged",t.EVENT_CELL_EDIT_REQUEST="cellEditRequest",t.EVENT_ROW_VALUE_CHANGED="rowValueChanged",t.EVENT_CELL_FOCUSED="cellFocused",t.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",t.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",t.EVENT_ROW_SELECTED="rowSelected",t.EVENT_SELECTION_CHANGED="selectionChanged",t.EVENT_TOOLTIP_SHOW="tooltipShow",t.EVENT_TOOLTIP_HIDE="tooltipHide",t.EVENT_CELL_KEY_DOWN="cellKeyDown",t.EVENT_CELL_MOUSE_OVER="cellMouseOver",t.EVENT_CELL_MOUSE_OUT="cellMouseOut",t.EVENT_FILTER_CHANGED="filterChanged",t.EVENT_FILTER_MODIFIED="filterModified",t.EVENT_FILTER_OPENED="filterOpened",t.EVENT_SORT_CHANGED="sortChanged",t.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",t.EVENT_ROW_CLICKED="rowClicked",t.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",t.EVENT_GRID_READY="gridReady",t.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",t.EVENT_VIEWPORT_CHANGED="viewportChanged",t.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",t.EVENT_FIRST_DATA_RENDERED="firstDataRendered",t.EVENT_DRAG_STARTED="dragStarted",t.EVENT_DRAG_STOPPED="dragStopped",t.EVENT_CHECKBOX_CHANGED="checkboxChanged",t.EVENT_ROW_EDITING_STARTED="rowEditingStarted",t.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",t.EVENT_CELL_EDITING_STARTED="cellEditingStarted",t.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",t.EVENT_BODY_SCROLL="bodyScroll",t.EVENT_BODY_SCROLL_END="bodyScrollEnd",t.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",t.EVENT_PAGINATION_CHANGED="paginationChanged",t.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",t.EVENT_STORE_REFRESHED="storeRefreshed",t.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",t.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",t.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",t.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",t.EVENT_FLASH_CELLS="flashCells",t.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",t.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",t.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",t.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",t.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",t.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",t.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",t.EVENT_ROW_DRAG_ENTER="rowDragEnter",t.EVENT_ROW_DRAG_MOVE="rowDragMove",t.EVENT_ROW_DRAG_LEAVE="rowDragLeave",t.EVENT_ROW_DRAG_END="rowDragEnd",t.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",t.EVENT_POPUP_TO_FRONT="popupToFront",t.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",t.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",t.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",t.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",t.EVENT_KEYBOARD_FOCUS="keyboardFocus",t.EVENT_MOUSE_FOCUS="mouseFocus",t.EVENT_STORE_UPDATED="storeUpdated",t.EVENT_FILTER_DESTROYED="filterDestroyed",t.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted",t.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged",t.EVENT_DATA_TYPES_INFERRED="dataTypesInferred",t.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged",t.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected",t}(),Zt=function(){function t(){this.existingIds={}}return t.prototype.getInstanceIdForKey=function(t){var e,n=this.existingIds[t];return e="number"!==typeof n?0:n+1,this.existingIds[t]=e,e},t}(),Qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$t="ag-Grid-AutoColumn",te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qt(e,t),e.prototype.createAutoGroupColumns=function(t){var e=this,n=[],r=this.gridOptionsService.isTreeData(),o=this.gridOptionsService.isGroupMultiAutoColumn();return r&&o&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),o=!1),o?t.forEach((function(t,r){n.push(e.createOneAutoGroupColumn(t,r))})):n.push(this.createOneAutoGroupColumn()),n},e.prototype.updateAutoGroupColumns=function(t){var e=this;t.forEach((function(t,n){return e.updateOneAutoGroupColumn(t,n)}))},e.prototype.createOneAutoGroupColumn=function(t,e){var n;n=t?$t+"-"+t.getId():$t;var r=this.createAutoGroupColDef(n,t,e);r.colId=n;var o=new ht(r,null,n,!0);return this.context.createBean(o),o},e.prototype.updateOneAutoGroupColumn=function(t,e){var n=t.getColDef(),r="string"==typeof n.showRowGroup?n.showRowGroup:void 0,o=null!=r?this.columnModel.getPrimaryColumn(r):void 0,i=this.createAutoGroupColDef(t.getId(),null!==o&&void 0!==o?o:void 0,e);t.setColDef(i,null),this.columnFactory.applyColumnState(t,i)},e.prototype.createAutoGroupColDef=function(t,e,n){var r=this.createBaseColDef(e);(x(r,this.gridOptionsService.get("autoGroupColumnDef")),r=this.columnFactory.addColumnDefaultAndTypes(r,t),this.gridOptionsService.isTreeData())||i(r.field)&&i(r.valueGetter)&&i(r.filterValueGetter)&&"agGroupColumnFilter"!==r.filter&&(r.filter=!1);n&&n>0&&(r.headerCheckboxSelection=!1);var o=this.gridOptionsService.isColumnsSortingCoupledToGroup(),s=r.valueGetter||null!=r.field;return o&&!s&&(r.sortIndex=void 0,r.initialSort=void 0),r},e.prototype.createBaseColDef=function(t){var e=this.gridOptionsService.get("autoGroupColumnDef"),n={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(e&&(e.cellRenderer||e.cellRendererSelector)||(n.cellRenderer="agGroupCellRenderer"),t){var r=t.getColDef();Object.assign(n,{headerName:this.columnModel.getDisplayNameForColumn(t,"header"),headerValueGetter:r.headerValueGetter}),r.cellRenderer&&Object.assign(n,{cellRendererParams:{innerRenderer:r.cellRenderer,innerRendererParams:r.cellRendererParams}}),n.showRowGroup=t.getColId()}else n.showRowGroup=!0;return n},Jt([$("columnModel")],e.prototype,"columnModel",void 0),Jt([$("columnFactory")],e.prototype,"columnFactory",void 0),e=Jt([J("autoGroupColService")],e)}(jt),ee=/[&<>"']/g,ne={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function re(t,e){if(null==t)return null;var n=t.toString().toString();return e?n:n.replace(ee,(function(t){return ne[t]}))}function oe(t){if(!t||null==t)return null;return t.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((function(t){return t.substring(0,1).toUpperCase()+(t.length>1?t.substring(1,t.length):"")})).join(" ")}function ie(t){return t.replace(/[A-Z]/g,(function(t){return"-"+t.toLocaleLowerCase()}))}var se=Object.freeze({__proto__:null,utf8_encode:function(t){var e=String.fromCharCode;function n(t,n){return e(t>>n&63|128)}function r(t){if(t>=0&&t<=31&&10!==t)return"_x"+t.toString(16).toUpperCase().padStart(4,"0")+"_";if(0==(4294967168&t))return e(t);var r="";return 0==(4294965248&t)?r=e(t>>6&31|192):0==(4294901760&t)?(!function(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}(t),r=e(t>>12&15|224),r+=n(t,6)):0==(4292870144&t)&&(r=e(t>>18&7|240),r+=n(t,12),r+=n(t,6)),r+=e(63&t|128)}for(var o=function(t){var e=[];if(!t)return[];for(var n,r,o=t.length,i=0;i<o;)(n=t.charCodeAt(i++))>=55296&&n<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?e.push(((1023&n)<<10)+(1023&r)+65536):(e.push(n),i--):e.push(n);return e}(t),i=o.length,s=-1,a="";++s<i;)a+=r(o[s]);return a},capitalise:function(t){return t[0].toUpperCase()+t.substr(1).toLowerCase()},escapeString:re,camelCaseToHumanText:oe,camelCaseToHyphenated:ie});function ae(t){var e=new Map;return t.forEach((function(t){return e.set(t[0],t[1])})),e}var le=Object.freeze({__proto__:null,convertToMap:ae,mapById:function(t,e){var n=new Map;return t.forEach((function(t){return n.set(e(t),t)})),n},keys:function(t){var e=[];return t.forEach((function(t,n){return e.push(n)})),e}}),ue=function(){function t(){}return t.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0},t.ALL_PROPERTIES=Object.keys(t.ColDefPropertyMap),t}(),ce=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},pe=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},he=function(){function t(){}return t.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator"],t.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent"],t.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],t.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],t.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideFilterAllLevels","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard","enableAdvancedFilter","includeHiddenColumnsInAdvancedFilter"],t.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer"],t.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],t.FUNCTION_PROPERTIES=pe(pe([],ce(t.FUNCTIONAL_PROPERTIES)),ce(t.CALLBACK_PROPERTIES)),t.ALL_PROPERTIES=pe(pe(pe(pe(pe(pe([],ce(t.ARRAY_PROPERTIES)),ce(t.OBJECT_PROPERTIES)),ce(t.STRING_PROPERTIES)),ce(t.NUMBER_PROPERTIES)),ce(t.FUNCTION_PROPERTIES)),ce(t.BOOLEAN_PROPERTIES)),t}(),de=function(){return(de=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},fe=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ge=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},me=function(){function t(){}return t.getCallbackForEvent=function(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substr(1)},t.getCoercionLookup=function(){var e={};return ge(ge(ge(ge(ge([],fe(t.ARRAY_PROPERTIES)),fe(t.OBJECT_PROPERTIES)),fe(t.STRING_PROPERTIES)),fe(t.FUNCTION_PROPERTIES)),fe(t.EVENT_CALLBACKS)).forEach((function(t){return e[t]="none"})),t.BOOLEAN_PROPERTIES.forEach((function(t){return e[t]="boolean"})),t.NUMBER_PROPERTIES.forEach((function(t){return e[t]="number"})),e},t.getValue=function(e,n){var r=t.coercionLookup[e];if(r){var o=n;switch(r){case"number":o=t.toNumber(n);break;case"boolean":o=t.toBoolean(n);break;case"none":"groupAggFiltering"===e&&"function"!==typeof n&&(o=t.toBoolean(n))}return o}},t.getGridOptionKeys=function(e,n){return n?Object.keys(t.coercionLookup):Object.keys(e)},t.copyAttributesToGridOptions=function(e,n,r){void 0===r&&(r=!1),"object"!==typeof e&&(e={});var o=e;return t.getGridOptionKeys(n,r).forEach((function(e){var r=n[e];if("undefined"!==typeof r){var i=t.getValue(e,r);void 0!==i&&(o[e]=i)}})),e},t.processOnChange=function(e,n){if(e&&0!==Object.keys(e).length){var r=de({},e);r.columnTypes&&(n.setColumnTypes(r.columnTypes.currentValue,"gridOptionsChanged"),delete r.columnTypes),r.autoGroupColumnDef&&(n.setAutoGroupColumnDef(r.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete r.autoGroupColumnDef),r.defaultColDef&&(n.setDefaultColDef(r.defaultColDef.currentValue,"gridOptionsChanged"),delete r.defaultColDef),r.columnDefs&&(n.setColumnDefs(r.columnDefs.currentValue,"gridOptionsChanged"),delete r.columnDefs),Object.keys(r).forEach((function(e){var o=e,i=t.getValue(o,r[o].currentValue);n.__setProperty(o,i)}));var o={type:Yt.EVENT_COMPONENT_STATE_CHANGED};g(e,(function(t,e){o[t]=e})),n.dispatchEvent(o)}},t.toBoolean=function(t){return"boolean"===typeof t?t:"string"===typeof t&&("TRUE"===t.toUpperCase()||""==t)},t.toNumber=function(t){return"number"===typeof t?t:"string"===typeof t?Number(t):void 0},t.EVENTS=c(Yt),t.EXCLUDED_INTERNAL_EVENTS=[Yt.EVENT_SCROLLBAR_WIDTH_CHANGED,Yt.EVENT_CHECKBOX_CHANGED,Yt.EVENT_HEIGHT_SCALE_CHANGED,Yt.EVENT_BODY_HEIGHT_CHANGED,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,Yt.EVENT_COLUMN_HOVER_CHANGED,Yt.EVENT_FLASH_CELLS,Yt.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,Yt.EVENT_DISPLAYED_ROWS_CHANGED,Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED,Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,Yt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,Yt.EVENT_POPUP_TO_FRONT,Yt.EVENT_KEYBOARD_FOCUS,Yt.EVENT_MOUSE_FOCUS,Yt.EVENT_STORE_UPDATED,Yt.EVENT_COLUMN_PANEL_ITEM_DRAG_START,Yt.EVENT_COLUMN_PANEL_ITEM_DRAG_END,Yt.EVENT_FILL_START,Yt.EVENT_FILL_END,Yt.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,Yt.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,Yt.EVENT_FULL_WIDTH_ROW_FOCUSED,Yt.EVENT_HEADER_HEIGHT_CHANGED,Yt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,Yt.EVENT_CELL_FOCUS_CLEARED,Yt.EVENT_GRID_STYLES_CHANGED,Yt.EVENT_FILTER_DESTROYED,Yt.EVENT_ROW_DATA_UPDATE_STARTED,Yt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,Yt.EVENT_DATA_TYPES_INFERRED,Yt.EVENT_FIELD_VALUE_CHANGED,Yt.EVENT_FIELD_PICKER_VALUE_SELECTED],t.PUBLIC_EVENTS=t.EVENTS.filter((function(e){return!Tt(t.EXCLUDED_INTERNAL_EVENTS,e)})),t.EVENT_CALLBACKS=t.EVENTS.map((function(e){return t.getCallbackForEvent(e)})),t.STRING_PROPERTIES=he.STRING_PROPERTIES,t.OBJECT_PROPERTIES=he.OBJECT_PROPERTIES,t.ARRAY_PROPERTIES=he.ARRAY_PROPERTIES,t.NUMBER_PROPERTIES=he.NUMBER_PROPERTIES,t.BOOLEAN_PROPERTIES=he.BOOLEAN_PROPERTIES,t.FUNCTION_PROPERTIES=he.FUNCTION_PROPERTIES,t.ALL_PROPERTIES=he.ALL_PROPERTIES,t.ALL_PROPERTIES_SET=new Set(he.ALL_PROPERTIES),t.coercionLookup=t.getCoercionLookup(),t}();function ye(t,e,n){var r={},o=t.filter((function(t){return!e.some((function(e){return e===t}))}));return o.length>0&&o.forEach((function(t){return r[t]=ve(t,n)})),r}function ve(t,e,n,r){var o=e.map((function(e){return{value:e,relevance:_e(t.toLowerCase(),e.toLocaleLowerCase())}}));if(o.sort((function(t,e){return e.relevance-t.relevance})),n&&(o=o.filter((function(t){return 0!==t.relevance}))),o.length>0&&r&&r>0){var i=o[0].relevance*r;o=o.filter((function(t){return i-t.relevance<0}))}return o.map((function(t){return t.value}))}function _e(t,e){for(var n=t.replace(/\s/g,""),r=e.replace(/\s/g,""),o=0,i=-1,s=0;s<n.length;s++){var a=r.indexOf(n[s],i+1);-1!==a&&(o+=100-100*(i=a)/1e4*100)}return o}var we=Object.freeze({__proto__:null,fuzzyCheckStrings:ye,fuzzySuggestions:ve}),Ce=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},be=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},xe=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};function Ee(t,e,n,r){var o=n?"Please use '"+n+"' instead. ":"";O((function(){return console.warn("AG Grid: since v"+t+", '"+e+"' is deprecated. "+o+(null!==r&&void 0!==r?r:""))}),"Deprecated_"+e)}var Se=["__ob__","__v_skip","__metadata__"],Te=function(){function t(){this.deprecatedProperties={rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideOnlyRefreshFilteredGroups",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",newProp:"enterNavigatesVertically",copyToNewProp:!0},enterMovesDownAfterEdit:{version:"30",newProp:"enterNavigatesVerticallyAfterEdit",copyToNewProp:!0}}}return t.prototype.pickOneWarning=function(t,e){console.warn("AG Grid: "+t+" and "+e+" do not work with each other, you need to pick one.")},t.prototype.init=function(){var t=this;if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),this.gridOptionsService.isRowModelType("serverSide")){var e=function(t,e){return"AG Grid: '"+t+"' is not supported on the Server-Side Row Model."+(e?" Please use "+e+" instead.":"")};this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(e("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&this.gridOptionsService.is("suppressServerSideInfiniteScroll")&&console.warn(e("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(e("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?W.__assertRegistered(z.RangeSelectionModule,"enableRangeSelection",this.gridOptionsService.getGridId()):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");var n=function(e,n){return t.gridOptionsService.exists(e)&&W.__assertRegistered(n,e,t.gridOptionsService.getGridId())};n("sideBar",z.SideBarModule),n("statusBar",z.StatusBarModule),n("enableCharts",z.GridChartsModule),n("getMainMenuItems",z.MenuModule),n("getContextMenuItems",z.MenuModule),n("allowContextMenuWithControlKey",z.MenuModule),n("enableAdvancedFilter",z.AdvancedFilterModule)},t.prototype.checkColumnDefProperties=function(){var t=this;if(null!=this.gridOptions.columnDefs){var e=ue.ALL_PROPERTIES,n=function(r,o){var i=Object.getOwnPropertyNames(r);t.checkProperties(i,xe(xe([],be(e)),be(Se)),e,o,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),r.children&&r.children.forEach((function(t){return n(t,"columnDefs.children")}))};this.gridOptions.columnDefs.forEach((function(t){return n(t,"columnDefs")})),this.gridOptions.defaultColDef&&n(this.gridOptions.defaultColDef,"defaultColDef")}},t.prototype.checkColumnDefViolations=function(){var t,e=null!==(t=this.gridOptionsService.get("rowModelType"))&&void 0!==t?t:"clientSide",n={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[e];if(null===n||void 0===n?void 0:n.length){var r=function(t){n.forEach((function(n){n in t&&t[n]&&console.warn("AG Grid: Column property "+n+" is not supported with the row model type "+e+".")}))};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach((function(t){return r(t)})),null!=this.gridOptions.autoGroupColumnDef&&r(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&r(this.gridOptions.defaultColDef)}},t.prototype.checkGridOptionsProperties=function(){var t=Object.getOwnPropertyNames(this.gridOptions),e=xe(xe([],be(he.ALL_PROPERTIES)),be(me.EVENT_CALLBACKS)),n=xe(xe(xe(xe([],be(e)),["api","columnApi"]),be(Se)),be(Object.keys(this.deprecatedProperties)));this.checkProperties(t,n,e,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")},t.prototype.checkProperties=function(t,e,n,r,o){var i=ye(t,e,n);g(i,(function(t,e){O((function(){return console.warn("AG Grid: invalid "+r+" property '"+t+"' did you mean any of these: "+e.slice(0,8).join(", "))}),"invalidProperty"+r+t)})),Object.keys(i).length>0&&O((function(){return console.warn("AG Grid: to see all the valid "+r+" properties please check: "+o)}),"invalidProperties"+r+o)},t.prototype.checkForDeprecated=function(){var t=this.gridOptions;Object.entries(this.deprecatedProperties).forEach((function(e){var n,r=be(e,2),o=r[0],i=r[1],s=t[o];s&&(Ee(i.version,o,i.newProp,i.message),i.copyToNewProp&&i.newProp&&null==t[i.newProp]&&(t[i.newProp]=null!==(n=i.newPropValue)&&void 0!==n?n:s))})),t.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),t.suppressServerSideInfiniteScroll="partial"!==t.serverSideStoreType)},t.prototype.checkForViolations=function(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()},t.prototype.treeDataViolations=function(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))},Ce([$("gridOptions")],t.prototype,"gridOptions",void 0),Ce([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),Ce([Z],t.prototype,"init",null),t=Ce([J("gridOptionsValidator")],t)}();function Re(t,e){var n=["groupRows","multipleColumns","custom","singleColumn"];return n.indexOf(e)<0?(console.warn("AG Grid: '"+e+"' is not a valid groupDisplayType value - possible values are: '"+n.join("', '")+"'"),!1):e===t}var Pe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ie=function(t,e){return function(n,r){e(n,r,t)}},Ae=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},De=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Me=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Le=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ne=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.primaryHeaderRowCount=0,e.secondaryHeaderRowCount=0,e.gridHeaderRowCount=0,e.displayedColumnsLeft=[],e.displayedColumnsRight=[],e.displayedColumnsCenter=[],e.displayedColumns=[],e.displayedColumnsAndGroupsMap={},e.viewportColumns=[],e.viewportColumnsHash="",e.headerViewportColumns=[],e.viewportColumnsCenter=[],e.headerViewportColumnsCenter=[],e.autoHeightActiveAtLeastOnce=!1,e.rowGroupColumns=[],e.valueColumns=[],e.pivotColumns=[],e.ready=!1,e.autoGroupsNeedBuilding=!1,e.forceRecreateAutoGroups=!1,e.pivotMode=!1,e.bodyWidth=0,e.leftWidth=0,e.rightWidth=0,e.bodyWidthDirty=!0,e.shouldQueueResizeOperations=!1,e.resizeOperationQueue=[],e}return Pe(e,t),e.prototype.init=function(){var t=this;this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");var e=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",(function(){return t.onGroupDisplayTypeChanged()})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return t.onAutoGroupColumnDefChanged()})),this.addManagedPropertyListener("defaultColDef",(function(e){return t.onSharedColDefChanged(e.source)})),this.addManagedPropertyListener("columnTypes",(function(e){return t.onSharedColDefChanged(e.source)}))},e.prototype.onGroupDisplayTypeChanged=function(){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged"))},e.prototype.onAutoGroupColumnDefChanged=function(){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns)},e.prototype.onSharedColDefChanged=function(t){void 0===t&&(t="api"),this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns),this.createColumnsFromColumnDefs(!0,t)},e.prototype.setColumnDefs=function(t,e){void 0===e&&(e="api");var n=!!this.columnDefs;this.columnDefs=t,this.createColumnsFromColumnDefs(n,e)},e.prototype.recreateColumnDefs=function(t){void 0===t&&(t="api"),this.onSharedColDefChanged(t)},e.prototype.destroyOldColumns=function(t,e){var n={};if(t){this.columnUtils.depthFirstOriginalTreeSearch(null,t,(function(t){n[t.getInstanceId()]=t})),e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,(function(t){n[t.getInstanceId()]=null}));var r=Object.values(n).filter((function(t){return null!=t}));this.destroyBeans(r)}},e.prototype.destroyColumns=function(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)},e.prototype.createColumnsFromColumnDefs=function(t,e){var n=this;void 0===e&&(e="api");var r=t?this.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var o=this.primaryColumns,i=this.primaryColumnTree,s=this.columnFactory.createColumnTree(this.columnDefs,!0,i);this.destroyOldColumns(this.primaryColumnTree,s.columnTree),this.primaryColumnTree=s.columnTree,this.primaryHeaderRowCount=s.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach((function(t){return n.primaryColumnsMap[t.getId()]=t})),this.extractRowGroupColumns(e,o),this.extractPivotColumns(e,o),this.extractValueColumns(e,o),this.ready=!0;var a=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||a)&&(this.updateGridColumns(),t&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(e),this.checkViewportColumns()),this.dispatchEverythingChanged(e),r&&r(),this.dispatchNewColumnsLoaded(e)},e.prototype.dispatchNewColumnsLoaded=function(t){var e={type:Yt.EVENT_NEW_COLUMNS_LOADED,source:t};this.eventService.dispatchEvent(e)},e.prototype.dispatchEverythingChanged=function(t){void 0===t&&(t="api");var e={type:Yt.EVENT_COLUMN_EVERYTHING_CHANGED,source:t};this.eventService.dispatchEvent(e)},e.prototype.orderGridColumnsLikePrimary=function(){var t=this,e=this.primaryColumns;if(e){var n=e.filter((function(e){return t.gridColumns.indexOf(e)>=0})),r=this.gridColumns.filter((function(t){return n.indexOf(t)<0}));this.gridColumns=Me(Me([],De(r)),De(n)),this.gridColumns=this.placeLockedColumns(this.gridColumns)}},e.prototype.getAllDisplayedAutoHeightCols=function(){return this.displayedAutoHeightCols},e.prototype.setViewport=function(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)},e.prototype.getDisplayedColumnsStartingAt=function(t){for(var e=t,n=[];null!=e;)n.push(e),e=this.getDisplayedColAfter(e);return n},e.prototype.checkViewportColumns=function(){if(null!=this.displayedColumnsCenter&&this.extractViewport()){var t={type:Yt.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}},e.prototype.setViewportPosition=function(t,e){(t!==this.scrollWidth||e!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=t,this.scrollPosition=e,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())},e.prototype.isPivotMode=function(){return this.pivotMode},e.prototype.isPivotSettingAllowed=function(t){return!t||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)},e.prototype.setPivotMode=function(t,e){if(void 0===e&&(e="api"),t!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)){this.pivotMode=t,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(e);var n={type:Yt.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(n)}},e.prototype.getSecondaryPivotColumn=function(t,e){if(i(this.secondaryColumns))return null;var n=this.getPrimaryColumn(e),r=null;return this.secondaryColumns.forEach((function(e){var o=e.getColDef().pivotKeys,i=e.getColDef().pivotValueColumn;vt(o,t)&&i===n&&(r=e)})),r},e.prototype.setBeans=function(t){this.logger=t.create("columnModel")},e.prototype.setFirstRightAndLastLeftPinned=function(t){var e,n;this.gridOptionsService.is("enableRtl")?(e=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,n=this.displayedColumnsRight?yt(this.displayedColumnsRight):null):(e=this.displayedColumnsLeft?yt(this.displayedColumnsLeft):null,n=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach((function(r){r.setLastLeftPinned(r===e,t),r.setFirstRightPinned(r===n,t)}))},e.prototype.autoSizeColumns=function(t){var e=this;if(this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return e.autoSizeColumns(t)}));else{var n=t.columns,r=t.skipHeader,o=t.skipHeaderGroups,i=t.stopAtGroup,s=t.source,a=void 0===s?"api":s;this.animationFrameService.flushAllFrames();for(var l=[],u=-1,c=null!=r?r:this.gridOptionsService.is("skipHeaderOnAutoSize"),p=null!=o?o:c;0!==u;)u=0,this.actionOnGridColumns(n,(function(t){if(l.indexOf(t)>=0)return!1;var n=e.autoWidthCalculator.getPreferredWidthForColumn(t,c);if(n>0){var r=e.normaliseColumnWidth(t,n);t.setActualWidth(r,a),l.push(t),u++}return!0}),a);p||this.autoSizeColumnGroupsByColumns(n,a,i),this.dispatchColumnResizedEvent(l,!0,"autosizeColumns")}},e.prototype.dispatchColumnResizedEvent=function(t,e,n,r){if(void 0===r&&(r=null),t&&t.length){var o={type:Yt.EVENT_COLUMN_RESIZED,columns:t,column:1===t.length?t[0]:null,flexColumns:r,finished:e,source:n};this.eventService.dispatchEvent(o)}},e.prototype.dispatchColumnChangedEvent=function(t,e,n){var r={type:t,columns:e,column:e&&1==e.length?e[0]:null,source:n};this.eventService.dispatchEvent(r)},e.prototype.dispatchColumnMovedEvent=function(t){var e=t.movedColumns,n=t.source,r=t.toIndex,o=t.finished,i={type:Yt.EVENT_COLUMN_MOVED,columns:e,column:e&&1===e.length?e[0]:null,toIndex:r,finished:o,source:n};this.eventService.dispatchEvent(i)},e.prototype.dispatchColumnPinnedEvent=function(t,e){if(t.length){var n=1===t.length?t[0]:null,r=this.getCommonValue(t,(function(t){return t.getPinned()})),o={type:Yt.EVENT_COLUMN_PINNED,pinned:null!=r?r:null,columns:t,column:n,source:e};this.eventService.dispatchEvent(o)}},e.prototype.dispatchColumnVisibleEvent=function(t,e){if(t.length){var n=1===t.length?t[0]:null,r=this.getCommonValue(t,(function(t){return t.isVisible()})),o={type:Yt.EVENT_COLUMN_VISIBLE,visible:r,columns:t,column:n,source:e};this.eventService.dispatchEvent(o)}},e.prototype.autoSizeColumn=function(t,e,n){void 0===n&&(n="api"),t&&this.autoSizeColumns({columns:[t],skipHeader:e,skipHeaderGroups:!0,source:n})},e.prototype.autoSizeColumnGroupsByColumns=function(t,e,n){var r,o,i,s,a,l=new Set;this.getGridColumns(t).forEach((function(t){for(var e=t.getParent();e&&e!=n;)e.isPadding()||l.add(e),e=e.getParent()}));try{for(var u=Le(l),c=u.next();!c.done;c=u.next()){var p=c.value;try{for(var h=(i=void 0,Le(this.ctrlsService.getHeaderRowContainerCtrls())),d=h.next();!d.done;d=h.next()){if(a=d.value.getHeaderCtrlForColumn(p))break}}catch(f){i={error:f}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}a&&a.resizeLeafColumnsToFit(e)}}catch(g){r={error:g}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return[]},e.prototype.autoSizeAllColumns=function(t,e){var n=this;if(void 0===e&&(e="api"),this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return n.autoSizeAllColumns(t,e)}));else{var r=this.getAllDisplayedColumns();this.autoSizeColumns({columns:r,skipHeader:t,source:e})}},e.prototype.getColumnsFromTree=function(t){var e=[],n=function(t){for(var r=0;r<t.length;r++){var o=t[r];o instanceof ht?e.push(o):o instanceof ft&&n(o.getChildren())}};return n(t),e},e.prototype.getAllDisplayedTrees=function(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null},e.prototype.getPrimaryColumnTree=function(){return this.primaryColumnTree},e.prototype.getHeaderRowCount=function(){return this.gridHeaderRowCount},e.prototype.getDisplayedTreeLeft=function(){return this.displayedTreeLeft},e.prototype.getDisplayedTreeRight=function(){return this.displayedTreeRight},e.prototype.getDisplayedTreeCentre=function(){return this.displayedTreeCentre},e.prototype.isColumnDisplayed=function(t){return this.getAllDisplayedColumns().indexOf(t)>=0},e.prototype.getAllDisplayedColumns=function(){return this.displayedColumns},e.prototype.getViewportColumns=function(){return this.viewportColumns},e.prototype.getDisplayedLeftColumnsForRow=function(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsLeft):this.displayedColumnsLeft},e.prototype.getDisplayedRightColumnsForRow=function(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsRight):this.displayedColumnsRight},e.prototype.isColSpanActive=function(){return this.colSpanActive},e.prototype.getDisplayedColumnsForRow=function(t,e,n,r){for(var o,i=[],s=null,a=function(a){var l,u=e[a],c=e.length-a,p=Math.min(u.getColSpan(t),c),h=[u];if(p>1){for(var d=p-1,f=1;f<=d;f++)h.push(e[a+f]);a+=d}if(n?(l=!1,h.forEach((function(t){n(t)&&(l=!0)}))):l=!0,l){if(0===i.length&&s)!!r&&r(u)&&i.push(s);i.push(u)}s=u,o=a},l=0;l<e.length;l++)a(l),l=o;return i},e.prototype.getViewportCenterColumnsForRow=function(t){var e=this;if(!this.colSpanActive)return this.viewportColumnsCenter;var n=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(t,this.displayedColumnsCenter,n,(function(t){var n=t.getLeft();return o(n)&&n>e.viewportLeft}))},e.prototype.getAriaColumnIndex=function(t){return this.getAllGridColumns().indexOf(t)+1},e.prototype.isColumnInHeaderViewport=function(t){return!!t.isAutoHeaderHeight()||this.isColumnInRowViewport(t)},e.prototype.isColumnInRowViewport=function(t){if(t.isAutoHeight())return!0;var e=t.getLeft()||0,n=e+t.getActualWidth(),r=this.viewportLeft-200,o=this.viewportRight+200;return!(e<r&&n<r)&&!(e>o&&n>o)},e.prototype.getDisplayedColumnsLeftWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsLeft)},e.prototype.getDisplayedColumnsRightWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsRight)},e.prototype.updatePrimaryColumnList=function(t,e,n,r,o,i){var a=this;if(void 0===i&&(i="api"),t&&!s(t)){var l=!1;if(t.forEach((function(t){var o=a.getPrimaryColumn(t);if(o){if(n){if(e.indexOf(o)>=0)return;e.push(o)}else{if(e.indexOf(o)<0)return;Ct(e,o)}r(o),l=!0}})),l){this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(i);var u={type:o,columns:e,column:1===e.length?e[0]:null,source:i};this.eventService.dispatchEvent(u)}}},e.prototype.setRowGroupColumns=function(t,e){void 0===e&&(e="api"),this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(t,this.rowGroupColumns,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),e)},e.prototype.setRowGroupActive=function(t,e,n){t!==e.isRowGroupActive()&&(e.setRowGroupActive(t,n),t&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(e,!1,n),t||this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnVisible(e,!0,n))},e.prototype.addRowGroupColumn=function(t,e){void 0===e&&(e="api"),t&&this.addRowGroupColumns([t],e)},e.prototype.addRowGroupColumns=function(t,e){void 0===e&&(e="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,e)},e.prototype.removeRowGroupColumns=function(t,e){void 0===e&&(e="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,e)},e.prototype.removeRowGroupColumn=function(t,e){void 0===e&&(e="api"),t&&this.removeRowGroupColumns([t],e)},e.prototype.addPivotColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.pivotColumns,!0,(function(t){return t.setPivotActive(!0,e)}),Yt.EVENT_COLUMN_PIVOT_CHANGED,e)},e.prototype.setPivotColumns=function(t,e){void 0===e&&(e="api"),this.setPrimaryColumnList(t,this.pivotColumns,Yt.EVENT_COLUMN_PIVOT_CHANGED,!0,(function(t,n){n.setPivotActive(t,e)}),e)},e.prototype.addPivotColumn=function(t,e){void 0===e&&(e="api"),this.addPivotColumns([t],e)},e.prototype.removePivotColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.pivotColumns,!1,(function(t){return t.setPivotActive(!1,e)}),Yt.EVENT_COLUMN_PIVOT_CHANGED,e)},e.prototype.removePivotColumn=function(t,e){void 0===e&&(e="api"),this.removePivotColumns([t],e)},e.prototype.setPrimaryColumnList=function(t,e,n,r,i,s){var a=this,l=new Map;e.forEach((function(t,e){return l.set(t,e)})),e.length=0,o(t)&&t.forEach((function(t){var n=a.getPrimaryColumn(t);n&&e.push(n)})),e.forEach((function(t,e){var n=l.get(t);void 0!==n?r&&n!==e||l.delete(t):l.set(t,0)})),(this.primaryColumns||[]).forEach((function(t){var n=e.indexOf(t)>=0;i(n,t)})),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(s),this.dispatchColumnChangedEvent(n,Me([],De(l.keys())),s)},e.prototype.setValueColumns=function(t,e){void 0===e&&(e="api"),this.setPrimaryColumnList(t,this.valueColumns,Yt.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),e)},e.prototype.setValueActive=function(t,e,n){if(t!==e.isValueActive()&&(e.setValueActive(t,n),t&&!e.getAggFunc())){var r=this.aggFuncService.getDefaultAggFunc(e);e.setAggFunc(r)}},e.prototype.addValueColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.valueColumns,!0,this.setValueActive.bind(this,!0),Yt.EVENT_COLUMN_VALUE_CHANGED,e)},e.prototype.addValueColumn=function(t,e){void 0===e&&(e="api"),t&&this.addValueColumns([t],e)},e.prototype.removeValueColumn=function(t,e){void 0===e&&(e="api"),this.removeValueColumns([t],e)},e.prototype.removeValueColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.valueColumns,!1,this.setValueActive.bind(this,!1),Yt.EVENT_COLUMN_VALUE_CHANGED,e)},e.prototype.normaliseColumnWidth=function(t,e){var n=t.getMinWidth();o(n)&&e<n&&(e=n);var r=t.getMaxWidth();return o(r)&&t.isGreaterThanMax(e)&&(e=r),e},e.prototype.getPrimaryOrGridColumn=function(t){return this.getPrimaryColumn(t)||this.getGridColumn(t)},e.prototype.setColumnWidths=function(t,e,n,r){var o=this;void 0===r&&(r="api");var i=[];t.forEach((function(t){var n=o.getPrimaryOrGridColumn(t.key);if(n&&(i.push({width:t.newWidth,ratios:[1],columns:[n]}),"shift"===o.gridOptionsService.get("colResizeDefault")&&(e=!e),e)){var r=o.getDisplayedColAfter(n);if(!r)return;var s=n.getActualWidth()-t.newWidth,a=r.getActualWidth()+s;i.push({width:a,ratios:[1],columns:[r]})}})),0!==i.length&&this.resizeColumnSets({resizeSets:i,finished:n,source:r})},e.prototype.checkMinAndMaxWidthsForSet=function(t){var e=t.columns,n=t.width,r=0,i=0,s=!0;return e.forEach((function(t){var e=t.getMinWidth();r+=e||0;var n=t.getMaxWidth();o(n)&&n>0?i+=n:s=!1})),n>=r&&(!s||n<=i)},e.prototype.resizeColumnSets=function(t){var e=this,n=t.resizeSets,r=t.finished,i=t.source;if(!n||n.every((function(t){return e.checkMinAndMaxWidthsForSet(t)}))){var s=[],a=[];n.forEach((function(t){var e=t.width,n=t.columns,r=t.ratios,l={},u={};n.forEach((function(t){return a.push(t)}));for(var c=!0,p=0,h=function(){if(++p>1e3)return console.error("AG Grid: infinite loop in resizeColumnSets"),"break";c=!1;var t=[],i=0,s=e;n.forEach((function(e,n){if(u[e.getId()])s-=l[e.getId()];else{t.push(e);var o=r[n];i+=o}}));var a=1/i;t.forEach((function(n,i){var p;i===t.length-1?p=s:(p=Math.round(r[i]*e*a),s-=p);var h=n.getMinWidth(),d=n.getMaxWidth();o(h)&&p<h?(p=h,u[n.getId()]=!0,c=!0):o(d)&&d>0&&p>d&&(p=d,u[n.getId()]=!0,c=!0),l[n.getId()]=p}))};c;){if("break"===h())break}n.forEach((function(t){var e=l[t.getId()];t.getActualWidth()!==e&&(t.setActualWidth(e,i),s.push(t))}))}));var l=s.length>0,u=[];l&&(u=this.refreshFlexedColumns({resizingCols:a,skipSetLeft:!0}),this.setLeftValues(i),this.updateBodyWidths(),this.checkViewportColumns());var c=a.concat(u);(l||r)&&this.dispatchColumnResizedEvent(c,r,i,u)}else if(r){var p=n&&n.length>0?n[0].columns:null;this.dispatchColumnResizedEvent(p,r,i)}},e.prototype.setColumnAggFunc=function(t,e,n){if(void 0===n&&(n="api"),t){var r=this.getPrimaryColumn(t);r&&(r.setAggFunc(e),this.dispatchColumnChangedEvent(Yt.EVENT_COLUMN_VALUE_CHANGED,[r],n))}},e.prototype.moveRowGroupColumn=function(t,e,n){void 0===n&&(n="api");var r=this.rowGroupColumns[t],o=this.rowGroupColumns.slice(t,e);this.rowGroupColumns.splice(t,1),this.rowGroupColumns.splice(e,0,r);var i={type:Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:o,column:1===o.length?o[0]:null,source:n};this.eventService.dispatchEvent(i)},e.prototype.moveColumns=function(t,e,n,r){if(void 0===n&&(n="api"),void 0===r&&(r=!0),this.columnAnimationService.start(),e>this.gridColumns.length-t.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+e),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");var o=this.getGridColumns(t);!this.doesMovePassRules(o,e)||(St(this.gridColumns,o,e),this.updateDisplayedColumns(n),this.dispatchColumnMovedEvent({movedColumns:o,source:n,toIndex:e,finished:r}),this.columnAnimationService.finish())},e.prototype.doesMovePassRules=function(t,e){var n=this.getProposedColumnOrder(t,e);return this.doesOrderPassRules(n)},e.prototype.doesOrderPassRules=function(t){return!!this.doesMovePassMarryChildren(t)&&!!this.doesMovePassLockedPositions(t)},e.prototype.getProposedColumnOrder=function(t,e){var n=this.gridColumns.slice();return St(n,t,e),n},e.prototype.sortColumnsLikeGridColumns=function(t){var e=this;!t||t.length<=1||(t.filter((function(t){return e.gridColumns.indexOf(t)<0})).length>0||t.sort((function(t,n){return e.gridColumns.indexOf(t)-e.gridColumns.indexOf(n)})))},e.prototype.doesMovePassLockedPositions=function(t){var e=0,n=!0;return t.forEach((function(t){var r,o=(r=t.getColDef().lockPosition)?!0===r||"left"===r?0:2:1;o<e&&(n=!1),e=o})),n},e.prototype.doesMovePassMarryChildren=function(t){var e=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(n){if(n instanceof ft){var r=n,o=r.getColGroupDef();if(o&&o.marryChildren){var i=[];r.getLeafColumns().forEach((function(e){var n=t.indexOf(e);i.push(n)})),Math.max.apply(Math,i)-Math.min.apply(Math,i)>r.getLeafColumns().length-1&&(e=!1)}}})),e},e.prototype.moveColumn=function(t,e,n){void 0===n&&(n="api"),this.moveColumns([t],e,n)},e.prototype.moveColumnByIndex=function(t,e,n){void 0===n&&(n="api");var r=this.gridColumns[t];this.moveColumn(r,e,n)},e.prototype.getColumnDefs=function(){var t=this;if(this.primaryColumns){var e=this.primaryColumns.slice();return this.gridColsArePrimary?e.sort((function(e,n){return t.gridColumns.indexOf(e)-t.gridColumns.indexOf(n)})):this.lastPrimaryOrder&&e.sort((function(e,n){return t.lastPrimaryOrder.indexOf(e)-t.lastPrimaryOrder.indexOf(n)})),this.columnDefFactory.buildColumnDefs(e,this.rowGroupColumns,this.pivotColumns)}},e.prototype.getBodyContainerWidth=function(){return this.bodyWidth},e.prototype.getContainerWidth=function(t){switch(t){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}},e.prototype.updateBodyWidths=function(){var t=this.getWidthOfColsInList(this.displayedColumnsCenter),e=this.getWidthOfColsInList(this.displayedColumnsLeft),n=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==t,this.bodyWidth!==t||this.leftWidth!==e||this.rightWidth!==n){this.bodyWidth=t,this.leftWidth=e,this.rightWidth=n;var r={type:Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(r)}},e.prototype.getValueColumns=function(){return this.valueColumns?this.valueColumns:[]},e.prototype.getPivotColumns=function(){return this.pivotColumns?this.pivotColumns:[]},e.prototype.isPivotActive=function(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode},e.prototype.getRowGroupColumns=function(){return this.rowGroupColumns?this.rowGroupColumns:[]},e.prototype.getDisplayedCenterColumns=function(){return this.displayedColumnsCenter},e.prototype.getDisplayedLeftColumns=function(){return this.displayedColumnsLeft},e.prototype.getDisplayedRightColumns=function(){return this.displayedColumnsRight},e.prototype.getDisplayedColumns=function(t){switch(t){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}},e.prototype.getAllPrimaryColumns=function(){return this.primaryColumns?this.primaryColumns.slice():null},e.prototype.getSecondaryColumns=function(){return this.secondaryColumns?this.secondaryColumns.slice():null},e.prototype.getAllColumnsForQuickFilter=function(){return this.columnsForQuickFilter},e.prototype.getAllGridColumns=function(){return this.gridColumns},e.prototype.isEmpty=function(){return s(this.gridColumns)},e.prototype.isRowGroupEmpty=function(){return s(this.rowGroupColumns)},e.prototype.setColumnVisible=function(t,e,n){void 0===n&&(n="api"),this.setColumnsVisible([t],e,n)},e.prototype.setColumnsVisible=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n="api"),this.applyColumnState({state:t.map((function(t){return{colId:"string"===typeof t?t:t.getColId(),hide:!e}}))},n)},e.prototype.setColumnPinned=function(t,e,n){void 0===n&&(n="api"),t&&this.setColumnsPinned([t],e,n)},e.prototype.setColumnsPinned=function(t,e,n){var r;(void 0===n&&(n="api"),this.gridOptionsService.isDomLayout("print"))?console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'"):(this.columnAnimationService.start(),r=!0===e||"left"===e?"left":"right"===e?"right":null,this.actionOnGridColumns(t,(function(t){return t.getPinned()!==r&&(t.setPinned(r),!0)}),n,(function(){return{type:Yt.EVENT_COLUMN_PINNED,pinned:r,column:null,columns:null,source:n}})),this.columnAnimationService.finish())},e.prototype.actionOnGridColumns=function(t,e,n,r){var i=this;if(!s(t)){var a=[];if(t.forEach((function(t){var n=i.getGridColumn(t);n&&(!1!==e(n)&&a.push(n))})),a.length&&(this.updateDisplayedColumns(n),o(r)&&r)){var l=r();l.columns=a,l.column=1===a.length?a[0]:null,this.eventService.dispatchEvent(l)}}},e.prototype.getDisplayedColBefore=function(t){var e=this.getAllDisplayedColumns(),n=e.indexOf(t);return n>0?e[n-1]:null},e.prototype.getDisplayedColAfter=function(t){var e=this.getAllDisplayedColumns(),n=e.indexOf(t);return n<e.length-1?e[n+1]:null},e.prototype.getDisplayedGroupAfter=function(t){return this.getDisplayedGroupAtDirection(t,"After")},e.prototype.getDisplayedGroupBefore=function(t){return this.getDisplayedGroupAtDirection(t,"Before")},e.prototype.getDisplayedGroupAtDirection=function(t,e){for(var n=t.getProvidedColumnGroup().getLevel()+t.getPaddingLevel(),r=t.getDisplayedLeafColumns(),o="After"===e?yt(r):r[0],i="getDisplayedCol"+e;;){var s=this[i](o);if(!s)return null;var a=this.getColumnGroupAtLevel(s,n);if(a!==t)return a}},e.prototype.getColumnGroupAtLevel=function(t,e){for(var n=t.getParent();;){if(n.getProvidedColumnGroup().getLevel()+n.getPaddingLevel()<=e)break;n=n.getParent()}return n},e.prototype.isPinningLeft=function(){return this.displayedColumnsLeft.length>0},e.prototype.isPinningRight=function(){return this.displayedColumnsRight.length>0},e.prototype.getPrimaryAndSecondaryAndAutoColumns=function(){var t;return(t=[]).concat.apply(t,[this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[]])},e.prototype.createStateItemFromColumn=function(t){var e=t.isRowGroupActive()?this.rowGroupColumns.indexOf(t):null,n=t.isPivotActive()?this.pivotColumns.indexOf(t):null,r=t.isValueActive()?t.getAggFunc():null,o=null!=t.getSort()?t.getSort():null,i=null!=t.getSortIndex()?t.getSortIndex():null,s=null!=t.getFlex()&&t.getFlex()>0?t.getFlex():null;return{colId:t.getColId(),width:t.getActualWidth(),hide:!t.isVisible(),pinned:t.getPinned(),sort:o,sortIndex:i,aggFunc:r,rowGroup:t.isRowGroupActive(),rowGroupIndex:e,pivot:t.isPivotActive(),pivotIndex:n,flex:s}},e.prototype.getColumnState=function(){if(i(this.primaryColumns)||!this.isAlive())return[];var t=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(t),t},e.prototype.orderColumnStateList=function(t){var e=ae(this.gridColumns.map((function(t,e){return[t.getColId(),e]})));t.sort((function(t,n){return(e.has(t.colId)?e.get(t.colId):-1)-(e.has(n.colId)?e.get(n.colId):-1)}))},e.prototype.resetColumnState=function(t){var e=this;void 0===t&&(t="api");var n=this.getColumnsFromTree(this.primaryColumnTree),r=[],o=1e3,s=1e3,a=[];this.groupAutoColumns&&(a=a.concat(this.groupAutoColumns)),n&&(a=a.concat(n)),a.forEach((function(t){var n=e.getColumnStateFromColDef(t);i(n.rowGroupIndex)&&n.rowGroup&&(n.rowGroupIndex=o++),i(n.pivotIndex)&&n.pivot&&(n.pivotIndex=s++),r.push(n)})),this.applyColumnState({state:r,applyOrder:!0},t)},e.prototype.getColumnStateFromColDef=function(t){var e=function(t,e){return null!=t?t:null!=e?e:null},n=t.getColDef(),r=e(n.sort,n.initialSort),o=e(n.sortIndex,n.initialSortIndex),i=e(n.hide,n.initialHide),s=e(n.pinned,n.initialPinned),a=e(n.width,n.initialWidth),l=e(n.flex,n.initialFlex),u=e(n.rowGroupIndex,n.initialRowGroupIndex),c=e(n.rowGroup,n.initialRowGroup);null!=u||null!=c&&0!=c||(u=null,c=null);var p=e(n.pivotIndex,n.initialPivotIndex),h=e(n.pivot,n.initialPivot);null!=p||null!=h&&0!=h||(p=null,h=null);var d=e(n.aggFunc,n.initialAggFunc);return{colId:t.getColId(),sort:r,sortIndex:o,hide:i,pinned:s,width:a,flex:l,rowGroup:c,rowGroupIndex:u,pivot:h,pivotIndex:p,aggFunc:d}},e.prototype.applyColumnState=function(t,e){var n=this;if(s(this.primaryColumns))return!1;if(t&&t.state&&!t.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;var r=function(r,o,i){var s=n.compareColumnStatesAndDispatchEvents(e);n.autoGroupsNeedBuilding=!0;var a=o.slice(),l={},u={},c=[],p=[],h=0,d=n.rowGroupColumns.slice(),f=n.pivotColumns.slice();r.forEach((function(r){var o=r.colId||"";if(o.startsWith($t))return c.push(r),void p.push(r);var s=i(o);s?(n.syncColumnWithStateItem(s,r,t.defaultState,l,u,!1,e),Ct(a,s)):(p.push(r),h+=1)}));var g=function(r){return n.syncColumnWithStateItem(r,null,t.defaultState,l,u,!1,e)};a.forEach(g);var m=function(t,e,n,r){var o=t[n.getId()],i=t[r.getId()],s=null!=o,a=null!=i;if(s&&a)return o-i;if(s)return-1;if(a)return 1;var l=e.indexOf(n),u=e.indexOf(r),c=l>=0;return c&&u>=0?l-u:c?-1:1};n.rowGroupColumns.sort(m.bind(n,l,d)),n.pivotColumns.sort(m.bind(n,u,f)),n.updateGridColumns();var y=n.groupAutoColumns?n.groupAutoColumns.slice():[];return c.forEach((function(r){var o=n.getAutoColumn(r.colId);Ct(y,o),n.syncColumnWithStateItem(o,r,t.defaultState,null,null,!0,e)})),y.forEach(g),n.applyOrderAfterApplyState(t),n.updateDisplayedColumns(e),n.dispatchEverythingChanged(e),s(),{unmatchedAndAutoStates:p,unmatchedCount:h}};this.columnAnimationService.start();var i=r(t.state||[],this.primaryColumns||[],(function(t){return n.getPrimaryColumn(t)})),a=i.unmatchedAndAutoStates,l=i.unmatchedCount;return(a.length>0||o(t.defaultState))&&(l=r(a,this.secondaryColumns||[],(function(t){return n.getSecondaryColumn(t)})).unmatchedCount),this.columnAnimationService.finish(),0===l},e.prototype.applyOrderAfterApplyState=function(t){var e=this;if(t.applyOrder&&t.state){var n=[],r={};t.state.forEach((function(t){if(t.colId&&!r[t.colId]){var o=e.gridColumnsMap[t.colId];o&&(n.push(o),r[t.colId]=!0)}}));var o=0;this.gridColumns.forEach((function(t){var e=t.getColId();null!=r[e]||(e.startsWith($t)?Et(n,t,o++):n.push(t))})),n=this.placeLockedColumns(n),this.doesMovePassMarryChildren(n)?this.gridColumns=n:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}},e.prototype.compareColumnStatesAndDispatchEvents=function(t){var e=this,n={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},r=this.getColumnState(),o={};return r.forEach((function(t){o[t.colId]=t})),function(){var i=e.getPrimaryAndSecondaryAndAutoColumns(),s=function(n,r,o,i){if(!vt(r.map(i),o.map(i))){var s=new Set(r);o.forEach((function(t){s.delete(t)||s.add(t)}));var a=Me([],De(s)),l={type:n,columns:a,column:1===a.length?a[0]:null,source:t};e.eventService.dispatchEvent(l)}},a=function(t){var e=[];return i.forEach((function(n){var r=o[n.getColId()];r&&t(r,n)&&e.push(n)})),e},l=function(t){return t.getColId()};s(Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,n.rowGroupColumns,e.rowGroupColumns,l),s(Yt.EVENT_COLUMN_PIVOT_CHANGED,n.pivotColumns,e.pivotColumns,l);var u=a((function(t,e){var n=null!=t.aggFunc,r=n!=e.isValueActive(),o=n&&t.aggFunc!=e.getAggFunc();return r||o}));u.length>0&&e.dispatchColumnChangedEvent(Yt.EVENT_COLUMN_VALUE_CHANGED,u,t);e.dispatchColumnResizedEvent(a((function(t,e){return t.width!=e.getActualWidth()})),!0,t);e.dispatchColumnPinnedEvent(a((function(t,e){return t.pinned!=e.getPinned()})),t);e.dispatchColumnVisibleEvent(a((function(t,e){return t.hide==e.isVisible()})),t);a((function(t,e){return t.sort!=e.getSort()||t.sortIndex!=e.getSortIndex()})).length>0&&e.sortController.dispatchSortChangedEvents(t),e.normaliseColumnMovedEventForColumnState(r,t)}},e.prototype.getCommonValue=function(t,e){if(t&&0!=t.length){for(var n=e(t[0]),r=1;r<t.length;r++)if(n!==e(t[r]))return;return n}},e.prototype.normaliseColumnMovedEventForColumnState=function(t,e){var n=this,r=this.getColumnState(),o={};r.forEach((function(t){return o[t.colId]=t}));var i={};t.forEach((function(t){o[t.colId]&&(i[t.colId]=!0)}));var s=t.filter((function(t){return i[t.colId]})),a=r.filter((function(t){return i[t.colId]})),l=[];a.forEach((function(t,e){var r=s&&s[e];if(r&&r.colId!==t.colId){var o=n.getGridColumn(r.colId);o&&l.push(o)}})),l.length&&this.dispatchColumnMovedEvent({movedColumns:l,source:e,finished:!0})},e.prototype.syncColumnWithStateItem=function(t,e,n,r,i,s,a){if(t){var l=function(t,r){var i={value1:void 0,value2:void 0},s=!1;return e&&(void 0!==e[t]&&(i.value1=e[t],s=!0),o(r)&&void 0!==e[r]&&(i.value2=e[r],s=!0)),!s&&n&&(void 0!==n[t]&&(i.value1=n[t]),o(r)&&void 0!==n[r]&&(i.value2=n[r])),i},u=l("hide").value1;void 0!==u&&t.setVisible(!u,a);var c=l("pinned").value1;void 0!==c&&t.setPinned(c);var p=this.columnUtils.calculateColMinWidth(t.getColDef()),h=l("flex").value1;if(void 0!==h&&t.setFlex(h),t.getFlex()<=0){var d=l("width").value1;null!=d&&null!=p&&d>=p&&t.setActualWidth(d,a)}var f=l("sort").value1;void 0!==f&&("desc"===f||"asc"===f?t.setSort(f,a):t.setSort(void 0,a));var g=l("sortIndex").value1;if(void 0!==g&&t.setSortIndex(g),!s&&t.isPrimary()){var m=l("aggFunc").value1;void 0!==m&&("string"===typeof m?(t.setAggFunc(m),t.isValueActive()||(t.setValueActive(!0,a),this.valueColumns.push(t))):(o(m)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),t.isValueActive()&&(t.setValueActive(!1,a),Ct(this.valueColumns,t))));var y=l("rowGroup","rowGroupIndex"),v=y.value1,_=y.value2;void 0===v&&void 0===_||("number"===typeof _||v?(t.isRowGroupActive()||(t.setRowGroupActive(!0,a),this.rowGroupColumns.push(t)),r&&"number"===typeof _&&(r[t.getId()]=_)):t.isRowGroupActive()&&(t.setRowGroupActive(!1,a),Ct(this.rowGroupColumns,t)));var w=l("pivot","pivotIndex"),C=w.value1,b=w.value2;void 0===C&&void 0===b||("number"===typeof b||C?(t.isPivotActive()||(t.setPivotActive(!0,a),this.pivotColumns.push(t)),i&&"number"===typeof b&&(i[t.getId()]=b)):t.isPivotActive()&&(t.setPivotActive(!1,a),Ct(this.pivotColumns,t)))}}},e.prototype.getGridColumns=function(t){return this.getColumns(t,this.getGridColumn.bind(this))},e.prototype.getColumns=function(t,e){var n=[];return t&&t.forEach((function(t){var r=e(t);r&&n.push(r)})),n},e.prototype.getColumnWithValidation=function(t){if(null==t)return null;var e=this.getGridColumn(t);return e||console.warn("AG Grid: could not find column "+t),e},e.prototype.getPrimaryColumn=function(t){return this.primaryColumns?this.getColumn(t,this.primaryColumns,this.primaryColumnsMap):null},e.prototype.getGridColumn=function(t){return this.getColumn(t,this.gridColumns,this.gridColumnsMap)},e.prototype.getSecondaryColumn=function(t){return this.secondaryColumns?this.getColumn(t,this.secondaryColumns,this.secondaryColumnsMap):null},e.prototype.getColumn=function(t,e,n){if(!t)return null;if("string"==typeof t&&n[t])return n[t];for(var r=0;r<e.length;r++)if(this.columnsMatch(e[r],t))return e[r];return this.getAutoColumn(t)},e.prototype.getSourceColumnsForGroupColumn=function(t){var e=t.getColDef().showRowGroup;if(!e)return null;if(!0===e)return this.rowGroupColumns.slice(0);var n=this.getPrimaryColumn(e);return n?[n]:null},e.prototype.getAutoColumn=function(t){var e=this;return this.groupAutoColumns&&o(this.groupAutoColumns)&&!i(this.groupAutoColumns)&&this.groupAutoColumns.find((function(n){return e.columnsMatch(n,t)}))||null},e.prototype.columnsMatch=function(t,e){var n=t===e,r=t.getColDef()===e,o=t.getColId()==e;return n||r||o},e.prototype.getDisplayNameForColumn=function(t,e,n){if(void 0===n&&(n=!1),!t)return null;var r=this.getHeaderName(t.getColDef(),t,null,null,e);return n?this.wrapHeaderNameWithAggFunc(t,r):r},e.prototype.getDisplayNameForProvidedColumnGroup=function(t,e,n){var r=e?e.getColGroupDef():null;return r?this.getHeaderName(r,null,t,e,n):null},e.prototype.getDisplayNameForColumnGroup=function(t,e){return this.getDisplayNameForProvidedColumnGroup(t,t.getProvidedColumnGroup(),e)},e.prototype.getHeaderName=function(t,e,n,r,o){var i=t.headerValueGetter;if(i){var s={colDef:t,column:e,columnGroup:n,providedColumnGroup:r,location:o,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"===typeof i?i(s):"string"===typeof i?this.expressionService.evaluate(i,s):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=t.headerName?t.headerName:t.field?oe(t.field):""},e.prototype.wrapHeaderNameWithAggFunc=function(t,e){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return e;var n,r=t.getColDef().pivotValueColumn,i=null;if(o(r)){var s=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,a=void 0!==t.getColDef().pivotTotalColumnIds;if(s&&!a)return e;i=r?r.getAggFunc():null,n=!0}else{var l=t.isValueActive(),u=this.pivotMode||!this.isRowGroupEmpty();l&&u?(i=t.getAggFunc(),n=!0):n=!1}if(n){var c="string"===typeof i?i:"func";return this.localeService.getLocaleTextFunc()(c,c)+"("+e+")"}return e},e.prototype.getColumnGroup=function(t,e){if(!t)return null;if(t instanceof Kt)return t;var n=this.getAllDisplayedTrees(),r="number"===typeof e,o=null;return this.columnUtils.depthFirstAllColumnTreeSearch(n,(function(n){if(n instanceof Kt){var i=n;(r?t===i.getGroupId()&&e===i.getPartId():t===i.getGroupId())&&(o=i)}})),o},e.prototype.isReady=function(){return this.ready},e.prototype.extractValueColumns=function(t,e){this.valueColumns=this.extractColumns(e,this.valueColumns,(function(e,n){return e.setValueActive(n,t)}),(function(){}),(function(){}),(function(t){var e=t.aggFunc;return null===e||""===e?null:void 0!==e?!!e:void 0}),(function(t){return null!=t.initialAggFunc&&""!=t.initialAggFunc})),this.valueColumns.forEach((function(t){var e=t.getColDef();null!=e.aggFunc&&""!=e.aggFunc?t.setAggFunc(e.aggFunc):t.getAggFunc()||t.setAggFunc(e.initialAggFunc)}))},e.prototype.extractRowGroupColumns=function(t,e){this.rowGroupColumns=this.extractColumns(e,this.rowGroupColumns,(function(e,n){return e.setRowGroupActive(n,t)}),(function(t){return t.rowGroupIndex}),(function(t){return t.initialRowGroupIndex}),(function(t){return t.rowGroup}),(function(t){return t.initialRowGroup}))},e.prototype.extractColumns=function(t,e,n,r,o,i,s){void 0===t&&(t=[]),void 0===e&&(e=[]);var a=[],c=[];(this.primaryColumns||[]).forEach((function(n){var p=t.indexOf(n)<0,h=n.getColDef(),d=u(i(h)),f=u(s(h)),g=l(r(h)),m=l(o(h));(void 0!==d?d:void 0!==g?null!==g&&g>=0:p?void 0!==f?f:!!(void 0!==m)&&(null!=m&&m>=0):e.indexOf(n)>=0)&&((p?null!=g||null!=m:null!=g)?a.push(n):c.push(n))}));var p=function(t){var e=r(t.getColDef()),n=o(t.getColDef());return null!=e?e:n};a.sort((function(t,e){var n=p(t),r=p(e);return n===r?0:n<r?-1:1}));var h=[].concat(a);return e.forEach((function(t){c.indexOf(t)>=0&&h.push(t)})),c.forEach((function(t){h.indexOf(t)<0&&h.push(t)})),e.forEach((function(t){h.indexOf(t)<0&&n(t,!1)})),h.forEach((function(t){e.indexOf(t)<0&&n(t,!0)})),h},e.prototype.extractPivotColumns=function(t,e){this.pivotColumns=this.extractColumns(e,this.pivotColumns,(function(e,n){return e.setPivotActive(n,t)}),(function(t){return t.pivotIndex}),(function(t){return t.initialPivotIndex}),(function(t){return t.pivot}),(function(t){return t.initialPivot}))},e.prototype.resetColumnGroupState=function(t){void 0===t&&(t="api");var e=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,(function(t){if(t instanceof ft){var n=t.getColGroupDef(),r={groupId:t.getGroupId(),open:n?n.openByDefault:void 0};e.push(r)}})),this.setColumnGroupState(e,t)},e.prototype.getColumnGroupState=function(){var t=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(e){e instanceof ft&&t.push({groupId:e.getGroupId(),open:e.isExpanded()})})),t},e.prototype.setColumnGroupState=function(t,e){var n=this;void 0===e&&(e="api"),this.columnAnimationService.start();var r=[];t.forEach((function(t){var e=t.groupId,o=t.open,i=n.getProvidedColumnGroup(e);i&&i.isExpanded()!==o&&(n.logger.log("columnGroupOpened("+i.getGroupId()+","+o+")"),i.setExpanded(o),r.push(i))})),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e),r.forEach((function(t){var e={type:Yt.EVENT_COLUMN_GROUP_OPENED,columnGroup:t};n.eventService.dispatchEvent(e)})),this.columnAnimationService.finish()},e.prototype.setColumnGroupOpened=function(t,e,n){var r;void 0===n&&(n="api"),r=t instanceof ft?t.getId():t||"",this.setColumnGroupState([{groupId:r,open:e}],n)},e.prototype.getProvidedColumnGroup=function(t){"string"!==typeof t&&console.error("AG Grid: group key must be a string");var e=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(n){n instanceof ft&&n.getId()===t&&(e=n)})),e},e.prototype.calculateColumnsForDisplay=function(){var t=this;return this.pivotMode&&i(this.secondaryColumns)?this.gridColumns.filter((function(e){var n=t.groupAutoColumns&&Tt(t.groupAutoColumns,e),r=t.valueColumns&&Tt(t.valueColumns,e);return n||r})):this.gridColumns.filter((function(e){return t.groupAutoColumns&&Tt(t.groupAutoColumns,e)||e.isVisible()}))},e.prototype.checkColSpanActiveInCols=function(t){var e=!1;return t.forEach((function(t){o(t.getColDef().colSpan)&&(e=!0)})),e},e.prototype.calculateColumnsForGroupDisplay=function(){var t=this;this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};this.gridColumns.forEach((function(e){var n=e.getColDef(),r=n.showRowGroup;n&&o(r)&&(t.groupDisplayColumns.push(e),"string"===typeof r?t.groupDisplayColumnsMap[r]=e:!0===r&&t.getRowGroupColumns().forEach((function(n){t.groupDisplayColumnsMap[n.getId()]=e})))}))},e.prototype.getGroupDisplayColumns=function(){return this.groupDisplayColumns},e.prototype.getGroupDisplayColumnForGroup=function(t){return this.groupDisplayColumnsMap[t]},e.prototype.updateDisplayedColumns=function(t){var e=this.calculateColumnsForDisplay();this.buildDisplayedTrees(e),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t)},e.prototype.isSecondaryColumnsPresent=function(){return o(this.secondaryColumns)},e.prototype.setSecondaryColumns=function(t,e){var n=this;void 0===e&&(e="api");var r=t&&t.length>0;if(r||!i(this.secondaryColumns)){if(r){this.processSecondaryColumnDefinitions(t);var o=this.columnFactory.createColumnTree(t,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,o.columnTree),this.secondaryBalancedTree=o.columnTree,this.secondaryHeaderRowCount=o.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach((function(t){return n.secondaryColumnsMap[t.getId()]=t})),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(e)}},e.prototype.processSecondaryColumnDefinitions=function(t){var e=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),n=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(e||n){var r=function(t){t.forEach((function(t){if(o(t.children)){var i=t;n&&n(i),r(i.children)}else{e&&e(t)}}))};t&&r(t)}},e.prototype.updateGridColumns=function(){var t,e=this,n=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){var r=this.secondaryColumns.every((function(t){return void 0!==e.gridColumnsMap[t.getColId()]}));this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,r&&(t=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,t=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&t){var o=ae(this.groupAutoColumns.map((function(t){return[t,!0]})));t=t.filter((function(t){return!o.has(t)})),t=Me(Me([],De(this.groupAutoColumns)),De(t))}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(t),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach((function(t){return e.gridColumnsMap[t.getId()]=t})),this.setAutoHeightActive(),!vt(n,this.gridBalancedTree)){var i={type:Yt.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(i)}},e.prototype.setAutoHeightActive=function(){if((this.autoHeightActive=this.gridColumns.filter((function(t){return t.isAutoHeight()})).length>0,this.autoHeightActive)&&(this.autoHeightActiveAtLeastOnce=!0,!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide")))){O((function(){return console.warn("AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}),"autoHeightActive.wrongRowModel")}},e.prototype.orderGridColsLike=function(t){if(!i(t)){var e=ae(t.map((function(t,e){return[t,e]}))),n=!0;if(this.gridColumns.forEach((function(t){e.has(t)&&(n=!1)})),!n){var r=ae(this.gridColumns.map((function(t){return[t,!0]}))),o=t.filter((function(t){return r.has(t)})),s=ae(o.map((function(t){return[t,!0]}))),a=this.gridColumns.filter((function(t){return!s.has(t)})),l=o.slice();a.forEach((function(t){var e=t.getOriginalParent();if(e){for(var n=[];!n.length&&e;){e.getLeafColumns().forEach((function(t){var e=l.indexOf(t)>=0,r=n.indexOf(t)<0;e&&r&&n.push(t)})),e=e.getOriginalParent()}if(n.length){var r=n.map((function(t){return l.indexOf(t)})),o=Math.max.apply(Math,Me([],De(r)));Et(l,t,o+1)}else l.push(t)}else l.push(t)})),this.gridColumns=l}}},e.prototype.isPrimaryColumnGroupsPresent=function(){return this.primaryHeaderRowCount>1},e.prototype.refreshQuickFilterColumns=function(){var t,e=null!==(t=this.isPivotMode()?this.secondaryColumns:this.primaryColumns)&&void 0!==t?t:[];this.groupAutoColumns&&(e=e.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")?e:e.filter((function(t){return t.isVisible()||t.isRowGroupActive()}))},e.prototype.placeLockedColumns=function(t){var e=[],n=[],r=[];return t.forEach((function(t){var o=t.getColDef().lockPosition;"right"===o?r.push(t):"left"===o||!0===o?e.push(t):n.push(t)})),Me(Me(Me([],De(e)),De(n)),De(r))},e.prototype.addAutoGroupToGridColumns=function(){if(i(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;var t=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,t),this.groupAutoColsBalancedTree=t,this.gridBalancedTree=t.concat(this.gridBalancedTree)},e.prototype.clearDisplayedAndViewportColumns=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""},e.prototype.updateGroupsAndDisplayedColumns=function(t){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(t),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();var e={type:Yt.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.deriveDisplayedColumns=function(t){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(t),this.displayedAutoHeightCols=this.displayedColumns.filter((function(t){return t.isAutoHeight()}))},e.prototype.isAutoRowHeightActive=function(){return this.autoHeightActive},e.prototype.wasAutoRowHeightEverActive=function(){return this.autoHeightActiveAtLeastOnce},e.prototype.joinDisplayedColumns=function(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)},e.prototype.setLeftValues=function(t){this.setLeftValuesOfColumns(t),this.setLeftValuesOfGroups()},e.prototype.setLeftValuesOfColumns=function(t){var e=this;if(this.primaryColumns){var n=this.primaryColumns.slice(0),r=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach((function(o){if(r){var i=e.getWidthOfColsInList(o);o.forEach((function(e){i-=e.getActualWidth(),e.setLeft(i,t)}))}else{var s=0;o.forEach((function(e){e.setLeft(s,t),s+=e.getActualWidth()}))}bt(n,o)})),n.forEach((function(e){e.setLeft(null,t)}))}},e.prototype.setLeftValuesOfGroups=function(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach((function(t){t.forEach((function(t){t instanceof Kt&&t.checkLeft()}))}))},e.prototype.derivedDisplayedColumnsFromDisplayedTree=function(t,e){e.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(t,(function(t){t instanceof ht&&e.push(t)}))},e.prototype.extractViewportColumns=function(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)},e.prototype.getVirtualHeaderGroupRow=function(t,e){var n;switch(t){case"left":n=this.viewportRowLeft[e];break;case"right":n=this.viewportRowRight[e];break;default:n=this.viewportRowCenter[e]}return i(n)&&(n=[]),n},e.prototype.calculateHeaderRows=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};var t={};this.headerViewportColumns.forEach((function(e){return t[e.getId()]=!0}));var e=function(n,r,o){for(var i=!1,s=0;s<n.length;s++){var a=n[s],l=!1;if(a instanceof ht)l=!0===t[a.getId()];else{var u=a.getDisplayedChildren();u&&(l=e(u,r,o+1))}l&&(i=!0,r[o]||(r[o]=[]),r[o].push(a))}return i};e(this.displayedTreeLeft,this.viewportRowLeft,0),e(this.displayedTreeRight,this.viewportRowRight,0),e(this.displayedTreeCentre,this.viewportRowCenter,0)},e.prototype.extractViewport=function(){this.extractViewportColumns();var t=this.viewportColumns.map((function(t){return t.getId()+"-"+(t.getPinned()||"normal")})).join("#"),e=this.viewportColumnsHash!==t;return e&&(this.viewportColumnsHash=t,this.calculateHeaderRows()),e},e.prototype.refreshFlexedColumns=function(t){var e;void 0===t&&(t={});var n=t.source?t.source:"flex";if(null!=t.viewportWidth&&(this.flexViewportWidth=t.viewportWidth),!this.flexViewportWidth)return[];var r=-1;if(t.resizingCols)for(var i=new Set(t.resizingCols),s=this.displayedColumnsCenter,a=s.length-1;a>=0;a--)if(i.has(s[a])){r=a;break}var l=0,u=[],c=0,p=0;for(a=0;a<this.displayedColumnsCenter.length;a++){this.displayedColumnsCenter[a].getFlex()&&a>r?(u.push(this.displayedColumnsCenter[a]),p+=this.displayedColumnsCenter[a].getFlex(),c+=null!==(e=this.displayedColumnsCenter[a].getMinWidth())&&void 0!==e?e:0):l+=this.displayedColumnsCenter[a].getActualWidth()}if(!u.length)return[];var h=[];l+c>this.flexViewportWidth&&(u.forEach((function(t){var e;return t.setActualWidth(null!==(e=t.getMinWidth())&&void 0!==e?e:0,n)})),h=u,u=[]);var d,f=[];t:for(;;){var g=(d=this.flexViewportWidth-l)/p;for(a=0;a<u.length;a++){var m=u[a],y=g*m.getFlex(),v=0,_=m.getMinWidth(),w=m.getMaxWidth();if(o(_)&&y<_?v=_:o(w)&&y>w&&(v=w),v){m.setActualWidth(v,n),wt(u,m),p-=m.getFlex(),h.push(m),l+=m.getActualWidth();continue t}f[a]=Math.round(y)}break}var C=d;return u.forEach((function(t,e){t.setActualWidth(Math.min(f[e],C),n),h.push(t),C-=f[e]})),t.skipSetLeft||this.setLeftValues(n),t.updateBodyWidths&&this.updateBodyWidths(),t.fireResizedEvent&&this.dispatchColumnResizedEvent(h,!0,n,u),u},e.prototype.sizeColumnsToFit=function(t,e,n,r){var i,s,a,l,u,c=this;if(void 0===e&&(e="sizeColumnsToFit"),this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return c.sizeColumnsToFit(t,e,n,r)}));else{var p={};r&&(null===(i=null===r||void 0===r?void 0:r.columnLimits)||void 0===i||i.forEach((function(t){var e=t.key,n=Ae(t,["key"]);p["string"===typeof e?e:e.getColId()]=n})));var h=this.getAllDisplayedColumns(),d=t===this.getWidthOfColsInList(h);if(!(t<=0||!h.length||d)){var f=[],g=[];h.forEach((function(t){!0===t.getColDef().suppressSizeToFit?g.push(t):f.push(t)}));var m=f.slice(0),y=!1,v=function(t){Ct(f,t),g.push(t)};for(f.forEach((function(t){var n,o;t.resetActualWidth(e);var i=null===p||void 0===p?void 0:p[t.getId()],s=null!==(n=null===i||void 0===i?void 0:i.minWidth)&&void 0!==n?n:null===r||void 0===r?void 0:r.defaultMinWidth,a=null!==(o=null===i||void 0===i?void 0:i.maxWidth)&&void 0!==o?o:null===r||void 0===r?void 0:r.defaultMaxWidth,l=t.getActualWidth();"number"===typeof s&&l<s?t.setActualWidth(s,e,!0):"number"===typeof a&&l>a&&t.setActualWidth(a,e,!0)}));!y;){y=!0;var _=t-this.getWidthOfColsInList(g);if(_<=0)f.forEach((function(t){var n,o,i=null!==(o=null===(n=null===p||void 0===p?void 0:p[t.getId()])||void 0===n?void 0:n.minWidth)&&void 0!==o?o:null===r||void 0===r?void 0:r.defaultMinWidth;"number"!==typeof i?t.setMinimum(e):t.setActualWidth(i,e,!0)}));else for(var w=_/this.getWidthOfColsInList(f),C=_,b=f.length-1;b>=0;b--){var x=f[b],E=null===p||void 0===p?void 0:p[x.getId()],S=null!==(s=null===E||void 0===E?void 0:E.minWidth)&&void 0!==s?s:null===r||void 0===r?void 0:r.defaultMinWidth,T=null!==(a=null===E||void 0===E?void 0:E.maxWidth)&&void 0!==a?a:null===r||void 0===r?void 0:r.defaultMaxWidth,R=null!==(l=x.getMinWidth())&&void 0!==l?l:0,P=null!==(u=x.getMaxWidth())&&void 0!==u?u:Number.MAX_VALUE,O="number"===typeof S&&S>R?S:x.getMinWidth(),I="number"===typeof T&&T<P?T:x.getMaxWidth(),A=Math.round(x.getActualWidth()*w);o(O)&&A<O?(A=O,v(x),y=!1):o(I)&&A>I?(A=I,v(x),y=!1):0===b&&(A=C),x.setActualWidth(A,e,!0),C-=A}}m.forEach((function(t){t.fireColumnWidthChangedEvent(e)})),this.setLeftValues(e),this.updateBodyWidths(),n||this.dispatchColumnResizedEvent(m,!0,e)}}},e.prototype.buildDisplayedTrees=function(t){var e=[],n=[],r=[];t.forEach((function(t){switch(t.getPinned()){case"left":e.push(t);break;case"right":n.push(t);break;default:r.push(t)}}));var o=new Zt;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(e,o,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(n,o,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(r,o,null,this.displayedTreeCentre),this.updateDisplayedMap()},e.prototype.updateDisplayedMap=function(){var t=this;this.displayedColumnsAndGroupsMap={};var e=function(e){t.displayedColumnsAndGroupsMap[e.getUniqueId()]=e};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,e)},e.prototype.isDisplayed=function(t){return this.displayedColumnsAndGroupsMap[t.getUniqueId()]===t},e.prototype.updateOpenClosedVisibilityInColumnGroups=function(){var t=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(t,(function(t){t instanceof Kt&&t.calculateDisplayedColumns()}))},e.prototype.getGroupAutoColumns=function(){return this.groupAutoColumns},e.prototype.createGroupAutoColumnsIfNeeded=function(){var t=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;var e=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),n=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!n&&!e){var r=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(r,this.groupAutoColumns)||t)return this.groupAutoColumns=r,!0}else this.groupAutoColumns=null;return!1},e.prototype.isGroupSuppressAutoColumn=function(){var t=this.gridOptionsService.get("groupDisplayType");if(!!t&&Re("custom",t))return!0;var e=this.gridOptionsService.get("treeDataDisplayType");return!!e&&function(t,e){var n=["auto","custom"];return n.indexOf(e)<0?(console.warn("AG Grid: '"+e+"' is not a valid treeDataDisplayType value - possible values are: '"+n.join("', '")+"'"),!1):e===t}("custom",e)},e.prototype.autoColsEqual=function(t,e){return vt(t,e,(function(t,e){return t.getColId()===e.getColId()}))},e.prototype.getWidthOfColsInList=function(t){return t.reduce((function(t,e){return t+e.getActualWidth()}),0)},e.prototype.getGridBalancedTree=function(){return this.gridBalancedTree},e.prototype.getFirstDisplayedColumn=function(){var t=this.gridOptionsService.is("enableRtl"),e=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];t&&e.reverse();for(var n=0;n<e.length;n++){var r=this[e[n]]();if(r.length)return t?yt(r):r[0]}return null},e.prototype.setColumnHeaderHeight=function(t,e){if(t.setAutoHeaderHeight(e)){var n={type:Yt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:t,columns:[t],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(n)}},e.prototype.getColumnGroupHeaderRowHeight=function(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()},e.prototype.getColumnHeaderRowHeight=function(){var t=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),e=this.getAllDisplayedColumns().filter((function(t){return t.isAutoHeaderHeight()})).map((function(t){return t.getAutoHeaderHeight()||0}));return Math.max.apply(Math,Me([t],De(e)))},e.prototype.getHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("headerHeight"))&&void 0!==t?t:this.environment.getFromTheme(25,"headerHeight")},e.prototype.getFloatingFiltersHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==t?t:this.getHeaderHeight()},e.prototype.getGroupHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==t?t:this.getHeaderHeight()},e.prototype.getPivotHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==t?t:this.getHeaderHeight()},e.prototype.getPivotGroupHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==t?t:this.getGroupHeaderHeight()},e.prototype.queueResizeOperations=function(){this.shouldQueueResizeOperations=!0},e.prototype.processResizeOperations=function(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach((function(t){return t()})),this.resizeOperationQueue=[]},e.prototype.resetColumnDefIntoColumn=function(t){var e=t.getUserProvidedColDef();if(!e)return!1;var n=this.columnFactory.addColumnDefaultAndTypes(e,t.getColId());return t.setColDef(n,e),!0},e.prototype.generateColumnStateForRowGroupAndPivotIndexes=function(t,e){var n=this,r={},o=function(t,e,o,i,s,a){if(!e.length||!n.primaryColumns)return[];for(var l=Object.keys(t),u=new Set(l),c=new Set(l),p=new Set(e.map((function(t){var e=t.getColId();return c.delete(e),e})).concat(l)),h=[],d={},f=0,g=0;g<n.primaryColumns.length;g++){var m=n.primaryColumns[g].getColId();p.has(m)&&(h.push(m),d[m]=f++)}var y=1e3,v=!1,_=0,w=function(e){for(var n=d[e],r=_;r<n;r++){var o=h[r];c.has(o)&&(t[o][s]=y++,c.delete(o))}_=n};e.forEach((function(e){var n=e.getColId();if(u.has(n))w(n),t[n][s]=y++;else{var l=e.getColDef();if(null===l[s]||void 0===l[s]&&null==l[a]){if(!v)l[o]||void 0===l[o]&&l[i]?w(n):(c.forEach((function(e){t[e][s]=y+d[e]})),y+=h.length,v=!0);r[n]||(r[n]={colId:n}),r[n][s]=y++}}}))};return o(t,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),o(e,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(r)},Oe([$("expressionService")],e.prototype,"expressionService",void 0),Oe([$("columnFactory")],e.prototype,"columnFactory",void 0),Oe([$("displayedGroupCreator")],e.prototype,"displayedGroupCreator",void 0),Oe([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Oe([$("autoWidthCalculator")],e.prototype,"autoWidthCalculator",void 0),Oe([$("columnUtils")],e.prototype,"columnUtils",void 0),Oe([$("columnAnimationService")],e.prototype,"columnAnimationService",void 0),Oe([$("autoGroupColService")],e.prototype,"autoGroupColService",void 0),Oe([tt("aggFuncService")],e.prototype,"aggFuncService",void 0),Oe([tt("valueCache")],e.prototype,"valueCache",void 0),Oe([tt("animationFrameService")],e.prototype,"animationFrameService",void 0),Oe([$("sortController")],e.prototype,"sortController",void 0),Oe([$("columnDefFactory")],e.prototype,"columnDefFactory",void 0),Oe([Z],e.prototype,"init",null),Oe([Q],e.prototype,"destroyColumns",null),Oe([Ie(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=Oe([J("columnModel")],e)}(jt),Fe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),e.prototype.calculateColMinWidth=function(t){return null!=t.minWidth?t.minWidth:this.environment.getMinColWidth()},e.prototype.calculateColMaxWidth=function(t){return null!=t.maxWidth?t.maxWidth:Number.MAX_SAFE_INTEGER},e.prototype.calculateColInitialWidth=function(t){var e,n=this.calculateColMinWidth(t),r=this.calculateColMaxWidth(t),o=l(t.width),i=l(t.initialWidth);return e=null!=o?o:null!=i?i:200,Math.max(Math.min(e,r),n)},e.prototype.getOriginalPathForColumn=function(t,e){var n=[],r=!1,o=function(e,i){for(var s=0;s<e.length;s++){if(r)return;var a=e[s];if(a instanceof ft)o(a.getChildren(),i+1),n[i]=a;else a===t&&(r=!0)}};return o(e,0),r?n:null},e.prototype.depthFirstOriginalTreeSearch=function(t,e,n){var r=this;e&&e.forEach((function(e){e instanceof ft&&r.depthFirstOriginalTreeSearch(e,e.getChildren(),n),n(e,t)}))},e.prototype.depthFirstAllColumnTreeSearch=function(t,e){var n=this;t&&t.forEach((function(t){t instanceof Kt&&n.depthFirstAllColumnTreeSearch(t.getChildren(),e),e(t)}))},e.prototype.depthFirstDisplayedColumnTreeSearch=function(t,e){var n=this;t&&t.forEach((function(t){t instanceof Kt&&n.depthFirstDisplayedColumnTreeSearch(t.getDisplayedChildren(),e),e(t)}))},e=ke([J("columnUtils")],e)}(jt),Be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ve=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Be(e,t),e.prototype.createDisplayedGroups=function(t,e,n,r){for(var o=this,i=this.mapOldGroupsById(r),s=[],a=t,l=function(){var t=a;a=[];for(var r=0,l=function(l){var u=r;r=l;var c=t[u],p=(c instanceof Kt?c.getProvidedColumnGroup():c).getOriginalParent();if(null!=p){var h=o.createColumnGroup(p,e,i,n);for(d=u;d<l;d++)h.addChild(t[d]);a.push(h)}else for(var d=u;d<l;d++)s.push(t[d])},u=1;u<t.length;u++){var c=t[u],p=(c instanceof Kt?c.getProvidedColumnGroup():c).getOriginalParent(),h=t[r];p!==(h instanceof Kt?h.getProvidedColumnGroup():h).getOriginalParent()&&l(u)}r<t.length&&l(t.length)};a.length;)l();return this.setupParentsIntoColumns(s,null),s},e.prototype.createColumnGroup=function(t,e,n,r){var i=t.getGroupId(),s=e.getInstanceIdForKey(i),a=n[Kt.createUniqueId(i,s)];return a&&a.getProvidedColumnGroup()!==t&&(a=null),o(a)?a.reset():(a=new Kt(t,i,s,r),this.context.createBean(a)),a},e.prototype.mapOldGroupsById=function(t){var e={},n=function(t){t.forEach((function(t){if(t instanceof Kt){var r=t;e[t.getUniqueId()]=r,n(r.getChildren())}}))};return t&&n(t),e},e.prototype.setupParentsIntoColumns=function(t,e){var n=this;t.forEach((function(t){if(t.setParent(e),t instanceof Kt){var r=t;n.setupParentsIntoColumns(r.getChildren(),r)}}))},e=Ve([J("displayedGroupCreator")],e)}(jt),je=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),He=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentsMappedByName={},e}return je(e,t),e.prototype.setupComponents=function(t){var e=this;t&&t.forEach((function(t){return e.addComponent(t)}))},e.prototype.addComponent=function(t){var e=t.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[e]=t.componentClass},e.prototype.getComponentClass=function(t){return this.componentsMappedByName[t]},e=He([J("agStackComponentsRegistry")],e)}(jt);function We(t,e,n){null==n||""==n?Xe(t,e):qe(t,e,n)}function qe(t,e,n){t.setAttribute(Ke(e),n.toString())}function Xe(t,e){t.removeAttribute(Ke(e))}function Ke(t){return"aria-"+t}function Ye(t,e){e?t.setAttribute("role",e):t.removeAttribute("role")}function Ze(t){return"asc"===t?"ascending":"desc"===t?"descending":"mixed"===t?"other":"none"}function Qe(t){return parseInt(t.getAttribute("aria-level"),10)}function Je(t){return parseInt(t.getAttribute("aria-posinset"),10)}function $e(t,e){We(t,"label",e)}function tn(t,e){We(t,"labelledby",e)}function en(t,e){We(t,"description",e)}function nn(t,e){We(t,"describedby",e)}function rn(t,e){We(t,"live",e)}function on(t,e){We(t,"level",e)}function sn(t,e){We(t,"disabled",e)}function an(t,e){We(t,"hidden",e)}function ln(t,e){qe(t,"expanded",e)}function un(t){Xe(t,"expanded")}function cn(t,e){qe(t,"setsize",e)}function pn(t,e){qe(t,"posinset",e)}function hn(t,e){qe(t,"multiselectable",e)}function dn(t,e){qe(t,"rowcount",e)}function fn(t,e){qe(t,"rowindex",e)}function gn(t,e){qe(t,"colcount",e)}function mn(t,e){qe(t,"colindex",e)}function yn(t,e){qe(t,"colspan",e)}function vn(t,e){qe(t,"sort",e)}function _n(t){Xe(t,"sort")}function wn(t,e){We(t,"selected",e)}function Cn(t,e){qe(t,"checked",void 0===e?"mixed":e)}function bn(t,e){We(t,"controls",e.id),tn(e,t.id)}function xn(t,e){return void 0===e?t("ariaIndeterminate","indeterminate"):!0===e?t("ariaChecked","checked"):t("ariaUnchecked","unchecked")}var En,Sn,Tn,Rn,Pn,On,In,An,Dn=Object.freeze({__proto__:null,setAriaRole:Ye,getAriaSortState:Ze,getAriaLevel:Qe,getAriaPosInSet:Je,getAriaDescribedBy:function(t){return t.getAttribute("aria-describedby")||""},setAriaLabel:$e,setAriaLabelledBy:tn,setAriaDescription:en,setAriaDescribedBy:nn,setAriaLive:rn,setAriaLevel:on,setAriaDisabled:sn,setAriaHidden:an,setAriaExpanded:ln,removeAriaExpanded:un,setAriaSetSize:cn,setAriaPosInSet:pn,setAriaMultiSelectable:hn,setAriaRowCount:dn,setAriaRowIndex:fn,setAriaColCount:gn,setAriaColIndex:mn,setAriaColSpan:yn,setAriaSort:vn,removeAriaSort:_n,setAriaSelected:wn,setAriaChecked:Cn,setAriaControls:bn,getAriaCheckboxStateName:xn});function Mn(){return void 0===En&&(En=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),En}function Ln(){if(void 0===Sn)if(Mn()){var t=navigator.userAgent.match(/version\/(\d+)/i);t&&(Sn=null!=t[1]?parseFloat(t[1]):0)}else Sn=0;return Sn}function Nn(){if(void 0===Tn){var t=window;Tn=!!t.chrome&&(!!t.chrome.webstore||!!t.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return Tn}function Fn(){return void 0===Rn&&(Rn=/(firefox)/i.test(navigator.userAgent)),Rn}function kn(){return void 0===Pn&&(Pn=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Pn}function Gn(){return void 0===On&&(On=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),On}function Bn(){return!Mn()||Ln()>=15}function Vn(t){if(!t)return null;var e=t.tabIndex,n=t.getAttribute("tabIndex");return-1!==e||null!==n&&(""!==n||Fn())?e.toString():null}function zn(){if(!document.body)return-1;var t=1e6,e=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){var r=2*t;if(n.style.height=r+"px",r>e||n.clientHeight!==r)break;t=r}return document.body.removeChild(n),t}function jn(){var t,e,n;return null!==(e=null===(t=document.body)||void 0===t?void 0:t.clientWidth)&&void 0!==e?e:window.innerHeight||(null===(n=document.documentElement)||void 0===n?void 0:n.clientWidth)||-1}function Hn(){var t,e,n;return null!==(e=null===(t=document.body)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:window.innerHeight||(null===(n=document.documentElement)||void 0===n?void 0:n.clientHeight)||-1}function Un(){return null==An&&Wn(),An}function Wn(){var t=document.body,e=document.createElement("div");e.style.width=e.style.height="100px",e.style.opacity="0",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",e.style.position="absolute",t.appendChild(e);var n=e.offsetWidth-e.clientWidth;0===n&&0===e.clientWidth&&(n=null),e.parentNode&&e.parentNode.removeChild(e),null!=n&&(An=n,In=0===n)}function qn(){return null==In&&Wn(),In}var Xn=Object.freeze({__proto__:null,isBrowserSafari:Mn,getSafariVersion:Ln,isBrowserChrome:Nn,isBrowserFirefox:Fn,isMacOsUserAgent:kn,isIOSUserAgent:Gn,browserSupportsPreventScroll:Bn,getTabIndex:Vn,getMaxDivHeight:zn,getBodyWidth:jn,getBodyHeight:Hn,getScrollbarWidth:Un,isInvisibleScrollbar:qn});function Kn(t,e){return t.toString().padStart(e,"0")}function Yn(t,e){for(var n=[],r=t;r<=e;r++)n.push(r);return n}function Zn(t,e,n){return"number"!==typeof t?"":t.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+e)}var Qn=Object.freeze({__proto__:null,padStartWidthZeros:Kn,createArrayOfNumbers:Yn,cleanNumber:function(t){return"string"===typeof t&&(t=parseInt(t,10)),"number"===typeof t?Math.floor(t):null},decToHex:function(t,e){for(var n="",r=0;r<e;r++)n+=String.fromCharCode(255&t),t>>>=8;return n},formatNumberTwoDecimalPlacesAndCommas:function(t,e,n){return"number"!==typeof t?"":Zn(Math.round(100*t)/100,e,n)},formatNumberCommas:Zn,sum:function(t){return null==t?null:t.reduce((function(t,e){return t+e}),0)},zeroOrGreater:function(t,e){return t>=0?t:e},oneOrGreater:function(t,e){var n=parseInt(t,10);return!isNaN(n)&&isFinite(n)&&n>0?n:e}}),Jn=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function $n(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n="-"),!t)return null;var r=[t.getFullYear(),t.getMonth()+1,t.getDate()].map((function(t){return Kn(t,2)})).join(n);return e&&(r+=" "+[t.getHours(),t.getMinutes(),t.getSeconds()].map((function(t){return Kn(t,2)})).join(":")),r}var tr=function(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function er(t,e){void 0===e&&(e="YYYY-MM-DD");var n=Kn(t.getFullYear(),4),r=["January","February","March","April","May","June","July","August","September","October","November","December"],o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i={YYYY:function(){return n.slice(n.length-4,n.length)},YY:function(){return n.slice(n.length-2,n.length)},Y:function(){return""+t.getFullYear()},MMMM:function(){return r[t.getMonth()]},MMM:function(){return r[t.getMonth()].slice(0,3)},MM:function(){return Kn(t.getMonth()+1,2)},Mo:function(){return""+(t.getMonth()+1)+tr(t.getMonth()+1)},M:function(){return""+(t.getMonth()+1)},Do:function(){return""+t.getDate()+tr(t.getDate())},DD:function(){return Kn(t.getDate(),2)},D:function(){return""+t.getDate()},dddd:function(){return o[t.getDay()]},ddd:function(){return o[t.getDay()].slice(0,3)},dd:function(){return o[t.getDay()].slice(0,2)},do:function(){return""+t.getDay()+tr(t.getDay())},d:function(){return""+t.getDay()}},s=new RegExp(Object.keys(i).join("|"),"g");return e.replace(s,(function(t){return t in i?i[t]():t}))}function nr(t){if(!t)return null;var e=Jn(t.split(" "),2),n=e[0],r=e[1];if(!n)return null;var o=n.split("-").map((function(t){return parseInt(t,10)}));if(3!==o.filter((function(t){return!isNaN(t)})).length)return null;var i=Jn(o,3),s=i[0],a=i[1],l=i[2],u=new Date(s,a-1,l);if(u.getFullYear()!==s||u.getMonth()!==a-1||u.getDate()!==l)return null;if(!r||"00:00:00"===r)return u;var c=Jn(r.split(":").map((function(t){return parseInt(t,10)})),3),p=c[0],h=c[1],d=c[2];return p>=0&&p<24&&u.setHours(p),h>=0&&h<60&&u.setMinutes(h),d>=0&&d<60&&u.setSeconds(d),u}var rr,or=Object.freeze({__proto__:null,serialiseDate:$n,dateToFormattedString:er,parseDateTimeFromString:nr}),ir=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},sr=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};var ar=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function lr(t){var e=Element.prototype.matches||Element.prototype.msMatchesSelector,n=e.call(t,"input, select, button, textarea"),r=e.call(t,ar),o=Er(t);return n&&!r&&o}function ur(t,e,n){void 0===n&&(n={});var r=n.skipAriaHidden;t.classList.toggle("ag-hidden",!e),r||an(t,!e)}function cr(t,e,n){void 0===n&&(n={});var r=n.skipAriaHidden;t.classList.toggle("ag-invisible",!e),r||an(t,!e)}function pr(t,e){var n=e?function(t){return t.setAttribute("disabled","")}:function(t){return t.removeAttribute("disabled")};n(t),jr(t.querySelectorAll("input"),(function(t){return n(t)}))}function hr(t,e,n){for(var r=0;t;){if(t.classList.contains(e))return!0;if(t=t.parentElement,"number"==typeof n){if(++r>n)break}else if(t===n)break}return!1}function dr(t){var e=window.getComputedStyle(t),n=e.height,r=e.width,o=e.borderTopWidth,i=e.borderRightWidth,s=e.borderBottomWidth,a=e.borderLeftWidth,l=e.paddingTop,u=e.paddingRight,c=e.paddingBottom,p=e.paddingLeft,h=e.marginTop,d=e.marginRight,f=e.marginBottom,g=e.marginLeft,m=e.boxSizing;return{height:parseFloat(n),width:parseFloat(r),borderTopWidth:parseFloat(o),borderRightWidth:parseFloat(i),borderBottomWidth:parseFloat(s),borderLeftWidth:parseFloat(a),paddingTop:parseFloat(l),paddingRight:parseFloat(u),paddingBottom:parseFloat(c),paddingLeft:parseFloat(p),marginTop:parseFloat(h),marginRight:parseFloat(d),marginBottom:parseFloat(f),marginLeft:parseFloat(g),boxSizing:m}}function fr(t){var e=dr(t);return"border-box"===e.boxSizing?e.height-e.paddingTop-e.paddingBottom:e.height}function gr(t){var e=dr(t);return"border-box"===e.boxSizing?e.width-e.paddingLeft-e.paddingRight:e.width}function mr(t){var e=dr(t),n=e.marginBottom+e.marginTop;return Math.ceil(t.offsetHeight+n)}function yr(t){var e=dr(t),n=e.marginLeft+e.marginRight;return Math.ceil(t.offsetWidth+n)}function vr(t){var e=t.getBoundingClientRect(),n=dr(t),r=n.borderTopWidth,o=n.borderLeftWidth,i=n.borderRightWidth,s=n.borderBottomWidth;return{top:e.top+(r||0),left:e.left+(o||0),right:e.right+(i||0),bottom:e.bottom+(s||0)}}function _r(){if("boolean"===typeof rr)return rr;var t=document.createElement("div");return t.style.direction="rtl",t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="0px",t.style.overflow="hidden",t.dir="rtl",t.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(t),t.scrollLeft=1,rr=0===Math.floor(t.scrollLeft),document.body.removeChild(t),rr}function wr(t,e){var n=t.scrollLeft;return e&&(n=Math.abs(n),Nn()&&!_r()&&(n=t.scrollWidth-t.clientWidth-n)),n}function Cr(t,e,n){n&&(_r()?e*=-1:(Mn()||Nn())&&(e=t.scrollWidth-t.clientWidth-e)),t.scrollLeft=e}function br(t){for(;t&&t.firstChild;)t.removeChild(t.firstChild)}function xr(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Er(t){return null!==t.offsetParent}function Sr(t){var e=document.createElement("div");return e.innerHTML=(t||"").trim(),e.firstChild}function Tr(t){return t&&t.clientHeight?t.clientHeight:0}function Rr(t){return t&&t.clientWidth?t.clientWidth:0}function Pr(t,e,n){if(!n||n.nextSibling!==e){var r=document.activeElement,o=e.contains(r);n?n.nextSibling?t.insertBefore(e,n.nextSibling):t.appendChild(e):t.firstChild&&t.firstChild!==e&&t.insertAdjacentElement("afterbegin",e),o&&r&&Bn()&&r.focus({preventScroll:!0})}}function Or(t,e){for(var n=0;n<e.length;n++){var r=e[n],o=t.children[n];o!==r&&t.insertBefore(r,o)}}function Ir(t,e,n){n?n.insertAdjacentElement("afterend",e):t.firstChild?t.insertAdjacentElement("afterbegin",e):t.appendChild(e)}function Ar(t,e){var n,r;if(e)try{for(var o=ir(Object.entries(e)),i=o.next();!i.done;i=o.next()){var s=sr(i.value,2),a=s[0],l=s[1];if(a&&a.length&&null!=l){var u=ie(a),c=l.toString(),p=c.replace(/\s*!important/g,""),h=p.length!=c.length?"important":void 0;t.style.setProperty(u,p,h)}}}catch(d){n={error:d}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}function Dr(t){return t.clientWidth<t.scrollWidth}function Mr(t){return t.clientHeight<t.scrollHeight}function Lr(t,e){"flex"===e?(t.style.removeProperty("width"),t.style.removeProperty("minWidth"),t.style.removeProperty("maxWidth"),t.style.flex="1 1 auto"):Nr(t,e)}function Nr(t,e){e=kr(e),t.style.width=e.toString(),t.style.maxWidth=e.toString(),t.style.minWidth=e.toString()}function Fr(t,e){e=kr(e),t.style.height=e.toString(),t.style.maxHeight=e.toString(),t.style.minHeight=e.toString()}function kr(t){return"number"===typeof t?t+"px":t}function Gr(t){return t instanceof Node||t instanceof HTMLElement}function Br(t){if(null==t)return[];var e=[];return jr(t,(function(t){return e.push(t)})),e}function Vr(t,e){if(t)for(var n=0;n<t.length;n++){var r=t[n];e(r.name,r.value)}}function zr(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n.toString())}function jr(t,e){if(null!=t)for(var n=0;n<t.length;n++)e(t[n])}function Hr(t,e){t.then((function(t){var n=t.getGui();null!=n&&("object"===typeof n?e.appendChild(n):e.innerHTML=n)}))}var Ur=Object.freeze({__proto__:null,radioCssClass:function(t,e,n){for(var r=t.parentElement,o=r&&r.firstChild;o;)e&&o.classList.toggle(e,o===t),n&&o.classList.toggle(n,o!==t),o=o.nextSibling},FOCUSABLE_SELECTOR:"[tabindex], input, select, button, textarea, [href]",FOCUSABLE_EXCLUDE:ar,isFocusableFormField:lr,setDisplayed:ur,setVisible:cr,setDisabled:pr,isElementChildOfClass:hr,getElementSize:dr,getInnerHeight:fr,getInnerWidth:gr,getAbsoluteHeight:mr,getAbsoluteWidth:yr,getElementRectWithOffset:vr,isRtlNegativeScroll:_r,getScrollLeft:wr,setScrollLeft:Cr,clearElement:br,removeElement:function(t,e){xr(t.querySelector(e))},removeFromParent:xr,isVisible:Er,loadTemplate:Sr,appendHtml:function(t,e){t.lastChild?t.insertAdjacentHTML("afterbegin",e):t.innerHTML=e},getElementAttribute:function(t,e){return t.attributes&&t.attributes[e]?t.attributes[e].value:null},offsetHeight:Tr,offsetWidth:Rr,ensureDomOrder:Pr,setDomChildOrder:Or,insertWithDomOrder:Ir,prependDC:function(t,e){o(t.firstChild)?t.insertBefore(e,t.firstChild):t.appendChild(e)},addStylesToElement:Ar,isHorizontalScrollShowing:Dr,isVerticalScrollShowing:Mr,setElementWidth:Lr,setFixedWidth:Nr,setElementHeight:function(t,e){"flex"===e?(t.style.removeProperty("height"),t.style.removeProperty("minHeight"),t.style.removeProperty("maxHeight"),t.style.flex="1 1 auto"):Fr(t,e)},setFixedHeight:Fr,formatSize:kr,isNodeOrElement:Gr,copyNodeList:Br,iterateNamedNodeMap:Vr,addOrRemoveAttribute:zr,nodeListForEach:jr,bindCellRendererToHtmlElement:Hr}),Wr={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function qr(t,e,n){var r=Xr(t,e,n);if(r){var o=r.className;if("string"===typeof o&&o.indexOf("ag-icon")>-1||"object"===typeof o&&o["ag-icon"])return r}var i=document.createElement("span");return i.appendChild(r),i}function Xr(t,e,n,r){var o=null,i=n&&n.getColDef().icons;if(i&&(o=i[t]),e&&!o){var s=e.get("icons");s&&(o=s[t])}if(!o){var a=document.createElement("span"),l=Wr[t];return l||(r?l=t:(console.warn("AG Grid: Did not find icon "+t),l="")),a.setAttribute("class","ag-icon ag-icon-"+l),a.setAttribute("unselectable","on"),Ye(a,"presentation"),a}var u=void 0;if("function"===typeof o)u=o();else{if("string"!==typeof o)throw new Error("icon from grid options needs to be a string or a function");u=o}return"string"===typeof u?Sr(u):Gr(u)?u:void console.warn("AG Grid: iconRenderer should return back a string or a dom object")}var Kr=Object.freeze({__proto__:null,iconNameClassMap:Wr,createIcon:qr,createIconNoSpan:Xr}),Yr=function(){function t(){}return t.BACKSPACE="Backspace",t.TAB="Tab",t.ENTER="Enter",t.ESCAPE="Escape",t.SPACE=" ",t.LEFT="ArrowLeft",t.UP="ArrowUp",t.RIGHT="ArrowRight",t.DOWN="ArrowDown",t.DELETE="Delete",t.F2="F2",t.PAGE_UP="PageUp",t.PAGE_DOWN="PageDown",t.PAGE_HOME="Home",t.PAGE_END="End",t.A="KeyA",t.C="KeyC",t.D="KeyD",t.V="KeyV",t.X="KeyX",t.Y="KeyY",t.Z="KeyZ",t}();function Zr(t){return!(t.altKey||t.ctrlKey||t.metaKey)&&1===t.key.length}function Qr(t,e,n,r,o){var i=r?r.getColDef().suppressKeyboardEvent:void 0;if(!i)return!1;var s={event:e,editing:o,column:r,api:t.api,node:n,data:n.data,colDef:r.getColDef(),context:t.context,columnApi:t.columnApi};if(i&&i(s))return!0;return!1}function Jr(t,e,n,r){var i=r.getDefinition(),s=i&&i.suppressHeaderKeyboardEvent;return!!o(s)&&!!s({api:t.api,columnApi:t.columnApi,context:t.context,colDef:i,column:r,headerRowIndex:n,event:e})}function $r(t){var e;switch(t.keyCode){case 65:e=Yr.A;break;case 67:e=Yr.C;break;case 86:e=Yr.V;break;case 68:e=Yr.D;break;case 90:e=Yr.Z;break;case 89:e=Yr.Y;break;default:e=t.code}return e}function to(t,e){return void 0===e&&(e=!1),t===Yr.DELETE||!e&&t===Yr.BACKSPACE&&kn()}var eo=Object.freeze({__proto__:null,isEventFromPrintableCharacter:Zr,isUserSuppressingKeyboardEvent:Qr,isUserSuppressingHeaderKeyboardEvent:Jr,normaliseQwertyAzerty:$r,isDeleteKey:to});function no(t,e,n){if(0===n)return!1;var r=Math.abs(t.clientX-e.clientX),o=Math.abs(t.clientY-e.clientY);return Math.max(r,o)<=n}var ro=Object.freeze({__proto__:null,areEventsNear:no});var oo=Object.freeze({__proto__:null,sortRowNodesByOrder:function(t,e){if(!t)return!1;for(var n=function(t,n){var r=e[t.id],o=e[n.id],i=void 0!==r,s=void 0!==o;return i&&s?r-o:!i&&!s?t.__objectId-n.__objectId:i?1:-1},r=!1,o=0;o<t.length-1;o++)if(n(t[o],t[o+1])>0){r=!0;break}return!!r&&(t.sort(n),!0)},traverseNodesWithKey:function(t,e){var n=[];!function t(r){if(!r)return;r.forEach((function(r){if(r.group||r.hasChildren()){n.push(r.key);var o=n.join("|");e(r,o),t(r.childrenAfterGroup),n.pop()}}))}(t)}});function io(t){var e=new Set;return t.forEach((function(t){return e.add(t)})),e}var so,ao=Object.freeze({__proto__:null,convertToSet:io}),lo=function(){return(lo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},uo=lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo(lo({},Dn),Ot),Xn),or),Ur),Vt),j),we),p),Kr),eo),le),ro),Qn),R),oo),ao),se),co=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.nextValue=t,this.step=e}return t.prototype.next=function(){var t=this.nextValue;return this.nextValue+=this.step,t},t.prototype.peek=function(){return this.nextValue},t.prototype.skip=function(t){this.nextValue+=t},t}();!function(t){t[t.IN_PROGRESS=0]="IN_PROGRESS",t[t.RESOLVED=1]="RESOLVED"}(so||(so={}));var po,ho,fo=function(){function t(t){var e=this;this.status=so.IN_PROGRESS,this.resolution=null,this.waiters=[],t((function(t){return e.onDone(t)}),(function(t){return e.onReject(t)}))}return t.all=function(e){return new t((function(t){var n=e.length,r=new Array(n);e.forEach((function(e,o){e.then((function(e){r[o]=e,0===--n&&t(r)}))}))}))},t.resolve=function(e){return void 0===e&&(e=null),new t((function(t){return t(e)}))},t.prototype.then=function(e){var n=this;return new t((function(t){n.status===so.RESOLVED?t(e(n.resolution)):n.waiters.push((function(n){return t(e(n))}))}))},t.prototype.resolveNow=function(t,e){return this.status===so.RESOLVED?e(this.resolution):t},t.prototype.onDone=function(t){this.status=so.RESOLVED,this.resolution=t,this.waiters.forEach((function(e){return e(t)}))},t.prototype.onReject=function(t){console.warn("TBI")},t}(),go=function(){function t(){this.timestamp=(new Date).getTime()}return t.prototype.print=function(t){var e=(new Date).getTime()-this.timestamp;console.info(t+" = "+e),this.timestamp=(new Date).getTime()},t}(),mo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yo=function(){return(yo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},vo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.NOTHING=0]="NOTHING",t[t.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",t[t.SHOWING=2]="SHOWING"}(po||(po={})),function(t){t[t.HOVER=0]="HOVER",t[t.FOCUS=1]="FOCUS"}(ho||(ho={}));var _o=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentComp=e,o.tooltipShowDelayOverride=n,o.tooltipHideDelayOverride=r,o.DEFAULT_SHOW_TOOLTIP_DELAY=2e3,o.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,o.SHOW_QUICK_TOOLTIP_DIFF=1e3,o.FADE_OUT_TOOLTIP_TIMEOUT=1e3,o.INTERACTIVE_HIDE_DELAY=100,o.interactionEnabled=!1,o.isInteractingWithTooltip=!1,o.state=po.NOTHING,o.tooltipInstanceCount=0,o.tooltipMouseTrack=!1,o}return mo(e,t),e.prototype.postConstruct=function(){this.gridOptionsService.is("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipShowDelay=this.getTooltipDelay("show"),this.tooltipHideDelay=this.getTooltipDelay("hide"),this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");var t=this.parentComp.getGui();this.tooltipTrigger===ho.HOVER&&(this.addManagedListener(t,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(t,"mouseleave",this.onMouseLeave.bind(this))),this.tooltipTrigger===ho.FOCUS&&(this.addManagedListener(t,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(t,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(t,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(t,"keydown",this.onKeyDown.bind(this)))},e.prototype.getGridOptionsTooltipDelay=function(t){var e=this.gridOptionsService.getNum(t);if(o(e))return e<0&&O((function(){return console.warn("AG Grid: "+t+" should not be lower than 0")}),t+"Warn"),Math.max(200,e)},e.prototype.getTooltipDelay=function(t){var e,n,r,o;return"show"===t?null!==(n=null!==(e=this.getGridOptionsTooltipDelay("tooltipShowDelay"))&&void 0!==e?e:this.tooltipShowDelayOverride)&&void 0!==n?n:this.DEFAULT_SHOW_TOOLTIP_DELAY:null!==(o=null!==(r=this.getGridOptionsTooltipDelay("tooltipHideDelay"))&&void 0!==r?r:this.tooltipHideDelayOverride)&&void 0!==o?o:this.DEFAULT_HIDE_TOOLTIP_DELAY},e.prototype.destroy=function(){this.setToDoNothing(),t.prototype.destroy.call(this)},e.prototype.getTooltipTrigger=function(){var t=this.gridOptionsService.get("tooltipTrigger");return t&&"hover"!==t?ho.FOCUS:ho.HOVER},e.prototype.onMouseEnter=function(t){var n=this;this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),Gn()||(e.isLocked?this.showTooltipTimeoutId=window.setTimeout((function(){n.prepareToShowTooltip(t)}),this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(t))},e.prototype.onMouseMove=function(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&this.state===po.SHOWING&&this.tooltipComp&&this.positionTooltip()},e.prototype.onMouseDown=function(){this.setToDoNothing()},e.prototype.onMouseLeave=function(){this.interactionEnabled?this.lockService():this.setToDoNothing()},e.prototype.onFocusIn=function(){this.prepareToShowTooltip()},e.prototype.onFocusOut=function(t){var e,n=t.relatedTarget,r=this.parentComp.getGui(),o=null===(e=this.tooltipComp)||void 0===e?void 0:e.getGui();this.isInteractingWithTooltip||r.contains(n)||this.interactionEnabled&&(null===o||void 0===o?void 0:o.contains(n))||this.setToDoNothing()},e.prototype.onKeyDown=function(){this.setToDoNothing()},e.prototype.prepareToShowTooltip=function(t){if(this.state!=po.NOTHING||e.isLocked)return!1;var n=0;return t&&(n=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),n),this.state=po.WAITING_TO_SHOW,!0},e.prototype.isLastTooltipHiddenRecently=function(){return(new Date).getTime()-e.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF},e.prototype.setToDoNothing=function(){this.state===po.SHOWING&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=po.NOTHING,this.lastMouseEvent=null},e.prototype.showTooltip=function(){var t=yo({},this.parentComp.getTooltipParams());if(o(t.value)){this.state=po.SHOWING,this.tooltipInstanceCount++;var e=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(e)}else this.setToDoNothing()},e.prototype.hideTooltip=function(t){if(t||!this.isInteractingWithTooltip){this.tooltipComp&&(this.destroyTooltipComp(),e.lastTooltipHideTime=(new Date).getTime());var n={type:Yt.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(n),this.state=po.NOTHING}},e.prototype.newTooltipComponentCallback=function(t,e){if(this.state!==po.SHOWING||this.tooltipInstanceCount!==t)this.getContext().destroyBean(e);else{var n=e.getGui();this.tooltipComp=e,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===ho.HOVER&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");var r=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({eChild:n,ariaLabel:r("ariaLabelTooltip","Tooltip")});o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===ho.FOCUS&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,Yt.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(this.tooltipTrigger===ho.HOVER?(this.tooltipMouseEnterListener=this.addManagedListener(n,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(n,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(n,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(n,"focusout",this.onTooltipFocusOut.bind(this))||null));var i={type:Yt.EVENT_TOOLTIP_SHOW,tooltipGui:n,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(i),this.startHideTimeout()}},e.prototype.onTooltipMouseEnter=function(){this.isInteractingWithTooltip=!0,this.unlockService()},e.prototype.onTooltipMouseLeave=function(){this.isInteractingWithTooltip=!1,this.lockService()},e.prototype.onTooltipFocusIn=function(){this.isInteractingWithTooltip=!0},e.prototype.onTooltipFocusOut=function(t){var e,n=this.parentComp.getGui(),r=null===(e=this.tooltipComp)||void 0===e?void 0:e.getGui(),o=t.relatedTarget;(null===r||void 0===r?void 0:r.contains(o))||(this.isInteractingWithTooltip=!1,n.contains(o)?this.startHideTimeout():this.hideTooltip())},e.prototype.positionTooltip=function(){var t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(yo(yo({},t),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(yo(yo({},t),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))},e.prototype.destroyTooltipComp=function(){var t=this;this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");var e=this.tooltipPopupDestroyFunc,n=this.tooltipComp,r=this.tooltipTrigger===ho.HOVER?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout((function(){e(),t.getContext().destroyBean(n)}),r),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0},e.prototype.clearTooltipListeners=function(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach((function(t){t&&t()})),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null},e.prototype.lockService=function(){var t=this;e.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout((function(){t.unlockService(),t.setToDoNothing()}),this.INTERACTIVE_HIDE_DELAY)},e.prototype.unlockService=function(){e.isLocked=!1,this.clearInteractiveTimeout()},e.prototype.startHideTimeout=function(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)},e.prototype.clearShowTimeout=function(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)},e.prototype.clearHideTimeout=function(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)},e.prototype.clearInteractiveTimeout=function(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)},e.prototype.clearTimeouts=function(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()},e.isLocked=!1,vo([$("popupService")],e.prototype,"popupService",void 0),vo([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),vo([Z],e.prototype,"postConstruct",null),e}(jt),wo=function(){function t(t){this.cssClassStates={},this.getGui=t}return t.prototype.addCssClass=function(t){var e=this,n=(t||"").split(" ");if(n.length>1)n.forEach((function(t){return e.addCssClass(t)}));else if(!0!==this.cssClassStates[t]&&t.length){var r=this.getGui();r&&r.classList.add(t),this.cssClassStates[t]=!0}},t.prototype.removeCssClass=function(t){var e=this,n=(t||"").split(" ");if(n.length>1)n.forEach((function(t){return e.removeCssClass(t)}));else if(!1!==this.cssClassStates[t]&&t.length){var r=this.getGui();r&&r.classList.remove(t),this.cssClassStates[t]=!1}},t.prototype.containsCssClass=function(t){var e=this.getGui();return!!e&&e.classList.contains(t)},t.prototype.addOrRemoveCssClass=function(t,e){var n=this;if(t){if(t.indexOf(" ")>=0){var r=(t||"").split(" ");if(r.length>1)return void r.forEach((function(t){return n.addOrRemoveCssClass(t,e)}))}if(this.cssClassStates[t]!==e&&t.length){var o=this.getGui();o&&o.classList.toggle(t,e),this.cssClassStates[t]=e}}},t}(),Co=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xo=new co,Eo=function(t){function e(e){var n=t.call(this)||this;return n.displayed=!0,n.visible=!0,n.compId=xo.next(),n.cssClassManager=new wo((function(){return n.eGui})),e&&n.setTemplate(e),n}return Co(e,t),e.prototype.preConstructOnComponent=function(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")},e.prototype.getCompId=function(){return this.compId},e.prototype.getTooltipParams=function(){return{value:this.tooltipText,location:"UNKNOWN"}},e.prototype.setTooltip=function(t,e,n){var r=this;this.tooltipText!=t&&(this.tooltipText&&(r.usingBrowserTooltips?r.getGui().removeAttribute("title"):r.tooltipFeature=r.destroyBean(r.tooltipFeature)),null!=t&&(this.tooltipText=t,this.tooltipText&&(r.usingBrowserTooltips?r.getGui().setAttribute("title",r.tooltipText):r.tooltipFeature=r.createBean(new _o(r,e,n)))))},e.prototype.createChildComponentsFromTags=function(t,e){var n=this;Br(t.childNodes).forEach((function(r){if(r instanceof HTMLElement){var o=n.createComponentFromElement(r,(function(t){t.getGui()&&n.copyAttributesFromNode(r,t.getGui())}),e);if(o){if(o.addItems&&r.children.length){n.createChildComponentsFromTags(r,e);var i=Array.prototype.slice.call(r.children);o.addItems(i)}n.swapComponentForNode(o,t,r)}else r.childNodes&&n.createChildComponentsFromTags(r,e)}}))},e.prototype.createComponentFromElement=function(t,n,r){var o=t.nodeName,i=r?r[t.getAttribute("ref")]:void 0,s=this.agStackComponentsRegistry.getComponentClass(o);if(s){e.elementGettingCreated=t;var a=new s(i);return a.setParentComponent(this),this.createBean(a,null,n),a}return null},e.prototype.copyAttributesFromNode=function(t,e){Vr(t.attributes,(function(t,n){return e.setAttribute(t,n)}))},e.prototype.swapComponentForNode=function(t,e,n){var r=t.getGui();e.replaceChild(r,n),e.insertBefore(document.createComment(n.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,t)),this.swapInComponentForQuerySelectors(t,n)},e.prototype.swapInComponentForQuerySelectors=function(t,e){var n=this;this.iterateOverQuerySelectors((function(r){n[r.attributeName]===e&&(n[r.attributeName]=t)}))},e.prototype.iterateOverQuerySelectors=function(t){for(var e=Object.getPrototypeOf(this);null!=e;){var n=e.__agComponentMetaData,r=I(e.constructor);n&&n[r]&&n[r].querySelectors&&n[r].querySelectors.forEach((function(e){return t(e)})),e=Object.getPrototypeOf(e)}},e.prototype.activateTabIndex=function(t){var e=this.gridOptionsService.getNum("tabIndex")||0;t||(t=[]),t.length||t.push(this.getGui()),t.forEach((function(t){return t.setAttribute("tabindex",e.toString())}))},e.prototype.setTemplate=function(t,e){var n=Sr(t);this.setTemplateFromElement(n,e)},e.prototype.setTemplateFromElement=function(t,e){this.eGui=t,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),e)},e.prototype.createChildComponentsPreConstruct=function(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())},e.prototype.wireQuerySelectors=function(){var t=this;if(this.eGui){var e=this;this.iterateOverQuerySelectors((function(n){var r=function(t){return e[n.attributeName]=t};if(n.refSelector&&t.getAttribute("ref")===n.refSelector)r(t.eGui);else{var o=t.eGui.querySelector(n.querySelector);o&&r(o.__agComponent||o)}}))}},e.prototype.getGui=function(){return this.eGui},e.prototype.getFocusableElement=function(){return this.eGui},e.prototype.setParentComponent=function(t){this.parentComponent=t},e.prototype.getParentComponent=function(){return this.parentComponent},e.prototype.setGui=function(t){this.eGui=t},e.prototype.queryForHtmlElement=function(t){return this.eGui.querySelector(t)},e.prototype.queryForHtmlInputElement=function(t){return this.eGui.querySelector(t)},e.prototype.appendChild=function(t,e){if(null!=t)if(e||(e=this.eGui),Gr(t))e.appendChild(t);else{var n=t;e.appendChild(n.getGui())}},e.prototype.isDisplayed=function(){return this.displayed},e.prototype.setVisible=function(t,e){if(void 0===e&&(e={}),t!==this.visible){this.visible=t;var n=e.skipAriaHidden;cr(this.eGui,t,{skipAriaHidden:n})}},e.prototype.setDisplayed=function(t,n){if(void 0===n&&(n={}),t!==this.displayed){this.displayed=t;var r=n.skipAriaHidden;ur(this.eGui,t,{skipAriaHidden:r});var o={type:e.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(o)}},e.prototype.destroy=function(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);var e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),t.prototype.destroy.call(this)},e.prototype.addGuiEventListener=function(t,e,n){var r=this;this.eGui.addEventListener(t,e,n),this.addDestroyFunc((function(){return r.eGui.removeEventListener(t,e)}))},e.prototype.addCssClass=function(t){this.cssClassManager.addCssClass(t)},e.prototype.removeCssClass=function(t){this.cssClassManager.removeCssClass(t)},e.prototype.containsCssClass=function(t){return this.cssClassManager.containsCssClass(t)},e.prototype.addOrRemoveCssClass=function(t,e){this.cssClassManager.addOrRemoveCssClass(t,e)},e.prototype.getAttribute=function(t){var e=this.eGui;return e?e.getAttribute(t):null},e.prototype.getRefElement=function(t){return this.queryForHtmlElement('[ref="'+t+'"]')},e.EVENT_DISPLAYED_CHANGED="displayedChanged",bo([$("agStackComponentsRegistry")],e.prototype,"agStackComponentsRegistry",void 0),bo([Y],e.prototype,"preConstructOnComponent",null),bo([Y],e.prototype,"createChildComponentsPreConstruct",null),e}(jt);function So(t){return Ro.bind(this,t,void 0)}function To(t){return Ro.bind(this,"[ref="+t+"]",t)}function Ro(t,e,n,r,o){null!==t?"number"!==typeof o?function(t,e,n){var r=function(t,e){t.__agComponentMetaData||(t.__agComponentMetaData={});t.__agComponentMetaData[e]||(t.__agComponentMetaData[e]={});return t.__agComponentMetaData[e]}(t,I(t.constructor));r[e]||(r[e]=[]);r[e].push(n)}(n,"querySelectors",{attributeName:r,querySelector:t,refSelector:e}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}var Po=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Io=function(t){function e(){return t.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this}return Po(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){this.params=t;var e=this.columnModel.getDisplayNameForColumn(t.column,"header",!0),n=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(e+" "+n("ariaFilterInput","Filter Input"))},e.prototype.onParentModelChanged=function(t){var e=this;t?this.params.parentFilterInstance((function(n){if(n.getModelAsString){var r=n.getModelAsString(t);e.eFloatingFilterText.setValue(r)}})):this.eFloatingFilterText.setValue("")},e.prototype.onParamsUpdated=function(t){this.init(t)},Oo([To("eFloatingFilterText")],e.prototype,"eFloatingFilterText",void 0),Oo([$("columnModel")],e.prototype,"columnModel",void 0),e}(Eo),Ao=function(){function t(t,e,n,r){var o=this;this.alive=!0,this.context=t,this.eParent=r,e.getDateCompDetails(n).newAgStackInstance().then((function(e){o.alive?(o.dateComp=e,e&&(r.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached(),o.tempValue&&e.setDate(o.tempValue),null!=o.disabled&&o.setDateCompDisabled(o.disabled))):t.destroyBean(e)}))}return t.prototype.destroy=function(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)},t.prototype.getDate=function(){return this.dateComp?this.dateComp.getDate():this.tempValue},t.prototype.setDate=function(t){this.dateComp?this.dateComp.setDate(t):this.tempValue=t},t.prototype.setDisabled=function(t){this.dateComp?this.setDateCompDisabled(t):this.disabled=t},t.prototype.setDisplayed=function(t){ur(this.eParent,t)},t.prototype.setInputPlaceholder=function(t){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(t)},t.prototype.setInputAriaLabel=function(t){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(t)},t.prototype.afterGuiAttached=function(t){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(t)},t.prototype.updateParams=function(t){var e;(null===(e=this.dateComp)||void 0===e?void 0:e.onParamsUpdated)&&"function"===typeof this.dateComp.onParamsUpdated&&this.dateComp.onParamsUpdated(t)},t.prototype.setDateCompDisabled=function(t){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(t)},t}(),Do=function(){function t(){this.customFilterOptions={}}return t.prototype.init=function(t,e){this.filterOptions=t.filterOptions||e,this.mapCustomOptions(),this.selectDefaultItem(t)},t.prototype.getFilterOptions=function(){return this.filterOptions},t.prototype.mapCustomOptions=function(){var t=this;this.filterOptions&&this.filterOptions.forEach((function(e){if("string"!==typeof e){[["displayKey"],["displayName"],["predicate","test"]].every((function(t){return!!t.some((function(t){return null!=e[t]}))||(console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '"+t+"'"),!1)}))?t.customFilterOptions[e.displayKey]=e:t.filterOptions=t.filterOptions.filter((function(t){return t===e}))||[]}}))},t.prototype.selectDefaultItem=function(t){if(t.defaultOption)this.defaultOption=t.defaultOption;else if(this.filterOptions.length>=1){var e=this.filterOptions[0];"string"===typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")},t.prototype.getDefaultOption=function(){return this.defaultOption},t.prototype.getCustomOption=function(t){return this.customFilterOptions[t]},t}(),Mo={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},Lo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),No=function(){return(No=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Fo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ko=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.eFocusableElement=e,r.callbacks=n,r.callbacks=No({shouldStopEventPropagation:function(){return!1},onTabKeyDown:function(t){if(!t.defaultPrevented){var e=r.focusService.findNextFocusableElement(r.eFocusableElement,!1,t.shiftKey);e&&(e.focus(),t.preventDefault())}}},n),r}return Lo(e,t),e.prototype.postConstruct=function(){this.eFocusableElement.classList.add(e.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)},e.prototype.addKeyDownListeners=function(t){var e=this;this.addManagedListener(t,"keydown",(function(t){t.defaultPrevented||Mt(t)||(e.callbacks.shouldStopEventPropagation(t)?Dt(t):t.key===Yr.TAB?e.callbacks.onTabKeyDown(t):e.callbacks.handleKeyDown&&e.callbacks.handleKeyDown(t))}))},e.FOCUS_MANAGED_CLASS="ag-focus-managed",Fo([$("focusService")],e.prototype,"focusService",void 0),Fo([Z],e.prototype,"postConstruct",null),e}(jt),Go=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Vo=function(t){function e(e,n){var r=t.call(this)||this;return r.element=e,r.dragStartPosition={x:0,y:0},r.position={x:0,y:0},r.lastSize={width:-1,height:-1},r.positioned=!1,r.resizersAdded=!1,r.resizeListeners=[],r.boundaryEl=null,r.isResizing=!1,r.isMoving=!1,r.resizable={},r.movable=!1,r.currentResizer=null,r.config=Object.assign({},{popup:!1},n),r}return Go(e,t),e.prototype.center=function(){var t=this.offsetParent,e=t.clientHeight,n=t.clientWidth/2-this.getWidth()/2,r=e/2-this.getHeight()/2;this.offsetElement(n,r)},e.prototype.initialisePosition=function(){if(!this.positioned){var t=this.config,e=t.centered,n=t.forcePopupParentAsOffsetParent,r=t.minWidth,o=t.width,i=t.minHeight,s=t.height,a=t.x,l=t.y;this.offsetParent||this.setOffsetParent();var u=0,c=0,p=!!this.element.offsetParent;if(p){var h=this.findBoundaryElement(),d=window.getComputedStyle(h);if(null!=d.minWidth){var f=h.offsetWidth-this.element.offsetWidth;c=parseInt(d.minWidth,10)-f}if(null!=d.minHeight){var g=h.offsetHeight-this.element.offsetHeight;u=parseInt(d.minHeight,10)-g}}if(this.minHeight=i||u,this.minWidth=r||c,o&&this.setWidth(o),s&&this.setHeight(s),o&&s||this.refreshSize(),e)this.center();else if(a||l)this.offsetElement(a,l);else if(p&&n){var m=!0;if((h=this.boundaryEl)||(h=this.findBoundaryElement(),m=!1),h){var y=parseFloat(h.style.top),v=parseFloat(h.style.left);m?this.offsetElement(isNaN(v)?0:v,isNaN(y)?0:y):this.setPosition(v,y)}}this.positioned=!!this.offsetParent}},e.prototype.isPositioned=function(){return this.positioned},e.prototype.getPosition=function(){return this.position},e.prototype.setMovable=function(t,e){if(this.config.popup&&t!==this.movable){this.movable=t;var n=this.moveElementDragListener||{eElement:e,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};t?(this.dragService.addDragSource(n),this.moveElementDragListener=n):(this.dragService.removeDragSource(n),this.moveElementDragListener=void 0)}},e.prototype.setResizable=function(t){var e=this;if(this.clearResizeListeners(),t?this.addResizers():this.removeResizers(),"boolean"===typeof t){if(!1===t)return;t={topLeft:t,top:t,topRight:t,right:t,bottomRight:t,bottom:t,bottomLeft:t,left:t}}Object.keys(t).forEach((function(n){var r=!!t[n],o=e.getResizerElement(n),i={dragStartPixels:0,eElement:o,onDragStart:function(t){return e.onResizeStart(t,n)},onDragging:e.onResize.bind(e),onDragStop:function(t){return e.onResizeEnd(t,n)}};(r||!e.isAlive()&&!r)&&(r?(e.dragService.addDragSource(i),e.resizeListeners.push(i),o.style.pointerEvents="all"):o.style.pointerEvents="none",e.resizable[n]=r)}))},e.prototype.removeSizeFromEl=function(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")},e.prototype.restoreLastSize=function(){this.element.style.flex="0 0 auto";var t=this.lastSize,e=t.height,n=t.width;-1!==n&&(this.element.style.width=n+"px"),-1!==e&&(this.element.style.height=e+"px")},e.prototype.getHeight=function(){return this.element.offsetHeight},e.prototype.setHeight=function(t){var e=this.config.popup,n=this.element,r=!1;if("string"===typeof t&&-1!==t.indexOf("%"))Fr(n,t),t=mr(n),r=!0;else if(t=Math.max(this.minHeight,t),this.positioned){var o=this.getAvailableHeight();o&&t>o&&(t=o)}this.getHeight()!==t&&(r?(n.style.maxHeight="unset",n.style.minHeight="unset"):e?Fr(n,t):(n.style.height=t+"px",n.style.flex="0 0 auto",this.lastSize.height="number"===typeof t?t:parseFloat(t)))},e.prototype.getAvailableHeight=function(){var t=this.config,e=t.popup,n=t.forcePopupParentAsOffsetParent;this.positioned||this.initialisePosition();var r=this.offsetParent.clientHeight;if(!r)return null;var o=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:o.top,a=e?0:i.top,l=0;if(n){var u=this.element.parentElement;if(u)l=u.getBoundingClientRect().bottom-o.bottom}return r+a-s-l},e.prototype.getWidth=function(){return this.element.offsetWidth},e.prototype.setWidth=function(t){var e=this.element,n=this.config.popup,r=!1;if("string"===typeof t&&-1!==t.indexOf("%"))Nr(e,t),t=yr(e),r=!0;else if(this.positioned){t=Math.max(this.minWidth,t);var o=this.offsetParent.clientWidth,i=n?this.position.x:this.element.getBoundingClientRect().left;o&&t+i>o&&(t=o-i)}this.getWidth()!==t&&(r?(e.style.maxWidth="unset",e.style.minWidth="unset"):this.config.popup?Nr(e,t):(e.style.width=t+"px",e.style.flex=" unset",this.lastSize.width="number"===typeof t?t:parseFloat(t)))},e.prototype.offsetElement=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n=this.config.forcePopupParentAsOffsetParent?this.boundaryEl:this.element;n&&(this.popupService.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:function(){return{x:t,y:e}}}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))},e.prototype.constrainSizeToAvailableHeight=function(t){var e=this;if(this.config.forcePopupParentAsOffsetParent){t?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),(function(){var t=e.getAvailableHeight();e.element.style.setProperty("max-height",t+"px")})):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}},e.prototype.setPosition=function(t,e){this.position.x=t,this.position.y=e},e.prototype.updateDragStartPosition=function(t,e){this.dragStartPosition={x:t,y:e}},e.prototype.calculateMouseMovement=function(t){var e=t.e,n=t.isLeft,r=t.isTop,o=t.anywhereWithin,i=t.topBuffer,s=e.clientX-this.dragStartPosition.x,a=e.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(e,!!n,!!o,s)?0:s,movementY:this.shouldSkipY(e,!!r,i,a)?0:a}},e.prototype.shouldSkipX=function(t,e,n,r){var o=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:o.left,l=a<=0&&i.left>=t.clientX||i.right<=t.clientX&&i.right<=s.right;return!!l||(l=e?r<0&&t.clientX>a+i.left||r>0&&t.clientX<a+i.left:n?r<0&&t.clientX>s.right||r>0&&t.clientX<a+i.left:r<0&&t.clientX>s.right||r>0&&t.clientX<s.right)},e.prototype.shouldSkipY=function(t,e,n,r){void 0===n&&(n=0);var o=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:o.top,l=a<=0&&i.top>=t.clientY||i.bottom<=t.clientY&&i.bottom<=s.bottom;return!!l||(l=e?r<0&&t.clientY>a+i.top+n||r>0&&t.clientY<a+i.top:r<0&&t.clientY>s.bottom||r>0&&t.clientY<s.bottom)},e.prototype.createResizeMap=function(){var t=this.element;this.resizerMap={topLeft:{element:t.querySelector("[ref=eTopLeftResizer]")},top:{element:t.querySelector("[ref=eTopResizer]")},topRight:{element:t.querySelector("[ref=eTopRightResizer]")},right:{element:t.querySelector("[ref=eRightResizer]")},bottomRight:{element:t.querySelector("[ref=eBottomRightResizer]")},bottom:{element:t.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:t.querySelector("[ref=eBottomLeftResizer]")},left:{element:t.querySelector("[ref=eLeftResizer]")}}},e.prototype.addResizers=function(){if(!this.resizersAdded){var t=this.element;if(t){var e=(new DOMParser).parseFromString('<div class="ag-resizer-wrapper">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',"text/html").body;t.appendChild(e.firstChild),this.createResizeMap(),this.resizersAdded=!0}}},e.prototype.removeResizers=function(){this.resizerMap=void 0;var t=this.element.querySelector(".ag-resizer-wrapper");t&&this.element.removeChild(t),this.resizersAdded=!1},e.prototype.getResizerElement=function(t){return this.resizerMap[t].element},e.prototype.onResizeStart=function(t,e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!e.match(/top/i),isRight:!!e.match(/right/i),isBottom:!!e.match(/bottom/i),isLeft:!!e.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[e].element.classList.add("ag-active");var n=this.config,r=n.popup,o=n.forcePopupParentAsOffsetParent;r||o||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(t.clientX,t.clientY)},e.prototype.getSiblings=function(){var t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter((function(t){return!t.classList.contains("ag-hidden")})):null},e.prototype.getMinSizeOfSiblings=function(){for(var t=this.getSiblings()||[],e=0,n=0,r=0;r<t.length;r++){var o=t[r],i=!!o.style.flex&&"0 0 auto"!==o.style.flex;if(o!==this.element){var s=this.minHeight||0,a=this.minWidth||0;if(i){var l=window.getComputedStyle(o);l.minHeight&&(s=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else s=o.offsetHeight,a=o.offsetWidth;e+=s,n+=a}}return{height:e,width:n}},e.prototype.applySizeToSiblings=function(t){var e=null,n=this.getSiblings();if(n){for(var r=0;r<n.length;r++){var o=n[r];o!==e&&(t?o.style.height=o.offsetHeight+"px":o.style.width=o.offsetWidth+"px",o.style.flex="0 0 auto",o===this.element&&(e=n[r+1]))}e&&(e.style.removeProperty("height"),e.style.removeProperty("min-height"),e.style.removeProperty("max-height"),e.style.flex="1 1 auto")}},e.prototype.isResizable=function(){return Object.values(this.resizable).some((function(t){return t}))},e.prototype.onResize=function(t){if(this.isResizing&&this.currentResizer){var e=this.config,n=e.popup,r=e.forcePopupParentAsOffsetParent,o=this.currentResizer,i=o.isTop,s=o.isRight,a=o.isBottom,l=o.isLeft,u=s||l,c=a||i,p=this.calculateMouseMovement({e:t,isLeft:l,isTop:i}),h=p.movementX,d=p.movementY,f=this.position.x,g=this.position.y,m=0,y=0;if(u&&h){var v=l?-1:1,_=this.getWidth(),w=_+h*v,C=!1;l&&(f+(m=_-w)<=0||w<=this.minWidth)&&(C=!0,m=0),C||this.setWidth(w)}if(c&&d){v=i?-1:1;var b=this.getHeight(),x=b+d*v,E=!1;i?(g+(y=b-x)<=0||x<=this.minHeight)&&(E=!0,y=0):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&b<x&&this.getMinSizeOfSiblings().height+x>this.element.parentElement.offsetHeight&&(E=!0),E||this.setHeight(x)}this.updateDragStartPosition(t.clientX,t.clientY),((n||r)&&m||y)&&this.offsetElement(f+m,g+y)}},e.prototype.onResizeEnd=function(t,e){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;var n={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[e].element.classList.remove("ag-active"),this.dispatchEvent(n)},e.prototype.refreshSize=function(){var t=this.element;this.config.popup&&(this.config.width||this.setWidth(t.offsetWidth),this.config.height||this.setHeight(t.offsetHeight))},e.prototype.onMoveStart=function(t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(t.clientX,t.clientY)},e.prototype.onMove=function(t){if(this.isMoving){var e,n=this.position,r=n.x,o=n.y;this.config.calculateTopBuffer&&(e=this.config.calculateTopBuffer());var i=this.calculateMouseMovement({e:t,isTop:!0,anywhereWithin:!0,topBuffer:e}),s=i.movementX,a=i.movementY;this.offsetElement(r+s,o+a),this.updateDragStartPosition(t.clientX,t.clientY)}},e.prototype.onMoveEnd=function(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")},e.prototype.setOffsetParent=function(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent},e.prototype.findBoundaryElement=function(){for(var t=this.element;t;){if("static"!==window.getComputedStyle(t).position)return t;t=t.parentElement}return this.element},e.prototype.clearResizeListeners=function(){for(;this.resizeListeners.length;){var t=this.resizeListeners.pop();this.dragService.removeDragSource(t)}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()},Bo([$("popupService")],e.prototype,"popupService",void 0),Bo([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Bo([$("dragService")],e.prototype,"dragService",void 0),e}(jt),zo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ho=function(t){function e(e){var n=t.call(this)||this;return n.filterNameKey=e,n.applyActive=!1,n.hidePopup=null,n.debouncePending=!1,n.appliedModel=null,n}return zo(e,t),e.prototype.postConstruct=function(){this.resetTemplate(),this.createManagedBean(new ko(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Vo(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)},e.prototype.handleKeyDown=function(t){},e.prototype.getFilterTitle=function(){return this.translate(this.filterNameKey)},e.prototype.isFilterActive=function(){return!!this.appliedModel},e.prototype.resetTemplate=function(t){var e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit);var n='\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'+this.getCssIdentifier()+'-body-wrapper" ref="eFilterBody">\n                    '+this.createBodyTemplate()+"\n                </div>\n            </form>";this.setTemplate(n,t),(e=this.getGui())&&e.addEventListener("submit",this.onFormSubmit)},e.prototype.isReadOnly=function(){return!!this.providedFilterParams.readOnly},e.prototype.init=function(t){var e=this;this.setParams(t),this.resetUiToDefaults(!0).then((function(){e.updateUiVisibility(),e.setupOnBtApplyDebounce()}))},e.prototype.setParams=function(t){this.providedFilterParams=t,this.applyActive=e.isUseApplyButton(t),this.createButtonPanel()},e.prototype.createButtonPanel=function(){var t=this,e=this.providedFilterParams.buttons;if(!(!e||e.length<1||this.isReadOnly())){var n=document.createElement("div");n.classList.add("ag-filter-apply-panel");io(e).forEach((function(e){return function(e){var r,o;switch(e){case"apply":r=t.translate("applyFilter"),o=function(e){return t.onBtApply(!1,!1,e)};break;case"clear":r=t.translate("clearFilter"),o=function(){return t.onBtClear()};break;case"reset":r=t.translate("resetFilter"),o=function(){return t.onBtReset()};break;case"cancel":r=t.translate("cancelFilter"),o=function(e){t.onBtCancel(e)};break;default:return void console.warn("AG Grid: Unknown button type specified")}var i=Sr('<button\n                    type="'+("apply"===e?"submit":"button")+'"\n                    ref="'+e+'FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >'+r+"\n                </button>");n.appendChild(i),t.addManagedListener(i,"click",o)}(e)})),this.getGui().appendChild(n)}},e.prototype.getDefaultDebounceMs=function(){return 0},e.prototype.setupOnBtApplyDebounce=function(){var t=this,n=e.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),r=k(this.checkApplyDebounce.bind(this),n);this.onBtApplyDebounce=function(){t.debouncePending=!0,r()}},e.prototype.checkApplyDebounce=function(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())},e.prototype.getModel=function(){return this.appliedModel?this.appliedModel:null},e.prototype.setModel=function(t){var e=this;return(null!=t?this.setModelIntoUi(t):this.resetUiToDefaults()).then((function(){e.updateUiVisibility(),e.applyModel("api")}))},e.prototype.onBtCancel=function(t){var e=this;this.resetUiToActiveModel(this.getModel(),(function(){e.handleCancelEnd(t)}))},e.prototype.handleCancelEnd=function(t){this.providedFilterParams.closeOnApply&&this.close(t)},e.prototype.resetUiToActiveModel=function(t,e){var n=this,r=function(){n.onUiChanged(!1,"prevent"),null===e||void 0===e||e()};null!=t?this.setModelIntoUi(t).then(r):this.resetUiToDefaults().then(r)},e.prototype.onBtClear=function(){var t=this;this.resetUiToDefaults().then((function(){return t.onUiChanged()}))},e.prototype.onBtReset=function(){this.onBtClear(),this.onBtApply()},e.prototype.applyModel=function(t){var e=this.getModelFromUi();if(!this.isModelValid(e))return!1;var n=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(n,e)},e.prototype.isModelValid=function(t){return!0},e.prototype.onFormSubmit=function(t){t.preventDefault()},e.prototype.onBtApply=function(t,e,n){if(void 0===t&&(t=!1),void 0===e&&(e=!1),n&&n.preventDefault(),this.applyModel(e?"rowDataUpdated":"ui")){this.providedFilterParams.filterChangedCallback({afterFloatingFilter:t,afterDataChange:e,source:"columnFilter"})}this.providedFilterParams.closeOnApply&&this.applyActive&&!t&&!e&&this.close(n)},e.prototype.onNewRowsLoaded=function(){},e.prototype.close=function(t){if(this.hidePopup){var e,n=t,r=n&&n.key;"Enter"!==r&&"Space"!==r||(e={keyboardEvent:n}),this.hidePopup(e),this.hidePopup=null}},e.prototype.onUiChanged=function(t,e){if(void 0===t&&(t=!1),this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){var n=this.isModelValid(this.getModelFromUi());pr(this.getRefElement("applyFilterButton"),!n)}t&&!e||"immediately"===e?this.onBtApply(t):(this.applyActive||e)&&"debounce"!==e||this.onBtApplyDebounce()},e.prototype.afterGuiAttached=function(t){t&&(this.hidePopup=t.hidePopup),this.refreshFilterResizer(null===t||void 0===t?void 0:t.container)},e.prototype.refreshFilterResizer=function(t){if(this.positionableFeature&&"toolPanel"!==t){var e="floatingFilter"===t,n=this.positionableFeature,r=this.gridOptionsService;e?(n.restoreLastSize(),n.setResizable(r.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}},e.prototype.afterGuiDetached=function(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)},e.getDebounceMs=function(t,n){return e.isUseApplyButton(t)?(null!=t.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=t.debounceMs?t.debounceMs:n},e.isUseApplyButton=function(t){return!!t.buttons&&t.buttons.indexOf("apply")>=0},e.prototype.destroy=function(){var e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),t.prototype.destroy.call(this)},e.prototype.translate=function(t){return this.localeService.getLocaleTextFunc()(t,Mo[t])},e.prototype.getCellValue=function(t){var e=this.providedFilterParams,n=e.api,r=e.colDef,o=e.column,i=e.columnApi,s=e.context;return this.providedFilterParams.valueGetter({api:n,colDef:r,column:o,columnApi:i,context:s,data:t.data,getValue:function(e){return t.data[e]},node:t})},e.prototype.getPositionableElement=function(){return this.eFilterBody},jo([$("rowModel")],e.prototype,"rowModel",void 0),jo([To("eFilterBody")],e.prototype,"eFilterBody",void 0),jo([Z],e.prototype,"postConstruct",null),e}(Eo),Uo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qo=function(t){function e(e,n){var r=t.call(this,n)||this;return r.labelSeparator="",r.labelAlignment="left",r.disabled=!1,r.label="",r.config=e||{},r}return Uo(e,t),e.prototype.postConstruct=function(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");var t=this.config,e=t.labelSeparator,n=t.label,r=t.labelWidth,o=t.labelAlignment;null!=e&&this.setLabelSeparator(e),null!=n&&this.setLabel(n),null!=r&&this.setLabelWidth(r),this.setLabelAlignment(o||this.labelAlignment),this.refreshLabel()},e.prototype.refreshLabel=function(){br(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(ur(this.eLabel,!1),Ye(this.eLabel,"presentation")):(ur(this.eLabel,!0),Ye(this.eLabel,null))},e.prototype.setLabelSeparator=function(t){return this.labelSeparator===t||(this.labelSeparator=t,null!=this.label&&this.refreshLabel()),this},e.prototype.getLabelId=function(){return this.eLabel.id=this.eLabel.id||"ag-"+this.getCompId()+"-label",this.eLabel.id},e.prototype.getLabel=function(){return this.label},e.prototype.setLabel=function(t){return this.label===t||(this.label=t,this.refreshLabel()),this},e.prototype.setLabelAlignment=function(t){var e=this.getGui().classList;return e.toggle("ag-label-align-left","left"===t),e.toggle("ag-label-align-right","right"===t),e.toggle("ag-label-align-top","top"===t),this},e.prototype.setLabelEllipsis=function(t){return this.eLabel.classList.toggle("ag-label-ellipsis",t),this},e.prototype.setLabelWidth=function(t){return null==this.label||Lr(this.eLabel,t),this},e.prototype.setDisabled=function(t){t=!!t;var e=this.getGui();return pr(e,t),e.classList.toggle("ag-disabled",t),this.disabled=t,this},e.prototype.isDisabled=function(){return!!this.disabled},Wo([Z],e.prototype,"postConstruct",null),e}(Eo),Xo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ko=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return o.className=r,o}return Xo(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.className&&this.addCssClass(this.className)},e.prototype.onValueChange=function(t){var e=this;return this.addManagedListener(this,Yt.EVENT_FIELD_VALUE_CHANGED,(function(){return t(e.getValue())})),this},e.prototype.getWidth=function(){return this.getGui().clientWidth},e.prototype.setWidth=function(t){return Nr(this.getGui(),t),this},e.prototype.getPreviousValue=function(){return this.previousValue},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t,e){return this.value===t||(this.previousValue=this.value,this.value=t,e||this.dispatchEvent({type:Yt.EVENT_FIELD_VALUE_CHANGED})),this},e}(qo),Yo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qo=function(t){function e(e,n,r,o){var i=t.call(this,e,'<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    '+(o?'role="'+o+'"':"")+'\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',n)||this;return i.pickerIcon=r,i.isPickerDisplayed=!1,i.skipClick=!1,i.pickerGap=4,i.hideCurrentPicker=null,i.onPickerFocusIn=i.onPickerFocusIn.bind(i),i.onPickerFocusOut=i.onPickerFocusOut.bind(i),null!=(null===e||void 0===e?void 0:e.pickerGap)&&(i.pickerGap=e.pickerGap),i}return Yo(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this);var n="ag-"+this.getCompId()+"-display";this.eDisplayField.setAttribute("id",n),nn(this.eWrapper,n);var r=this.getGui();this.addManagedListener(r,"mousedown",(function(t){var n;!e.skipClick&&(null===(n=e.pickerComponent)||void 0===n?void 0:n.isAlive())&&Er(e.pickerComponent.getGui())&&r.contains(t.target)&&(e.skipClick=!0)}));var o=this.getFocusableElement();if(this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"click",this.clickHandler.bind(this)),this.addManagedListener(o,"click",this.clickHandler.bind(this)),this.pickerIcon){var i=Xr(this.pickerIcon,this.gridOptionsService);i&&this.eIcon.appendChild(i)}},e.prototype.refreshLabel=function(){o(this.getLabel())?tn(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),t.prototype.refreshLabel.call(this)},e.prototype.clickHandler=function(){this.skipClick?this.skipClick=!1:this.isDisabled()||this.showPicker()},e.prototype.onKeyDown=function(t){switch(t.key){case Yr.UP:case Yr.DOWN:case Yr.ENTER:case Yr.SPACE:t.preventDefault(),this.clickHandler();break;case Yr.ESCAPE:this.isPickerDisplayed&&(t.preventDefault(),t.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}},e.prototype.showPicker=function(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());var t=this.pickerComponent.getGui();t.addEventListener("focusin",this.onPickerFocusIn),t.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)},e.prototype.renderAndPositionPicker=function(){var t=this,e=this.gridOptionsService.getDocument(),n=this.pickerComponent.getGui();this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(e.body,"wheel",(function(e){n.contains(e.target)||t.hidePicker()})));var r=this.localeService.getLocaleTextFunc(),o=this.config,i=o.pickerType,s=o.pickerAriaLabelKey,a=o.pickerAriaLabelValue,l={modal:!0,eChild:n,closeOnEsc:!0,closedCallback:function(){var n=e.activeElement===e.body;t.beforeHidePicker(),n&&t.isAlive()&&t.getFocusableElement().focus()},ariaLabel:r(s,a)},u=this.popupService.addPopup(l);return Lr(n,yr(this.eWrapper)),n.style.position="absolute",this.popupService.positionPopupByComponent({type:i,eventSource:this.eWrapper,ePopup:n,position:"under",keepWithinBounds:!0,nudgeY:this.pickerGap}),u.hideFunc},e.prototype.beforeHidePicker=function(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);var t=this.pickerComponent.getGui();t.removeEventListener("focusin",this.onPickerFocusIn),t.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null},e.prototype.toggleExpandedStyles=function(t){this.isAlive()&&(ln(this.eWrapper,t),this.eWrapper.classList.toggle("ag-picker-expanded",t),this.eWrapper.classList.toggle("ag-picker-collapsed",!t))},e.prototype.onPickerFocusIn=function(){this.togglePickerHasFocus(!0)},e.prototype.onPickerFocusOut=function(t){var e;(null===(e=this.pickerComponent)||void 0===e?void 0:e.getGui().contains(t.relatedTarget))||this.togglePickerHasFocus(!1)},e.prototype.togglePickerHasFocus=function(t){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",t)},e.prototype.hidePicker=function(){this.hideCurrentPicker&&this.hideCurrentPicker()},e.prototype.setAriaLabel=function(t){return $e(this.eWrapper,t),this},e.prototype.setInputWidth=function(t){return Lr(this.eWrapper,t),this},e.prototype.getFocusableElement=function(){return this.eWrapper},e.prototype.setPickerGap=function(t){return this.pickerGap=t,this},e.prototype.destroy=function(){this.hidePicker(),t.prototype.destroy.call(this)},Zo([$("popupService")],e.prototype,"popupService",void 0),Zo([To("eLabel")],e.prototype,"eLabel",void 0),Zo([To("eWrapper")],e.prototype,"eWrapper",void 0),Zo([To("eDisplayField")],e.prototype,"eDisplayField",void 0),Zo([To("eIcon")],e.prototype,"eIcon",void 0),e}(Ko),Jo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$o=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ti=function(t){function e(e){void 0===e&&(e="default");var n=t.call(this,'<div class="ag-list ag-'+e+'-list" role="listbox"></div>')||this;return n.cssIdentifier=e,n.options=[],n.itemEls=[],n}return Jo(e,t),e.prototype.init=function(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))},e.prototype.handleKeyDown=function(t){var e=t.key;switch(e){case Yr.ENTER:if(this.highlightedEl){var n=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(n)}else this.setValue(this.getValue());break;case Yr.DOWN:case Yr.UP:var r=e===Yr.DOWN,o=void 0;if(t.preventDefault(),this.highlightedEl){var i=this.itemEls.indexOf(this.highlightedEl)+(r?1:-1);i=Math.min(Math.max(i,0),this.itemEls.length-1),o=this.itemEls[i]}else o=this.itemEls[r?0:this.itemEls.length-1];this.highlightItem(o)}},e.prototype.addOptions=function(t){var e=this;return t.forEach((function(t){return e.addOption(t)})),this},e.prototype.addOption=function(t){var e=t.value,n=re(t.text||e);return this.options.push({value:e,text:n}),this.renderOption(e,n),this.updateIndices(),this},e.prototype.updateIndices=function(){var t=this.getGui().querySelectorAll(".ag-list-item");t.forEach((function(e,n){pn(e,n+1),cn(e,t.length)}))},e.prototype.renderOption=function(t,e){var n=this,r=document.createElement("div");Ye(r,"option"),r.classList.add("ag-list-item","ag-"+this.cssIdentifier+"-list-item"),r.innerHTML="<span>"+e+"</span>",r.tabIndex=-1,this.itemEls.push(r),this.addManagedListener(r,"mouseover",(function(){return n.highlightItem(r)})),this.addManagedListener(r,"mouseleave",(function(){return n.clearHighlighted()})),this.addManagedListener(r,"click",(function(){return n.setValue(t)})),this.getGui().appendChild(r)},e.prototype.setValue=function(t,e){if(this.value===t)return this.fireItemSelected(),this;if(null==t)return this.reset(),this;var n=this.options.findIndex((function(e){return e.value===t}));if(-1!==n){var r=this.options[n];this.value=r.value,this.displayValue=null!=r.text?r.text:r.value,this.highlightItem(this.itemEls[n]),e||this.fireChangeEvent()}return this},e.prototype.setValueByIndex=function(t){return this.setValue(this.options[t].value)},e.prototype.getValue=function(){return this.value},e.prototype.getDisplayValue=function(){return this.displayValue},e.prototype.refreshHighlighted=function(){var t=this;this.clearHighlighted();var e=this.options.findIndex((function(e){return e.value===t.value}));-1!==e&&this.highlightItem(this.itemEls[e])},e.prototype.reset=function(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()},e.prototype.highlightItem=function(t){t.offsetParent&&(this.clearHighlighted(),this.highlightedEl=t,this.highlightedEl.classList.add(e.ACTIVE_CLASS),wn(this.highlightedEl,!0),this.highlightedEl.focus())},e.prototype.clearHighlighted=function(){this.highlightedEl&&this.highlightedEl.offsetParent&&(this.highlightedEl.classList.remove(e.ACTIVE_CLASS),wn(this.highlightedEl,!1),this.highlightedEl=null)},e.prototype.fireChangeEvent=function(){this.dispatchEvent({type:Yt.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()},e.prototype.fireItemSelected=function(){this.dispatchEvent({type:e.EVENT_ITEM_SELECTED})},e.EVENT_ITEM_SELECTED="selectedItem",e.ACTIVE_CLASS="ag-active-item",$o([Z],e.prototype,"init",null),e}(Eo),ei=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ni=function(){return(ni=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ri=function(t){function e(e){return t.call(this,ni({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list"},e),"ag-select","smallDown","listbox")||this}return ei(e,t),e.prototype.postConstruct=function(){var e;t.prototype.postConstruct.call(this),this.createListComponent(),this.eWrapper.tabIndex=null!==(e=this.gridOptionsService.getNum("tabIndex"))&&void 0!==e?e:0},e.prototype.createListComponent=function(){var t=this;this.listComponent=this.createBean(new ti("select")),this.listComponent.setParentComponent(this),this.listComponent.addGuiEventListener("keydown",(function(e){e.key===Yr.TAB&&(e.preventDefault(),e.stopImmediatePropagation(),t.getGui().dispatchEvent(new KeyboardEvent("keydown",{key:e.key,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,bubbles:!0})))})),this.listComponent.addManagedListener(this.listComponent,ti.EVENT_ITEM_SELECTED,(function(){t.hidePicker(),t.dispatchEvent({type:e.EVENT_ITEM_SELECTED})})),this.listComponent.addManagedListener(this.listComponent,Yt.EVENT_FIELD_VALUE_CHANGED,(function(){t.listComponent&&(t.setValue(t.listComponent.getValue(),!1,!0),t.hidePicker())}))},e.prototype.createPickerComponent=function(){return this.listComponent},e.prototype.showPicker=function(){var e=this;if(this.listComponent){t.prototype.showPicker.call(this),this.listComponent.getGui().style.maxHeight=fr(this.popupService.getPopupParent())+"px";var n=this.listComponent.getGui();this.pickerFocusOutListener=this.addManagedListener(n,"focusout",(function(t){n.contains(t.relatedTarget)||e.hidePicker()})),this.listComponent.refreshHighlighted()}},e.prototype.beforeHidePicker=function(){this.pickerFocusOutListener&&(this.pickerFocusOutListener(),this.pickerFocusOutListener=void 0),t.prototype.beforeHidePicker.call(this)},e.prototype.addOptions=function(t){var e=this;return t.forEach((function(t){return e.addOption(t)})),this},e.prototype.addOption=function(t){return this.listComponent.addOption(t),this},e.prototype.setValue=function(e,n,r){return this.value!==e&&this.listComponent?(r||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),t.prototype.setValue.call(this,e,n))):this},e.prototype.destroy=function(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),t.prototype.destroy.call(this)},e.EVENT_ITEM_SELECTED="selectedItem",e}(Qo),oi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ii=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},si=function(t){function e(e,n,r,o){void 0===r&&(r="text"),void 0===o&&(o="input");var i=t.call(this,e,'\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'+o+' ref="eInput" class="ag-input-field-input"></'+o+">\n                </div>\n            </div>",n)||this;return i.inputType=r,i.displayFieldTag=o,i}return oi(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.setInputType(),this.eLabel.classList.add(this.className+"-label"),this.eWrapper.classList.add(this.className+"-input-wrapper"),this.eInput.classList.add(this.className+"-input"),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||"ag-"+this.getCompId()+"-input";var e=this.config,n=e.width,r=e.value;null!=n&&this.setWidth(n),null!=r&&this.setValue(r),this.addInputListeners(),this.activateTabIndex([this.eInput])},e.prototype.refreshLabel=function(){o(this.getLabel())?tn(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),t.prototype.refreshLabel.call(this)},e.prototype.addInputListeners=function(){var t=this;this.addManagedListener(this.eInput,"input",(function(e){return t.setValue(e.target.value)}))},e.prototype.setInputType=function(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)},e.prototype.getInputElement=function(){return this.eInput},e.prototype.setInputWidth=function(t){return Lr(this.eWrapper,t),this},e.prototype.setInputName=function(t){return this.getInputElement().setAttribute("name",t),this},e.prototype.getFocusableElement=function(){return this.eInput},e.prototype.setMaxLength=function(t){return this.eInput.maxLength=t,this},e.prototype.setInputPlaceholder=function(t){return zr(this.eInput,"placeholder",t),this},e.prototype.setInputAriaLabel=function(t){return $e(this.eInput,t),this},e.prototype.setDisabled=function(e){return pr(this.eInput,e),t.prototype.setDisabled.call(this,e)},e.prototype.setAutoComplete=function(t){if(!0===t)zr(this.eInput,"autocomplete",null);else{var e="string"===typeof t?t:"off";zr(this.eInput,"autocomplete",e)}return this},ii([To("eLabel")],e.prototype,"eLabel",void 0),ii([To("eWrapper")],e.prototype,"eWrapper",void 0),ii([To("eInput")],e.prototype,"eInput",void 0),e}(Ko),ai=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),li=function(t){function e(e,n,r){void 0===n&&(n="ag-checkbox"),void 0===r&&(r="checkbox");var o=t.call(this,e,n,r)||this;return o.labelAlignment="right",o.selected=!1,o.readOnly=!1,o.passive=!1,o}return ai(e,t),e.prototype.addInputListeners=function(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))},e.prototype.getNextValue=function(){return void 0===this.selected||!this.selected},e.prototype.setPassive=function(t){this.passive=t},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.setReadOnly=function(t){this.eWrapper.classList.toggle("ag-disabled",t),this.eInput.disabled=t,this.readOnly=t},e.prototype.setDisabled=function(e){return this.eWrapper.classList.toggle("ag-disabled",e),t.prototype.setDisabled.call(this,e)},e.prototype.toggle=function(){if(!this.eInput.disabled){var t=this.isSelected(),e=this.getNextValue();this.passive?this.dispatchChange(e,t):this.setValue(e)}},e.prototype.getValue=function(){return this.isSelected()},e.prototype.setValue=function(t,e){return this.refreshSelectedClass(t),this.setSelected(t,e),this},e.prototype.setName=function(t){return this.getInputElement().name=t,this},e.prototype.isSelected=function(){return this.selected},e.prototype.setSelected=function(t,e){this.isSelected()!==t&&(this.previousValue=this.isSelected(),t=this.selected="boolean"===typeof t?t:void 0,this.eInput.checked=t,this.eInput.indeterminate=void 0===t,e||this.dispatchChange(this.selected,this.previousValue))},e.prototype.dispatchChange=function(t,e,n){this.dispatchEvent({type:Yt.EVENT_FIELD_VALUE_CHANGED,selected:t,previousValue:e,event:n});var r=this.getInputElement(),o={type:Yt.EVENT_CHECKBOX_CHANGED,id:r.id,name:r.name,selected:t,previousValue:e};this.eventService.dispatchEvent(o)},e.prototype.onCheckboxClick=function(t){if(!this.passive&&!this.eInput.disabled){var e=this.isSelected(),n=this.selected=t.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,e,t)}},e.prototype.refreshSelectedClass=function(t){this.eWrapper.classList.toggle("ag-checked",!0===t),this.eWrapper.classList.toggle("ag-indeterminate",null==t)},e}(si),ui=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ci=function(t){function e(e){return t.call(this,e,"ag-radio-button","radio")||this}return ui(e,t),e.prototype.isSelected=function(){return this.eInput.checked},e.prototype.toggle=function(){this.eInput.disabled||this.isSelected()||this.setValue(!0)},e.prototype.addInputListeners=function(){t.prototype.addInputListeners.call(this),this.addManagedListener(this.eventService,Yt.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))},e.prototype.onChange=function(t){t.selected&&t.name&&this.eInput.name&&this.eInput.name===t.name&&t.id&&this.eInput.id!==t.id&&this.setValue(!1,!0)},e}(li),pi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hi=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},di=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},fi=function(){function t(t,e,n){this.localeService=t,this.optionsFactory=e,this.valueFormatter=n}return t.prototype.getModelAsString=function(t){var e=this;if(!t)return null;var n=null!=t.operator,r=this.localeService.getLocaleTextFunc();if(n){var o=t,i=o.conditions;if(!i)i=[o.condition1,o.condition2];var s=i.map((function(t){return e.getModelAsString(t)})),a="AND"===o.operator?"andCondition":"orCondition";return s.join(" "+r(a,Mo[a])+" ")}if(t.type===gi.BLANK||t.type===gi.NOT_BLANK)return r(t.type,t.type);var l=t,u=this.optionsFactory.getCustomOption(l.type),c=u||{},p=c.displayKey,h=c.displayName,d=c.numberOfInputs;return p&&h&&0===d?(r(p,h),h):this.conditionToString(l,u)},t.prototype.updateParams=function(t){this.optionsFactory=t.optionsFactory},t.prototype.formatValue=function(t){var e;return this.valueFormatter?null!==(e=this.valueFormatter(null!==t&&void 0!==t?t:null))&&void 0!==e?e:"":String(t)},t}(),gi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eTypes=[],e.eJoinOperatorPanels=[],e.eJoinOperatorsAnd=[],e.eJoinOperatorsOr=[],e.eConditionBodies=[],e.listener=function(){return e.onUiChanged()},e.lastUiCompletePosition=null,e.joinOperatorId=0,e}return pi(e,t),e.prototype.getNumberOfInputs=function(t){var n=this.optionsFactory.getCustomOption(t);if(n){var r=n.numberOfInputs;return null!=r?r:1}var o=[e.EMPTY,e.NOT_BLANK,e.BLANK];return t&&o.indexOf(t)>=0?0:t===e.IN_RANGE?2:1},e.prototype.onFloatingFilterChanged=function(t,e){this.setTypeFromFloatingFilter(t),this.setValueFromFloatingFilter(e),this.onUiChanged(!0)},e.prototype.setTypeFromFloatingFilter=function(t){var e=this;this.eTypes.forEach((function(n,r){0===r?n.setValue(t,!0):n.setValue(e.optionsFactory.getDefaultOption(),!0)}))},e.prototype.getModelFromUi=function(){var t=this.getUiCompleteConditions();return 0===t.length?null:this.maxNumConditions>1&&t.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:t[0],condition2:t[1],conditions:t}:t[0]},e.prototype.getConditionTypes=function(){return this.eTypes.map((function(t){return t.getValue()}))},e.prototype.getConditionType=function(t){return this.eTypes[t].getValue()},e.prototype.getJoinOperator=function(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"},e.prototype.areModelsEqual=function(t,e){var n=this;if(!t&&!e)return!0;if(!t&&e||t&&!e)return!1;var r,o=!t.operator,i=!e.operator;if(!o&&i||o&&!i)return!1;if(o){var s=t,a=e;r=this.areSimpleModelsEqual(s,a)}else{var l=t,u=e;r=l.operator===u.operator&&vt(l.conditions,u.conditions,(function(t,e){return n.areSimpleModelsEqual(t,e)}))}return r},e.prototype.setModelIntoUi=function(t){var e=this;if(t.operator){var n=t;n.conditions||(n.conditions=[n.condition1,n.condition2]);var r=this.validateAndUpdateConditions(n.conditions),o=this.getNumConditions();if(r<o)this.removeConditionsAndOperators(r);else if(r>o)for(var i=o;i<r;i++)this.createJoinOperatorPanel(),this.createOption();var s="OR"===n.operator;this.eJoinOperatorsAnd.forEach((function(t){return t.setValue(!s,!0)})),this.eJoinOperatorsOr.forEach((function(t){return t.setValue(s,!0)})),n.conditions.forEach((function(t,n){e.eTypes[n].setValue(t.type,!0),e.setConditionIntoUi(t,n)}))}else{var a=t;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(a.type,!0),this.setConditionIntoUi(a,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),fo.resolve()},e.prototype.validateAndUpdateConditions=function(t){var e=t.length;return e>this.maxNumConditions&&(t.splice(this.maxNumConditions),O((function(){return console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.')}),"simpleFilterSetModelMaxNumConditions"),e=this.maxNumConditions),e},e.prototype.doesFilterPass=function(t){var e,n=this,r=this.getModel();if(null==r)return!0;var o=r.operator,i=[];if(o){var s=r;i.push.apply(i,di([],hi(null!==(e=s.conditions)&&void 0!==e?e:[])))}else i.push(r);return i[o&&"OR"===o?"some":"every"]((function(e){return n.individualConditionPasses(t,e)}))},e.prototype.setParams=function(e){t.prototype.setParams.call(this,e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Do,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")},e.prototype.setNumConditions=function(t){var e,n;null!=t.suppressAndOrCondition&&O((function(){return console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.')}),"simpleFilterSuppressAndOrCondition"),null!=t.alwaysShowBothConditions&&O((function(){return console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.')}),"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(e=t.maxNumConditions)&&void 0!==e?e:t.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(O((function(){return console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.')}),"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(n=t.numAlwaysVisibleConditions)&&void 0!==n?n:t.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(O((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.')}),"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(O((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".')}),"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)},e.prototype.createOption=function(){var t=this,e=this.createManagedBean(new ri);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());var n=this.createValueElement();this.eConditionBodies.push(n),this.eFilterBody.appendChild(n),this.putOptionsIntoDropdown(e),this.resetType(e);var r=this.getNumConditions()-1;this.forEachPositionInput(r,(function(e){return t.resetInput(e)})),this.addChangedListeners(e,r)},e.prototype.createJoinOperatorPanel=function(){var t=document.createElement("div");this.eJoinOperatorPanels.push(t),t.classList.add("ag-filter-condition");var e=this.createJoinOperator(this.eJoinOperatorsAnd,t,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,t,"or");this.eFilterBody.appendChild(t);var r=this.eJoinOperatorPanels.length-1,o=this.joinOperatorId++;this.resetJoinOperatorAnd(e,r,o),this.resetJoinOperatorOr(n,r,o),this.isReadOnly()||(e.onValueChange(this.listener),n.onValueChange(this.listener))},e.prototype.createJoinOperator=function(t,e,n){var r=this.createManagedBean(new ci);return t.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass("ag-filter-condition-operator-"+n),e.appendChild(r.getGui()),r},e.prototype.getDefaultJoinOperator=function(t){return"AND"===t||"OR"===t?t:"AND"},e.prototype.createFilterListOptions=function(){var t=this,e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map((function(e){return"string"===typeof e?t.createBoilerplateListOption(e):t.createCustomListOption(e)}))},e.prototype.putOptionsIntoDropdown=function(t){this.filterListOptions.forEach((function(e){t.addOption(e)})),t.setDisabled(this.filterListOptions.length<=1)},e.prototype.createBoilerplateListOption=function(t){return{value:t,text:this.translate(t)}},e.prototype.createCustomListOption=function(t){var e=t.displayKey,n=this.optionsFactory.getCustomOption(t.displayKey);return{value:e,text:n?this.localeService.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(e)}},e.prototype.isAllowTwoConditions=function(){return this.maxNumConditions>=2},e.prototype.createBodyTemplate=function(){return""},e.prototype.getCssIdentifier=function(){return"simple-filter"},e.prototype.updateUiVisibility=function(){var t=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,t)},e.prototype.updateNumConditions=function(){for(var t,e=-1,n=!0,r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:n=!1;if(this.shouldAddNewConditionAtEnd(n))this.createJoinOperatorPanel(),this.createOption();else{var o=null!==(t=this.lastUiCompletePosition)&&void 0!==t?t:this.getNumConditions()-2;if(e<o){this.removeConditionsAndOperators(o+1);var i=e+1,s=o-i;s>0&&this.removeConditionsAndOperators(i,s),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e},e.prototype.updateConditionStatusesAndValues=function(t,e){var n=this;this.eTypes.forEach((function(e,r){var o=n.isConditionDisabled(r,t);e.setDisabled(o||n.filterListOptions.length<=1),1===r&&(pr(n.eJoinOperatorPanels[0],o),n.eJoinOperatorsAnd[0].setDisabled(o),n.eJoinOperatorsOr[0].setDisabled(o))})),this.eConditionBodies.forEach((function(t,e){ur(t,n.isConditionBodyVisible(e))}));var r="OR"===(null!==e&&void 0!==e?e:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((function(t,e){t.setValue(!r,!0)})),this.eJoinOperatorsOr.forEach((function(t,e){t.setValue(r,!0)})),this.forEachInput((function(e,r,o,i){n.setElementDisplayed(e,r<i),n.setElementDisabled(e,n.isConditionDisabled(o,t))})),this.resetPlaceholder()},e.prototype.shouldAddNewConditionAtEnd=function(t){return t&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()},e.prototype.removeConditionsAndOperators=function(t,e){if(!(t>=this.getNumConditions())){this.removeComponents(this.eTypes,t,e),this.removeElements(this.eConditionBodies,t,e),this.removeValueElements(t,e);var n=Math.max(t-1,0);this.removeElements(this.eJoinOperatorPanels,n,e),this.removeComponents(this.eJoinOperatorsAnd,n,e),this.removeComponents(this.eJoinOperatorsOr,n,e)}},e.prototype.removeElements=function(t,e,n){this.removeItems(t,e,n).forEach((function(t){return xr(t)}))},e.prototype.removeComponents=function(t,e,n){var r=this;this.removeItems(t,e,n).forEach((function(t){xr(t.getGui()),r.destroyBean(t)}))},e.prototype.removeItems=function(t,e,n){return null==n?t.splice(e):t.splice(e,n)},e.prototype.afterGuiAttached=function(e){if(t.prototype.afterGuiAttached.call(this,e),this.resetPlaceholder(),!(null===e||void 0===e?void 0:e.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{var n=this.getInputs(0)[0];if(!n)return;n instanceof si&&n.getInputElement().focus()}},e.prototype.afterGuiDetached=function(){t.prototype.afterGuiDetached.call(this);var e=this.getModel();this.areModelsEqual(e,this.getModelFromUi())&&!this.hasInvalidInputs()||this.resetUiToActiveModel(e);for(var n=-1,r=-1,o=!1,i=this.getJoinOperator(),s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))-1===n&&(n=s,r=s);else{var a=s<n;(s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1)||a)&&(this.removeConditionsAndOperators(s,1),o=!0,a&&r--)}var l=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),l=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),l=!0),l&&this.updateConditionStatusesAndValues(r,i),o&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r},e.prototype.getPlaceholderText=function(t,e){var n=this.translate(t);if(A(this.filterPlaceholder)){var r=this.filterPlaceholder,o=this.eTypes[e].getValue();n=r({filterOptionKey:o,filterOption:this.translate(o),placeholder:n})}else"string"===typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n},e.prototype.resetPlaceholder=function(){var t=this,e=this.localeService.getLocaleTextFunc();this.forEachInput((function(n,r,o,i){if(n instanceof si){var s=0===r&&i>1?"inRangeStart":0===r?"filterOoo":"inRangeEnd",a=0===r&&i>1?e("ariaFilterFromValue","Filter from value"):0===r?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");n.setInputPlaceholder(t.getPlaceholderText(s,o)),n.setInputAriaLabel(a)}}))},e.prototype.setElementValue=function(t,e){t instanceof si&&t.setValue(null!=e?String(e):null,!0)},e.prototype.setElementDisplayed=function(t,e){t instanceof Eo&&ur(t.getGui(),e)},e.prototype.setElementDisabled=function(t,e){t instanceof Eo&&pr(t.getGui(),e)},e.prototype.attachElementOnChange=function(t,e){t instanceof si&&t.onValueChange(e)},e.prototype.forEachInput=function(t){var e=this;this.getConditionTypes().forEach((function(n,r){e.forEachPositionTypeInput(r,n,t)}))},e.prototype.forEachPositionInput=function(t,e){var n=this.getConditionType(t);this.forEachPositionTypeInput(t,n,e)},e.prototype.forEachPositionTypeInput=function(t,e,n){for(var r=this.getNumberOfInputs(e),o=this.getInputs(t),i=0;i<o.length;i++){var s=o[i];null!=s&&n(s,i,t,r)}},e.prototype.isConditionDisabled=function(t,e){return!!this.isReadOnly()||0!==t&&t>e+1},e.prototype.isConditionBodyVisible=function(t){var e=this.getConditionType(t);return this.getNumberOfInputs(e)>0},e.prototype.isConditionUiComplete=function(t){return!(t>=this.getNumConditions())&&(this.getConditionType(t)!==e.EMPTY&&!this.getValues(t).some((function(t){return null==t})))},e.prototype.getNumConditions=function(){return this.eTypes.length},e.prototype.getUiCompleteConditions=function(){for(var t=[],e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)&&t.push(this.createCondition(e));return t},e.prototype.createMissingConditionsAndOperators=function(){if(!this.isReadOnly())for(var t=this.getNumConditions();t<this.numAlwaysVisibleConditions;t++)this.createJoinOperatorPanel(),this.createOption()},e.prototype.resetUiToDefaults=function(t){var e=this;return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((function(t){return e.resetType(t)})),this.eJoinOperatorsAnd.forEach((function(t,n){return e.resetJoinOperatorAnd(t,n,e.joinOperatorId+n)})),this.eJoinOperatorsOr.forEach((function(t,n){return e.resetJoinOperatorOr(t,n,e.joinOperatorId+n)})),this.joinOperatorId++,this.forEachInput((function(t){return e.resetInput(t)})),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,t||this.onUiChanged(),fo.resolve()},e.prototype.resetType=function(t){var e=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");t.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(e).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)},e.prototype.resetJoinOperatorAnd=function(t,e,n){this.resetJoinOperator(t,e,this.isDefaultOperator("AND"),this.translate("andCondition"),n)},e.prototype.resetJoinOperatorOr=function(t,e,n){this.resetJoinOperator(t,e,this.isDefaultOperator("OR"),this.translate("orCondition"),n)},e.prototype.resetJoinOperator=function(t,e,n,r,o){this.updateJoinOperatorDisabled(t.setValue(n,!0).setName("ag-simple-filter-and-or-"+this.getCompId()+"-"+o).setLabel(r),e)},e.prototype.updateJoinOperatorsDisabled=function(){var t=this;this.eJoinOperatorsAnd.forEach((function(e,n){return t.updateJoinOperatorDisabled(e,n)})),this.eJoinOperatorsOr.forEach((function(e,n){return t.updateJoinOperatorDisabled(e,n)}))},e.prototype.updateJoinOperatorDisabled=function(t,e){t.setDisabled(this.isReadOnly()||e>0)},e.prototype.resetInput=function(t){this.setElementValue(t,null),this.setElementDisabled(t,this.isReadOnly())},e.prototype.setConditionIntoUi=function(t,e){var n=this,r=this.mapValuesFromModel(t);this.forEachInput((function(t,o,i,s){i===e&&n.setElementValue(t,null!=r[o]?r[o]:null)}))},e.prototype.setValueFromFloatingFilter=function(t){var e=this;this.forEachInput((function(n,r,o,i){e.setElementValue(n,0===r&&0===o?t:null)}))},e.prototype.isDefaultOperator=function(t){return t===this.defaultJoinOperator},e.prototype.addChangedListeners=function(t,e){var n=this;this.isReadOnly()||(t.onValueChange(this.listener),this.forEachPositionInput(e,(function(t){n.attachElementOnChange(t,n.listener)})))},e.prototype.individualConditionPasses=function(t,e){var n=this.getCellValue(t.node),r=this.mapValuesFromModel(e),o=this.optionsFactory.getCustomOption(e.type),i=this.evaluateCustomFilter(o,r,n);return null!=i?i:null==n?this.evaluateNullValue(e.type):this.evaluateNonNullValue(r,n,e,t)},e.prototype.evaluateCustomFilter=function(t,e,n){if(null!=t){var r=t.predicate;return null==r||e.some((function(t){return null==t}))?void 0:r(e,n)}},e.prototype.isBlank=function(t){return null==t||"string"===typeof t&&0===t.trim().length},e.prototype.hasInvalidInputs=function(){return!1},e.EMPTY="empty",e.BLANK="blank",e.NOT_BLANK="notBlank",e.EQUALS="equals",e.NOT_EQUAL="notEqual",e.LESS_THAN="lessThan",e.LESS_THAN_OR_EQUAL="lessThanOrEqual",e.GREATER_THAN="greaterThan",e.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e.IN_RANGE="inRange",e.CONTAINS="contains",e.NOT_CONTAINS="notContains",e.STARTS_WITH="startsWith",e.ENDS_WITH="endsWith",e}(Ho),mi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return mi(e,t),e.prototype.setParams=function(e){t.prototype.setParams.call(this,e),this.scalarFilterParams=e},e.prototype.evaluateNullValue=function(t){switch(t){case e.EQUALS:case e.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case e.GREATER_THAN:case e.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case e.LESS_THAN:case e.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case e.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case e.BLANK:return!0;case e.NOT_BLANK:return!1}return!1},e.prototype.evaluateNonNullValue=function(t,n,r){var o=this.comparator(),i=null!=t[0]?o(t[0],n):0;switch(r.type){case e.EQUALS:return 0===i;case e.NOT_EQUAL:return 0!==i;case e.GREATER_THAN:return i>0;case e.GREATER_THAN_OR_EQUAL:return i>=0;case e.LESS_THAN:return i<0;case e.LESS_THAN_OR_EQUAL:return i<=0;case e.IN_RANGE:var s=o(t[1],n);return this.scalarFilterParams.inRangeInclusive?i>=0&&s<=0:i>0&&s<0;case e.BLANK:return this.isBlank(n);case e.NOT_BLANK:return!this.isBlank(n);default:return console.warn('AG Grid: Unexpected type of filter "'+r.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}},e}(gi),vi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_i=function(){return(_i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},wi=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ci=function(t){function e(e,n,r){var o=t.call(this,n,r)||this;return o.dateFilterParams=e,o}return vi(e,t),e.prototype.conditionToString=function(t,e){var n=t.type,r=(e||{}).numberOfInputs,o=n==gi.IN_RANGE||2===r,i=nr(t.dateFrom),s=nr(t.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;return o?(null!==i?er(i,a):"null")+"-"+(null!==s?er(s,a):"null"):null!=i?er(i,a):""+n},e.prototype.updateParams=function(e){t.prototype.updateParams.call(this,e),this.dateFilterParams=e.dateFilterParams},e}(fi),bi=function(t){function e(){var e=t.call(this,"dateFilter")||this;return e.eConditionPanelsFrom=[],e.eConditionPanelsTo=[],e.dateConditionFromComps=[],e.dateConditionToComps=[],e.minValidYear=1e3,e.maxValidYear=1/0,e}return vi(e,t),e.prototype.afterGuiAttached=function(e){t.prototype.afterGuiAttached.call(this,e),this.dateConditionFromComps[0].afterGuiAttached(e)},e.prototype.mapValuesFromModel=function(t){var e=t||{},n=e.dateFrom,r=e.dateTo,o=e.type;return[n&&nr(n)||null,r&&nr(r)||null].slice(0,this.getNumberOfInputs(o))},e.prototype.comparator=function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)},e.prototype.defaultComparator=function(t,e){return null==e||e<t?-1:e>t?1:0},e.prototype.setParams=function(e){this.dateFilterParams=e,t.prototype.setParams.call(this,e);var n=function(t,n){if(null!=e[t]){if(!isNaN(e[t]))return null==e[t]?n:Number(e[t]);console.warn("AG Grid: DateFilter "+t+" is not a number")}return n};this.minValidYear=n("minValidYear",1e3),this.maxValidYear=n("maxValidYear",1/0),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new Ci(this.dateFilterParams,this.localeService,this.optionsFactory)},e.prototype.createDateCompWrapper=function(t){var e=this,n=new Ao(this.getContext(),this.userComponentFactory,{onDateChanged:function(){return e.onUiChanged()},filterParams:this.dateFilterParams},t);return this.addDestroyFunc((function(){return n.destroy()})),n},e.prototype.setElementValue=function(t,e){t.setDate(e)},e.prototype.setElementDisplayed=function(t,e){t.setDisplayed(e)},e.prototype.setElementDisabled=function(t,e){t.setDisabled(e)},e.prototype.getDefaultFilterOptions=function(){return e.DEFAULT_FILTER_OPTIONS},e.prototype.createValueElement=function(){var t=document.createElement("div");return t.classList.add("ag-filter-body"),this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t},e.prototype.createFromToElement=function(t,e,n,r){var o=document.createElement("div");o.classList.add("ag-filter-"+r),o.classList.add("ag-filter-date-"+r),e.push(o),t.appendChild(o),n.push(this.createDateCompWrapper(o))},e.prototype.removeValueElements=function(t,e){this.removeDateComps(this.dateConditionFromComps,t,e),this.removeDateComps(this.dateConditionToComps,t,e),this.removeItems(this.eConditionPanelsFrom,t,e),this.removeItems(this.eConditionPanelsTo,t,e)},e.prototype.removeDateComps=function(t,e,n){this.removeItems(t,e,n).forEach((function(t){return t.destroy()}))},e.prototype.isConditionUiComplete=function(e){var n=this;if(!t.prototype.isConditionUiComplete.call(this,e))return!1;var r=!0;return this.forEachInput((function(t,o,i,s){var a;i!==e||!r||o>=s||(r=r&&(null!=(a=t.getDate())&&a.getUTCFullYear()>=n.minValidYear&&a.getUTCFullYear()<=n.maxValidYear))})),r},e.prototype.areSimpleModelsEqual=function(t,e){return t.dateFrom===e.dateFrom&&t.dateTo===e.dateTo&&t.type===e.type},e.prototype.getFilterType=function(){return"date"},e.prototype.createCondition=function(t){var e=this.getConditionType(t),n={},r=this.getValues(t);return r.length>0&&(n.dateFrom=$n(r[0])),r.length>1&&(n.dateTo=$n(r[1])),_i({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:e},n)},e.prototype.resetPlaceholder=function(){var t=this.localeService.getLocaleTextFunc(),e=this.translate("dateFormatOoo"),n=t("ariaFilterValue","Filter Value");this.forEachInput((function(t){t.setInputPlaceholder(e),t.setInputAriaLabel(n)}))},e.prototype.getInputs=function(t){return t>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[t],this.dateConditionToComps[t]]},e.prototype.getValues=function(t){var e=[];return this.forEachPositionInput(t,(function(t,n,r,o){n<o&&e.push(t.getDate())})),e},e.prototype.getModelAsString=function(t){var e;return null!==(e=this.filterModelFormatter.getModelAsString(t))&&void 0!==e?e:""},e.DEFAULT_FILTER_OPTIONS=[yi.EQUALS,yi.GREATER_THAN,yi.LESS_THAN,yi.NOT_EQUAL,yi.IN_RANGE,yi.BLANK,yi.NOT_BLANK],wi([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),e}(yi),xi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xi(e,t),e.prototype.getDefaultDebounceMs=function(){return 0},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.isEventFromFloatingFilter=function(t){return t&&t.afterFloatingFilter},e.prototype.isEventFromDataChange=function(t){return null===t||void 0===t?void 0:t.afterDataChange},e.prototype.getLastType=function(){return this.lastType},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.setLastTypeFromModel=function(t){if(t){var e;if(t.operator)e=t.conditions[0];else e=t;this.lastType=e.type}else this.lastType=this.optionsFactory.getDefaultOption()},e.prototype.canWeEditAfterModelFromParentFilter=function(t){if(!t)return this.isTypeEditable(this.lastType);if(t.operator)return!1;var e=t;return this.isTypeEditable(e.type)},e.prototype.init=function(t){this.setSimpleParams(t)},e.prototype.setSimpleParams=function(t){this.optionsFactory=new Do,this.optionsFactory.init(t.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!t.filterParams.readOnly;var e=this.isTypeEditable(this.lastType);this.setEditable(e)},e.prototype.onParamsUpdated=function(t){this.setSimpleParams(t)},e.prototype.doesFilterHaveSingleInput=function(t){var e=(this.optionsFactory.getCustomOption(t)||{}).numberOfInputs;return null==e||1==e},e.prototype.isTypeEditable=function(t){var e=[gi.IN_RANGE,gi.EMPTY,gi.BLANK,gi.NOT_BLANK];return!!t&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(t)&&e.indexOf(t)<0},e}(Eo),Si=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ti=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ri=function(t){function e(){return t.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')||this}return Si(e,t),e.prototype.getDefaultFilterOptions=function(){return bi.DEFAULT_FILTER_OPTIONS},e.prototype.init=function(e){t.prototype.init.call(this,e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new Ci(this.filterParams,this.localeService,this.optionsFactory);var n=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(n("ariaDateFilterInput","Date Filter Input"))},e.prototype.onParamsUpdated=function(e){t.prototype.onParamsUpdated.call(this,e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams})},e.prototype.setEditable=function(t){ur(this.eDateWrapper,t),ur(this.eReadOnlyText.getGui(),!t)},e.prototype.onParentModelChanged=function(e,n){if(!this.isEventFromFloatingFilter(n)&&!this.isEventFromDataChange(n)){t.prototype.setLastTypeFromModel.call(this,e);var r=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(r),r){if(e){var o=e;this.dateComp.setDate(nr(o.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}},e.prototype.onDateChanged=function(){var t=this,e=$n(this.dateComp.getDate());this.params.parentFilterInstance((function(n){if(n){var r=nr(e);n.onFloatingFilterChanged(t.getLastType()||null,r)}}))},e.prototype.getDateComponentParams=function(){var t=Ho.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:k(this.onDateChanged.bind(this),t),filterParams:this.params.column.getColDef().filterParams}},e.prototype.createDateComponent=function(){var t=this;this.dateComp=new Ao(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper),this.addDestroyFunc((function(){return t.dateComp.destroy()}))},e.prototype.updateDateComponent=function(){var t=this.getDateComponentParams(),e=this.gridOptionsService,n=e.api,r=e.columnApi,o=e.context;t.api=n,t.columnApi=r,t.context=o,this.dateComp.updateParams(t)},e.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},Ti([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Ti([To("eReadOnlyText")],e.prototype,"eReadOnlyText",void 0),Ti([To("eDateWrapper")],e.prototype,"eDateWrapper",void 0),e}(Ei),Pi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oi=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ii=function(t){function e(){return t.call(this,'\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')||this}return Pi(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){var e=this;this.params=t,this.setParams(t);var n=this.gridOptionsService.getDocument(),r=this.eDateInput.getInputElement();this.addManagedListener(r,"mousedown",(function(){e.eDateInput.isDisabled()||e.usingSafariDatePicker||r.focus()})),this.addManagedListener(r,"input",(function(t){t.target===n.activeElement&&(e.eDateInput.isDisabled()||e.params.onDateChanged())}))},e.prototype.setParams=function(t){var e=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(t);this.usingSafariDatePicker=n&&Mn(),e.type=n?"date":"text";var r=t.filterParams||{},o=r.minValidYear,i=r.maxValidYear;o&&(e.min=o+"-01-01"),i&&(e.max=i+"-12-31")},e.prototype.onParamsUpdated=function(t){this.params=t,this.setParams(t)},e.prototype.getDate=function(){return nr(this.eDateInput.getValue())},e.prototype.setDate=function(t){this.eDateInput.setValue($n(t,!1))},e.prototype.setInputPlaceholder=function(t){this.eDateInput.setInputPlaceholder(t)},e.prototype.setDisabled=function(t){this.eDateInput.setDisabled(t)},e.prototype.afterGuiAttached=function(t){t&&t.suppressFocus||this.eDateInput.getInputElement().focus()},e.prototype.shouldUseBrowserDatePicker=function(t){return t.filterParams&&null!=t.filterParams.browserDatePicker?t.filterParams.browserDatePicker:Nn()||Fn()||Mn()&&Ln()>=14.1},Oi([To("eDateInput")],e.prototype,"eDateInput",void 0),e}(Eo),Ai=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Di=function(t){function e(e,n,r){return void 0===n&&(n="ag-text-field"),void 0===r&&(r="text"),t.call(this,e,n,r)||this}return Ai(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.config.allowedCharPattern&&this.preventDisallowedCharacters()},e.prototype.setValue=function(e,n){return this.eInput.value!==e&&(this.eInput.value=o(e)?e:""),t.prototype.setValue.call(this,e,n)},e.prototype.setStartValue=function(t){this.setValue(t,!0)},e.prototype.preventDisallowedCharacters=function(){var t=new RegExp("["+this.config.allowedCharPattern+"]");this.addManagedListener(this.eInput,"keydown",(function(e){Zr(e)&&e.key&&!t.test(e.key)&&e.preventDefault()})),this.addManagedListener(this.eInput,"paste",(function(e){var n,r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text");r&&r.split("").some((function(e){return!t.test(e)}))&&e.preventDefault()}))},e}(si),Mi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Li=function(t){function e(e){return t.call(this,e,"ag-number-field","number")||this}return Mi(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"blur",(function(){var t=parseFloat(e.eInput.value),n=isNaN(t)?"":e.normalizeValue(t.toString());e.value!==n&&e.setValue(n)})),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"},e.prototype.onWheel=function(t){document.activeElement===this.eInput&&t.preventDefault()},e.prototype.normalizeValue=function(t){if(""===t)return"";null!=this.precision&&(t=this.adjustPrecision(t));var e=parseFloat(t);return null!=this.min&&e<this.min?t=this.min.toString():null!=this.max&&e>this.max&&(t=this.max.toString()),t},e.prototype.adjustPrecision=function(t,e){if(null==this.precision)return t;if(e){var n=parseFloat(t).toFixed(this.precision);return parseFloat(n).toString()}var r=String(t).split(".");if(r.length>1){if(r[1].length<=this.precision)return t;if(this.precision>0)return r[0]+"."+r[1].slice(0,this.precision)}return r[0]},e.prototype.setMin=function(t){return this.min===t||(this.min=t,zr(this.eInput,"min",t)),this},e.prototype.setMax=function(t){return this.max===t||(this.max=t,zr(this.eInput,"max",t)),this},e.prototype.setPrecision=function(t){return this.precision=t,this},e.prototype.setStep=function(t){return this.step===t||(this.step=t,zr(this.eInput,"step",t)),this},e.prototype.setValue=function(e,n){var r=this;return this.setValueOrInputValue((function(e){return t.prototype.setValue.call(r,e,n)}),(function(){return r}),e)},e.prototype.setStartValue=function(e){var n=this;return this.setValueOrInputValue((function(e){return t.prototype.setValue.call(n,e,!0)}),(function(t){n.eInput.value=t}),e)},e.prototype.setValueOrInputValue=function(t,e,n){if(o(n)){var r=this.isScientificNotation(n);if(r&&this.eInput.validity.valid)return t(n);if(!r)r=(n=this.adjustPrecision(n))!=this.normalizeValue(n);if(r)return e(n)}return t(n)},e.prototype.getValue=function(){if(this.eInput.validity.valid){var e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):t.prototype.getValue.call(this)}},e.prototype.isScientificNotation=function(t){return"string"===typeof t&&t.includes("e")},e}(Di),Ni=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ni(e,t),e.prototype.conditionToString=function(t,e){var n=(e||{}).numberOfInputs;return t.type==gi.IN_RANGE||2===n?this.formatValue(t.filter)+"-"+this.formatValue(t.filterTo):null!=t.filter?this.formatValue(t.filter):""+t.type},e}(fi);function ki(t){var e=(null!==t&&void 0!==t?t:{}).allowedCharPattern;return null!==e&&void 0!==e?e:null}var Gi,Bi,Vi,zi=function(t){function e(){var e=t.call(this,"numberFilter")||this;return e.eValuesFrom=[],e.eValuesTo=[],e}return Ni(e,t),e.prototype.mapValuesFromModel=function(t){var e=t||{},n=e.filter,r=e.filterTo,o=e.type;return[this.processValue(n),this.processValue(r)].slice(0,this.getNumberOfInputs(o))},e.prototype.getDefaultDebounceMs=function(){return 500},e.prototype.comparator=function(){return function(t,e){return t===e?0:t<e?1:-1}},e.prototype.setParams=function(e){this.numberFilterParams=e,t.prototype.setParams.call(this,e),this.filterModelFormatter=new Fi(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)},e.prototype.getDefaultFilterOptions=function(){return e.DEFAULT_FILTER_OPTIONS},e.prototype.setElementValue=function(e,n){var r=this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(null!==n&&void 0!==n?n:null):n;t.prototype.setElementValue.call(this,e,r)},e.prototype.createValueElement=function(){var t=ki(this.numberFilterParams),e=document.createElement("div");return e.classList.add("ag-filter-body"),Ye(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from",t),this.createFromToElement(e,this.eValuesTo,"to",t),e},e.prototype.createFromToElement=function(t,e,n,r){var o=this.createManagedBean(r?new Di({allowedCharPattern:r}):new Li);o.addCssClass("ag-filter-"+n),o.addCssClass("ag-filter-filter"),e.push(o),t.appendChild(o.getGui())},e.prototype.removeValueElements=function(t,e){this.removeComponents(this.eValuesFrom,t,e),this.removeComponents(this.eValuesTo,t,e)},e.prototype.getValues=function(t){var e=this,n=[];return this.forEachPositionInput(t,(function(t,r,o,i){r<i&&n.push(e.processValue(e.stringToFloat(t.getValue())))})),n},e.prototype.areSimpleModelsEqual=function(t,e){return t.filter===e.filter&&t.filterTo===e.filterTo&&t.type===e.type},e.prototype.getFilterType=function(){return"number"},e.prototype.processValue=function(t){return null==t||isNaN(t)?null:t},e.prototype.stringToFloat=function(t){if("number"===typeof t)return t;var e=r(t);return null!=e&&""===e.trim()&&(e=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(e):null==e||"-"===e.trim()?null:parseFloat(e)},e.prototype.createCondition=function(t){var e=this.getConditionType(t),n={filterType:this.getFilterType(),type:e},r=this.getValues(t);return r.length>0&&(n.filter=r[0]),r.length>1&&(n.filterTo=r[1]),n},e.prototype.getInputs=function(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]},e.prototype.getModelAsString=function(t){var e;return null!==(e=this.filterModelFormatter.getModelAsString(t))&&void 0!==e?e:""},e.prototype.hasInvalidInputs=function(){var t=!1;return this.forEachInput((function(e){e.getInputElement().validity.valid||(t=!0)})),t},e.DEFAULT_FILTER_OPTIONS=[yi.EQUALS,yi.NOT_EQUAL,yi.LESS_THAN,yi.LESS_THAN_OR_EQUAL,yi.GREATER_THAN,yi.GREATER_THAN_OR_EQUAL,yi.IN_RANGE,yi.BLANK,yi.NOT_BLANK],e}(yi),ji=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hi=function(){return(Hi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ji(e,t),e.prototype.conditionToString=function(t,e){var n=(e||{}).numberOfInputs;return t.type==gi.IN_RANGE||2===n?t.filter+"-"+t.filterTo:null!=t.filter?""+t.filter:""+t.type},e}(fi),Wi=function(t){function e(){var e=t.call(this,"textFilter")||this;return e.eValuesFrom=[],e.eValuesTo=[],e}return ji(e,t),e.trimInput=function(t){var e=t&&t.trim();return""===e?t:e},e.prototype.getDefaultDebounceMs=function(){return 500},e.prototype.setParams=function(n){this.textFilterParams=n,t.prototype.setParams.call(this,n),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?e.DEFAULT_FORMATTER:e.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new Ui(this.localeService,this.optionsFactory)},e.prototype.getTextMatcher=function(){var t=this.textFilterParams.textCustomComparator;return t?(uo.doOnce((function(){return console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead.")}),"textCustomComparator.deprecated"),function(e){var n=e.filterOption,r=e.value,o=e.filterText;return t(n,r,o)}):this.textFilterParams.textMatcher||e.DEFAULT_MATCHER},e.prototype.createCondition=function(t){var e=this.getConditionType(t),n={filterType:this.getFilterType(),type:e},r=this.getValuesWithSideEffects(t,!0);return r.length>0&&(n.filter=r[0]),r.length>1&&(n.filterTo=r[1]),n},e.prototype.getFilterType=function(){return"text"},e.prototype.areSimpleModelsEqual=function(t,e){return t.filter===e.filter&&t.filterTo===e.filterTo&&t.type===e.type},e.prototype.getInputs=function(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]},e.prototype.getValues=function(t){return this.getValuesWithSideEffects(t,!1)},e.prototype.getValuesWithSideEffects=function(t,n){var o=this,i=[];return this.forEachPositionInput(t,(function(t,s,a,l){var u;if(s<l){var c=r(t.getValue());n&&o.textFilterParams.trimInput&&(c=null!==(u=e.trimInput(c))&&void 0!==u?u:null,t.setValue(c,!0)),i.push(c)}})),i},e.prototype.getDefaultFilterOptions=function(){return e.DEFAULT_FILTER_OPTIONS},e.prototype.createValueElement=function(){var t=document.createElement("div");return t.classList.add("ag-filter-body"),Ye(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from"),this.createFromToElement(t,this.eValuesTo,"to"),t},e.prototype.createFromToElement=function(t,e,n){var r=this.createManagedBean(new Di);r.addCssClass("ag-filter-"+n),r.addCssClass("ag-filter-filter"),e.push(r),t.appendChild(r.getGui())},e.prototype.removeValueElements=function(t,e){this.removeComponents(this.eValuesFrom,t,e),this.removeComponents(this.eValuesTo,t,e)},e.prototype.mapValuesFromModel=function(t){var e=t||{},n=e.filter,r=e.filterTo,o=e.type;return[n||null,r||null].slice(0,this.getNumberOfInputs(o))},e.prototype.evaluateNullValue=function(t){var e=[gi.NOT_EQUAL,gi.NOT_CONTAINS,gi.BLANK];return!!t&&e.indexOf(t)>=0},e.prototype.evaluateNonNullValue=function(t,e,n,r){var o=this,i=t.map((function(t){return o.formatter(t)}))||[],s=this.formatter(e),a=this.textFilterParams,l=a.api,u=a.colDef,c=a.column,p=a.columnApi,h=a.context,d=a.textFormatter;if(n.type===gi.BLANK)return this.isBlank(e);if(n.type===gi.NOT_BLANK)return!this.isBlank(e);var f={api:l,colDef:u,column:c,columnApi:p,context:h,node:r.node,data:r.data,filterOption:n.type,value:s,textFormatter:d};return i.some((function(t){return o.matcher(Hi(Hi({},f),{filterText:t}))}))},e.prototype.getModelAsString=function(t){var e;return null!==(e=this.filterModelFormatter.getModelAsString(t))&&void 0!==e?e:""},e.DEFAULT_FILTER_OPTIONS=[gi.CONTAINS,gi.NOT_CONTAINS,gi.EQUALS,gi.NOT_EQUAL,gi.STARTS_WITH,gi.ENDS_WITH,gi.BLANK,gi.NOT_BLANK],e.DEFAULT_FORMATTER=function(t){return t},e.DEFAULT_LOWERCASE_FORMATTER=function(t){return null==t?null:t.toString().toLowerCase()},e.DEFAULT_MATCHER=function(t){var n=t.filterOption,r=t.value,o=t.filterText;if(null==o)return!1;switch(n){case e.CONTAINS:return r.indexOf(o)>=0;case e.NOT_CONTAINS:return r.indexOf(o)<0;case e.EQUALS:return r===o;case e.NOT_EQUAL:return r!=o;case e.STARTS_WITH:return 0===r.indexOf(o);case e.ENDS_WITH:var i=r.lastIndexOf(o);return i>=0&&i===r.length-o.length;default:return!1}},e}(gi),qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xi=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ki=function(t){function e(e){var n=t.call(this)||this;return n.params=e,n.valueChangedListener=function(){},n}return qi(e,t),e.prototype.setupGui=function(t){var e,n=this;this.eFloatingFilterTextInput=this.createManagedBean(new Di(null===(e=this.params)||void 0===e?void 0:e.config));var r=this.eFloatingFilterTextInput.getGui();t.appendChild(r),this.addManagedListener(r,"input",(function(t){return n.valueChangedListener(t)})),this.addManagedListener(r,"keydown",(function(t){return n.valueChangedListener(t)}))},e.prototype.setEditable=function(t){this.eFloatingFilterTextInput.setDisabled(!t)},e.prototype.setAutoComplete=function(t){this.eFloatingFilterTextInput.setAutoComplete(t)},e.prototype.getValue=function(){return this.eFloatingFilterTextInput.getValue()},e.prototype.setValue=function(t,e){this.eFloatingFilterTextInput.setValue(t,e)},e.prototype.setValueChangedListener=function(t){this.valueChangedListener=t},e.prototype.setParams=function(t){this.setAriaLabel(t.ariaLabel),void 0!==t.autoComplete&&this.setAutoComplete(t.autoComplete)},e.prototype.setAriaLabel=function(t){this.eFloatingFilterTextInput.setInputAriaLabel(t)},e}(jt),Yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qi(e,t),e.prototype.postConstruct=function(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')},e.prototype.getDefaultDebounceMs=function(){return 500},e.prototype.onParentModelChanged=function(t,e){this.isEventFromFloatingFilter(e)||this.isEventFromDataChange(e)||(this.setLastTypeFromModel(t),this.setEditable(this.canWeEditAfterModelFromParentFilter(t)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(t)))},e.prototype.init=function(e){this.setupFloatingFilterInputService(e),t.prototype.init.call(this,e),this.setTextInputParams(e)},e.prototype.setupFloatingFilterInputService=function(t){this.floatingFilterInputService=this.createFloatingFilterInputService(t),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)},e.prototype.setTextInputParams=function(t){var e;this.params=t;var n=null!==(e=t.browserAutoComplete)&&void 0!==e&&e;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(t),autoComplete:n}),this.applyActive=Ho.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){var r=Ho.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),o=k(this.syncUpWithParentFilter.bind(this),r);this.floatingFilterInputService.setValueChangedListener(o)}},e.prototype.onParamsUpdated=function(e){t.prototype.onParamsUpdated.call(this,e),this.setTextInputParams(e)},e.prototype.recreateFloatingFilterInputService=function(t){var e=this.floatingFilterInputService.getValue();br(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(t),this.floatingFilterInputService.setValue(e,!0)},e.prototype.getAriaLabel=function(t){return this.columnModel.getDisplayNameForColumn(t.column,"header",!0)+" "+this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")},e.prototype.syncUpWithParentFilter=function(t){var e=this,n=t.key===Yr.ENTER;if(!this.applyActive||n){var r=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(r=Wi.trimInput(r),this.floatingFilterInputService.setValue(r,!0)),this.params.parentFilterInstance((function(t){t&&t.onFloatingFilterChanged(e.getLastType()||null,r||null)}))}},e.prototype.setEditable=function(t){this.floatingFilterInputService.setEditable(t)},Xi([$("columnModel")],e.prototype,"columnModel",void 0),Xi([To("eFloatingFilterInputContainer")],e.prototype,"eFloatingFilterInputContainer",void 0),Xi([Z],e.prototype,"postConstruct",null),e}(Ei),Zi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueChangedListener=function(){},e.numberInputActive=!0,e}return Zi(e,t),e.prototype.setupGui=function(t){var e=this;this.eFloatingFilterNumberInput=this.createManagedBean(new Li),this.eFloatingFilterTextInput=this.createManagedBean(new Di),this.eFloatingFilterTextInput.setDisabled(!0);var n=this.eFloatingFilterNumberInput.getGui(),r=this.eFloatingFilterTextInput.getGui();t.appendChild(n),t.appendChild(r),this.setupListeners(n,(function(t){return e.valueChangedListener(t)})),this.setupListeners(r,(function(t){return e.valueChangedListener(t)}))},e.prototype.setEditable=function(t){this.numberInputActive=t,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)},e.prototype.setAutoComplete=function(t){this.eFloatingFilterNumberInput.setAutoComplete(t),this.eFloatingFilterTextInput.setAutoComplete(t)},e.prototype.getValue=function(){return this.getActiveInputElement().getValue()},e.prototype.setValue=function(t,e){this.getActiveInputElement().setValue(t,e)},e.prototype.getActiveInputElement=function(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput},e.prototype.setValueChangedListener=function(t){this.valueChangedListener=t},e.prototype.setupListeners=function(t,e){this.addManagedListener(t,"input",e),this.addManagedListener(t,"keydown",e)},e.prototype.setParams=function(t){this.setAriaLabel(t.ariaLabel),void 0!==t.autoComplete&&this.setAutoComplete(t.autoComplete)},e.prototype.setAriaLabel=function(t){this.eFloatingFilterNumberInput.setInputAriaLabel(t),this.eFloatingFilterTextInput.setInputAriaLabel(t)},e}(jt),Ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zi(e,t),e.prototype.init=function(e){var n;t.prototype.init.call(this,e),this.filterModelFormatter=new Fi(this.localeService,this.optionsFactory,null===(n=e.filterParams)||void 0===n?void 0:n.numberFormatter)},e.prototype.onParamsUpdated=function(e){ki(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),t.prototype.onParamsUpdated.call(this,e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})},e.prototype.getDefaultFilterOptions=function(){return zi.DEFAULT_FILTER_OPTIONS},e.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},e.prototype.createFloatingFilterInputService=function(t){return this.allowedCharPattern=ki(t.filterParams),this.allowedCharPattern?this.createManagedBean(new Ki({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Qi)},e}(Yi),$i=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ts=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $i(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.filterModelFormatter=new Ui(this.localeService,this.optionsFactory)},e.prototype.onParamsUpdated=function(e){t.prototype.onParamsUpdated.call(this,e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})},e.prototype.getDefaultFilterOptions=function(){return Wi.DEFAULT_FILTER_OPTIONS},e.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},e.prototype.createFloatingFilterInputService=function(){return this.createManagedBean(new Ki)},e}(Yi),es=function(){function t(t,e){var n=this;void 0===e&&(e=!1),this.destroyFuncs=[],this.touching=!1,this.eventService=new st,this.eElement=t,this.preventMouseClick=e;var r=this.onTouchStart.bind(this),o=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",r,{passive:!0}),this.eElement.addEventListener("touchmove",o,{passive:!0}),this.eElement.addEventListener("touchend",i,{passive:!1}),this.destroyFuncs.push((function(){n.eElement.removeEventListener("touchstart",r,{passive:!0}),n.eElement.removeEventListener("touchmove",o,{passive:!0}),n.eElement.removeEventListener("touchend",i,{passive:!1})}))}return t.prototype.getActiveTouch=function(t){for(var e=0;e<t.length;e++){if(t[e].identifier===this.touchStart.identifier)return t[e]}return null},t.prototype.addEventListener=function(t,e){this.eventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.eventService.removeEventListener(t,e)},t.prototype.onTouchStart=function(e){var n=this;if(!this.touching){this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;var r=this.touchStart;window.setTimeout((function(){var o=n.touchStart===r;if(n.touching&&o&&!n.moved){n.moved=!0;var i={type:t.EVENT_LONG_TAP,touchStart:n.touchStart,touchEvent:e};n.eventService.dispatchEvent(i)}}),500)}},t.prototype.onTouchMove=function(t){if(this.touching){var e=this.getActiveTouch(t.touches);if(e)!no(e,this.touchStart,4)&&(this.moved=!0)}},t.prototype.onTouchEnd=function(e){if(this.touching){if(!this.moved){var n={type:t.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(n),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}},t.prototype.checkForDoubleTap=function(){var e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>t.DOUBLE_TAP_MILLIS){var n={type:t.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(n),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e},t.prototype.destroy=function(){this.destroyFuncs.forEach((function(t){return t()}))},t.EVENT_TAP="tap",t.EVENT_DOUBLE_TAP="doubleTap",t.EVENT_LONG_TAP="longTap",t.DOUBLE_TAP_MILLIS=500,t}(),ns=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rs=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},os=function(t){function e(n){var r=t.call(this)||this;return n||r.setTemplate(e.TEMPLATE),r}return ns(e,t),e.prototype.attachCustomElements=function(t,e,n,r,o){this.eSortOrder=t,this.eSortAsc=e,this.eSortDesc=n,this.eSortMixed=r,this.eSortNone=o},e.prototype.setupSort=function(t,e){var n=this;void 0===e&&(e=!1),this.column=t,this.suppressOrder=e,this.setupMultiSortIndicator(),!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,t),this.addInIcon("sortDescending",this.eSortDesc,t),this.addInIcon("sortUnSort",this.eSortNone,t),this.addManagedListener(this.eventService,Yt.EVENT_SORT_CHANGED,(function(){return n.onSortChanged()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return n.onSortChanged()})),this.onSortChanged())},e.prototype.addInIcon=function(t,e,n){if(null!=e){var r=Xr(t,this.gridOptionsService,n);r&&e.appendChild(r)}},e.prototype.onSortChanged=function(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()},e.prototype.updateIcons=function(){var t=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){var e="asc"===t;ur(this.eSortAsc,e,{skipAriaHidden:!0})}if(this.eSortDesc){var n="desc"===t;ur(this.eSortDesc,n,{skipAriaHidden:!0})}if(this.eSortNone){var r=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),o=null===t||void 0===t;ur(this.eSortNone,!r&&o,{skipAriaHidden:!0})}},e.prototype.setupMultiSortIndicator=function(){var t=this;this.addInIcon("sortUnSort",this.eSortMixed,this.column);var e=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e&&(this.addManagedListener(this.eventService,Yt.EVENT_SORT_CHANGED,(function(){return t.updateMultiSortIndicator()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return t.updateMultiSortIndicator()})),this.updateMultiSortIndicator())},e.prototype.updateMultiSortIndicator=function(){if(this.eSortMixed){var t="mixed"===this.sortController.getDisplaySortForColumn(this.column);ur(this.eSortMixed,t,{skipAriaHidden:!0})}},e.prototype.updateSortOrder=function(){var t,e=this;if(this.eSortOrder){var n=this.sortController.getColumnsWithSortingOrdered(),r=null!==(t=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==t?t:-1,o=n.some((function(t){var n;return null!==(n=e.sortController.getDisplaySortIndexForColumn(t))&&void 0!==n&&n})),i=r>=0&&o;ur(this.eSortOrder,i,{skipAriaHidden:!0}),r>=0?this.eSortOrder.innerHTML=(r+1).toString():br(this.eSortOrder)}},e.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',rs([To("eSortOrder")],e.prototype,"eSortOrder",void 0),rs([To("eSortAsc")],e.prototype,"eSortAsc",void 0),rs([To("eSortDesc")],e.prototype,"eSortDesc",void 0),rs([To("eSortMixed")],e.prototype,"eSortMixed",void 0),rs([To("eSortNone")],e.prototype,"eSortNone",void 0),rs([$("columnModel")],e.prototype,"columnModel",void 0),rs([$("sortController")],e.prototype,"sortController",void 0),e}(Eo),is=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ss=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},as=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastMovingChanged=0,e}return is(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.refresh=function(t){return this.params=t,this.workOutTemplate()==this.currentTemplate&&(this.workOutShowMenu()==this.currentShowMenu&&(this.workOutSort()==this.currentSort&&(this.setDisplayName(t),!0)))},e.prototype.workOutTemplate=function(){var t=mt(this.params.template,e.TEMPLATE);return t=t&&t.trim?t.trim():t},e.prototype.init=function(t){this.params=t,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(t.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(t)},e.prototype.setDisplayName=function(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;var e=re(this.currentDisplayName);this.eText&&(this.eText.innerHTML=e)}},e.prototype.setupIcons=function(t){this.addInIcon("menu",this.eMenu,t),this.addInIcon("filter",this.eFilter,t)},e.prototype.addInIcon=function(t,e,n){if(null!=e){var r=Xr(t,this.gridOptionsService,n);r&&e.appendChild(r)}},e.prototype.setupTap=function(){var t=this,e=this.gridOptionsService;if(!e.is("suppressTouch")){var n=new es(this.getGui(),!0),r=e.is("suppressMenuHide"),i=r&&o(this.eMenu),s=i?new es(this.eMenu,!0):n;if(this.params.enableMenu){var a=i?"EVENT_TAP":"EVENT_LONG_TAP";this.addManagedListener(s,es[a],(function(n){e.api.showColumnMenuAfterMouseClick(t.params.column,n.touchStart)}))}if(this.params.enableSorting){this.addManagedListener(n,es.EVENT_TAP,(function(e){var n=e.touchStart.target;r&&t.eMenu.contains(n)||t.sortController.progressSort(t.params.column,!1,"uiColumnSorted")}))}this.addDestroyFunc((function(){return n.destroy()})),i&&this.addDestroyFunc((function(){return s.destroy()}))}},e.prototype.workOutShowMenu=function(){var t=!this.gridOptionsService.is("suppressMenuHide"),e=Gn()&&t;return this.params.enableMenu&&!e},e.prototype.setMenu=function(){var t=this;if(this.eMenu)if(this.currentShowMenu=this.workOutShowMenu(),this.currentShowMenu){var e=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",(function(){return t.showMenu(t.eMenu)})),this.eMenu.classList.toggle("ag-header-menu-always-show",e)}else xr(this.eMenu)},e.prototype.showMenu=function(t){t||(t=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,t,"columnMenu")},e.prototype.workOutSort=function(){return this.params.enableSorting},e.prototype.setupSort=function(){var t=this;if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new os(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),this.currentSort){var e="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,ht.EVENT_MOVING_CHANGED,(function(){t.lastMovingChanged=(new Date).getTime()})),this.eLabel&&this.addManagedListener(this.eLabel,"click",(function(n){var r=t.params.column.isMoving(),o=(new Date).getTime()-t.lastMovingChanged<50;if(!(r||o)){var i=e?n.ctrlKey||n.metaKey:n.shiftKey;t.params.progressSort(i)}}));var n=function(){if(t.addOrRemoveCssClass("ag-header-cell-sorted-asc",t.params.column.isSortAscending()),t.addOrRemoveCssClass("ag-header-cell-sorted-desc",t.params.column.isSortDescending()),t.addOrRemoveCssClass("ag-header-cell-sorted-none",t.params.column.isSortNone()),t.params.column.getColDef().showRowGroup){var e=t.columnModel.getSourceColumnsForGroupColumn(t.params.column),n=!(null===e||void 0===e?void 0:e.every((function(e){return t.params.column.getSort()==e.getSort()})));t.addOrRemoveCssClass("ag-header-cell-sorted-mixed",n)}};this.addManagedListener(this.eventService,Yt.EVENT_SORT_CHANGED,n),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,n)}},e.prototype.setupFilterIcon=function(){this.eFilter&&(this.addManagedListener(this.params.column,ht.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())},e.prototype.onFilterChanged=function(){var t=this.params.column.isFilterActive();ur(this.eFilter,t,{skipAriaHidden:!0})},e.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',ss([$("sortController")],e.prototype,"sortController",void 0),ss([$("menuFactory")],e.prototype,"menuFactory",void 0),ss([$("columnModel")],e.prototype,"columnModel",void 0),ss([To("eFilter")],e.prototype,"eFilter",void 0),ss([To("eSortIndicator")],e.prototype,"eSortIndicator",void 0),ss([To("eMenu")],e.prototype,"eMenu",void 0),ss([To("eLabel")],e.prototype,"eLabel",void 0),ss([To("eText")],e.prototype,"eText",void 0),ss([To("eSortOrder")],e.prototype,"eSortOrder",void 0),ss([To("eSortAsc")],e.prototype,"eSortAsc",void 0),ss([To("eSortDesc")],e.prototype,"eSortDesc",void 0),ss([To("eSortMixed")],e.prototype,"eSortMixed",void 0),ss([To("eSortNone")],e.prototype,"eSortNone",void 0),e}(Eo),ls=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),us=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},cs=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return ls(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){this.params=t,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()},e.prototype.checkWarnings=function(){if(this.params.template){O((function(){return console.warn("AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}),"HeaderGroupComp.templateNotSupported")}},e.prototype.setupExpandIcons=function(){var t=this;this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");var e=function(e){if(!Mt(e)){var n=!t.params.columnGroup.isExpanded();t.columnModel.setColumnGroupOpened(t.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")}};this.addTouchAndClickListeners(this.eCloseIcon,e),this.addTouchAndClickListeners(this.eOpenIcon,e);var n=function(t){Dt(t)};this.addManagedListener(this.eCloseIcon,"dblclick",n),this.addManagedListener(this.eOpenIcon,"dblclick",n),this.addManagedListener(this.getGui(),"dblclick",e),this.updateIconVisibility();var r=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(r,ft.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(r,ft.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))},e.prototype.addTouchAndClickListeners=function(t,e){var n=new es(t,!0);this.addManagedListener(n,es.EVENT_TAP,e),this.addDestroyFunc((function(){return n.destroy()})),this.addManagedListener(t,"click",e)},e.prototype.updateIconVisibility=function(){if(this.params.columnGroup.isExpandable()){var t=this.params.columnGroup.isExpanded();ur(this.eOpenIcon,t),ur(this.eCloseIcon,!t)}else ur(this.eOpenIcon,!1),ur(this.eCloseIcon,!1)},e.prototype.addInIcon=function(t,e){var n=Xr(t,this.gridOptionsService,null);n&&this.getRefElement(e).appendChild(n)},e.prototype.addGroupExpandIcon=function(){if(!this.params.columnGroup.isExpandable())return ur(this.eOpenIcon,!1),void ur(this.eCloseIcon,!1)},e.prototype.setupLabel=function(){var t,e=this.params,n=e.displayName,r=e.columnGroup;if(o(n)){var i=re(n);this.getRefElement("agLabel").innerHTML=i}this.addOrRemoveCssClass("ag-sticky-label",!(null===(t=r.getColGroupDef())||void 0===t?void 0:t.suppressStickyLabel))},e.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',us([$("columnModel")],e.prototype,"columnModel",void 0),us([To("agOpened")],e.prototype,"eOpenIcon",void 0),us([To("agClosed")],e.prototype,"eCloseIcon",void 0),e}(Eo),ps=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ps(e,t),e.prototype.isPopup=function(){return!0},e.prototype.setParentComponent=function(e){e.addCssClass("ag-has-popup"),t.prototype.setParentComponent.call(this,e)},e.prototype.destroy=function(){var e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),t.prototype.destroy.call(this)},e}(Eo),ds=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fs=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gs=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return ds(e,t),e.prototype.init=function(t){this.params=t,this.focusAfterAttached=t.cellStartedEdit,this.eTextArea.setMaxLength(t.maxLength||200).setCols(t.cols||60).setRows(t.rows||10),o(t.value,!0)&&this.eTextArea.setValue(t.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()},e.prototype.onKeyDown=function(t){var e=t.key;(e===Yr.LEFT||e===Yr.UP||e===Yr.RIGHT||e===Yr.DOWN||t.shiftKey&&e===Yr.ENTER)&&t.stopPropagation()},e.prototype.afterGuiAttached=function(){var t=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(t("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()},e.prototype.getValue=function(){var t=this.eTextArea.getValue();return o(t)||o(this.params.value)?this.params.parseValue(t):this.params.value},e.TEMPLATE='<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',fs([To("eTextArea")],e.prototype,"eTextArea",void 0),e}(hs),ms=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ys=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},vs=function(t){function e(){var e=t.call(this,'<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>\n            </div>')||this;return e.startedByEnter=!1,e}return ms(e,t),e.prototype.init=function(t){var e=this;this.focusAfterAttached=t.cellStartedEdit;var n=t.values,r=t.value,o=t.eventKey;if(i(n))console.warn("AG Grid: no values found for select cellEditor");else{this.startedByEnter=null!=o&&o===Yr.ENTER;var s=!1;n.forEach((function(n){var o={value:n},i=e.valueFormatterService.formatValue(t.column,null,n),a=null!==i&&void 0!==i;o.text=a?i:n,e.eSelect.addOption(o),s=s||r===n})),s?this.eSelect.setValue(t.value,!0):t.values.length&&this.eSelect.setValue(t.values[0],!0),null!=t.valueListGap&&this.eSelect.setPickerGap(t.valueListGap),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,ri.EVENT_ITEM_SELECTED,(function(){return t.stopEditing()}))}},e.prototype.afterGuiAttached=function(){var t=this;this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout((function(){t.isAlive()&&t.eSelect.showPicker()}))},e.prototype.focusIn=function(){this.eSelect.getFocusableElement().focus()},e.prototype.getValue=function(){return this.eSelect.getValue()},e.prototype.isPopup=function(){return!1},ys([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),ys([To("eSelect")],e.prototype,"eSelect",void 0),e}(hs),_s=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ws=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Cs=function(t){function e(e){var n=t.call(this,'\n            <div class="ag-cell-edit-wrapper">\n                '+e.getTemplate()+"\n            </div>")||this;return n.cellEditorInput=e,n}return _s(e,t),e.prototype.init=function(t){this.params=t;var e,n=this.eInput;if(this.cellEditorInput.init(n,t),t.cellStartedEdit){this.focusAfterAttached=!0;var r=t.eventKey;r===Yr.BACKSPACE||t.eventKey===Yr.DELETE?e="":r&&1===r.length?e=r:(e=this.cellEditorInput.getStartValue(),r!==Yr.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,e=this.cellEditorInput.getStartValue();null!=e&&n.setStartValue(e),this.addManagedListener(n.getGui(),"keydown",(function(t){var e=t.key;e!==Yr.PAGE_UP&&e!==Yr.PAGE_DOWN||t.preventDefault()}))},e.prototype.afterGuiAttached=function(){var t,e,n=this.localeService.getLocaleTextFunc(),r=this.eInput;if(r.setInputAriaLabel(n("ariaInputEditor","Input Editor")),this.focusAfterAttached){Mn()||r.getFocusableElement().focus();var o=r.getInputElement();this.highlightAllOnFocus?o.select():null===(e=(t=this.cellEditorInput).setCaret)||void 0===e||e.call(t)}},e.prototype.focusIn=function(){var t=this.eInput,e=t.getFocusableElement(),n=t.getInputElement();e.focus(),n.select()},e.prototype.getValue=function(){return this.cellEditorInput.getValue()},e.prototype.isPopup=function(){return!1},ws([To("eInput")],e.prototype,"eInput",void 0),e}(hs),bs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xs=function(){function t(){}return t.prototype.getTemplate=function(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.maxLength&&t.setMaxLength(e.maxLength)},t.prototype.getValue=function(){var t=this.eInput.getValue();return o(t)||o(this.params.value)?this.params.parseValue(t):this.params.value},t.prototype.getStartValue=function(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value},t.prototype.setCaret=function(){var t=this.eInput.getValue(),e=o(t)&&t.length||0;e&&this.eInput.getInputElement().setSelectionRange(e,e)},t}(),Es=function(t){function e(){return t.call(this,new xs)||this}return bs(e,t),e}(Cs),Ss=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ts=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Rs=function(t){function e(){var n=t.call(this,e.TEMPLATE)||this;return n.refreshCount=0,n}return Ss(e,t),e.prototype.init=function(t){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(t)},e.prototype.showDelta=function(t,e){var n=Math.abs(e),r=t.formatValue(n),i=o(r)?r:n,s=e>=0;this.eDelta.innerHTML=s?"\u2191"+i:"\u2193"+i,this.eDelta.classList.toggle("ag-value-change-delta-up",s),this.eDelta.classList.toggle("ag-value-change-delta-down",!s)},e.prototype.setTimerToRemoveDelta=function(){var t=this;this.refreshCount++;var e=this.refreshCount;window.setTimeout((function(){e===t.refreshCount&&t.hideDeltaValue()}),2e3)},e.prototype.hideDeltaValue=function(){this.eValue.classList.remove("ag-value-change-value-highlight"),br(this.eDelta)},e.prototype.refresh=function(t){var e=t.value;if(e===this.lastValue)return!1;if(o(t.valueFormatted)?this.eValue.innerHTML=t.valueFormatted:o(t.value)?this.eValue.innerHTML=e:br(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof e&&"number"===typeof this.lastValue){var n=e-this.lastValue;this.showDelta(t,n)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=e,!0},e.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',Ts([$("filterManager")],e.prototype,"filterManager",void 0),e}(Eo),Ps=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Os=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Is=function(t){function e(){var n=t.call(this,e.TEMPLATE)||this;return n.refreshCount=0,n.eCurrent=n.queryForHtmlElement(".ag-value-slide-current"),n}return Ps(e,t),e.prototype.init=function(t){this.refresh(t)},e.prototype.addSlideAnimation=function(){var t=this;this.refreshCount++;var e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=Sr('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout((function(){e===t.refreshCount&&t.ePrevious.classList.add("ag-value-slide-out-end")}),50),window.setTimeout((function(){e===t.refreshCount&&(t.getGui().removeChild(t.ePrevious),t.ePrevious=null)}),3e3)},e.prototype.refresh=function(t){var e=t.value;return i(e)&&(e=""),e!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=e,o(t.valueFormatted)?this.eCurrent.innerHTML=t.valueFormatted:o(t.value)?this.eCurrent.innerHTML=e:br(this.eCurrent),!0))},e.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',Os([$("filterManager")],e.prototype,"filterManager",void 0),e}(Eo),As=function(){return(As=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ds=function(){function t(e){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=t.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=e}return t.prototype.setData=function(t){this.setDataCommon(t,!1)},t.prototype.updateData=function(t){this.setDataCommon(t,!0)},t.prototype.setDataCommon=function(t,e){var n=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();var r=this.createDataChangedEvent(t,n,e);this.dispatchLocalEvent(r)},t.prototype.updateDataOnDetailNode=function(){this.detailNode&&(this.detailNode.data=this.data)},t.prototype.createDataChangedEvent=function(e,n,r){return{type:t.EVENT_DATA_CHANGED,node:this,oldData:n,newData:e,update:r}},t.prototype.createLocalRowEvent=function(t){return{type:t,node:this}},t.prototype.getRowIndexString=function(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()},t.prototype.createDaemonNode=function(){var e=new t(this.beans);return e.id=this.id,e.data=this.data,e.__daemon=!0,e.selected=this.selected,e.level=this.level,e},t.prototype.setDataAndId=function(t,e){var n=o(this.id)?this.createDaemonNode():null,r=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(e),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,n);var i=this.createDataChangedEvent(t,r,!1);this.dispatchLocalEvent(i)},t.prototype.checkRowSelectable=function(){var t=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!t||t(this))},t.prototype.setRowSelectable=function(e){if(this.selectable!==e&&(this.selectable=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_SELECTABLE_CHANGED)),this.beans.gridOptionsService.is("groupSelectsChildren"))){var n=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:null!==n&&void 0!==n&&n,source:"selectableChanged"})}},t.prototype.setId=function(e){var n=this.beans.gridOptionsService.getCallback("getRowId");if(n)if(this.data){var r=this.getGroupKeys(!0);this.id=n({data:this.data,parentKeys:r.length>0?r:void 0,level:this.level}),null!==this.id&&"string"===typeof this.id&&this.id.startsWith(t.ID_PREFIX_ROW_GROUP)&&console.error("AG Grid: Row IDs cannot start with "+t.ID_PREFIX_ROW_GROUP+", this is a reserved prefix for AG Grid's row grouping feature."),null!==this.id&&"string"!==typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=e},t.prototype.getGroupKeys=function(t){void 0===t&&(t=!1);var e=[],n=this;for(t&&(n=n.parent);n&&n.level>=0;)e.push(n.key),n=n.parent;return e.reverse(),e},t.prototype.isPixelInRange=function(t){return!(!o(this.rowTop)||!o(this.rowHeight))&&(t>=this.rowTop&&t<this.rowTop+this.rowHeight)},t.prototype.setFirstChild=function(e){this.firstChild!==e&&(this.firstChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_FIRST_CHILD_CHANGED)))},t.prototype.setLastChild=function(e){this.lastChild!==e&&(this.lastChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_LAST_CHILD_CHANGED)))},t.prototype.setChildIndex=function(e){this.childIndex!==e&&(this.childIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_CHILD_INDEX_CHANGED)))},t.prototype.setRowTop=function(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_TOP_CHANGED)),this.setDisplayed(null!==e))},t.prototype.clearRowTopAndRowIndex=function(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)},t.prototype.setDisplayed=function(e){this.displayed!==e&&(this.displayed=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_DISPLAYED_CHANGED)))},t.prototype.setDragging=function(e){this.dragging!==e&&(this.dragging=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_DRAGGING_CHANGED)))},t.prototype.setHighlighted=function(e){e!==this.highlighted&&(this.highlighted=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_HIGHLIGHT_CHANGED)))},t.prototype.setHovered=function(t){this.hovered!==t&&(this.hovered=t)},t.prototype.isHovered=function(){return this.hovered},t.prototype.setAllChildrenCount=function(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_ALL_CHILDREN_COUNT_CHANGED)))},t.prototype.setMaster=function(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_MASTER_CHANGED)))},t.prototype.setGroup=function(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_GROUP_CHANGED)))},t.prototype.setRowHeight=function(e,n){void 0===n&&(n=!1),this.rowHeight=e,this.rowHeightEstimated=n,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_HEIGHT_CHANGED))},t.prototype.setRowAutoHeight=function(t,e){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[e.getId()]=t,null!=t&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=k(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())},t.prototype.checkAutoHeights=function(){var t=this,e=!1,n=!0,r=0,o=this.__autoHeights;if(null!=o&&(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach((function(i){var s=o[i.getId()];if(null==s){if(!t.beans.columnModel.isColSpanActive())return void(e=!0);var a=[];switch(i.getPinned()){case"left":a=t.beans.columnModel.getDisplayedLeftColumnsForRow(t);break;case"right":a=t.beans.columnModel.getDisplayedRightColumnsForRow(t);break;case null:a=t.beans.columnModel.getViewportCenterColumnsForRow(t)}if(a.includes(i))return void(e=!0);s=-1}else n=!1;s>r&&(r=s)})),!e&&((n||r<10)&&(r=this.beans.gridOptionsService.getRowHeightForNode(this).height),r!=this.rowHeight))){this.setRowHeight(r);var i=this.beans.rowModel;i.onRowHeightChangedDebounced&&i.onRowHeightChangedDebounced()}},t.prototype.setRowIndex=function(e){this.rowIndex!==e&&(this.rowIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_ROW_INDEX_CHANGED)))},t.prototype.setUiLevel=function(e){this.uiLevel!==e&&(this.uiLevel=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_UI_LEVEL_CHANGED)))},t.prototype.setExpanded=function(e,n){if(this.expanded!==e){this.expanded=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_EXPANDED_CHANGED));var r=Object.assign({},this.createGlobalRowEvent(Yt.EVENT_ROW_GROUP_OPENED),{expanded:e,event:n||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}},t.prototype.createGlobalRowEvent=function(t){return{type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}},t.prototype.dispatchLocalEvent=function(t){this.eventService&&this.eventService.dispatchEvent(t)},t.prototype.setDataValue=function(t,e,n){var r=this,o=function(){var e;return"string"!==typeof t?t:null!==(e=r.beans.columnModel.getGridColumn(t))&&void 0!==e?e:r.beans.columnModel.getPrimaryColumn(t)}(),i=this.getValueFromValueService(o);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(o,i,e,n),!1;var s=this.beans.valueService.setValue(this,o,e,n);return this.dispatchCellChangedEvent(o,e,i),this.checkRowSelectable(),s},t.prototype.getValueFromValueService=function(t){var e=this.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.group&&this.expanded&&!this.footer&&!e,r=this.beans.gridOptionsService.is("groupIncludeFooter"),o=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),i=n&&r&&!o;return this.beans.valueService.getValue(t,this,!1,i)},t.prototype.dispatchEventForSaveValueReadOnly=function(t,e,n,r){var o={type:Yt.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:t,colDef:t.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:e,newValue:n,value:n,source:r};this.beans.eventService.dispatchEvent(o)},t.prototype.setGroupValue=function(t,e){var n=this.beans.columnModel.getGridColumn(t);i(this.groupData)&&(this.groupData={});var r=n.getColId(),o=this.groupData[r];o!==e&&(this.groupData[r]=e,this.dispatchCellChangedEvent(n,e,o))},t.prototype.setAggData=function(t){var e=this,n=C([this.aggData,t]),r=this.aggData;this.aggData=t,this.eventService&&n.forEach((function(t){var n=e.beans.columnModel.getGridColumn(t),o=e.aggData?e.aggData[t]:void 0,i=r?r[t]:void 0;e.dispatchCellChangedEvent(n,o,i)}))},t.prototype.updateHasChildren=function(){var e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){var n=this.beans.gridOptionsService.isTreeData(),r=this.beans.gridOptionsService.get("isServerSideGroup");e=!this.stub&&!this.footer&&(n?!!r&&r(this.data):!!this.group)}e!==this.__hasChildren&&(this.__hasChildren=!!e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_HAS_CHILDREN_CHANGED)))},t.prototype.hasChildren=function(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren},t.prototype.isEmptyRowGroupNode=function(){return this.group&&s(this.childrenAfterGroup)},t.prototype.dispatchCellChangedEvent=function(e,n,r){var o={type:t.EVENT_CELL_CHANGED,node:this,column:e,newValue:n,oldValue:r};this.dispatchLocalEvent(o)},t.prototype.resetQuickFilterAggregateText=function(){this.quickFilterAggregateText=null},t.prototype.isExpandable=function(){return!!(this.hasChildren()&&!this.footer||this.master)},t.prototype.isSelected=function(){return this.footer?this.sibling.isSelected():this.selected},t.prototype.depthFirstSearch=function(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach((function(e){return e.depthFirstSearch(t)})),t(this)},t.prototype.calculateSelectedFromChildren=function(){var t,e=!1,n=!1,r=!1;if(!(null===(t=this.childrenAfterGroup)||void 0===t?void 0:t.length))return this.selectable?this.selected:null;for(var o=0;o<this.childrenAfterGroup.length;o++){var i=this.childrenAfterGroup[o],s=i.isSelected();if(!i.selectable){var a=i.calculateSelectedFromChildren();if(null===a)continue;s=a}switch(s){case!0:e=!0;break;case!1:n=!0;break;default:r=!0}}return r||e&&n?void 0:!!e||!n&&(this.selectable?this.selected:null)},t.prototype.setSelectedInitialValue=function(t){this.selected=t},t.prototype.selectThisNode=function(e,n,r){void 0===r&&(r="api");var o=!this.selectable&&e,i=this.selected===e;if(o||i)return!1;this.selected=e,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(t.EVENT_ROW_SELECTED));var s=As(As({},this.createGlobalRowEvent(Yt.EVENT_ROW_SELECTED)),{event:n||null,source:r});return this.beans.eventService.dispatchEvent(s),!0},t.prototype.setSelected=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n="api"),"boolean"!==typeof n?this.setSelectedParams({newValue:t,clearSelection:e,rangeSelect:!1,source:n}):console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")},t.prototype.setSelectedParams=function(t){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(As(As({},t),{nodes:[this.footer?this.sibling:this]}))},t.prototype.isRowPinned=function(){return"top"===this.rowPinned||"bottom"===this.rowPinned},t.prototype.isParentOfNode=function(t){for(var e=this.parent;e;){if(e===t)return!0;e=e.parent}return!1},t.prototype.addEventListener=function(t,e){this.eventService||(this.eventService=new st),this.eventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.eventService&&(this.eventService.removeEventListener(t,e),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))},t.prototype.onMouseEnter=function(){this.dispatchLocalEvent(this.createLocalRowEvent(t.EVENT_MOUSE_ENTER))},t.prototype.onMouseLeave=function(){this.dispatchLocalEvent(this.createLocalRowEvent(t.EVENT_MOUSE_LEAVE))},t.prototype.getFirstChildOfFirstChild=function(t){for(var e=this,n=!0,r=!1,i=null;n&&!r;){var s=e.parent;o(s)&&e.firstChild?s.rowGroupColumn===t&&(r=!0,i=s):n=!1,e=s}return r?i:null},t.prototype.isFullWidthCell=function(){var t=this.beans.gridOptionsService.getCallback("isFullWidthRow");return!!t&&t({rowNode:this})},t.prototype.getRoute=function(){if(null!=this.key){for(var t=[],e=this;null!=e.key;)t.push(e.key),e=e.parent;return t.reverse()}},t.prototype.createFooter=function(){var e=this;if(!this.sibling){var n=new t(this.beans);Object.keys(this).forEach((function(t){n[t]=e[t]})),n.footer=!0,n.setRowTop(null),n.setRowIndex(null),n.oldRowTop=null,n.id="rowGroupFooter_"+this.id,n.sibling=this,this.sibling=n}},t.ID_PREFIX_ROW_GROUP="row-group-",t.ID_PREFIX_TOP_PINNED="t-",t.ID_PREFIX_BOTTOM_PINNED="b-",t.OBJECT_ID_SEQUENCE=0,t.EVENT_ROW_SELECTED="rowSelected",t.EVENT_DATA_CHANGED="dataChanged",t.EVENT_CELL_CHANGED="cellChanged",t.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",t.EVENT_MASTER_CHANGED="masterChanged",t.EVENT_GROUP_CHANGED="groupChanged",t.EVENT_MOUSE_ENTER="mouseEnter",t.EVENT_MOUSE_LEAVE="mouseLeave",t.EVENT_HEIGHT_CHANGED="heightChanged",t.EVENT_TOP_CHANGED="topChanged",t.EVENT_DISPLAYED_CHANGED="displayedChanged",t.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",t.EVENT_LAST_CHILD_CHANGED="lastChildChanged",t.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",t.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",t.EVENT_EXPANDED_CHANGED="expandedChanged",t.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",t.EVENT_SELECTABLE_CHANGED="selectableChanged",t.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",t.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",t.EVENT_DRAGGING_CHANGED="draggingChanged",t}(),Ms=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ls=function(){return(Ls=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ns=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Fs=function(t){function e(){return t.call(this,'\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return Ms(e,t),e.prototype.postConstruct=function(){this.eCheckbox.setPassive(!0),rn(this.eCheckbox.getInputElement(),"polite")},e.prototype.getCheckboxId=function(){return this.eCheckbox.getInputElement().id},e.prototype.onDataChanged=function(){this.onSelectionChanged()},e.prototype.onSelectableChanged=function(){this.showOrHideSelect()},e.prototype.onSelectionChanged=function(){var t=this.localeService.getLocaleTextFunc(),e=this.rowNode.isSelected(),n=xn(t,e),r=t("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(e,!0),this.eCheckbox.setInputAriaLabel(r+" ("+n+")")},e.prototype.onClicked=function(t,e,n){return this.rowNode.setSelectedParams({newValue:t,rangeSelect:n.shiftKey,groupSelectsFiltered:e,event:n,source:"checkboxSelected"})},e.prototype.init=function(t){var e=this;if(this.rowNode=t.rowNode,this.column=t.column,this.overrides=t.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(t){Dt(t)})),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(t){Dt(t);var n=e.gridOptionsService.is("groupSelectsFiltered"),r=e.eCheckbox.getValue();e.shouldHandleIndeterminateState(r,n)?0===e.onClicked(!0,n,t||{})&&e.onClicked(!1,n,t):r?e.onClicked(!1,n,t):e.onClicked(!0,n,t||{})})),this.addManagedListener(this.rowNode,Ds.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsService.get("isRowSelectable")||"function"===typeof this.getIsVisible()){var n=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,n),this.addManagedListener(this.rowNode,Ds.EVENT_DATA_CHANGED,n),this.addManagedListener(this.rowNode,Ds.EVENT_CELL_CHANGED,n),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")},e.prototype.shouldHandleIndeterminateState=function(t,e){return e&&(void 0===this.eCheckbox.getPreviousValue()||void 0===t)&&this.gridOptionsService.isRowModelType("clientSide")},e.prototype.showOrHideSelect=function(){var t,e,n,r,o=this.rowNode.selectable,i=this.getIsVisible();if(o)if("function"===typeof i){var s=null===(t=this.overrides)||void 0===t?void 0:t.callbackParams,a=null===(e=this.column)||void 0===e?void 0:e.createColumnFunctionCallbackParams(this.rowNode);o=!!a&&i(Ls(Ls({},s),a))}else o=null!==i&&void 0!==i&&i;if(null===(n=this.column)||void 0===n?void 0:n.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!o),this.setVisible(!0),void this.setDisplayed(!0);(null===(r=this.overrides)||void 0===r?void 0:r.removeHidden)?this.setDisplayed(o):this.setVisible(o)},e.prototype.getIsVisible=function(){var t,e;return this.overrides?this.overrides.isVisible:null===(e=null===(t=this.column)||void 0===t?void 0:t.getColDef())||void 0===e?void 0:e.checkboxSelection},Ns([To("eCheckbox")],e.prototype,"eCheckbox",void 0),Ns([Z],e.prototype,"postConstruct",null),e}(Eo),ks=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gs=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Bs=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(t){t[t.ToolPanel=0]="ToolPanel",t[t.HeaderCell=1]="HeaderCell",t[t.RowDrag=2]="RowDrag",t[t.ChartPanel=3]="ChartPanel"}(Gi||(Gi={})),function(t){t[t.Up=0]="Up",t[t.Down=1]="Down"}(Bi||(Bi={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(Vi||(Vi={}));var Vs,zs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragSourceAndParamsList=[],e.dropTargets=[],e}var n;return ks(e,t),n=e,e.prototype.init=function(){this.ePinnedIcon=qr("columnMovePin",this.gridOptionsService,null),this.eHideIcon=qr("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=qr("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=qr("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=qr("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=qr("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=qr("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=qr("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=qr("dropNotAllowed",this.gridOptionsService,null)},e.prototype.addDragSource=function(t,e){void 0===e&&(e=!1);var n={eElement:t.eElement,dragStartPixels:t.dragStartPixels,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:e};this.dragSourceAndParamsList.push({params:n,dragSource:t}),this.dragService.addDragSource(n)},e.prototype.removeDragSource=function(t){var e=this.dragSourceAndParamsList.find((function(e){return e.dragSource===t}));e&&(this.dragService.removeDragSource(e.params),Ct(this.dragSourceAndParamsList,e))},e.prototype.clearDragSourceParamsList=function(){var t=this;this.dragSourceAndParamsList.forEach((function(e){return t.dragService.removeDragSource(e.params)})),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0},e.prototype.nudge=function(){this.dragging&&this.onDragging(this.eventLastTime,!0)},e.prototype.onDragStart=function(t,e){this.dragging=!0,this.dragSource=t,this.eventLastTime=e,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()},e.prototype.onDragStop=function(t){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var e=this.createDropTargetEvent(this.lastDropTarget,t,null,null,!1);this.lastDropTarget.onDragStop(e)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()},e.prototype.onDragging=function(t,e){var n,r,o,i,s=this,a=this.getHorizontalDirection(t),l=this.getVerticalDirection(t);this.eventLastTime=t,this.positionGhost(t);var u=this.dropTargets.filter((function(e){return s.isMouseOnDropTarget(t,e)})),c=this.findCurrentDropTarget(t,u);if(c!==this.lastDropTarget)this.leaveLastTargetIfExists(t,a,l,e),null!==this.lastDropTarget&&null===c&&(null===(r=(n=this.dragSource).onGridExit)||void 0===r||r.call(n,this.dragItem)),null===this.lastDropTarget&&null!==c&&(null===(i=(o=this.dragSource).onGridEnter)||void 0===i||i.call(o,this.dragItem)),this.enterDragTargetIfExists(c,t,a,l,e),this.lastDropTarget=c;else if(c&&c.onDragging){var p=this.createDropTargetEvent(c,t,a,l,e);c.onDragging(p)}},e.prototype.getAllContainersFromDropTarget=function(t){var e=t.getSecondaryContainers?t.getSecondaryContainers():null,n=[[t.getContainer()]];return e?n.concat(e):n},e.prototype.allContainersIntersect=function(t,e){var n,r;try{for(var o=Bs(e),i=o.next();!i.done;i=o.next()){var s=i.value.getBoundingClientRect();if(0===s.width||0===s.height)return!1;var a=t.clientX>=s.left&&t.clientX<s.right,l=t.clientY>=s.top&&t.clientY<s.bottom;if(!a||!l)return!1}}catch(u){n={error:u}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},e.prototype.isMouseOnDropTarget=function(t,e){var n,r,o=this.getAllContainersFromDropTarget(e),i=!1;try{for(var s=Bs(o),a=s.next();!a.done;a=s.next()){var l=a.value;if(this.allContainersIntersect(t,l)){i=!0;break}}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return!(e.targetContainsSource&&!e.getContainer().contains(this.dragSource.eElement))&&(i&&e.isInterestedIn(this.dragSource.type,this.dragSource.eElement))},e.prototype.findCurrentDropTarget=function(t,e){var n,r,o,i,s=e.length;if(0===s)return null;if(1===s)return e[0];var a=this.gridOptionsService.getRootNode().elementsFromPoint(t.clientX,t.clientY);try{for(var l=Bs(a),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var p=(o=void 0,Bs(e)),h=p.next();!h.done;h=p.next()){var d=h.value;if(-1!==Rt(this.getAllContainersFromDropTarget(d)).indexOf(c))return d}}catch(f){o={error:f}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}}catch(g){n={error:g}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return null},e.prototype.enterDragTargetIfExists=function(t,e,n,r,o){if(t){if(t.onDragEnter){var i=this.createDropTargetEvent(t,e,n,r,o);t.onDragEnter(i)}this.setGhostIcon(t.getIconName?t.getIconName():null)}},e.prototype.leaveLastTargetIfExists=function(t,e,n,r){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){var o=this.createDropTargetEvent(this.lastDropTarget,t,e,n,r);this.lastDropTarget.onDragLeave(o)}this.setGhostIcon(null)}},e.prototype.addDropTarget=function(t){this.dropTargets.push(t)},e.prototype.removeDropTarget=function(t){this.dropTargets=this.dropTargets.filter((function(e){return e.getContainer()!==t.getContainer()}))},e.prototype.hasExternalDropZones=function(){return this.dropTargets.some((function(t){return t.external}))},e.prototype.findExternalZone=function(t){return this.dropTargets.filter((function(t){return t.external})).find((function(e){return e.getContainer()===t.getContainer()}))||null},e.prototype.getHorizontalDirection=function(t){var e=this.eventLastTime&&this.eventLastTime.clientX,n=t.clientX;return e===n?null:e>n?Vi.Left:Vi.Right},e.prototype.getVerticalDirection=function(t){var e=this.eventLastTime&&this.eventLastTime.clientY,n=t.clientY;return e===n?null:e>n?Bi.Up:Bi.Down},e.prototype.createDropTargetEvent=function(t,e,n,r,o){var i=t.getContainer(),s=i.getBoundingClientRect(),a=this.gridApi,l=this.columnApi,u=this.dragItem,c=this.dragSource;return{event:e,x:e.clientX-s.left,y:e.clientY-s.top,vDirection:r,hDirection:n,dragSource:c,fromNudge:o,dragItem:u,api:a,columnApi:l,dropZoneTarget:i}},e.prototype.positionGhost=function(t){var e=this.eGhost;if(e){var n=e.getBoundingClientRect().height,r=jn()-2,o=Hn()-2,i=vr(e.offsetParent),s=t.clientY,a=t.clientX,l=s-i.top-n/2,u=a-i.left-10,c=this.gridOptionsService.getDocument(),p=c.defaultView||window,h=p.pageYOffset||c.documentElement.scrollTop,d=p.pageXOffset||c.documentElement.scrollLeft;r>0&&u+e.clientWidth>r+d&&(u=r+d-e.clientWidth),u<0&&(u=0),o>0&&l+e.clientHeight>o+h&&(l=o+h-e.clientHeight),l<0&&(l=0),e.style.left=u+"px",e.style.top=l+"px"}},e.prototype.removeGhost=function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null},e.prototype.createGhost=function(){this.eGhost=Sr(n.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);var t=this.environment.getTheme().theme;t&&this.eGhost.classList.add(t),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);var e=this.eGhost.querySelector(".ag-dnd-ghost-label"),r=this.dragSource.dragItemName;A(r)&&(r=r()),e.innerHTML=re(r)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var o=this.gridOptionsService.getDocument(),i=null;try{i=o.fullscreenElement}catch(l){}finally{if(!i){var s=this.gridOptionsService.getRootNode(),a=s.querySelector("body");i=a||(s instanceof ShadowRoot?s:null===s||void 0===s?void 0:s.documentElement)}}this.eGhostParent=i,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")},e.prototype.setGhostIcon=function(t,e){void 0===e&&(e=!1),br(this.eGhostIcon);var r=null;switch(t||(t=this.dragSource.defaultIconName||n.ICON_NOT_ALLOWED),t){case n.ICON_PINNED:r=this.ePinnedIcon;break;case n.ICON_MOVE:r=this.eMoveIcon;break;case n.ICON_LEFT:r=this.eLeftIcon;break;case n.ICON_RIGHT:r=this.eRightIcon;break;case n.ICON_GROUP:r=this.eGroupIcon;break;case n.ICON_AGGREGATE:r=this.eAggregateIcon;break;case n.ICON_PIVOT:r=this.ePivotIcon;break;case n.ICON_NOT_ALLOWED:r=this.eDropNotAllowedIcon;break;case n.ICON_HIDE:r=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",e),r===this.eHideIcon&&this.gridOptionsService.is("suppressDragLeaveHidesColumns")||r&&this.eGhostIcon.appendChild(r)},e.ICON_PINNED="pinned",e.ICON_MOVE="move",e.ICON_LEFT="left",e.ICON_RIGHT="right",e.ICON_GROUP="group",e.ICON_AGGREGATE="aggregate",e.ICON_PIVOT="pivot",e.ICON_NOT_ALLOWED="notAllowed",e.ICON_HIDE="hide",e.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',Gs([$("dragService")],e.prototype,"dragService",void 0),Gs([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Gs([$("columnApi")],e.prototype,"columnApi",void 0),Gs([$("gridApi")],e.prototype,"gridApi",void 0),Gs([Z],e.prototype,"init",null),Gs([Q],e.prototype,"clearDragSourceParamsList",null),e=n=Gs([J("dragAndDropService")],e)}(jt),js=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hs=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Us=function(t){function e(e,n,r,o,i,s){var a=t.call(this)||this;return a.cellValueFn=e,a.rowNode=n,a.column=r,a.customGui=o,a.dragStartPixels=i,a.suppressVisibilityChange=s,a.dragSource=null,a}return js(e,t),e.prototype.isCustomGui=function(){return null!=this.customGui},e.prototype.postConstruct=function(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(Xr("rowDrag",this.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){var t=this.gridOptionsService.is("rowDragManaged")?new Xs(this,this.beans,this.rowNode,this.column):new qs(this,this.beans,this.rowNode,this.column);this.createManagedBean(t,this.beans.context)}},e.prototype.setDragElement=function(t,e){this.setTemplateFromElement(t),this.addDragSource(e)},e.prototype.getSelectedNodes=function(){if(!this.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];var t=this.beans.selectionService.getSelectedNodes();return-1!==t.indexOf(this.rowNode)?t:[this.rowNode]},e.prototype.checkCompatibility=function(){var t=this.gridOptionsService.is("rowDragManaged");this.gridOptionsService.isTreeData()&&t&&O((function(){return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true")}),"RowDragComp.managedAndTreeData")},e.prototype.getDragItem=function(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}},e.prototype.getRowDragText=function(t){if(t){var e=t.getColDef();if(e.rowDragText)return e.rowDragText}return this.gridOptionsService.get("rowDragText")},e.prototype.addDragSource=function(t){var e=this;void 0===t&&(t=4),this.dragSource&&this.removeDragSource();var n=this.getRowDragText(this.column),r=this.localeService.getLocaleTextFunc();this.dragSource={type:Gi.RowDrag,eElement:this.getGui(),dragItemName:function(){var t,o=e.getDragItem(),i=(null===(t=o.rowNodes)||void 0===t?void 0:t.length)||1;return n?n(o,i):1===i?e.cellValueFn():i+" "+r("rowDragRows","rows")},getDragItem:function(){return e.getDragItem()},dragStartPixels:t,dragSourceDomDataKey:this.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)},e.prototype.removeDragSource=function(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null},Hs([$("beans")],e.prototype,"beans",void 0),Hs([Z],e.prototype,"postConstruct",null),Hs([Q],e.prototype,"removeDragSource",null),e}(Eo),Ws=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parent=e,o.rowNode=n,o.column=r,o}return js(e,t),e.prototype.setDisplayedOrVisible=function(t){var e={skipAriaHidden:!0};if(t)this.parent.setDisplayed(!1,e);else{var n=!0,r=!1;this.column&&(n=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),r=A(this.column.getColDef().rowDrag)),r?(this.parent.setDisplayed(!0,e),this.parent.setVisible(n,e)):(this.parent.setDisplayed(n,e),this.parent.setVisible(!0,e))}},e}(jt),qs=function(t){function e(e,n,r,o){var i=t.call(this,e,r,o)||this;return i.beans=n,i}return js(e,t),e.prototype.postConstruct=function(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()},e.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},e.prototype.workOutVisibility=function(){var t=this.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(t)},Hs([Z],e.prototype,"postConstruct",null),e}(Ws),Xs=function(t){function e(e,n,r,o){var i=t.call(this,e,r,o)||this;return i.beans=n,i}return js(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.beans.eventService,Yt.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Yt.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()},e.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},e.prototype.workOutVisibility=function(){var t=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),e=t&&t.shouldPreventRowMove(),n=this.gridOptionsService.is("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),o=e&&!r||n;this.setDisplayedOrVisible(o)},Hs([Z],e.prototype,"postConstruct",null),e}(Ws),Ks=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ys=function(){return(Ys=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Zs=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ks(e,t),e.prototype.init=function(t,e,n,r,o,i,s){this.params=s,this.eGui=e,this.eCheckbox=n,this.eExpanded=r,this.eContracted=o,this.comp=t,this.compClass=i;var a=this.isTopLevelFooter(),l=this.isEmbeddedRowMismatch(),u=null==s.value&&!s.node.master,c=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){var p=s.node;if(p.footer)c=(s.colDef&&s.colDef.showRowGroup)!==(p.rowGroupColumn&&p.rowGroupColumn.getColId())}this.cellIsBlank=!a&&(l||u&&!s.node.master||c),this.cellIsBlank||(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.expandListener=null},e.prototype.refreshAriaExpanded=function(){var t=this.params,e=t.node,n=t.eParentOfValue;if(this.expandListener&&(this.expandListener=this.expandListener()),this.isExpandable()){var r=function(){ln(n,!!e.expanded)};this.expandListener=this.addManagedListener(e,Ds.EVENT_EXPANDED_CHANGED,r)||null,r()}else un(n)},e.prototype.isTopLevelFooter=function(){if(!this.gridOptionsService.is("groupIncludeTotalFooter"))return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;var t=this.params.colDef;if(null==t)return!0;if(!0===t.showRowGroup)return!0;var e=this.columnModel.getRowGroupColumns();return!e||0===e.length||e[0].getId()===t.showRowGroup},e.prototype.isEmbeddedRowMismatch=function(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;var t="left"===this.params.pinned,e="right"===this.params.pinned,n=!t&&!e;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!e:!n:this.columnModel.isPinningLeft()?!t:!n},e.prototype.findDisplayedGroupNode=function(){var t=this.params.column,e=this.params.node;if(this.showingValueForOpenedParent)for(var n=e.parent;null!=n;){if(n.rowGroupColumn&&t.isRowGroupDisplayed(n.rowGroupColumn.getId())){this.displayedGroupNode=n;break}n=n.parent}i(this.displayedGroupNode)&&(this.displayedGroupNode=e)},e.prototype.setupShowingValueForOpenedParent=function(){var t=this.params.node,e=this.params.column;if(this.gridOptionsService.is("groupHideOpenParents"))if(t.groupData){if(null!=t.rowGroupColumn){var n=t.rowGroupColumn.getId();if(e.isRowGroupDisplayed(n))return void(this.showingValueForOpenedParent=!1)}var r=null!=t.groupData[e.getId()];this.showingValueForOpenedParent=r}else this.showingValueForOpenedParent=!1;else this.showingValueForOpenedParent=!1},e.prototype.addValueElement=function(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())},e.prototype.addGroupValue=function(){var t=this.adjustParamsWithDetailsFromRelatedColumn(),e=this.getInnerCompDetails(t),n=t.valueFormatted,r=t.value,o=n;null==o&&(o=""===r&&this.params.node.group?this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):null!==r&&void 0!==r?r:null);this.comp.setInnerRenderer(e,o)},e.prototype.adjustParamsWithDetailsFromRelatedColumn=function(){var t=this.displayedGroupNode.rowGroupColumn,e=this.params.column;if(!t)return this.params;if(null!=e&&!e.isRowGroupDisplayed(t.getId()))return this.params;var n=this.params,r=this.params,o=r.value,i=r.node,s=this.valueFormatterService.formatValue(t,i,o);return Ys(Ys({},n),{valueFormatted:s})},e.prototype.addFooterValue=function(){var t=this.params.footerValueGetter,e="";if(t){var n=m(this.params);n.value=this.params.value,"function"===typeof t?e=t(n):"string"===typeof t?e=this.expressionService.evaluate(t,n):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else e="Total "+(null!=this.params.value?this.params.value:"");var r=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(r,e)},e.prototype.getInnerCompDetails=function(t){var e=this;if(t.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),t);var n=this.userComponentFactory.getInnerRendererDetails(t,t),r=function(t){return t&&t.componentClass==e.compClass};if(n&&!r(n))return n;var o=this.displayedGroupNode.rowGroupColumn,i=o?o.getColDef():void 0;if(i){var s=this.userComponentFactory.getCellRendererDetails(i,t);if(s&&!r(s))return s;if(r(s)&&i.cellRendererParams&&i.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(i.cellRendererParams,t)}},e.prototype.addChildCount=function(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,Ds.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())},e.prototype.updateChildCount=function(){var t=this.displayedGroupNode.allChildrenCount,e=this.isShowRowGroupForThisRow()&&null!=t&&t>=0?"("+t+")":"";this.comp.setChildCount(e)},e.prototype.isShowRowGroupForThisRow=function(){if(this.gridOptionsService.isTreeData())return!0;var t=this.displayedGroupNode.rowGroupColumn;if(!t)return!1;var e=this.params.column;return null==e||e.isRowGroupDisplayed(t.getId())},e.prototype.addExpandAndContract=function(){var t,e=this.params,n=Xr("groupExpanded",this.gridOptionsService,null),r=Xr("groupContracted",this.gridOptionsService,null);n&&this.eExpanded.appendChild(n),r&&this.eContracted.appendChild(r);var o=e.eGridCell;(null===(t=this.params.column)||void 0===t?void 0:t.isCellEditable(e.node))&&this.gridOptionsService.is("enableGroupEdit")||!this.isExpandable()||e.suppressDoubleClickExpand||this.addManagedListener(o,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(o,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(e.node,Ds.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();var i=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,Ds.EVENT_ALL_CHILDREN_COUNT_CHANGED,i),this.addManagedListener(this.displayedGroupNode,Ds.EVENT_MASTER_CHANGED,i),this.addManagedListener(this.displayedGroupNode,Ds.EVENT_GROUP_CHANGED,i),this.addManagedListener(this.displayedGroupNode,Ds.EVENT_HAS_CHILDREN_CHANGED,i)},e.prototype.onExpandClicked=function(t){Mt(t)||(Dt(t),this.onExpandOrContract(t))},e.prototype.onExpandOrContract=function(t){var e=this.displayedGroupNode,n=!e.expanded;!n&&e.sticky&&this.scrollToStickyNode(e),e.setExpanded(n,t)},e.prototype.scrollToStickyNode=function(t){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(t.rowTop-t.stickyRowTop)},e.prototype.isExpandable=function(){if(this.showingValueForOpenedParent)return!0;var t=this.displayedGroupNode,e=this.columnModel.isPivotMode()&&t.leafGroup;if(!(t.isExpandable()&&!t.footer&&!e))return!1;var n=this.params.column;return null==n||"string"!==typeof n.getColDef().showRowGroup||this.isShowRowGroupForThisRow()},e.prototype.showExpandAndContractIcons=function(){var t=this.params,e=this.displayedGroupNode,n=this.columnModel,r=t.node,o=this.isExpandable();if(o){var i=!!this.showingValueForOpenedParent||r.expanded;this.comp.setExpandedDisplayed(i),this.comp.setContractedDisplayed(!i)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);var s=n.isPivotMode(),a=s&&e.leafGroup,l=o&&!a,u=r.footer&&-1===r.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",l),this.comp.addOrRemoveCssClass("ag-row-group",l),s?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",a):u||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!l)},e.prototype.onRowNodeIsExpandableChanged=function(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()},e.prototype.setupIndent=function(){var t=this.params.node;this.params.suppressPadding||(this.addManagedListener(t,Ds.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())},e.prototype.setIndent=function(){if(!this.gridOptionsService.is("groupHideOpenParents")){var t=this.params,e=t.node,n=!!t.colDef,r=this.gridOptionsService.isTreeData(),o=!n||r||!0===t.colDef.showRowGroup?e.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+o,this.comp.addOrRemoveCssClass(this.indentClass,!0)}},e.prototype.addFullWidthRowDraggerIfNeeded=function(){var t=this;if(this.params.fullWidth&&this.params.rowDrag){var e=new Us((function(){return t.params.value}),this.params.node);this.createManagedBean(e,this.context),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}},e.prototype.isUserWantsSelected=function(){var t=this.params.checkbox;return"function"===typeof t||!0===t},e.prototype.addCheckboxIfNeeded=function(){var t=this,e=this.displayedGroupNode,n=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(n){var r=new Fs;this.getContext().createBean(r),r.init({rowNode:e,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(r.getGui()),this.addDestroyFunc((function(){return t.getContext().destroyBean(r)}))}this.comp.setCheckboxVisible(n)},e.prototype.onKeyDown=function(t){t.key!==Yr.ENTER||this.params.suppressEnterExpand||(this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(t))},e.prototype.onCellDblClicked=function(t){Mt(t)||(Ft(this.eExpanded,t)||Ft(this.eContracted,t)||this.onExpandOrContract(t))},Zs([$("expressionService")],e.prototype,"expressionService",void 0),Zs([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),Zs([$("columnModel")],e.prototype,"columnModel",void 0),Zs([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Zs([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e}(jt),Js=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$s=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ta=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return Js(e,t),e.prototype.init=function(t){var e=this,n={setInnerRenderer:function(t,n){return e.setRenderDetails(t,n)},setChildCount:function(t){return e.eChildCount.innerHTML=t},addOrRemoveCssClass:function(t,n){return e.addOrRemoveCssClass(t,n)},setContractedDisplayed:function(t){return ur(e.eContracted,t)},setExpandedDisplayed:function(t){return ur(e.eExpanded,t)},setCheckboxVisible:function(t){return e.eCheckbox.classList.toggle("ag-invisible",!t)}},r=this.createManagedBean(new Qs),o=!t.colDef,i=this.getGui();r.init(n,i,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,t),o&&Ye(i,"gridcell")},e.prototype.setRenderDetails=function(t,e){var n=this;if(t){var r=t.newAgStackInstance();if(!r)return;r.then((function(t){if(t){var e=function(){return n.context.destroyBean(t)};n.isAlive()?(n.eValue.appendChild(t.getGui()),n.addDestroyFunc(e)):e()}}))}else this.eValue.innerText=e},e.prototype.destroy=function(){this.getContext().destroyBean(this.innerCellRenderer),t.prototype.destroy.call(this)},e.prototype.refresh=function(){return!1},e.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',$s([To("eExpanded")],e.prototype,"eExpanded",void 0),$s([To("eContracted")],e.prototype,"eContracted",void 0),$s([To("eCheckbox")],e.prototype,"eCheckbox",void 0),$s([To("eValue")],e.prototype,"eValue",void 0),$s([To("eChildCount")],e.prototype,"eChildCount",void 0),e}(Eo),ea=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),na=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ra=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return ea(e,t),e.prototype.init=function(t){t.node.failedLoad?this.setupFailed():this.setupLoading()},e.prototype.setupFailed=function(){var t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingError","ERR")},e.prototype.setupLoading=function(){var t=Xr("groupLoading",this.gridOptionsService,null);t&&this.eLoadingIcon.appendChild(t);var e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingOoo","Loading")},e.prototype.refresh=function(t){return!1},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',na([To("eLoadingIcon")],e.prototype,"eLoadingIcon",void 0),na([To("eLoadingText")],e.prototype,"eLoadingText",void 0),e}(Eo),oa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ia=function(t){function e(){return t.call(this)||this}return oa(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){var n,r=null!==(n=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==n?n:e.DEFAULT_LOADING_OVERLAY_TEMPLATE,o=this.localeService.getLocaleTextFunc(),i=r.replace("[LOADING...]",o("loadingOoo","Loading..."));this.setTemplate(i)},e.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>',e}(Eo),sa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),aa=function(t){function e(){return t.call(this)||this}return sa(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){var n,r=null!==(n=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==n?n:e.DEFAULT_NO_ROWS_TEMPLATE,o=this.localeService.getLocaleTextFunc(),i=r.replace("[NO_ROWS_TO_SHOW]",o("noRowsToShow","No Rows To Show"));this.setTemplate(i)},e.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>',e}(Eo),la=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ua=function(t){function e(){return t.call(this,'<div class="ag-tooltip"></div>')||this}return la(e,t),e.prototype.init=function(t){var e=t.value;this.getGui().innerHTML=re(e)},e}(hs),ca=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pa=function(){function t(){}return t.prototype.getTemplate=function(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.max&&t.setMax(e.max),null!=e.min&&t.setMin(e.min),null!=e.precision&&t.setPrecision(e.precision),null!=e.step&&t.setStep(e.step),e.showStepperButtons&&t.getInputElement().classList.add("ag-number-field-input-stepper")},t.prototype.getValue=function(){var t=this.eInput.getValue();if(!o(t)&&!o(this.params.value))return this.params.value;var e=this.params.parseValue(t);if(null==e)return e;if("string"===typeof e){if(""===e)return null;e=Number(e)}return isNaN(e)?null:e},t.prototype.getStartValue=function(){return this.params.value},t}(),ha=function(t){function e(){return t.call(this,new pa)||this}return ca(e,t),e}(Cs),da=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fa=function(){function t(){}return t.prototype.getTemplate=function(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.min&&t.setMin(e.min),null!=e.max&&t.setMax(e.max),null!=e.step&&t.setStep(e.step)},t.prototype.getValue=function(){var t=this.eInput.getDate();return o(t)||o(this.params.value)?null!==t&&void 0!==t?t:null:this.params.value},t.prototype.getStartValue=function(){var t=this.params.value;if(t instanceof Date)return $n(t,!1)},t}(),ga=function(t){function e(){return t.call(this,new fa)||this}return da(e,t),e}(Cs),ma=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ya=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},va=function(){function t(t){this.getDataTypeService=t}return t.prototype.getTemplate=function(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.min&&t.setMin(e.min),null!=e.max&&t.setMax(e.max),null!=e.step&&t.setStep(e.step)},t.prototype.getValue=function(){var t=this.formatDate(this.eInput.getDate());return o(t)||o(this.params.value)?this.params.parseValue(null!==t&&void 0!==t?t:""):this.params.value},t.prototype.getStartValue=function(){var t,e;return $n(null!==(e=this.parseDate(null!==(t=this.params.value)&&void 0!==t?t:void 0))&&void 0!==e?e:null,!1)},t.prototype.parseDate=function(t){return this.getDataTypeService().getDateParserFunction()(t)},t.prototype.formatDate=function(t){return this.getDataTypeService().getDateFormatterFunction()(t)},t}(),_a=function(t){function e(){var e=t.call(this,new va((function(){return e.dataTypeService})))||this;return e}return ma(e,t),ya([$("dataTypeService")],e.prototype,"dataTypeService",void 0),e}(Cs),wa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ca=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ba=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return wa(e,t),e.prototype.init=function(t){var e=this;this.params=t,this.updateCheckbox(t),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(t){if(Dt(t),!e.eCheckbox.isDisabled()){var n=e.eCheckbox.getValue();e.onCheckboxChanged(n)}})),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(t){Dt(t)}));var n=this.gridOptionsService.getDocument();this.addManagedListener(this.params.eGridCell,"keydown",(function(t){if(t.key===Yr.SPACE&&!e.eCheckbox.isDisabled()){e.params.eGridCell===n.activeElement&&e.eCheckbox.toggle();var r=e.eCheckbox.getValue();e.onCheckboxChanged(r),t.preventDefault()}}))},e.prototype.refresh=function(t){return this.params=t,this.updateCheckbox(t),!0},e.prototype.updateCheckbox=function(t){var e,n,r,o,i=!0;if(t.node.group&&t.column){var s=t.column.getColId();s.startsWith($t)?o=null==t.value||""===t.value?void 0:"true"===t.value:t.node.aggData&&void 0!==t.node.aggData[s]?o=null!==(e=t.value)&&void 0!==e?e:void 0:i=!1}else o=null!==(n=t.value)&&void 0!==n?n:void 0;if(i){this.eCheckbox.setValue(o);var a=null!=t.disabled?t.disabled:!(null===(r=t.column)||void 0===r?void 0:r.isCellEditable(t.node));this.eCheckbox.setDisabled(a);var l=this.localeService.getLocaleTextFunc(),u=xn(l,o),c=a?u:l("ariaToggleCellValue","Press SPACE to toggle cell value")+" ("+u+")";this.eCheckbox.setInputAriaLabel(c)}else this.eCheckbox.setDisplayed(!1)},e.prototype.onCheckboxChanged=function(t){var e=this.params,n=e.column,r=e.node,o=e.rowIndex,i=e.value,s={type:Yt.EVENT_CELL_EDITING_STARTED,column:n,colDef:null===n||void 0===n?void 0:n.getColDef(),data:r.data,node:r,rowIndex:o,rowPinned:r.rowPinned,value:i};this.eventService.dispatchEvent(s);var a=this.params.node.setDataValue(this.params.column,t,"edit"),l={type:Yt.EVENT_CELL_EDITING_STOPPED,column:n,colDef:null===n||void 0===n?void 0:n.getColDef(),data:r.data,node:r,rowIndex:o,rowPinned:r.rowPinned,value:i,oldValue:i,newValue:t,valueChanged:a};this.eventService.dispatchEvent(l)},e.TEMPLATE='\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>',Ca([To("eCheckbox")],e.prototype,"eCheckbox",void 0),e}(Eo),xa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ea=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Sa=function(t){function e(){return t.call(this,'\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return xa(e,t),e.prototype.init=function(t){var e,n=this;this.params=t;var r=null!==(e=t.value)&&void 0!==e?e:void 0;this.eCheckbox.setValue(r),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(r),this.addManagedListener(this.eCheckbox,Yt.EVENT_FIELD_VALUE_CHANGED,(function(t){return n.setAriaLabel(t.selected)}))},e.prototype.getValue=function(){return this.eCheckbox.getValue()},e.prototype.focusIn=function(){this.eCheckbox.getFocusableElement().focus()},e.prototype.afterGuiAttached=function(){this.params.cellStartedEdit&&this.focusIn()},e.prototype.isPopup=function(){return!1},e.prototype.setAriaLabel=function(t){var e=this.localeService.getLocaleTextFunc(),n=xn(e,t),r=e("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(r+" ("+n+")")},Ea([To("eCheckbox")],e.prototype,"eCheckbox",void 0),e}(hs),Ta=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ra=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Pa=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Oa=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Ia=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.agGridDefaults={agDateInput:Ii,agColumnHeader:as,agColumnGroupHeader:cs,agSortIndicator:os,agTextColumnFloatingFilter:ts,agNumberColumnFloatingFilter:Ji,agDateColumnFloatingFilter:Ri,agReadOnlyFloatingFilter:Io,agAnimateShowChangeCellRenderer:Rs,agAnimateSlideCellRenderer:Is,agGroupCellRenderer:ta,agGroupRowRenderer:ta,agLoadingCellRenderer:ra,agCheckboxCellRenderer:ba,agCellEditor:Es,agTextCellEditor:Es,agNumberCellEditor:ha,agDateCellEditor:ga,agDateStringCellEditor:_a,agSelectCellEditor:vs,agLargeTextCellEditor:gs,agCheckboxCellEditor:Sa,agTextColumnFilter:Wi,agNumberColumnFilter:zi,agDateColumnFilter:bi,agLoadingOverlay:ia,agNoRowsOverlay:aa,agTooltipComponent:ua},e.enterpriseAgDefaultCompsModule={agSetColumnFilter:z.SetFilterModule,agSetColumnFloatingFilter:z.SetFilterModule,agMultiColumnFilter:z.MultiFilterModule,agMultiColumnFloatingFilter:z.MultiFilterModule,agGroupColumnFilter:z.RowGroupingModule,agGroupColumnFloatingFilter:z.RowGroupingModule,agRichSelect:z.RichSelectModule,agRichSelectCellEditor:z.RichSelectModule,agDetailCellRenderer:z.MasterDetailModule,agSparklineCellRenderer:z.SparklinesModule},e.jsComps={},e}return Ta(e,t),e.prototype.init=function(){var t=this;null!=this.gridOptions.components&&g(this.gridOptions.components,(function(e,n){return t.registerJsComponent(e,n)}))},e.prototype.registerDefaultComponent=function(t,e){this.agGridDefaults[t]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[t]=e},e.prototype.registerJsComponent=function(t,e){this.jsComps[t]=e},e.prototype.retrieve=function(t,e){var n=this,r=function(t,e){return{componentFromFramework:e,component:t}},o=this.getFrameworkOverrides().frameworkComponent(e,this.gridOptions.components);if(null!=o)return r(o,!0);var i=this.jsComps[e];if(i)return r(i,this.getFrameworkOverrides().isFrameworkComponent(i));var s=this.agGridDefaults[e];if(s)return r(s,!1);var a=this.enterpriseAgDefaultCompsModule[e];return a?W.__assertRegistered(a,"AG Grid '"+t+"' component: "+e,this.context.getGridId()):O((function(){n.warnAboutMissingComponent(t,e)}),"MissingComp"+e),null},e.prototype.warnAboutMissingComponent=function(t,e){var n=ve(e,Oa(Oa([],Pa(Object.keys(this.agGridDefaults).filter((function(t){return!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(t)})))),Pa(Object.keys(this.jsComps))),!0,.8);console.warn("AG Grid: Could not find '"+e+"' component. It was configured as \""+t+": '"+e+"'\" but it wasn't found in the list of registered components."),n.length>0&&console.warn("         Did you mean: ["+n.slice(0,3)+"]?"),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")},Ra([$("gridOptions")],e.prototype,"gridOptions",void 0),Ra([Z],e.prototype,"init",null),e=Ra([J("userComponentRegistry")],e)}(jt),Aa={propertyName:"dateComponent",cellRenderer:!1},Da={propertyName:"headerComponent",cellRenderer:!1},Ma={propertyName:"headerGroupComponent",cellRenderer:!1},La={propertyName:"cellRenderer",cellRenderer:!0},Na={propertyName:"cellEditor",cellRenderer:!1},Fa={propertyName:"innerRenderer",cellRenderer:!0},ka={propertyName:"loadingOverlayComponent",cellRenderer:!1},Ga={propertyName:"noRowsOverlayComponent",cellRenderer:!1},Ba={propertyName:"tooltipComponent",cellRenderer:!1},Va={propertyName:"filter",cellRenderer:!1},za={propertyName:"floatingFilterComponent",cellRenderer:!1},ja={propertyName:"toolPanel",cellRenderer:!1},Ha={propertyName:"statusPanel",cellRenderer:!1},Ua={propertyName:"fullWidthCellRenderer",cellRenderer:!0},Wa={propertyName:"loadingCellRenderer",cellRenderer:!0},qa={propertyName:"groupRowRenderer",cellRenderer:!0},Xa={propertyName:"detailCellRenderer",cellRenderer:!0},Ka=function(){function t(){}return t.getFloatingFilterType=function(t){return this.filterToFloatingFilterMapping[t]},t.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"},t}(),Ya=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Za=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ya(e,t),e.prototype.getHeaderCompDetails=function(t,e){return this.getCompDetails(t,Da,"agColumnHeader",e)},e.prototype.getHeaderGroupCompDetails=function(t){var e=t.columnGroup.getColGroupDef();return this.getCompDetails(e,Ma,"agColumnGroupHeader",t)},e.prototype.getFullWidthCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Ua,null,t,!0)},e.prototype.getFullWidthLoadingCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Wa,"agLoadingCellRenderer",t,!0)},e.prototype.getFullWidthGroupCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,qa,"agGroupRowRenderer",t,!0)},e.prototype.getFullWidthDetailCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Xa,"agDetailCellRenderer",t,!0)},e.prototype.getInnerRendererDetails=function(t,e){return this.getCompDetails(t,Fa,null,e)},e.prototype.getFullWidthGroupRowInnerCellRenderer=function(t,e){return this.getCompDetails(t,Fa,null,e)},e.prototype.getCellRendererDetails=function(t,e){return this.getCompDetails(t,La,null,e)},e.prototype.getCellEditorDetails=function(t,e){return this.getCompDetails(t,Na,"agCellEditor",e,!0)},e.prototype.getFilterDetails=function(t,e,n){return this.getCompDetails(t,Va,n,e,!0)},e.prototype.getDateCompDetails=function(t){return this.getCompDetails(this.gridOptions,Aa,"agDateInput",t,!0)},e.prototype.getLoadingOverlayCompDetails=function(t){return this.getCompDetails(this.gridOptions,ka,"agLoadingOverlay",t,!0)},e.prototype.getNoRowsOverlayCompDetails=function(t){return this.getCompDetails(this.gridOptions,Ga,"agNoRowsOverlay",t,!0)},e.prototype.getTooltipCompDetails=function(t){return this.getCompDetails(t.colDef,Ba,"agTooltipComponent",t,!0)},e.prototype.getSetFilterCellRendererDetails=function(t,e){return this.getCompDetails(t,La,null,e)},e.prototype.getFloatingFilterCompDetails=function(t,e,n){return this.getCompDetails(t,za,n,e)},e.prototype.getToolPanelCompDetails=function(t,e){return this.getCompDetails(t,ja,null,e,!0)},e.prototype.getStatusPanelCompDetails=function(t,e){return this.getCompDetails(t,Ha,null,e,!0)},e.prototype.getCompDetails=function(t,e,n,r,o){var i=this;void 0===o&&(o=!1);var s=e.propertyName,a=e.cellRenderer,l=this.getCompKeys(t,e,r),u=l.compName,c=l.jsComp,p=l.fwComp,h=l.paramsFromSelector,d=l.popupFromSelector,f=l.popupPositionFromSelector,g=function(t){var e=i.userComponentRegistry.retrieve(s,t);e&&(c=e.componentFromFramework?void 0:e.component,p=e.componentFromFramework?e.component:void 0)};if(null!=u&&g(u),null==c&&null==p&&null!=n&&g(n),c&&a&&!this.agComponentUtils.doesImplementIComponent(c)&&(c=this.agComponentUtils.adaptFunction(s,c)),c||p){var m=this.mergeParamsWithApplicationProvidedParams(t,e,r,h),y=null==c,v=c||p;return{componentFromFramework:y,componentClass:v,params:m,type:e,popupFromSelector:d,popupPositionFromSelector:f,newAgStackInstance:function(){return i.newAgStackInstance(v,y,m,e)}}}o&&console.error("AG Grid: Could not find component "+u+", did you forget to configure this component?")},e.prototype.getCompKeys=function(t,e,n){var r,o,i,s,a,l,u=this,c=e.propertyName;if(t){var p=t,h=p[c+"Selector"],d=h?h(n):null,f=function(t){if("string"===typeof t)r=t;else if(null!=t&&!0!==t){u.getFrameworkOverrides().isFrameworkComponent(t)?i=t:o=t}};d?(f(d.component),s=d.params,a=d.popup,l=d.popupPosition):f(p[c])}return{compName:r,jsComp:o,fwComp:i,paramsFromSelector:s,popupFromSelector:a,popupPositionFromSelector:l}},e.prototype.newAgStackInstance=function(t,e,n,r){var o,i=r.propertyName;if(!e)o=new t;else{var s=this.componentMetadataProvider.retrieve(i);o=this.frameworkComponentWrapper.wrap(t,s.mandatoryMethodList,s.optionalMethodList,r)}var a=this.initComponent(o,n);return null==a?fo.resolve(o):a.then((function(){return o}))},e.prototype.mergeParamsWithApplicationProvidedParams=function(t,e,n,r){void 0===r&&(r=null);var o={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};x(o,n);var i=t&&t[e.propertyName+"Params"];"function"===typeof i?x(o,i(n)):"object"===typeof i&&x(o,i);return x(o,r),o},e.prototype.initComponent=function(t,e){if(this.context.createBean(t),null!=t.init)return t.init(e)},e.prototype.getDefaultFloatingFilterType=function(t,e){if(null==t)return null;var n=null,r=this.getCompKeys(t,Va),o=r.compName,i=r.jsComp,s=r.fwComp;o?n=Ka.getFloatingFilterType(o):null==i&&null==s&&!0===t.filter&&(n=e());return n},Za([$("gridOptions")],e.prototype,"gridOptions",void 0),Za([$("agComponentUtils")],e.prototype,"agComponentUtils",void 0),Za([$("componentMetadataProvider")],e.prototype,"componentMetadataProvider",void 0),Za([$("userComponentRegistry")],e.prototype,"userComponentRegistry",void 0),Za([tt("frameworkComponentWrapper")],e.prototype,"frameworkComponentWrapper",void 0),e=Za([J("userComponentFactory")],e)}(jt);!function(t){t[t.SINGLE_SHEET=0]="SINGLE_SHEET",t[t.MULTI_SHEET=1]="MULTI_SHEET"}(Vs||(Vs={}));var Ja,$a,tl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),el=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},nl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragEndFunctions=[],e.dragSources=[],e}return tl(e,t),e.prototype.removeAllListeners=function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0},e.prototype.removeListener=function(t){var e=t.dragSource.eElement,n=t.mouseDownListener;if(e.removeEventListener("mousedown",n),t.touchEnabled){var r=t.touchStartListener;e.removeEventListener("touchstart",r,{passive:!0})}},e.prototype.removeDragSource=function(t){var e=this.dragSources.find((function(e){return e.dragSource===t}));e&&(this.removeListener(e),Ct(this.dragSources,e))},e.prototype.isDragging=function(){return this.dragging},e.prototype.addDragSource=function(t){var e=this,n=this.onMouseDown.bind(this,t),r=t.eElement,o=t.includeTouch,i=t.stopPropagationForTouch;r.addEventListener("mousedown",n);var s=null,a=this.gridOptionsService.is("suppressTouch");o&&!a&&(s=function(n){lr(n.target)||(n.cancelable&&(n.preventDefault(),i&&n.stopPropagation()),e.onTouchStart(t,n))},r.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:t,mouseDownListener:n,touchStartListener:s,touchEnabled:!!o})},e.prototype.getStartTarget=function(){return this.startTarget},e.prototype.onTouchStart=function(t,e){var n=this;this.currentDragParams=t,this.dragging=!1;var r=e.touches[0];this.touchLastTime=r,this.touchStart=r;var o=function(e){return n.onTouchUp(e,t.eElement)},i=e.target,s=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:function(t){t.cancelable&&t.preventDefault()},options:{passive:!1}},{target:i,type:"touchmove",listener:function(e){return n.onTouchMove(e,t.eElement)},options:{passive:!0}},{target:i,type:"touchend",listener:o,options:{passive:!0}},{target:i,type:"touchcancel",listener:o,options:{passive:!0}}];this.addTemporaryEvents(s),0===t.dragStartPixels&&this.onCommonMove(r,this.touchStart,t.eElement)},e.prototype.onMouseDown=function(t,e){var n=this,r=e;if((!t.skipMouseEvent||!t.skipMouseEvent(e))&&!r._alreadyProcessedByDragService&&(r._alreadyProcessedByDragService=!0,0===e.button)){this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.currentDragParams=t,this.dragging=!1,this.mouseStartEvent=e,this.startTarget=e.target;var o=this.gridOptionsService.getRootNode(),i=[{target:o,type:"mousemove",listener:function(e){return n.onMouseMove(e,t.eElement)}},{target:o,type:"mouseup",listener:function(e){return n.onMouseUp(e,t.eElement)}},{target:o,type:"contextmenu",listener:function(t){return t.preventDefault()}}];this.addTemporaryEvents(i),0===t.dragStartPixels&&this.onMouseMove(e,t.eElement)}},e.prototype.addTemporaryEvents=function(t){t.forEach((function(t){var e=t.target,n=t.type,r=t.listener,o=t.options;e.addEventListener(n,r,o)})),this.dragEndFunctions.push((function(){t.forEach((function(t){var e=t.target,n=t.type,r=t.listener,o=t.options;e.removeEventListener(n,r,o)}))}))},e.prototype.isEventNearStartEvent=function(t,e){var n=this.currentDragParams.dragStartPixels;return no(t,e,o(n)?n:4)},e.prototype.getFirstActiveTouch=function(t){for(var e=0;e<t.length;e++)if(t[e].identifier===this.touchStart.identifier)return t[e];return null},e.prototype.onCommonMove=function(t,e,n){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(t,e))return;this.dragging=!0;var r={type:Yt.EVENT_DRAG_STARTED,target:n};this.eventService.dispatchEvent(r),this.currentDragParams.onDragStart(e),this.currentDragParams.onDragging(e)}this.currentDragParams.onDragging(t)},e.prototype.onTouchMove=function(t,e){var n=this.getFirstActiveTouch(t.touches);n&&this.onCommonMove(n,this.touchStart,e)},e.prototype.onMouseMove=function(t,e){this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.onCommonMove(t,this.mouseStartEvent,e)},e.prototype.shouldPreventMouseEvent=function(t){var e=this.gridOptionsService.is("enableCellTextSelection"),n=Mn(),r="mousemove"===t.type;return(e&&r||n)&&t.cancelable&&this.mouseEventService.isEventFromThisGrid(t)&&!this.isOverFormFieldElement(t)},e.prototype.isOverFormFieldElement=function(t){var e=t.target,n=null===e||void 0===e?void 0:e.tagName.toLocaleLowerCase();return!!(null===n||void 0===n?void 0:n.match("^a$|textarea|input|select|button"))},e.prototype.onTouchUp=function(t,e){var n=this.getFirstActiveTouch(t.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,e)},e.prototype.onMouseUp=function(t,e){this.onUpCommon(t,e)},e.prototype.onUpCommon=function(t,e){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(t);var n={type:Yt.EVENT_DRAG_STOPPED,target:e};this.eventService.dispatchEvent(n)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach((function(t){return t()})),this.dragEndFunctions.length=0},el([$("mouseEventService")],e.prototype,"mouseEventService",void 0),el([Q],e.prototype,"removeAllListeners",null),e=el([J("dragService")],e)}(jt);!function(t){t[t.Above=0]="Above",t[t.Below=1]="Below"}(Ja||(Ja={})),function(t){t.EVERYTHING="group",t.FILTER="filter",t.SORT="sort",t.MAP="map",t.AGGREGATE="aggregate",t.FILTER_AGGREGATES="filter_aggregates",t.PIVOT="pivot",t.NOTHING="nothing"}($a||($a={}));var rl=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};function ol(t){var e=t;return null!=e&&null!=e.getFrameworkComponentInstance?e.getFrameworkComponentInstance():t}var il,sl=function(){function t(){this.detailGridInfoMap={},this.destroyCalled=!1}return t.prototype.registerOverlayWrapperComp=function(t){this.overlayWrapperComp=t},t.prototype.registerSideBarComp=function(t){this.sideBarComp=t},t.prototype.init=function(){var t=this;switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl()}))},t.prototype.__getAlignedGridService=function(){return this.alignedGridsService},t.prototype.__getContext=function(){return this.context},t.prototype.getSetterMethod=function(t){return"set"+t.charAt(0).toUpperCase()+t.substring(1)},t.prototype.__setProperty=function(t,e){this.gos.set(t,e);var n=this.getSetterMethod(t);this[n]&&this[n](e)},t.prototype.getGridId=function(){return this.context.getGridId()},t.prototype.addDetailGridInfo=function(t,e){this.detailGridInfoMap[t]=e},t.prototype.removeDetailGridInfo=function(t){this.detailGridInfoMap[t]=void 0},t.prototype.getDetailGridInfo=function(t){return this.detailGridInfoMap[t]},t.prototype.forEachDetailGridInfo=function(t){var e=0;g(this.detailGridInfoMap,(function(n,r){o(r)&&(t(r,e),e++)}))},t.prototype.getDataAsCsv=function(t){if(W.__assertRegistered(z.CsvExportModule,"api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(t)},t.prototype.exportDataAsCsv=function(t){W.__assertRegistered(z.CsvExportModule,"api.exportDataAsCSv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(t)},t.prototype.getExcelExportMode=function(t){var e=this.gos.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},e,t).exportMode},t.prototype.assertNotExcelMultiSheet=function(t,e){if(!W.__assertRegistered(z.ExcelExportModule,"api."+t,this.context.getGridId()))return!1;var n=this.getExcelExportMode(e);return this.excelCreator.getFactoryMode(n)!==Vs.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)},t.prototype.getDataAsExcel=function(t){if(this.assertNotExcelMultiSheet("getDataAsExcel",t))return this.excelCreator.getDataAsExcel(t)},t.prototype.exportDataAsExcel=function(t){this.assertNotExcelMultiSheet("exportDataAsExcel",t)&&this.excelCreator.exportDataAsExcel(t)},t.prototype.getSheetDataForExcel=function(t){if(W.__assertRegistered(z.ExcelExportModule,"api.getSheetDataForExcel",this.context.getGridId())){var e=this.getExcelExportMode(t);return this.excelCreator.setFactoryMode(Vs.MULTI_SHEET,e),this.excelCreator.getSheetDataForExcel(t)}},t.prototype.getMultipleSheetsAsExcel=function(t){if(W.__assertRegistered(z.ExcelExportModule,"api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(t)},t.prototype.exportMultipleSheetsAsExcel=function(t){if(W.__assertRegistered(z.ExcelExportModule,"api.exportMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.exportMultipleSheetsAsExcel(t)},t.prototype.setGridAriaProperty=function(t,e){if(t){var n=this.ctrlsService.getGridBodyCtrl().getGui(),r="aria-"+t;null===e?n.removeAttribute(r):n.setAttribute(r,e)}},t.prototype.logMissingRowModel=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.error("AG Grid: api."+t+" can only be called when gridOptions.rowModelType is "+e.join(" or "))},t.prototype.setServerSideDatasource=function(t){this.serverSideRowModel?this.serverSideRowModel.setDatasource(t):this.logMissingRowModel("setServerSideDatasource","serverSide")},t.prototype.setCacheBlockSize=function(t){this.serverSideRowModel?(this.gos.set("cacheBlockSize",t),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")},t.prototype.setDatasource=function(t){this.gos.isRowModelType("infinite")?this.rowModel.setDatasource(t):this.logMissingRowModel("setDatasource","infinite")},t.prototype.setViewportDatasource=function(t){this.gos.isRowModelType("viewport")?this.rowModel.setViewportDatasource(t):this.logMissingRowModel("setViewportDatasource","viewport")},t.prototype.setRowData=function(t){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(t):(this.selectionService.reset(),this.clientSideRowModel.setRowData(t))},t.prototype.setPinnedTopRowData=function(t){this.pinnedRowModel.setPinnedTopRowData(t)},t.prototype.setPinnedBottomRowData=function(t){this.pinnedRowModel.setPinnedBottomRowData(t)},t.prototype.getPinnedTopRowCount=function(){return this.pinnedRowModel.getPinnedTopRowCount()},t.prototype.getPinnedBottomRowCount=function(){return this.pinnedRowModel.getPinnedBottomRowCount()},t.prototype.getPinnedTopRow=function(t){return this.pinnedRowModel.getPinnedTopRow(t)},t.prototype.getPinnedBottomRow=function(t){return this.pinnedRowModel.getPinnedBottomRow(t)},t.prototype.setColumnDefs=function(t,e){void 0===e&&(e="api"),this.columnModel.setColumnDefs(t,e),this.gos.set("columnDefs",t,!0,{source:e})},t.prototype.setAutoGroupColumnDef=function(t,e){void 0===e&&(e="api"),this.gos.set("autoGroupColumnDef",t,!0,{source:e})},t.prototype.setDefaultColDef=function(t,e){void 0===e&&(e="api"),this.gos.set("defaultColDef",t,!0,{source:e})},t.prototype.setColumnTypes=function(t,e){void 0===e&&(e="api"),this.gos.set("columnTypes",t,!0,{source:e})},t.prototype.expireValueCache=function(){this.valueCache.expire()},t.prototype.getVerticalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()},t.prototype.getHorizontalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()},t.prototype.setAlwaysShowHorizontalScroll=function(t){this.gos.set("alwaysShowHorizontalScroll",t)},t.prototype.setAlwaysShowVerticalScroll=function(t){this.gos.set("alwaysShowVerticalScroll",t)},t.prototype.refreshCells=function(t){void 0===t&&(t={}),this.rowRenderer.refreshCells(t)},t.prototype.flashCells=function(t){void 0===t&&(t={}),this.rowRenderer.flashCells(t)},t.prototype.redrawRows=function(t){void 0===t&&(t={});var e=t?t.rowNodes:void 0;this.rowRenderer.redrawRows(e)},t.prototype.setFunctionsReadOnly=function(t){this.gos.set("functionsReadOnly",t)},t.prototype.refreshHeader=function(){this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(t){return t.refresh()}))},t.prototype.isAnyFilterPresent=function(){return this.filterManager.isAnyFilterPresent()},t.prototype.isColumnFilterPresent=function(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()},t.prototype.isQuickFilterPresent=function(){return this.filterManager.isQuickFilterPresent()},t.prototype.getModel=function(){return this.rowModel},t.prototype.setRowNodeExpanded=function(t,e,n){t&&(n&&t.parent&&-1!==t.parent.level&&this.setRowNodeExpanded(t.parent,e,n),t.setExpanded(e))},t.prototype.onGroupExpandedOrCollapsed=function(){i(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:$a.MAP})},t.prototype.refreshClientSideRowModel=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(t)},t.prototype.isAnimationFrameQueueEmpty=function(){return this.animationFrameService.isQueueEmpty()},t.prototype.flushAllAnimationFrames=function(){this.animationFrameService.flushAllFrames()},t.prototype.getRowNode=function(t){return this.rowModel.getRowNode(t)},t.prototype.getSizesForCurrentTheme=function(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}},t.prototype.expandAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")},t.prototype.collapseAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")},t.prototype.addRenderedRowListener=function(t,e,n){this.rowRenderer.addRenderedRowListener(t,e,n)},t.prototype.getQuickFilter=function(){return this.gos.get("quickFilterText")},t.prototype.setQuickFilter=function(t){this.gos.set("quickFilterText",t)},t.prototype.setExcludeHiddenColumnsFromQuickFilter=function(t){Ee("30","setExcludeHiddenColumnsFromQuickFilter",void 0,"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `setIncludeHiddenColumnsInQuickFilter`"),this.setIncludeHiddenColumnsInQuickFilter(!t)},t.prototype.setIncludeHiddenColumnsInQuickFilter=function(t){this.gos.set("includeHiddenColumnsInQuickFilter",t)},t.prototype.getAdvancedFilterModel=function(){return W.__assertRegistered(z.AdvancedFilterModule,"api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null},t.prototype.setAdvancedFilterModel=function(t){W.__assertRegistered(z.AdvancedFilterModule,"api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.setAdvancedFilterModel(t)},t.prototype.setEnableAdvancedFilter=function(t){this.gos.set("enableAdvancedFilter",t)},t.prototype.setIncludeHiddenColumnsInAdvancedFilter=function(t){this.gos.set("includeHiddenColumnsInAdvancedFilter",t)},t.prototype.setAdvancedFilterParent=function(t){this.gos.set("advancedFilterParent",t)},t.prototype.setNodesSelected=function(t){if(t.nodes.every((function(t){return t.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):void 0!==t.id||(console.warn("AG Grid: cannot select node until id for node is known"),!1)}))){var e=t.nodes,n=t.source,r=t.newValue,o=e;this.selectionService.setNodesSelected({nodes:o,source:null!==n&&void 0!==n?n:"api",newValue:r})}},t.prototype.selectAll=function(t){void 0===t&&(t="apiSelectAll"),this.selectionService.selectAllRowNodes({source:t})},t.prototype.deselectAll=function(t){void 0===t&&(t="apiSelectAll"),this.selectionService.deselectAllRowNodes({source:t})},t.prototype.selectAllFiltered=function(t){void 0===t&&(t="apiSelectAllFiltered"),this.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},t.prototype.deselectAllFiltered=function(t){void 0===t&&(t="apiSelectAllFiltered"),this.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},t.prototype.getServerSideSelectionState=function(){return i(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()},t.prototype.setServerSideSelectionState=function(t){i(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(t)},t.prototype.selectAllOnCurrentPage=function(t){void 0===t&&(t="apiSelectAllCurrentPage"),this.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},t.prototype.deselectAllOnCurrentPage=function(t){void 0===t&&(t="apiSelectAllCurrentPage"),this.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},t.prototype.sizeColumnsToFit=function(t){this.gridBodyCtrl.sizeColumnsToFit(t)},t.prototype.showLoadingOverlay=function(){this.overlayWrapperComp.showLoadingOverlay()},t.prototype.showNoRowsOverlay=function(){this.overlayWrapperComp.showNoRowsOverlay()},t.prototype.hideOverlay=function(){this.overlayWrapperComp.hideOverlay()},t.prototype.getSelectedNodes=function(){return this.selectionService.getSelectedNodes()},t.prototype.getSelectedRows=function(){return this.selectionService.getSelectedRows()},t.prototype.getBestCostNodeSelection=function(){if(!i(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")},t.prototype.getRenderedNodes=function(){return this.rowRenderer.getRenderedNodes()},t.prototype.ensureColumnVisible=function(t,e){void 0===e&&(e="auto"),this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(t,e)},t.prototype.ensureIndexVisible=function(t,e){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t,e)},t.prototype.ensureNodeVisible=function(t,e){void 0===e&&(e=null),this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(t,e)},t.prototype.forEachLeafNode=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(t)},t.prototype.forEachNode=function(t,e){this.rowModel.forEachNode(t,e)},t.prototype.forEachNodeAfterFilter=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(t)},t.prototype.forEachNodeAfterFilterAndSort=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(t)},t.prototype.getFilterInstance=function(t,e){return this.filterManager.getFilterInstance(t,e)},t.prototype.destroyFilter=function(t){var e=this.columnModel.getPrimaryColumn(t);if(e)return this.filterManager.destroyFilter(e,"api")},t.prototype.getStatusPanel=function(t){if(W.__assertRegistered(z.StatusBarModule,"api.getStatusPanel",this.context.getGridId()))return ol(this.statusBarService.getStatusPanel(t))},t.prototype.getColumnDef=function(t){var e=this.columnModel.getPrimaryColumn(t);return e?e.getColDef():null},t.prototype.getColumnDefs=function(){return this.columnModel.getColumnDefs()},t.prototype.onFilterChanged=function(t){void 0===t&&(t="api"),this.filterManager.onFilterChanged({source:t})},t.prototype.onSortChanged=function(){this.sortController.onSortChanged("api")},t.prototype.setFilterModel=function(t){this.filterManager.setFilterModel(t)},t.prototype.getFilterModel=function(){return this.filterManager.getFilterModel()},t.prototype.getFocusedCell=function(){return this.focusService.getFocusedCell()},t.prototype.clearFocusedCell=function(){return this.focusService.clearFocusedCell()},t.prototype.setFocusedCell=function(t,e,n){this.focusService.setFocusedCell({rowIndex:t,column:e,rowPinned:n,forceBrowserFocus:!0})},t.prototype.setSuppressRowDrag=function(t){this.gos.set("suppressRowDrag",t)},t.prototype.setSuppressMoveWhenRowDragging=function(t){this.gos.set("suppressMoveWhenRowDragging",t)},t.prototype.setSuppressRowClickSelection=function(t){this.gos.set("suppressRowClickSelection",t)},t.prototype.addRowDropZone=function(t){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(t)},t.prototype.removeRowDropZone=function(t){var e=this.dragAndDropService.findExternalZone(t);e&&this.dragAndDropService.removeDropTarget(e)},t.prototype.getRowDropZoneParams=function(t){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(t)},t.prototype.setHeaderHeight=function(t){this.gos.set("headerHeight",t)},t.prototype.setDomLayout=function(t){this.gos.set("domLayout",t)},t.prototype.setEnableCellTextSelection=function(t){this.gridBodyCtrl.setCellTextSelection(t)},t.prototype.setFillHandleDirection=function(t){this.gos.set("fillHandleDirection",t)},t.prototype.setGroupHeaderHeight=function(t){this.gos.set("groupHeaderHeight",t)},t.prototype.setFloatingFiltersHeight=function(t){this.gos.set("floatingFiltersHeight",t)},t.prototype.setPivotHeaderHeight=function(t){this.gos.set("pivotHeaderHeight",t)},t.prototype.setPivotGroupHeaderHeight=function(t){this.gos.set("pivotGroupHeaderHeight",t)},t.prototype.setPivotMode=function(t){this.columnModel.setPivotMode(t)},t.prototype.setAnimateRows=function(t){this.gos.set("animateRows",t)},t.prototype.setIsExternalFilterPresent=function(t){this.gos.set("isExternalFilterPresent",t)},t.prototype.setDoesExternalFilterPass=function(t){this.gos.set("doesExternalFilterPass",t)},t.prototype.setNavigateToNextCell=function(t){this.gos.set("navigateToNextCell",t)},t.prototype.setTabToNextCell=function(t){this.gos.set("tabToNextCell",t)},t.prototype.setTabToNextHeader=function(t){this.gos.set("tabToNextHeader",t)},t.prototype.setNavigateToNextHeader=function(t){this.gos.set("navigateToNextHeader",t)},t.prototype.setRowGroupPanelShow=function(t){this.gos.set("rowGroupPanelShow",t)},t.prototype.setGetGroupRowAgg=function(t){this.gos.set("getGroupRowAgg",t)},t.prototype.setGetBusinessKeyForNode=function(t){this.gos.set("getBusinessKeyForNode",t)},t.prototype.setGetChildCount=function(t){this.gos.set("getChildCount",t)},t.prototype.setProcessRowPostCreate=function(t){this.gos.set("processRowPostCreate",t)},t.prototype.setGetRowId=function(t){this.gos.set("getRowId",t)},t.prototype.setGetRowClass=function(t){this.gos.set("getRowClass",t)},t.prototype.setIsFullWidthRow=function(t){this.gos.set("isFullWidthRow",t)},t.prototype.setIsRowSelectable=function(t){this.gos.set("isRowSelectable",t)},t.prototype.setIsRowMaster=function(t){this.gos.set("isRowMaster",t)},t.prototype.setPostSortRows=function(t){this.gos.set("postSortRows",t)},t.prototype.setGetDocument=function(t){this.gos.set("getDocument",t)},t.prototype.setGetContextMenuItems=function(t){this.gos.set("getContextMenuItems",t)},t.prototype.setGetMainMenuItems=function(t){this.gos.set("getMainMenuItems",t)},t.prototype.setProcessCellForClipboard=function(t){this.gos.set("processCellForClipboard",t)},t.prototype.setSendToClipboard=function(t){this.gos.set("sendToClipboard",t)},t.prototype.setProcessCellFromClipboard=function(t){this.gos.set("processCellFromClipboard",t)},t.prototype.setProcessSecondaryColDef=function(t){Ee("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(t)},t.prototype.setProcessSecondaryColGroupDef=function(t){Ee("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(t)},t.prototype.setProcessPivotResultColDef=function(t){this.gos.set("processPivotResultColDef",t)},t.prototype.setProcessPivotResultColGroupDef=function(t){this.gos.set("processPivotResultColGroupDef",t)},t.prototype.setPostProcessPopup=function(t){this.gos.set("postProcessPopup",t)},t.prototype.setInitialGroupOrderComparator=function(t){this.gos.set("initialGroupOrderComparator",t)},t.prototype.setGetChartToolbarItems=function(t){this.gos.set("getChartToolbarItems",t)},t.prototype.setPaginationNumberFormatter=function(t){this.gos.set("paginationNumberFormatter",t)},t.prototype.setGetServerSideStoreParams=function(t){Ee("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(t)},t.prototype.setGetServerSideGroupLevelParams=function(t){this.gos.set("getServerSideGroupLevelParams",t)},t.prototype.setIsServerSideGroupOpenByDefault=function(t){this.gos.set("isServerSideGroupOpenByDefault",t)},t.prototype.setIsApplyServerSideTransaction=function(t){this.gos.set("isApplyServerSideTransaction",t)},t.prototype.setIsServerSideGroup=function(t){this.gos.set("isServerSideGroup",t)},t.prototype.setGetServerSideGroupKey=function(t){this.gos.set("getServerSideGroupKey",t)},t.prototype.setGetRowStyle=function(t){this.gos.set("getRowStyle",t)},t.prototype.setGetRowHeight=function(t){this.gos.set("getRowHeight",t)},t.prototype.assertSideBarLoaded=function(t){return W.__assertRegistered(z.SideBarModule,"api."+t,this.context.getGridId())},t.prototype.isSideBarVisible=function(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()},t.prototype.setSideBarVisible=function(t){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(t)},t.prototype.setSideBarPosition=function(t){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(t)},t.prototype.openToolPanel=function(t){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(t,"api")},t.prototype.closeToolPanel=function(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")},t.prototype.getOpenedToolPanel=function(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null},t.prototype.refreshToolPanel=function(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()},t.prototype.isToolPanelShowing=function(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()},t.prototype.getToolPanelInstance=function(t){if(this.assertSideBarLoaded("getToolPanelInstance"))return ol(this.sideBarComp.getToolPanelInstance(t))},t.prototype.getSideBar=function(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()},t.prototype.setSideBar=function(t){this.gos.set("sideBar",t)},t.prototype.setSuppressClipboardPaste=function(t){this.gos.set("suppressClipboardPaste",t)},t.prototype.resetRowHeights=function(){if(o(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}},t.prototype.setGroupRemoveSingleChildren=function(t){this.gos.set("groupRemoveSingleChildren",t)},t.prototype.setGroupRemoveLowestSingleChildren=function(t){this.gos.set("groupRemoveLowestSingleChildren",t)},t.prototype.setGroupDisplayType=function(t){this.gos.set("groupDisplayType",t)},t.prototype.setRowClass=function(t){this.gos.set("rowClass",t)},t.prototype.setDeltaSort=function(t){this.gos.set("deltaSort",t)},t.prototype.setRowCount=function(t,e){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(t,e):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(t,e):this.logMissingRowModel("setRowCount","infinite","serverSide")},t.prototype.onRowHeightChanged=function(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()},t.prototype.getValue=function(t,e){var n=this.columnModel.getPrimaryColumn(t);return i(n)&&(n=this.columnModel.getGridColumn(t)),i(n)?null:this.valueService.getValue(n,e)},t.prototype.addEventListener=function(t,e){var n=this.gos.useAsyncEvents();this.eventService.addEventListener(t,e,n)},t.prototype.addGlobalListener=function(t){var e=this.gos.useAsyncEvents();this.eventService.addGlobalListener(t,e)},t.prototype.removeEventListener=function(t,e){var n=this.gos.useAsyncEvents();this.eventService.removeEventListener(t,e,n)},t.prototype.removeGlobalListener=function(t){var e=this.gos.useAsyncEvents();this.eventService.removeGlobalListener(t,e)},t.prototype.dispatchEvent=function(t){this.eventService.dispatchEvent(t)},t.prototype.destroy=function(){if(!this.destroyCalled){this.destroyCalled=!0;var t=this.ctrlsService.getGridCtrl();t&&t.destroyGridUi(),this.context.destroy()}},t.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(S.bind(window,this,"Grid API"),100)},t.prototype.warnIfDestroyed=function(t){return this.destroyCalled&&console.warn("AG Grid: Grid API method "+t+" was called on a grid that was destroyed."),this.destroyCalled},t.prototype.resetQuickFilter=function(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()},t.prototype.getCellRanges=function(){return this.rangeService?this.rangeService.getCellRanges():(W.__assertRegistered(z.RangeSelectionModule,"api.getCellRanges",this.context.getGridId()),null)},t.prototype.addCellRange=function(t){this.rangeService?this.rangeService.addCellRange(t):W.__assertRegistered(z.RangeSelectionModule,"api.addCellRange",this.context.getGridId())},t.prototype.clearRangeSelection=function(){this.rangeService&&this.rangeService.removeAllCellRanges(),W.__assertRegistered(z.RangeSelectionModule,"gridApi.clearRangeSelection",this.context.getGridId())},t.prototype.undoCellEditing=function(){this.undoRedoService.undo("api")},t.prototype.redoCellEditing=function(){this.undoRedoService.redo("api")},t.prototype.getCurrentUndoSize=function(){return this.undoRedoService.getCurrentUndoStackSize()},t.prototype.getCurrentRedoSize=function(){return this.undoRedoService.getCurrentRedoStackSize()},t.prototype.getChartModels=function(){if(W.__assertRegistered(z.GridChartsModule,"api.getChartModels",this.context.getGridId()))return this.chartService.getChartModels()},t.prototype.getChartRef=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.getChartRef",this.context.getGridId()))return this.chartService.getChartRef(t)},t.prototype.getChartImageDataURL=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.getChartImageDataURL",this.context.getGridId()))return this.chartService.getChartImageDataURL(t)},t.prototype.downloadChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.downloadChart",this.context.getGridId()))return this.chartService.downloadChart(t)},t.prototype.openChartToolPanel=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.openChartToolPanel",this.context.getGridId()))return this.chartService.openChartToolPanel(t)},t.prototype.closeChartToolPanel=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.closeChartToolPanel",this.context.getGridId()))return this.chartService.closeChartToolPanel(t.chartId)},t.prototype.createRangeChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.createRangeChart",this.context.getGridId()))return this.chartService.createRangeChart(t)},t.prototype.createPivotChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.createPivotChart",this.context.getGridId()))return this.chartService.createPivotChart(t)},t.prototype.createCrossFilterChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.createCrossFilterChart",this.context.getGridId()))return this.chartService.createCrossFilterChart(t)},t.prototype.updateChart=function(t){W.__assertRegistered(z.GridChartsModule,"api.updateChart",this.context.getGridId())&&this.chartService.updateChart(t)},t.prototype.restoreChart=function(t,e){if(W.__assertRegistered(z.GridChartsModule,"api.restoreChart",this.context.getGridId()))return this.chartService.restoreChart(t,e)},t.prototype.copyToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.copyToClipboard",this.context.getGridId())&&this.clipboardService.copyToClipboard(t)},t.prototype.cutToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.cutToClipboard",this.context.getGridId())&&this.clipboardService.cutToClipboard(t,"api")},t.prototype.copySelectedRowsToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.copySelectedRowsToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRowsToClipboard(t)},t.prototype.copySelectedRangeToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.copySelectedRangeToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRangeToClipboard(t)},t.prototype.copySelectedRangeDown=function(){W.__assertRegistered(z.ClipboardModule,"api.copySelectedRangeDown",this.context.getGridId())&&this.clipboardService.copyRangeDown()},t.prototype.pasteFromClipboard=function(){W.__assertRegistered(z.ClipboardModule,"api.pasteFromClipboard",this.context.getGridId())&&this.clipboardService.pasteFromClipboard()},t.prototype.showColumnMenuAfterButtonClick=function(t,e){var n=this.columnModel.getGridColumn(t);this.menuFactory.showMenuAfterButtonClick(n,e,"columnMenu")},t.prototype.showColumnMenuAfterMouseClick=function(t,e){var n=this.columnModel.getGridColumn(t);n||(n=this.columnModel.getPrimaryColumn(t)),n?this.menuFactory.showMenuAfterMouseEvent(n,e):console.error("AG Grid: column '"+t+"' not found")},t.prototype.hidePopupMenu=function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()},t.prototype.setPopupParent=function(t){this.gos.set("popupParent",t)},t.prototype.tabToNextCell=function(t){return this.navigationService.tabToNextCell(!1,t)},t.prototype.tabToPreviousCell=function(t){return this.navigationService.tabToNextCell(!0,t)},t.prototype.getCellRendererInstances=function(t){return void 0===t&&(t={}),this.rowRenderer.getCellRendererInstances(t).map(ol)},t.prototype.getCellEditorInstances=function(t){return void 0===t&&(t={}),this.rowRenderer.getCellEditorInstances(t).map(ol)},t.prototype.getEditingCells=function(){return this.rowRenderer.getEditingCells()},t.prototype.stopEditing=function(t){void 0===t&&(t=!1),this.rowRenderer.stopEditing(t)},t.prototype.startEditingCell=function(t){var e=this.columnModel.getGridColumn(t.colKey);if(e){var n={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:e};null==t.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t.rowIndex);var r=this.navigationService.getCellByPosition(n);r&&(this.focusService.isCellFocused(n)||this.focusService.setFocusedCell(n),r.startRowOrCellEdit(t.key))}else console.warn("AG Grid: no column found for "+t.colKey)},t.prototype.addAggFunc=function(t,e){this.aggFuncService&&this.aggFuncService.addAggFunc(t,e)},t.prototype.addAggFuncs=function(t){this.aggFuncService&&this.aggFuncService.addAggFuncs(t)},t.prototype.clearAggFuncs=function(){this.aggFuncService&&this.aggFuncService.clear()},t.prototype.applyServerSideTransaction=function(t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(t);this.logMissingRowModel("applyServerSideTransaction","serverSide")},t.prototype.applyServerSideTransactionAsync=function(t,e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(t,e);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")},t.prototype.retryServerSideLoads=function(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")},t.prototype.flushServerSideAsyncTransactions=function(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")},t.prototype.applyTransaction=function(t){if(this.clientSideRowModel)return this.clientSideRowModel.updateRowData(t);this.logMissingRowModel("applyTransaction","clientSide")},t.prototype.applyTransactionAsync=function(t,e){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(t,e):this.logMissingRowModel("applyTransactionAsync","clientSide")},t.prototype.flushAsyncTransactions=function(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")},t.prototype.setSuppressModelUpdateAfterUpdateTransaction=function(t){this.gos.set("suppressModelUpdateAfterUpdateTransaction",t)},t.prototype.refreshInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")},t.prototype.purgeInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")},t.prototype.refreshServerSide=function(t){this.serverSideRowModel?this.serverSideRowModel.refreshStore(t):this.logMissingRowModel("refreshServerSide","serverSide")},t.prototype.refreshServerSideStore=function(t){return Ee("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(t)},t.prototype.getServerSideStoreState=function(){return Ee("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()},t.prototype.getServerSideGroupLevelState=function(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])},t.prototype.getInfiniteRowCount=function(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")},t.prototype.isLastRowIndexKnown=function(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")},t.prototype.getCacheBlockState=function(){return this.rowNodeBlockLoader.getBlockState()},t.prototype.getFirstDisplayedRow=function(){return this.rowRenderer.getFirstVirtualRenderedRow()},t.prototype.getLastDisplayedRow=function(){return this.rowRenderer.getLastVirtualRenderedRow()},t.prototype.getDisplayedRowAtIndex=function(t){return this.rowModel.getRow(t)},t.prototype.getDisplayedRowCount=function(){return this.rowModel.getRowCount()},t.prototype.setDataTypeDefinitions=function(t){this.gos.set("dataTypeDefinitions",t)},t.prototype.setPagination=function(t){this.gos.set("pagination",t)},t.prototype.paginationIsLastPageFound=function(){return this.paginationProxy.isLastPageFound()},t.prototype.paginationGetPageSize=function(){return this.paginationProxy.getPageSize()},t.prototype.paginationSetPageSize=function(t){this.gos.set("paginationPageSize",t)},t.prototype.paginationGetCurrentPage=function(){return this.paginationProxy.getCurrentPage()},t.prototype.paginationGetTotalPages=function(){return this.paginationProxy.getTotalPages()},t.prototype.paginationGetRowCount=function(){return this.paginationProxy.getMasterRowCount()},t.prototype.paginationGoToNextPage=function(){this.paginationProxy.goToNextPage()},t.prototype.paginationGoToPreviousPage=function(){this.paginationProxy.goToPreviousPage()},t.prototype.paginationGoToFirstPage=function(){this.paginationProxy.goToFirstPage()},t.prototype.paginationGoToLastPage=function(){this.paginationProxy.goToLastPage()},t.prototype.paginationGoToPage=function(t){this.paginationProxy.goToPage(t)},rl([tt("immutableService")],t.prototype,"immutableService",void 0),rl([tt("csvCreator")],t.prototype,"csvCreator",void 0),rl([tt("excelCreator")],t.prototype,"excelCreator",void 0),rl([$("rowRenderer")],t.prototype,"rowRenderer",void 0),rl([$("navigationService")],t.prototype,"navigationService",void 0),rl([$("filterManager")],t.prototype,"filterManager",void 0),rl([$("columnModel")],t.prototype,"columnModel",void 0),rl([$("selectionService")],t.prototype,"selectionService",void 0),rl([$("gridOptionsService")],t.prototype,"gos",void 0),rl([$("valueService")],t.prototype,"valueService",void 0),rl([$("alignedGridsService")],t.prototype,"alignedGridsService",void 0),rl([$("eventService")],t.prototype,"eventService",void 0),rl([$("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),rl([$("context")],t.prototype,"context",void 0),rl([$("rowModel")],t.prototype,"rowModel",void 0),rl([$("sortController")],t.prototype,"sortController",void 0),rl([$("paginationProxy")],t.prototype,"paginationProxy",void 0),rl([$("focusService")],t.prototype,"focusService",void 0),rl([$("dragAndDropService")],t.prototype,"dragAndDropService",void 0),rl([tt("rangeService")],t.prototype,"rangeService",void 0),rl([tt("clipboardService")],t.prototype,"clipboardService",void 0),rl([tt("aggFuncService")],t.prototype,"aggFuncService",void 0),rl([$("menuFactory")],t.prototype,"menuFactory",void 0),rl([tt("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),rl([$("valueCache")],t.prototype,"valueCache",void 0),rl([$("animationFrameService")],t.prototype,"animationFrameService",void 0),rl([tt("statusBarService")],t.prototype,"statusBarService",void 0),rl([tt("chartService")],t.prototype,"chartService",void 0),rl([tt("undoRedoService")],t.prototype,"undoRedoService",void 0),rl([tt("rowNodeBlockLoader")],t.prototype,"rowNodeBlockLoader",void 0),rl([tt("ssrmTransactionManager")],t.prototype,"serverSideTransactionManager",void 0),rl([$("ctrlsService")],t.prototype,"ctrlsService",void 0),rl([Z],t.prototype,"init",null),rl([Q],t.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),t=rl([J("gridApi")],t)}(),al=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ll=function(){return(ll=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ul=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},cl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allColumnFilters=new Map,e.allColumnListeners=new Map,e.activeAggregateFilters=[],e.activeColumnFilters=[],e.quickFilter=null,e.quickFilterParts=null,e.processingFilterChange=!1,e.filterModelUpdateQueue=[],e}var n;return al(e,t),n=e,e.prototype.init=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_GRID_COLUMNS_CHANGED,(function(){return t.onColumnsChanged()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VALUE_CHANGED,(function(){return t.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_CHANGED,(function(){return t.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(){t.refreshFiltersForAggregations(),t.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,(function(){t.resetQuickFilterCache(),t.updateAdvancedFilterColumns()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return t.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VISIBLE,(function(){t.gridOptionsService.is("includeHiddenColumnsInQuickFilter")||t.resetQuickFilterCache(),t.updateAdvancedFilterColumns()})),this.addManagedPropertyListener("quickFilterText",(function(e){return t.setQuickFilter(e.currentValue)})),this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter",(function(){return t.onIncludeHiddenColumnsInQuickFilterChanged()})),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",(function(){return t.updateAggFiltering()})),this.addManagedPropertyListener("advancedFilterModel",(function(e){return t.setAdvancedFilterModel(e.currentValue)})),this.addManagedListener(this.eventService,Yt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,(function(e){var n=e.enabled;return t.onAdvancedFilterEnabledChanged(n)})),this.addManagedListener(this.eventService,Yt.EVENT_DATA_TYPES_INFERRED,(function(){return t.processFilterModelUpdateQueue()}))},e.prototype.isExternalFilterPresentCallback=function(){var t=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"===typeof t&&t({})},e.prototype.doesExternalFilterPass=function(t){var e=this.gridOptionsService.get("doesExternalFilterPass");return"function"===typeof e&&e(t)},e.prototype.setQuickFilterParts=function(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null},e.prototype.setFilterModel=function(t){var e=this;if(this.isAdvancedFilterEnabled())this.warnAdvancedFilters();else if(this.dataTypeService.isPendingInference())this.filterModelUpdateQueue.push(t);else{var n=[],r=this.getFilterModel();if(t){var o=io(Object.keys(t));this.allColumnFilters.forEach((function(r,i){var s=t[i];n.push(e.setModelOnFilterWrapper(r.filterPromise,s)),o.delete(i)})),o.forEach((function(r){var o=e.columnModel.getPrimaryColumn(r)||e.columnModel.getGridColumn(r);if(o)if(o.isFilterAllowed()){var i=e.getOrCreateFilterWrapper(o,"NO_UI");i?n.push(e.setModelOnFilterWrapper(i.filterPromise,t[r])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+r)}else console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+r);else console.warn("AG Grid: setFilterModel() - no column found for colId: "+r)}))}else this.allColumnFilters.forEach((function(t){n.push(e.setModelOnFilterWrapper(t.filterPromise,null))}));fo.all(n).then((function(){var t=e.getFilterModel(),n=[];e.allColumnFilters.forEach((function(e,o){var i=r?r[o]:null,s=t?t[o]:null;uo.jsonEquals(i,s)||n.push(e.column)})),n.length>0&&e.onFilterChanged({columns:n,source:"api"})}))}},e.prototype.setModelOnFilterWrapper=function(t,e){return new fo((function(n){t.then((function(t){"function"!==typeof t.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),n()),(t.setModel(e)||fo.resolve()).then((function(){return n()}))}))}))},e.prototype.getFilterModel=function(){var t={};return this.allColumnFilters.forEach((function(e,n){var r=e.filterPromise.resolveNow(null,(function(t){return t}));if(null==r)return null;if("function"===typeof r.getModel){var i=r.getModel();o(i)&&(t[n]=i)}else console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel")})),t},e.prototype.isColumnFilterPresent=function(){return this.activeColumnFilters.length>0},e.prototype.isAggregateFilterPresent=function(){return!!this.activeAggregateFilters.length},e.prototype.isExternalFilterPresent=function(){return this.externalFilterPresent},e.prototype.isChildFilterPresent=function(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()},e.prototype.isAdvancedFilterPresent=function(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()},e.prototype.onAdvancedFilterEnabledChanged=function(t){var e,n=this;t?this.allColumnFilters.size&&(this.allColumnFilters.forEach((function(t){return n.disposeFilterWrapper(t,"advancedFilterEnabled")})),this.onFilterChanged({source:"advancedFilter"})):(null===(e=this.advancedFilterService)||void 0===e?void 0:e.isFilterPresent())&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))},e.prototype.isAdvancedFilterEnabled=function(){var t;return null===(t=this.advancedFilterService)||void 0===t?void 0:t.isEnabled()},e.prototype.isAdvancedFilterHeaderActive=function(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()},e.prototype.doAggregateFiltersPass=function(t,e){return this.doColumnFiltersPass(t,e,!0)},e.prototype.updateActiveFilters=function(){var t=this;this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;var e=function(t){return!!t&&(t.isFilterActive?t.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1))},n=!!this.gridOptionsService.getGroupAggFiltering();this.allColumnFilters.forEach((function(r){if(r.filterPromise.resolveNow(!1,e)){var o=r.filterPromise.resolveNow(null,(function(t){return t}));!function(e){if(!e.isPrimary())return!0;var r=!t.columnModel.isPivotActive();return!(!e.isValueActive()||!r)&&(!!t.columnModel.isPivotMode()||n)}(r.column)?t.activeColumnFilters.push(o):t.activeAggregateFilters.push(o)}}))},e.prototype.updateFilterFlagInColumns=function(t,e){this.allColumnFilters.forEach((function(n){var r=n.filterPromise.resolveNow(!1,(function(t){return t.isFilterActive()}));n.column.setFilterActive(r,t,e)}))},e.prototype.isAnyFilterPresent=function(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()},e.prototype.doColumnFiltersPass=function(t,e,n){for(var r=t.data,o=t.aggData,i=n?this.activeAggregateFilters:this.activeColumnFilters,s=n?o:r,a=0;a<i.length;a++){var l=i[a];if(null!=l&&l!==e){if("function"!==typeof l.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:t,data:s}))return!1}}return!0},e.prototype.parseQuickFilter=function(t){return o(t)?this.gridOptionsService.isRowModelType("clientSide")?t.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null},e.prototype.setQuickFilter=function(t){if(null==t||"string"===typeof t){var e=this.parseQuickFilter(t);this.quickFilter!==e&&(this.quickFilter=e,this.setQuickFilterParts(),this.onFilterChanged({source:"quickFilter"}))}else console.warn("AG Grid - setQuickFilter() only supports string inputs, received: "+typeof t)},e.prototype.resetQuickFilterCache=function(){this.rowModel.forEachNode((function(t){return t.quickFilterAggregateText=null}))},e.prototype.onIncludeHiddenColumnsInQuickFilterChanged=function(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged({source:"quickFilter"})},e.prototype.refreshFiltersForAggregations=function(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()},e.prototype.callOnFilterChangedOutsideRenderCycle=function(t){var e=this,n=function(){return e.onFilterChanged(t)};this.rowRenderer.isRefreshInProgress()?setTimeout(n,0):n()},e.prototype.onFilterChanged=function(t){void 0===t&&(t={});var e=t.source,n=t.filterInstance,r=t.additionalEventAttributes,o=t.columns;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",r),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach((function(t){t.filterPromise&&t.filterPromise.then((function(t){t&&t!==n&&t.onAnyFilterChanged&&t.onAnyFilterChanged()}))}));var i={source:e,type:Yt.EVENT_FILTER_CHANGED,columns:o||[]};r&&x(i,r),this.processingFilterChange=!0,this.eventService.dispatchEvent(i),this.processingFilterChange=!1},e.prototype.isSuppressFlashingCellsBecauseFiltering=function(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange},e.prototype.isQuickFilterPresent=function(){return null!==this.quickFilter},e.prototype.updateAggFiltering=function(){this.aggFiltering=!!this.gridOptionsService.getGroupAggFiltering()},e.prototype.isAggregateQuickFilterPresent=function(){return this.isQuickFilterPresent()&&(this.aggFiltering||this.columnModel.isPivotMode())},e.prototype.isNonAggregateQuickFilterPresent=function(){return this.isQuickFilterPresent()&&!(this.aggFiltering||this.columnModel.isPivotMode())},e.prototype.doesRowPassOtherFilters=function(t,e){return this.doesRowPassFilter({rowNode:e,filterInstanceToSkip:t})},e.prototype.doesRowPassQuickFilterNoCache=function(t,e){var n=this;return this.columnModel.getAllColumnsForQuickFilter().some((function(r){var i=n.getQuickFilterTextForColumn(r,t);return o(i)&&i.indexOf(e)>=0}))},e.prototype.doesRowPassQuickFilterCache=function(t,e){return t.quickFilterAggregateText||this.aggregateRowForQuickFilter(t),t.quickFilterAggregateText.indexOf(e)>=0},e.prototype.doesRowPassQuickFilter=function(t){var e=this,n=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every((function(r){return n?e.doesRowPassQuickFilterCache(t,r):e.doesRowPassQuickFilterNoCache(t,r)}))},e.prototype.doesRowPassAggregateFilters=function(t){return!(this.isAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(t.rowNode))&&!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(t.rowNode,t.filterInstanceToSkip))},e.prototype.doesRowPassFilter=function(t){return!(this.isNonAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(t.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(t.rowNode))&&(!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(t.rowNode,t.filterInstanceToSkip))&&!(this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(t.rowNode))))},e.prototype.getQuickFilterTextForColumn=function(t,e){var n=this.valueService.getValue(t,e,!0),r=t.getColDef();if(r.getQuickFilterText){var i={value:n,node:e,data:e.data,column:t,colDef:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};n=r.getQuickFilterText(i)}return o(n)?n.toString().toUpperCase():null},e.prototype.aggregateRowForQuickFilter=function(t){var e=this,r=[];this.columnModel.getAllColumnsForQuickFilter().forEach((function(n){var i=e.getQuickFilterTextForColumn(n,t);o(i)&&r.push(i)})),t.quickFilterAggregateText=r.join(n.QUICK_FILTER_SEPARATOR)},e.prototype.onNewRowsLoaded=function(t){this.allColumnFilters.forEach((function(t){t.filterPromise.then((function(t){t.onNewRowsLoaded&&t.onNewRowsLoaded()}))})),this.updateFilterFlagInColumns(t,{afterDataChange:!0}),this.updateActiveFilters()},e.prototype.createValueGetter=function(t){var e=this;return function(n){var r=n.node;return e.valueService.getValue(t,r,!0)}},e.prototype.getFilterComponent=function(t,e,n){var r;if(void 0===n&&(n=!0),n)return(null===(r=this.getOrCreateFilterWrapper(t,e))||void 0===r?void 0:r.filterPromise)||null;var o=this.cachedFilter(t);return o?o.filterPromise:null},e.prototype.isFilterActive=function(t){var e=this.cachedFilter(t);return!!e&&e.filterPromise.resolveNow(!1,(function(t){return t.isFilterActive()}))},e.prototype.getOrCreateFilterWrapper=function(t,e){var n=this;if(!t.isFilterAllowed())return null;var r=this.cachedFilter(t);if(r)"NO_UI"!==e&&this.putIntoGui(r,e);else{r=this.createFilterWrapper(t,e);var o=t.getColId();this.allColumnFilters.set(o,r),this.allColumnListeners.set(o,this.addManagedListener(t,ht.EVENT_COL_DEF_CHANGED,(function(){return n.checkDestroyFilter(o)})))}return r},e.prototype.cachedFilter=function(t){return this.allColumnFilters.get(t.getColId())},e.prototype.getDefaultFilter=function(t){var e;if(W.__isRegistered(z.SetFilterModule,this.context.getGridId()))e="agSetColumnFilter";else{var n=t.getColDef().cellDataType;e="number"===n?"agNumberColumnFilter":"date"===n||"dateString"===n?"agDateColumnFilter":"agTextColumnFilter"}return e},e.prototype.getDefaultFloatingFilter=function(t){var e;if(W.__isRegistered(z.SetFilterModule,this.context.getGridId()))e="agSetColumnFloatingFilter";else{var n=t.getColDef().cellDataType;e="number"===n?"agNumberColumnFloatingFilter":"date"===n||"dateString"===n?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return e},e.prototype.createFilterInstance=function(t){var e,n=this,r=this.getDefaultFilter(t),o=t.getColDef(),i=ll(ll({},this.createFilterParams(t,o)),{filterModifiedCallback:function(){var r={type:Yt.EVENT_FILTER_MODIFIED,column:t,filterInstance:e};n.eventService.dispatchEvent(r)},filterChangedCallback:function(r){var o,i=null!==(o=null===r||void 0===r?void 0:r.source)&&void 0!==o?o:"api",s={filterInstance:e,additionalEventAttributes:r,columns:[t],source:i};n.callOnFilterChangedOutsideRenderCycle(s)},doesRowPassOtherFilter:function(t){return n.doesRowPassOtherFilters(e,t)}}),s=this.userComponentFactory.getFilterDetails(o,i,r);return s?{filterPromise:function(){var t=s.newAgStackInstance();return t&&t.then((function(t){return e=t})),t},compDetails:s}:{filterPromise:null,compDetails:null}},e.prototype.createFilterParams=function(t,e){return{column:t,colDef:m(e),rowModel:this.rowModel,filterChangedCallback:function(){},filterModifiedCallback:function(){},valueGetter:this.createValueGetter(t),doesRowPassOtherFilter:function(){return!0},api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},e.prototype.createFilterWrapper=function(t,e){var n,r={column:t,filterPromise:null,compiledElement:null,guiPromise:fo.resolve(null),compDetails:null},o=this.createFilterInstance(t),i=o.filterPromise,s=o.compDetails;return r.filterPromise=null!==(n=null===i||void 0===i?void 0:i())&&void 0!==n?n:null,r.compDetails=s,i&&this.putIntoGui(r,e),r},e.prototype.putIntoGui=function(t,e){var n=this,r=document.createElement("div");r.className="ag-filter",t.guiPromise=new fo((function(i){t.filterPromise.then((function(s){var a=s.getGui();o(a)||console.warn("AG Grid: getGui method from filter returned "+a+", it should be a DOM element or an HTML template string."),"string"===typeof a&&(a=Sr(a)),r.appendChild(a),i(r);var l={type:Yt.EVENT_FILTER_OPENED,column:t.column,source:e,eGui:r};n.eventService.dispatchEvent(l)}))}))},e.prototype.onColumnsChanged=function(){var t=this,e=[];this.allColumnFilters.forEach((function(n,r){(n.column.isPrimary()?t.columnModel.getPrimaryColumn(r):t.columnModel.getGridColumn(r))||(e.push(n.column),t.disposeFilterWrapper(n,"columnChanged"),t.disposeColumnListener(r))})),e.length>0?this.onFilterChanged({columns:e,source:"api"}):this.updateDependantFilters()},e.prototype.updateDependantFilters=function(){var t=this,e=this.columnModel.getGroupAutoColumns();null===e||void 0===e||e.forEach((function(e){"agGroupColumnFilter"===e.getColDef().filter&&t.getOrCreateFilterWrapper(e,"NO_UI")}))},e.prototype.isFilterAllowed=function(t){var e,n;if(this.isAdvancedFilterEnabled())return!1;if(!t.isFilterAllowed())return!1;var r=this.allColumnFilters.get(t.getColId());return null===(n=null===(e=null===r||void 0===r?void 0:r.filterPromise)||void 0===e?void 0:e.resolveNow(!0,(function(t){var e,n;return"function"!==typeof(null===(e=t)||void 0===e?void 0:e.isFilterAllowed)||(null===(n=t)||void 0===n?void 0:n.isFilterAllowed())})))||void 0===n||n},e.prototype.getFloatingFilterCompDetails=function(t,e){var n=this,r=t.getColDef(),o=this.createFilterParams(t,r),i=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(r,Va,o),s=this.userComponentFactory.getDefaultFloatingFilterType(r,(function(){return n.getDefaultFloatingFilter(t)}));null==s&&(s="agReadOnlyFloatingFilter");var a={column:t,filterParams:i,currentParentModel:function(){return n.getCurrentFloatingFilterParentModel(t)},parentFilterInstance:function(e){var r=n.getFilterComponent(t,"NO_UI");null!=r&&r.then((function(t){e(ol(t))}))},showParentFilter:e,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(r,a,s)},e.prototype.getCurrentFloatingFilterParentModel=function(t){var e=this.getFilterComponent(t,"NO_UI",!1);return e?e.resolveNow(null,(function(t){return t&&t.getModel()})):null},e.prototype.destroyFilter=function(t,e){void 0===e&&(e="api");var n=t.getColId(),r=this.allColumnFilters.get(n);this.disposeColumnListener(n),r&&(this.disposeFilterWrapper(r,e),this.onFilterChanged({columns:[t],source:"api"}))},e.prototype.disposeColumnListener=function(t){var e=this.allColumnListeners.get(t);e&&(this.allColumnListeners.delete(t),e())},e.prototype.disposeFilterWrapper=function(t,e){var n=this;t.filterPromise.then((function(r){(r.setModel(null)||fo.resolve()).then((function(){n.getContext().destroyBean(r),t.column.setFilterActive(!1,"filterDestroyed"),n.allColumnFilters.delete(t.column.getColId());var o={type:Yt.EVENT_FILTER_DESTROYED,source:e,column:t.column};n.eventService.dispatchEvent(o)}))}))},e.prototype.checkDestroyFilter=function(t){var e=this.allColumnFilters.get(t);if(e){var n=e.column,r=(n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null}).compDetails;this.areFilterCompsDifferent(e.compDetails,r)&&this.destroyFilter(n,"columnChanged")}},e.prototype.areFilterCompsDifferent=function(t,e){if(!e||!t)return!0;var n=t.componentClass,r=e.componentClass;return!(n===r||(null===n||void 0===n?void 0:n.render)&&(null===r||void 0===r?void 0:r.render)&&n.render===r.render)},e.prototype.getAdvancedFilterModel=function(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null},e.prototype.setAdvancedFilterModel=function(t){this.isAdvancedFilterEnabled()&&(this.advancedFilterService.setModel(t),this.onFilterChanged({source:"advancedFilter"}))},e.prototype.updateAdvancedFilterColumns=function(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})},e.prototype.hasFloatingFilters=function(){if(this.isAdvancedFilterEnabled())return!1;var t=this.columnModel.getAllGridColumns();return!!t&&t.some((function(t){return t.getColDef().floatingFilter}))},e.prototype.getFilterInstance=function(t,e){if(!this.isAdvancedFilterEnabled()){var n=this.getFilterInstanceImpl(t,(function(t){if(e){var n=ol(t);e(n)}}));return ol(n)}this.warnAdvancedFilters()},e.prototype.getFilterInstanceImpl=function(t,e){var n=this.columnModel.getPrimaryColumn(t);if(n){var r=this.getFilterComponent(n,"NO_UI"),o=r&&r.resolveNow(null,(function(t){return t}));return o?setTimeout(e,0,o):r&&r.then((function(t){e(t)})),o}},e.prototype.warnAdvancedFilters=function(){O((function(){console.warn("AG Grid: Column Filter API methods have been disabled as Advanced Filters are enabled.")}),"advancedFiltersCompatibility")},e.prototype.setupAdvancedFilterHeaderComp=function(t){var e;null===(e=this.advancedFilterService)||void 0===e||e.getCtrl().setupHeaderComp(t)},e.prototype.getHeaderRowCount=function(){return this.isAdvancedFilterHeaderActive()?1:0},e.prototype.getHeaderHeight=function(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0},e.prototype.processFilterModelUpdateQueue=function(){var t=this;this.filterModelUpdateQueue.forEach((function(e){return t.setFilterModel(e)})),this.filterModelUpdateQueue=[]},e.prototype.destroy=function(){var e=this;t.prototype.destroy.call(this),this.allColumnFilters.forEach((function(t){return e.disposeFilterWrapper(t,"gridDestroyed")})),this.allColumnListeners.clear()},e.QUICK_FILTER_SEPARATOR="\n",ul([$("valueService")],e.prototype,"valueService",void 0),ul([$("columnModel")],e.prototype,"columnModel",void 0),ul([$("rowModel")],e.prototype,"rowModel",void 0),ul([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),ul([$("rowRenderer")],e.prototype,"rowRenderer",void 0),ul([$("dataTypeService")],e.prototype,"dataTypeService",void 0),ul([tt("advancedFilterService")],e.prototype,"advancedFilterService",void 0),ul([Z],e.prototype,"init",null),e=n=ul([J("filterManager")],e)}(jt),pl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hl=function(t){function e(e,n){var r=t.call(this,e)||this;return r.ctrl=n,r}return pl(e,t),e.prototype.getCtrl=function(){return this.ctrl},e}(Eo),dl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fl=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gl=function(t){function e(n){return t.call(this,e.TEMPLATE,n)||this}return dl(e,t),e.prototype.postConstruct=function(){var t=this,e=this.getGui(),n={addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},addOrRemoveBodyCssClass:function(e,n){return t.eFloatingFilterBody.classList.toggle(e,n)},setButtonWrapperDisplayed:function(e){return ur(t.eButtonWrapper,e)},setCompDetails:function(e){return t.setCompDetails(e)},getFloatingFilterComp:function(){return t.compPromise},setWidth:function(t){return e.style.width=t},setMenuIcon:function(e){return t.eButtonShowMainFilter.appendChild(e)}};this.ctrl.setComp(n,e,this.eButtonShowMainFilter,this.eFloatingFilterBody)},e.prototype.setCompDetails=function(t){var e=this;if(!t)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=t.newAgStackInstance(),this.compPromise.then((function(t){return e.afterCompCreated(t)}))},e.prototype.destroyFloatingFilterComp=function(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))},e.prototype.afterCompCreated=function(t){t&&(this.isAlive()?(this.destroyFloatingFilterComp(),this.floatingFilterComp=t,this.eFloatingFilterBody.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached()):this.destroyBean(t))},e.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',fl([To("eFloatingFilterBody")],e.prototype,"eFloatingFilterBody",void 0),fl([To("eButtonWrapper")],e.prototype,"eButtonWrapper",void 0),fl([To("eButtonShowMainFilter")],e.prototype,"eButtonShowMainFilter",void 0),fl([Z],e.prototype,"postConstruct",null),fl([Q],e.prototype,"destroyFloatingFilterComp",null),e}(hl),ml=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yl=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.AUTO_HEIGHT="ag-layout-auto-height",t.NORMAL="ag-layout-normal",t.PRINT="ag-layout-print"}(il||(il={}));var vl,_l,wl=function(t){function e(e){var n=t.call(this)||this;return n.view=e,n}return ml(e,t),e.prototype.postConstruct=function(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()},e.prototype.updateLayoutClasses=function(){var t=this.getDomLayout(),e={autoHeight:"autoHeight"===t,normal:"normal"===t,print:"print"===t},n=e.autoHeight?il.AUTO_HEIGHT:e.print?il.PRINT:il.NORMAL;this.view.updateLayoutClasses(n,e)},e.prototype.getDomLayout=function(){var t,e=null!==(t=this.gridOptionsService.get("domLayout"))&&void 0!==t?t:"normal";return-1===["normal","print","autoHeight"].indexOf(e)?(O((function(){return console.warn("AG Grid: "+e+" is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.")}),"warn about dom layout values"),"normal"):e},yl([Z],e.prototype,"postConstruct",null),e}(jt),Cl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bl=function(){return(bl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},xl=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal"}(vl||(vl={})),function(t){t[t.Container=0]="Container",t[t.FakeContainer=1]="FakeContainer"}(_l||(_l={}));var El,Sl=function(t){function e(e){var n=t.call(this)||this;return n.lastScrollSource=[null,null],n.scrollLeft=-1,n.nextScrollTop=-1,n.scrollTop=-1,n.eBodyViewport=e,n.resetLastHScrollDebounced=k((function(){return n.lastScrollSource[vl.Horizontal]=null}),500),n.resetLastVScrollDebounced=k((function(){return n.lastScrollSource[vl.Vertical]=null}),500),n}return Cl(e,t),e.prototype.postConstruct=function(){var t=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady((function(e){t.centerRowContainerCtrl=e.centerRowContainerCtrl,t.onDisplayedColumnsWidthChanged(),t.addScrollListener()}))},e.prototype.addScrollListener=function(){var t=this.ctrlsService.getFakeHScrollComp(),e=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),t.onScrollCallback(this.onFakeHScroll.bind(this));var n=this.gridOptionsService.is("debounceVerticalScrollbar"),r=n?k(this.onVScroll.bind(this),100):this.onVScroll.bind(this),o=n?k(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",r),e.onScrollCallback(o)},e.prototype.onDisplayedColumnsWidthChanged=function(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()},e.prototype.horizontallyScrollHeaderCenterAndFloatingCenter=function(t){if(!(null==this.centerRowContainerCtrl)){void 0===t&&(t=this.centerRowContainerCtrl.getCenterViewportScrollLeft());var e=this.enableRtl?t:-t,n=this.ctrlsService.getTopCenterRowContainerCtrl(),r=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),o=this.ctrlsService.getBottomCenterRowContainerCtrl(),i=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-e),o.setContainerTranslateX(e),n.setContainerTranslateX(e),r.setContainerTranslateX(e);var s=this.centerRowContainerCtrl.getViewportElement(),a=this.lastScrollSource[vl.Horizontal]===_l.Container;t=Math.abs(t),a?i.setScrollPosition(t):Cr(s,t,this.enableRtl)}},e.prototype.isControllingScroll=function(t,e){return null==this.lastScrollSource[e]?(this.lastScrollSource[e]=t,!0):this.lastScrollSource[e]===t},e.prototype.onFakeHScroll=function(){this.isControllingScroll(_l.FakeContainer,vl.Horizontal)&&this.onHScrollCommon(_l.FakeContainer)},e.prototype.onHScroll=function(){this.isControllingScroll(_l.Container,vl.Horizontal)&&this.onHScrollCommon(_l.Container)},e.prototype.onHScrollCommon=function(t){var e,n=this.centerRowContainerCtrl.getViewportElement(),r=n.scrollLeft;this.shouldBlockScrollUpdate(vl.Horizontal,r,!0)||(e=t===_l.Container?wr(n,this.enableRtl):this.ctrlsService.getFakeHScrollComp().getScrollPosition(),this.doHorizontalScroll(Math.round(e)),this.resetLastHScrollDebounced())},e.prototype.onFakeVScroll=function(){this.isControllingScroll(_l.FakeContainer,vl.Vertical)&&this.onVScrollCommon(_l.FakeContainer)},e.prototype.onVScroll=function(){this.isControllingScroll(_l.Container,vl.Vertical)&&this.onVScrollCommon(_l.Container)},e.prototype.onVScrollCommon=function(t){var e;e=t===_l.Container?this.eBodyViewport.scrollTop:this.ctrlsService.getFakeVScrollComp().getScrollPosition(),this.shouldBlockScrollUpdate(vl.Vertical,e,!0)||(this.animationFrameService.setScrollTop(e),this.nextScrollTop=e,t===_l.Container?this.ctrlsService.getFakeVScrollComp().setScrollPosition(e):this.eBodyViewport.scrollTop=e,this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())},e.prototype.doHorizontalScroll=function(t){var e=this.ctrlsService.getFakeHScrollComp().getScrollPosition();this.scrollLeft===t&&t===e||(this.scrollLeft=t,this.fireScrollEvent(vl.Horizontal),this.horizontallyScrollHeaderCenterAndFloatingCenter(t),this.onHorizontalViewportChanged())},e.prototype.fireScrollEvent=function(t){var e=this,n={type:Yt.EVENT_BODY_SCROLL,direction:t===vl.Horizontal?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(n),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout((function(){var t=bl(bl({},n),{type:Yt.EVENT_BODY_SCROLL_END});e.eventService.dispatchEvent(t)}),100)},e.prototype.shouldBlockScrollUpdate=function(t,e,n){return void 0===n&&(n=!1),!(n&&!Gn())&&(t===vl.Vertical?this.shouldBlockVerticalScroll(e):this.shouldBlockHorizontalScroll(e))},e.prototype.shouldBlockVerticalScroll=function(t){var e=fr(this.eBodyViewport),n=this.eBodyViewport.scrollHeight;return t<0||t+e>n},e.prototype.shouldBlockHorizontalScroll=function(t){var e=this.centerRowContainerCtrl.getCenterWidth(),n=this.centerRowContainerCtrl.getViewportElement().scrollWidth;if(this.enableRtl&&_r()){if(t>0)return!0}else if(t<0)return!0;return Math.abs(t)+e>n},e.prototype.redrawRowsAfterScroll=function(){this.fireScrollEvent(vl.Vertical)},e.prototype.onHorizontalViewportChanged=function(){this.centerRowContainerCtrl.onHorizontalViewportChanged()},e.prototype.checkScrollLeft=function(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(_l.Container)},e.prototype.scrollGridIfNeeded=function(){var t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),t},e.prototype.setHorizontalScrollPosition=function(t,e){void 0===e&&(e=!1);var n=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();!e&&this.shouldBlockScrollUpdate(vl.Horizontal,t)&&(t=this.enableRtl&&_r()?t>0?0:n:Math.min(Math.max(t,0),n)),Cr(this.centerRowContainerCtrl.getViewportElement(),Math.abs(t),this.enableRtl),this.doHorizontalScroll(t)},e.prototype.setVerticalScrollPosition=function(t){this.eBodyViewport.scrollTop=t},e.prototype.getVScrollPosition=function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}},e.prototype.getHScrollPosition=function(){return this.centerRowContainerCtrl.getHScrollPosition()},e.prototype.isHorizontalScrollShowing=function(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()},e.prototype.scrollHorizontally=function(t){var e=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(e+t),this.centerRowContainerCtrl.getViewportElement().scrollLeft-e},e.prototype.scrollToTop=function(){this.eBodyViewport.scrollTop=0},e.prototype.ensureNodeVisible=function(t,e){void 0===e&&(e=null);for(var n=this.rowModel.getRowCount(),r=-1,o=0;o<n;o++){var i=this.rowModel.getRow(o);if("function"===typeof t){if(i&&t(i)){r=o;break}}else if(t===i||t===i.data){r=o;break}}r>=0&&this.ensureIndexVisible(r,e)},e.prototype.ensureIndexVisible=function(t,e){if(!this.gridOptionsService.isDomLayout("print")){var n=this.paginationProxy.getRowCount();if("number"!==typeof t||t<0||t>=n)console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+t);else{this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(t);var r,o=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),i=this.paginationProxy.getRow(t);do{var s=i.rowTop,a=i.rowHeight,l=this.paginationProxy.getPixelOffset(),u=i.rowTop-l,c=u+i.rowHeight,p=this.getVScrollPosition(),h=this.heightScaler.getDivStretchOffset(),d=p.top+h,f=p.bottom+h,g=f-d,m=this.heightScaler.getScrollPositionForPixel(u),y=this.heightScaler.getScrollPositionForPixel(c-g),v=Math.min((m+y)/2,u),_=null;"top"===e?_=m:"bottom"===e?_=y:"middle"===e?_=v:d+o>u?_=m-o:f<c&&(_=y),null!==_&&(this.setVerticalScrollPosition(_),this.rowRenderer.redraw({afterScroll:!0})),r=s!==i.rowTop||a!==i.rowHeight}while(r);this.animationFrameService.flushAllFrames()}}},e.prototype.ensureColumnVisible=function(t,e){void 0===e&&(e="auto");var n=this.columnModel.getGridColumn(t);if(n&&!n.isPinned()&&this.columnModel.isColumnDisplayed(n)){var r=this.getPositionedHorizontalScroll(n,e);null!==r&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(r),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}},e.prototype.getPositionedHorizontalScroll=function(t,e){var n=this.isColumnOutsideViewport(t),r=n.columnBeforeStart,o=n.columnAfterEnd,i=this.centerRowContainerCtrl.getCenterWidth()<t.getActualWidth(),s=this.centerRowContainerCtrl.getCenterWidth(),a=this.enableRtl,l=(a?r:o)||i,u=a?o:r;"auto"!==e&&(l="start"===e,u="end"===e);var c="middle"===e;if(l||u||c){var p=this.getColumnBounds(t),h=p.colLeft,d=p.colMiddle,f=p.colRight;return c?d-s/2:l?a?f:h:a?h-s:f-s}return null},e.prototype.isColumnOutsideViewport=function(t){var e=this.getViewportBounds(),n=e.start,r=e.end,o=this.getColumnBounds(t),i=o.colLeft,s=o.colRight,a=this.enableRtl;return{columnBeforeStart:a?n>s:r<s,columnAfterEnd:a?r<i:n>i}},e.prototype.getColumnBounds=function(t){var e=this.enableRtl,n=this.columnModel.getBodyContainerWidth(),r=t.getActualWidth(),o=t.getLeft(),i=e?-1:1,s=e?n-o:o;return{colLeft:s,colMiddle:s+r/2*i,colRight:s+r*i}},e.prototype.getViewportBounds=function(){var t=this.centerRowContainerCtrl.getCenterWidth(),e=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:e,end:t+e,width:t}},xl([$("ctrlsService")],e.prototype,"ctrlsService",void 0),xl([$("animationFrameService")],e.prototype,"animationFrameService",void 0),xl([$("paginationProxy")],e.prototype,"paginationProxy",void 0),xl([$("rowModel")],e.prototype,"rowModel",void 0),xl([$("rowContainerHeightService")],e.prototype,"heightScaler",void 0),xl([$("rowRenderer")],e.prototype,"rowRenderer",void 0),xl([$("columnModel")],e.prototype,"columnModel",void 0),xl([Z],e.prototype,"postConstruct",null),e}(jt),Tl=function(){function t(t){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=t.scrollContainer,this.scrollHorizontally=-1!==t.scrollAxis.indexOf("x"),this.scrollVertically=-1!==t.scrollAxis.indexOf("y"),this.scrollByTick=null!=t.scrollByTick?t.scrollByTick:20,t.onScrollCallback&&(this.onScrollCallback=t.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=t.getVerticalPosition,this.setVerticalPosition=t.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=t.getHorizontalPosition,this.setHorizontalPosition=t.setHorizontalPosition),this.shouldSkipVerticalScroll=t.shouldSkipVerticalScroll||function(){return!1},this.shouldSkipHorizontalScroll=t.shouldSkipHorizontalScroll||function(){return!1}}return t.prototype.check=function(t,e){void 0===e&&(e=!1);var n=e||this.shouldSkipVerticalScroll();if(!n||!this.shouldSkipHorizontalScroll()){var r=this.scrollContainer.getBoundingClientRect(),o=this.scrollByTick;this.tickLeft=t.clientX<r.left+o,this.tickRight=t.clientX>r.right-o,this.tickUp=t.clientY<r.top+o&&!n,this.tickDown=t.clientY>r.bottom-o&&!n,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}},t.prototype.ensureTickingStarted=function(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)},t.prototype.doTick=function(){var t;if(this.tickCount++,t=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){var e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){var n=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(n-t),this.tickRight&&this.setHorizontalPosition(n+t)}this.onScrollCallback&&this.onScrollCallback()},t.prototype.ensureCleared=function(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)},t}(),Rl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pl=function(){return(Pl=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ol=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Il=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Al=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Dl=function(t){function e(e){var n=t.call(this)||this;return n.isMultiRowDrag=!1,n.isGridSorted=!1,n.isGridFiltered=!1,n.isRowGroupActive=!1,n.eContainer=e,n}return Rl(e,t),e.prototype.postConstruct=function(){var t=this;this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);var e=function(){t.onSortChanged(),t.onFilterChanged(),t.onRowGroupChanged()};this.addManagedListener(this.eventService,Yt.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_MODEL_UPDATED,(function(){e()})),e(),this.ctrlsService.whenReady((function(){var e=t.ctrlsService.getGridBodyCtrl();t.autoScrollService=new Tl({scrollContainer:e.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:function(){return e.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(t){return e.getScrollFeature().setVerticalScrollPosition(t)},onScrollCallback:function(){t.onDragging(t.lastDraggingEvent)}})}))},e.prototype.onSortChanged=function(){this.isGridSorted=this.sortController.isSortActive()},e.prototype.onFilterChanged=function(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()},e.prototype.onRowGroupChanged=function(){var t=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!s(t)},e.prototype.getContainer=function(){return this.eContainer},e.prototype.isInterestedIn=function(t){return t===Gi.RowDrag},e.prototype.getIconName=function(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?zs.ICON_NOT_ALLOWED:zs.ICON_MOVE},e.prototype.shouldPreventRowMove=function(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive},e.prototype.getRowNodes=function(t){var e=this;if(!this.isFromThisGrid(t))return t.dragItem.rowNodes||[];var n=this.gridOptionsService.is("rowDragMultiRow"),r=Al([],Il(this.selectionService.getSelectedNodes())).sort((function(t,n){return null==t.rowIndex||null==n.rowIndex?0:e.getRowIndexNumber(t)-e.getRowIndexNumber(n)})),o=t.dragItem.rowNode;return n&&-1!==r.indexOf(o)?(this.isMultiRowDrag=!0,r):(this.isMultiRowDrag=!1,[o])},e.prototype.onDragEnter=function(t){t.dragItem.rowNodes=this.getRowNodes(t),this.dispatchGridEvent(Yt.EVENT_ROW_DRAG_ENTER,t),this.getRowNodes(t).forEach((function(t){t.setDragging(!0)})),this.onEnterOrDragging(t)},e.prototype.onDragging=function(t){this.onEnterOrDragging(t)},e.prototype.isFromThisGrid=function(t){return t.dragSource.dragSourceDomDataKey===this.gridOptionsService.getDomDataKey()},e.prototype.isDropZoneWithinThisGrid=function(t){var e=this.ctrlsService.getGridBodyCtrl().getGui(),n=t.dropZoneTarget;return!e.contains(n)},e.prototype.onEnterOrDragging=function(t){this.dispatchGridEvent(Yt.EVENT_ROW_DRAG_MOVE,t),this.lastDraggingEvent=t;var e=this.mouseEventService.getNormalisedPosition(t).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(t,e),this.autoScrollService.check(t.event)},e.prototype.doManagedDrag=function(t,e){var n=this.isFromThisGrid(t),r=this.gridOptionsService.is("rowDragManaged"),o=t.dragItem.rowNodes;r&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!n?this.isDropZoneWithinThisGrid(t)||this.clientSideRowModel.highlightRowAtPixel(o[0],e):this.moveRows(o,e))},e.prototype.getRowIndexNumber=function(t){return parseInt(yt(t.getRowIndexString().split("-")),10)},e.prototype.moveRowAndClearHighlight=function(t){var e=this,n=this.clientSideRowModel.getLastHighlightedRowNode(),r=n&&n.highlighted===Ja.Below,o=this.mouseEventService.getNormalisedPosition(t).y,i=t.dragItem.rowNodes,s=r?1:0;if(this.isFromThisGrid(t))i.forEach((function(t){t.rowTop<o&&(s-=1)})),this.moveRows(i,o,s);else{var a=this.gridOptionsService.getCallback("getRowId"),l=this.clientSideRowModel.getRowIndexAtPixel(o)+1;this.clientSideRowModel.getHighlightPosition(o)===Ja.Above&&l--,this.clientSideRowModel.updateRowData({add:i.map((function(t){return t.data})).filter((function(t){return!e.clientSideRowModel.getRowNode(a?a({data:t,level:0}):t.id)})),addIndex:l})}this.clearRowHighlight()},e.prototype.clearRowHighlight=function(){this.clientSideRowModel.highlightRowAtPixel(null)},e.prototype.moveRows=function(t,e,n){void 0===n&&(n=0),this.clientSideRowModel.ensureRowsAtPixel(t,e,n)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())},e.prototype.addRowDropZone=function(t){var e=this;if(t.getContainer())if(this.dragAndDropService.findExternalZone(t))console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");else{var n={getContainer:t.getContainer};t.fromGrid?(t.fromGrid=void 0,n=t):(t.onDragEnter&&(n.onDragEnter=function(n){t.onDragEnter(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_ENTER,n))}),t.onDragLeave&&(n.onDragLeave=function(n){t.onDragLeave(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_LEAVE,n))}),t.onDragging&&(n.onDragging=function(n){t.onDragging(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_MOVE,n))}),t.onDragStop&&(n.onDragStop=function(n){t.onDragStop(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_END,n))})),this.dragAndDropService.addDropTarget(Pl({isInterestedIn:function(t){return t===Gi.RowDrag},getIconName:function(){return zs.ICON_MOVE},external:!0},n))}else O((function(){return console.warn("AG Grid: addRowDropZone - A container target needs to be provided")}),"add-drop-zone-empty-target")},e.prototype.getRowDropZone=function(t){var e=this,n=this.getContainer.bind(this),r=this.onDragEnter.bind(this),o=this.onDragLeave.bind(this),i=this.onDragging.bind(this),s=this.onDragStop.bind(this);return t?{getContainer:n,onDragEnter:t.onDragEnter?function(n){r(n),t.onDragEnter(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_ENTER,n))}:r,onDragLeave:t.onDragLeave?function(n){o(n),t.onDragLeave(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_LEAVE,n))}:o,onDragging:t.onDragging?function(n){i(n),t.onDragging(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_MOVE,n))}:i,onDragStop:t.onDragStop?function(n){s(n),t.onDragStop(e.draggingToRowDragEvent(Yt.EVENT_ROW_DRAG_END,n))}:s,fromGrid:!0}:{getContainer:n,onDragEnter:r,onDragLeave:o,onDragging:i,onDragStop:s,fromGrid:!0}},e.prototype.draggingToRowDragEvent=function(t,e){var n,r,o=this.mouseEventService.getNormalisedPosition(e).y,i=-1;switch(o>this.paginationProxy.getCurrentPageHeight()||(i=this.rowModel.getRowIndexAtPixel(o),n=this.rowModel.getRow(i)),e.vDirection){case Bi.Down:r="down";break;case Bi.Up:r="up";break;default:r=null}return{type:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:e.event,node:e.dragItem.rowNode,nodes:e.dragItem.rowNodes,overIndex:i,overNode:n,y:o,vDirection:r}},e.prototype.dispatchGridEvent=function(t,e){var n=this.draggingToRowDragEvent(t,e);this.eventService.dispatchEvent(n)},e.prototype.onDragLeave=function(t){this.dispatchGridEvent(Yt.EVENT_ROW_DRAG_LEAVE,t),this.stopDragging(t),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(t)&&(this.isMultiRowDrag=!1)},e.prototype.onDragStop=function(t){this.dispatchGridEvent(Yt.EVENT_ROW_DRAG_END,t),this.stopDragging(t),!this.gridOptionsService.is("rowDragManaged")||!this.gridOptionsService.is("suppressMoveWhenRowDragging")&&this.isFromThisGrid(t)||this.isDropZoneWithinThisGrid(t)||this.moveRowAndClearHighlight(t)},e.prototype.stopDragging=function(t){this.autoScrollService.ensureCleared(),this.getRowNodes(t).forEach((function(t){t.setDragging(!1)}))},Ol([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Ol([$("rowModel")],e.prototype,"rowModel",void 0),Ol([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Ol([$("columnModel")],e.prototype,"columnModel",void 0),Ol([$("focusService")],e.prototype,"focusService",void 0),Ol([$("sortController")],e.prototype,"sortController",void 0),Ol([$("filterManager")],e.prototype,"filterManager",void 0),Ol([$("selectionService")],e.prototype,"selectionService",void 0),Ol([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Ol([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Ol([tt("rangeService")],e.prototype,"rangeService",void 0),Ol([Z],e.prototype,"postConstruct",null),e}(jt),Ml=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ll=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.ANIMATION_ON="ag-row-animation",t.ANIMATION_OFF="ag-row-no-animation"}(El||(El={}));var Nl,Fl,kl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stickyTopHeight=0,e}return Ml(e,t),e.prototype.getScrollFeature=function(){return this.bodyScrollFeature},e.prototype.getBodyViewportElement=function(){return this.eBodyViewport},e.prototype.setComp=function(t,e,n,r,o,i){this.comp=t,this.eGridBody=e,this.eBodyViewport=n,this.eTop=r,this.eBottom=o,this.eStickyTop=i,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new wl(this.comp)),this.bodyScrollFeature=this.createManagedBean(new Sl(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([r,n,o,i]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(r),this.ctrlsService.registerGridBodyCtrl(this)},e.prototype.getComp=function(){return this.comp},e.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Yt.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))},e.prototype.addFocusListeners=function(t){var e=this;t.forEach((function(t){e.addManagedListener(t,"focusin",(function(e){var n=hr(e.target,"ag-root",t);t.classList.toggle("ag-has-focus",!n)})),e.addManagedListener(t,"focusout",(function(e){var n=e.target,r=e.relatedTarget,o=t.contains(r),i=hr(r,"ag-root",t);hr(n,"ag-root",t)||o&&!i||t.classList.remove("ag-has-focus")}))}))},e.prototype.setColumnMovingCss=function(t){this.comp.setColumnMovingCss("ag-column-moving",t)},e.prototype.setCellTextSelection=function(t){void 0===t&&(t=!1),this.comp.setCellSelectableCss("ag-selectable",t)},e.prototype.onScrollVisibilityChanged=function(){var t=this,e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyTopWidth(e);var n="calc(100% + "+((e&&this.gridOptionsService.getScrollbarWidth()||0)+(qn()?16:0))+"px)";this.animationFrameService.requestAnimationFrame((function(){return t.comp.setBodyViewportWidth(n)}))},e.prototype.onGridColumnsChanged=function(){var t=this.columnModel.getAllGridColumns();this.comp.setColumnCount(t?t.length:0)},e.prototype.disableBrowserDragging=function(){this.addManagedListener(this.eGridBody,"dragstart",(function(t){if(t.target instanceof HTMLImageElement)return t.preventDefault(),!1}))},e.prototype.addStopEditingWhenGridLosesFocus=function(){var t=this;if(this.gridOptionsService.is("stopEditingWhenCellsLoseFocus")){var e=function(e){var r=e.relatedTarget;if(null!==Vn(r)){var o=n.some((function(t){return t.contains(r)}))&&t.mouseEventService.isElementInThisGrid(r);if(!o){var i=t.popupService;o=i.getActivePopups().some((function(t){return t.contains(r)}))||i.isElementWithinCustomPopup(r)}o||t.rowRenderer.stopEditing()}else t.rowRenderer.stopEditing()},n=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];n.forEach((function(n){return t.addManagedListener(n,"focusout",e)}))}},e.prototype.updateRowCount=function(){var t=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),e=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,n=-1===e?-1:t+e;this.comp.setRowCount(n)},e.prototype.registerBodyViewportResizeListener=function(t){this.comp.registerBodyViewportResizeListener(t)},e.prototype.setVerticalScrollPaddingVisible=function(t){var e=t?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(e)},e.prototype.isVerticalScrollShowing=function(){var t=this.gridOptionsService.is("alwaysShowVerticalScroll"),e=t?"ag-force-vertical-scroll":null,n=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(e,t),t||n&&Mr(this.eBodyViewport)},e.prototype.setupRowAnimationCssClass=function(){var t=this,e=function(){var e=t.gridOptionsService.isAnimateRows()&&!t.rowContainerHeightService.isStretching(),n=e?El.ANIMATION_ON:El.ANIMATION_OFF;t.comp.setRowAnimationCssOnBodyViewport(n,e)};e(),this.addManagedListener(this.eventService,Yt.EVENT_HEIGHT_SCALE_CHANGED,e),this.addManagedPropertyListener("animateRows",e)},e.prototype.getGridBodyElement=function(){return this.eGridBody},e.prototype.addBodyViewportListener=function(){var t=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",t),this.mockContextMenuForIPad(t),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()},e.prototype.addFullWidthContainerWheelListener=function(){var t=this,e=this.eBodyViewport.querySelector(".ag-full-width-container"),n=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&n&&this.addManagedListener(e,"wheel",(function(e){return t.onFullWidthContainerWheel(e,n)}))},e.prototype.onFullWidthContainerWheel=function(t,e){!t.deltaX||Math.abs(t.deltaY)>Math.abs(t.deltaX)||!this.mouseEventService.isEventFromThisGrid(t)||(t.preventDefault(),e.scrollBy({left:t.deltaX}))},e.prototype.onBodyViewportContextMenu=function(t,e,n){if(t||n){if(this.gridOptionsService.is("preventDefaultOnContextMenu"))(t||n).preventDefault();var r=(t||e).target;if(r===this.eBodyViewport||r===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;t?this.contextMenuFactory.onContextMenu(t,null,null,null,null,this.eGridBody):n&&this.contextMenuFactory.onContextMenu(null,n,null,null,null,this.eGridBody)}}},e.prototype.mockContextMenuForIPad=function(t){if(Gn()){var e=new es(this.eBodyViewport);this.addManagedListener(e,es.EVENT_LONG_TAP,(function(e){t(void 0,e.touchStart,e.touchEvent)})),this.addDestroyFunc((function(){return e.destroy()}))}},e.prototype.onBodyViewportWheel=function(t){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&t.preventDefault()},e.prototype.onStickyTopWheel=function(t){t.preventDefault(),t.offsetY&&this.scrollVertically(t.deltaY)},e.prototype.getGui=function(){return this.eGridBody},e.prototype.scrollVertically=function(t){var e=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(e+t),this.eBodyViewport.scrollTop-e},e.prototype.addRowDragListener=function(){this.rowDragFeature=this.createManagedBean(new Dl(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)},e.prototype.getRowDragFeature=function(){return this.rowDragFeature},e.prototype.onPinnedRowDataChanged=function(){this.setFloatingHeights()},e.prototype.setFloatingHeights=function(){var t=this.pinnedRowModel,e=t.getPinnedTopTotalHeight();e&&(e+=1);var n=t.getPinnedBottomTotalHeight();n&&(n+=1),this.comp.setTopHeight(e),this.comp.setBottomHeight(n),this.comp.setTopDisplay(e?"inherit":"none"),this.comp.setBottomDisplay(n?"inherit":"none"),this.setStickyTopOffsetTop()},e.prototype.setStickyTopHeight=function(t){void 0===t&&(t=0),this.comp.setStickyTopHeight(t+"px"),this.stickyTopHeight=t},e.prototype.getStickyTopHeight=function(){return this.stickyTopHeight},e.prototype.setStickyTopWidth=function(t){if(t){var e=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth("calc(100% - "+e+"px)")}else this.comp.setStickyTopWidth("100%")},e.prototype.onHeaderHeightChanged=function(){this.setStickyTopOffsetTop()},e.prototype.setStickyTopOffsetTop=function(){var t=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight()+this.filterManager.getHeaderHeight(),e=this.pinnedRowModel.getPinnedTopTotalHeight(),n=0;t>0&&(n+=t+1),e>0&&(n+=e+1),this.comp.setStickyTopTop(n+"px")},e.prototype.sizeColumnsToFit=function(t,e){var n=this,r=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,o=gr(this.eGridBody)-r;o>0?this.columnModel.sizeColumnsToFit(o,"sizeColumnsToFit",!1,t):void 0===e?window.setTimeout((function(){n.sizeColumnsToFit(t,100)}),0):100===e?window.setTimeout((function(){n.sizeColumnsToFit(t,500)}),100):500===e?window.setTimeout((function(){n.sizeColumnsToFit(t,-1)}),500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")},e.prototype.addScrollEventListener=function(t){this.eBodyViewport.addEventListener("scroll",t,{passive:!0})},e.prototype.removeScrollEventListener=function(t){this.eBodyViewport.removeEventListener("scroll",t)},Ll([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Ll([$("rowContainerHeightService")],e.prototype,"rowContainerHeightService",void 0),Ll([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Ll([$("columnModel")],e.prototype,"columnModel",void 0),Ll([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Ll([tt("contextMenuFactory")],e.prototype,"contextMenuFactory",void 0),Ll([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),Ll([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Ll([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Ll([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Ll([$("popupService")],e.prototype,"popupService",void 0),Ll([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Ll([$("rowModel")],e.prototype,"rowModel",void 0),Ll([$("filterManager")],e.prototype,"filterManager",void 0),e}(jt);!function(t){t[t.FILL=0]="FILL",t[t.RANGE=1]="RANGE"}(Nl||(Nl={})),function(t){t[t.VALUE=0]="VALUE",t[t.DIMENSION=1]="DIMENSION"}(Fl||(Fl={}));var Gl,Bl=function(){function t(t,e){this.beans=t,this.cellCtrl=e}return t.prototype.setComp=function(t,e){this.cellComp=t,this.eGui=e,this.onRangeSelectionChanged()},t.prototype.onRangeSelectionChanged=function(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected",0!==this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),wn(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())},t.prototype.updateRangeBorders=function(){var t=this.getRangeBorders(),e=this.isSingleCell(),n=!e&&t.top,r=!e&&t.right,o=!e&&t.bottom,i=!e&&t.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",o),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",i)},t.prototype.isSingleCell=function(){var t=this.beans.rangeService;return 1===this.rangeCount&&t&&!t.isMoreThanOneCell()},t.prototype.getHasChartRange=function(){var t=this.beans.rangeService;if(!this.rangeCount||!t)return!1;var e=t.getCellRanges();return e.length>0&&e.every((function(t){return Tt([Fl.DIMENSION,Fl.VALUE],t.type)}))},t.prototype.updateRangeBordersIfRangeCount=function(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())},t.prototype.getRangeBorders=function(){var t,e,n=this,r=this.beans.gridOptionsService.is("enableRtl"),o=!1,i=!1,s=!1,a=!1,l=this.cellCtrl.getCellPosition().column,u=this.beans,c=u.rangeService,p=u.columnModel;r?(t=p.getDisplayedColAfter(l),e=p.getDisplayedColBefore(l)):(t=p.getDisplayedColBefore(l),e=p.getDisplayedColAfter(l));var h=c.getCellRanges().filter((function(t){return c.isCellInSpecificRange(n.cellCtrl.getCellPosition(),t)}));t||(a=!0),e||(i=!0);for(var d=0;d<h.length&&!(o&&i&&s&&a);d++){var f=h[d],g=c.getRangeStartRow(f),m=c.getRangeEndRow(f);!o&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(o=!0),!s&&this.beans.rowPositionUtils.sameRow(m,this.cellCtrl.getCellPosition())&&(s=!0),!a&&t&&f.columns.indexOf(t)<0&&(a=!0),!i&&e&&f.columns.indexOf(e)<0&&(i=!0)}return{top:o,right:i,bottom:s,left:a}},t.prototype.refreshHandle=function(){if(this.beans.rangeService){var t=this.shouldHaveSelectionHandle();this.selectionHandle&&!t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),t&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}},t.prototype.shouldHaveSelectionHandle=function(){var t=this.beans,e=t.gridOptionsService,n=t.rangeService,r=n.getCellRanges(),o=r.length;if(this.rangeCount<1||o<1)return!1;var i=yt(r),s=this.cellCtrl.getCellPosition(),a=e.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),l=e.is("enableRangeHandle"),u=1===o&&!this.cellCtrl.isEditing()&&(a||l);if(this.hasChartRange){var c=r[0].type===Fl.DIMENSION&&n.isCellInSpecificRange(s,r[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",c),u=i.type===Fl.VALUE}return u&&null!=i.endRow&&n.isContiguousRange(i)&&n.isBottomRightCell(i,s)},t.prototype.addSelectionHandle=function(){var t=this.beans,e=t.gridOptionsService,n=yt(t.rangeService.getCellRanges()).type,r=e.is("enableFillHandle")&&i(n)?Nl.FILL:Nl.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==r&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(r)),this.selectionHandle.refresh(this.cellCtrl)},t.prototype.destroy=function(){this.beans.context.destroyBean(this.selectionHandle)},t}(),Vl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zl=function(t){function e(e,n){var r=t.call(this)||this;return r.cellCtrl=e,r.beans=n,r.column=e.getColumn(),r.rowNode=e.getRowNode(),r.setupColSpan(),r.setupRowSpan(),r}return Vl(e,t),e.prototype.setupRowSpan=function(){this.rowSpan=this.column.getRowSpan(this.rowNode)},e.prototype.setComp=function(t){this.eGui=t,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()},e.prototype.onDisplayColumnsChanged=function(){var t=this.getColSpanningList();vt(this.colsSpanning,t)||(this.colsSpanning=t,this.onWidthChanged(),this.onLeftChanged())},e.prototype.setupColSpan=function(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))},e.prototype.onWidthChanged=function(){if(this.eGui){var t=this.getCellWidth();this.eGui.style.width=t+"px"}},e.prototype.getCellWidth=function(){return this.colsSpanning?this.colsSpanning.reduce((function(t,e){return t+e.getActualWidth()}),0):this.column.getActualWidth()},e.prototype.getColSpanningList=function(){var t=this.column.getColSpan(this.rowNode),e=[];if(1===t)e.push(this.column);else for(var n=this.column,r=this.column.getPinned(),o=0;n&&o<t&&(e.push(n),(n=this.beans.columnModel.getDisplayedColAfter(n))&&!i(n))&&r===n.getPinned();o++);return e},e.prototype.onLeftChanged=function(){if(this.eGui){var t=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=t+"px"}},e.prototype.getCellLeft=function(){return(this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?yt(this.colsSpanning):this.column).getLeft()},e.prototype.modifyLeftForPrintLayout=function(t){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return t;var e=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===this.column.getPinned()?e+this.beans.columnModel.getBodyContainerWidth()+(t||0):e+(t||0)},e.prototype.applyRowSpan=function(){if(1!==this.rowSpan){var t=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=t+"px",this.eGui.style.zIndex="1"}},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(jt),jl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hl=function(t){function e(e,n){var r=t.call(this)||this;return r.staticClasses=[],r.cellCtrl=e,r.beans=n,r.column=e.getColumn(),r.rowNode=e.getRowNode(),r}return jl(e,t),e.prototype.setComp=function(t){this.cellComp=t,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()},e.prototype.applyCellClassRules=function(){var t=this,e=this.column.getColDef(),n={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(e.cellClassRules,n,(function(e){return t.cellComp.addOrRemoveCssClass(e,!0)}),(function(e){return t.cellComp.addOrRemoveCssClass(e,!1)}))},e.prototype.applyUserStyles=function(){var t=this.column.getColDef();if(t.cellStyle){var e;if("function"===typeof t.cellStyle){var n={column:this.column,value:this.cellCtrl.getValue(),colDef:t,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};e=(0,t.cellStyle)(n)}else e=t.cellStyle;e&&this.cellComp.setUserStyles(e)}},e.prototype.applyClassesFromColDef=function(){var t=this,e=this.column.getColDef(),n={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach((function(e){return t.cellComp.addOrRemoveCssClass(e,!1)})),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,n),this.staticClasses.length&&this.staticClasses.forEach((function(e){return t.cellComp.addOrRemoveCssClass(e,!0)}))},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(jt),Ul=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wl=function(t){function e(e,n){var r=t.call(this)||this;return r.ctrl=e,r.beans=n,r}return Ul(e,t),e.prototype.setComp=function(t){this.eGui=t,this.setupTooltip()},e.prototype.setBrowserTooltip=function(t){null!=t&&""!=t?this.eGui.setAttribute("title",t):this.eGui.removeAttribute("title")},e.prototype.setupTooltip=function(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.setBrowserTooltip(this.tooltip):this.createTooltipFeatureIfNeeded()},e.prototype.updateTooltipText=function(){this.tooltip=this.ctrl.getTooltipValue()},e.prototype.createTooltipFeatureIfNeeded=function(){var t=this;if(null==this.genericTooltipFeature){var e={getTooltipParams:function(){return t.getTooltipParams()},getGui:function(){return t.ctrl.getGui()}};this.genericTooltipFeature=this.createManagedBean(new _o(e),this.beans.context)}},e.prototype.refreshToolTip=function(){this.updateTooltipText(),this.browserTooltips&&this.setBrowserTooltip(this.tooltip)},e.prototype.getTooltipParams=function(){var t=this,e=this.ctrl,n=e.getColumn?e.getColumn():void 0,r=e.getColDef?e.getColDef():void 0,o=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:r,column:n,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:o,data:o?o.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0,hideTooltipCallback:function(){return t.genericTooltipFeature.hideTooltip(!0)}}},e.prototype.getTooltipText=function(){return this.tooltip},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(jt),ql=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Xl=function(){function t(){}return t.prototype.postConstruct=function(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)},ql([$("resizeObserverService")],t.prototype,"resizeObserverService",void 0),ql([$("paginationProxy")],t.prototype,"paginationProxy",void 0),ql([$("context")],t.prototype,"context",void 0),ql([$("columnApi")],t.prototype,"columnApi",void 0),ql([$("gridApi")],t.prototype,"gridApi",void 0),ql([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),ql([$("expressionService")],t.prototype,"expressionService",void 0),ql([$("environment")],t.prototype,"environment",void 0),ql([$("rowRenderer")],t.prototype,"rowRenderer",void 0),ql([$("templateService")],t.prototype,"templateService",void 0),ql([$("valueService")],t.prototype,"valueService",void 0),ql([$("eventService")],t.prototype,"eventService",void 0),ql([$("columnModel")],t.prototype,"columnModel",void 0),ql([$("headerNavigationService")],t.prototype,"headerNavigationService",void 0),ql([$("navigationService")],t.prototype,"navigationService",void 0),ql([$("columnAnimationService")],t.prototype,"columnAnimationService",void 0),ql([tt("rangeService")],t.prototype,"rangeService",void 0),ql([$("focusService")],t.prototype,"focusService",void 0),ql([tt("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),ql([$("popupService")],t.prototype,"popupService",void 0),ql([$("valueFormatterService")],t.prototype,"valueFormatterService",void 0),ql([$("stylingService")],t.prototype,"stylingService",void 0),ql([$("columnHoverService")],t.prototype,"columnHoverService",void 0),ql([$("userComponentFactory")],t.prototype,"userComponentFactory",void 0),ql([$("userComponentRegistry")],t.prototype,"userComponentRegistry",void 0),ql([$("animationFrameService")],t.prototype,"animationFrameService",void 0),ql([$("dragService")],t.prototype,"dragService",void 0),ql([$("dragAndDropService")],t.prototype,"dragAndDropService",void 0),ql([$("sortController")],t.prototype,"sortController",void 0),ql([$("filterManager")],t.prototype,"filterManager",void 0),ql([$("rowContainerHeightService")],t.prototype,"rowContainerHeightService",void 0),ql([$("frameworkOverrides")],t.prototype,"frameworkOverrides",void 0),ql([$("cellPositionUtils")],t.prototype,"cellPositionUtils",void 0),ql([$("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),ql([$("selectionService")],t.prototype,"selectionService",void 0),ql([tt("selectionHandleFactory")],t.prototype,"selectionHandleFactory",void 0),ql([$("rowCssClassCalculator")],t.prototype,"rowCssClassCalculator",void 0),ql([$("rowModel")],t.prototype,"rowModel",void 0),ql([$("ctrlsService")],t.prototype,"ctrlsService",void 0),ql([$("ctrlsFactory")],t.prototype,"ctrlsFactory",void 0),ql([$("agStackComponentsRegistry")],t.prototype,"agStackComponentsRegistry",void 0),ql([$("valueCache")],t.prototype,"valueCache",void 0),ql([$("rowNodeEventThrottle")],t.prototype,"rowNodeEventThrottle",void 0),ql([$("localeService")],t.prototype,"localeService",void 0),ql([$("valueParserService")],t.prototype,"valueParserService",void 0),ql([Z],t.prototype,"postConstruct",null),t=ql([J("beans")],t)}(),Kl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yl=function(t){function e(e,n,r){var o=t.call(this)||this;return o.cellCtrl=e,o.beans=n,o.column=r,o}return Kl(e,t),e.prototype.onMouseEvent=function(t,e){if(!Mt(e))switch(t){case"click":this.onCellClicked(e);break;case"mousedown":case"touchstart":this.onMouseDown(e);break;case"dblclick":this.onCellDoubleClicked(e);break;case"mouseout":this.onMouseOut(e);break;case"mouseover":this.onMouseOver(e)}},e.prototype.onCellClicked=function(t){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(t),void t.preventDefault();var e=this.beans,n=e.eventService,r=e.rangeService,o=e.gridOptionsService,i=t.ctrlKey||t.metaKey;r&&i&&r.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&r.intersectLastRange(!0);var s=this.cellCtrl.createEvent(t,Yt.EVENT_CELL_CLICKED);n.dispatchEvent(s);var a=this.column.getColDef();a.onCellClicked&&window.setTimeout((function(){return a.onCellClicked(s)}),0),(o.is("singleClickEdit")||a.singleClickEdit)&&!o.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()},e.prototype.isDoubleClickOnIPad=function(){if(!Gn()||Lt("dblclick"))return!1;var t=(new Date).getTime(),e=t-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=t,e},e.prototype.onCellDoubleClicked=function(t){var e=this.column.getColDef(),n=this.cellCtrl.createEvent(t,Yt.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(n),"function"===typeof e.onCellDoubleClicked&&window.setTimeout((function(){return e.onCellDoubleClicked(n)}),0),!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,t)},e.prototype.onMouseDown=function(t){var e=t.ctrlKey,n=t.metaKey,r=t.shiftKey,o=t.target,i=this.beans,s=i.eventService,a=i.rangeService;if(!this.isRightClickInExistingRange(t)){var l=a&&0!=a.getCellRanges().length;if(!r||!l){var u=Mn()&&!this.cellCtrl.isEditing()&&!lr(o);this.cellCtrl.focusCell(u)}if(r&&l&&t.preventDefault(),!this.containsWidget(o)){if(a){var c=this.cellCtrl.getCellPosition();if(r)a.extendLatestRangeToCell(c);else{var p=e||n;a.setRangeToCell(c,p)}}s.dispatchEvent(this.cellCtrl.createEvent(t,Yt.EVENT_CELL_MOUSE_DOWN))}}},e.prototype.isRightClickInExistingRange=function(t){var e=this.beans.rangeService;if(e&&(e.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===t.button))return!0;return!1},e.prototype.containsWidget=function(t){return hr(t,"ag-selection-checkbox",3)},e.prototype.onMouseOut=function(t){if(!this.mouseStayingInsideCell(t)){var e=this.cellCtrl.createEvent(t,Yt.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(e),this.beans.columnHoverService.clearMouseOver()}},e.prototype.onMouseOver=function(t){if(!this.mouseStayingInsideCell(t)){var e=this.cellCtrl.createEvent(t,Yt.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(e),this.beans.columnHoverService.setMouseOver([this.column])}},e.prototype.mouseStayingInsideCell=function(t){if(!t.target||!t.relatedTarget)return!1;var e=this.cellCtrl.getGui(),n=e.contains(t.target),r=e.contains(t.relatedTarget);return n&&r},e.prototype.destroy=function(){},e}(Xl),Zl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ql=function(t){function e(e,n,r,o,i){var s=t.call(this)||this;return s.cellCtrl=e,s.beans=n,s.rowNode=o,s.rowCtrl=i,s}return Zl(e,t),e.prototype.setComp=function(t){this.eGui=t},e.prototype.onKeyDown=function(t){var e=t.key;switch(e){case Yr.ENTER:this.onEnterKeyDown(t);break;case Yr.F2:this.onF2KeyDown(t);break;case Yr.ESCAPE:this.onEscapeKeyDown(t);break;case Yr.TAB:this.onTabKeyDown(t);break;case Yr.BACKSPACE:case Yr.DELETE:this.onBackspaceOrDeleteKeyDown(e,t);break;case Yr.DOWN:case Yr.UP:case Yr.RIGHT:case Yr.LEFT:this.onNavigationKeyDown(t,e)}},e.prototype.onNavigationKeyDown=function(t,e){this.cellCtrl.isEditing()||(t.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(t):this.beans.navigationService.navigateToNextCell(t,e,this.cellCtrl.getCellPosition(),!0),t.preventDefault())},e.prototype.onShiftRangeSelect=function(t){if(this.beans.rangeService){var e=this.beans.rangeService.extendLatestRangeInDirection(t);e&&this.beans.navigationService.ensureCellVisible(e)}},e.prototype.onTabKeyDown=function(t){this.beans.navigationService.onTabKeyDown(this.cellCtrl,t)},e.prototype.onBackspaceOrDeleteKeyDown=function(t,e){var n=this.cellCtrl,r=this.beans,o=this.rowNode,i=r.gridOptionsService,s=r.rangeService,a=r.eventService;n.isEditing()||(a.dispatchEvent({type:Yt.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),to(t,i.is("enableCellEditingOnBackspace"))?s&&i.isEnableRangeSelection()?s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"}):n.isCellEditable()&&o.setDataValue(n.getColumn(),null,"cellClear"):n.startRowOrCellEdit(t,e),a.dispatchEvent({type:Yt.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))},e.prototype.onEnterKeyDown=function(t){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,t.shiftKey);else if(this.beans.gridOptionsService.is("enterNavigatesVertically")){var e=t.shiftKey?Yr.UP:Yr.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(Yr.ENTER,t),this.cellCtrl.isEditing()&&t.preventDefault()},e.prototype.onF2KeyDown=function(t){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(Yr.F2,t)},e.prototype.onEscapeKeyDown=function(t){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))},e.prototype.processCharacter=function(t){if(!(t.target!==this.eGui)&&!this.cellCtrl.isEditing()){var e=t.key;" "===e?this.onSpaceKeyDown(t):(this.cellCtrl.startRowOrCellEdit(e,t),t.preventDefault())}},e.prototype.onSpaceKeyDown=function(t){var e=this.beans.gridOptionsService;if(!this.cellCtrl.isEditing()&&e.isRowSelection()){var n=this.rowNode.isSelected(),r=!n;if(r||!e.is("suppressRowDeselection")){var o=this.beans.gridOptionsService.is("groupSelectsFiltered"),i=this.rowNode.setSelectedParams({newValue:r,rangeSelect:t.shiftKey,groupSelectsFiltered:o,event:t,source:"spaceKey"});void 0===n&&0===i&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:t.shiftKey,groupSelectsFiltered:o,event:t,source:"spaceKey"})}}t.preventDefault()},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(jt),Jl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$l=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},tu=function(t){function e(e,n,r){var o=t.call(this,'<div class="ag-drag-handle ag-row-drag" draggable="true"></div>')||this;return o.rowNode=e,o.column=n,o.eCell=r,o}return Jl(e,t),e.prototype.postConstruct=function(){this.getGui().appendChild(Xr("rowDrag",this.gridOptionsService,null)),this.addGuiEventListener("mousedown",(function(t){t.stopPropagation()})),this.addDragSource(),this.checkVisibility()},e.prototype.addDragSource=function(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))},e.prototype.onDragStart=function(t){var e=this,n=this.column.getColDef().dndSourceOnRowDrag;t.dataTransfer.setDragImage(this.eCell,0,0);n?n({rowNode:this.rowNode,dragEvent:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):function(){try{var n=JSON.stringify(e.rowNode.data);t.dataTransfer.setData("application/json",n),t.dataTransfer.setData("text/plain",n)}catch(r){}}()},e.prototype.checkVisibility=function(){var t=this.column.isDndSource(this.rowNode);this.setDisplayed(t)},$l([Z],e.prototype,"postConstruct",null),e}(Eo),eu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nu=function(){return(nu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ru=0,ou=function(t){function e(e,n,r,o){var i=t.call(this)||this;i.cellRangeFeature=null,i.cellPositionFeature=null,i.cellCustomStyleFeature=null,i.tooltipFeature=null,i.cellMouseListenerFeature=null,i.cellKeyboardListenerFeature=null,i.suppressRefreshCell=!1,i.onCellCompAttachedFuncs=[],i.column=e,i.rowNode=n,i.beans=r,i.rowCtrl=o,i.instanceId=e.getId()+"-"+ru++;var s=i.column.getColDef();return i.colIdSanitised=re(i.column.getId()),i.beans.gridOptionsService.is("suppressCellFocus")||(i.tabIndex=-1),i.isCellRenderer=null!=s.cellRenderer||null!=s.cellRendererSelector,i.createCellPosition(),i.addFeatures(),i.updateAndFormatValue(!0),i}return eu(e,t),e.prototype.shouldRestoreFocus=function(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)},e.prototype.addFeatures=function(){var t=this;this.cellPositionFeature=new zl(this,this.beans),this.addDestroyFunc((function(){var e;null===(e=t.cellPositionFeature)||void 0===e||e.destroy(),t.cellPositionFeature=null})),this.cellCustomStyleFeature=new Hl(this,this.beans),this.addDestroyFunc((function(){var e;null===(e=t.cellCustomStyleFeature)||void 0===e||e.destroy(),t.cellCustomStyleFeature=null})),this.cellMouseListenerFeature=new Yl(this,this.beans,this.column),this.addDestroyFunc((function(){var e;null===(e=t.cellMouseListenerFeature)||void 0===e||e.destroy(),t.cellMouseListenerFeature=null})),this.cellKeyboardListenerFeature=new Ql(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc((function(){var e;null===(e=t.cellKeyboardListenerFeature)||void 0===e||e.destroy(),t.cellKeyboardListenerFeature=null})),this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new Bl(this.beans,this),this.addDestroyFunc((function(){var e;null===(e=t.cellRangeFeature)||void 0===e||e.destroy(),t.cellRangeFeature=null}))),this.column.isTooltipEnabled()&&this.addTooltipFeature()},e.prototype.addTooltipFeature=function(){var t=this,e={getColumn:function(){return t.column},getColDef:function(){return t.column.getColDef()},getRowIndex:function(){return t.cellPosition.rowIndex},getRowNode:function(){return t.rowNode},getGui:function(){return t.getGui()},getLocation:function(){return"cell"},getTooltipValue:function(){var e=t.column.getColDef(),n=t.rowNode.data;if(e.tooltipField&&o(n))return E(n,e.tooltipField,t.column.isTooltipFieldContainsDots());var r=e.tooltipValueGetter;return r?r({location:"cell",api:t.beans.gridOptionsService.api,columnApi:t.beans.gridOptionsService.columnApi,context:t.beans.gridOptionsService.context,colDef:t.column.getColDef(),column:t.column,rowIndex:t.cellPosition.rowIndex,node:t.rowNode,data:t.rowNode.data,value:t.value,valueFormatted:t.valueFormatted}):null},getValueFormatted:function(){return t.valueFormatted}};this.tooltipFeature=new Wl(e,this.beans),this.addDestroyFunc((function(){var e;null===(e=t.tooltipFeature)||void 0===e||e.destroy(),t.tooltipFeature=null}))},e.prototype.setComp=function(t,e,n,r,o){var i,s,a,l;this.cellComp=t,this.eGui=e,this.printLayout=r,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),n&&this.setupAutoHeight(n),this.setAriaColIndex(),null===(i=this.cellPositionFeature)||void 0===i||i.setComp(e),null===(s=this.cellCustomStyleFeature)||void 0===s||s.setComp(t),null===(a=this.tooltipFeature)||void 0===a||a.setComp(e),null===(l=this.cellKeyboardListenerFeature)||void 0===l||l.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t,e),o&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach((function(t){return t()})),this.onCellCompAttachedFuncs=[])},e.prototype.setupAutoHeight=function(t){var e=this;if(this.column.isAutoHeight()){var n=t.parentElement,r=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,o=function(i){if(!e.editing&&e.isAlive()){var s=dr(n),a=s.paddingTop+s.paddingBottom+s.borderBottomWidth+s.borderTopWidth,l=t.offsetHeight+a;if(i<5){var u=e.beans.gridOptionsService.getDocument();if(!u||!u.contains(t)||0==l)return void e.beans.frameworkOverrides.setTimeout((function(){return o(i+1)}),0)}var c=Math.max(l,r);e.rowNode.setRowAutoHeight(c,e.column)}},i=function(){return o(0)};i();var s=this.beans.resizeObserverService.observeResize(t,i);this.addDestroyFunc((function(){s(),e.rowNode.setRowAutoHeight(void 0,e.column)}))}},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.getIncludeSelection=function(){return this.includeSelection},e.prototype.getIncludeRowDrag=function(){return this.includeRowDrag},e.prototype.getIncludeDndSource=function(){return this.includeDndSource},e.prototype.getColumnIdSanitised=function(){return this.colIdSanitised},e.prototype.getTabIndex=function(){return this.tabIndex},e.prototype.getIsCellRenderer=function(){return this.isCellRenderer},e.prototype.getValueToDisplay=function(){return null!=this.valueFormatted?this.valueFormatted:this.value},e.prototype.showValue=function(t){void 0===t&&(t=!1);var e,n=this.getValueToDisplay();if(this.isCellRenderer){var r=this.createCellRendererParams();e=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),r)}this.cellComp.setRenderDetails(e,n,t),this.refreshHandle()},e.prototype.setupControlComps=function(){var t=this.column.getColDef();this.includeSelection=this.isIncludeControl(t.checkboxSelection),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)},e.prototype.isForceWrapper=function(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()},e.prototype.isIncludeControl=function(t){return!(null!=this.rowNode.rowPinned)&&("function"===typeof t||!0===t)},e.prototype.refreshShouldDestroy=function(){var t=this.column.getColDef(),e=this.includeSelection!=this.isIncludeControl(t.checkboxSelection),n=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),r=this.includeDndSource!=this.isIncludeControl(t.dndSource);return e||n||r},e.prototype.startEditing=function(t,e,n){var r=this;if(void 0===t&&(t=null),void 0===e&&(e=!1),void 0===n&&(n=null),this.isCellEditable()&&!this.editing)if(this.cellComp){var o=this.createCellEditorParams(t,e),i=this.column.getColDef(),s=this.beans.userComponentFactory.getCellEditorDetails(i,o),a=null!=(null===s||void 0===s?void 0:s.popupFromSelector)?s.popupFromSelector:!!i.cellEditorPopup,l=null!=(null===s||void 0===s?void 0:s.popupPositionFromSelector)?s.popupPositionFromSelector:i.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(s,a,l);var u=this.createEvent(n,Yt.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(u)}else this.onCellCompAttachedFuncs.push((function(){r.startEditing(t,e,n)}))},e.prototype.setEditing=function(t){this.editing!==t&&(this.editing=t,this.refreshHandle())},e.prototype.stopRowOrCellEdit=function(t){void 0===t&&(t=!1),"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(t):this.stopEditing(t)},e.prototype.onPopupEditorClosed=function(){this.isEditing()&&this.stopEditingAndFocus()},e.prototype.takeValueFromCellEditor=function(t){var e={newValueExists:!1};if(t)return e;var n=this.cellComp.getCellEditor();return n?n.isCancelAfterEnd&&n.isCancelAfterEnd()?e:{newValue:n.getValue(),newValueExists:!0}:e},e.prototype.saveNewValue=function(t,e){if(e===t)return!1;this.suppressRefreshCell=!0;var n=this.rowNode.setDataValue(this.column,e,"edit");return this.suppressRefreshCell=!1,n},e.prototype.stopEditing=function(t){if(void 0===t&&(t=!1),!this.editing)return!1;var e=this.takeValueFromCellEditor(t),n=e.newValue,r=e.newValueExists,o=this.rowNode.getValueFromValueService(this.column),i=!1;return r&&(i=this.saveNewValue(o,n)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(o,n,!t&&!!i),i},e.prototype.dispatchEditingStoppedEvent=function(t,e,n){var r=nu(nu({},this.createEvent(null,Yt.EVENT_CELL_EDITING_STOPPED)),{oldValue:t,newValue:e,valueChanged:n});this.beans.eventService.dispatchEvent(r)},e.prototype.createCellEditorParams=function(t,e){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:t,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:e,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}},e.prototype.createCellRendererParams=function(){var t=this;return{value:this.value,valueFormatted:this.valueFormatted,getValue:function(){return t.rowNode.getValueFromValueService(t.column)},setValue:function(e){return t.beans.valueService.setValue(t.rowNode,t.column,e)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:function(e,n,r,o){return t.registerRowDragger(e,n,o)}}},e.prototype.parseValue=function(t){return this.beans.valueParserService.parseValue(this.column,this.rowNode,t,this.getValue())},e.prototype.setFocusOutOnEditor=function(){if(this.editing){var t=this.cellComp.getCellEditor();t&&t.focusOut&&t.focusOut()}},e.prototype.setFocusInOnEditor=function(){if(this.editing){var t=this.cellComp.getCellEditor();t&&t.focusIn?t.focusIn():this.focusCell(!0)}},e.prototype.onCellChanged=function(t){this.cellComp&&(t.column===this.column&&this.refreshCell({}))},e.prototype.refreshCell=function(t){var e,n,r;if(!this.suppressRefreshCell&&!this.editing&&this.cellComp){var o=this.column.getColDef(),i=null!=t&&!!t.newData,s=null!=t&&!!t.suppressFlash||!!o.suppressCellFlash,a=null==o.field&&null==o.valueGetter&&null==o.showRowGroup,l=t&&t.forceRefresh||a||i,u=this.updateAndFormatValue();if(l||u){this.showValue(i);var c=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!s&&!c&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||o.enableCellChangeFlash)&&this.flashCell(),null===(e=this.cellCustomStyleFeature)||void 0===e||e.applyUserStyles(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyClassesFromColDef()}this.refreshToolTip(),null===(r=this.cellCustomStyleFeature)||void 0===r||r.applyCellClassRules()}},e.prototype.stopEditingAndFocus=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.stopRowOrCellEdit(),this.focusCell(!0),t||this.navigateAfterEdit(e)},e.prototype.navigateAfterEdit=function(t){if(this.beans.gridOptionsService.is("enterNavigatesVerticallyAfterEdit")){var e=t?Yr.UP:Yr.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.getCellPosition(),!1)}},e.prototype.flashCell=function(t){var e=t&&t.flashDelay,n=t&&t.fadeDelay;this.animateCell("data-changed",e,n)},e.prototype.animateCell=function(t,e,n){var r,i,s=this;if(this.cellComp){var a="ag-cell-"+t,l="ag-cell-"+t+"-animation",u=this.beans.gridOptionsService;e||(e=null!==(r=u.getNum("cellFlashDelay"))&&void 0!==r?r:500),o(n)||(n=null!==(i=u.getNum("cellFadeDelay"))&&void 0!==i?i:1e3),this.cellComp.addOrRemoveCssClass(a,!0),this.cellComp.addOrRemoveCssClass(l,!1),window.setTimeout((function(){s.isAlive()&&(s.cellComp.addOrRemoveCssClass(a,!1),s.cellComp.addOrRemoveCssClass(l,!0),s.eGui.style.transition="background-color "+n+"ms",window.setTimeout((function(){s.isAlive()&&(s.cellComp.addOrRemoveCssClass(l,!1),s.eGui.style.transition="")}),n))}),e)}},e.prototype.onFlashCells=function(t){if(this.cellComp){var e=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[e]&&this.animateCell("highlight")}},e.prototype.isCellEditable=function(){return this.column.isCellEditable(this.rowNode)},e.prototype.isSuppressFillHandle=function(){return this.column.isSuppressFillHandle()},e.prototype.formatValue=function(t){var e;return null!==(e=this.callValueFormatter(t))&&void 0!==e?e:t},e.prototype.callValueFormatter=function(t){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,t)},e.prototype.updateAndFormatValue=function(t){void 0===t&&(t=!1);var e=this.value,n=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),!!t||(!this.valuesAreEqual(e,this.value)||this.valueFormatted!=n)},e.prototype.valuesAreEqual=function(t,e){var n=this.column.getColDef();return n.equals?n.equals(t,e):t===e},e.prototype.getComp=function(){return this.cellComp},e.prototype.getValue=function(){return this.value},e.prototype.getValueFormatted=function(){return this.valueFormatted},e.prototype.addDomData=function(){var t=this,n=this.getGui();this.beans.gridOptionsService.setDomData(n,e.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc((function(){return t.beans.gridOptionsService.setDomData(n,e.DOM_DATA_KEY_CELL_CTRL,null)}))},e.prototype.createEvent=function(t,e){return{type:e,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex}},e.prototype.processCharacter=function(t){var e;null===(e=this.cellKeyboardListenerFeature)||void 0===e||e.processCharacter(t)},e.prototype.onKeyDown=function(t){var e;null===(e=this.cellKeyboardListenerFeature)||void 0===e||e.onKeyDown(t)},e.prototype.onMouseEvent=function(t,e){var n;null===(n=this.cellMouseListenerFeature)||void 0===n||n.onMouseEvent(t,e)},e.prototype.getGui=function(){return this.eGui},e.prototype.refreshToolTip=function(){var t;null===(t=this.tooltipFeature)||void 0===t||t.refreshToolTip()},e.prototype.getColSpanningList=function(){return this.cellPositionFeature.getColSpanningList()},e.prototype.onLeftChanged=function(){var t;this.cellComp&&(null===(t=this.cellPositionFeature)||void 0===t||t.onLeftChanged())},e.prototype.onDisplayedColumnsChanged=function(){this.eGui&&this.setAriaColIndex()},e.prototype.setAriaColIndex=function(){var t=this.beans.columnModel.getAriaColumnIndex(this.column);mn(this.getGui(),t)},e.prototype.isSuppressNavigable=function(){return this.column.isSuppressNavigable(this.rowNode)},e.prototype.onWidthChanged=function(){var t;return null===(t=this.cellPositionFeature)||void 0===t?void 0:t.onWidthChanged()},e.prototype.getColumn=function(){return this.column},e.prototype.getRowNode=function(){return this.rowNode},e.prototype.getBeans=function(){return this.beans},e.prototype.isPrintLayout=function(){return this.printLayout},e.prototype.appendChild=function(t){this.eGui.appendChild(t)},e.prototype.refreshHandle=function(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()},e.prototype.getCellPosition=function(){return this.cellPosition},e.prototype.isEditing=function(){return this.editing},e.prototype.startRowOrCellEdit=function(t,e){void 0===e&&(e=null),this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(t,this):this.startEditing(t,!0,e))},e.prototype.getRowCtrl=function(){return this.rowCtrl},e.prototype.getRowPosition=function(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}},e.prototype.updateRangeBordersIfRangeCount=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()},e.prototype.onRangeSelectionChanged=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},e.prototype.isRangeSelectionEnabled=function(){return null!=this.cellRangeFeature},e.prototype.focusCell=function(t){void 0===t&&(t=!1),this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:t})},e.prototype.onRowIndexChanged=function(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},e.prototype.onFirstRightPinnedChanged=function(){if(this.cellComp){var t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",t)}},e.prototype.onLastLeftPinnedChanged=function(){if(this.cellComp){var t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",t)}},e.prototype.onCellFocused=function(t){if(!this.beans.gridOptionsService.is("suppressCellFocus")){var e=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp){if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",e),e&&t&&t.forceBrowserFocus)this.cellComp.getFocusableElement().focus({preventScroll:!!t.preventScrollOnBrowserFocus});var n="fullRow"===this.beans.gridOptionsService.get("editType");e||n||!this.editing||this.stopRowOrCellEdit()}else e&&(null===t||void 0===t?void 0:t.forceBrowserFocus)&&(this.focusEventToRestore=t)}},e.prototype.createCellPosition=function(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:r(this.rowNode.rowPinned),column:this.column}},e.prototype.applyStaticCssClasses=function(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);var t=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",t),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!t)},e.prototype.onColumnHover=function(){if(this.cellComp&&this.beans.gridOptionsService.is("columnHoverHighlight")){var t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",t)}},e.prototype.onColDefChanged=function(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))},e.prototype.setWrapText=function(){var t=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",t)},e.prototype.dispatchCellContextMenuEvent=function(t){var e=this.column.getColDef(),n=this.createEvent(t,Yt.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(n),e.onCellContextMenu&&window.setTimeout((function(){return e.onCellContextMenu(n)}),0)},e.prototype.getCellRenderer=function(){return this.cellComp?this.cellComp.getCellRenderer():null},e.prototype.getCellEditor=function(){return this.cellComp?this.cellComp.getCellEditor():null},e.prototype.destroy=function(){this.onCellCompAttachedFuncs=[],t.prototype.destroy.call(this)},e.prototype.createSelectionCheckbox=function(){var t=new Fs;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t},e.prototype.createDndSource=function(){var t=new tu(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(t),t},e.prototype.registerRowDragger=function(t,e,n){var r=this;if(this.customRowDragComp)this.customRowDragComp.setDragElement(t,e);else{var o=this.createRowDragComp(t,e,n);o&&(this.customRowDragComp=o,this.addDestroyFunc((function(){r.beans.context.destroyBean(o),r.customRowDragComp=null})))}},e.prototype.createRowDragComp=function(t,e,n){var r=this,o=this.beans.gridOptionsService.is("pagination"),i=this.beans.gridOptionsService.is("rowDragManaged"),s=this.beans.gridOptionsService.isRowModelType("clientSide");if(i){if(!s)return void O((function(){return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model")}),"CellComp.addRowDragging");if(o)return void O((function(){return console.warn("AG Grid: managed row dragging is not possible when doing pagination")}),"CellComp.addRowDragging")}var a=new Us((function(){return r.value}),this.rowNode,this.column,t,e,n);return this.beans.context.createBean(a),a},e.DOM_DATA_KEY_CELL_CTRL="cellCtrl",e}(jt),iu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),su=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},au=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},lu=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};!function(t){t.Normal="Normal",t.FullWidth="FullWidth",t.FullWidthLoading="FullWidthLoading",t.FullWidthGroup="FullWidthGroup",t.FullWidthDetail="FullWidthDetail"}(Gl||(Gl={}));var uu,cu,pu=0,hu=function(t){function e(e,n,r,o,i){var s=t.call(this)||this;return s.allRowGuis=[],s.active=!0,s.centerCellCtrls={list:[],map:{}},s.leftCellCtrls={list:[],map:{}},s.rightCellCtrls={list:[],map:{}},s.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},s.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},s.lastMouseDownOnDragger=!1,s.emptyStyle={},s.updateColumnListsPending=!1,s.rowId=null,s.businessKeySanitised=null,s.beans=n,s.gridOptionsService=n.gridOptionsService,s.rowNode=e,s.paginationPage=n.paginationProxy.getCurrentPage(),s.useAnimationFrameForCreate=o,s.printLayout=i,s.instanceId=e.id+"-"+pu++,s.rowId=re(e.id),s.isFullWidth()&&!s.gridOptionsService.is("suppressCellFocus")&&(s.tabIndex=-1),s.setAnimateFlags(r),s.initRowBusinessKey(),s.rowFocused=n.focusService.isRowFocused(s.rowNode.rowIndex,s.rowNode.rowPinned),s.rowLevel=n.rowCssClassCalculator.calculateRowLevel(s.rowNode),s.setRowType(),s.rowStyles=s.processStylesFromGridOptions(),s.addListeners(),s}return iu(e,t),e.prototype.initRowBusinessKey=function(){this.businessKeyForNodeFunc=this.gridOptionsService.get("getBusinessKeyForNode"),this.updateRowBusinessKey()},e.prototype.updateRowBusinessKey=function(){if("function"===typeof this.businessKeyForNodeFunc){var t=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=re(t)}},e.prototype.getRowId=function(){return this.rowId},e.prototype.getRowStyles=function(){return this.rowStyles},e.prototype.getTabIndex=function(){return this.tabIndex},e.prototype.isSticky=function(){return this.rowNode.sticky},e.prototype.getBeans=function(){return this.beans},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.setComp=function(t,e,n){var r={rowComp:t,element:e,containerType:n};this.allRowGuis.push(r),n===cu.LEFT?this.leftGui=r:n===cu.RIGHT?this.rightGui=r:n===cu.FULL_WIDTH?this.fullWidthGui=r:this.centerGui=r,this.initialiseRowComp(r),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()},e.prototype.unsetComp=function(t){this.allRowGuis=this.allRowGuis.filter((function(e){return e.containerType!==t})),t===cu.LEFT?this.leftGui=void 0:t===cu.RIGHT?this.rightGui=void 0:t===cu.FULL_WIDTH&&(this.fullWidthGui=void 0)},e.prototype.isCacheable=function(){return this.rowType===Gl.FullWidthDetail&&this.gridOptionsService.is("keepDetailRows")},e.prototype.setCached=function(t){var e=t?"none":"";this.allRowGuis.forEach((function(t){return t.element.style.display=e}))},e.prototype.initialiseRowComp=function(t){var n=this,r=this.gridOptionsService;this.listenOnDomOrder(t),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),r.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);var o=t.rowComp;this.getInitialRowClasses(t.containerType).forEach((function(t){return o.addOrRemoveCssClass(t,!0)})),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&ln(t.element,1==this.rowNode.expanded),this.setRowCompRowId(o,!1),this.setRowCompRowBusinessKey(o),r.setDomData(t.element,e.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc((function(){return r.setDomData(t.element,e.DOM_DATA_KEY_ROW_CTRL,null)})),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t.element),this.isFullWidth()&&this.setupFullWidth(t),r.is("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask((function(){n.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()},e.prototype.setRowCompRowBusinessKey=function(t){null!=this.businessKeySanitised&&t.setRowBusinessKey(this.businessKeySanitised)},e.prototype.getBusinessKey=function(){return this.businessKeySanitised},e.prototype.setRowCompRowId=function(t,e){e&&(this.rowId=re(this.rowNode.id)),null!=this.rowId&&t.setRowId(this.rowId)},e.prototype.executeSlideAndFadeAnimations=function(t){var e=this,n=t.containerType;this.slideInAnimation[n]&&(N((function(){e.onTopChanged()})),this.slideInAnimation[n]=!1),this.fadeInAnimation[n]&&(N((function(){t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[n]=!1)},e.prototype.addRowDraggerToRow=function(t){if(this.gridOptionsService.isEnableRangeSelection())O((function(){console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")}),"rowDragAndRangeSelectionEnabled");else{var e=this.beans.localeService.getLocaleTextFunc(),n=new Us((function(){return"1 "+e("rowDragRow","row")}),this.rowNode,void 0,t.element,void 0,!0);this.createManagedBean(n,this.beans.context)}},e.prototype.setupFullWidth=function(t){var e=this.getPinnedForContainer(t.containerType),n=this.createFullWidthParams(t.element,e);if(this.rowType!=Gl.FullWidthDetail||W.__assertRegistered(z.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId())){var r;switch(this.rowType){case Gl.FullWidthDetail:r=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(n);break;case Gl.FullWidthGroup:r=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(n);break;case Gl.FullWidthLoading:r=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(n);break;default:r=this.beans.userComponentFactory.getFullWidthCellRendererDetails(n)}t.rowComp.showFullWidth(r)}},e.prototype.isPrintLayout=function(){return this.printLayout},e.prototype.getFullWidthCellRenderer=function(){var t,e;return null===(e=null===(t=this.fullWidthGui)||void 0===t?void 0:t.rowComp)||void 0===e?void 0:e.getFullWidthCellRenderer()},e.prototype.getCellElement=function(t){var e=this.getCellCtrl(t);return e?e.getGui():null},e.prototype.executeProcessRowPostCreateFunc=function(){var t,e=this.gridOptionsService.getCallback("processRowPostCreate");e&&this.areAllContainersReady()&&e({eRow:null===(t=this.centerGui)||void 0===t?void 0:t.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})},e.prototype.areAllContainersReady=function(){var t=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),e=!!this.centerGui,n=!!this.rightGui||!this.beans.columnModel.isPinningRight();return t&&e&&n},e.prototype.setRowType=function(){var t=this.rowNode.stub,e=this.rowNode.isFullWidthCell(),n=this.beans.doingMasterDetail&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),o=!!this.rowNode.group&&!this.rowNode.footer&&this.gridOptionsService.isGroupUseEntireRow(r);this.rowType=t?Gl.FullWidthLoading:n?Gl.FullWidthDetail:e?Gl.FullWidth:o?Gl.FullWidthGroup:Gl.Normal},e.prototype.updateColumnLists=function(t,e){var n=this;(void 0===t&&(t=!1),void 0===e&&(e=!1),this.isFullWidth())||(t||this.gridOptionsService.is("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(e):this.updateColumnListsPending||(this.beans.animationFrameService.createTask((function(){n.active&&n.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0))},e.prototype.createCellCtrls=function(t,e,n){var r=this;void 0===n&&(n=null);var o={list:[],map:{}},i=function(t,e){o.list.push(e),o.map[t]=e};return e.forEach((function(e){var n=e.getInstanceId(),o=t.map[n];o||(o=new ou(e,r.rowNode,r.beans,r)),i(n,o)})),t.list.forEach((function(t){null!=o.map[t.getColumn().getInstanceId()]||(!r.isCellEligibleToBeRemoved(t,n)?i(t.getColumn().getInstanceId(),t):t.destroy())})),o},e.prototype.updateColumnListsImpl=function(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)},e.prototype.setCellCtrls=function(t){var e=this;this.allRowGuis.forEach((function(n){var r=e.getCellCtrlsForContainer(n.containerType);n.rowComp.setCellCtrls(r,t)}))},e.prototype.getCellCtrlsForContainer=function(t){switch(t){case cu.LEFT:return this.leftCellCtrls.list;case cu.RIGHT:return this.rightCellCtrls.list;case cu.FULL_WIDTH:return[];case cu.CENTER:return this.centerCellCtrls.list;default:throw new Error("Unhandled case: "+t)}},e.prototype.createAllCellCtrls=function(){var t=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{var e=t.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,e);var n=t.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");var r=t.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}},e.prototype.isCellEligibleToBeRemoved=function(t,e){if(t.getColumn().getPinned()!=e)return!0;var n=t.isEditing(),r=this.beans.focusService.isCellFocused(t.getCellPosition());if(n||r){var o=t.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(o)>=0)}return!0},e.prototype.getDomOrder=function(){return this.gridOptionsService.is("ensureDomOrder")||this.gridOptionsService.isDomLayout("print")},e.prototype.listenOnDomOrder=function(t){var e=this,n=function(){t.rowComp.setDomOrder(e.getDomOrder())};this.addManagedPropertyListener("domLayout",n),this.addManagedPropertyListener("ensureDomOrder",n)},e.prototype.setAnimateFlags=function(t){if(!this.isSticky()&&t){var e=o(this.rowNode.oldRowTop),n=this.beans.columnModel.isPinningLeft(),r=this.beans.columnModel.isPinningRight();e?(this.slideInAnimation.center=!0,this.slideInAnimation.left=n,this.slideInAnimation.right=r):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=n,this.fadeInAnimation.right=r)}},e.prototype.isEditing=function(){return this.editingRow},e.prototype.stopRowEditing=function(t){this.stopEditing(t)},e.prototype.isFullWidth=function(){return this.rowType!==Gl.Normal},e.prototype.getRowType=function(){return this.rowType},e.prototype.refreshFullWidth=function(){var t=this,e=function(e,n){if(!e)return!0;var r=e.rowComp.getFullWidthCellRenderer();if(!r)return!1;if(!r.refresh)return!1;var o=t.createFullWidthParams(e.element,n);return r.refresh(o)},n=e(this.fullWidthGui,null),r=e(this.centerGui,null),o=e(this.leftGui,"left"),i=e(this.rightGui,"right");return n&&r&&o&&i},e.prototype.addListeners=function(){var t=this;this.addManagedListener(this.rowNode,Ds.EVENT_HEIGHT_CHANGED,(function(){return t.onRowHeightChanged()})),this.addManagedListener(this.rowNode,Ds.EVENT_ROW_SELECTED,(function(){return t.onRowSelected()})),this.addManagedListener(this.rowNode,Ds.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,Ds.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,Ds.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));var e=this.beans.eventService;this.addManagedListener(e,Yt.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(e,Yt.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(e,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(e,Yt.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(e,Yt.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(e,Yt.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(e,Yt.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(e,Yt.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(e,Yt.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()},e.prototype.onColumnMoved=function(){this.updateColumnLists()},e.prototype.addListenersForCellComps=function(){var t=this;this.addManagedListener(this.rowNode,Ds.EVENT_ROW_INDEX_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onRowIndexChanged()}))})),this.addManagedListener(this.rowNode,Ds.EVENT_CELL_CHANGED,(function(e){t.getAllCellCtrls().forEach((function(t){return t.onCellChanged(e)}))}))},e.prototype.onRowNodeDataChanged=function(t){var e=this;this.isFullWidth()?this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode):(this.getAllCellCtrls().forEach((function(e){return e.refreshCell({suppressFlash:!t.update,newData:!t.update})})),this.allRowGuis.forEach((function(t){e.setRowCompRowId(t.rowComp,!0),e.updateRowBusinessKey(),e.setRowCompRowBusinessKey(t.rowComp)})),this.onRowSelected(),this.postProcessCss())},e.prototype.onRowNodeCellChanged=function(){this.postProcessCss()},e.prototype.postProcessCss=function(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},e.prototype.onRowNodeHighlightChanged=function(){var t=this.rowNode.highlighted;this.allRowGuis.forEach((function(e){var n=t===Ja.Above,r=t===Ja.Below;e.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),e.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)}))},e.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},e.prototype.postProcessRowDragging=function(){var t=this.rowNode.dragging;this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-dragging",t)}))},e.prototype.updateExpandedCss=function(){var t=this.rowNode.isExpandable(),e=1==this.rowNode.expanded;this.allRowGuis.forEach((function(n){n.rowComp.addOrRemoveCssClass("ag-row-group",t),n.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&e),n.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!e),ln(n.element,t&&e)}))},e.prototype.onDisplayedColumnsChanged=function(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()},e.prototype.onVirtualColumnsChanged=function(){this.updateColumnLists(!1,!0)},e.prototype.getRowPosition=function(){return{rowPinned:r(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}},e.prototype.onKeyboardNavigate=function(t){var e=this.allRowGuis.find((function(e){return e.element.contains(t.target)}));if((e?e.element:null)===t.target){var n=this.rowNode,r=this.beans.focusService.getFocusedCell(),o={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:r&&r.column};this.beans.navigationService.navigateToNextCell(t,t.key,o,!0),t.preventDefault()}},e.prototype.onTabKeyDown=function(t){if(!t.defaultPrevented&&!Mt(t)){var e=this.allRowGuis.find((function(e){return e.element.contains(t.target)})),n=e?e.element:null,r=n===t.target,o=null;r||(o=this.beans.focusService.findNextFocusableElement(n,!1,t.shiftKey)),(this.isFullWidth()&&r||!o)&&this.beans.navigationService.onTabKeyDown(this,t)}},e.prototype.onFullWidthRowFocused=function(t){var e,n=this.rowNode,r=!!t&&(this.isFullWidth()&&t.rowIndex===n.rowIndex&&t.rowPinned==n.rowPinned),o=this.fullWidthGui?this.fullWidthGui.element:null===(e=this.centerGui)||void 0===e?void 0:e.element;o&&(o.classList.toggle("ag-full-width-focus",r),r&&o.focus({preventScroll:!0}))},e.prototype.refreshCell=function(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),this.updateColumnLists()},e.prototype.removeCellCtrl=function(t,e){var n={list:[],map:{}};return t.list.forEach((function(t){t!==e&&(n.list.push(t),n.map[t.getInstanceId()]=t)})),n},e.prototype.onMouseEvent=function(t,e){switch(t){case"dblclick":this.onRowDblClick(e);break;case"click":this.onRowClick(e);break;case"touchstart":case"mousedown":this.onRowMouseDown(e)}},e.prototype.createRowEvent=function(t,e){return{type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,event:e}},e.prototype.createRowEventWithSource=function(t,e){var n=this.createRowEvent(t,e);return n.source=this,n},e.prototype.onRowDblClick=function(t){if(!Mt(t)){var e=this.createRowEventWithSource(Yt.EVENT_ROW_DOUBLE_CLICKED,t);this.beans.eventService.dispatchEvent(e)}},e.prototype.onRowMouseDown=function(t){if(this.lastMouseDownOnDragger=hr(t.target,"ag-row-drag",3),this.isFullWidth()){var e=this.rowNode,n=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:e.rowIndex,column:n.getAllDisplayedColumns()[0],rowPinned:e.rowPinned,forceBrowserFocus:!0})}},e.prototype.onRowClick=function(t){if(!(Mt(t)||this.lastMouseDownOnDragger)){var e=this.createRowEventWithSource(Yt.EVENT_ROW_CLICKED,t);this.beans.eventService.dispatchEvent(e);var n=t.ctrlKey||t.metaKey,r=t.shiftKey;if(!(this.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.gridOptionsService.isRowSelection()||this.gridOptionsService.is("suppressRowClickSelection"))){var o=this.gridOptionsService.is("rowMultiSelectWithClick"),i=!this.gridOptionsService.is("suppressRowDeselection"),s="rowClicked";if(this.rowNode.isSelected())o?this.rowNode.setSelectedParams({newValue:!1,event:t,source:s}):n?i&&this.rowNode.setSelectedParams({newValue:!1,event:t,source:s}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!r,rangeSelect:r,event:t,source:s});else{var a=!o&&!n;this.rowNode.setSelectedParams({newValue:!0,clearSelection:a,rangeSelect:r,event:t,source:s})}}}},e.prototype.setupDetailRowAutoHeight=function(t){var e=this;if(this.rowType===Gl.FullWidthDetail&&this.gridOptionsService.is("detailRowAutoHeight")){var n=function(){var n=t.clientHeight;if(null!=n&&n>0){e.beans.frameworkOverrides.setTimeout((function(){e.rowNode.setRowHeight(n),e.beans.clientSideRowModel?e.beans.clientSideRowModel.onRowHeightChanged():e.beans.serverSideRowModel&&e.beans.serverSideRowModel.onRowHeightChanged()}),0)}},r=this.beans.resizeObserverService.observeResize(t,n);this.addDestroyFunc(r),n()}},e.prototype.createFullWidthParams=function(t,e){var n=this;return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,eGridCell:t,eParentOfValue:t,pinned:e,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:function(t,e,r,o){return n.addFullWidthRowDragging(t,e,r,o)}}},e.prototype.addFullWidthRowDragging=function(t,e,n,r){if(void 0===n&&(n=""),this.isFullWidth()){var o=new Us((function(){return n}),this.rowNode,void 0,t,e,r);this.createManagedBean(o,this.beans.context)}},e.prototype.onUiLevelChanged=function(){var t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){var e="ag-row-level-"+t,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((function(t){t.rowComp.addOrRemoveCssClass(e,!0),t.rowComp.addOrRemoveCssClass(n,!1)}))}this.rowLevel=t},e.prototype.isFirstRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()},e.prototype.isLastRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()},e.prototype.onModelUpdated=function(){this.refreshFirstAndLastRowStyles()},e.prototype.refreshFirstAndLastRowStyles=function(){var t=this.isFirstRowOnPage(),e=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-first",t)}))),this.lastRowOnPage!==e&&(this.lastRowOnPage=e,this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-last",e)})))},e.prototype.stopEditing=function(t){var e,n;if(void 0===t&&(t=!1),!this.stoppingRowEdit){var r=this.getAllCellCtrls(),o=this.editingRow;this.stoppingRowEdit=!0;var i=!1;try{for(var s=su(r),a=s.next();!a.done;a=s.next()){var l=a.value.stopEditing(t);o&&!t&&!i&&l&&(i=!0)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}if(i){var u=this.createRowEvent(Yt.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(u)}o&&this.setEditingRow(!1),this.stoppingRowEdit=!1}},e.prototype.setInlineEditingCss=function(t){this.allRowGuis.forEach((function(e){e.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),e.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)}))},e.prototype.setEditingRow=function(t){this.editingRow=t,this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-editing",t)}));var e=t?this.createRowEvent(Yt.EVENT_ROW_EDITING_STARTED):this.createRowEvent(Yt.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(e)},e.prototype.startRowEditing=function(t,e,n){(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),this.editingRow)||this.getAllCellCtrls().reduce((function(r,o){var i=o===e;return i?o.startEditing(t,i,n):o.startEditing(null,i,n),!!r||o.isEditing()}),!1)&&this.setEditingRow(!0)},e.prototype.getAllCellCtrls=function(){return 0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length?this.centerCellCtrls.list:lu(lu(lu([],au(this.centerCellCtrls.list)),au(this.leftCellCtrls.list)),au(this.rightCellCtrls.list))},e.prototype.postProcessClassesFromGridOptions=function(){var t=this,e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach((function(e){t.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass(e,!0)}))}))},e.prototype.postProcessRowClassRules=function(){var t=this;this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,(function(e){t.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass(e,!0)}))}),(function(e){t.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass(e,!1)}))}))},e.prototype.setStylesFromGridOptions=function(t,e){var n=this;t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(e,(function(t){return t.rowComp.setUserStyles(n.rowStyles)}))},e.prototype.getPinnedForContainer=function(t){return t===cu.LEFT?"left":t===cu.RIGHT?"right":null},e.prototype.getInitialRowClasses=function(t){var e=this.getPinnedForContainer(t),n={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[t],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:e};return this.beans.rowCssClassCalculator.getInitialRowClasses(n)},e.prototype.processStylesFromGridOptions=function(){var t=this.gridOptionsService.get("rowStyle");if(!t||"function"!==typeof t){var e,n=this.gridOptionsService.getCallback("getRowStyle");if(n)e=n({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});return e||t?Object.assign({},t,e):this.emptyStyle}console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},e.prototype.onRowSelected=function(t){var e=this,n=!!this.rowNode.isSelected();this.forEachGui(t,(function(t){t.rowComp.addOrRemoveCssClass("ag-row-selected",n),wn(t.element,!!n||void 0);var r=e.createAriaLabel();$e(t.element,null==r?"":r)}))},e.prototype.createAriaLabel=function(){var t=this.rowNode.isSelected();if(!t||!this.gridOptionsService.is("suppressRowDeselection"))return this.beans.localeService.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect","Press SPACE to "+(t?"deselect":"select")+" this row.")},e.prototype.isUseAnimationFrameForCreate=function(){return this.useAnimationFrameForCreate},e.prototype.addHoverFunctionality=function(t){var e=this;this.active&&(this.addManagedListener(t,"mouseenter",(function(){return e.rowNode.onMouseEnter()})),this.addManagedListener(t,"mouseleave",(function(){return e.rowNode.onMouseLeave()})),this.addManagedListener(this.rowNode,Ds.EVENT_MOUSE_ENTER,(function(){e.beans.dragService.isDragging()||e.gridOptionsService.is("suppressRowHoverHighlight")||(t.classList.add("ag-row-hover"),e.rowNode.setHovered(!0))})),this.addManagedListener(this.rowNode,Ds.EVENT_MOUSE_LEAVE,(function(){t.classList.remove("ag-row-hover"),e.rowNode.setHovered(!1)})))},e.prototype.roundRowTopToBounds=function(t){var e=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.applyPaginationOffset(e.top,!0)-100,r=this.applyPaginationOffset(e.bottom,!0)+100;return Math.min(Math.max(n,t),r)},e.prototype.getFrameworkOverrides=function(){return this.beans.frameworkOverrides},e.prototype.forEachGui=function(t,e){t?e(t):this.allRowGuis.forEach(e)},e.prototype.onRowHeightChanged=function(t){if(null!=this.rowNode.rowHeight){var e=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),r=this.gridOptionsService.isGetRowHeightFunction()?this.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,o=r?Math.min(n,r)-2+"px":void 0;this.forEachGui(t,(function(t){t.element.style.height=e+"px",o&&t.element.style.setProperty("--ag-line-height",o)}))}},e.prototype.addEventListener=function(e,n){t.prototype.addEventListener.call(this,e,n)},e.prototype.removeEventListener=function(e,n){t.prototype.removeEventListener.call(this,e,n)},e.prototype.destroyFirstPass=function(){this.active=!1,this.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);var e=this.createRowEvent(Yt.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e),t.prototype.destroy.call(this)},e.prototype.setupRemoveAnimation=function(){if(!this.isSticky())if(null!=this.rowNode.rowTop){var t=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(t)}else this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)}))},e.prototype.destroySecondPass=function(){this.allRowGuis.length=0;var t=function(t){return t.list.forEach((function(t){return t.destroy()})),{list:[],map:{}}};this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)},e.prototype.setFocusedClasses=function(t){var e=this;this.forEachGui(t,(function(t){t.rowComp.addOrRemoveCssClass("ag-row-focus",e.rowFocused),t.rowComp.addOrRemoveCssClass("ag-row-no-focus",!e.rowFocused)}))},e.prototype.onCellFocused=function(){this.onCellFocusChanged()},e.prototype.onCellFocusCleared=function(){this.onCellFocusChanged()},e.prototype.onCellFocusChanged=function(){var t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)},e.prototype.onPaginationChanged=function(){var t=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()},e.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},e.prototype.onPaginationPixelOffsetChanged=function(){this.onTopChanged()},e.prototype.applyPaginationOffset=function(t,e){return void 0===e&&(e=!1),this.rowNode.isRowPinned()||this.rowNode.sticky?t:t+this.beans.paginationProxy.getPixelOffset()*(e?1:-1)},e.prototype.setRowTop=function(t){if(!this.printLayout&&o(t)){var e=this.applyPaginationOffset(t),n=(this.rowNode.isRowPinned()||this.rowNode.sticky?e:this.beans.rowContainerHeightService.getRealPixelPosition(e))+"px";this.setRowTopStyle(n)}},e.prototype.getInitialRowTop=function(t){return this.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(t):void 0},e.prototype.getInitialTransform=function(t){return this.gridOptionsService.is("suppressRowTransform")?void 0:"translateY("+this.getInitialRowTopShared(t)+")"},e.prototype.getInitialRowTopShared=function(t){if(this.printLayout)return"";var e;if(this.isSticky())e=this.rowNode.stickyRowTop;else{var n=this.slideInAnimation[t]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,r=this.applyPaginationOffset(n);e=this.rowNode.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}return e+"px"},e.prototype.setRowTopStyle=function(t){var e=this.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach((function(n){return e?n.rowComp.setTop(t):n.rowComp.setTransform("translateY("+t+")")}))},e.prototype.getRowNode=function(){return this.rowNode},e.prototype.getCellCtrl=function(t){var e=null;return this.getAllCellCtrls().forEach((function(n){n.getColumn()==t&&(e=n)})),null!=e||this.getAllCellCtrls().forEach((function(n){n.getColSpanningList().indexOf(t)>=0&&(e=n)})),e},e.prototype.onRowIndexChanged=function(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())},e.prototype.getRowIndex=function(){return this.rowNode.getRowIndexString()},e.prototype.updateRowIndexes=function(t){var e=this.rowNode.getRowIndexString(),n=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),r=this.rowNode.rowIndex%2===0,o=n+this.rowNode.rowIndex+1;this.forEachGui(t,(function(t){t.rowComp.setRowIndex(e),t.rowComp.addOrRemoveCssClass("ag-row-even",r),t.rowComp.addOrRemoveCssClass("ag-row-odd",!r),fn(t.element,o)}))},e.prototype.getPinnedLeftRowElement=function(){return this.leftGui?this.leftGui.element:void 0},e.prototype.getPinnedRightRowElement=function(){return this.rightGui?this.rightGui.element:void 0},e.prototype.getBodyRowElement=function(){return this.centerGui?this.centerGui.element:void 0},e.prototype.getFullWidthRowElement=function(){return this.fullWidthGui?this.fullWidthGui.element:void 0},e.DOM_DATA_KEY_ROW_CTRL="renderedRow",e}(jt),du=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gu=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},mu=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return du(e,t),e.prototype.postConstruct=function(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()},e.prototype.addKeyboardListeners=function(){var t=this.processKeyboardEvent.bind(this,"keydown");this.addManagedListener(this.element,"keydown",t)},e.prototype.addMouseListeners=function(){var t=this;["dblclick","contextmenu","mouseover","mouseout","click",Lt("touchstart")?"touchstart":"mousedown"].forEach((function(e){var n=t.processMouseEvent.bind(t,e);t.addManagedListener(t.element,e,n)}))},e.prototype.processMouseEvent=function(t,e){if(this.mouseEventService.isEventFromThisGrid(e)&&!Mt(e)){var n=this.getRowForEvent(e),r=this.mouseEventService.getRenderedCellForEvent(e);"contextmenu"===t?this.handleContextMenuMouseEvent(e,null,n,r):(r&&r.onMouseEvent(t,e),n&&n.onMouseEvent(t,e))}},e.prototype.mockContextMenuForIPad=function(){var t=this;if(Gn()){var e=new es(this.element);this.addManagedListener(e,es.EVENT_LONG_TAP,(function(e){var n=t.getRowForEvent(e.touchEvent),r=t.mouseEventService.getRenderedCellForEvent(e.touchEvent);t.handleContextMenuMouseEvent(null,e.touchEvent,n,r)})),this.addDestroyFunc((function(){return e.destroy()}))}},e.prototype.getRowForEvent=function(t){for(var e=t.target;e;){var n=this.gridOptionsService.getDomData(e,hu.DOM_DATA_KEY_ROW_CTRL);if(n)return n;e=e.parentElement}return null},e.prototype.handleContextMenuMouseEvent=function(t,e,n,r){var o=n?n.getRowNode():null,i=r?r.getColumn():null,s=null;if(i){var a=t||e;r.dispatchCellContextMenuEvent(a),s=this.valueService.getValue(i,o)}var l=this.ctrlsService.getGridBodyCtrl(),u=r?r.getGui():l.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(t,e,o,i,s,u)},e.prototype.getControlsForEventTarget=function(t){return{cellCtrl:Nt(this.gridOptionsService,t,ou.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Nt(this.gridOptionsService,t,hu.DOM_DATA_KEY_ROW_CTRL)}},e.prototype.processKeyboardEvent=function(t,e){var n=this.getControlsForEventTarget(e.target),r=n.cellCtrl,o=n.rowCtrl;e.defaultPrevented||(r?this.processCellKeyboardEvent(r,t,e):o&&o.isFullWidth()&&this.processFullWidthRowKeyboardEvent(o,t,e))},e.prototype.processCellKeyboardEvent=function(t,e,n){var r=t.getRowNode(),o=t.getColumn(),i=t.isEditing();Qr(this.gridOptionsService,n,r,o,i)||"keydown"===e&&(!i&&this.navigationService.handlePageScrollingKey(n)||t.onKeyDown(n),this.doGridOperations(n,t.isEditing()),Zr(n)&&t.processCharacter(n));if("keydown"===e){var s=t.createEvent(n,Yt.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(s)}},e.prototype.processFullWidthRowKeyboardEvent=function(t,e,n){var r=t.getRowNode(),o=this.focusService.getFocusedCell(),i=o&&o.column;if(!Qr(this.gridOptionsService,n,r,i,!1)){var s=n.key;if("keydown"===e)switch(s){case Yr.PAGE_HOME:case Yr.PAGE_END:case Yr.PAGE_UP:case Yr.PAGE_DOWN:this.navigationService.handlePageScrollingKey(n,!0);break;case Yr.UP:case Yr.DOWN:t.onKeyboardNavigate(n);break;case Yr.TAB:t.onTabKeyDown(n)}}if("keydown"===e){var a=t.createRowEvent(Yt.EVENT_CELL_KEY_DOWN,n);this.eventService.dispatchEvent(a)}},e.prototype.doGridOperations=function(t,e){if((t.ctrlKey||t.metaKey)&&!e&&this.mouseEventService.isEventFromThisGrid(t)){var n=$r(t);return n===Yr.A?this.onCtrlAndA(t):n===Yr.C?this.onCtrlAndC(t):n===Yr.D?this.onCtrlAndD(t):n===Yr.V?this.onCtrlAndV(t):n===Yr.X?this.onCtrlAndX(t):n===Yr.Y?this.onCtrlAndY():n===Yr.Z?this.onCtrlAndZ(t):void 0}},e.prototype.onCtrlAndA=function(t){var e=this.pinnedRowModel,n=this.paginationProxy,r=this.rangeService;if(r&&n.isRowsToRender()){var o=gu([e.isEmpty("top"),e.isEmpty("bottom")],2),i=o[0]?null:"top",a=void 0,l=void 0;o[1]?(a=null,l=this.paginationProxy.getRowCount()-1):(a="bottom",l=e.getPinnedBottomRowData().length-1);var u=this.columnModel.getAllDisplayedColumns();if(s(u))return;r.setCellRange({rowStartIndex:0,rowStartPinned:i,rowEndIndex:l,rowEndPinned:a,columnStart:u[0],columnEnd:yt(u)})}t.preventDefault()},e.prototype.onCtrlAndC=function(t){if(this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")){var e=this.getControlsForEventTarget(t.target),n=e.cellCtrl,r=e.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===r||void 0===r?void 0:r.isEditing())||(t.preventDefault(),this.clipboardService.copyToClipboard())}},e.prototype.onCtrlAndX=function(t){if(this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")&&!this.gridOptionsService.is("suppressCutToClipboard")){var e=this.getControlsForEventTarget(t.target),n=e.cellCtrl,r=e.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===r||void 0===r?void 0:r.isEditing())||(t.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}},e.prototype.onCtrlAndV=function(t){var e=this.getControlsForEventTarget(t.target),n=e.cellCtrl,r=e.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===r||void 0===r?void 0:r.isEditing())||this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()},e.prototype.onCtrlAndD=function(t){this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),t.preventDefault()},e.prototype.onCtrlAndZ=function(t){this.gridOptionsService.is("undoRedoCellEditing")&&(t.preventDefault(),t.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))},e.prototype.onCtrlAndY=function(){this.undoRedoService.redo("ui")},fu([$("mouseEventService")],e.prototype,"mouseEventService",void 0),fu([$("valueService")],e.prototype,"valueService",void 0),fu([tt("contextMenuFactory")],e.prototype,"contextMenuFactory",void 0),fu([$("ctrlsService")],e.prototype,"ctrlsService",void 0),fu([$("navigationService")],e.prototype,"navigationService",void 0),fu([$("focusService")],e.prototype,"focusService",void 0),fu([$("undoRedoService")],e.prototype,"undoRedoService",void 0),fu([$("columnModel")],e.prototype,"columnModel",void 0),fu([$("paginationProxy")],e.prototype,"paginationProxy",void 0),fu([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),fu([tt("rangeService")],e.prototype,"rangeService",void 0),fu([tt("clipboardService")],e.prototype,"clipboardService",void 0),fu([Z],e.prototype,"postConstruct",null),e}(jt),yu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_u=function(t){function e(e){var n=t.call(this)||this;return n.centerContainerCtrl=e,n}return yu(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl(),t.listenForResize()})),this.addManagedListener(this.eventService,Yt.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))},e.prototype.listenForResize=function(){var t=this,e=function(){return t.onCenterViewportResized()};this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)},e.prototype.onScrollbarWidthChanged=function(){this.checkViewportAndScrolls()},e.prototype.onCenterViewportResized=function(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();var t=this.centerContainerCtrl.getCenterWidth();t!==this.centerWidth&&(this.centerWidth=t,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0},e.prototype.checkViewportAndScrolls=function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()},e.prototype.getBodyHeight=function(){return this.bodyHeight},e.prototype.checkBodyHeight=function(){var t=fr(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==t){this.bodyHeight=t;var e={type:Yt.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(e)}},e.prototype.updateScrollVisibleService=function(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)},e.prototype.updateScrollVisibleServiceImpl=function(){var t={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(t)},e.prototype.isHorizontalScrollShowing=function(){return this.centerContainerCtrl.isHorizontalScrollShowing()},e.prototype.onHorizontalViewportChanged=function(){var t=this.centerContainerCtrl.getCenterWidth(),e=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(t,e)},vu([$("ctrlsService")],e.prototype,"ctrlsService",void 0),vu([$("columnModel")],e.prototype,"columnModel",void 0),vu([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),vu([Z],e.prototype,"postConstruct",null),e}(jt),wu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Cu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},bu=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return wu(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))},e.prototype.onPinnedLeftWidthChanged=function(){var t=this.pinnedWidthService.getPinnedLeftWidth(),e=t>0;ur(this.element,e),Nr(this.element,t)},e.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedLeftWidth()},Cu([$("pinnedWidthService")],e.prototype,"pinnedWidthService",void 0),Cu([Z],e.prototype,"postConstruct",null),e}(jt),xu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Eu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Su=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return xu(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))},e.prototype.onPinnedRightWidthChanged=function(){var t=this.pinnedWidthService.getPinnedRightWidth(),e=t>0;ur(this.element,e),Nr(this.element,t)},e.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedRightWidth()},Eu([$("pinnedWidthService")],e.prototype,"pinnedWidthService",void 0),Eu([Z],e.prototype,"postConstruct",null),e}(jt),Tu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ru=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Pu=function(t){function e(e,n){var r=t.call(this)||this;return r.eContainer=e,r.eWrapper=n,r}return Tu(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Yt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))},e.prototype.onHeightChanged=function(){var t=this.maxDivHeightScaler.getUiContainerHeight(),e=null!=t?t+"px":"";this.eContainer.style.height=e,this.eWrapper&&(this.eWrapper.style.height=e)},Ru([$("rowContainerHeightService")],e.prototype,"maxDivHeightScaler",void 0),Ru([Z],e.prototype,"postConstruct",null),e}(jt),Ou=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Iu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Au=function(t){function e(e){var n=t.call(this)||this;return n.eContainer=e,n}return Ou(e,t),e.prototype.postConstruct=function(){var t=this;if(this.gridOptionsService.isEnableRangeSelection()&&!i(this.rangeService)){var e={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(e),this.addDestroyFunc((function(){return t.dragService.removeDragSource(e)}))}},Iu([tt("rangeService")],e.prototype,"rangeService",void 0),Iu([$("dragService")],e.prototype,"dragService",void 0),Iu([Z],e.prototype,"postConstruct",null),e}(jt),Du=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Lu=function(t){function e(e,n){void 0===n&&(n=!1);var r=t.call(this)||this;return r.callback=e,r.addSpacer=n,r}return Du(e,t),e.prototype.postConstruct=function(){var t=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",t),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED,t),this.addSpacer&&(this.addManagedListener(this.eventService,Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_SCROLLBAR_WIDTH_CHANGED,t)),this.setWidth()},e.prototype.setWidth=function(){var t,e=this.columnModel,n=this.gridOptionsService.isDomLayout("print"),r=e.getBodyContainerWidth(),o=e.getDisplayedColumnsLeftWidth(),i=e.getDisplayedColumnsRightWidth();n?t=r+o+i:(t=r,this.addSpacer&&0===(this.gridOptionsService.is("enableRtl")?o:i)&&this.scrollVisibleService.isVerticalScrollShowing()&&(t+=this.gridOptionsService.getScrollbarWidth()));this.callback(t)},Mu([$("columnModel")],e.prototype,"columnModel",void 0),Mu([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Mu([Z],e.prototype,"postConstruct",null),e}(jt),Nu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ku=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Gu=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};function Bu(t){switch(t){case uu.CENTER:case uu.TOP_CENTER:case uu.STICKY_TOP_CENTER:case uu.BOTTOM_CENTER:return cu.CENTER;case uu.LEFT:case uu.TOP_LEFT:case uu.STICKY_TOP_LEFT:case uu.BOTTOM_LEFT:return cu.LEFT;case uu.RIGHT:case uu.TOP_RIGHT:case uu.STICKY_TOP_RIGHT:case uu.BOTTOM_RIGHT:return cu.RIGHT;case uu.FULL_WIDTH:case uu.TOP_FULL_WIDTH:case uu.STICKY_TOP_FULL_WIDTH:case uu.BOTTOM_FULL_WIDTH:return cu.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}!function(t){t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.FULL_WIDTH="fullWidth",t.TOP_LEFT="topLeft",t.TOP_RIGHT="topRight",t.TOP_CENTER="topCenter",t.TOP_FULL_WIDTH="topFullWidth",t.STICKY_TOP_LEFT="stickyTopLeft",t.STICKY_TOP_RIGHT="stickyTopRight",t.STICKY_TOP_CENTER="stickyTopCenter",t.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",t.BOTTOM_LEFT="bottomLeft",t.BOTTOM_RIGHT="bottomRight",t.BOTTOM_CENTER="bottomCenter",t.BOTTOM_FULL_WIDTH="bottomFullWidth"}(uu||(uu={})),function(t){t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.FULL_WIDTH="fullWidth"}(cu||(cu={}));var Vu=ae([[uu.CENTER,"ag-center-cols-container"],[uu.LEFT,"ag-pinned-left-cols-container"],[uu.RIGHT,"ag-pinned-right-cols-container"],[uu.FULL_WIDTH,"ag-full-width-container"],[uu.TOP_CENTER,"ag-floating-top-container"],[uu.TOP_LEFT,"ag-pinned-left-floating-top"],[uu.TOP_RIGHT,"ag-pinned-right-floating-top"],[uu.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[uu.STICKY_TOP_CENTER,"ag-sticky-top-container"],[uu.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[uu.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[uu.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[uu.BOTTOM_CENTER,"ag-floating-bottom-container"],[uu.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[uu.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[uu.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),zu=ae([[uu.CENTER,"ag-center-cols-viewport"],[uu.TOP_CENTER,"ag-floating-top-viewport"],[uu.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[uu.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),ju=ae([[uu.CENTER,"ag-center-cols-clipper"]]),Hu=function(t){function e(e){var n=t.call(this)||this;return n.visible=!0,n.EMPTY_CTRLS=[],n.name=e,n.isFullWithContainer=n.name===uu.TOP_FULL_WIDTH||n.name===uu.STICKY_TOP_FULL_WIDTH||n.name===uu.BOTTOM_FULL_WIDTH||n.name===uu.FULL_WIDTH,n}return Nu(e,t),e.getRowContainerCssClasses=function(t){return{container:Vu.get(t),viewport:zu.get(t),wrapper:ju.get(t)}},e.getPinned=function(t){switch(t){case uu.BOTTOM_LEFT:case uu.TOP_LEFT:case uu.STICKY_TOP_LEFT:case uu.LEFT:return"left";case uu.BOTTOM_RIGHT:case uu.TOP_RIGHT:case uu.STICKY_TOP_RIGHT:case uu.RIGHT:return"right";default:return null}},e.prototype.postConstruct=function(){var t=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([uu.CENTER],(function(){return t.viewportSizeFeature=t.createManagedBean(new _u(t))}))},e.prototype.registerWithCtrlsService=function(){switch(this.name){case uu.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case uu.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case uu.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case uu.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case uu.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case uu.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case uu.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case uu.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case uu.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case uu.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case uu.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case uu.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}},e.prototype.forContainers=function(t,e){t.indexOf(this.name)>=0&&e()},e.prototype.getContainerElement=function(){return this.eContainer},e.prototype.getViewportSizeFeature=function(){return this.viewportSizeFeature},e.prototype.setComp=function(t,e,n,r){var o=this;this.comp=t,this.eContainer=e,this.eViewport=n,this.eWrapper=r,this.createManagedBean(new mu(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();var i=[uu.TOP_CENTER,uu.TOP_LEFT,uu.TOP_RIGHT],s=[uu.STICKY_TOP_CENTER,uu.STICKY_TOP_LEFT,uu.STICKY_TOP_RIGHT],a=[uu.BOTTOM_CENTER,uu.BOTTOM_LEFT,uu.BOTTOM_RIGHT],l=[uu.CENTER,uu.LEFT,uu.RIGHT],u=Gu(Gu(Gu(Gu([],ku(i)),ku(a)),ku(l)),ku(s)),c=[uu.CENTER,uu.LEFT,uu.RIGHT,uu.FULL_WIDTH],p=[uu.CENTER,uu.TOP_CENTER,uu.STICKY_TOP_CENTER,uu.BOTTOM_CENTER],h=[uu.LEFT,uu.BOTTOM_LEFT,uu.TOP_LEFT,uu.STICKY_TOP_LEFT],d=[uu.RIGHT,uu.BOTTOM_RIGHT,uu.TOP_RIGHT,uu.STICKY_TOP_RIGHT];this.forContainers(h,(function(){o.pinnedWidthFeature=o.createManagedBean(new bu(o.eContainer)),o.addManagedListener(o.eventService,Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED,(function(){return o.onPinnedWidthChanged()}))})),this.forContainers(d,(function(){o.pinnedWidthFeature=o.createManagedBean(new Su(o.eContainer)),o.addManagedListener(o.eventService,Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,(function(){return o.onPinnedWidthChanged()}))})),this.forContainers(c,(function(){return o.createManagedBean(new Pu(o.eContainer,o.eWrapper))})),this.forContainers(u,(function(){return o.createManagedBean(new Au(o.eContainer))})),this.forContainers(p,(function(){return o.createManagedBean(new Lu((function(t){return o.comp.setContainerWidth(t+"px")})))})),qn()&&(this.forContainers([uu.CENTER],(function(){var t=o.enableRtl?Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED:Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED;o.addManagedListener(o.eventService,t,(function(){return o.refreshPaddingForFakeScrollbar()}))})),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()},e.prototype.refreshPaddingForFakeScrollbar=function(){var t=this,e=t.enableRtl,n=t.columnModel,r=t.name,o=t.eWrapper,i=t.eContainer,s=e?uu.LEFT:uu.RIGHT;this.forContainers([uu.CENTER,s],(function(){var t=n.getContainerWidth(s),a=e?"marginLeft":"marginRight";r===uu.CENTER?o.style[a]=t?"0px":"16px":i.style[a]=t?"16px":"0px"}))},e.prototype.addListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,(function(){return t.onScrollVisibilityChanged()})),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){return t.onDisplayedColumnsChanged()})),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){return t.onDisplayedColumnsWidthChanged()})),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_ROWS_CHANGED,(function(e){return t.onDisplayedRowsChanged(e.afterScroll)})),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()},e.prototype.listenOnDomOrder=function(){var t=this;if([uu.STICKY_TOP_CENTER,uu.STICKY_TOP_LEFT,uu.STICKY_TOP_RIGHT,uu.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)this.comp.setDomOrder(!0);else{var e=function(){var e=t.gridOptionsService.is("ensureDomOrder"),n=t.gridOptionsService.isDomLayout("print");t.comp.setDomOrder(e||n)};this.addManagedPropertyListener("domLayout",e),e()}},e.prototype.stopHScrollOnPinnedRows=function(){var t=this;this.forContainers([uu.TOP_CENTER,uu.STICKY_TOP_CENTER,uu.BOTTOM_CENTER],(function(){t.addManagedListener(t.eViewport,"scroll",(function(){return t.eViewport.scrollLeft=0}))}))},e.prototype.onDisplayedColumnsChanged=function(){var t=this;this.forContainers([uu.CENTER],(function(){return t.onHorizontalViewportChanged()}))},e.prototype.onDisplayedColumnsWidthChanged=function(){var t=this;this.forContainers([uu.CENTER],(function(){return t.onHorizontalViewportChanged()}))},e.prototype.onScrollVisibilityChanged=function(){var t=this,e=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===uu.CENTER){var n=this.scrollVisibleService.isHorizontalScrollShowing()?e:0,r=0==n?"100%":"calc(100% + "+n+"px)";this.animationFrameService.requestAnimationFrame((function(){return t.comp.setViewportHeight(r)}))}if(this.name===uu.FULL_WIDTH){var o="calc(100% - "+(qn()?16:0)+"px)";this.eContainer.style.setProperty("width",o)}},e.prototype.addPreventScrollWhileDragging=function(){var t=this,e=function(e){t.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc((function(){return t.eContainer.removeEventListener("touchmove",e)}))},e.prototype.onHorizontalViewportChanged=function(){var t=this.getCenterWidth(),e=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(t,e)},e.prototype.getCenterWidth=function(){return gr(this.eViewport)},e.prototype.getCenterViewportScrollLeft=function(){return wr(this.eViewport,this.enableRtl)},e.prototype.registerViewportResizeListener=function(t){var e=this.resizeObserverService.observeResize(this.eViewport,t);this.addDestroyFunc((function(){return e()}))},e.prototype.isViewportVisible=function(){return Er(this.eViewport)},e.prototype.getViewportScrollLeft=function(){return wr(this.eViewport,this.enableRtl)},e.prototype.isHorizontalScrollShowing=function(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||Dr(this.eViewport)},e.prototype.getViewportElement=function(){return this.eViewport},e.prototype.setContainerTranslateX=function(t){this.eContainer.style.transform="translateX("+t+"px)"},e.prototype.getHScrollPosition=function(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}},e.prototype.setCenterViewportScrollLeft=function(t){Cr(this.eViewport,t,this.enableRtl)},e.prototype.isContainerVisible=function(){return!e.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0},e.prototype.onPinnedWidthChanged=function(){var t=this.isContainerVisible();this.visible!=t&&(this.visible=t,this.onDisplayedRowsChanged()),qn()&&this.refreshPaddingForFakeScrollbar()},e.prototype.onDisplayedRowsChanged=function(t){var e=this;if(void 0===t&&(t=!1),this.visible){var n=this.gridOptionsService.isDomLayout("print"),r=this.getRowCtrls().filter((function(t){var r=t.isFullWidth(),o=e.embedFullWidthRows||n;return e.isFullWithContainer?!o&&r:o||!r}));this.comp.setRowCtrls(r,t)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)},e.prototype.getRowCtrls=function(){switch(this.name){case uu.TOP_CENTER:case uu.TOP_LEFT:case uu.TOP_RIGHT:case uu.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case uu.STICKY_TOP_CENTER:case uu.STICKY_TOP_LEFT:case uu.STICKY_TOP_RIGHT:case uu.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case uu.BOTTOM_CENTER:case uu.BOTTOM_LEFT:case uu.BOTTOM_RIGHT:case uu.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}},Fu([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Fu([$("dragService")],e.prototype,"dragService",void 0),Fu([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Fu([$("columnModel")],e.prototype,"columnModel",void 0),Fu([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Fu([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Fu([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Fu([Z],e.prototype,"postConstruct",null),e}(jt),Uu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qu='<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="'+uu.TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="'+uu.TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="'+uu.TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="'+uu.TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="'+uu.LEFT+'"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="'+uu.CENTER+'"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="'+uu.RIGHT+'"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="'+uu.FULL_WIDTH+'"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="'+uu.STICKY_TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="'+uu.STICKY_TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="'+uu.STICKY_TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="'+uu.STICKY_TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="'+uu.BOTTOM_LEFT+'"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="'+uu.BOTTOM_CENTER+'"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="'+uu.BOTTOM_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="'+uu.BOTTOM_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>',Xu=function(t){function e(){return t.call(this,qu)||this}return Uu(e,t),e.prototype.init=function(){var t=this,e=function(t,e){var n=t+"px";e.style.minHeight=n,e.style.height=n},n={setRowAnimationCssOnBodyViewport:function(e,n){return t.setRowAnimationCssOnBodyViewport(e,n)},setColumnCount:function(e){return gn(t.getGui(),e)},setRowCount:function(e){return dn(t.getGui(),e)},setTopHeight:function(n){return e(n,t.eTop)},setBottomHeight:function(n){return e(n,t.eBottom)},setTopDisplay:function(e){return t.eTop.style.display=e},setBottomDisplay:function(e){return t.eBottom.style.display=e},setStickyTopHeight:function(e){return t.eStickyTop.style.height=e},setStickyTopTop:function(e){return t.eStickyTop.style.top=e},setStickyTopWidth:function(e){return t.eStickyTop.style.width=e},setColumnMovingCss:function(e,n){return t.addOrRemoveCssClass(e,n)},updateLayoutClasses:function(e,n){[t.eBodyViewport.classList,t.eBodyClipper.classList,t.eBody.classList].forEach((function(t){t.toggle(il.AUTO_HEIGHT,n.autoHeight),t.toggle(il.NORMAL,n.normal),t.toggle(il.PRINT,n.print)})),t.addOrRemoveCssClass(il.AUTO_HEIGHT,n.autoHeight),t.addOrRemoveCssClass(il.NORMAL,n.normal),t.addOrRemoveCssClass(il.PRINT,n.print)},setAlwaysVerticalScrollClass:function(e,n){return t.eBodyViewport.classList.toggle("ag-force-vertical-scroll",n)},registerBodyViewportResizeListener:function(e){var n=t.resizeObserverService.observeResize(t.eBodyViewport,e);t.addDestroyFunc((function(){return n()}))},setPinnedTopBottomOverflowY:function(e){return t.eTop.style.overflowY=t.eBottom.style.overflowY=e},setCellSelectableCss:function(e,n){[t.eTop,t.eBodyViewport,t.eBottom].forEach((function(t){return t.classList.toggle(e,n)}))},setBodyViewportWidth:function(e){return t.eBodyViewport.style.width=e}};this.ctrl=this.createManagedBean(new kl),this.ctrl.setComp(n,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&hn(this.getGui(),!0)},e.prototype.setRowAnimationCssOnBodyViewport=function(t,e){var n=this.eBodyViewport.classList;n.toggle(El.ANIMATION_ON,e),n.toggle(El.ANIMATION_OFF,!e)},e.prototype.getFloatingTopBottom=function(){return[this.eTop,this.eBottom]},Wu([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Wu([tt("rangeService")],e.prototype,"rangeService",void 0),Wu([To("eBodyViewport")],e.prototype,"eBodyViewport",void 0),Wu([To("eStickyTop")],e.prototype,"eStickyTop",void 0),Wu([To("eTop")],e.prototype,"eTop",void 0),Wu([To("eBottom")],e.prototype,"eBottom",void 0),Wu([To("gridHeader")],e.prototype,"headerRootComp",void 0),Wu([To("eBodyClipper")],e.prototype,"eBodyClipper",void 0),Wu([To("eBody")],e.prototype,"eBody",void 0),Wu([Z],e.prototype,"init",null),e}(Eo),Ku=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ku(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))},e.prototype.onDisplayedColumnsChanged=function(){this.update()},e.prototype.onDisplayedColumnsWidthChanged=function(){this.update()},e.prototype.update=function(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)},e.prototype.updateImpl=function(){var t=this.ctrlsService.getCenterRowContainerCtrl();if(t){var e={horizontalScrollShowing:t.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(e)}},e.prototype.setScrollsVisible=function(t){if(this.horizontalScrollShowing!==t.horizontalScrollShowing||this.verticalScrollShowing!==t.verticalScrollShowing){this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing;var e={type:Yt.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(e)}},e.prototype.isHorizontalScrollShowing=function(){return this.horizontalScrollShowing},e.prototype.isVerticalScrollShowing=function(){return this.verticalScrollShowing},Yu([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Yu([Z],e.prototype,"postConstruct",null),e=Yu([J("scrollVisibleService")],e)}(jt),Qu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ju=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridInstanceId=n.gridInstanceSequence.next(),e}var n;return Qu(e,t),n=e,e.prototype.stampTopLevelGridCompWithGridInstance=function(t){t[n.GRID_DOM_KEY]=this.gridInstanceId},e.prototype.getRenderedCellForEvent=function(t){return Nt(this.gridOptionsService,t.target,ou.DOM_DATA_KEY_CELL_CTRL)},e.prototype.isEventFromThisGrid=function(t){return this.isElementInThisGrid(t.target)},e.prototype.isElementInThisGrid=function(t){for(var e=t;e;){var r=e[n.GRID_DOM_KEY];if(o(r))return r===this.gridInstanceId;e=e.parentElement}return!1},e.prototype.getCellPositionForEvent=function(t){var e=this.getRenderedCellForEvent(t);return e?e.getCellPosition():null},e.prototype.getNormalisedPosition=function(t){var e,n,r=this.gridOptionsService.isDomLayout("normal"),o=t;if(null!=o.clientX||null!=o.clientY?(e=o.clientX,n=o.clientY):(e=o.x,n=o.y),r){var i=this.ctrlsService.getGridBodyCtrl(),s=i.getScrollFeature().getVScrollPosition();e+=i.getScrollFeature().getHScrollPosition().left,n+=s.top}return{x:e,y:n}},e.gridInstanceSequence=new co,e.GRID_DOM_KEY="__ag_grid_instance",Ju([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=n=Ju([J("mouseEventService")],e)}(jt),tc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ec=function(){return(ec=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},nc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},rc=function(t){function e(){var e=t.call(this)||this;return e.onPageDown=G(e.onPageDown,100),e.onPageUp=G(e.onPageUp,100),e}return tc(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.gridBodyCon=e.gridBodyCtrl}))},e.prototype.handlePageScrollingKey=function(t,e){void 0===e&&(e=!1);var n=t.key,r=t.altKey,o=t.ctrlKey||t.metaKey,i=!!this.rangeService&&t.shiftKey,s=this.mouseEventService.getCellPositionForEvent(t),a=!1;switch(n){case Yr.PAGE_HOME:case Yr.PAGE_END:o||r||(this.onHomeOrEndKey(n),a=!0);break;case Yr.LEFT:case Yr.RIGHT:case Yr.UP:case Yr.DOWN:if(!s)return!1;!o||r||i||(this.onCtrlUpDownLeftRight(n,s),a=!0);break;case Yr.PAGE_DOWN:case Yr.PAGE_UP:o||r||(a=this.handlePageUpDown(n,s,e))}return a&&t.preventDefault(),a},e.prototype.handlePageUpDown=function(t,e,n){return n&&(e=this.focusService.getFocusedCell()),!!e&&(t===Yr.PAGE_UP?this.onPageUp(e):this.onPageDown(e),!0)},e.prototype.navigateTo=function(t){var e=t.scrollIndex,n=t.scrollType,r=t.scrollColumn,i=t.focusIndex,s=t.focusColumn;if(o(r)&&!r.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(r),o(e)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e,n),t.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(i),this.focusService.setFocusedCell({rowIndex:i,column:s,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){var a={rowIndex:i,rowPinned:null,column:s};this.rangeService.setRangeToCell(a)}},e.prototype.onPageDown=function(t){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.getViewportHeight(),r=this.paginationProxy.getPixelOffset(),o=e.top+n,i=this.paginationProxy.getRowIndexAtPixel(o+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(t,i):this.navigateToNextPage(t,i)},e.prototype.onPageUp=function(t){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.paginationProxy.getPixelOffset(),r=e.top,o=this.paginationProxy.getRowIndexAtPixel(r+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(t,o,!0):this.navigateToNextPage(t,o,!0)},e.prototype.navigateToNextPage=function(t,e,n){void 0===n&&(n=!1);var r,o=this.getViewportHeight(),i=this.paginationProxy.getPageFirstRow(),s=this.paginationProxy.getPageLastRow(),a=this.paginationProxy.getPixelOffset(),l=this.paginationProxy.getRow(t.rowIndex),u=n?(null===l||void 0===l?void 0:l.rowHeight)-o-a:o-a,c=(null===l||void 0===l?void 0:l.rowTop)+u,p=this.paginationProxy.getRowIndexAtPixel(c+a);if(p===t.rowIndex){var h=n?-1:1;e=p=t.rowIndex+h}n?(r="bottom",p<i&&(p=i),e<i&&(e=i)):(r="top",p>s&&(p=s),e>s&&(e=s)),this.isRowTallerThanView(p)&&(e=p,r="top"),this.navigateTo({scrollIndex:e,scrollType:r,scrollColumn:null,focusIndex:p,focusColumn:t.column})},e.prototype.navigateToNextPageWithAutoHeight=function(t,e,n){var r=this;void 0===n&&(n=!1),this.navigateTo({scrollIndex:e,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:e,focusColumn:t.column}),setTimeout((function(){var o=r.getNextFocusIndexForAutoHeight(t,n);r.navigateTo({scrollIndex:e,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:o,focusColumn:t.column,isAsync:!0})}),50)},e.prototype.getNextFocusIndexForAutoHeight=function(t,e){var n;void 0===e&&(e=!1);for(var r=e?-1:1,o=this.getViewportHeight(),i=this.paginationProxy.getPageLastRow(),s=0,a=t.rowIndex;a>=0&&a<=i;){var l=this.paginationProxy.getRow(a);if(l){var u=null!==(n=l.rowHeight)&&void 0!==n?n:0;if(s+u>o)break;s+=u}a+=r}return Math.max(0,Math.min(a,i))},e.prototype.getViewportHeight=function(){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),e=this.gridOptionsService.getScrollbarWidth(),n=t.bottom-t.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(n-=e),n},e.prototype.isRowTallerThanView=function(t){var e=this.paginationProxy.getRow(t);if(!e)return!1;var n=e.rowHeight;return"number"===typeof n&&n>this.getViewportHeight()},e.prototype.onCtrlUpDownLeftRight=function(t,e){var n=this.cellNavigationService.getNextCellToFocus(t,e,!0),r=n.rowIndex,o=n.column;this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:o,focusIndex:r,focusColumn:o})},e.prototype.onHomeOrEndKey=function(t){var e=t===Yr.PAGE_HOME,n=this.columnModel.getAllDisplayedColumns(),r=e?n[0]:yt(n),o=e?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:r,focusIndex:o,focusColumn:r})},e.prototype.onTabKeyDown=function(t,e){var n=e.shiftKey;if(this.tabToNextCellCommon(t,n,e))e.preventDefault();else if(n){var r=t.getRowPosition(),o=r.rowIndex;(r.rowPinned?0===o:o===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(e.preventDefault(),this.focusService.focusPreviousFromFirstCell(e)))}else t instanceof ou&&t.focusCell(!0),this.focusService.focusNextGridCoreContainer(n)&&e.preventDefault()},e.prototype.tabToNextCell=function(t,e){var n=this.focusService.getFocusedCell();if(!n)return!1;var r=this.getCellByPosition(n);return!!(r||(r=this.rowRenderer.getRowByPosition(n))&&r.isFullWidth())&&this.tabToNextCellCommon(r,t,e)},e.prototype.tabToNextCellCommon=function(t,e,n){var r=t.isEditing();if(!r&&t instanceof ou){var o=t.getRowCtrl();o&&(r=o.isEditing())}return(r?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(t,e,n):this.moveToNextEditingCell(t,e,n):this.moveToNextCellNotEditing(t,e))||!!this.focusService.getFocusedHeader()},e.prototype.moveToNextEditingCell=function(t,e,n){void 0===n&&(n=null);var r=t.getCellPosition();t.getGui().focus(),t.stopEditing();var o=this.findNextCellToFocusOn(r,e,!0);return null!=o&&(o.startEditing(null,!0,n),o.focusCell(!1),!0)},e.prototype.moveToNextEditingRow=function(t,e,n){void 0===n&&(n=null);var r=t.getCellPosition(),o=this.findNextCellToFocusOn(r,e,!0);if(null==o)return!1;var i=o.getCellPosition(),s=this.isCellEditable(r),a=this.isCellEditable(i),l=i&&r.rowIndex===i.rowIndex&&r.rowPinned===i.rowPinned;(s&&t.setFocusOutOnEditor(),l)||(t.getRowCtrl().stopEditing(),o.getRowCtrl().startRowEditing(void 0,void 0,n));return a?(o.setFocusInOnEditor(),o.focusCell()):o.focusCell(!0),!0},e.prototype.moveToNextCellNotEditing=function(t,e){var n,r=this.columnModel.getAllDisplayedColumns();n=t instanceof hu?ec(ec({},t.getRowPosition()),{column:e?r[0]:yt(r)}):t.getCellPosition();var i=this.findNextCellToFocusOn(n,e,!1);if(i instanceof ou)i.focusCell(!0);else if(i)return this.tryToFocusFullWidthRow(i.getRowPosition(),e);return o(i)},e.prototype.findNextCellToFocusOn=function(t,e,n){for(var r=t;;){t!==r&&(t=r),e||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,e);var i=this.gridOptionsService.getCallback("tabToNextCell");if(o(i)){var s=i({backwards:e,editing:n,previousCellPosition:t,nextCellPosition:r||null});o(s)?(s.floating&&(O((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),s.rowPinned=s.floating),r={rowIndex:s.rowIndex,column:s.column,rowPinned:s.rowPinned}):r=null}if(!r)return null;if(r.rowIndex<0){var a=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+r.rowIndex,column:r.column},fromCell:!0}),null}var l="fullRow"===this.gridOptionsService.get("editType");if(n&&!l)if(!this.isCellEditable(r))continue;this.ensureCellVisible(r);var u=this.getCellByPosition(r);if(!u){var c=this.rowRenderer.getRowByPosition(r);if(!c||!c.isFullWidth()||n)continue;return c}if(!u.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(r),u}},e.prototype.isCellEditable=function(t){var e=this.lookupRowNodeForCell(t);return!!e&&t.column.isCellEditable(e)},e.prototype.getCellByPosition=function(t){var e=this.rowRenderer.getRowByPosition(t);return e?e.getCellCtrl(t.column):null},e.prototype.lookupRowNodeForCell=function(t){return"top"===t.rowPinned?this.pinnedRowModel.getPinnedTopRow(t.rowIndex):"bottom"===t.rowPinned?this.pinnedRowModel.getPinnedBottomRow(t.rowIndex):this.paginationProxy.getRow(t.rowIndex)},e.prototype.navigateToNextCell=function(t,e,n,r){for(var s=n,a=!1;s&&(s===n||!this.isValidNavigateCell(s));)this.gridOptionsService.is("enableRtl")?e===Yr.LEFT&&(s=this.getLastCellOfColSpan(s)):e===Yr.RIGHT&&(s=this.getLastCellOfColSpan(s)),a=i(s=this.cellNavigationService.getNextCellToFocus(e,s));if(a&&t&&t.key===Yr.UP&&(s={rowIndex:-1,rowPinned:null,column:n.column}),r){var l=this.gridOptionsService.getCallback("navigateToNextCell");if(o(l)){var u=l({key:e,previousCellPosition:n,nextCellPosition:s||null,event:t});o(u)?(u.floating&&(O((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),u.rowPinned=u.floating),s={rowPinned:u.rowPinned,rowIndex:u.rowIndex,column:u.column}):s=null}}if(s)if(s.rowIndex<0){var c=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:c+s.rowIndex,column:n.column},event:t||void 0,fromCell:!0})}else{var p=this.getNormalisedPosition(s);p?this.focusPosition(p):this.tryToFocusFullWidthRow(s)}},e.prototype.getNormalisedPosition=function(t){this.ensureCellVisible(t);var e=this.getCellByPosition(t);return e?(t=e.getCellPosition(),this.ensureCellVisible(t),t):null},e.prototype.tryToFocusFullWidthRow=function(t,e){void 0===e&&(e=!1);var n=this.columnModel.getAllDisplayedColumns(),r=this.rowRenderer.getRowByPosition(t);if(!r||!r.isFullWidth())return!1;var o=this.focusService.getFocusedCell(),i={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column||(e?yt(n):n[0])};this.focusPosition(i);var s=null!=o&&this.rowPositionUtils.before(i,o),a={type:Yt.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:i.rowIndex,rowPinned:i.rowPinned,column:i.column,isFullWidthCell:!0,floating:i.rowPinned,fromBelow:s};return this.eventService.dispatchEvent(a),!0},e.prototype.focusPosition=function(t){this.focusService.setFocusedCell({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(t)},e.prototype.isValidNavigateCell=function(t){return!!this.rowPositionUtils.getRowNode(t)},e.prototype.getLastCellOfColSpan=function(t){var e=this.getCellByPosition(t);if(!e)return t;var n=e.getColSpanningList();return 1===n.length?t:{rowIndex:t.rowIndex,column:yt(n),rowPinned:t.rowPinned}},e.prototype.ensureCellVisible=function(t){var e=this.gridOptionsService.isGroupRowsSticky(),n=this.rowModel.getRow(t.rowIndex);!(e&&(null===n||void 0===n?void 0:n.sticky))&&i(t.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t.rowIndex),t.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(t.column)},nc([$("mouseEventService")],e.prototype,"mouseEventService",void 0),nc([$("paginationProxy")],e.prototype,"paginationProxy",void 0),nc([$("focusService")],e.prototype,"focusService",void 0),nc([tt("rangeService")],e.prototype,"rangeService",void 0),nc([$("columnModel")],e.prototype,"columnModel",void 0),nc([$("rowModel")],e.prototype,"rowModel",void 0),nc([$("ctrlsService")],e.prototype,"ctrlsService",void 0),nc([$("rowRenderer")],e.prototype,"rowRenderer",void 0),nc([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),nc([$("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),nc([$("cellNavigationService")],e.prototype,"cellNavigationService",void 0),nc([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),nc([Z],e.prototype,"postConstruct",null),e=nc([J("navigationService")],e)}(jt),oc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ic=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},sc=function(t){function e(e){var n=t.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')||this;return n.params=e,n}return oc(e,t),e.prototype.postConstruct=function(){this.gridOptionsService.setDomData(this.getGui(),e.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()},e.prototype.addKeyDownListener=function(){var t=this,e=this.getGui(),n=this.params;this.addManagedListener(e,"keydown",(function(e){Qr(t.gridOptionsService,e,n.node,n.column,!0)||n.onKeyDown(e)}))},e.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",ic([Z],e.prototype,"postConstruct",null),e}(hs),ac=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lc=function(t){function e(e,n,r,o,i){var s=t.call(this)||this;s.rendererVersion=0,s.editorVersion=0,s.beans=e,s.column=n.getColumn(),s.rowNode=n.getRowNode(),s.rowCtrl=n.getRowCtrl(),s.eRow=o,s.cellCtrl=n,s.setTemplate('<div comp-id="'+s.getCompId()+'"/>');var a=s.getGui();s.forceWrapper=n.isForceWrapper(),s.refreshWrapper(!1);var l=function(t,e){null!=e&&""!=e?a.setAttribute(t,e):a.removeAttribute(t)};Ye(a,"gridcell"),l("col-id",n.getColumnIdSanitised());var u=n.getTabIndex();void 0!==u&&l("tabindex",u.toString());var c={addOrRemoveCssClass:function(t,e){return s.addOrRemoveCssClass(t,e)},setUserStyles:function(t){return Ar(a,t)},getFocusableElement:function(){return s.getFocusableElement()},setIncludeSelection:function(t){return s.includeSelection=t},setIncludeRowDrag:function(t){return s.includeRowDrag=t},setIncludeDndSource:function(t){return s.includeDndSource=t},setRenderDetails:function(t,e,n){return s.setRenderDetails(t,e,n)},setEditDetails:function(t,e,n){return s.setEditDetails(t,e,n)},getCellEditor:function(){return s.cellEditor||null},getCellRenderer:function(){return s.cellRenderer||null},getParentOfValue:function(){return s.getParentOfValue()}};return n.setComp(c,s.getGui(),s.eCellWrapper,r,i),s}return ac(e,t),e.prototype.getParentOfValue=function(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()},e.prototype.setRenderDetails=function(t,e,n){if(!(this.cellEditor&&!this.cellEditorPopupWrapper)){this.firstRender=null==this.firstRender;var r=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),t)!(n||r)&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t));else this.destroyRenderer(),this.insertValueWithoutCellRenderer(e)}},e.prototype.setEditDetails=function(t,e,n){t?this.createCellEditorInstance(t,e,n):this.destroyEditor()},e.prototype.removeControls=function(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)},e.prototype.refreshWrapper=function(t){var e=this.includeRowDrag||this.includeDndSource||this.includeSelection,n=e||this.forceWrapper,r=n&&null==this.eCellWrapper;r&&(this.eCellWrapper=Sr('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));var o=!n&&null!=this.eCellWrapper;o&&(xr(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!n);var i=!t&&n,s=i&&null==this.eCellValue;s&&(this.eCellValue=Sr('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));var a=!i&&null!=this.eCellValue;a&&(xr(this.eCellValue),this.eCellValue=void 0);var l=r||o||s||a;return l&&this.removeControls(),t||e&&this.addControls(),l},e.prototype.addControls=function(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))},e.prototype.createCellEditorInstance=function(t,e,n){var r=this,o=this.editorVersion,s=t.newAgStackInstance();if(s){var a=t.params;s.then((function(t){return r.afterCellEditorCreated(o,t,a,e,n)})),i(this.cellEditor)&&a.cellStartedEdit&&this.cellCtrl.focusCell(!0)}},e.prototype.insertValueWithoutCellRenderer=function(t){var e=this.getParentOfValue();br(e);var n=null!=t?re(t):null;null!=n&&(e.innerHTML=n)},e.prototype.destroyEditorAndRenderer=function(){this.destroyRenderer(),this.destroyEditor()},e.prototype.destroyRenderer=function(){var t=this.beans.context;this.cellRenderer=t.destroyBean(this.cellRenderer),xr(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++},e.prototype.destroyEditor=function(){var t=this.beans.context;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),xr(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++},e.prototype.refreshCellRenderer=function(t){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==t.componentClass)return!1;var e=this.cellRenderer.refresh(t.params);return!0===e||void 0===e},e.prototype.createCellRendererInstance=function(t){var e=this,n=!this.beans.gridOptionsService.is("suppressAnimationFrame"),r=this.rendererVersion,o=t.componentClass,i=function(){if(!(e.rendererVersion!==r||!e.isAlive())){var n=t.newAgStackInstance(),i=e.afterCellRendererCreated.bind(e,r,o);n&&n.then(i)}};n&&this.firstRender?this.beans.animationFrameService.createTask(i,this.rowNode.rowIndex,"createTasksP2"):i()},e.prototype.getCtrl=function(){return this.cellCtrl},e.prototype.getRowCtrl=function(){return this.rowCtrl},e.prototype.getCellRenderer=function(){return this.cellRenderer},e.prototype.getCellEditor=function(){return this.cellEditor},e.prototype.afterCellRendererCreated=function(t,e,n){if(!this.isAlive()||t!==this.rendererVersion)this.beans.context.destroyBean(n);else if(this.cellRenderer=n,this.cellRendererClass=e,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){var r=this.getParentOfValue();br(r),r.appendChild(this.cellRendererGui)}},e.prototype.afterCellEditorCreated=function(t,e,n,r,o){if(t!==this.editorVersion)this.beans.context.destroyBean(e);else{if(e.isCancelBeforeStart&&e.isCancelBeforeStart())return this.beans.context.destroyBean(e),void this.cellCtrl.stopEditing(!0);if(!e.getGui)return console.warn("AG Grid: cellEditor for column "+this.column.getId()+" is missing getGui() method"),void this.beans.context.destroyBean(e);this.cellEditor=e,this.cellEditorGui=e.getGui();var i=r||void 0!==e.isPopup&&e.isPopup();i?this.addPopupCellEditor(n,o):this.addInCellEditor(),this.refreshEditStyles(!0,i),e.afterGuiAttached&&e.afterGuiAttached()}},e.prototype.refreshEditStyles=function(t,e){var n;this.addOrRemoveCssClass("ag-cell-inline-editing",t&&!e),this.addOrRemoveCssClass("ag-cell-popup-editing",t&&!!e),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!t||!!e),null===(n=this.rowCtrl)||void 0===n||n.setInlineEditingCss(t)},e.prototype.addInCellEditor=function(){var t=this.getGui(),e=this.beans.gridOptionsService.getDocument();(t.contains(e.activeElement)&&t.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui)&&this.getParentOfValue().appendChild(this.cellEditorGui)},e.prototype.addPopupCellEditor=function(t,e){var n=this;"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var r=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new sc(t));var o=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&o.appendChild(this.cellEditorGui);var i=this.beans.popupService,s=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),a=null!=e?e:r.getPopupPosition?r.getPopupPosition():"over",l=this.beans.gridOptionsService.is("enableRtl"),u={ePopup:o,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:a,alignSide:l?"right":"left",keepWithinBounds:!0},c=i.positionPopupByComponent.bind(i,u),p=this.beans.localeService.getLocaleTextFunc(),h=i.addPopup({modal:s,eChild:o,closeOnEsc:!0,closedCallback:function(){n.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:p("ariaLabelCellEditor","Cell Editor")});h&&(this.hideEditorPopup=h.hideFunc)},e.prototype.detach=function(){this.eRow.removeChild(this.getGui())},e.prototype.destroy=function(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),t.prototype.destroy.call(this)},e.prototype.clearParentOfValue=function(){var t=this.getGui(),e=this.beans.gridOptionsService.getDocument();t.contains(e.activeElement)&&Bn()&&t.focus({preventScroll:!0}),br(this.getParentOfValue())},e}(Eo),uc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),cc=function(t){function e(e,n,r){var o=t.call(this)||this;o.cellComps={},o.beans=n,o.rowCtrl=e,o.setTemplate('<div comp-id="'+o.getCompId()+'" style="'+o.getInitialStyle(r)+'"/>');var i=o.getGui(),s=i.style;o.domOrder=o.rowCtrl.getDomOrder(),Ye(i,"row");var a=o.rowCtrl.getTabIndex();null!=a&&i.setAttribute("tabindex",a.toString());var l={setDomOrder:function(t){return o.domOrder=t},setCellCtrls:function(t){return o.setCellCtrls(t)},showFullWidth:function(t){return o.showFullWidth(t)},getFullWidthCellRenderer:function(){return o.getFullWidthCellRenderer()},addOrRemoveCssClass:function(t,e){return o.addOrRemoveCssClass(t,e)},setUserStyles:function(t){return Ar(i,t)},setTop:function(t){return s.top=t},setTransform:function(t){return s.transform=t},setRowIndex:function(t){return i.setAttribute("row-index",t)},setRowId:function(t){return i.setAttribute("row-id",t)},setRowBusinessKey:function(t){return i.setAttribute("row-business-key",t)}};return e.setComp(l,o.getGui(),r),o.addDestroyFunc((function(){e.unsetComp(r)})),o}return uc(e,t),e.prototype.getInitialStyle=function(t){var e=this.rowCtrl.getInitialTransform(t),n=this.rowCtrl.getInitialRowTop(t);return e?"transform: "+e:"top: "+n},e.prototype.showFullWidth=function(t){var e=this,n=t.newAgStackInstance();n&&n.then((function(t){if(e.isAlive()){var n=t.getGui();e.getGui().appendChild(n),e.rowCtrl.setupDetailRowAutoHeight(n),e.setFullWidthRowComp(t)}else e.beans.context.destroyBean(t)}))},e.prototype.setCellCtrls=function(t){var e=this,n=Object.assign({},this.cellComps);t.forEach((function(t){var r=t.getInstanceId();null==e.cellComps[r]?e.newCellComp(t):n[r]=null}));var r=b(n).filter((function(t){return null!=t}));this.destroyCells(r),this.ensureDomOrder(t)},e.prototype.ensureDomOrder=function(t){var e=this;if(this.domOrder){var n=[];t.forEach((function(t){var r=e.cellComps[t.getInstanceId()];r&&n.push(r.getGui())})),Or(this.getGui(),n)}},e.prototype.newCellComp=function(t){var e=new lc(this.beans,t,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[t.getInstanceId()]=e,this.getGui().appendChild(e.getGui())},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.destroyAllCells()},e.prototype.destroyAllCells=function(){var t=b(this.cellComps).filter((function(t){return null!=t}));this.destroyCells(t)},e.prototype.setFullWidthRowComp=function(t){var e=this;this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=t,this.addDestroyFunc((function(){e.fullWidthCellRenderer=e.beans.context.destroyBean(e.fullWidthCellRenderer)}))},e.prototype.getFullWidthCellRenderer=function(){return this.fullWidthCellRenderer},e.prototype.destroyCells=function(t){var e=this;t.forEach((function(t){if(t){var n=t.getCtrl().getInstanceId();e.cellComps[n]===t&&(t.detach(),t.destroy(),e.cellComps[n]=null)}}))},e}(Eo),pc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hc=function(){return(hc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},dc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};var fc,gc=function(t){function e(){var e=t.call(this,function(){var t=Eo.elementGettingCreated.getAttribute("name"),e=Hu.getRowContainerCssClasses(t),n=t===uu.CENTER,r=t===uu.TOP_CENTER||t===uu.STICKY_TOP_CENTER||t===uu.BOTTOM_CENTER;return n?'<div class="'+e.wrapper+'" ref="eWrapper" role="presentation">\n                <div class="'+e.viewport+'" ref="eViewport" role="presentation">\n                    <div class="'+e.container+'" ref="eContainer"></div>\n                </div>\n            </div>':r?'<div class="'+e.viewport+'" ref="eViewport" role="presentation">\n                <div class="'+e.container+'" ref="eContainer"></div>\n            </div>':'<div class="'+e.container+'" ref="eContainer"></div>'}())||this;return e.rowComps={},e.name=Eo.elementGettingCreated.getAttribute("name"),e.type=Bu(e.name),e}return pc(e,t),e.prototype.postConstruct=function(){var t=this,e={setViewportHeight:function(e){return t.eViewport.style.height=e},setRowCtrls:function(e){return t.setRowCtrls(e)},setDomOrder:function(e){t.domOrder=e},setContainerWidth:function(e){return t.eContainer.style.width=e}};this.createManagedBean(new Hu(this.name)).setComp(e,this.eContainer,this.eViewport,this.eWrapper)},e.prototype.preDestroy=function(){this.setRowCtrls([])},e.prototype.setRowCtrls=function(t){var e=this,n=hc({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;t.forEach((function(t){var r=t.getInstanceId(),o=n[r];if(o)e.rowComps[r]=o,delete n[r],e.ensureDomOrder(o.getGui());else{if(!t.getRowNode().displayed)return;var i=new cc(t,e.beans,e.type);e.rowComps[r]=i,e.appendRow(i.getGui())}})),b(n).forEach((function(t){e.eContainer.removeChild(t.getGui()),t.destroy()})),Ye(this.eContainer,t.length?"rowgroup":"presentation")},e.prototype.appendRow=function(t){this.domOrder?Ir(this.eContainer,t,this.lastPlacedElement):this.eContainer.appendChild(t),this.lastPlacedElement=t},e.prototype.ensureDomOrder=function(t){this.domOrder&&(Pr(this.eContainer,t,this.lastPlacedElement),this.lastPlacedElement=t)},dc([$("beans")],e.prototype,"beans",void 0),dc([To("eViewport")],e.prototype,"eViewport",void 0),dc([To("eContainer")],e.prototype,"eContainer",void 0),dc([To("eWrapper")],e.prototype,"eWrapper",void 0),dc([Z],e.prototype,"postConstruct",null),dc([Q],e.prototype,"preDestroy",null),e}(Eo),mc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},yc=function(){function t(t){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=t}return t.prototype.onDragEnter=function(t){var e=this;if(this.clearColumnsList(),!this.gridOptionsService.is("functionsReadOnly")){var n=t.dragItem.columns;n&&n.forEach((function(t){t.isPrimary()&&(t.isAnyFunctionActive()||(t.isAllowValue()?e.columnsToAggregate.push(t):t.isAllowRowGroup()?e.columnsToGroup.push(t):t.isAllowPivot()&&e.columnsToPivot.push(t)))}))}},t.prototype.getIconName=function(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?zs.ICON_PINNED:zs.ICON_MOVE:null},t.prototype.onDragLeave=function(t){this.clearColumnsList()},t.prototype.clearColumnsList=function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0},t.prototype.onDragging=function(t){},t.prototype.onDragStop=function(t){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")},mc([$("columnModel")],t.prototype,"columnModel",void 0),mc([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),t}(),vc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_c=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},wc=function(){function t(t,e){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=t,this.eContainer=e,this.centerContainer=!o(t)}return t.prototype.init=function(){var t=this;this.ctrlsService.whenReady((function(){t.gridBodyCon=t.ctrlsService.getGridBodyCtrl()}))},t.prototype.getIconName=function(){return this.pinned?zs.ICON_PINNED:zs.ICON_MOVE},t.prototype.onDragEnter=function(t){var e=t.dragItem.columns;if(t.dragSource.type===Gi.ToolPanel)this.setColumnsVisible(e,!0,"uiColumnDragged");else{var n=t.dragItem.visibleState,r=(e||[]).filter((function(t){return n[t.getId()]}));this.setColumnsVisible(r,!0,"uiColumnDragged")}this.setColumnsPinned(e,this.pinned,"uiColumnDragged"),this.onDragging(t,!0,!0)},t.prototype.onDragLeave=function(){this.ensureIntervalCleared(),this.lastMovedInfo=null},t.prototype.setColumnsVisible=function(t,e,n){if(void 0===n&&(n="api"),t){var r=t.filter((function(t){return!t.getColDef().lockVisible}));this.columnModel.setColumnsVisible(r,e,n)}},t.prototype.setColumnsPinned=function(t,e,n){if(void 0===n&&(n="api"),t){var r=t.filter((function(t){return!t.getColDef().lockPinned}));this.columnModel.setColumnsPinned(r,e,n)}},t.prototype.onDragStop=function(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null},t.prototype.normaliseX=function(t){this.gridOptionsService.is("enableRtl")&&(t=this.eContainer.clientWidth-t);return this.centerContainer&&(t+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),t},t.prototype.checkCenterForScrolling=function(t){if(this.centerContainer){var e=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),n=e+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=t<e+50,this.needToMoveLeft=t>n-50):(this.needToMoveLeft=t<e+50,this.needToMoveRight=t>n-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}},t.prototype.onDragging=function(t,e,n,r){var o,s=this;if(void 0===t&&(t=this.lastDraggingEvent),void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===r&&(r=!1),r){if(this.lastMovedInfo){var a=this.lastMovedInfo,l=a.columns,u=a.toIndex;this.moveColumns(l,u,"uiColumnMoved",!0)}}else if(this.lastDraggingEvent=t,!i(t.hDirection)){var c=this.normaliseX(t.x);e||this.checkCenterForScrolling(c);var p=this.normaliseDirection(t.hDirection),h=t.dragSource.type,d=(null===(o=t.dragSource.getDragItem().columns)||void 0===o?void 0:o.filter((function(t){return!t.getColDef().lockPinned||t.getPinned()==s.pinned})))||[];this.attemptMoveColumns({dragSourceType:h,allMovingColumns:d,hDirection:p,mouseX:c,fromEnter:e,fakeEvent:n})}},t.prototype.normaliseDirection=function(t){if(!this.gridOptionsService.is("enableRtl"))return t;switch(t){case Vi.Left:return Vi.Right;case Vi.Right:return Vi.Left;default:console.error("AG Grid: Unknown direction "+t)}},t.prototype.attemptMoveColumns=function(t){var e=t.dragSourceType,n=t.hDirection,r=t.mouseX,o=t.fromEnter,i=t.fakeEvent,s=n===Vi.Left,a=n===Vi.Right,l=t.allMovingColumns;if(e===Gi.HeaderCell){var u=[];l.forEach((function(t){for(var e,n=null,r=t.getParent();null!=r&&1===r.getDisplayedLeafColumns().length;)n=r,r=r.getParent();null!=n?(!!(null===(e=n.getColGroupDef())||void 0===e?void 0:e.marryChildren)?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns()).forEach((function(t){u.includes(t)||u.push(t)})):u.includes(t)||u.push(t)})),l=u}var c=l.slice();this.columnModel.sortColumnsLikeGridColumns(c);var p=this.calculateValidMoves(c,a,r),h=this.calculateOldIndex(c);if(0!==p.length){var d=p[0],f=null!==h&&!o;if(e==Gi.HeaderCell&&(f=null!==h),f&&!i){if(s&&d>=h)return;if(a&&d<=h)return}for(var g=this.columnModel.getAllDisplayedColumns(),m=[],y=null,v=0;v<p.length;v++){var _=p[v],w=this.columnModel.getProposedColumnOrder(c,_);if(this.columnModel.doesOrderPassRules(w)){var C=w.filter((function(t){return g.includes(t)}));if(null===y)y=C;else if(!uo.areEqual(C,y))break;var b=this.groupFragCount(w);m.push({move:_,fragCount:b})}}0!==m.length&&(m.sort((function(t,e){return t.fragCount-e.fragCount})),this.moveColumns(l,m[0].move,"uiColumnMoved",!1))}},t.prototype.calculateOldIndex=function(t){var e=this.columnModel.getAllGridColumns(),n=_t(t.map((function(t){return e.indexOf(t)}))),r=n[0];return yt(n)-r!==n.length-1?null:r},t.prototype.moveColumns=function(t,e,n,r){this.columnModel.moveColumns(t,e,n,r),this.lastMovedInfo=r?null:{columns:t,toIndex:e}},t.prototype.groupFragCount=function(t){function e(t){for(var e=[],n=t.getOriginalParent();null!=n;)e.push(n),n=n.getOriginalParent();return e}for(var n=0,r=function(r){var o,i=e(t[r]),s=e(t[r+1]);i=(o=_c(i.length>s.length?[i,s]:[s,i],2))[0],s=o[1],i.forEach((function(t){-1===s.indexOf(t)&&n++}))},o=0;o<t.length-1;o++)r(o);return n},t.prototype.calculateValidMoves=function(t,e,n){if(this.gridOptionsService.is("suppressMovableColumns")||t.some((function(t){return t.getColDef().suppressMovable})))return[];var r,o=this.columnModel.getDisplayedColumns(this.pinned),i=this.columnModel.getAllGridColumns(),s=o.filter((function(e){return Tt(t,e)})),a=o.filter((function(e){return!Tt(t,e)})),l=i.filter((function(e){return!Tt(t,e)})),u=0,c=n;if(e){var p=0;s.forEach((function(t){return p+=t.getActualWidth()})),c-=p}if(c>0){for(var h=0;h<a.length;h++){if((c-=a[h].getActualWidth())<0)break;u++}e&&u++}if(u>0){var d=a[u-1];r=l.indexOf(d)+1}else-1===(r=l.indexOf(a[0]))&&(r=0);var f=[r],g=function(t,e){return t-e};if(e){for(var m=r+1,y=i.length-1;m<=y;)f.push(m),m++;f.sort(g)}else{m=r,y=i.length-1;for(var v=i[m];m<=y&&this.isColumnHidden(o,v);)m++,f.push(m),v=i[m];m=r-1;for(;m>=0;)f.push(m),m--;f.sort(g).reverse()}return f},t.prototype.isColumnHidden=function(t,e){return t.indexOf(e)<0},t.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(zs.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(zs.ICON_RIGHT,!0))},t.prototype.ensureIntervalCleared=function(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(zs.ICON_MOVE))},t.prototype.moveInterval=function(){var t;this.intervalCount++,(t=10+5*this.intervalCount)>100&&(t=100);var e=null,n=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?e=n.scrollHorizontally(-t):this.needToMoveRight&&(e=n.scrollHorizontally(t)),0!==e)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var r=this.lastDraggingEvent.dragItem.columns.filter((function(t){return!t.getColDef().lockPinned}));if(r.length>0&&(this.dragAndDropService.setGhostIcon(zs.ICON_PINNED),this.failedMoveAttempts>7)){var o=this.needToMoveLeft?"left":"right";this.setColumnsPinned(r,o,"uiColumnDragged"),this.dragAndDropService.nudge()}}},vc([$("columnModel")],t.prototype,"columnModel",void 0),vc([$("dragAndDropService")],t.prototype,"dragAndDropService",void 0),vc([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),vc([$("ctrlsService")],t.prototype,"ctrlsService",void 0),vc([Z],t.prototype,"init",null),t}(),Cc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xc=function(t){function e(e,n){var r=t.call(this)||this;return r.pinned=e,r.eContainer=n,r}return Cc(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){switch(t.pinned){case"left":t.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.leftRowContainerCtrl.getContainerElement()],[e.bottomLeftRowContainerCtrl.getContainerElement()],[e.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":t.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.rightRowContainerCtrl.getContainerElement()],[e.bottomRightRowContainerCtrl.getContainerElement()],[e.topRightRowContainerCtrl.getContainerElement()]];break;default:t.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.centerRowContainerCtrl.getViewportElement()],[e.bottomCenterRowContainerCtrl.getViewportElement()],[e.topCenterRowContainerCtrl.getViewportElement()]]}}))},e.prototype.isInterestedIn=function(t){return t===Gi.HeaderCell||t===Gi.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")},e.prototype.getSecondaryContainers=function(){return this.eSecondaryContainers},e.prototype.getContainer=function(){return this.eContainer},e.prototype.init=function(){this.moveColumnFeature=this.createManagedBean(new wc(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new yc(this.pinned)),this.dragAndDropService.addDropTarget(this)},e.prototype.getIconName=function(){return this.currentDropListener.getIconName()},e.prototype.isDropColumnInPivotMode=function(t){return this.columnModel.isPivotMode()&&t.dragSource.type===Gi.ToolPanel},e.prototype.onDragEnter=function(t){this.currentDropListener=this.isDropColumnInPivotMode(t)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(t)},e.prototype.onDragLeave=function(t){this.currentDropListener.onDragLeave(t)},e.prototype.onDragging=function(t){this.currentDropListener.onDragging(t)},e.prototype.onDragStop=function(t){this.currentDropListener.onDragStop(t)},bc([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),bc([$("columnModel")],e.prototype,"columnModel",void 0),bc([$("ctrlsService")],e.prototype,"ctrlsService",void 0),bc([Z],e.prototype,"postConstruct",null),bc([Z],e.prototype,"init",null),e}(jt),Ec=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Sc=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Tc=function(){function t(){}return t.getHeaderClassesFromColDef=function(t,e,n,r){return i(t)?[]:this.getColumnClassesFromCollDef(t.headerClass,t,e,n,r)},t.getToolPanelClassesFromColDef=function(t,e,n,r){return i(t)?[]:this.getColumnClassesFromCollDef(t.toolPanelClass,t,e,n,r)},t.getClassParams=function(t,e,n,r){return{colDef:t,column:n,columnGroup:r,api:e.api,columnApi:e.columnApi,context:e.context}},t.getColumnClassesFromCollDef=function(t,e,n,r,o){if(i(t))return[];var s;"function"===typeof t?s=t(this.getClassParams(e,n,r,o)):s=t;return"string"===typeof s?[s]:Array.isArray(s)?Sc([],Ec(s)):[]},t}(),Rc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Oc=function(t){function e(n){var r=t.call(this,e.TEMPLATE,n)||this;return r.headerCompVersion=0,r.column=n.getColumnGroupChild(),r.pinned=n.getPinned(),r}return Rc(e,t),e.prototype.postConstruct=function(){var t,e,n=this,r=this.getGui();t="col-id",null!=(e=this.column.getColId())&&""!=e?r.setAttribute(t,e):r.removeAttribute(t);var o={setWidth:function(t){return r.style.width=t},addOrRemoveCssClass:function(t,e){return n.addOrRemoveCssClass(t,e)},setAriaDescription:function(t){return en(r,t)},setAriaSort:function(t){return t?vn(r,t):_n(r)},setUserCompDetails:function(t){return n.setUserCompDetails(t)},getUserCompInstance:function(){return n.headerComp}};this.ctrl.setComp(o,this.getGui(),this.eResize,this.eHeaderCompWrapper);var i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)},e.prototype.destroyHeaderComp=function(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)},e.prototype.setUserCompDetails=function(t){var e=this;this.headerCompVersion++;var n=this.headerCompVersion;t.newAgStackInstance().then((function(t){return e.afterCompCreated(n,t)}))},e.prototype.afterCompCreated=function(t,e){t==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=e,this.headerCompGui=e.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(e)},e.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',Pc([To("eResize")],e.prototype,"eResize",void 0),Pc([To("eHeaderCompWrapper")],e.prototype,"eHeaderCompWrapper",void 0),Pc([Z],e.prototype,"postConstruct",null),Pc([Q],e.prototype,"destroyHeaderComp",null),e}(hl),Ic=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ac=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Dc=function(t){function e(n){return t.call(this,e.TEMPLATE,n)||this}return Ic(e,t),e.prototype.postConstruct=function(){var t=this,e=this.getGui();e.setAttribute("col-id",this.ctrl.getColId());var n={addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},setResizableDisplayed:function(e){return ur(t.eResize,e)},setWidth:function(t){return e.style.width=t},setAriaExpanded:function(t){return n="aria-expanded",void 0!=(r=t)?e.setAttribute(n,r):e.removeAttribute(n);var n,r},setUserCompDetails:function(e){return t.setUserCompDetails(e)}};this.ctrl.setComp(n,e,this.eResize)},e.prototype.setUserCompDetails=function(t){var e=this;t.newAgStackInstance().then((function(t){return e.afterHeaderCompCreated(t)}))},e.prototype.afterHeaderCompCreated=function(t){var e=this,n=function(){return e.destroyBean(t)};if(this.isAlive()){var r=this.getGui(),o=t.getGui();r.appendChild(o),this.addDestroyFunc(n),this.ctrl.setDragSource(r)}else n()},e.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',Ac([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Ac([To("eResize")],e.prototype,"eResize",void 0),Ac([Z],e.prototype,"postConstruct",null),e}(hl),Mc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.COLUMN_GROUP="group",t.COLUMN="column",t.FLOATING_FILTER="filter"}(fc||(fc={}));var Nc,Fc=function(t){function e(e){var n=t.call(this)||this;return n.headerComps={},n.ctrl=e,n.setTemplate('<div class="'+n.ctrl.getHeaderRowClass()+'" role="row"></div>'),n}return Mc(e,t),e.prototype.init=function(){var t=this;this.getGui().style.transform=this.ctrl.getTransform(),fn(this.getGui(),this.ctrl.getAriaRowIndex());var e={setHeight:function(e){return t.getGui().style.height=e},setTop:function(e){return t.getGui().style.top=e},setHeaderCtrls:function(e,n){return t.setHeaderCtrls(e,n)},setWidth:function(e){return t.getGui().style.width=e}};this.ctrl.setComp(e)},e.prototype.destroyHeaderCtrls=function(){this.setHeaderCtrls([],!1)},e.prototype.setHeaderCtrls=function(t,e){var n=this;if(this.isAlive()){var r=this.headerComps;if(this.headerComps={},t.forEach((function(t){var e=t.getInstanceId(),o=r[e];delete r[e],null==o&&(o=n.createHeaderComp(t),n.getGui().appendChild(o.getGui())),n.headerComps[e]=o})),g(r,(function(t,e){n.getGui().removeChild(e.getGui()),n.destroyBean(e)})),e){var o=b(this.headerComps);o.sort((function(t,e){return t.getCtrl().getColumnGroupChild().getLeft()-e.getCtrl().getColumnGroupChild().getLeft()}));var i=o.map((function(t){return t.getGui()}));Or(this.getGui(),i)}}},e.prototype.createHeaderComp=function(t){var e;switch(this.ctrl.getType()){case fc.COLUMN_GROUP:e=new Dc(t);break;case fc.FLOATING_FILTER:e=new gl(t);break;default:e=new Oc(t)}return this.createBean(e),e.setParentComponent(this),e},Lc([Z],e.prototype,"init",null),Lc([Q],e.prototype,"destroyHeaderCtrls",null),e}(Eo),kc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Bc=0,Vc=function(t){function e(e,n){var r=t.call(this)||this;return r.lastFocusEvent=null,r.columnGroupChild=e,r.parentRowCtrl=n,r.instanceId=e.getUniqueId()+"-"+Bc++,r}return kc(e,t),e.prototype.shouldStopEventPropagation=function(t){var e=this.focusService.getFocusedHeader(),n=e.headerRowIndex,r=e.column;return Jr(this.gridOptionsService,t,n,r)},e.prototype.getWrapperHasFocus=function(){return this.gridOptionsService.getDocument().activeElement===this.eGui},e.prototype.setGui=function(t){this.eGui=t,this.addDomData()},e.prototype.handleKeyDown=function(t){var e=this.getWrapperHasFocus();switch(t.key){case Yr.PAGE_DOWN:case Yr.PAGE_UP:case Yr.PAGE_HOME:case Yr.PAGE_END:e&&t.preventDefault()}},e.prototype.addDomData=function(){var t=this,n=e.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,n,this),this.addDestroyFunc((function(){return t.gridOptionsService.setDomData(t.eGui,n,null)}))},e.prototype.getGui=function(){return this.eGui},e.prototype.focus=function(t){return!!this.eGui&&(this.lastFocusEvent=t||null,this.eGui.focus(),!0)},e.prototype.getRowIndex=function(){return this.parentRowCtrl.getRowIndex()},e.prototype.getParentRowCtrl=function(){return this.parentRowCtrl},e.prototype.getPinned=function(){return this.parentRowCtrl.getPinned()},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.getColumnGroupChild=function(){return this.columnGroupChild},e.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",Gc([$("focusService")],e.prototype,"focusService",void 0),Gc([$("beans")],e.prototype,"beans",void 0),Gc([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),e}(jt),zc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Hc=function(t){function e(e,n,r,o){var i=t.call(this)||this;return i.columnOrGroup=e,i.eCell=n,i.ariaEl=i.eCell.querySelector("[role=columnheader]")||i.eCell,i.colsSpanning=o,i.beans=r,i}return zc(e,t),e.prototype.setColsSpanning=function(t){this.colsSpanning=t,this.onLeftChanged()},e.prototype.getColumnOrGroup=function(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?yt(this.colsSpanning):this.columnOrGroup},e.prototype.postConstruct=function(){this.addManagedListener(this.columnOrGroup,ht.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))},e.prototype.setLeftFirstTime=function(){var t=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),e=o(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&e&&!t?this.animateInLeft():this.onLeftChanged()},e.prototype.animateInLeft=function(){var t=this,e=this.getColumnOrGroup(),n=e.getLeft(),r=e.getOldLeft(),o=this.modifyLeftForPrintLayout(e,r),i=this.modifyLeftForPrintLayout(e,n);this.setLeft(o),this.actualLeft=i,this.beans.columnAnimationService.executeNextVMTurn((function(){t.actualLeft===i&&t.setLeft(i)}))},e.prototype.onLeftChanged=function(){var t=this.getColumnOrGroup(),e=t.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(t,e),this.setLeft(this.actualLeft)},e.prototype.modifyLeftForPrintLayout=function(t,e){if(!this.beans.gridOptionsService.isDomLayout("print"))return e;if("left"===t.getPinned())return e;var n=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===t.getPinned()?n+this.beans.columnModel.getBodyContainerWidth()+e:n+e},e.prototype.setLeft=function(t){var e;if(o(t)&&(this.eCell.style.left=t+"px"),this.columnOrGroup instanceof ht)e=this.columnOrGroup;else{var n=this.columnOrGroup.getLeafColumns();if(!n.length)return;n.length>1&&yn(this.ariaEl,n.length),e=n[0]}var r=this.beans.columnModel.getAriaColumnIndex(e);mn(this.ariaEl,r)},jc([Z],e.prototype,"postConstruct",null),e}(jt),Uc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qc=function(t){function e(e,n){var r=t.call(this)||this;return r.columns=e,r.element=n,r}return Uc(e,t),e.prototype.postConstruct=function(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()},e.prototype.addMouseHoverListeners=function(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))},e.prototype.onMouseOut=function(){this.columnHoverService.clearMouseOver()},e.prototype.onMouseOver=function(){this.columnHoverService.setMouseOver(this.columns)},Wc([$("columnHoverService")],e.prototype,"columnHoverService",void 0),Wc([Z],e.prototype,"postConstruct",null),e}(jt),Xc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Yc=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.iconCreated=!1,r.column=e,r}return Xc(e,t),e.prototype.setComp=function(e,n,r,o){t.prototype.setGui.call(this,n),this.comp=e,this.eButtonShowMainFilter=r,this.eFloatingFilterBody=o,this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,ht.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))},e.prototype.setupActive=function(){var t=this.column.getColDef(),e=!!t.filter,n=!!t.floatingFilter;this.active=e&&n},e.prototype.setupUi=function(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),this.active&&!this.iconCreated){var t=Xr("filter",this.gridOptionsService,this.column);t&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(t))}},e.prototype.setupFocus=function(){this.createManagedBean(new ko(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},e.prototype.setupAria=function(){var t=this.localeService.getLocaleTextFunc();$e(this.eButtonShowMainFilter,t("ariaFilterMenuOpen","Open Filter Menu"))},e.prototype.onTabKeyDown=function(t){if(!(this.gridOptionsService.getDocument().activeElement===this.eGui)){var e=this.focusService.findNextFocusableElement(this.eGui,null,t.shiftKey);if(e)return this.beans.headerNavigationService.scrollToColumn(this.column),t.preventDefault(),void e.focus();var n=this.findNextColumnWithFloatingFilter(t.shiftKey);n&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:n},event:t})&&t.preventDefault()}},e.prototype.findNextColumnWithFloatingFilter=function(t){var e=this.beans.columnModel,n=this.column;do{if(!(n=t?e.getDisplayedColBefore(n):e.getDisplayedColAfter(n)))break}while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n},e.prototype.handleKeyDown=function(e){t.prototype.handleKeyDown.call(this,e);var n=this.getWrapperHasFocus();switch(e.key){case Yr.UP:case Yr.DOWN:n||e.preventDefault();case Yr.LEFT:case Yr.RIGHT:if(n)return;e.stopPropagation();case Yr.ENTER:n&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case Yr.ESCAPE:n||this.eGui.focus()}},e.prototype.onFocusIn=function(t){if(!this.eGui.contains(t.relatedTarget)){var e=!!t.relatedTarget&&!t.relatedTarget.classList.contains("ag-floating-filter"),n=!!t.relatedTarget&&hr(t.relatedTarget,"ag-floating-filter");if(e&&n&&t.target===this.eGui){var r=this.lastFocusEvent,o=!(!r||r.key!==Yr.TAB);if(r&&o){var i=r.shiftKey;this.focusService.focusInto(this.eGui,i)}}var s=this.getRowIndex();this.beans.focusService.setFocusedHeader(s,this.column)}},e.prototype.setupHover=function(){var t=this;this.createManagedBean(new qc([this.column],this.eGui));var e=function(){if(t.gridOptionsService.is("columnHoverHighlight")){var e=t.columnHoverService.isHovered(t.column);t.comp.addOrRemoveCssClass("ag-column-hover",e)}};this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_HOVER_CHANGED,e),e()},e.prototype.setupLeft=function(){var t=new Hc(this.column,this.eGui,this.beans);this.createManagedBean(t)},e.prototype.setupFilterButton=function(){var t=this.column.getColDef();this.suppressFilterButton=!!t.floatingFilterComponentParams&&!!t.floatingFilterComponentParams.suppressFilterButton},e.prototype.setupUserComp=function(){var t=this;if(this.active){var e=this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return t.showParentFilter()}));e&&this.setCompDetails(e)}},e.prototype.setCompDetails=function(t){this.userCompDetails=t,this.comp.setCompDetails(t)},e.prototype.showParentFilter=function(){var t=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,t,"floatingFilter","filterMenuTab",["filterMenuTab"])},e.prototype.setupSyncWithFilter=function(){var t=this;if(this.active){var e=function(e){var n=t.comp.getFloatingFilterComp();n&&n.then((function(n){if(n){var r=t.filterManager.getCurrentFloatingFilterParentModel(t.column);n.onParentModelChanged(r,e)}}))};this.destroySyncListener=this.addManagedListener(this.column,ht.EVENT_FILTER_CHANGED,e),this.filterManager.isFilterActive(this.column)&&e(null)}},e.prototype.setupWidth=function(){var t=this,e=function(){var e=t.column.getActualWidth()+"px";t.comp.setWidth(e)};this.addManagedListener(this.column,ht.EVENT_WIDTH_CHANGED,e),e()},e.prototype.setupFilterChangedListener=function(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,ht.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)))},e.prototype.updateFilterButton=function(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))},e.prototype.onColDefChanged=function(){var t,e,n=this,r=this.active;this.setupActive();var o=!r&&this.active;r&&!this.active&&(null===(t=this.destroySyncListener)||void 0===t||t.call(this),null===(e=this.destroyFilterChangedListener)||void 0===e||e.call(this));var i=this.active?this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return n.showParentFilter()})):null,s=this.comp.getFloatingFilterComp();s&&i?s.then((function(t){var e;!t||n.filterManager.areFilterCompsDifferent(null!==(e=n.userCompDetails)&&void 0!==e?e:null,i)?n.updateCompDetails(i,o):n.updateFloatingFilterParams(i)})):this.updateCompDetails(i,o)},e.prototype.updateCompDetails=function(t,e){this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),e&&(this.setupSyncWithFilter(),this.setupFilterChangedListener())},e.prototype.updateFloatingFilterParams=function(t){var e;if(t){var n=t.params;null===(e=this.comp.getFloatingFilterComp())||void 0===e||e.then((function(t){(null===t||void 0===t?void 0:t.onParamsUpdated)&&"function"===typeof t.onParamsUpdated&&t.onParamsUpdated(n)}))}},Kc([$("filterManager")],e.prototype,"filterManager",void 0),Kc([$("columnHoverService")],e.prototype,"columnHoverService",void 0),Kc([$("menuFactory")],e.prototype,"menuFactory",void 0),e}(Vc),Zc=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qc=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Jc=function(t){function e(e,n,r,o,i){var s=t.call(this)||this;return s.pinned=e,s.column=n,s.eResize=r,s.comp=o,s.ctrl=i,s}return Zc(e,t),e.prototype.postConstruct=function(){var t,e,n=this,r=this.column.getColDef(),o=[],i=function(){o.forEach((function(t){return t()})),o.length=0},s=function(){var s=n.column.isResizable(),a=!n.gridOptionsService.is("suppressAutoSize")&&!r.suppressAutoSize;(s!==t||a!==e)&&(t=s,e=a,i(),function(){if(ur(n.eResize,t),t){var r=n.horizontalResizeService.addResizeBar({eResizeBar:n.eResize,onResizeStart:n.onResizeStart.bind(n),onResizing:n.onResizing.bind(n,!1),onResizeEnd:n.onResizing.bind(n,!0)});if(o.push(r),e){var i=n.gridOptionsService.is("skipHeaderOnAutoSize"),s=function(){n.columnModel.autoSizeColumn(n.column,i,"uiColumnResized")};n.eResize.addEventListener("dblclick",s);var a=new es(n.eResize);a.addEventListener(es.EVENT_DOUBLE_TAP,s),n.addDestroyFunc((function(){n.eResize.removeEventListener("dblclick",s),a.removeEventListener(es.EVENT_DOUBLE_TAP,s),a.destroy()}))}}}())};s(),this.addDestroyFunc(i),this.ctrl.addRefreshFunction(s)},e.prototype.onResizing=function(t,e){var n=this.normaliseResizeAmount(e),r=[{key:this.column,newWidth:this.resizeStartWidth+n}];this.columnModel.setColumnWidths(r,this.resizeWithShiftKey,t,"uiColumnResized"),t&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},e.prototype.onResizeStart=function(t){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=t,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},e.prototype.normaliseResizeAmount=function(t){var e=t,n="left"!==this.pinned,r="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?n&&(e*=-1):r&&(e*=-1),e},Qc([$("horizontalResizeService")],e.prototype,"horizontalResizeService",void 0),Qc([$("columnModel")],e.prototype,"columnModel",void 0),Qc([Z],e.prototype,"postConstruct",null),e}(jt),$c=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ep=function(t){function e(e){var n=t.call(this)||this;n.cbSelectAllVisible=!1,n.processingEventFromCheckbox=!1,n.column=e;var r=e.getColDef();return n.filteredOnly=!!(null===r||void 0===r?void 0:r.headerCheckboxSelectionFilteredOnly),n.currentPageOnly=!!(null===r||void 0===r?void 0:r.headerCheckboxSelectionCurrentPageOnly),n}return $c(e,t),e.prototype.onSpaceKeyDown=function(t){var e=this.cbSelectAll,n=this.gridOptionsService.getDocument();e.isDisplayed()&&!e.getGui().contains(n.activeElement)&&(t.preventDefault(),e.setValue(!e.getValue()))},e.prototype.getCheckboxGui=function(){return this.cbSelectAll.getGui()},e.prototype.setComp=function(t){this.headerCellCtrl=t,this.cbSelectAll=this.createManagedBean(new li),this.cbSelectAll.addCssClass("ag-header-select-all"),Ye(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,Yt.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),an(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()},e.prototype.showOrHideSelectAll=function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()},e.prototype.onModelChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},e.prototype.onSelectionChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},e.prototype.updateStateOfCheckbox=function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var t=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}},e.prototype.refreshSelectAllLabel=function(){var t=this.localeService.getLocaleTextFunc(),e=this.cbSelectAll.getValue()?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),n=t("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",n+" ("+e+")"):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(n+" ("+e+")"),this.headerCellCtrl.refreshAriaDescription()},e.prototype.checkRightRowModelType=function(t){var e=this.rowModel.getType();return!("clientSide"!==e&&"serverSide"!==e)||(console.warn("AG Grid: "+t+" is only available if using 'clientSide' or 'serverSide' rowModelType, you are using "+e+"."),!1)},e.prototype.onCbSelectAll=function(){if(!this.processingEventFromCheckbox&&this.cbSelectAllVisible){var t=this.cbSelectAll.getValue(),e="uiSelectAll";this.currentPageOnly?e="uiSelectAllCurrentPage":this.filteredOnly&&(e="uiSelectAllFiltered");var n={source:e,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};t?this.selectionService.selectAllRowNodes(n):this.selectionService.deselectAllRowNodes(n)}},e.prototype.isCheckboxSelection=function(){var t=this.column.getColDef().headerCheckboxSelection;"function"===typeof t&&(t=t({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context}));return!!t&&this.checkRightRowModelType("headerCheckboxSelection")},tp([$("gridApi")],e.prototype,"gridApi",void 0),tp([$("columnApi")],e.prototype,"columnApi",void 0),tp([$("rowModel")],e.prototype,"rowModel",void 0),tp([$("selectionService")],e.prototype,"selectionService",void 0),e}(jt),np=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.TAB_GUARD="ag-tab-guard",t.TAB_GUARD_TOP="ag-tab-guard-top",t.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(Nc||(Nc={}));var op,ip=function(t){function e(e){var n=t.call(this)||this;n.skipTabGuardFocus=!1;var r=e.comp,o=e.eTopGuard,i=e.eBottomGuard,s=e.focusInnerElement,a=e.onFocusIn,l=e.onFocusOut,u=e.shouldStopEventPropagation,c=e.onTabKeyDown,p=e.handleKeyDown,h=e.eFocusableElement;return n.comp=r,n.eTopGuard=o,n.eBottomGuard=i,n.providedFocusInnerElement=s,n.eFocusableElement=h,n.providedFocusIn=a,n.providedFocusOut=l,n.providedShouldStopEventPropagation=u,n.providedOnTabKeyDown=c,n.providedHandleKeyDown=p,n}return np(e,t),e.prototype.postConstruct=function(){var t=this;this.createManagedBean(new ko(this.eFocusableElement,{shouldStopEventPropagation:function(){return t.shouldStopEventPropagation()},onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)},onFocusIn:function(e){return t.onFocusIn(e)},onFocusOut:function(e){return t.onFocusOut(e)}})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((function(e){return t.addManagedListener(e,"focus",t.onFocus.bind(t))}))},e.prototype.handleKeyDown=function(t){this.providedHandleKeyDown&&this.providedHandleKeyDown(t)},e.prototype.tabGuardsAreActive=function(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")},e.prototype.shouldStopEventPropagation=function(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()},e.prototype.activateTabGuards=function(){var t=this.gridOptionsService.getNum("tabIndex")||0;this.comp.setTabIndex(t.toString())},e.prototype.deactivateTabGuards=function(){this.comp.setTabIndex()},e.prototype.onFocus=function(t){if(this.skipTabGuardFocus)this.skipTabGuardFocus=!1;else{var e=t.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(e):this.focusInnerElement(e)}},e.prototype.onFocusIn=function(t){this.providedFocusIn&&this.providedFocusIn(t)||this.deactivateTabGuards()},e.prototype.onFocusOut=function(t){this.providedFocusOut&&this.providedFocusOut(t)||this.eFocusableElement.contains(t.relatedTarget)||this.activateTabGuards()},e.prototype.onTabKeyDown=function(t){var e=this;if(this.providedOnTabKeyDown)this.providedOnTabKeyDown(t);else if(!t.defaultPrevented){var n=this.tabGuardsAreActive();n&&this.deactivateTabGuards();var r=this.getNextFocusableElement(t.shiftKey);n&&setTimeout((function(){return e.activateTabGuards()}),0),r&&(r.focus(),t.preventDefault())}},e.prototype.focusInnerElement=function(t){void 0===t&&(t=!1);var e=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(e.splice(0,1),e.splice(e.length-1,1)),e.length&&e[t?e.length-1:0].focus({preventScroll:!0})},e.prototype.getNextFocusableElement=function(t){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,t)},e.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1);var e=t?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,e.focus()},rp([$("focusService")],e.prototype,"focusService",void 0),rp([Z],e.prototype,"postConstruct",null),e}(jt),sp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ap=function(){return(ap=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},lp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},up=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},cp=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},pp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return sp(e,t),n=e,e.addKeyboardModeEvents=function(t,e){var r=n.instancesMonitored.get(t);r&&r.length>0?-1===r.indexOf(e)&&r.push(e):(n.instancesMonitored.set(t,[e]),t.addEventListener("keydown",n.toggleKeyboardMode),t.addEventListener("mousedown",n.toggleKeyboardMode))},e.removeKeyboardModeEvents=function(t,e){var r=n.instancesMonitored.get(t),o=[];r&&r.length&&(o=cp([],up(r)).filter((function(t){return t!==e})),n.instancesMonitored.set(t,o)),0===o.length&&(t.removeEventListener("keydown",n.toggleKeyboardMode),t.removeEventListener("mousedown",n.toggleKeyboardMode))},e.toggleKeyboardMode=function(t){var e=n.keyboardModeActive,r="keydown"===t.type;if((!r||!(t.ctrlKey||t.metaKey||t.altKey))&&!(e&&r||!e&&!r)){n.keyboardModeActive=r;var o=t.target.ownerDocument;if(o){var i=n.instancesMonitored.get(o);i&&i.forEach((function(t){t.dispatchEvent({type:r?Yt.EVENT_KEYBOARD_FOCUS:Yt.EVENT_MOUSE_FOCUS})}))}}},e.prototype.init=function(){var t=this,e=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_GROUP_OPENED,e),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.ctrlsService.whenReady((function(e){t.gridCtrl=e.gridCtrl;var r=t.gridOptionsService.getDocument();n.addKeyboardModeEvents(r,t.gridCtrl),t.addDestroyFunc((function(){return t.unregisterGridCompController(t.gridCtrl)}))}))},e.prototype.unregisterGridCompController=function(t){var e=this.gridOptionsService.getDocument();n.removeKeyboardModeEvents(e,t)},e.prototype.onColumnEverythingChanged=function(){if(this.focusedCellPosition){var t=this.focusedCellPosition.column,e=this.columnModel.getGridColumn(t.getId());t!==e&&this.clearFocusedCell()}},e.prototype.isKeyboardMode=function(){return n.keyboardModeActive},e.prototype.getFocusCellToUseAfterRefresh=function(){var t=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(t.activeElement,hu.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition},e.prototype.getFocusHeaderToUseAfterRefresh=function(){var t=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(t.activeElement,Vc.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition},e.prototype.isDomDataMissingInHierarchy=function(t,e){for(var n=t;n;){if(this.gridOptionsService.getDomData(n,e))return!1;n=n.parentNode}return!0},e.prototype.getFocusedCell=function(){return this.focusedCellPosition},e.prototype.shouldRestoreFocus=function(t){var e=this;return!!this.isCellRestoreFocused(t)&&(setTimeout((function(){e.restoredFocusedCellPosition=null}),0),!0)},e.prototype.isCellRestoreFocused=function(t){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(t,this.restoredFocusedCellPosition)},e.prototype.setRestoreFocusedCell=function(t){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=t)},e.prototype.getFocusEventParams=function(){var t=this.focusedCellPosition,e=t.rowIndex,n=t.rowPinned,r={rowIndex:e,rowPinned:n,column:t.column,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:n});return o&&(r.isFullWidthCell=o.isFullWidth()),r},e.prototype.clearFocusedCell=function(){if(this.restoredFocusedCellPosition=null,null!=this.focusedCellPosition){var t=ap({type:Yt.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(t)}},e.prototype.setFocusedCell=function(t){var e=t.column,n=t.rowIndex,o=t.rowPinned,i=t.forceBrowserFocus,s=void 0!==i&&i,a=t.preventScrollOnBrowserFocus,l=void 0!==a&&a,u=this.columnModel.getGridColumn(e);if(u){this.focusedCellPosition=u?{rowIndex:n,rowPinned:r(o),column:u}:null;var c=ap(ap({type:Yt.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:s,preventScrollOnBrowserFocus:l,floating:null});this.eventService.dispatchEvent(c)}else this.focusedCellPosition=null},e.prototype.isCellFocused=function(t){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(t,this.focusedCellPosition)},e.prototype.isRowNodeFocused=function(t){return this.isRowFocused(t.rowIndex,t.rowPinned)},e.prototype.isHeaderWrapperFocused=function(t){if(null==this.focusedHeaderPosition)return!1;var e=t.getColumnGroupChild(),n=t.getRowIndex(),r=t.getPinned(),o=this.focusedHeaderPosition,i=o.column,s=o.headerRowIndex;return e===i&&n===s&&r==i.getPinned()},e.prototype.clearFocusedHeader=function(){this.focusedHeaderPosition=null},e.prototype.getFocusedHeader=function(){return this.focusedHeaderPosition},e.prototype.setFocusedHeader=function(t,e){this.focusedHeaderPosition={headerRowIndex:t,column:e}},e.prototype.focusHeaderPosition=function(t){var e=t.direction,n=t.fromTab,r=t.allowUserOverride,o=t.event,i=t.fromCell,s=t.headerPosition;if(i&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(s);if(r){var a,l=this.getFocusedHeader(),u=this.headerNavigationService.getHeaderRowCount();if(n){if(a=this.gridOptionsService.getCallback("tabToNextHeader"))s=a({backwards:"Before"===e,previousHeaderPosition:l,nextHeaderPosition:s,headerRowCount:u})}else if((a=this.gridOptionsService.getCallback("navigateToNextHeader"))&&o)s=a({key:o.key,previousHeaderPosition:l,nextHeaderPosition:s,headerRowCount:u,event:o})}return!!s&&(-1===s.headerRowIndex?this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(s):this.focusGridView(s.column):(this.headerNavigationService.scrollToColumn(s.column,e),this.ctrlsService.getHeaderRowContainerCtrl(s.column.getPinned()).focusHeader(s.headerRowIndex,s.column,o)))},e.prototype.focusFirstHeader=function(){var t=this.columnModel.getAllDisplayedColumns()[0];return!!t&&(t.getParent()&&(t=this.columnModel.getColumnGroupAtLevel(t,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:t}}))},e.prototype.focusLastHeader=function(t){var e=this.headerNavigationService.getHeaderRowCount()-1,n=yt(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:e,column:n},event:t})},e.prototype.focusPreviousFromFirstCell=function(t){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(t)},e.prototype.isAnyCellFocused=function(){return!!this.focusedCellPosition},e.prototype.isRowFocused=function(t,e){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===t&&this.focusedCellPosition.rowPinned===r(e))},e.prototype.findFocusableElements=function(t,e,n){void 0===n&&(n=!1);var r=ar;e&&(r+=", "+e),n&&(r+=', [tabindex="-1"]');var o=Array.prototype.slice.apply(t.querySelectorAll("[tabindex], input, select, button, textarea, [href]")),i=Array.prototype.slice.apply(t.querySelectorAll(r));if(!i.length)return o;var s;return s=i,o.filter((function(t){return-1===s.indexOf(t)}))},e.prototype.focusInto=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=this.findFocusableElements(t,null,n),o=e?yt(r):r[0];return!!o&&(o.focus({preventScroll:!0}),!0)},e.prototype.findFocusableElementBeforeTabGuard=function(t,e){if(!e)return null;var n=this.findFocusableElements(t),r=n.indexOf(e);if(-1===r)return null;for(var o=-1,i=r-1;i>=0;i--)if(n[i].classList.contains(Nc.TAB_GUARD_TOP)){o=i;break}return o<=0?null:n[o-1]},e.prototype.findNextFocusableElement=function(t,e,n){void 0===t&&(t=this.eGridDiv);var r=this.findFocusableElements(t,e?':not([tabindex="-1"])':null),o=this.gridOptionsService.getDocument().activeElement,i=(e?r.findIndex((function(t){return t.contains(o)})):r.indexOf(o))+(n?-1:1);return i<0||i>=r.length?null:r[i]},e.prototype.isTargetUnderManagedComponent=function(t,e){if(!e)return!1;var n=t.querySelectorAll("."+ko.FOCUS_MANAGED_CLASS);if(!n.length)return!1;for(var r=0;r<n.length;r++)if(n[r].contains(e))return!0;return!1},e.prototype.findTabbableParent=function(t,e){void 0===e&&(e=5);for(var n=0;t&&null===Vn(t)&&++n<=e;)t=t.parentElement;return null===Vn(t)?null:t},e.prototype.focusGridView=function(t,e){if(this.gridOptionsService.is("suppressCellFocus"))return e?this.focusLastHeader():this.focusNextGridCoreContainer(!1);var n=e?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!n)return!1;var o=n.rowIndex,i=n.rowPinned,s=this.getFocusedHeader();if(!t&&s&&(t=s.column),null==o||!t)return!1;if(this.navigationService.ensureCellVisible({rowIndex:o,column:t,rowPinned:i}),this.setFocusedCell({rowIndex:o,column:t,rowPinned:r(i),forceBrowserFocus:!0}),this.rangeService){var a={rowIndex:o,rowPinned:i,column:t};this.rangeService.setRangeToCell(a)}return!0},e.prototype.focusNextGridCoreContainer=function(t,e){return void 0===e&&(e=!1),!(e||!this.gridCtrl.focusNextInnerContainer(t))||((e||!t&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(t),!1)},e.prototype.focusAdvancedFilter=function(t){return this.advancedFilterFocusColumn=null===t||void 0===t?void 0:t.column,this.advancedFilterService.getCtrl().focusHeaderComp()},e.prototype.focusNextFromAdvancedFilter=function(t,e){var n,r,o=null!==(n=e?void 0:this.advancedFilterFocusColumn)&&void 0!==n?n:null===(r=this.columnModel.getAllDisplayedColumns())||void 0===r?void 0:r[0];return t?this.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(o)},e.prototype.clearAdvancedFilterColumn=function(){this.advancedFilterFocusColumn=void 0},e.AG_KEYBOARD_FOCUS="ag-keyboard-focus",e.keyboardModeActive=!1,e.instancesMonitored=new Map,lp([$("eGridDiv")],e.prototype,"eGridDiv",void 0),lp([$("columnModel")],e.prototype,"columnModel",void 0),lp([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),lp([$("rowRenderer")],e.prototype,"rowRenderer",void 0),lp([$("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),lp([$("cellPositionUtils")],e.prototype,"cellPositionUtils",void 0),lp([tt("rangeService")],e.prototype,"rangeService",void 0),lp([$("navigationService")],e.prototype,"navigationService",void 0),lp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),lp([$("filterManager")],e.prototype,"filterManager",void 0),lp([tt("advancedFilterService")],e.prototype,"advancedFilterService",void 0),lp([Z],e.prototype,"init",null),e=n=lp([J("focusService")],e)}(jt),hp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},fp=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.refreshFunctions=[],r.userHeaderClasses=new Set,r.ariaDescriptionProperties=new Map,r.column=e,r}return hp(e,t),e.prototype.setComp=function(e,n,r,o){var i=this;t.prototype.setGui.call(this,n),this.comp=e,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(o),this.addColumnHoverListener(),this.setupFilterCss(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new Jc(this.getPinned(),this.column,r,e,this)),this.createManagedBean(new qc([this.column],n)),this.createManagedBean(new Hc(this.column,n,this.beans)),this.createManagedBean(new ko(n,{shouldStopEventPropagation:function(t){return i.shouldStopEventPropagation(t)},onTabKeyDown:function(){return null},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addMouseDownListenerIfNeeded(n),this.addManagedListener(this.column,ht.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onHeaderHeightChanged.bind(this))},e.prototype.addMouseDownListenerIfNeeded=function(t){var e=this;if(Mn()){var n=this.gridOptionsService.getDocument();["mousedown","touchstart"].forEach((function(r){e.addManagedListener(t,r,(function(e){var r=n.activeElement;r===t||t.contains(r)||(t.focus(),pp.toggleKeyboardMode(e))}))}))}},e.prototype.setupUserComp=function(){var t=this.lookupUserCompDetails();this.setCompDetails(t)},e.prototype.setCompDetails=function(t){this.userCompDetails=t,this.comp.setUserCompDetails(t)},e.prototype.lookupUserCompDetails=function(){var t=this.createParams(),e=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(e,t)},e.prototype.createParams=function(){var t=this,e=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:e.sortable,enableMenu:this.menuEnabled,showColumnMenu:function(e){t.gridApi.showColumnMenuAfterButtonClick(t.column,e)},progressSort:function(e){t.sortController.progressSort(t.column,!!e,"uiColumnSorted")},setSort:function(e,n){t.sortController.setSortForColumn(t.column,e,!!n,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()}},e.prototype.setupSelectAll=function(){this.selectAllFeature=this.createManagedBean(new ep(this.column)),this.selectAllFeature.setComp(this)},e.prototype.getSelectAllGui=function(){return this.selectAllFeature.getCheckboxGui()},e.prototype.handleKeyDown=function(e){t.prototype.handleKeyDown.call(this,e),e.key===Yr.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===Yr.ENTER&&this.onEnterKeyDown(e)},e.prototype.onEnterKeyDown=function(t){var e=this.comp.getUserCompInstance();if(e)if(t.ctrlKey||t.metaKey)this.menuEnabled&&e.showMenu&&(t.preventDefault(),e.showMenu());else if(this.sortable){var n=t.shiftKey;this.sortController.progressSort(this.column,n,"uiColumnSorted")}},e.prototype.isMenuEnabled=function(){return this.menuEnabled},e.prototype.onFocusIn=function(t){if(!this.getGui().contains(t.relatedTarget)){var e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column)}this.setActiveHeader(!0)},e.prototype.onFocusOut=function(t){this.getGui().contains(t.relatedTarget)||this.setActiveHeader(!1)},e.prototype.setupTooltip=function(){var t=this,e={getColumn:function(){return t.column},getColDef:function(){return t.column.getColDef()},getGui:function(){return t.eGui},getLocation:function(){return"header"},getTooltipValue:function(){return t.column.getColDef().headerTooltip}},n=this.createManagedBean(new Wl(e,this.beans));n.setComp(this.eGui),this.refreshFunctions.push((function(){return n.refreshToolTip()}))},e.prototype.setupClassesFromColDef=function(){var t=this,e=function(){var e=t.column.getColDef(),n=Tc.getHeaderClassesFromColDef(e,t.gridOptionsService,t.column,null),r=t.userHeaderClasses;t.userHeaderClasses=new Set(n),n.forEach((function(e){r.has(e)?r.delete(e):t.comp.addOrRemoveCssClass(e,!0)})),r.forEach((function(e){return t.comp.addOrRemoveCssClass(e,!1)}))};this.refreshFunctions.push(e),e()},e.prototype.setDragSource=function(t){var e=this;if(this.dragSourceElement=t,this.removeDragSource(),t&&this.draggable){var n=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:Gi.HeaderCell,eElement:t,defaultIconName:n?zs.ICON_HIDE:zs.ICON_NOT_ALLOWED,getDragItem:function(){return e.createDragItem()},dragItemName:this.displayName,onDragStarted:function(){return e.column.setMoving(!0,"uiColumnMoved")},onDragStopped:function(){return e.column.setMoving(!1,"uiColumnMoved")},onGridEnter:function(t){var r;if(n){var o=(null===(r=null===t||void 0===t?void 0:t.columns)||void 0===r?void 0:r.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(o,!0,"uiColumnMoved")}},onGridExit:function(t){var r;if(n){var o=(null===(r=null===t||void 0===t?void 0:t.columns)||void 0===r?void 0:r.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(o,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}},e.prototype.createDragItem=function(){var t={};return t[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:t}},e.prototype.removeDragSource=function(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)},e.prototype.onColDefChanged=function(){this.refresh()},e.prototype.updateState=function(){var t=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!t.suppressMenu,this.sortable=t.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()},e.prototype.addRefreshFunction=function(t){this.refreshFunctions.push(t)},e.prototype.refresh=function(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach((function(t){return t()}))},e.prototype.refreshHeaderComp=function(){var t=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass)&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)},e.prototype.attemptHeaderCompRefresh=function(t){var e=this.comp.getUserCompInstance();return!!e&&(!!e.refresh&&e.refresh(t))},e.prototype.calculateDisplayName=function(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)},e.prototype.checkDisplayName=function(){this.displayName!==this.calculateDisplayName()&&this.refresh()},e.prototype.workOutDraggable=function(){var t=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!t.suppressMovable&&!t.lockPosition)||!!t.enableRowGroup||!!t.enablePivot},e.prototype.onColumnRowGroupChanged=function(){this.checkDisplayName()},e.prototype.onColumnPivotChanged=function(){this.checkDisplayName()},e.prototype.onColumnValueChanged=function(){this.checkDisplayName()},e.prototype.setupWidth=function(){var t=this,e=function(){var e=t.column.getActualWidth();t.comp.setWidth(e+"px")};this.addManagedListener(this.column,ht.EVENT_WIDTH_CHANGED,e),e()},e.prototype.setupMovingCss=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-header-cell-moving",t.column.isMoving())};this.addManagedListener(this.column,ht.EVENT_MOVING_CHANGED,e),e()},e.prototype.setupMenuClass=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-column-menu-visible",t.column.isMenuVisible())};this.addManagedListener(this.column,ht.EVENT_MENU_VISIBLE_CHANGED,e),e()},e.prototype.setupSortableClass=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!t.sortable)};e(),this.addRefreshFunction(e),this.addManagedListener(this.eventService,ht.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))},e.prototype.setupWrapTextClass=function(){var t=this,e=function(){var e=!!t.column.getColDef().wrapHeaderText;t.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.addRefreshFunction(e)},e.prototype.onHeaderHeightChanged=function(){this.refreshSpanHeaderHeight()},e.prototype.refreshSpanHeaderHeight=function(){var t=this,e=t.eGui,n=t.column,r=t.comp,o=t.columnModel,i=t.gridOptionsService;if(n.isSpanHeaderHeight()){var s=this.getColumnGroupPaddingInfo(),a=s.numberOfParents,l=s.isSpanningTotal;r.addOrRemoveCssClass("ag-header-span-height",a>0);var u=o.getColumnHeaderRowHeight();if(0===a)return r.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height",u+"px");r.addOrRemoveCssClass("ag-header-span-total",l);var c=a*(i.is("pivotMode")?o.getPivotGroupHeaderHeight():o.getGroupHeaderHeight());e.style.setProperty("top",-c+"px"),e.style.setProperty("height",u+c+"px")}},e.prototype.getColumnGroupPaddingInfo=function(){var t=this.column.getParent();if(!t||!t.isPadding())return{numberOfParents:0,isSpanningTotal:!1};for(var e=t.getPaddingLevel()+1,n=!0;t;){if(!t.isPadding()){n=!1;break}t=t.getParent()}return{numberOfParents:e,isSpanningTotal:n}},e.prototype.setupAutoHeight=function(t){var e,n=this,r=function(e){if(n.isAlive()){var o=dr(n.getGui()),i=o.paddingTop+o.paddingBottom+o.borderBottomWidth+o.borderTopWidth,s=t.offsetHeight+i;if(e<5){var a=n.beans.gridOptionsService.getDocument();if(!a||!a.contains(t)||0==s)return void n.beans.frameworkOverrides.setTimeout((function(){return r(e+1)}),0)}n.columnModel.setColumnHeaderHeight(n.column,s)}},o=!1,i=function(){var t=n.column.isAutoHeaderHeight();t&&!o&&s(),!t&&o&&a()},s=function(){o=!0,r(0),n.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),e=n.resizeObserverService.observeResize(t,(function(){return r(0)}))},a=function(){o=!1,e&&e(),n.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),e=void 0};i(),this.addDestroyFunc((function(){return a()})),this.addManagedListener(this.column,ht.EVENT_WIDTH_CHANGED,(function(){return o&&r(0)})),this.addManagedListener(this.eventService,ht.EVENT_SORT_CHANGED,(function(){o&&n.beans.frameworkOverrides.setTimeout((function(){return r(0)}))})),this.addRefreshFunction(i)},e.prototype.refreshAriaSort=function(){if(this.sortable){var t=this.localeService.getLocaleTextFunc(),e=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(Ze(e)),this.setAriaDescriptionProperty("sort",t("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)},e.prototype.refreshAriaMenu=function(){if(this.menuEnabled){var t=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",t("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)},e.prototype.setAriaDescriptionProperty=function(t,e){null!=e?this.ariaDescriptionProperties.set(t,e):this.ariaDescriptionProperties.delete(t)},e.prototype.refreshAriaDescription=function(){var t=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(t.length?t.join(" "):void 0)},e.prototype.refreshAria=function(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()},e.prototype.addColumnHoverListener=function(){var t=this,e=function(){if(t.gridOptionsService.is("columnHoverHighlight")){var e=t.columnHoverService.isHovered(t.column);t.comp.addOrRemoveCssClass("ag-column-hover",e)}};this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_HOVER_CHANGED,e),e()},e.prototype.setupFilterCss=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-header-cell-filtered",t.column.isFilterActive())};this.addManagedListener(this.column,ht.EVENT_FILTER_ACTIVE_CHANGED,e),e()},e.prototype.getColId=function(){return this.column.getColId()},e.prototype.addActiveHeaderMouseListeners=function(){var t=this,e=function(e){return t.setActiveHeader("mouseenter"===e.type)};this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e)},e.prototype.setActiveHeader=function(t){this.comp.addOrRemoveCssClass("ag-header-active",t)},dp([$("columnModel")],e.prototype,"columnModel",void 0),dp([$("columnHoverService")],e.prototype,"columnHoverService",void 0),dp([$("sortController")],e.prototype,"sortController",void 0),dp([$("menuFactory")],e.prototype,"menuFactory",void 0),dp([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),dp([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),dp([$("gridApi")],e.prototype,"gridApi",void 0),dp([$("columnApi")],e.prototype,"columnApi",void 0),dp([Q],e.prototype,"removeDragSource",null),e}(Vc),gp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},yp=function(t){function e(e,n,r,o){var i=t.call(this)||this;return i.eResize=n,i.comp=e,i.pinned=r,i.columnGroup=o,i}return gp(e,t),e.prototype.postConstruct=function(){var t=this;if(this.columnGroup.isResizable()){var e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gridOptionsService.is("suppressAutoSize")){var n=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",(function(){var e=[];t.columnGroup.getDisplayedLeafColumns().forEach((function(t){t.getColDef().suppressAutoSize||e.push(t.getColId())})),e.length>0&&t.columnModel.autoSizeColumns({columns:e,skipHeader:n,stopAtGroup:t.columnGroup,source:"uiColumnResized"}),t.resizeLeafColumnsToFit("uiColumnResized")}))}}else this.comp.setResizableDisplayed(!1)},e.prototype.onResizeStart=function(t){var e=this;this.calculateInitialValues();var n=null;if(t&&(n=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),n){var r=n.getDisplayedLeafColumns();this.resizeTakeFromCols=r.filter((function(t){return t.isResizable()})),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach((function(t){return e.resizeTakeFromStartWidth+=t.getActualWidth()})),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach((function(t){return e.resizeTakeFromRatios.push(t.getActualWidth()/e.resizeTakeFromStartWidth)}))}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},e.prototype.onResizing=function(t,e,n){void 0===n&&(n="uiColumnResized");var r=this.normaliseDragChange(e),o=this.resizeStartWidth+r;this.resizeColumns(o,n,t)},e.prototype.resizeLeafColumnsToFit=function(t){var e=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),e>this.resizeStartWidth&&this.resizeColumns(e,t,!0)},e.prototype.resizeColumns=function(t,e,n){void 0===n&&(n=!0);var r=[];if(r.push({columns:this.resizeCols,ratios:this.resizeRatios,width:t}),this.resizeTakeFromCols){var o=t-this.resizeStartWidth;r.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-o})}this.columnModel.resizeColumnSets({resizeSets:r,finished:n,source:e}),n&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},e.prototype.calculateInitialValues=function(){var t=this,e=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=e.filter((function(t){return t.isResizable()})),this.resizeStartWidth=0,this.resizeCols.forEach((function(e){return t.resizeStartWidth+=e.getActualWidth()})),this.resizeRatios=[],this.resizeCols.forEach((function(e){return t.resizeRatios.push(e.getActualWidth()/t.resizeStartWidth)}))},e.prototype.normaliseDragChange=function(t){var e=t;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(e*=-1):"right"===this.pinned&&(e*=-1),e},mp([$("horizontalResizeService")],e.prototype,"horizontalResizeService",void 0),mp([$("autoWidthCalculator")],e.prototype,"autoWidthCalculator",void 0),mp([$("columnModel")],e.prototype,"columnModel",void 0),mp([Z],e.prototype,"postConstruct",null),e}(jt),vp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_p=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},wp=function(t){function e(e,n){var r=t.call(this)||this;return r.removeChildListenersFuncs=[],r.columnGroup=n,r.comp=e,r}return vp(e,t),e.prototype.postConstruct=function(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,Kt.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))},e.prototype.addListenersToChildrenColumns=function(){var t=this;this.removeListenersOnChildrenColumns();var e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((function(n){n.addEventListener("widthChanged",e),n.addEventListener("visibleChanged",e),t.removeChildListenersFuncs.push((function(){n.removeEventListener("widthChanged",e),n.removeEventListener("visibleChanged",e)}))}))},e.prototype.removeListenersOnChildrenColumns=function(){this.removeChildListenersFuncs.forEach((function(t){return t()})),this.removeChildListenersFuncs=[]},e.prototype.onDisplayedChildrenChanged=function(){this.addListenersToChildrenColumns(),this.onWidthChanged()},e.prototype.onWidthChanged=function(){var t=this.columnGroup.getActualWidth();this.comp.setWidth(t+"px"),this.comp.addOrRemoveCssClass("ag-hidden",0===t)},_p([Z],e.prototype,"postConstruct",null),e}(jt),Cp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xp=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.columnGroup=e,r}return Cp(e,t),e.prototype.setComp=function(e,n,r){t.prototype.setGui.call(this,n),this.comp=e,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();var o=this.getParentRowCtrl().getPinned(),i=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new qc(i,n)),this.createManagedBean(new Hc(this.columnGroup,n,this.beans)),this.createManagedBean(new wp(e,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new yp(e,r,o,this.columnGroup)),this.createManagedBean(new ko(n,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:function(){},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},e.prototype.resizeLeafColumnsToFit=function(t){this.groupResizeFeature&&this.groupResizeFeature.resizeLeafColumnsToFit(t)},e.prototype.setupUserComp=function(){var t=this,e=this.displayName,n={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:function(e){t.columnModel.setColumnGroupOpened(t.columnGroup.getProvidedColumnGroup(),e,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!e){for(var r=this.columnGroup,o=r.getLeafColumns();r.getParent()&&r.getParent().getLeafColumns().length===o.length;)r=r.getParent();var i=r.getColGroupDef();i&&(e=i.headerName),e||(e=o?this.columnModel.getDisplayNameForColumn(o[0],"header",!0):"")}var s=this.userComponentFactory.getHeaderGroupCompDetails(n);this.comp.setUserCompDetails(s)},e.prototype.setupTooltip=function(){var t=this,e=this.columnGroup.getColGroupDef(),n={getColumn:function(){return t.columnGroup},getGui:function(){return t.eGui},getLocation:function(){return"headerGroup"},getTooltipValue:function(){return e&&e.headerTooltip}};e&&(n.getColDef=function(){return e}),this.createManagedBean(new Wl(n,this.beans)).setComp(this.eGui)},e.prototype.setupExpandable=function(){var t=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(t,ft.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(t,ft.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))},e.prototype.refreshExpanded=function(){var t=this.columnGroup;this.expandable=t.isExpandable();var e=t.isExpanded();this.expandable?this.comp.setAriaExpanded(e?"true":"false"):this.comp.setAriaExpanded(void 0)},e.prototype.getColId=function(){return this.columnGroup.getUniqueId()},e.prototype.addClasses=function(){var t=this,e=this.columnGroup.getColGroupDef(),n=Tc.getHeaderClassesFromColDef(e,this.gridOptionsService,null,this.columnGroup);this.columnGroup.isPadding()?(n.push("ag-header-group-cell-no-group"),this.columnGroup.getLeafColumns().every((function(t){return t.isSpanHeaderHeight()}))&&n.push("ag-header-span-height")):n.push("ag-header-group-cell-with-group");n.forEach((function(e){return t.comp.addOrRemoveCssClass(e,!0)}))},e.prototype.setupMovingCss=function(){var t=this,e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),n=function(){return t.comp.addOrRemoveCssClass("ag-header-cell-moving",t.columnGroup.isMoving())};e.forEach((function(e){t.addManagedListener(e,ht.EVENT_MOVING_CHANGED,n)})),n()},e.prototype.onFocusIn=function(t){if(!this.eGui.contains(t.relatedTarget)){var e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.columnGroup)}},e.prototype.handleKeyDown=function(e){t.prototype.handleKeyDown.call(this,e);var n=this.getWrapperHasFocus();if(this.expandable&&n&&e.key===Yr.ENTER){var r=this.columnGroup,o=!r.isExpanded();this.columnModel.setColumnGroupOpened(r.getProvidedColumnGroup(),o,"uiColumnExpanded")}},e.prototype.setDragSource=function(t){var e=this;if(!this.isSuppressMoving()){var n=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),r=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),o={type:Gi.HeaderCell,eElement:t,defaultIconName:r?zs.ICON_HIDE:zs.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:function(){return n.forEach((function(t){return t.setMoving(!0,"uiColumnDragged")}))},onDragStopped:function(){return n.forEach((function(t){return t.setMoving(!1,"uiColumnDragged")}))},onGridEnter:function(t){var n;if(r){var o=(null===(n=null===t||void 0===t?void 0:t.columns)||void 0===n?void 0:n.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(o,!0,"uiColumnMoved")}},onGridExit:function(t){var n;if(r){var o=(null===(n=null===t||void 0===t?void 0:t.columns)||void 0===n?void 0:n.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(o,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(o,!0),this.addDestroyFunc((function(){return e.dragAndDropService.removeDragSource(o)}))}},e.prototype.getDragItemForGroup=function(){var t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),e={};t.forEach((function(t){return e[t.getId()]=t.isVisible()}));var n=[];return this.columnModel.getAllDisplayedColumns().forEach((function(e){t.indexOf(e)>=0&&(n.push(e),Ct(t,e))})),t.forEach((function(t){return n.push(t)})),{columns:n,visibleState:e}},e.prototype.isSuppressMoving=function(){var t=!1;return this.columnGroup.getLeafColumns().forEach((function(e){(e.getColDef().suppressMovable||e.getColDef().lockPosition)&&(t=!0)})),t||this.gridOptionsService.is("suppressMovableColumns")},bp([$("columnModel")],e.prototype,"columnModel",void 0),bp([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),bp([$("gridApi")],e.prototype,"gridApi",void 0),bp([$("columnApi")],e.prototype,"columnApi",void 0),e}(Vc),Ep=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tp=0,Rp=function(t){function e(e,n,r){var o=t.call(this)||this;o.instanceId=Tp++,o.headerCellCtrls={},o.rowIndex=e,o.pinned=n,o.type=r;var i=r==fc.COLUMN_GROUP?"ag-header-row-column-group":r==fc.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";return o.headerRowClass="ag-header-row "+i,o}return Ep(e,t),e.prototype.postConstruct=function(){this.isPrintLayout=this.gridOptionsService.isDomLayout("print"),this.isEnsureDomOrder=this.gridOptionsService.is("ensureDomOrder")},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.setComp=function(t,e){void 0===e&&(e=!0),this.comp=t,e&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()},e.prototype.getHeaderRowClass=function(){return this.headerRowClass},e.prototype.getAriaRowIndex=function(){return this.rowIndex+1},e.prototype.getTransform=function(){if(Mn())return"translateZ(0)"},e.prototype.addEventListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",(function(e){return t.isEnsureDomOrder=e.currentValue})),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))},e.prototype.getHeaderCellCtrl=function(t){return c(this.headerCellCtrls).find((function(e){return e.getColumnGroupChild()===t}))},e.prototype.onDisplayedColumnsChanged=function(){this.isPrintLayout=this.gridOptionsService.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()},e.prototype.getType=function(){return this.type},e.prototype.onColumnResized=function(){this.setWidth()},e.prototype.setWidth=function(){var t=this.getWidthForRow();this.comp.setWidth(t+"px")},e.prototype.getWidthForRow=function(){return this.isPrintLayout?null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null):this.columnModel.getContainerWidth(this.pinned)},e.prototype.onRowHeightChanged=function(){var t=this.getTopAndHeight(),e=t.topOffset,n=t.rowHeight;this.comp.setTop(e+"px"),this.comp.setHeight(n+"px")},e.prototype.getTopAndHeight=function(){var t=this.columnModel.getHeaderRowCount(),e=[],n=0;this.filterManager.hasFloatingFilters()&&(t++,n=1);for(var r=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),i=t-(1+n),s=0;s<i;s++)e.push(r);e.push(o);for(s=0;s<n;s++)e.push(this.columnModel.getFloatingFiltersHeight());var a=0;for(s=0;s<this.rowIndex;s++)a+=e[s];return{topOffset:a,rowHeight:e[this.rowIndex]}},e.prototype.getPinned=function(){return this.pinned},e.prototype.getRowIndex=function(){return this.rowIndex},e.prototype.onVirtualColumnsChanged=function(){var t=this.getHeaderCtrls(),e=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,e)},e.prototype.getHeaderCtrls=function(){var t=this,e=this.headerCellCtrls;this.headerCellCtrls={},this.getColumnsInViewport().forEach((function(n){if(!n.isEmptyGroup()){var r=n.getUniqueId(),o=e[r];if(delete e[r],o&&o.getColumnGroupChild()!=n&&(t.destroyBean(o),o=void 0),null==o)switch(t.type){case fc.FLOATING_FILTER:o=t.createBean(new Yc(n,t));break;case fc.COLUMN_GROUP:o=t.createBean(new xp(n,t));break;default:o=t.createBean(new fp(n,t))}t.headerCellCtrls[r]=o}}));return g(e,(function(e,n){var r;(r=n,!!t.focusService.isHeaderWrapperFocused(r)&&t.columnModel.isDisplayed(r.getColumnGroupChild()))?t.headerCellCtrls[e]=n:t.destroyBean(n)})),b(this.headerCellCtrls)},e.prototype.getColumnsInViewport=function(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()},e.prototype.getColumnsInViewportPrintLayout=function(){var t=this;if(null!=this.pinned)return[];var e=[],n=this.getActualDepth();return["left",null,"right"].forEach((function(r){var o=t.columnModel.getVirtualHeaderGroupRow(r,n);e=e.concat(o)})),e},e.prototype.getActualDepth=function(){return this.type==fc.FLOATING_FILTER?this.rowIndex-1:this.rowIndex},e.prototype.getColumnsInViewportNormalLayout=function(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())},e.prototype.focusHeader=function(t,e){var n=b(this.headerCellCtrls).find((function(e){return e.getColumnGroupChild()==t}));return!!n&&(n.focus(e),!0)},e.prototype.destroy=function(){var e=this;g(this.headerCellCtrls,(function(t,n){e.destroyBean(n)})),this.headerCellCtrls={},t.prototype.destroy.call(this)},Sp([$("columnModel")],e.prototype,"columnModel",void 0),Sp([$("focusService")],e.prototype,"focusService",void 0),Sp([$("filterManager")],e.prototype,"filterManager",void 0),Sp([Z],e.prototype,"postConstruct",null),e}(jt),Pp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Op=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ip=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ap=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Dp=function(t){function e(e){var n=t.call(this)||this;return n.hidden=!1,n.includeFloatingFilter=!1,n.groupsRowCtrls=[],n.pinned=e,n}return Pp(e,t),e.prototype.setComp=function(t,e){this.comp=t,this.eViewport=e,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,Yt.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()},e.prototype.setupDragAndDrop=function(t){var e=new xc(this.pinned,t);this.createManagedBean(e)},e.prototype.refresh=function(t){var e=this;void 0===t&&(t=!1);var n=new co,r=this.focusService.getFocusHeaderToUseAfterRefresh();!function(){var t=e.columnModel.getHeaderRowCount()-1;e.groupsRowCtrls=e.destroyBeans(e.groupsRowCtrls);for(var r=0;r<t;r++){var o=e.createBean(new Rp(n.next(),e.pinned,fc.COLUMN_GROUP));e.groupsRowCtrls.push(o)}}(),function(){var r=n.next(),o=!e.hidden&&(null==e.columnsRowCtrl||!t||e.columnsRowCtrl.getRowIndex()!==r);(o||e.hidden)&&(e.columnsRowCtrl=e.destroyBean(e.columnsRowCtrl)),o&&(e.columnsRowCtrl=e.createBean(new Rp(r,e.pinned,fc.COLUMN)))}(),function(){e.includeFloatingFilter=e.filterManager.hasFloatingFilters()&&!e.hidden;var r=function(){e.filtersRowCtrl=e.destroyBean(e.filtersRowCtrl)};if(e.includeFloatingFilter){var o=n.next();if(e.filtersRowCtrl){var i=e.filtersRowCtrl.getRowIndex()!==o;t&&!i||r()}e.filtersRowCtrl||(e.filtersRowCtrl=e.createBean(new Rp(o,e.pinned,fc.FLOATING_FILTER)))}else r()}();var o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(r)},e.prototype.restoreFocusOnHeader=function(t){null!=t&&t.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:t})},e.prototype.getAllCtrls=function(){var t=Ap([],Ip(this.groupsRowCtrls));return this.columnsRowCtrl&&t.push(this.columnsRowCtrl),this.filtersRowCtrl&&t.push(this.filtersRowCtrl),t},e.prototype.onGridColumnsChanged=function(){this.refresh(!0)},e.prototype.onDisplayedColumnsChanged=function(){var t=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)},e.prototype.setupCenterWidth=function(){var t=this;null==this.pinned&&this.createManagedBean(new Lu((function(e){return t.comp.setCenterWidth(e+"px")}),!0))},e.prototype.setHorizontalScroll=function(t){this.comp.setViewportScrollLeft(t)},e.prototype.setupPinnedWidth=function(){var t=this;if(null!=this.pinned){var e="left"===this.pinned,n="right"===this.pinned;this.hidden=!0;var r=function(){var r=e?t.pinnedWidthService.getPinnedLeftWidth():t.pinnedWidthService.getPinnedRightWidth();if(null!=r){var o=0==r,i=t.hidden!==o,s=t.gridOptionsService.is("enableRtl"),a=t.gridOptionsService.getScrollbarWidth(),l=t.scrollVisibleService.isVerticalScrollShowing()&&(s&&e||!s&&n)?r+a:r;t.comp.setPinnedContainerWidth(l+"px"),t.comp.setDisplayed(!o),i&&(t.hidden=o,t.refresh())}};this.addManagedListener(this.eventService,Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED,r),this.addManagedListener(this.eventService,Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,r),this.addManagedListener(this.eventService,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,r),this.addManagedListener(this.eventService,Yt.EVENT_SCROLLBAR_WIDTH_CHANGED,r)}},e.prototype.getHeaderCtrlForColumn=function(t){if(t instanceof ht){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(t)}if(0!==this.groupsRowCtrls.length)for(var e=0;e<this.groupsRowCtrls.length;e++){var n=this.groupsRowCtrls[e].getHeaderCellCtrl(t);if(n)return n}},e.prototype.getHtmlElementForColumnHeader=function(t){var e=this.getHeaderCtrlForColumn(t);return e?e.getGui():null},e.prototype.getRowType=function(t){var e=this.getAllCtrls()[t];return e?e.getType():void 0},e.prototype.focusHeader=function(t,e,n){var r=this.getAllCtrls()[t];return!!r&&r.focusHeader(e,n)},e.prototype.getRowCount=function(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)},e.prototype.destroy=function(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),t.prototype.destroy.call(this)},Op([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Op([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Op([$("pinnedWidthService")],e.prototype,"pinnedWidthService",void 0),Op([$("columnModel")],e.prototype,"columnModel",void 0),Op([$("focusService")],e.prototype,"focusService",void 0),Op([$("filterManager")],e.prototype,"filterManager",void 0),e}(jt),Mp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Np=function(t){function e(e){var n=t.call(this)||this;return n.headerRowComps={},n.rowCompsList=[],n.pinned=e,n}return Mp(e,t),e.prototype.init=function(){var t=this;this.selectAndSetTemplate();var e={setDisplayed:function(e){return t.setDisplayed(e)},setCtrls:function(e){return t.setCtrls(e)},setCenterWidth:function(e){return t.eCenterContainer.style.width=e},setViewportScrollLeft:function(e){return t.getGui().scrollLeft=e},setPinnedContainerWidth:function(e){var n=t.getGui();n.style.width=e,n.style.maxWidth=e,n.style.minWidth=e}};this.createManagedBean(new Dp(this.pinned)).setComp(e,this.getGui())},e.prototype.selectAndSetTemplate=function(){var t="left"==this.pinned,n="right"==this.pinned,r=t?e.PINNED_LEFT_TEMPLATE:n?e.PINNED_RIGHT_TEMPLATE:e.CENTER_TEMPLATE;this.setTemplate(r),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()},e.prototype.destroyRowComps=function(){this.setCtrls([])},e.prototype.destroyRowComp=function(t){this.destroyBean(t),this.eRowContainer.removeChild(t.getGui())},e.prototype.setCtrls=function(t){var e,n=this,r=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];t.forEach((function(t){var o=t.getInstanceId(),i=r[o];delete r[o];var s=i||n.createBean(new Fc(t));n.headerRowComps[o]=s,n.rowCompsList.push(s),function(t){var r=t.getGui();r.parentElement!=n.eRowContainer&&n.eRowContainer.appendChild(r),e&&Pr(n.eRowContainer,r,e),e=r}(s)})),b(r).forEach((function(t){return n.destroyRowComp(t)}))},e.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',e.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',e.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',Lp([To("eCenterContainer")],e.prototype,"eCenterContainer",void 0),Lp([Z],e.prototype,"init",null),Lp([Q],e.prototype,"destroyRowComps",null),e}(Eo),Fp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(op||(op={}));var Gp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fp(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.gridBodyCon=e.gridBodyCtrl}))},e.prototype.getHeaderRowCount=function(){var t=this.ctrlsService.getHeaderRowContainerCtrl();return t?t.getRowCount():0},e.prototype.navigateVertically=function(t,e,n){if(e||(e=this.focusService.getFocusedHeader()),!e)return!1;var r=e.headerRowIndex,o=e.column,i=this.getHeaderRowCount(),s=t===op.UP?this.headerPositionUtils.getColumnVisibleParent(o,r):this.headerPositionUtils.getColumnVisibleChild(o,r),a=s.nextRow,l=s.nextFocusColumn,u=!1;return a<0&&(a=0,l=o,u=!0),a>=i&&(a=-1),!(!u&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:n})},e.prototype.navigateHorizontally=function(t,e,n){void 0===e&&(e=!1);var r,o,i=this.focusService.getFocusedHeader();return t===op.LEFT!==this.gridOptionsService.is("enableRtl")?(o="Before",r=this.headerPositionUtils.findHeader(i,o)):(o="After",r=this.headerPositionUtils.findHeader(i,o)),r||!e?this.focusService.focusHeaderPosition({headerPosition:r,direction:o,fromTab:e,allowUserOverride:!0,event:n}):this.focusNextHeaderRow(i,o,n)},e.prototype.focusNextHeaderRow=function(t,e,n){var r,o=t.headerRowIndex,i=null;return"Before"===e?o>0&&(r=o-1,i=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"end")):(r=o+1,i=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"start")),this.focusService.focusHeaderPosition({headerPosition:i,direction:e,fromTab:!0,allowUserOverride:!0,event:n})},e.prototype.scrollToColumn=function(t,e){if(void 0===e&&(e="After"),!t.getPinned()){var n;if(t instanceof Kt){var r=t.getDisplayedLeafColumns();n="Before"===e?yt(r):r[0]}else n=t;this.gridBodyCon.getScrollFeature().ensureColumnVisible(n)}},kp([$("focusService")],e.prototype,"focusService",void 0),kp([$("headerPositionUtils")],e.prototype,"headerPositionUtils",void 0),kp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),kp([Z],e.prototype,"postConstruct",null),e=kp([J("headerNavigationService")],e)}(jt),Bp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Bp(e,t),e.prototype.setComp=function(t,e,n){this.comp=t,this.eGui=e,this.createManagedBean(new ko(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)},e.prototype.setupHeaderHeight=function(){var t=this.setHeaderHeight.bind(this);t(),this.addManagedPropertyListener("headerHeight",t),this.addManagedPropertyListener("pivotHeaderHeight",t),this.addManagedPropertyListener("groupHeaderHeight",t),this.addManagedPropertyListener("pivotGroupHeaderHeight",t),this.addManagedPropertyListener("floatingFiltersHeight",t),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_GRID_STYLES_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,t)},e.prototype.getHeaderHeight=function(){return this.headerHeight},e.prototype.setHeaderHeight=function(){var t,e=this.columnModel,n=0,r=e.getHeaderRowCount();this.filterManager.hasFloatingFilters()&&(r++,n=1);var o=this.columnModel.getColumnGroupHeaderRowHeight(),i=this.columnModel.getColumnHeaderRowHeight(),s=r-(1+n);if(t=n*e.getFloatingFiltersHeight(),t+=s*o,t+=i,this.headerHeight!==t){this.headerHeight=t;var a=t+1+"px";this.comp.setHeightAndMinHeight(a),this.eventService.dispatchEvent({type:Yt.EVENT_HEADER_HEIGHT_CHANGED})}},e.prototype.onPivotModeChanged=function(){var t=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)},e.prototype.onDisplayedColumnsChanged=function(){var t=this.columnModel.getAllDisplayedColumns().some((function(t){return t.isSpanHeaderHeight()}));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)},e.prototype.onTabKeyDown=function(t){var e=this.gridOptionsService.is("enableRtl"),n=t.shiftKey!==e?op.LEFT:op.RIGHT;(this.headerNavigationService.navigateHorizontally(n,!0,t)||this.focusService.focusNextGridCoreContainer(t.shiftKey))&&t.preventDefault()},e.prototype.handleKeyDown=function(t){var e=null;switch(t.key){case Yr.LEFT:e=op.LEFT;case Yr.RIGHT:o(e)||(e=op.RIGHT),this.headerNavigationService.navigateHorizontally(e,!1,t);break;case Yr.UP:e=op.UP;case Yr.DOWN:o(e)||(e=op.DOWN),this.headerNavigationService.navigateVertically(e,null,t)&&t.preventDefault();break;default:return}},e.prototype.onFocusOut=function(t){var e=this.gridOptionsService.getDocument(),n=t.relatedTarget;!n&&this.eGui.contains(e.activeElement)||this.eGui.contains(n)||this.focusService.clearFocusedHeader()},Vp([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),Vp([$("focusService")],e.prototype,"focusService",void 0),Vp([$("columnModel")],e.prototype,"columnModel",void 0),Vp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Vp([$("filterManager")],e.prototype,"filterManager",void 0),e}(jt),jp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Up=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return jp(e,t),e.prototype.postConstruct=function(){var t=this,e={addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},setHeightAndMinHeight:function(e){t.getGui().style.height=e,t.getGui().style.minHeight=e}};this.createManagedBean(new zp).setComp(e,this.getGui(),this.getFocusableElement());var n=function(e){t.createManagedBean(e),t.appendChild(e)};n(new Np("left")),n(new Np(null)),n(new Np("right"))},e.TEMPLATE='<div class="ag-header" role="presentation"/>',Hp([Z],e.prototype,"postConstruct",null),e}(Eo),Wp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Xp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Wp(e,t),e.prototype.addResizeBar=function(t){var e=this,n={dragStartPixels:t.dragStartPixels||0,eElement:t.eResizeBar,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this,t),onDragging:this.onDragging.bind(this,t),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(n);return function(){return e.dragService.removeDragSource(n)}},e.prototype.onDragStart=function(t,e){this.dragStartX=e.clientX,this.setResizeIcons();var n=e instanceof MouseEvent&&!0===e.shiftKey;t.onResizeStart(n)},e.prototype.setResizeIcons=function(){var t=this.ctrlsService.getGridCtrl();t.setResizeCursor(!0),t.disableUserSelect(!0)},e.prototype.onDragStop=function(t,e){t.onResizeEnd(this.resizeAmount),this.resetIcons()},e.prototype.resetIcons=function(){var t=this.ctrlsService.getGridCtrl();t.setResizeCursor(!1),t.disableUserSelect(!1)},e.prototype.onDragging=function(t,e){this.resizeAmount=e.clientX-this.dragStartX,t.onResizing(this.resizeAmount)},qp([$("dragService")],e.prototype,"dragService",void 0),qp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=qp([J("horizontalResizeService")],e)}(jt),Kp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kp(e,t),e.prototype.hideActiveMenu=function(){this.hidePopup&&this.hidePopup()},e.prototype.showMenuAfterMouseEvent=function(t,e){var n=this;this.showPopup(t,(function(r){n.popupService.positionPopupUnderMouseEvent({column:t,type:"columnMenu",mouseEvent:e,ePopup:r})}),"columnMenu",e.target)},e.prototype.showMenuAfterButtonClick=function(t,e,n){var r=this;this.showPopup(t,(function(o){r.popupService.positionPopupByComponent({type:n,eventSource:e,ePopup:o,keepWithinBounds:!0,position:"under",column:t})}),n,e)},e.prototype.showPopup=function(t,e,n,r){var o=this,i=this.filterManager.getOrCreateFilterWrapper(t,"COLUMN_MENU");if(!i)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");var s,a=document.createElement("div");Ye(a,"presentation"),a.classList.add("ag-menu"),this.tabListener=this.addManagedListener(a,"keydown",(function(t){return o.trapFocusWithin(t,a)})),i.guiPromise.then((function(t){return a.appendChild(t)}));var l=r||this.ctrlsService.getGridBodyCtrl().getGui(),u=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:function(e){t.setMenuVisible(!1,"contextMenu");var n=e instanceof KeyboardEvent;if(o.tabListener&&(o.tabListener=o.tabListener()),n&&r&&Er(r)){var s=o.focusService.findTabbableParent(r);s&&s.focus()}!function(){var t;null===(t=i.filterPromise)||void 0===t||t.then((function(t){var e;return null===(e=null===t||void 0===t?void 0:t.afterGuiDetached)||void 0===e?void 0:e.call(t)}))}()},positionCallback:function(){return e(a)},anchorToElement:l,ariaLabel:u("ariaLabelColumnMenu","Column Menu")});c&&(this.hidePopup=s=c.hideFunc),i.filterPromise.then((function(t){e(a),t.afterGuiAttached&&t.afterGuiAttached({container:n,hidePopup:s})})),t.setMenuVisible(!0,"contextMenu")},e.prototype.trapFocusWithin=function(t,e){t.key!==Yr.TAB||t.defaultPrevented||this.focusService.findNextFocusableElement(e,!1,t.shiftKey)||(t.preventDefault(),this.focusService.focusInto(e,t.shiftKey))},e.prototype.isMenuEnabled=function(t){return t.isFilterAllowed()&&t.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")},Yp([$("filterManager")],e.prototype,"filterManager",void 0),Yp([$("popupService")],e.prototype,"popupService",void 0),Yp([$("focusService")],e.prototype,"focusService",void 0),Yp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=Yp([J("menuFactory")],e)}(jt),Qp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jp=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$p=function(t){function e(n){var r=t.call(this,e.getTemplate(n.cssClass))||this;return r.items=[],r.tabbedItemScrollMap=new Map,r.params=n,n.items&&n.items.forEach((function(t){return r.addItem(t)})),r}return Qp(e,t),e.prototype.postConstruct=function(){var t=this;this.createManagedBean(new ko(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc((function(){var e,n,r;return null===(r=null===(n=null===(e=t.activeItem)||void 0===e?void 0:e.tabbedItem)||void 0===n?void 0:n.afterDetachedCallback)||void 0===r?void 0:r.call(n)}))},e.getTemplate=function(t){return'<div class="ag-tabs '+t+'">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header '+(t?t+"-header":"")+'"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body '+(t?t+"-body":"")+'"></div>\n        </div>'},e.prototype.handleKeyDown=function(t){var e=this.gridOptionsService.getDocument();switch(t.key){case Yr.RIGHT:case Yr.LEFT:if(!this.eHeader.contains(e.activeElement))return;var n=t.key===Yr.RIGHT,r=this.gridOptionsService.is("enableRtl"),o=this.items.indexOf(this.activeItem),i=n!==r?Math.min(o+1,this.items.length-1):Math.max(o-1,0);if(o===i)return;t.preventDefault();var s=this.items[i];this.showItemWrapper(s),s.eHeaderButton.focus();break;case Yr.UP:case Yr.DOWN:t.stopPropagation()}},e.prototype.onTabKeyDown=function(t){if(!t.defaultPrevented){var e=this.focusService,n=this.eHeader,r=this.eBody,o=this.activeItem,i=this.gridOptionsService.getDocument().activeElement,s=t.target;if(t.preventDefault(),n.contains(i))e.focusInto(r,t.shiftKey);else{var a=null;e.isTargetUnderManagedComponent(r,s)&&(t.shiftKey&&(a=this.focusService.findFocusableElementBeforeTabGuard(r,s)),a||(a=o.eHeaderButton)),!a&&r.contains(i)&&((a=e.findNextFocusableElement(r,!1,t.shiftKey))||(a=o.eHeaderButton)),a&&a.focus()}}},e.prototype.setAfterAttachedParams=function(t){this.afterAttachedParams=t},e.prototype.showFirstItem=function(){this.items.length>0&&this.showItemWrapper(this.items[0])},e.prototype.addItem=function(t){var e=document.createElement("span");Ye(e,"tab"),e.setAttribute("tabindex","-1"),e.appendChild(t.title),e.classList.add("ag-tab"),this.eHeader.appendChild(e),$e(e,t.titleLabel);var n={tabbedItem:t,eHeaderButton:e};this.items.push(n),e.addEventListener("click",this.showItemWrapper.bind(this,n))},e.prototype.showItem=function(t){var e=this.items.find((function(e){return e.tabbedItem===t}));e&&this.showItemWrapper(e)},e.prototype.showItemWrapper=function(t){var e,n,r=this,o=t.tabbedItem,i=t.eHeaderButton;this.params.onItemClicked&&this.params.onItemClicked({item:o}),this.activeItem!==t?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),br(this.eBody),o.bodyPromise.then((function(t){r.eBody.appendChild(t);var e=!r.focusService.isKeyboardMode();if(r.focusService.focusInto(r.eBody,!1,e),o.afterAttachedCallback&&o.afterAttachedCallback(r.afterAttachedParams),r.params.keepScrollPosition){var n=o.getScrollableContainer&&o.getScrollableContainer()||t;r.lastScrollListener=r.addManagedListener(n,"scroll",(function(){r.tabbedItemScrollMap.set(o.name,n.scrollTop)}));var i=r.tabbedItemScrollMap.get(o.name);void 0!==i&&setTimeout((function(){n.scrollTop=i}),0)}})),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(n=(e=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===n||n.call(e)),i.classList.add("ag-tab-selected"),this.activeItem=t):V(this.params.onActiveItemClicked)},Jp([$("focusService")],e.prototype,"focusService",void 0),Jp([To("eHeader")],e.prototype,"eHeader",void 0),Jp([To("eBody")],e.prototype,"eBody",void 0),Jp([Z],e.prototype,"postConstruct",null),e}(Eo);function th(t){return O((function(){return console.warn("AG Grid: Since v29 simpleHttpRequest has been deprecated as it was only meant for use in internal AG Grid documentation examples. Please use the browser fetch api directly.")}),"simpleHttpRequest"),new fo((function(e){var n=new XMLHttpRequest;n.open("GET",t.url),n.send(),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(JSON.parse(n.responseText))}}))}var eh,nh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},oh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.polyfillFunctions=[],e}return nh(e,t),e.prototype.observeResize=function(t,e){var n=this,r=this.gridOptionsService.getWindow(),o=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!r.ResizeObserver&&!o?function(){var n=new r.ResizeObserver(e);return n.observe(t),function(){return n.disconnect()}}():function(){var r=Rr(t),o=Tr(t),i=!0,s=function(){if(i){var a=Rr(t),l=Tr(t);(a!==r||l!==o)&&(r=a,o=l,e()),n.doNextPolyfillTurn(s)}};return s(),function(){return i=!1}}()},e.prototype.doNextPolyfillTurn=function(t){this.polyfillFunctions.push(t),this.schedulePolyfill()},e.prototype.schedulePolyfill=function(){var t=this;if(!this.polyfillScheduled){this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout((function(){var e=t.polyfillFunctions;t.polyfillScheduled=!1,t.polyfillFunctions=[],e.forEach((function(t){return t()}))}),50)}},e=rh([J("resizeObserverService")],e)}(jt),ih=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ah=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.createTasksP1={list:[],sorted:!1},e.createTasksP2={list:[],sorted:!1},e.destroyTasks=[],e.ticking=!1,e.scrollGoingDown=!0,e.lastPage=0,e.lastScrollTop=0,e.taskCount=0,e.cancelledTasks=new Set,e}return ih(e,t),e.prototype.setScrollTop=function(t){var e=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=t>=this.lastScrollTop,e&&0===t){var n=this.paginationProxy.getCurrentPage();n!==this.lastPage&&(this.lastPage=n,this.scrollGoingDown=!0)}this.lastScrollTop=t},e.prototype.init=function(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")},e.prototype.isOn=function(){return this.useAnimationFrame},e.prototype.verifyAnimationFrameOn=function(t){!1===this.useAnimationFrame&&console.warn("AG Grid: AnimationFrameService."+t+" called but animation frames are off")},e.prototype.createTask=function(t,e,n){this.verifyAnimationFrameOn(n);var r={task:t,index:e,createOrder:++this.taskCount};this.addTaskToList(this[n],r),this.schedule()},e.prototype.cancelTask=function(t){this.cancelledTasks.add(t)},e.prototype.addTaskToList=function(t,e){t.list.push(e),t.sorted=!1},e.prototype.sortTaskList=function(t){if(!t.sorted){var e=this.scrollGoingDown?1:-1;t.list.sort((function(t,n){return t.index!==n.index?e*(n.index-t.index):n.createOrder-t.createOrder})),t.sorted=!0}},e.prototype.addDestroyTask=function(t){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(t),this.schedule()},e.prototype.executeFrame=function(t){this.verifyAnimationFrameOn("executeFrame");for(var e=this.createTasksP1,n=e.list,r=this.createTasksP2,o=r.list,i=this.destroyTasks,s=(new Date).getTime(),a=(new Date).getTime()-s,l=t<=0,u=this.ctrlsService.getGridBodyCtrl();l||a<t;){if(!u.getScrollFeature().scrollGridIfNeeded()){var c=void 0;if(n.length)this.sortTaskList(e),c=n.pop().task;else if(o.length)this.sortTaskList(r),c=o.pop().task;else{if(!i.length){this.cancelledTasks.clear();break}c=i.pop()}this.cancelledTasks.has(c)||c()}a=(new Date).getTime()-s}n.length||o.length||i.length?this.requestFrame():this.stopTicking()},e.prototype.stopTicking=function(){this.ticking=!1},e.prototype.flushAllFrames=function(){this.useAnimationFrame&&this.executeFrame(-1)},e.prototype.schedule=function(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))},e.prototype.requestFrame=function(){var t=this.executeFrame.bind(this,60);this.requestAnimationFrame(t)},e.prototype.requestAnimationFrame=function(t){var e=this.gridOptionsService.getWindow();e.requestAnimationFrame?e.requestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.setTimeout(t,0)},e.prototype.isQueueEmpty=function(){return!this.ticking},e.prototype.debounce=function(t){var e=this,n=!1;return function(){e.isOn()?n||(n=!0,e.addDestroyTask((function(){n=!1,t()}))):e.getFrameworkOverrides().setTimeout(t,0)}},sh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),sh([$("paginationProxy")],e.prototype,"paginationProxy",void 0),sh([Z],e.prototype,"init",null),e=sh([J("animationFrameService")],e)}(jt),lh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),uh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ch=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lh(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.centerRowContainerCtrl=e.centerRowContainerCtrl}))},e.prototype.getPreferredWidthForColumn=function(t,e){var n=this.getHeaderCellForColumn(t);if(!n)return-1;var r=this.rowRenderer.getAllCellsForColumn(t);return e||r.push(n),this.addElementsToContainerAndGetWidth(r)},e.prototype.getPreferredWidthForColumnGroup=function(t){var e=this.getHeaderCellForColumn(t);return e?this.addElementsToContainerAndGetWidth([e]):-1},e.prototype.addElementsToContainerAndGetWidth=function(t){var e=this,n=document.createElement("form");n.style.position="fixed";var r=this.centerRowContainerCtrl.getContainerElement();t.forEach((function(t){return e.cloneItemIntoDummy(t,n)})),r.appendChild(n);var o=n.offsetWidth;return r.removeChild(n),o+this.getAutoSizePadding()},e.prototype.getAutoSizePadding=function(){var t=this.gridOptionsService.getNum("autoSizePadding");return null!=t&&t>=0?t:20},e.prototype.getHeaderCellForColumn=function(t){var e=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(n){var r=n.getHtmlElementForColumnHeader(t);null!=r&&(e=r)})),e},e.prototype.cloneItemIntoDummy=function(t,e){var n=t.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";var r=document.createElement("div"),o=r.classList;["ag-header-cell","ag-header-group-cell"].some((function(t){return n.classList.contains(t)}))?(o.add("ag-header","ag-header-row"),r.style.position="static"):o.add("ag-row");for(var i=t.parentElement;i;){if(["ag-header-row","ag-row"].some((function(t){return i.classList.contains(t)}))){for(var s=0;s<i.classList.length;s++){var a=i.classList[s];"ag-row-position-absolute"!=a&&o.add(a)}break}i=i.parentElement}r.appendChild(n),e.appendChild(r)},uh([$("rowRenderer")],e.prototype,"rowRenderer",void 0),uh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),uh([$("rowCssClassCalculator")],e.prototype,"rowCssClassCalculator",void 0),uh([Z],e.prototype,"postConstruct",null),e=uh([J("autoWidthCalculator")],e)}(jt),ph=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},dh=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fh=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},gh=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},mh=function(t){function e(e,n){var r=t.call(this)||this;return r.createRowCon=e,r.destroyRowCtrls=n,r.stickyRowCtrls=[],r.containerHeight=0,r}return ph(e,t),e.prototype.postConstruct=function(){var t=this;this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady((function(e){t.gridBodyCtrl=e.gridBodyCtrl}))},e.prototype.getStickyRowCtrls=function(){return this.stickyRowCtrls},e.prototype.checkStickyRows=function(){var t=this,e=0;if(!this.gridOptionsService.isGroupRowsSticky())return this.refreshNodesAndContainerHeight([],e);for(var n=[],r=this.rowRenderer.getFirstVisibleVerticalPixel(),o=function(o){var i,s,a,l;if(n.push(o),t.isClientSide){for(var u=o;u.expanded;)if(u.master)u=u.detailNode;else if(u.childrenAfterSort){if(0===u.childrenAfterSort.length)break;u=yt(u.childrenAfterSort)}l=u.rowTop+u.rowHeight}else if(o.master)l=o.detailNode.rowTop+o.detailNode.rowHeight;else{var c=null===(i=o.childStore)||void 0===i?void 0:i.getStoreBounds();l=(null!==(s=null===c||void 0===c?void 0:c.heightPx)&&void 0!==s?s:0)+(null!==(a=null===c||void 0===c?void 0:c.topPx)&&void 0!==a?a:0)}var p=r+e+o.rowHeight;o.stickyRowTop=l<p?e+(l-p):e,e=0,n.forEach((function(t){var n=t.stickyRowTop+t.rowHeight;e<n&&(e=n)}))};;){var i=r+e,s=this.rowModel.getRowIndexAtPixel(i),a=this.rowModel.getRow(s);if(null==a)break;if(a.level<0)break;for(var l=[],u=a.parent;u.level>=0;)l.push(u),u=u.parent;var c=l.reverse().find((function(t){return n.indexOf(t)<0&&t.displayed}));if(c)o(c);else{if(!(a.isExpandable()&&a.expanded&&a.rowTop<i))break;o(a)}}return this.refreshNodesAndContainerHeight(n,e)},e.prototype.refreshStickyNode=function(t){for(var e=[],n=0;n<this.stickyRowCtrls.length;n++){var r=this.stickyRowCtrls[n].getRowNode();r!==t&&e.push(r)}this.refreshNodesAndContainerHeight(e,this.containerHeight)&&this.checkStickyRows()},e.prototype.refreshNodesAndContainerHeight=function(t,e){var n,r,o,i=this,s=!1,a=this.stickyRowCtrls.filter((function(e){return-1===t.indexOf(e.getRowNode())})),l=t.filter((function(t){return-1===i.stickyRowCtrls.findIndex((function(e){return e.getRowNode()===t}))}));(a.length||l.length)&&(s=!0);var u={};a.forEach((function(t){u[t.getRowNode().id]=t,i.stickyRowCtrls=i.stickyRowCtrls.filter((function(e){return e!==t}))}));try{for(var c=dh(Object.values(u)),p=c.next();!p.done;p=c.next()){p.value.getRowNode().sticky=!1}}catch(d){n={error:d}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}this.destroyRowCtrls(u,!1);var h=l.map((function(t){return t.sticky=!0,i.createRowCon(t,!1,!1)}));return(o=this.stickyRowCtrls).push.apply(o,gh([],fh(h))),this.stickyRowCtrls.forEach((function(t){return t.setRowTop(t.getRowNode().stickyRowTop)})),this.stickyRowCtrls.sort((function(t,e){return e.getRowNode().rowIndex-t.getRowNode().rowIndex})),this.containerHeight!==e&&(this.containerHeight=e,this.gridBodyCtrl.setStickyTopHeight(e),s=!0),s},hh([$("rowModel")],e.prototype,"rowModel",void 0),hh([$("rowRenderer")],e.prototype,"rowRenderer",void 0),hh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),hh([Z],e.prototype,"postConstruct",null),e}(jt),yh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_h=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},wh=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Ch=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},bh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyFuncsForColumnListeners=[],e.rowCtrlsByRowIndex={},e.zombieRowCtrls={},e.allRowCtrls=[],e.topRowCtrls=[],e.bottomRowCtrls=[],e.refreshInProgress=!1,e.dataFirstRenderedFired=!1,e}return yh(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl(),t.initialise()}))},e.prototype.initialise=function(){if(this.addManagedListener(this.eventService,Yt.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.isGroupRowsSticky()){var t=this.rowModel.getType();"clientSide"!==t&&"serverSide"!==t||(this.stickyRowFeature=this.createManagedBean(new mh(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()},e.prototype.initialiseCache=function(){if(this.gridOptionsService.is("keepDetailRows")){var t=this.getKeepDetailRowsCount(),e=null!=t?t:3;this.cachedRowCtrls=new xh(e)}},e.prototype.getKeepDetailRowsCount=function(){var t=this.gridOptionsService.getNum("keepDetailRowsCount");return o(t)&&t>0?t:10},e.prototype.getStickyTopRowCtrls=function(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]},e.prototype.updateAllRowCtrls=function(){var t=b(this.rowCtrlsByRowIndex),e=this.gridOptionsService.is("ensureDomOrder"),n=this.gridOptionsService.isDomLayout("print");(e||n)&&t.sort((function(t,e){return t.getRowNode().rowIndex-e.getRowNode.rowIndex}));var r=b(this.zombieRowCtrls),o=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];r.length>0||o.length>0?this.allRowCtrls=wh(wh(wh([],_h(t)),_h(r)),_h(o)):this.allRowCtrls=t},e.prototype.onCellFocusChanged=function(t){this.getAllCellCtrls().forEach((function(e){return e.onCellFocused(t)})),this.getFullWidthRowCtrls().forEach((function(e){return e.onFullWidthRowFocused(t)}))},e.prototype.registerCellEventListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_CELL_FOCUSED,(function(e){t.onCellFocusChanged(e)})),this.addManagedListener(this.eventService,Yt.EVENT_CELL_FOCUS_CLEARED,(function(){t.onCellFocusChanged()})),this.addManagedListener(this.eventService,Yt.EVENT_FLASH_CELLS,(function(e){t.getAllCellCtrls().forEach((function(t){return t.onFlashCells(e)}))})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_HOVER_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onColumnHover()}))})),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onDisplayedColumnsChanged()}))})),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){t.printLayout&&t.getAllCellCtrls().forEach((function(t){return t.onLeftChanged()}))})),this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,Yt.EVENT_RANGE_SELECTION_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onRangeSelectionChanged()}))})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_MOVED,(function(){t.getAllCellCtrls().forEach((function(t){return t.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PINNED,(function(){t.getAllCellCtrls().forEach((function(t){return t.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VISIBLE,(function(){t.getAllCellCtrls().forEach((function(t){return t.updateRangeBordersIfRangeCount()}))}))),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,Yt.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))},e.prototype.removeGridColumnListeners=function(){this.destroyFuncsForColumnListeners.forEach((function(t){return t()})),this.destroyFuncsForColumnListeners.length=0},e.prototype.refreshListenersToColumnsForCellComps=function(){var t=this;this.removeGridColumnListeners();var e=this.columnModel.getAllGridColumns();e&&e.forEach((function(e){var n=function(n){t.getAllCellCtrls().forEach((function(t){t.getColumn()===e&&n(t)}))},r=function(){n((function(t){return t.onLeftChanged()}))},o=function(){n((function(t){return t.onWidthChanged()}))},i=function(){n((function(t){return t.onFirstRightPinnedChanged()}))},s=function(){n((function(t){return t.onLastLeftPinnedChanged()}))},a=function(){n((function(t){return t.onColDefChanged()}))};e.addEventListener("leftChanged",r),e.addEventListener("widthChanged",o),e.addEventListener("firstRightPinnedChanged",i),e.addEventListener("lastLeftPinnedChanged",s),e.addEventListener("colDefChanged",a),t.destroyFuncsForColumnListeners.push((function(){e.removeEventListener("leftChanged",r),e.removeEventListener("widthChanged",o),e.removeEventListener("firstRightPinnedChanged",i),e.removeEventListener("lastLeftPinnedChanged",s),e.removeEventListener("colDefChanged",a)}))}))},e.prototype.onDomLayoutChanged=function(){var t=this.gridOptionsService.isDomLayout("print"),e=t||this.gridOptionsService.is("embedFullWidthRows"),n=e!==this.embedFullWidthRows||this.printLayout!==t;this.printLayout=t,this.embedFullWidthRows=e,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})},e.prototype.datasourceChanged=function(){this.firstRenderedRow=0,this.lastRenderedRow=-1;var t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)},e.prototype.onPageLoaded=function(t){var e={recycleRows:t.keepRenderedRows,animate:t.animate,newData:t.newData,newPage:t.newPage,onlyBody:!0};this.redrawAfterModelUpdate(e)},e.prototype.getAllCellsForColumn=function(t){var e=[];return this.getAllRowCtrls().forEach((function(n){var r=n.getCellElement(t);r&&e.push(r)})),e},e.prototype.refreshFloatingRowComps=function(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())},e.prototype.getTopRowCtrls=function(){return this.topRowCtrls},e.prototype.getCentreRowCtrls=function(){return this.allRowCtrls},e.prototype.getBottomRowCtrls=function(){return this.bottomRowCtrls},e.prototype.refreshFloatingRows=function(t,e){var n=this;t.forEach((function(t){t.destroyFirstPass(),t.destroySecondPass()})),t.length=0,e&&e.forEach((function(e){var r=new hu(e,n.beans,!1,!1,n.printLayout);t.push(r)}))},e.prototype.onPinnedRowDataChanged=function(){this.redrawAfterModelUpdate({recycleRows:!0})},e.prototype.redrawRow=function(t,e){var n=this;if(void 0===e&&(e=!1),t.sticky)this.stickyRowFeature.refreshStickyNode(t);else{var r=function(e){var r=e[t.rowIndex];r&&r.getRowNode()===t&&(r.destroyFirstPass(),r.destroySecondPass(),e[t.rowIndex]=n.createRowCon(t,!1,!1))};switch(t.rowPinned){case"top":r(this.topRowCtrls);case"bottom":r(this.bottomRowCtrls);default:r(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}e||this.dispatchDisplayedRowsChanged(!1)},e.prototype.redrawRows=function(t){var e=this;if(null!=t)return null===t||void 0===t||t.forEach((function(t){return e.redrawRow(t,!0)})),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()},e.prototype.getCellToRestoreFocusToAfterRefresh=function(t){var e=(null===t||void 0===t?void 0:t.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==e)return null;var n=this.gridOptionsService.getDocument().activeElement,r=this.gridOptionsService.getDomData(n,ou.DOM_DATA_KEY_CELL_CTRL),o=this.gridOptionsService.getDomData(n,hu.DOM_DATA_KEY_ROW_CTRL);return r||o?e:null},e.prototype.redrawAfterModelUpdate=function(t){void 0===t&&(t={}),this.getLockOnRefresh();var e=this.getCellToRestoreFocusToAfterRefresh(t);this.updateContainerHeights(),this.scrollToTopIfNewData(t);var n=!t.domLayoutChanged&&!!t.recycleRows,r=t.animate&&this.gridOptionsService.isAnimateRows(),o=n?this.getRowsToRecycle():null;n||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(o,r),this.gridBodyCtrl.updateRowCount(),t.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=e&&this.restoreFocusedCell(e),this.releaseLockOnRefresh()},e.prototype.scrollToTopIfNewData=function(t){var e=t.newData||t.newPage,n=this.gridOptionsService.is("suppressScrollOnNewData");e&&!n&&this.gridBodyCtrl.getScrollFeature().scrollToTop()},e.prototype.updateContainerHeights=function(){if(this.printLayout)this.rowContainerHeightService.setModelHeight(null);else{var t=this.paginationProxy.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t)}},e.prototype.getLockOnRefresh=function(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0},e.prototype.releaseLockOnRefresh=function(){this.refreshInProgress=!1},e.prototype.isRefreshInProgress=function(){return this.refreshInProgress},e.prototype.restoreFocusedCell=function(t){t&&(this.focusService.setRestoreFocusedCell(t),this.onCellFocusChanged({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"}))},e.prototype.stopEditing=function(t){void 0===t&&(t=!1),this.getAllRowCtrls().forEach((function(e){e.stopEditing(t)}))},e.prototype.getAllCellCtrls=function(){for(var t=[],e=this.getAllRowCtrls(),n=e.length,r=0;r<n;r++)for(var o=e[r].getAllCellCtrls(),i=o.length,s=0;s<i;s++)t.push(o[s]);return t},e.prototype.getAllRowCtrls=function(){var t,e,n=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],r=wh(wh(wh([],_h(this.topRowCtrls)),_h(this.bottomRowCtrls)),_h(n));try{for(var o=Ch(Object.keys(this.rowCtrlsByRowIndex)),i=o.next();!i.done;i=o.next()){var s=i.value;r.push(this.rowCtrlsByRowIndex[s])}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.addRenderedRowListener=function(t,e,n){var r=this.rowCtrlsByRowIndex[e];r&&r.addEventListener(t,n)},e.prototype.flashCells=function(t){void 0===t&&(t={});var e=t.flashDelay,n=t.fadeDelay;this.getCellCtrls(t.rowNodes,t.columns).forEach((function(t){return t.flashCell({flashDelay:e,fadeDelay:n})}))},e.prototype.refreshCells=function(t){var e=this;void 0===t&&(t={});var n={forceRefresh:t.force,newData:!1,suppressFlash:t.suppressFlash};this.getCellCtrls(t.rowNodes,t.columns).forEach((function(t){if(t.refreshShouldDestroy()){var e=t.getRowCtrl();e&&e.refreshCell(t)}else t.refreshCell(n)})),t.rowNodes&&(this.getRowCtrls(t.rowNodes).forEach((function(t){t.isFullWidth()&&(t.refreshFullWidth()||e.redrawRow(t.getRowNode(),!0))})),this.dispatchDisplayedRowsChanged(!1))},e.prototype.getCellRendererInstances=function(t){var e,n=this,r=this.getCellCtrls(t.rowNodes,t.columns).map((function(t){return t.getCellRenderer()})).filter((function(t){return null!=t}));if(null===(e=t.columns)||void 0===e?void 0:e.length)return r;var o=[],i=this.mapRowNodes(t.rowNodes);return this.getAllRowCtrls().forEach((function(t){if((!i||n.isRowInMap(t.getRowNode(),i))&&t.isFullWidth()){var e=t.getFullWidthCellRenderer();e&&o.push(e)}})),wh(wh([],_h(o)),_h(r))},e.prototype.getCellEditorInstances=function(t){var e=[];return this.getCellCtrls(t.rowNodes,t.columns).forEach((function(t){var n=t.getCellEditor();n&&e.push(n)})),e},e.prototype.getEditingCells=function(){var t=[];return this.getAllCellCtrls().forEach((function(e){if(e.isEditing()){var n=e.getCellPosition();t.push(n)}})),t},e.prototype.mapRowNodes=function(t){if(t){var e={top:{},bottom:{},normal:{}};return t.forEach((function(t){var n=t.id;"top"===t.rowPinned?e.top[n]=t:"bottom"===t.rowPinned?e.bottom[n]=t:e.normal[n]=t})),e}},e.prototype.isRowInMap=function(t,e){var n=t.id,r=t.rowPinned;return"bottom"===r?null!=e.bottom[n]:"top"===r?null!=e.top[n]:null!=e.normal[n]},e.prototype.getRowCtrls=function(t){var e=this,n=this.mapRowNodes(t),r=this.getAllRowCtrls();return t&&n?r.filter((function(t){var r=t.getRowNode();return e.isRowInMap(r,n)})):r},e.prototype.getCellCtrls=function(t,e){var n,r=this;o(e)&&(n={},e.forEach((function(t){var e=r.columnModel.getGridColumn(t);o(e)&&(n[e.getId()]=!0)})));var i=[];return this.getRowCtrls(t).forEach((function(t){t.getAllCellCtrls().forEach((function(t){var e=t.getColumn().getId();n&&!n[e]||i.push(t)}))})),i},e.prototype.destroy=function(){this.removeAllRowComps(),t.prototype.destroy.call(this)},e.prototype.removeAllRowComps=function(){var t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)},e.prototype.getRowsToRecycle=function(){var t=[];g(this.rowCtrlsByRowIndex,(function(e,n){null==n.getRowNode().id&&t.push(e)})),this.removeRowCtrls(t);var e={};return g(this.rowCtrlsByRowIndex,(function(t,n){var r=n.getRowNode();e[r.id]=n})),this.rowCtrlsByRowIndex={},e},e.prototype.removeRowCtrls=function(t){var e=this;t.forEach((function(t){var n=e.rowCtrlsByRowIndex[t];n&&(n.destroyFirstPass(),n.destroySecondPass()),delete e.rowCtrlsByRowIndex[t]}))},e.prototype.onBodyScroll=function(t){"vertical"===t.direction&&this.redraw({afterScroll:!0})},e.prototype.redraw=function(t){void 0===t&&(t={});var e,n=t.afterScroll;this.stickyRowFeature&&Bn()&&(e=this.getCellToRestoreFocusToAfterRefresh()||void 0);var r=this.firstRenderedRow,o=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();var i=!1;this.stickyRowFeature&&(i=this.stickyRowFeature.checkStickyRows());var s=this.firstRenderedRow!==r||this.lastRenderedRow!==o;if((!n||i||s)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n),null!=e)){var a=this.getCellToRestoreFocusToAfterRefresh();null!=e&&null==a&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(e))}},e.prototype.removeRowCompsNotToDraw=function(t){var e={};t.forEach((function(t){return e[t]=!0}));var n=Object.keys(this.rowCtrlsByRowIndex).filter((function(t){return!e[t]}));this.removeRowCtrls(n)},e.prototype.calculateIndexesToDraw=function(t){var e=this,n=Yn(this.firstRenderedRow,this.lastRenderedRow),r=function(t,r){var o=r.getRowNode().rowIndex;null!=o&&(o<e.firstRenderedRow||o>e.lastRenderedRow)&&e.doNotUnVirtualiseRow(r)&&n.push(o)};g(this.rowCtrlsByRowIndex,r),g(t,r),n.sort((function(t,e){return t-e}));for(var o=[],i=0;i<n.length;i++){var s=n[i],a=this.paginationProxy.getRow(s);a&&!a.sticky&&o.push(s)}return o},e.prototype.recycleRows=function(t,e,n){var r=this;void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.calculateIndexesToDraw(t);(this.removeRowCompsNotToDraw(i),this.printLayout&&(e=!1),i.forEach((function(i){o(r.createOrUpdateRowCtrl(i,t,e,n))})),t)&&(n&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask((function(){r.destroyRowCtrls(t,e),r.updateAllRowCtrls(),r.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(t,e));this.updateAllRowCtrls()},e.prototype.dispatchDisplayedRowsChanged=function(t){void 0===t&&(t=!1);var e={type:Yt.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:t};this.eventService.dispatchEvent(e)},e.prototype.onDisplayedColumnsChanged=function(){var t=this.columnModel.isPinningLeft(),e=this.columnModel.isPinningRight();(this.pinningLeft!==t||e!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=e,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())},e.prototype.redrawFullWidthEmbeddedRows=function(){var t=[];this.getFullWidthRowCtrls().forEach((function(e){var n=e.getRowNode().rowIndex;t.push(n.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(t),this.redraw({afterScroll:!0})},e.prototype.getFullWidthRowCtrls=function(t){var e=this,n=this.mapRowNodes(t);return this.getAllRowCtrls().filter((function(t){if(!t.isFullWidth())return!1;var r=t.getRowNode();return!(null!=n&&!e.isRowInMap(r,n))}))},e.prototype.createOrUpdateRowCtrl=function(t,e,n,r){var i,s=this.rowCtrlsByRowIndex[t];if(s||o(i=this.paginationProxy.getRow(t))&&o(e)&&e[i.id]&&i.alreadyRendered&&(s=e[i.id],e[i.id]=null),!s){if(i||(i=this.paginationProxy.getRow(t)),!o(i))return;s=this.createRowCon(i,n,r)}return i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[t]=s,s},e.prototype.destroyRowCtrls=function(t,e){var n=this,r=[];g(t,(function(t,o){o&&(n.cachedRowCtrls&&o.isCacheable()?n.cachedRowCtrls.addRow(o):(o.destroyFirstPass(),e?(n.zombieRowCtrls[o.getInstanceId()]=o,r.push((function(){o.destroySecondPass(),delete n.zombieRowCtrls[o.getInstanceId()]}))):o.destroySecondPass()))})),e&&(r.push((function(){n.updateAllRowCtrls(),n.dispatchDisplayedRowsChanged()})),D(r))},e.prototype.getRowBuffer=function(){var t=this.gridOptionsService.getNum("rowBuffer");return"number"===typeof t?t<0&&(O((function(){return console.warn("AG Grid: rowBuffer should not be negative")}),"warn rowBuffer negative"),t=0,this.gridOptionsService.set("rowBuffer",0)):t=10,t},e.prototype.getRowBufferInPixels=function(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()},e.prototype.workOutFirstAndLastRowsToRender=function(){var t,e;if(this.rowContainerHeightService.updateOffset(),this.paginationProxy.isRowsToRender())if(this.printLayout)t=this.paginationProxy.getPageFirstRow(),e=this.paginationProxy.getPageLastRow();else{var n=this.getRowBufferInPixels(),r=this.ctrlsService.getGridBodyCtrl(),o=this.gridOptionsService.is("suppressRowVirtualisation"),i=!1,s=void 0,a=void 0;do{var l=this.paginationProxy.getPixelOffset(),u=this.paginationProxy.getCurrentPagePixelRange(),c=u.pageFirstPixel,p=u.pageLastPixel,h=this.rowContainerHeightService.getDivStretchOffset(),d=r.getScrollFeature().getVScrollPosition(),f=d.top,g=d.bottom;o?(s=c+h,a=p+h):(s=Math.max(f+l-n,c)+h,a=Math.min(g+l+n,p)+h),this.firstVisibleVPixel=Math.max(f+l,c)+h,i=this.ensureAllRowsInRangeHaveHeightsCalculated(s,a)}while(i);var m=this.paginationProxy.getRowIndexAtPixel(s),y=this.paginationProxy.getRowIndexAtPixel(a),v=this.paginationProxy.getPageFirstRow(),_=this.paginationProxy.getPageLastRow();m<v&&(m=v),y>_&&(y=_),t=m,e=y}else t=0,e=-1;var w=this.gridOptionsService.isDomLayout("normal"),C=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),b=Math.max(this.getRowBuffer(),500);w&&!C&&e-t>b&&(e=t+b);var x=t!==this.firstRenderedRow,E=e!==this.lastRenderedRow;if(x||E){this.firstRenderedRow=t,this.lastRenderedRow=e;var S={type:Yt.EVENT_VIEWPORT_CHANGED,firstRow:t,lastRow:e};this.eventService.dispatchEvent(S)}},e.prototype.dispatchFirstDataRenderedEvent=function(){var t=this;if(!this.dataFirstRenderedFired){this.dataFirstRenderedFired=!0;var e={type:Yt.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame((function(){t.beans.eventService.dispatchEvent(e)}))}},e.prototype.ensureAllRowsInRangeHaveHeightsCalculated=function(t,e){var n=this.paginationProxy.ensureRowHeightsValid(t,e,-1,-1);return n&&this.updateContainerHeights(),n},e.prototype.getFirstVisibleVerticalPixel=function(){return this.firstVisibleVPixel},e.prototype.getFirstVirtualRenderedRow=function(){return this.firstRenderedRow},e.prototype.getLastVirtualRenderedRow=function(){return this.lastRenderedRow},e.prototype.doNotUnVirtualiseRow=function(t){var e=t.getRowNode(),n=this.focusService.isRowNodeFocused(e),r=t.isEditing(),o=e.detail;return!!(n||r||o)&&!!this.paginationProxy.isRowPresent(e)},e.prototype.createRowCon=function(t,e,n){var r=this.cachedRowCtrls?this.cachedRowCtrls.getRow(t):null;if(r)return r;var o=this.gridOptionsService.is("suppressAnimationFrame"),i=n&&!o&&!this.printLayout;return new hu(t,this.beans,e,i,this.printLayout)},e.prototype.getRenderedNodes=function(){var t=this.rowCtrlsByRowIndex;return Object.keys(t).map((function(e){return t[e].getRowNode()}))},e.prototype.getRowByPosition=function(t){var e,n=t.rowIndex;switch(t.rowPinned){case"top":e=this.topRowCtrls[n];break;case"bottom":e=this.bottomRowCtrls[n];break;default:(e=this.rowCtrlsByRowIndex[n])||(e=this.getStickyTopRowCtrls().find((function(t){return t.getRowNode().rowIndex===n}))||null)}return e},e.prototype.getRowNode=function(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},e.prototype.isRangeInRenderedViewport=function(t,e){if(null==t||null==e)return!1;var n=t>this.lastRenderedRow;return!(e<this.firstRenderedRow)&&!n},vh([$("animationFrameService")],e.prototype,"animationFrameService",void 0),vh([$("paginationProxy")],e.prototype,"paginationProxy",void 0),vh([$("columnModel")],e.prototype,"columnModel",void 0),vh([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),vh([$("rowModel")],e.prototype,"rowModel",void 0),vh([$("focusService")],e.prototype,"focusService",void 0),vh([$("beans")],e.prototype,"beans",void 0),vh([$("rowContainerHeightService")],e.prototype,"rowContainerHeightService",void 0),vh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),vh([Z],e.prototype,"postConstruct",null),e=vh([J("rowRenderer")],e)}(jt),xh=function(){function t(t){this.entriesMap={},this.entriesList=[],this.maxCount=t}return t.prototype.addRow=function(t){if(this.entriesMap[t.getRowNode().id]=t,this.entriesList.push(t),t.setCached(!0),this.entriesList.length>this.maxCount){var e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}},t.prototype.getRow=function(t){if(null==t||null==t.id)return null;var e=this.entriesMap[t.id];return e?(this.removeFromCache(e),e.setCached(!1),e.getRowNode()!=t?null:e):null},t.prototype.removeFromCache=function(t){var e=t.getRowNode().id;delete this.entriesMap[e],Ct(this.entriesList,t)},t.prototype.getEntries=function(){return this.entriesList},t}(),Eh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Th=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Eh(e,t),e.prototype.formatValue=function(t,e,n,r,o){void 0===o&&(o=!0);var i,s=null,a=t.getColDef();if(r?i=r:o&&(i=a.valueFormatter),i){var l={value:n,node:e,data:e?e.data:null,colDef:a,column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};s="function"===typeof i?i(l):this.expressionService.evaluate(i,l)}else if(a.refData)return a.refData[n]||"";return null==s&&Array.isArray(n)&&(s=n.join(", ")),s},Sh([$("expressionService")],e.prototype,"expressionService",void 0),e=Sh([J("valueFormatterService")],e)}(jt),Rh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ph=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Oh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Rh(e,t),e.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))},e.prototype.isEmpty=function(t){return s("top"===t?this.pinnedTopRows:this.pinnedBottomRows)},e.prototype.isRowsToRender=function(t){return!this.isEmpty(t)},e.prototype.getRowAtPixel=function(t,e){var n="top"===e?this.pinnedTopRows:this.pinnedBottomRows;if(s(n))return 0;for(var r=0;r<n.length;r++){var o=n[r];if(o.rowTop+o.rowHeight-1>=t)return r}return n.length-1},e.prototype.setPinnedTopRowData=function(t){this.pinnedTopRows=this.createNodesFromData(t,!0);var e={type:Yt.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.setPinnedBottomRowData=function(t){this.pinnedBottomRows=this.createNodesFromData(t,!1);var e={type:Yt.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.createNodesFromData=function(t,e){var n=this,r=[];if(t){var o=0;t.forEach((function(t,i){var s=new Ds(n.beans);s.data=t;var a=e?Ds.ID_PREFIX_TOP_PINNED:Ds.ID_PREFIX_BOTTOM_PINNED;s.id=a+i,s.rowPinned=e?"top":"bottom",s.setRowTop(o),s.setRowHeight(n.gridOptionsService.getRowHeightForNode(s).height),s.setRowIndex(i),o+=s.rowHeight,r.push(s)}))}return r},e.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},e.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},e.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},e.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},e.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},e.prototype.getPinnedTopRow=function(t){return this.pinnedTopRows[t]},e.prototype.getPinnedBottomRow=function(t){return this.pinnedBottomRows[t]},e.prototype.forEachPinnedTopRow=function(t){s(this.pinnedTopRows)||this.pinnedTopRows.forEach(t)},e.prototype.forEachPinnedBottomRow=function(t){s(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(t)},e.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},e.prototype.getTotalHeight=function(t){if(!t||0===t.length)return 0;var e=yt(t);return e.rowTop+e.rowHeight},Ph([$("beans")],e.prototype,"beans",void 0),Ph([Z],e.prototype,"init",null),e=Ph([J("pinnedRowModel")],e)}(jt);!function(t){t.Applied="Applied",t.StoreNotFound="StoreNotFound",t.StoreLoading="StoreLoading",t.StoreWaitingToLoad="StoreWaitingToLoad",t.StoreLoadingFailed="StoreLoadingFailed",t.StoreWrongType="StoreWrongType",t.Cancelled="Cancelled"}(eh||(eh={}));var Ih,Ah=function(){function t(t,e){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=t,this.pathRoot={rowNode:e,children:null},this.mapToItems[e.id]=this.pathRoot}return t.prototype.setInactive=function(){this.active=!1},t.prototype.isActive=function(){return this.active},t.prototype.depthFirstSearchChangedPath=function(t,e){if(t.children)for(var n=0;n<t.children.length;n++)this.depthFirstSearchChangedPath(t.children[n],e);e(t.rowNode)},t.prototype.depthFirstSearchEverything=function(t,e,n){if(t.childrenAfterGroup)for(var r=0;r<t.childrenAfterGroup.length;r++){var o=t.childrenAfterGroup[r];o.childrenAfterGroup?this.depthFirstSearchEverything(t.childrenAfterGroup[r],e,n):n&&e(o)}e(t)},t.prototype.forEachChangedNodeDepthFirst=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1),this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,t):this.depthFirstSearchEverything(this.pathRoot.rowNode,t,e)},t.prototype.executeFromRootNode=function(t){t(this.pathRoot.rowNode)},t.prototype.createPathItems=function(t){for(var e=t,n=0;!this.mapToItems[e.id];){var r={rowNode:e,children:null};this.mapToItems[e.id]=r,n++,e=e.parent}return n},t.prototype.populateColumnsMap=function(t,e){var n=this;if(this.keepingColumns&&e)for(var r=t;r;)this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={}),e.forEach((function(t){return n.nodeIdsToColumns[r.id][t.getId()]=!0})),r=r.parent},t.prototype.linkPathItems=function(t,e){for(var n=t,r=0;r<e;r++){var o=this.mapToItems[n.id],i=this.mapToItems[n.parent.id];i.children||(i.children=[]),i.children.push(o),n=n.parent}},t.prototype.addParentNode=function(t,e){if(t&&!t.isRowPinned()){var n=this.createPathItems(t);this.linkPathItems(t,n),this.populateColumnsMap(t,e)}},t.prototype.canSkip=function(t){return this.active&&!this.mapToItems[t.id]},t.prototype.getValueColumnsForNode=function(t,e){if(!this.keepingColumns)return e;var n=this.nodeIdsToColumns[t.id];return e.filter((function(t){return n[t.getId()]}))},t.prototype.getNotValueColumnsForNode=function(t,e){if(!this.keepingColumns)return null;var n=this.nodeIdsToColumns[t.id];return e.filter((function(t){return!n[t.getId()]}))},t}(),Dh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mh=function(t){function e(n){var r=t.call(this)||this;return r.state=e.STATE_WAITING_TO_LOAD,r.version=0,r.id=n,r}return Dh(e,t),e.prototype.getId=function(){return this.id},e.prototype.load=function(){this.state=e.STATE_LOADING,this.loadFromDatasource()},e.prototype.getVersion=function(){return this.version},e.prototype.setStateWaitingToLoad=function(){this.version++,this.state=e.STATE_WAITING_TO_LOAD},e.prototype.getState=function(){return this.state},e.prototype.pageLoadFailed=function(t){this.isRequestMostRecentAndLive(t)&&(this.state=e.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)},e.prototype.success=function(t,e){this.successCommon(t,e)},e.prototype.pageLoaded=function(t,e,n){this.successCommon(t,{rowData:e,rowCount:n})},e.prototype.isRequestMostRecentAndLive=function(t){var e=t===this.version,n=this.isAlive();return e&&n},e.prototype.successCommon=function(t,n){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(t)&&(this.state=e.STATE_LOADED,this.processServerResult(n))},e.prototype.dispatchLoadCompleted=function(t){void 0===t&&(t=!0);var n={type:e.EVENT_LOAD_COMPLETE,success:t,block:this};this.dispatchEvent(n)},e.EVENT_LOAD_COMPLETE="loadComplete",e.STATE_WAITING_TO_LOAD="needsLoading",e.STATE_LOADING="loading",e.STATE_LOADED="loaded",e.STATE_FAILED="failed",e}(jt),Lh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Fh=function(t,e){return function(n,r){e(n,r,t)}},kh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeBlockLoadsCount=0,e.blocks=[],e.active=!0,e}var n;return Lh(e,t),n=e,e.prototype.postConstruct=function(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();var t=this.gridOptionsService.getNum("blockLoadDebounceMillis");t&&t>0&&(this.checkBlockToLoadDebounce=uo.debounce(this.performCheckBlocksToLoad.bind(this),t))},e.prototype.setBeans=function(t){this.logger=t.create("RowNodeBlockLoader")},e.prototype.getMaxConcurrentDatasourceRequests=function(){var t=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==t?2:t<=0?void 0:t},e.prototype.addBlock=function(t){this.blocks.push(t),t.addEventListener(Mh.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()},e.prototype.removeBlock=function(t){uo.removeFromArray(this.blocks,t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.active=!1},e.prototype.loadComplete=function(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:n.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:n.BLOCK_LOADER_FINISHED_EVENT})},e.prototype.checkBlockToLoad=function(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()},e.prototype.performCheckBlocksToLoad=function(){if(this.active)if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)this.logger.log("checkBlockToLoad: max loads exceeded");else{var t=this.getAvailableLoadingCount(),e=this.blocks.filter((function(t){return t.getState()===Mh.STATE_WAITING_TO_LOAD})).slice(0,t);this.registerLoads(e.length),e.forEach((function(t){return t.load()})),this.printCacheStatus()}},e.prototype.getBlockState=function(){if(this.gridOptionsService.isRowModelType("serverSide"))return this.rowModel.getBlockStates();var t={};return this.blocks.forEach((function(e){var n=e.getBlockStateJson(),r=n.id,o=n.state;t[r]=o})),t},e.prototype.printCacheStatus=function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = "+this.activeBlockLoadsCount+", blocks = "+JSON.stringify(this.getBlockState()))},e.prototype.isLoading=function(){return this.activeBlockLoadsCount>0},e.prototype.registerLoads=function(t){this.activeBlockLoadsCount+=t},e.prototype.getAvailableLoadingCount=function(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0},e.BLOCK_LOADED_EVENT="blockLoaded",e.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",Nh([$("rowModel")],e.prototype,"rowModel",void 0),Nh([Z],e.prototype,"postConstruct",null),Nh([Fh(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=n=Nh([J("rowNodeBlockLoader")],e)}(jt),Gh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Vh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentPage=0,e.topDisplayedRowIndex=0,e.bottomDisplayedRowIndex=0,e.pixelOffset=0,e.masterRowCount=0,e}return Gh(e,t),e.prototype.postConstruct=function(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,Yt.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()},e.prototype.ensureRowHeightsValid=function(t,e,n,r){var o=this.rowModel.ensureRowHeightsValid(t,e,this.getPageFirstRow(),this.getPageLastRow());return o&&this.calculatePages(),o},e.prototype.isPaginateChildRows=function(){return!(!this.gridOptionsService.is("groupRemoveSingleChildren")&&!this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")},e.prototype.onModelUpdated=function(t){this.calculatePages();var e={type:Yt.EVENT_PAGINATION_CHANGED,animate:!!t&&t.animate,newData:!!t&&t.newData,newPage:!!t&&t.newPage,keepRenderedRows:!!t&&t.keepRenderedRows};this.eventService.dispatchEvent(e)},e.prototype.onPaginationPageSizeChanged=function(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();var t={type:Yt.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(t)},e.prototype.goToPage=function(t){if(this.active&&this.currentPage!==t&&"number"===typeof this.currentPage){this.currentPage=t;var e={type:Yt.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(e)}},e.prototype.getPixelOffset=function(){return this.pixelOffset},e.prototype.getRow=function(t){return this.rowModel.getRow(t)},e.prototype.getRowNode=function(t){return this.rowModel.getRowNode(t)},e.prototype.getRowIndexAtPixel=function(t){return this.rowModel.getRowIndexAtPixel(t)},e.prototype.getCurrentPageHeight=function(){return i(this.topRowBounds)||i(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)},e.prototype.getCurrentPagePixelRange=function(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}},e.prototype.isRowPresent=function(t){return!!this.rowModel.isRowPresent(t)&&(t.rowIndex>=this.topDisplayedRowIndex&&t.rowIndex<=this.bottomDisplayedRowIndex)},e.prototype.isEmpty=function(){return this.rowModel.isEmpty()},e.prototype.isRowsToRender=function(){return this.rowModel.isRowsToRender()},e.prototype.forEachNode=function(t){return this.rowModel.forEachNode(t)},e.prototype.forEachNodeOnPage=function(t){for(var e=this.getPageFirstRow(),n=this.getPageLastRow(),r=e;r<=n;r++){var o=this.getRow(r);o&&t(o)}},e.prototype.getType=function(){return this.rowModel.getType()},e.prototype.getRowBounds=function(t){var e=this.rowModel.getRowBounds(t);return e.rowIndex=t,e},e.prototype.getPageFirstRow=function(){return this.topRowBounds?this.topRowBounds.rowIndex:-1},e.prototype.getPageLastRow=function(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1},e.prototype.getRowCount=function(){return this.rowModel.getRowCount()},e.prototype.getPageForIndex=function(t){return Math.floor(t/this.pageSize)},e.prototype.goToPageWithIndex=function(t){if(this.active){var e=this.getPageForIndex(t);this.goToPage(e)}},e.prototype.isRowInPage=function(t){return!this.active||this.getPageForIndex(t.rowIndex)===this.currentPage},e.prototype.isLastPageFound=function(){return this.rowModel.isLastRowIndexKnown()},e.prototype.getCurrentPage=function(){return this.currentPage},e.prototype.goToNextPage=function(){this.goToPage(this.currentPage+1)},e.prototype.goToPreviousPage=function(){this.goToPage(this.currentPage-1)},e.prototype.goToFirstPage=function(){this.goToPage(0)},e.prototype.goToLastPage=function(){var t=this.rowModel.getRowCount(),e=Math.floor(t/this.pageSize);this.goToPage(e)},e.prototype.getPageSize=function(){return this.pageSize},e.prototype.getTotalPages=function(){return this.totalPages},e.prototype.setPageSize=function(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)},e.prototype.calculatePages=function(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(o(this.topRowBounds)?this.topRowBounds.rowTop:0)},e.prototype.setPixelOffset=function(t){this.pixelOffset!==t&&(this.pixelOffset=t,this.eventService.dispatchEvent({type:Yt.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))},e.prototype.setZeroRows=function(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0},e.prototype.adjustCurrentPageIfInvalid=function(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)},e.prototype.calculatePagesMasterRowsOnly=function(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)this.setZeroRows();else{var t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.adjustCurrentPageIfInvalid();var e=this.pageSize*this.currentPage,n=this.pageSize*(this.currentPage+1)-1;if(n>t&&(n=t),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(e),n===t)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{var r=this.rowModel.getTopLevelRowDisplayedIndex(n+1);this.bottomDisplayedRowIndex=r-1}}},e.prototype.getMasterRowCount=function(){return this.masterRowCount},e.prototype.calculatePagesAllRows=function(){if(this.masterRowCount=this.rowModel.getRowCount(),0!==this.masterRowCount){var t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>t&&(this.bottomDisplayedRowIndex=t)}else this.setZeroRows()},e.prototype.calculatedPagesNotActive=function(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1},Bh([$("rowModel")],e.prototype,"rowModel",void 0),Bh([Z],e.prototype,"postConstruct",null),e=Bh([J("paginationProxy")],e)}(jt),zh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jh=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Hh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zh(e,t),e.prototype.processAllCellClasses=function(t,e,n,r){this.processClassRules(t.cellClassRules,e,n,r),this.processStaticCellClasses(t,e,n)},e.prototype.processClassRules=function(t,e,n,r){if(null!=t){for(var o=Object.keys(t),i={},s={},a=function(n){var r,a=o[n],u=t[a];"string"===typeof u?r=l.expressionService.evaluate(u,e):"function"===typeof u&&(r=u(e)),a.split(" ").forEach((function(t){null!=t&&""!=t.trim()&&(r?i[t]=!0:s[t]=!0)}))},l=this,u=0;u<o.length;u++)a(u);r&&Object.keys(s).forEach(r),Object.keys(i).forEach(n)}},e.prototype.getStaticCellClasses=function(t,e){var n,r=t.cellClass;if(!r)return[];"function"===typeof r?n=r(e):n=r;return"string"===typeof n&&(n=[n]),n||[]},e.prototype.processStaticCellClasses=function(t,e,n){this.getStaticCellClasses(t,e).forEach((function(t){n(t)}))},jh([$("expressionService")],e.prototype,"expressionService",void 0),e=jh([J("stylingService")],e)}(jt),Uh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wh=function(t){function e(e){return t.call(this,e,"ag-toggle-button")||this}return Uh(e,t),e.prototype.setValue=function(e,n){return t.prototype.setValue.call(this,e,n),this.addOrRemoveCssClass("ag-selected",this.getValue()),this},e}(li),qh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xh=function(t){function e(e){return t.call(this,e,"ag-text-area",null,"textarea")||this}return qh(e,t),e.prototype.setValue=function(e,n){var r=t.prototype.setValue.call(this,e,n);return this.eInput.value=e,r},e.prototype.setCols=function(t){return this.eInput.cols=t,this},e.prototype.setRows=function(t){return this.eInput.rows=t,this},e}(si),Kh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yh=function(t){function e(e){return t.call(this,e,"ag-date-field","date")||this}return Kh(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));var n=Mn();this.addManagedListener(this.eInput,"mousedown",(function(){e.isDisabled()||n||e.eInput.focus()})),this.eInput.step="any"},e.prototype.onWheel=function(t){document.activeElement===this.eInput&&t.preventDefault()},e.prototype.setMin=function(t){var e,n=t instanceof Date?null!==(e=$n(null!==t&&void 0!==t?t:null,!1))&&void 0!==e?e:void 0:t;return this.min===n||(this.min=n,zr(this.eInput,"min",n)),this},e.prototype.setMax=function(t){var e,n=t instanceof Date?null!==(e=$n(null!==t&&void 0!==t?t:null,!1))&&void 0!==e?e:void 0:t;return this.max===n||(this.max=n,zr(this.eInput,"max",n)),this},e.prototype.setStep=function(t){return this.step===t||(this.step=t,zr(this.eInput,"step",t)),this},e.prototype.getDate=function(){var t;if(this.eInput.validity.valid)return null!==(t=nr(this.getValue()))&&void 0!==t?t:void 0},e.prototype.setDate=function(t,e){this.setValue($n(null!==t&&void 0!==t?t:null,!1),e)},e}(Di),Zh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qh=function(t){function e(e){return t.call(this,e,"ag-range-field","range")||this}return Zh(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this);var e=this.config,n=e.min,r=e.max,o=e.step;null!=n&&this.setMinValue(n),null!=r&&this.setMaxValue(r),this.setStep(o||1)},e.prototype.addInputListeners=function(){var t=this;this.addManagedListener(this.eInput,"input",(function(e){var n=e.target.value;t.setValue(n)}))},e.prototype.setMinValue=function(t){return this.min=t,this.eInput.setAttribute("min",t.toString()),this},e.prototype.setMaxValue=function(t){return this.max=t,this.eInput.setAttribute("max",t.toString()),this},e.prototype.setStep=function(t){return this.eInput.setAttribute("step",t.toString()),this},e.prototype.setValue=function(e,n){null!=this.min&&(e=Math.max(parseFloat(e),this.min).toString()),null!=this.max&&(e=Math.min(parseFloat(e),this.max).toString());var r=t.prototype.setValue.call(this,e,n);return this.eInput.value=e,r},e}(si),Jh=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$h=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},td=function(t){function e(e,n){var r=t.call(this,'<div class="ag-rich-select-row" role="presentation"></div>')||this;return r.params=e,r.wrapperEl=n,r}return Jh(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.getGui(),"mouseup",this.onMouseUp.bind(this))},e.prototype.setState=function(t,e){var n="";this.params.valueFormatter&&(n=this.params.valueFormatter(t)),this.populateWithRenderer(t,n)||this.populateWithoutRenderer(t,n),this.value=t},e.prototype.updateHighlighted=function(t){var e,n=this.getGui(),r="ag-rich-select-row-"+this.getCompId();(null===(e=n.parentElement)||void 0===e||e.setAttribute("id",r),t)&&(this.getParentComponent().getAriaElement().setAttribute("aria-activedescendant",r),this.wrapperEl.setAttribute("data-active-option",r));wn(n.parentElement,t),this.addOrRemoveCssClass("ag-rich-select-row-selected",t)},e.prototype.populateWithoutRenderer=function(t,e){var n=this.gridOptionsService.getDocument(),r=this.getGui(),i=n.createElement("span");i.style.overflow="hidden",i.style.textOverflow="ellipsis";var s=re(o(e)?e:t);i.textContent=o(s)?s:"&nbsp;",r.appendChild(i)},e.prototype.populateWithRenderer=function(t,e){var n,r,o=this;return this.params.cellRenderer&&(r=this.userComponentFactory.getCellRendererDetails(this.params,{value:t,valueFormatted:e,api:this.gridOptionsService.api})),r&&(n=r.newAgStackInstance()),n&&Hr(n,this.getGui()),!!n&&(n.then((function(t){o.addDestroyFunc((function(){o.getContext().destroyBean(t)}))})),!0)},e.prototype.onMouseUp=function(){var t=this.getParentComponent(),e={type:Yt.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};null===t||void 0===t||t.dispatchEvent(e)},$h([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),$h([Z],e.prototype,"postConstruct",null),e}(Eo),ed=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nd=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},rd=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ed(e,t),e.prototype.initialiseTabGuard=function(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();var e=[this.eTopGuard,this.eBottomGuard],n={setTabIndex:function(t){e.forEach((function(e){return null!=t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new ip({comp:n,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:t.onFocusIn,onFocusOut:t.onFocusOut,focusInnerElement:t.focusInnerElement,handleKeyDown:t.handleKeyDown,onTabKeyDown:t.onTabKeyDown,shouldStopEventPropagation:t.shouldStopEventPropagation}))},e.prototype.createTabGuard=function(t){var e=document.createElement("div"),n="top"===t?Nc.TAB_GUARD_TOP:Nc.TAB_GUARD_BOTTOM;return e.classList.add(Nc.TAB_GUARD,n),Ye(e,"presentation"),e},e.prototype.addTabGuards=function(t,e){this.eFocusableElement.insertAdjacentElement("afterbegin",t),this.eFocusableElement.insertAdjacentElement("beforeend",e)},e.prototype.removeAllChildrenExceptTabGuards=function(){var t=[this.eTopGuard,this.eBottomGuard];br(this.getFocusableElement()),this.addTabGuards.apply(this,rd([],nd(t)))},e.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1),this.tabGuardCtrl.forceFocusOutOfContainer(t)},e.prototype.appendChild=function(e,n){Gr(e)||(e=e.getGui());var r=this.eBottomGuard;r?r.insertAdjacentElement("beforebegin",e):t.prototype.appendChild.call(this,e,n)},e}(Eo),id=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ad=function(t){function e(n){var r=t.call(this,e.getTemplate((null===n||void 0===n?void 0:n.cssIdentifier)||"default"))||this;r.renderedRows=new Map,r.rowHeight=20;var o=n||{},i=o.cssIdentifier,s=void 0===i?"default":i,a=o.ariaRole,l=void 0===a?"listbox":a,u=o.listName;return r.cssIdentifier=s,r.ariaRole=l,r.listName=u,r}return id(e,t),e.prototype.postConstruct=function(){var t=this;this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:function(e){return t.onFocusIn(e)},onFocusOut:function(e){return t.onFocusOut(e)},focusInnerElement:function(e){return t.focusInnerElement(e)},onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)}}),this.setAriaProperties(),this.addManagedListener(this.eventService,Yt.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))},e.prototype.onGridStylesChanged=function(){this.rowHeight=this.getItemHeight(),this.refresh()},e.prototype.setAriaProperties=function(){var t=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),e=this.eContainer;Ye(e,this.ariaRole),$e(e,t)},e.prototype.addResizeObserver=function(){var t=this,e=this.resizeObserverService.observeResize(this.getGui(),(function(){return t.drawVirtualRows()}));this.addDestroyFunc(e)},e.prototype.focusInnerElement=function(t){this.focusRow(t?this.model.getRowCount()-1:0)},e.prototype.onFocusIn=function(t){var e=t.target;return e.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=Je(e)-1),!1},e.prototype.onFocusOut=function(t){return this.getFocusableElement().contains(t.relatedTarget)||(this.lastFocusedRowIndex=null),!1},e.prototype.handleKeyDown=function(t){switch(t.key){case Yr.UP:case Yr.DOWN:this.navigate(t.key===Yr.UP)&&t.preventDefault()}},e.prototype.onTabKeyDown=function(t){this.navigate(t.shiftKey)?t.preventDefault():(Dt(t),this.forceFocusOutOfContainer(t.shiftKey))},e.prototype.navigate=function(t){if(null==this.lastFocusedRowIndex)return!1;var e=this.lastFocusedRowIndex+(t?-1:1);return!(e<0||e>=this.model.getRowCount())&&(this.focusRow(e),!0)},e.prototype.getLastFocusedRow=function(){return this.lastFocusedRowIndex},e.prototype.focusRow=function(t){var e=this;this.ensureIndexVisible(t),window.setTimeout((function(){if(e.isAlive()){var n=e.renderedRows.get(t);n&&n.eDiv.focus()}}),10)},e.prototype.getComponentAt=function(t){var e=this.renderedRows.get(t);return e&&e.rowComponent},e.prototype.forEachRenderedRow=function(t){this.renderedRows.forEach((function(e,n){return t(e.rowComponent,n)}))},e.getTemplate=function(t){return'<div class="ag-virtual-list-viewport ag-'+t+'-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-'+t+'-virtual-list-container" ref="eContainer"></div>\n            </div>'},e.prototype.getItemHeight=function(){return this.environment.getListItemHeight()},e.prototype.ensureIndexVisible=function(t){var e=this.model.getRowCount();if("number"!==typeof t||t<0||t>=e)console.warn("AG Grid: invalid row index for ensureIndexVisible: "+t);else{var n=t*this.rowHeight,r=n+this.rowHeight,o=this.getGui(),i=o.scrollTop,s=o.offsetHeight,a=i+s<r;if(i>n)o.scrollTop=n;else if(a){var l=r-s;o.scrollTop=l}}},e.prototype.setComponentCreator=function(t){this.componentCreator=t},e.prototype.setComponentUpdater=function(t){this.componentUpdater=t},e.prototype.getRowHeight=function(){return this.rowHeight},e.prototype.getScrollTop=function(){return this.getGui().scrollTop},e.prototype.setRowHeight=function(t){this.rowHeight=t,this.refresh()},e.prototype.refresh=function(t){var e=this;if(null!=this.model&&this.isAlive()){var n=this.model.getRowCount();this.eContainer.style.height=n*this.rowHeight+"px",B((function(){return e.eContainer.clientHeight>=n*e.rowHeight}),(function(){e.isAlive()&&(e.canSoftRefresh(t)?e.drawVirtualRows(!0):(e.clearVirtualRows(),e.drawVirtualRows()))}))}},e.prototype.canSoftRefresh=function(t){return!!(t&&this.renderedRows.size&&"function"===typeof this.model.areRowsEqual&&this.componentUpdater)},e.prototype.clearVirtualRows=function(){var t=this;this.renderedRows.forEach((function(e,n){return t.removeRow(n)}))},e.prototype.drawVirtualRows=function(t){if(this.isAlive()&&this.model){var e=this.getGui(),n=e.scrollTop,r=n+e.offsetHeight,o=Math.floor(n/this.rowHeight),i=Math.floor(r/this.rowHeight);this.ensureRowsRendered(o,i,t)}},e.prototype.ensureRowsRendered=function(t,e,n){var r=this;this.renderedRows.forEach((function(n,o){(o<t||o>e)&&o!==r.lastFocusedRowIndex&&r.removeRow(o)})),n&&this.refreshRows();for(var o=t;o<=e;o++)this.renderedRows.has(o)||o<this.model.getRowCount()&&this.insertRow(o)},e.prototype.insertRow=function(t){var e=this,n=this.model.getRow(t),r=document.createElement("div");if(r.classList.add("ag-virtual-list-item","ag-"+this.cssIdentifier+"-virtual-list-item"),Ye(r,"tree"===this.ariaRole?"treeitem":"option"),cn(r,this.model.getRowCount()),pn(r,t+1),r.setAttribute("tabindex","-1"),"function"===typeof this.model.isRowSelected){var o=this.model.isRowSelected(t);wn(r,!!o),Cn(r,o)}r.style.height=this.rowHeight+"px",r.style.top=this.rowHeight*t+"px";var i=this.componentCreator(n,r);i.addGuiEventListener("focusin",(function(){return e.lastFocusedRowIndex=t})),r.appendChild(i.getGui()),this.renderedRows.has(t-1)?this.renderedRows.get(t-1).eDiv.insertAdjacentElement("afterend",r):this.renderedRows.has(t+1)?this.renderedRows.get(t+1).eDiv.insertAdjacentElement("beforebegin",r):this.eContainer.appendChild(r),this.renderedRows.set(t,{rowComponent:i,eDiv:r,value:n})},e.prototype.removeRow=function(t){var e=this.renderedRows.get(t);this.eContainer.removeChild(e.eDiv),this.destroyBean(e.rowComponent),this.renderedRows.delete(t)},e.prototype.refreshRows=function(){var t=this,e=this.model.getRowCount();this.renderedRows.forEach((function(n,r){var o,i;if(r>=e)t.removeRow(r);else{var s=t.model.getRow(r);(null===(i=(o=t.model).areRowsEqual)||void 0===i?void 0:i.call(o,n.value,s))?t.componentUpdater(s,n.rowComponent):t.removeRow(r)}}))},e.prototype.addScrollListener=function(){var t=this;this.addGuiEventListener("scroll",(function(){return t.drawVirtualRows()}),{passive:!0})},e.prototype.setModel=function(t){this.model=t},e.prototype.getAriaElement=function(){return this.eContainer},e.prototype.destroy=function(){this.isAlive()&&(this.clearVirtualRows(),t.prototype.destroy.call(this))},sd([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),sd([To("eContainer")],e.prototype,"eContainer",void 0),sd([Z],e.prototype,"postConstruct",null),e}(od),ld=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ud=function(){return(ud=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},cd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},pd=function(t){function e(e){var n=t.call(this,ud({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list"},e),"ag-rich-select","smallDown","combobox")||this;n.searchString="",n.highlightedItem=-1;var r=e||{},o=r.cellRowHeight,i=r.value,s=r.valueList,a=r.searchDebounceDelay;return o&&(n.cellRowHeight=o),null!=i&&(n.value=i),null!=s&&n.setValueList(s),null!=a&&(n.searchDebounceDelay=a),n}return ld(e,t),e.prototype.postConstruct=function(){var e,n;t.prototype.postConstruct.call(this),this.createListComponent(),this.eWrapper.tabIndex=null!==(e=this.gridOptionsService.getNum("tabIndex"))&&void 0!==e?e:0,this.eWrapper.classList.add("ag-rich-select-value");var r=null!==(n=this.searchDebounceDelay)&&void 0!==n?n:300;this.clearSearchString=k(this.clearSearchString,r),this.renderSelectedValue()},e.prototype.createListComponent=function(){var t=this;this.listComponent=this.createManagedBean(new ad({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this)),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,Yt.EVENT_FIELD_PICKER_VALUE_SELECTED,(function(e){t.onListValueSelected(e.value,e.fromEnterKey)})),this.cellRowHeight&&this.listComponent.setRowHeight(this.cellRowHeight);var e=this.listComponent.getGui(),n=this.listComponent.getAriaElement();this.addManagedListener(e,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(e,"mousedown",(function(t){return t.preventDefault()})),e.classList.add("ag-rich-select-list");var r="ag-rich-select-list-"+this.listComponent.getCompId();n.setAttribute("id",r),bn(this.eWrapper,n)},e.prototype.renderSelectedValue=function(){var t,e,n=this,r=this.value,i=this.eDisplayField,s=this.config,a=this.config.valueFormatter?this.config.valueFormatter(r):r;s.cellRenderer&&(t=this.userComponentFactory.getCellRendererDetails(this.config,{value:r,valueFormatted:a,api:this.gridOptionsService.api})),t&&(e=t.newAgStackInstance()),e?(br(i),Hr(e,i),e.then((function(t){n.addDestroyFunc((function(){return n.getContext().destroyBean(t)}))}))):o(this.value)?i.innerText=a:br(i)},e.prototype.setValueList=function(t){this.values=t,this.highlightSelectedValue()},e.prototype.getCurrentValueIndex=function(){var t=this.values,e=this.value;if(null==e)return-1;for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},e.prototype.highlightSelectedValue=function(t){var e=this;null==t&&(t=this.getCurrentValueIndex()),-1!==t&&(this.highlightedItem=t,this.listComponent&&this.listComponent.forEachRenderedRow((function(t,n){t.updateHighlighted(e.highlightedItem===n)})))},e.prototype.setRowHeight=function(t){t!==this.cellRowHeight&&(this.cellRowHeight=t),this.listComponent&&this.listComponent.setRowHeight(t)},e.prototype.createPickerComponent=function(){var t=this.values;return this.listComponent.setModel({getRowCount:function(){return t.length},getRow:function(e){return t[e]}}),this.listComponent},e.prototype.showPicker=function(){var e,n,r;t.prototype.showPicker.call(this);var o=this.getCurrentValueIndex();-1!==o?(null===(e=this.listComponent)||void 0===e||e.refresh(),null===(n=this.listComponent)||void 0===n||n.ensureIndexVisible(o),this.highlightSelectedValue(o)):null===(r=this.listComponent)||void 0===r||r.refresh()},e.prototype.beforeHidePicker=function(){this.highlightedItem=-1,t.prototype.beforeHidePicker.call(this)},e.prototype.searchText=function(t){if("string"!==typeof t){var e=t.key;if(e===Yr.BACKSPACE)this.searchString=this.searchString.slice(0,-1),e="";else if(!Zr(t))return;return t.preventDefault(),void this.searchText(e)}this.searchString+=t,this.runSearch(),this.clearSearchString()},e.prototype.runSearch=function(){var t,e=this.values,n=this.config,r=n.valueFormatter,o=void 0===r?function(t){return t}:r,i=n.searchStringCreator;if("number"===typeof e[0]||"string"===typeof e[0]?t=e.map((function(t){return o(t)})):"object"===typeof e[0]&&i&&(t=i(e)),t){var s=ve(this.searchString,t,!0)[0];if(s){var a=t.indexOf(s);this.selectListItem(a)}}},e.prototype.clearSearchString=function(){this.searchString=""},e.prototype.selectListItem=function(t){!this.isPickerDisplayed||!this.listComponent||t<0||t>=this.values.length||(this.listComponent.ensureIndexVisible(t),this.highlightSelectedValue(t))},e.prototype.setValue=function(e,n,r){var o=this.values.indexOf(e);return-1===o?this:(this.value=e,r||this.selectListItem(o),this.renderSelectedValue(),t.prototype.setValue.call(this,e,n))},e.prototype.createRowComponent=function(t){var e=new td(this.config,this.eWrapper);return e.setParentComponent(this.listComponent),this.getContext().createBean(e),e.setState(t,t===this.value),e},e.prototype.getRowForMouseEvent=function(t){var e=this.listComponent;if(!e)return-1;var n=(null===e||void 0===e?void 0:e.getGui()).getBoundingClientRect(),r=e.getScrollTop(),o=t.clientY-n.top+r;return Math.floor(o/e.getRowHeight())},e.prototype.onPickerMouseMove=function(t){if(this.listComponent){var e=this.getRowForMouseEvent(t);-1!==e&&this.selectListItem(e)}},e.prototype.onNavigationKeyDown=function(t,e){t.preventDefault();var n=e===Yr.DOWN;if(this.isPickerDisplayed||!n){var r=this.highlightedItem,o=-1===r?0:r+(n?1:-1);this.selectListItem(o)}else this.showPicker()},e.prototype.onEnterKeyDown=function(t){this.isPickerDisplayed&&(t.preventDefault(),this.onListValueSelected(this.values[this.highlightedItem],!0))},e.prototype.onListValueSelected=function(t,e){this.setValue(t,!1,!0),this.dispatchPickerEvent(t,e),this.hidePicker()},e.prototype.dispatchPickerEvent=function(t,e){var n={type:Yt.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:e,value:t};this.dispatchEvent(n)},e.prototype.onKeyDown=function(t){var e=t.key;switch(e){case Yr.LEFT:case Yr.RIGHT:t.preventDefault();break;case Yr.DOWN:case Yr.UP:this.onNavigationKeyDown(t,e);break;case Yr.ESCAPE:this.isPickerDisplayed&&this.hidePicker();break;case Yr.ENTER:this.onEnterKeyDown(t);break;default:this.searchText(t)}},cd([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),e}(Qo),hd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},fd=function(t){function e(n){var r=t.call(this,n,e.TEMPLATE)||this;return r.labelAlignment="top",r}return hd(e,t),e.prototype.init=function(){this.eSlider.addCssClass("ag-slider-field")},e.prototype.onValueChange=function(t){var e=this,n=Yt.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,n,(function(){var n=parseFloat(e.eText.getValue());e.eSlider.setValue(n.toString(),!0),t(n||0)})),this.addManagedListener(this.eSlider,n,(function(){var n=e.eSlider.getValue();e.eText.setValue(n,!0),t(parseFloat(n))})),this},e.prototype.setSliderWidth=function(t){return this.eSlider.setWidth(t),this},e.prototype.setTextFieldWidth=function(t){return this.eText.setWidth(t),this},e.prototype.setMinValue=function(t){return this.eSlider.setMinValue(t),this.eText.setMin(t),this},e.prototype.setMaxValue=function(t){return this.eSlider.setMaxValue(t),this.eText.setMax(t),this},e.prototype.getValue=function(){return this.eText.getValue()},e.prototype.setValue=function(t){return this.getValue()===t||(this.eText.setValue(t,!0),this.eSlider.setValue(t,!0),this.dispatchEvent({type:Yt.EVENT_FIELD_VALUE_CHANGED})),this},e.prototype.setStep=function(t){return this.eSlider.setStep(t),this.eText.setStep(t),this},e.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',dd([To("eLabel")],e.prototype,"eLabel",void 0),dd([To("eSlider")],e.prototype,"eSlider",void 0),dd([To("eText")],e.prototype,"eText",void 0),dd([Z],e.prototype,"init",null),e}(qo),gd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),md=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},yd=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,e.getTemplate(n))||this;r.suppressEnabledCheckbox=!0,r.suppressOpenCloseIcons=!1;var o=n.title,i=n.enabled,s=n.items,a=n.suppressEnabledCheckbox,l=n.suppressOpenCloseIcons;return r.title=o,r.cssIdentifier=n.cssIdentifier||"default",r.enabled=null==i||i,r.items=s||[],r.alignItems=n.alignItems||"center",null!=a&&(r.suppressEnabledCheckbox=a),null!=l&&(r.suppressOpenCloseIcons=l),r}return gd(e,t),e.getTemplate=function(t){var e=t.cssIdentifier||"default";return'<div class="ag-group ag-'+e+'-group" role="presentation">\n            <div class="ag-group-title-bar ag-'+e+'-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-'+e+'-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-'+e+'-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-'+e+'-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-'+e+'-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-'+(t.direction||"vertical")+" ag-"+e+'-group-container"></div>\n        </div>'},e.prototype.postConstruct=function(){if(this.items.length){var t=this.items;this.items=[],this.addItems(t)}var e=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()},e.prototype.setupExpandContract=function(){var t=this;this.eGroupClosedIcon.appendChild(qr("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(qr("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",(function(){return t.toggleGroupExpand()})),this.addManagedListener(this.eTitleBar,"keydown",(function(e){switch(e.key){case Yr.ENTER:case Yr.SPACE:e.preventDefault(),t.toggleGroupExpand();break;case Yr.RIGHT:case Yr.LEFT:e.preventDefault(),t.toggleGroupExpand(e.key===Yr.RIGHT)}}))},e.prototype.refreshAriaStatus=function(){this.suppressOpenCloseIcons||ln(this.eTitleBar,this.expanded)},e.prototype.refreshChildDisplay=function(){var t=!this.suppressOpenCloseIcons;ur(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),ur(this.eGroupOpenedIcon,t&&this.expanded),ur(this.eGroupClosedIcon,t&&!this.expanded)},e.prototype.isExpanded=function(){return this.expanded},e.prototype.setAlignItems=function(t){this.alignItems!==t&&this.removeCssClass("ag-group-item-alignment-"+this.alignItems),this.alignItems=t;var e="ag-group-item-alignment-"+this.alignItems;return this.addCssClass(e),this},e.prototype.toggleGroupExpand=function(t){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),ur(this.eContainer,!0),this):(t=null!=t?t:!this.expanded,this.expanded===t||(this.expanded=t,this.refreshAriaStatus(),this.refreshChildDisplay(),ur(this.eContainer,t),this.dispatchEvent({type:this.expanded?e.EVENT_EXPANDED:e.EVENT_COLLAPSED})),this)},e.prototype.addItems=function(t){var e=this;t.forEach((function(t){return e.addItem(t)}))},e.prototype.addItem=function(t){var e=this.eContainer,n=t instanceof Eo?t.getGui():t;n.classList.add("ag-group-item","ag-"+this.cssIdentifier+"-group-item"),e.appendChild(n),this.items.push(n)},e.prototype.hideItem=function(t,e){ur(this.items[e],!t)},e.prototype.setTitle=function(t){return this.eTitle.innerText=t,this},e.prototype.addCssClassToTitleBar=function(t){this.eTitleBar.classList.add(t)},e.prototype.setEnabled=function(t,e){return this.enabled=t,this.refreshDisabledStyles(),this.toggleGroupExpand(t),e||this.cbGroupEnabled.setValue(t),this},e.prototype.isEnabled=function(){return this.enabled},e.prototype.onEnableChange=function(t){var e=this;return this.cbGroupEnabled.onValueChange((function(n){e.setEnabled(n,!0),t(n)})),this},e.prototype.hideEnabledCheckbox=function(t){return this.suppressEnabledCheckbox=t,this.refreshChildDisplay(),this.refreshDisabledStyles(),this},e.prototype.hideOpenCloseIcons=function(t){return this.suppressOpenCloseIcons=t,t&&this.toggleGroupExpand(!0),this},e.prototype.refreshDisabledStyles=function(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)},e.EVENT_EXPANDED="expanded",e.EVENT_COLLAPSED="collapsed",md([To("eTitleBar")],e.prototype,"eTitleBar",void 0),md([To("eGroupOpenedIcon")],e.prototype,"eGroupOpenedIcon",void 0),md([To("eGroupClosedIcon")],e.prototype,"eGroupClosedIcon",void 0),md([To("eToolbar")],e.prototype,"eToolbar",void 0),md([To("cbGroupEnabled")],e.prototype,"cbGroupEnabled",void 0),md([To("eTitle")],e.prototype,"eTitle",void 0),md([To("eContainer")],e.prototype,"eContainer",void 0),md([Z],e.prototype,"postConstruct",null),e}(Eo),vd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_d=function(){return(_d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},wd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Cd=function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,'<div class="ag-menu-list" role="tree"></div>')||this;return n.level=e,n.menuItems=[],n}return vd(e,t),e.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)}})},e.prototype.onTabKeyDown=function(t){var e=this.getParentComponent(),n=e&&e.getGui();n&&n.classList.contains("ag-focus-managed")||t.preventDefault(),t.shiftKey&&this.closeIfIsChild(t)},e.prototype.handleKeyDown=function(t){switch(t.key){case Yr.UP:case Yr.RIGHT:case Yr.DOWN:case Yr.LEFT:t.preventDefault(),this.handleNavKey(t.key);break;case Yr.ESCAPE:var e=this.findTopMenu();e&&this.focusService.focusInto(e.getGui())}},e.prototype.clearActiveItem=function(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)},e.prototype.addMenuItems=function(t){var e=this;null!=t&&t.forEach((function(t){"separator"===t?e.addSeparator():"string"===typeof t?console.warn("AG Grid: unrecognised menu item "+t):e.addItem(t)}))},e.prototype.addItem=function(t){var e=this,n=this.createManagedBean(new Rd(_d(_d({},t),{isAnotherSubMenuOpen:function(){return e.menuItems.some((function(t){return t.isSubMenuOpen()}))}})));n.setParentComponent(this),on(n.getGui(),this.level),this.menuItems.push(n),this.appendChild(n.getGui()),this.addManagedListener(n,Rd.EVENT_MENU_ITEM_SELECTED,(function(t){e.dispatchEvent(t)})),this.addManagedListener(n,Rd.EVENT_MENU_ITEM_ACTIVATED,(function(t){e.activeMenuItem&&e.activeMenuItem!==t.menuItem&&e.activeMenuItem.deactivate(),e.activeMenuItem=t.menuItem}))},e.prototype.activateFirstItem=function(){var t=this.menuItems.filter((function(t){return!t.isDisabled()}))[0];t&&t.activate()},e.prototype.addSeparator=function(){this.appendChild(Sr('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))},e.prototype.findTopMenu=function(){var t=this.getParentComponent();if(!t&&this instanceof e)return this;for(;;){var n=t&&t.getParentComponent&&t.getParentComponent();if(!n||!(n instanceof e||n instanceof Rd))break;t=n}return t instanceof e?t:void 0},e.prototype.handleNavKey=function(t){switch(t){case Yr.UP:case Yr.DOWN:var e=this.findNextItem(t===Yr.UP);return void(e&&e!==this.activeMenuItem&&e.activate())}t===(this.gridOptionsService.is("enableRtl")?Yr.RIGHT:Yr.LEFT)?this.closeIfIsChild():this.openChild()},e.prototype.closeIfIsChild=function(t){var e=this.getParentComponent();e&&e instanceof Rd&&(t&&t.preventDefault(),e.closeSubMenu(),e.getGui().focus())},e.prototype.openChild=function(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)},e.prototype.findNextItem=function(t){var e=this.menuItems.filter((function(t){return!t.isDisabled()}));if(e.length){if(!this.activeMenuItem)return t?yt(e):e[0];var n;t&&e.reverse();for(var r=!1,o=0;o<e.length;o++){var i=e[o];if(r){n=i;break}i===this.activeMenuItem&&(r=!0)}return n||this.activeMenuItem}},e.prototype.destroy=function(){this.clearActiveItem(),t.prototype.destroy.call(this)},wd([$("focusService")],e.prototype,"focusService",void 0),wd([Z],e.prototype,"postConstruct",null),e}(od),bd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ed=function(t){function e(e){var n=t.call(this)||this;return n.wrappedComponent=e,n.setTemplateFromElement(e.getGui()),n}return bd(e,t),e.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)}})},e.prototype.handleKeyDown=function(t){t.key===Yr.ESCAPE&&this.closePanel()},e.prototype.onTabKeyDown=function(t){t.defaultPrevented||(this.closePanel(),t.preventDefault())},e.prototype.closePanel=function(){var t=this.parentComponent;t.closeSubMenu(),setTimeout((function(){return t.getGui().focus()}),0)},xd([Z],e.prototype,"postConstruct",null),e}(od),Sd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Td=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Rd=function(t){function e(e){var n=t.call(this)||this;return n.params=e,n.isActive=!1,n.subMenuIsOpen=!1,n.setTemplate('<div class="'+n.getClassName()+'" tabindex="-1" role="treeitem"></div>'),n}return Sd(e,t),e.prototype.init=function(){var t=this;this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();var e=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),sn(e,!0)):(this.addGuiEventListener("click",(function(e){return t.onItemSelected(e)})),this.addGuiEventListener("keydown",(function(e){e.key!==Yr.ENTER&&e.key!==Yr.SPACE||(e.preventDefault(),t.onItemSelected(e))})),this.addGuiEventListener("mousedown",(function(t){t.stopPropagation(),t.preventDefault()})),this.addGuiEventListener("mouseenter",(function(){return t.onMouseEnter()})),this.addGuiEventListener("mouseleave",(function(){return t.onMouseLeave()}))),this.params.cssClasses&&this.params.cssClasses.forEach((function(e){return t.addCssClass(e)}))},e.prototype.isDisabled=function(){return!!this.params.disabled},e.prototype.openSubMenu=function(t){var n=this;if(void 0===t&&(t=!1),this.closeSubMenu(),this.params.subMenu){var r,o=Sr('<div class="ag-menu" role="presentation"></div>');if(this.params.subMenu instanceof Array){var i=Qe(this.getGui()),s=isNaN(i)?1:i+1,a=this.createBean(new Cd(s));a.setParentComponent(this),a.addMenuItems(this.params.subMenu),o.appendChild(a.getGui()),this.addManagedListener(a,e.EVENT_MENU_ITEM_SELECTED,(function(t){return n.dispatchEvent(t)})),a.addGuiEventListener("mouseenter",(function(){return n.cancelDeactivate()})),r=function(){return n.destroyBean(a)},t&&setTimeout((function(){return a.activateFirstItem()}),0)}else{var l=this.params.subMenu,u=this.createBean(new Ed(l));u.setParentComponent(this);var c=u.getGui(),p=function(){return n.cancelDeactivate()};c.addEventListener("mouseenter",p),r=function(){return c.removeEventListener("mouseenter",p)},o.appendChild(c),l.afterGuiAttached&&setTimeout((function(){return l.afterGuiAttached()}),0)}var h=this.getGui(),d=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:h,ePopup:o}),f=this.localeService.getLocaleTextFunc(),g=this.popupService.addPopup({modal:!0,eChild:o,positionCallback:d,anchorToElement:h,ariaLabel:f("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,ln(h,!0),this.hideSubMenu=function(){g&&g.hideFunc(),n.subMenuIsOpen=!1,ln(h,!1),r()}}},e.prototype.closeSubMenu=function(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,ln(this.getGui(),!1))},e.prototype.isSubMenuOpen=function(){return this.subMenuIsOpen},e.prototype.activate=function(t){var e=this;this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),t&&this.params.subMenu&&window.setTimeout((function(){e.isAlive()&&e.isActive&&e.openSubMenu()}),300),this.onItemActivated())},e.prototype.deactivate=function(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()},e.prototype.addIcon=function(){if(this.params.checked||this.params.icon||!this.params.isCompact){var t=Sr('<span ref="eIcon" class="'+this.getClassName("part")+" "+this.getClassName("icon")+'" role="presentation"></span>');this.params.checked?t.appendChild(Xr("check",this.gridOptionsService)):this.params.icon&&(Gr(this.params.icon)?t.appendChild(this.params.icon):"string"===typeof this.params.icon?t.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(t)}},e.prototype.addName=function(){if(this.params.name||!this.params.isCompact){var t=Sr('<span ref="eName" class="'+this.getClassName("part")+" "+this.getClassName("text")+'">'+(this.params.name||"")+"</span>");this.getGui().appendChild(t)}},e.prototype.addTooltip=function(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new _o(this)))},e.prototype.getTooltipParams=function(){return{location:"menu",value:this.tooltip}},e.prototype.addShortcut=function(){if(this.params.shortcut||!this.params.isCompact){var t=Sr('<span ref="eShortcut" class="'+this.getClassName("part")+" "+this.getClassName("shortcut")+'">'+(this.params.shortcut||"")+"</span>");this.getGui().appendChild(t)}},e.prototype.addSubMenu=function(){if(this.params.subMenu||!this.params.isCompact){var t=Sr('<span ref="ePopupPointer" class="'+this.getClassName("part")+" "+this.getClassName("popup-pointer")+'"></span>'),e=this.getGui();if(this.params.subMenu){var n=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";ln(e,!1),t.appendChild(Xr(n,this.gridOptionsService))}e.appendChild(t)}},e.prototype.onItemSelected=function(t){if(this.params.action?this.params.action():this.openSubMenu(t&&"keydown"===t.type),!this.params.subMenu||this.params.action){var n={type:e.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:t};this.dispatchEvent(n)}},e.prototype.onItemActivated=function(){var t={type:e.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(t)},e.prototype.cancelActivate=function(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)},e.prototype.cancelDeactivate=function(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)},e.prototype.onMouseEnter=function(){var t=this;this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout((function(){return t.activate(!0)}),e.ACTIVATION_DELAY):this.activate(!0)},e.prototype.onMouseLeave=function(){var t=this;this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout((function(){return t.deactivate()}),e.ACTIVATION_DELAY):this.deactivate()},e.prototype.getClassName=function(t){var e=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return t?e+"-"+t:e},e.EVENT_MENU_ITEM_SELECTED="menuItemSelected",e.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",e.ACTIVATION_DELAY=80,Td([$("popupService")],e.prototype,"popupService",void 0),Td([Z],e.prototype,"init",null),e}(Eo),Pd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Od=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Id=function(t){function e(n){var r=t.call(this,e.getTemplate(n))||this;return r.closable=!0,r.config=n,r}return Pd(e,t),e.getTemplate=function(t){var e=t&&t.cssIdentifier||"default";return'<div class="ag-panel ag-'+e+'-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-'+e+'-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-'+e+'-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-'+e+'-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-'+e+'-panel-content-wrapper"></div>\n        </div>'},e.prototype.postConstruct=function(){var t=this,e=this.config,n=e.component,r=e.closable,o=e.hideTitleBar,i=e.title,s=e.minWidth,a=void 0===s?250:s,l=e.width,u=e.minHeight,c=void 0===u?250:u,p=e.height,h=e.centered,d=e.popup,f=e.x,g=e.y;this.positionableFeature=new Vo(this.getGui(),{minWidth:a,width:l,minHeight:c,height:p,centered:h,x:f,y:g,popup:d,calculateTopBuffer:function(){return t.positionableFeature.getHeight()-t.getBodyHeight()}}),this.createManagedBean(this.positionableFeature);var m=this.getGui();n&&this.setBodyComponent(n),o?ur(this.eTitleBar,!1):(i&&this.setTitle(i),this.setClosable(null!=r?r:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",(function(e){var n=t.gridOptionsService.getDocument();if(m.contains(e.relatedTarget)||m.contains(n.activeElement)||t.eTitleBarButtons.contains(e.target))e.preventDefault();else{var r=t.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");r&&r.focus()}})),d&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")},e.prototype.renderComponent=function(){var t=this,e=this.getGui();e.focus(),this.close=function(){e.parentElement.removeChild(e),t.destroy()}},e.prototype.getHeight=function(){return this.positionableFeature.getHeight()},e.prototype.setHeight=function(t){this.positionableFeature.setHeight(t)},e.prototype.getWidth=function(){return this.positionableFeature.getWidth()},e.prototype.setWidth=function(t){this.positionableFeature.setWidth(t)},e.prototype.setClosable=function(t){if(t!==this.closable&&(this.closable=t),t){var n=this.closeButtonComp=new Eo(e.CLOSE_BTN_TEMPLATE);this.getContext().createBean(n);var r=n.getGui(),o=Xr("close",this.gridOptionsService);o.classList.add("ag-panel-title-bar-button-icon"),r.appendChild(o),this.addTitleBarButton(n),n.addManagedListener(r,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){(r=this.closeButtonComp.getGui()).parentElement.removeChild(r),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}},e.prototype.setBodyComponent=function(t){t.setParentComponent(this),this.eContentWrapper.appendChild(t.getGui())},e.prototype.addTitleBarButton=function(t,e){var n=this.eTitleBarButtons,r=n.children,o=r.length;null==e&&(e=o),e=Math.max(0,Math.min(e,o)),t.addCssClass("ag-panel-title-bar-button");var i=t.getGui();0===e?n.insertAdjacentElement("afterbegin",i):e===o?n.insertAdjacentElement("beforeend",i):r[e-1].insertAdjacentElement("afterend",i),t.setParentComponent(this)},e.prototype.getBodyHeight=function(){return fr(this.eContentWrapper)},e.prototype.getBodyWidth=function(){return gr(this.eContentWrapper)},e.prototype.setTitle=function(t){this.eTitle.innerText=t},e.prototype.onBtClose=function(){this.close()},e.prototype.destroy=function(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));var e=this.getGui();e&&e.offsetParent&&this.close(),t.prototype.destroy.call(this)},e.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',Od([To("eContentWrapper")],e.prototype,"eContentWrapper",void 0),Od([To("eTitleBar")],e.prototype,"eTitleBar",void 0),Od([To("eTitleBarButtons")],e.prototype,"eTitleBarButtons",void 0),Od([To("eTitle")],e.prototype,"eTitle",void 0),Od([Z],e.prototype,"postConstruct",null),e}(Eo),Ad=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dd=function(){return(Dd=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Md=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ld=function(t){function e(e){var n=t.call(this,Dd(Dd({},e),{popup:!0}))||this;return n.isMaximizable=!1,n.isMaximized=!1,n.maximizeListeners=[],n.resizeListenerDestroy=null,n.lastPosition={x:0,y:0,width:0,height:0},n}return Ad(e,t),e.prototype.postConstruct=function(){var e=this,n=this.getGui(),r=this.config,o=r.movable,i=r.resizable,s=r.maximizable;this.addCssClass("ag-dialog"),t.prototype.postConstruct.call(this),this.addManagedListener(n,"focusin",(function(t){n.contains(t.relatedTarget)||e.popupService.bringPopupToFront(n)})),o&&this.setMovable(o),s&&this.setMaximizable(s),i&&this.setResizable(i)},e.prototype.renderComponent=function(){var t=this.getGui(),e=this.config,n=e.alwaysOnTop,r=e.modal,o=e.title,i=this.localeService.getLocaleTextFunc(),s=this.popupService.addPopup({modal:r,eChild:t,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:n,ariaLabel:o||i("ariaLabelDialog","Dialog")});s&&(this.close=s.hideFunc)},e.prototype.toggleMaximize=function(){var t=this.positionableFeature.getPosition();if(this.isMaximized){var e=this.lastPosition,n=e.x,r=e.y,o=e.width,i=e.height;this.setWidth(o),this.setHeight(i),this.positionableFeature.offsetElement(n,r)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=t.x,this.lastPosition.y=t.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()},e.prototype.refreshMaximizeIcon=function(){ur(this.maximizeIcon,!this.isMaximized),ur(this.minimizeIcon,this.isMaximized)},e.prototype.clearMaximizebleListeners=function(){this.maximizeListeners.length&&(this.maximizeListeners.forEach((function(t){return t()})),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)},e.prototype.destroy=function(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),t.prototype.destroy.call(this)},e.prototype.setResizable=function(t){this.positionableFeature.setResizable(t)},e.prototype.setMovable=function(t){this.positionableFeature.setMovable(t,this.eTitleBar)},e.prototype.setMaximizable=function(t){var e=this;if(!t)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));var n=this.eTitleBar;if(n&&t!==this.isMaximizable){var r=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),r.addManagedListener(r.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(r,0),this.maximizeListeners.push(this.addManagedListener(n,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",(function(){e.isMaximized=!1,e.refreshMaximizeIcon()}))}},e.prototype.buildMaximizeAndMinimizeElements=function(){var t=this.maximizeButtonComp=this.createBean(new Eo('<div class="ag-dialog-button"></span>')),e=t.getGui();return this.maximizeIcon=Xr("maximize",this.gridOptionsService),e.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=Xr("minimize",this.gridOptionsService),e.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),t},Md([$("popupService")],e.prototype,"popupService",void 0),e}(Id),Nd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fd=function(){return(Fd=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},kd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Gd=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Bd=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};!function(t){t[t.vertical=0]="vertical",t[t.horizontal=1]="horizontal"}(Ih||(Ih={}));var Vd,zd=0,jd=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.popupList=[],e}var n;return Nd(e,t),n=e,e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.gridCtrl=e.gridCtrl,t.addManagedListener(t.gridCtrl,Yt.EVENT_KEYBOARD_FOCUS,(function(){t.popupList.forEach((function(t){return t.element.classList.add(pp.AG_KEYBOARD_FOCUS)}))})),t.addManagedListener(t.gridCtrl,Yt.EVENT_MOUSE_FOCUS,(function(){t.popupList.forEach((function(t){return t.element.classList.remove(pp.AG_KEYBOARD_FOCUS)}))}))}))},e.prototype.getPopupParent=function(){var t=this.gridOptionsService.get("popupParent");return t||this.gridCtrl.getGui()},e.prototype.positionPopupForMenu=function(t){var e=t.eventSource,n=t.ePopup,r=this.getPopupIndex(n);-1!==r&&(this.popupList[r].alignedToElement=e);var o=e.getBoundingClientRect(),i=this.getParentRect(),s=this.keepXYWithinBounds(n,o.top-i.top,Ih.vertical),a=n.clientWidth>0?n.clientWidth:200;n.style.minWidth=a+"px";var l,u=i.right-i.left-a;function c(){return o.right-i.left-2}function p(){return o.left-i.left-a}this.gridOptionsService.is("enableRtl")?((l=p())<0&&(l=c(),this.setAlignedStyles(n,"left")),l>u&&(l=0,this.setAlignedStyles(n,"right"))):((l=c())>u&&(l=p(),this.setAlignedStyles(n,"right")),l<0&&(l=0,this.setAlignedStyles(n,"left"))),n.style.left=l+"px",n.style.top=s+"px"},e.prototype.positionPopupUnderMouseEvent=function(t){var e=this,n=t.ePopup,r=t.nudgeX,o=t.nudgeY,i=t.skipObserver;this.positionPopup({ePopup:n,nudgeX:r,nudgeY:o,keepWithinBounds:!0,skipObserver:i,updatePosition:function(){return e.calculatePointerAlign(t.mouseEvent)},postProcessCallback:function(){return e.callPostProcessPopup(t.type,t.ePopup,null,t.mouseEvent,t.column,t.rowNode)}})},e.prototype.calculatePointerAlign=function(t){var e=this.getParentRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},e.prototype.positionPopupByComponent=function(t){var e=this,n=t.ePopup,r=t.nudgeX,o=t.nudgeY,i=t.keepWithinBounds,s=t.eventSource,a=t.alignSide,l=void 0===a?"left":a,u=t.position,c=void 0===u?"over":u,p=t.column,h=t.rowNode,d=t.type,f=s.getBoundingClientRect(),g=this.getParentRect(),m=this.getPopupIndex(n);-1!==m&&(this.popupList[m].alignedToElement=s);this.positionPopup({ePopup:n,nudgeX:r,nudgeY:o,keepWithinBounds:i,updatePosition:function(){var r,i=f.left-g.left;("right"===l&&(i-=n.offsetWidth-f.width),"over"===c)?(r=f.top-g.top,e.setAlignedStyles(n,"over")):(e.setAlignedStyles(n,"under"),r="under"===e.shouldRenderUnderOrAbove(n,f,g,t.nudgeY||0)?f.top-g.top+f.height:f.top-n.offsetHeight-2*(o||0)-g.top);return{x:i,y:r}},postProcessCallback:function(){return e.callPostProcessPopup(d,n,s,null,p,h)}})},e.prototype.shouldRenderUnderOrAbove=function(t,e,n,r){var o=n.bottom-e.bottom,i=e.top-n.top,s=t.offsetHeight+r;return o>s?"under":i>s||i>o?"above":"under"},e.prototype.setAlignedStyles=function(t,e){var n=this.getPopupIndex(t);if(-1!==n){var r=this.popupList[n].alignedToElement;if(r){["right","left","over","above","under"].forEach((function(e){r.classList.remove("ag-has-popup-positioned-"+e),t.classList.remove("ag-popup-positioned-"+e)})),e&&(r.classList.add("ag-has-popup-positioned-"+e),t.classList.add("ag-popup-positioned-"+e))}}},e.prototype.callPostProcessPopup=function(t,e,n,r,o,i){var s=this.gridOptionsService.getCallback("postProcessPopup");s&&s({column:o,rowNode:i,ePopup:e,type:t,eventSource:n,mouseEvent:r})},e.prototype.positionPopup=function(t){var e=this,r=t.ePopup,o=t.keepWithinBounds,i=t.nudgeX,s=t.nudgeY,a=t.skipObserver,l=t.updatePosition,u={width:0,height:0},c=function(n){void 0===n&&(n=!1);var a=l(),c=a.x,p=a.y;n&&r.clientWidth===u.width&&r.clientHeight===u.height||(u.width=r.clientWidth,u.height=r.clientHeight,i&&(c+=i),s&&(p+=s),o&&(c=e.keepXYWithinBounds(r,c,Ih.horizontal),p=e.keepXYWithinBounds(r,p,Ih.vertical)),r.style.left=c+"px",r.style.top=p+"px",t.postProcessCallback&&t.postProcessCallback())};if(c(),!a){var p=this.resizeObserverService.observeResize(r,(function(){return c(!0)}));setTimeout((function(){return p()}),n.WAIT_FOR_POPUP_CONTENT_RESIZE)}},e.prototype.getActivePopups=function(){return this.popupList.map((function(t){return t.element}))},e.prototype.getPopupList=function(){return this.popupList},e.prototype.getParentRect=function(){var t=this.gridOptionsService.getDocument(),e=this.getPopupParent();return e===t.body?e=t.documentElement:"static"===getComputedStyle(e).position&&(e=e.offsetParent),vr(e)},e.prototype.keepXYWithinBounds=function(t,e,n){var r=n===Ih.vertical,o=r?"clientHeight":"clientWidth",i=r?"top":"left",s=r?"offsetHeight":"offsetWidth",a=r?"scrollTop":"scrollLeft",l=this.gridOptionsService.getDocument(),u=l.documentElement,c=this.getPopupParent(),p=c.getBoundingClientRect(),h=l.documentElement.getBoundingClientRect(),d=c===l.body,f=t[s],g=d?(r?mr:yr)(u)+u[a]:c[o];d&&(g-=Math.abs(h[i]-p[i]));var m=g-f;return Math.min(Math.max(e,0),Math.abs(m))},e.prototype.addPopup=function(t){var e=this.gridOptionsService.getDocument(),n=t.eChild,r=t.ariaLabel,o=t.alwaysOnTop,i=t.positionCallback,s=t.anchorToElement;if(!e)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:function(){}};var a=this.getPopupIndex(n);if(-1!==a)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(n);var l=this.createPopupWrapper(n,r,!!o),u=this.addEventListenersToPopup(Fd(Fd({},t),{wrapperEl:l}));return i&&i(),this.addPopupToPopupList(n,l,u,s),{hideFunc:u}},e.prototype.initialisePopupPosition=function(t){var e=this.getPopupParent().getBoundingClientRect();o(t.style.top)||(t.style.top=-1*e.top+"px"),o(t.style.left)||(t.style.left=-1*e.left+"px")},e.prototype.createPopupWrapper=function(t,e,n){var r,o=this.getPopupParent(),i=document.createElement("div"),s=this.environment.getTheme().allThemes;return s.length&&(r=i.classList).add.apply(r,Bd([],Gd(s))),i.classList.add("ag-popup"),t.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),t.hasAttribute("role")||Ye(t,"dialog"),$e(t,e),this.focusService.isKeyboardMode()&&t.classList.add(pp.AG_KEYBOARD_FOCUS),i.appendChild(t),o.appendChild(i),n?this.setAlwaysOnTop(t,!0):this.bringPopupToFront(t),i},e.prototype.addEventListenersToPopup=function(t){var e=this,n=this.gridOptionsService.getDocument(),r=this.getPopupParent(),o=t.wrapperEl,i=t.eChild,s=t.click,a=t.closedCallback,l=t.afterGuiAttached,u=t.closeOnEsc,c=t.modal,p=!1,h=function(t){o.contains(n.activeElement)&&(t.key===Yr.ESCAPE&&g({keyboardEvent:t}))},d=function(t){return g({mouseEvent:t})},f=function(t){return g({touchEvent:t})},g=function(t){void 0===t&&(t={});var l=t.mouseEvent,u=t.touchEvent,c=t.keyboardEvent;e.isEventFromCurrentPopup({mouseEvent:l,touchEvent:u},i)||e.isEventSameChainAsOriginalEvent({originalMouseEvent:s,mouseEvent:l,touchEvent:u})||p||(p=!0,r.removeChild(o),n.removeEventListener("keydown",h),n.removeEventListener("mousedown",d),n.removeEventListener("touchstart",f),n.removeEventListener("contextmenu",d),e.eventService.removeEventListener(Yt.EVENT_DRAG_STARTED,d),a&&a(l||u||c),e.removePopupFromPopupList(i))};return l&&l({hidePopup:g}),window.setTimeout((function(){u&&n.addEventListener("keydown",h),c&&(n.addEventListener("mousedown",d),e.eventService.addEventListener(Yt.EVENT_DRAG_STARTED,d),n.addEventListener("touchstart",f),n.addEventListener("contextmenu",d))}),0),g},e.prototype.addPopupToPopupList=function(t,e,n,r){this.popupList.push({element:t,wrapper:e,hideFunc:n,instanceId:zd++,isAnchored:!!r}),r&&this.setPopupPositionRelatedToElement(t,r)},e.prototype.getPopupIndex=function(t){return this.popupList.findIndex((function(e){return e.element===t}))},e.prototype.setPopupPositionRelatedToElement=function(t,e){var n=this.getPopupIndex(t);if(-1!==n){var r=this.popupList[n];if(r.stopAnchoringPromise&&r.stopAnchoringPromise.then((function(t){return t&&t()})),r.stopAnchoringPromise=void 0,r.isAnchored=!1,e){var o=this.keepPopupPositionedRelativeTo({element:e,ePopup:t,hidePopup:r.hideFunc});return r.stopAnchoringPromise=o,r.isAnchored=!0,o}}},e.prototype.removePopupFromPopupList=function(t){this.setAlignedStyles(t,null),this.setPopupPositionRelatedToElement(t,null),this.popupList=this.popupList.filter((function(e){return e.element!==t}))},e.prototype.keepPopupPositionedRelativeTo=function(t){var e=this,n=this.getPopupParent(),r=n.getBoundingClientRect(),o=t.element,i=t.ePopup,s=o.getBoundingClientRect(),a=r.top-s.top,l=r.left-s.left,u=a,c=l,p=i.style.top,h=parseInt(p.substring(0,p.length-1),10),d=i.style.left,f=parseInt(d.substring(0,d.length-1),10);return new fo((function(r){e.getFrameworkOverrides().setInterval((function(){var r=n.getBoundingClientRect(),s=o.getBoundingClientRect();if(0==s.top&&0==s.left&&0==s.height&&0==s.width)t.hidePopup();else{var p=r.top-s.top;if(p!=u){var d=e.keepXYWithinBounds(i,h+a-p,Ih.vertical);i.style.top=d+"px"}u=p;var g=r.left-s.left;if(g!=c){var m=e.keepXYWithinBounds(i,f+l-g,Ih.horizontal);i.style.left=m+"px"}c=g}}),200).then((function(t){r((function(){null!=t&&window.clearInterval(t)}))}))}))},e.prototype.hasAnchoredPopup=function(){return this.popupList.some((function(t){return t.isAnchored}))},e.prototype.isEventFromCurrentPopup=function(t,e){var n=t.mouseEvent,r=t.touchEvent,o=n||r;if(!o)return!1;var i=this.getPopupIndex(e);if(-1===i)return!1;for(var s=i;s<this.popupList.length;s++){if(Ft(this.popupList[s].element,o))return!0}return this.isElementWithinCustomPopup(o.target)},e.prototype.isElementWithinCustomPopup=function(t){for(var e=this.gridOptionsService.getDocument();t&&t!==e.body;){if(t.classList.contains("ag-custom-component-popup")||null===t.parentElement)return!0;t=t.parentElement}return!1},e.prototype.isEventSameChainAsOriginalEvent=function(t){var e=t.originalMouseEvent,n=t.mouseEvent,r=t.touchEvent,o=null;if(n?o=n:r&&(o=r.touches[0]),o&&e){var i=n?n.screenX:0,s=n?n.screenY:0,a=Math.abs(e.screenX-i)<5,l=Math.abs(e.screenY-s)<5;if(a&&l)return!0}return!1},e.prototype.getWrapper=function(t){for(;!t.classList.contains("ag-popup")&&t.parentElement;)t=t.parentElement;return t.classList.contains("ag-popup")?t:null},e.prototype.setAlwaysOnTop=function(t,e){var n=this.getWrapper(t);n&&(n.classList.toggle("ag-always-on-top",!!e),e&&this.bringPopupToFront(n))},e.prototype.bringPopupToFront=function(t){var e=this.getPopupParent(),n=Array.prototype.slice.call(e.querySelectorAll(".ag-popup")),r=n.length,o=Array.prototype.slice.call(e.querySelectorAll(".ag-popup.ag-always-on-top")),i=o.length,s=this.getWrapper(t);if(s&&!(r<=1)&&e.contains(t)){var a=n.indexOf(s),l=s.querySelectorAll("div"),u=[];if(l.forEach((function(t){0!==t.scrollTop&&u.push([t,t.scrollTop])})),i)s.classList.contains("ag-always-on-top")?a!==r-1&&yt(o).insertAdjacentElement("afterend",s):a!==r-i-1&&o[0].insertAdjacentElement("beforebegin",s);else a!==r-1&&yt(n).insertAdjacentElement("afterend",s);for(;u.length;){var c=u.pop();c[0].scrollTop=c[1]}var p={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:s};this.eventService.dispatchEvent(p)}},e.WAIT_FOR_POPUP_CONTENT_RESIZE=200,kd([$("focusService")],e.prototype,"focusService",void 0),kd([$("ctrlsService")],e.prototype,"ctrlsService",void 0),kd([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),kd([Z],e.prototype,"postConstruct",null),e=n=kd([J("popupService")],e)}(jt),Hd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ud=function(t){function e(){var e=t.call(this,'\n        <div class="ag-autocomplete-row" role="presentation">\n            <div class="ag-autocomplete-row-label"></div>\n        </div>')||this;return e.hasHighlighting=!1,e}return Hd(e,t),e.prototype.setState=function(t,e){this.value=t,this.render(),this.updateSelected(e)},e.prototype.updateSelected=function(t){this.addOrRemoveCssClass("ag-autocomplete-row-selected",t)},e.prototype.setSearchString=function(t){var e,n=!1;if(o(t)){var r=null===(e=this.value)||void 0===e?void 0:e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase());if(r>=0){n=!0,this.hasHighlighting=!0;var i=r+t.length,s=re(this.value.slice(0,r)),a=re(this.value.slice(r,i)),l=re(this.value.slice(i));this.getGui().lastElementChild.innerHTML=s+"<b>"+a+"</b>"+l}}!n&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())},e.prototype.render=function(){var t;this.getGui().lastElementChild.innerHTML=null!==(t=re(this.value))&&void 0!==t?t:"&nbsp;"},e}(Eo),Wd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Xd=function(t){function e(n){var r=t.call(this,e.TEMPLATE)||this;return r.params=n,r.searchString="",r}return Wd(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(){var t=this;this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new ad({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:function(){return t.autocompleteEntries.length},getRow:function(e){return t.autocompleteEntries[e]}});var e=this.virtualList.getGui();this.addManagedListener(e,"click",(function(){return t.params.onConfirmed()})),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",(function(t){return t.preventDefault()})),this.setSelectedValue(0)},e.prototype.onNavigationKeyDown=function(t,e){t.preventDefault();var n=this.autocompleteEntries.indexOf(this.selectedValue),r=e===Yr.UP?n-1:n+1;this.checkSetSelectedValue(r)},e.prototype.setSearch=function(t){this.searchString=t,o(t)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()},e.prototype.runContainsSearch=function(t,e){var n,r=!1,o=t.toLocaleLowerCase(),i=e.filter((function(t){var e=t.toLocaleLowerCase().indexOf(o),i=0===e,s=e>=0;return s&&(!n||!r&&i||r===i&&t.length<n.length)&&(n=t,r=i),s}));return!n&&i.length&&(n=i[0]),{topMatch:n,allMatches:i}},e.prototype.runSearch=function(){var t,e,n,r,o=this.params.autocompleteEntries,i=o.map((function(t){var e;return null!==(e=t.displayValue)&&void 0!==e?e:t.key}));if(this.params.useFuzzySearch)r=(n=ve(this.searchString,i,!0)).length?n[0]:void 0;else{var s=this.runContainsSearch(this.searchString,i);n=s.allMatches,r=s.topMatch}var a=o.filter((function(t){var e=t.key,r=t.displayValue;return n.includes(null!==r&&void 0!==r?r:e)}));if(!a.length&&this.selectedValue&&(null===(e=null===(t=this.params)||void 0===t?void 0:t.forceLastSelection)||void 0===e?void 0:e.call(t,this.selectedValue,this.searchString))&&(a=[this.selectedValue]),this.autocompleteEntries=a,this.virtualList.refresh(),r){var l=n.indexOf(r);this.checkSetSelectedValue(l)}},e.prototype.updateSearchInList=function(){var t=this;this.virtualList.forEachRenderedRow((function(e){return e.setSearchString(t.searchString)}))},e.prototype.checkSetSelectedValue=function(t){t>=0&&t<this.autocompleteEntries.length&&this.setSelectedValue(t)},e.prototype.setSelectedValue=function(t){var e=this.autocompleteEntries[t];this.selectedValue!==e&&(this.selectedValue=e,this.virtualList.ensureIndexVisible(t),this.virtualList.forEachRenderedRow((function(e,n){e.updateSelected(t===n)})))},e.prototype.createRowComponent=function(t){var e,n=new Ud;return this.getContext().createBean(n),n.setState(null!==(e=t.displayValue)&&void 0!==e?e:t.key,t===this.selectedValue),n},e.prototype.onMouseMove=function(t){var e=this.virtualList.getGui().getBoundingClientRect(),n=this.virtualList.getScrollTop(),r=t.clientY-e.top+n,o=Math.floor(r/this.virtualList.getRowHeight());this.checkSetSelectedValue(o)},e.prototype.afterGuiAttached=function(){this.virtualList.refresh()},e.prototype.getSelectedValue=function(){var t;return this.autocompleteEntries.length&&null!==(t=this.selectedValue)&&void 0!==t?t:null},e.TEMPLATE='<div class="ag-autocomplete-list-popup">\n            <div ref="eList" class="ag-autocomplete-list"></div>\n        <div>',qd([To("eList")],e.prototype,"eList",void 0),qd([Z],e.prototype,"init",null),e}(hs),Kd=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yd=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zd=function(t){function e(){var e=t.call(this,'\n            <div class="ag-autocomplete" role="presentation">\n                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>\n            </div>')||this;return e.isListOpen=!1,e.lastPosition=0,e.valid=!0,e}return Kd(e,t),e.prototype.postConstruct=function(){var t=this;this.eAutocompleteInput.onValueChange((function(e){return t.onValueChanged(e)})),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc((function(){t.destroyBean(t.autocompleteList)})),this.addGuiEventListener("focusout",(function(){return t.onFocusOut()}))},e.prototype.onValueChanged=function(t){var e=r(t);this.updateValue(e),this.updateAutocompleteList(e)},e.prototype.updateValue=function(t){this.updateLastPosition(),this.dispatchEvent({type:e.EVENT_VALUE_CHANGED,value:t}),this.validate(t)},e.prototype.updateAutocompleteList=function(t){var e,n,r,o,i=null!==(n=null===(e=this.listGenerator)||void 0===e?void 0:e.call(this,t,this.lastPosition))&&void 0!==n?n:{enabled:!1};if(i.type&&i.type===(null===(r=this.autocompleteListParams)||void 0===r?void 0:r.type)||this.isListOpen&&this.closeList(),this.autocompleteListParams=i,null===(o=this.autocompleteListParams)||void 0===o?void 0:o.enabled){this.isListOpen||this.openList();var s=this.autocompleteListParams.searchString;this.autocompleteList.setSearch(null!==s&&void 0!==s?s:"")}else this.isListOpen&&this.closeList()},e.prototype.onKeyDown=function(t){var e=this,n=t.key;switch(this.updateLastPosition(),n){case Yr.ENTER:this.onEnterKeyDown(t);break;case Yr.TAB:this.onTabKeyDown(t);break;case Yr.DOWN:case Yr.UP:this.onUpDownKeyDown(t,n);break;case Yr.LEFT:case Yr.RIGHT:case Yr.PAGE_HOME:case Yr.PAGE_END:setTimeout((function(){e.updatePositionAndList()}));break;case Yr.ESCAPE:this.onEscapeKeyDown(t);break;case Yr.SPACE:t.ctrlKey&&!this.isListOpen&&(t.preventDefault(),this.forceOpenList())}},e.prototype.confirmSelection=function(){var t,n=null===(t=this.autocompleteList)||void 0===t?void 0:t.getSelectedValue();n&&(this.closeList(),this.dispatchEvent({type:e.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:n,autocompleteType:this.autocompleteListParams.type}))},e.prototype.onTabKeyDown=function(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.confirmSelection())},e.prototype.onEnterKeyDown=function(t){t.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()},e.prototype.onUpDownKeyDown=function(t,e){var n;t.preventDefault(),this.isListOpen?null===(n=this.autocompleteList)||void 0===n||n.onNavigationKeyDown(t,e):this.forceOpenList()},e.prototype.onEscapeKeyDown=function(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))},e.prototype.onFocusOut=function(){this.isListOpen&&this.closeList()},e.prototype.updatePositionAndList=function(){var t;this.updateLastPosition(),this.updateAutocompleteList(null!==(t=this.eAutocompleteInput.getValue())&&void 0!==t?t:null)},e.prototype.setCaret=function(t,e){var n=this.gridOptionsService.getDocument();e&&n.activeElement===n.body&&this.eAutocompleteInput.getFocusableElement().focus(),this.eAutocompleteInput.getInputElement().setSelectionRange(t,t)},e.prototype.forceOpenList=function(){this.onValueChanged(this.eAutocompleteInput.getValue())},e.prototype.updateLastPosition=function(){var t;this.lastPosition=null!==(t=this.eAutocompleteInput.getInputElement().selectionStart)&&void 0!==t?t:0},e.prototype.validate=function(t){var n;this.validator&&(this.validationMessage=this.validator(t),this.eAutocompleteInput.getInputElement().setCustomValidity(null!==(n=this.validationMessage)&&void 0!==n?n:""),this.valid=!this.validationMessage,this.dispatchEvent({type:e.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))},e.prototype.openList=function(){var t=this;this.isListOpen=!0,this.autocompleteList=this.createBean(new Xd({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:function(){return t.confirmSelection()},forceLastSelection:this.forceLastSelection}));var e=this.autocompleteList.getGui(),n={ePopup:e,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gridOptionsService.is("enableRtl")?"right":"left",keepWithinBounds:!0},r=this.popupService.addPopup({eChild:e,anchorToElement:this.getGui(),positionCallback:function(){return t.popupService.positionPopupByComponent(n)},ariaLabel:this.listAriaLabel});this.hidePopup=r.hideFunc,this.autocompleteList.afterGuiAttached()},e.prototype.closeList=function(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null},e.prototype.onCompleted=function(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:e.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})},e.prototype.getValue=function(){return r(this.eAutocompleteInput.getValue())},e.prototype.setInputPlaceholder=function(t){return this.eAutocompleteInput.setInputPlaceholder(t),this},e.prototype.setInputAriaLabel=function(t){return this.eAutocompleteInput.setInputAriaLabel(t),this},e.prototype.setListAriaLabel=function(t){return this.listAriaLabel=t,this},e.prototype.setListGenerator=function(t){return this.listGenerator=t,this},e.prototype.setValidator=function(t){return this.validator=t,this},e.prototype.isValid=function(){return this.valid},e.prototype.setValue=function(t){var e=t.value,n=t.position,r=t.silent,o=t.updateListOnlyIfOpen,i=t.restoreFocus;this.eAutocompleteInput.setValue(e,!0),this.setCaret(null!==n&&void 0!==n?n:this.lastPosition,i),r||this.updateValue(e),o&&!this.isListOpen||this.updateAutocompleteList(e)},e.prototype.setForceLastSelection=function(t){return this.forceLastSelection=t,this},e.prototype.setInputDisabled=function(t){return this.eAutocompleteInput.setDisabled(t),this},e.EVENT_VALUE_CHANGED="eventValueChanged",e.EVENT_VALUE_CONFIRMED="eventValueConfirmed",e.EVENT_OPTION_SELECTED="eventOptionSelected",e.EVENT_VALID_CHANGED="eventValidChanged",Yd([$("popupService")],e.prototype,"popupService",void 0),Yd([To("eAutocompleteInput")],e.prototype,"eAutocompleteInput",void 0),Yd([Z],e.prototype,"postConstruct",null),e}(Eo),Qd=["mouseover","mouseout","mouseenter","mouseleave","mousemove"],Jd=["touchstart","touchend","touchmove","touchcancel"],$d=function(){function t(){this.renderingEngine="vanilla",this.isOutsideAngular=function(t){return Tt(Qd,t)}}return t.prototype.setTimeout=function(t,e){window.setTimeout(t,e)},t.prototype.setInterval=function(t,e){return new fo((function(n){n(window.setInterval(t,e))}))},t.prototype.addEventListener=function(t,e,n,r){var o=Tt(Jd,e);t.addEventListener(e,n,{capture:!!r,passive:o})},t.prototype.dispatchEvent=function(t,e,n){e()},t.prototype.frameworkComponent=function(t){return null},t.prototype.isFrameworkComponent=function(t){return!1},t}(),tf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ef=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},nf=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},rf=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},of=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tf(e,t),e.prototype.getNextCellToFocus=function(t,e,n){return void 0===n&&(n=!1),n?this.getNextCellToFocusWithCtrlPressed(t,e):this.getNextCellToFocusWithoutCtrlPressed(t,e)},e.prototype.getNextCellToFocusWithCtrlPressed=function(t,e){var n,r,o=t===Yr.UP,i=t===Yr.DOWN,s=t===Yr.LEFT;if(o||i)r=o?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),n=e.column;else{var a=this.columnModel.getAllDisplayedColumns(),l=this.gridOptionsService.is("enableRtl");r=e.rowIndex,n=s!==l?a[0]:yt(a)}return{rowIndex:r,rowPinned:null,column:n}},e.prototype.getNextCellToFocusWithoutCtrlPressed=function(t,e){for(var n=e,r=!1;!r;){switch(t){case Yr.UP:n=this.getCellAbove(n);break;case Yr.DOWN:n=this.getCellBelow(n);break;case Yr.RIGHT:n=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case Yr.LEFT:n=this.gridOptionsService.is("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,console.warn("AG Grid: unknown key for navigation "+t)}r=!n||this.isCellGoodToFocusOn(n)}return n},e.prototype.isCellGoodToFocusOn=function(t){var e,n=t.column;switch(t.rowPinned){case"top":e=this.pinnedRowModel.getPinnedTopRow(t.rowIndex);break;case"bottom":e=this.pinnedRowModel.getPinnedBottomRow(t.rowIndex);break;default:e=this.rowModel.getRow(t.rowIndex)}return!!e&&!n.isSuppressNavigable(e)},e.prototype.getCellToLeft=function(t){if(!t)return null;var e=this.columnModel.getDisplayedColBefore(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null},e.prototype.getCellToRight=function(t){if(!t)return null;var e=this.columnModel.getDisplayedColAfter(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null},e.prototype.getRowBelow=function(t){var e=t.rowIndex,n=t.rowPinned;if(this.isLastRowInContainer(t))switch(n){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}var r=this.rowModel.getRow(t.rowIndex),o=this.getNextStickyPosition(r);return o||{rowIndex:e+1,rowPinned:n}},e.prototype.getNextStickyPosition=function(t,e){if(this.gridOptionsService.isGroupRowsSticky()&&t&&t.sticky){var n=rf([],nf(this.rowRenderer.getStickyTopRowCtrls())).sort((function(t,e){return t.getRowNode().rowIndex-e.getRowNode().rowIndex})),r=e?-1:1,o=n.findIndex((function(e){return e.getRowNode().rowIndex===t.rowIndex})),i=n[o+r];return i?{rowIndex:i.getRowNode().rowIndex,rowPinned:null}:void 0}},e.prototype.getCellBelow=function(t){if(!t)return null;var e=this.getRowBelow(t);return e?{rowIndex:e.rowIndex,column:t.column,rowPinned:e.rowPinned}:null},e.prototype.isLastRowInContainer=function(t){var e=t.rowPinned,n=t.rowIndex;return"top"===e?this.pinnedRowModel.getPinnedTopRowData().length-1<=n:"bottom"===e?this.pinnedRowModel.getPinnedBottomRowData().length-1<=n:this.paginationProxy.getPageLastRow()<=n},e.prototype.getRowAbove=function(t){var e=t.rowIndex,n=t.rowPinned;if(n?0===e:e===this.paginationProxy.getPageFirstRow())return"top"===n?null:n&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;var r=this.rowModel.getRow(t.rowIndex),o=this.getNextStickyPosition(r,!0);return o||{rowIndex:e-1,rowPinned:n}},e.prototype.getCellAbove=function(t){if(!t)return null;var e=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});return e?{rowIndex:e.rowIndex,column:t.column,rowPinned:e.rowPinned}:null},e.prototype.getLastBodyCell=function(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}},e.prototype.getLastFloatingTopRow=function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}},e.prototype.getNextTabbedCell=function(t,e){return e?this.getNextTabbedCellBackwards(t):this.getNextTabbedCellForwards(t)},e.prototype.getNextTabbedCellForwards=function(t){var e=this.columnModel.getAllDisplayedColumns(),n=t.rowIndex,r=t.rowPinned,o=this.columnModel.getDisplayedColAfter(t.column);if(!o){o=e[0];var s=this.getRowBelow(t);if(i(s))return null;if(!s.rowPinned&&!this.paginationProxy.isRowInPage(s))return null;n=s?s.rowIndex:null,r=s?s.rowPinned:null}return{rowIndex:n,column:o,rowPinned:r}},e.prototype.getNextTabbedCellBackwards=function(t){var e=this.columnModel.getAllDisplayedColumns(),n=t.rowIndex,r=t.rowPinned,o=this.columnModel.getDisplayedColBefore(t.column);if(!o){o=yt(e);var s=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});if(i(s))return null;if(!s.rowPinned&&!this.paginationProxy.isRowInPage(s))return null;n=s?s.rowIndex:null,r=s?s.rowPinned:null}return{rowIndex:n,column:o,rowPinned:r}},ef([$("columnModel")],e.prototype,"columnModel",void 0),ef([$("rowModel")],e.prototype,"rowModel",void 0),ef([$("rowRenderer")],e.prototype,"rowRenderer",void 0),ef([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),ef([$("paginationProxy")],e.prototype,"paginationProxy",void 0),e=ef([J("cellNavigationService")],e)}(jt),sf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),af=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},lf=function(t,e){return function(n,r){e(n,r,t)}},uf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.consuming=!1,e}return sf(e,t),e.prototype.setBeans=function(t){this.logger=t.create("AlignedGridsService")},e.prototype.init=function(){this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))},e.prototype.fireEvent=function(t){if(!this.consuming){var e=this.gridOptionsService.get("alignedGrids");e&&e.forEach((function(e){if(e.api){var n=e.api.__getAlignedGridService();t(n)}}))}},e.prototype.onEvent=function(t){this.consuming=!0,t(),this.consuming=!1},e.prototype.fireColumnEvent=function(t){this.fireEvent((function(e){e.onColumnEvent(t)}))},e.prototype.fireScrollEvent=function(t){"horizontal"===t.direction&&this.fireEvent((function(e){e.onScrollEvent(t)}))},e.prototype.onScrollEvent=function(t){var e=this;this.onEvent((function(){e.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(t.left,!0)}))},e.prototype.getMasterColumns=function(t){var e=[];return t.columns?t.columns.forEach((function(t){e.push(t)})):t.column&&e.push(t.column),e},e.prototype.getColumnIds=function(t){var e=[];return t.columns?t.columns.forEach((function(t){e.push(t.getColId())})):t.column&&e.push(t.column.getColId()),e},e.prototype.onColumnEvent=function(t){var e=this;this.onEvent((function(){switch(t.type){case Yt.EVENT_COLUMN_MOVED:case Yt.EVENT_COLUMN_VISIBLE:case Yt.EVENT_COLUMN_PINNED:case Yt.EVENT_COLUMN_RESIZED:var n=t;e.processColumnEvent(n);break;case Yt.EVENT_COLUMN_GROUP_OPENED:var r=t;e.processGroupOpenedEvent(r);break;case Yt.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}}))},e.prototype.processGroupOpenedEvent=function(t){var e=t.columnGroup,n=null;if(e){var r=e.getGroupId();n=this.columnModel.getProvidedColumnGroup(r)}e&&!n||(this.logger.log("onColumnEvent-> processing "+t+" expanded = "+e.isExpanded()),this.columnModel.setColumnGroupOpened(n,e.isExpanded(),"alignedGridChanged"))},e.prototype.processColumnEvent=function(t){var e,n=this,r=t.column,o=null;if(r&&(o=this.columnModel.getPrimaryColumn(r.getColId())),!r||o){var i=this.getMasterColumns(t);switch(t.type){case Yt.EVENT_COLUMN_MOVED:var s=t,a=t.columnApi.getColumnState().map((function(t){return{colId:t.colId}}));this.columnModel.applyColumnState({state:a,applyOrder:!0},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" toIndex = "+s.toIndex);break;case Yt.EVENT_COLUMN_VISIBLE:var l=t;a=t.columnApi.getColumnState().map((function(t){return{colId:t.colId,hide:t.hide}}));this.columnModel.applyColumnState({state:a},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" visible = "+l.visible);break;case Yt.EVENT_COLUMN_PINNED:var u=t;a=t.columnApi.getColumnState().map((function(t){return{colId:t.colId,pinned:t.pinned}}));this.columnModel.applyColumnState({state:a},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" pinned = "+u.pinned);break;case Yt.EVENT_COLUMN_RESIZED:var c=t,p={};i.forEach((function(e){n.logger.log("onColumnEvent-> processing "+t.type+" actualWidth = "+e.getActualWidth()),p[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}})),null===(e=c.flexColumns)||void 0===e||e.forEach((function(t){p[t.getId()]&&delete p[t.getId()]})),this.columnModel.setColumnWidths(Object.values(p),!1,c.finished,"alignedGridChanged")}var h=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),d=this.gridOptionsService.get("alignedGrids");d&&d.forEach((function(t){t.api&&t.api.setAlwaysShowVerticalScroll(h)}))}},af([$("columnModel")],e.prototype,"columnModel",void 0),af([$("ctrlsService")],e.prototype,"ctrlsService",void 0),af([lf(0,nt("loggerFactory"))],e.prototype,"setBeans",null),af([Z],e.prototype,"init",null),e=af([J("alignedGridsService")],e)}(jt),cf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},hf=function(t,e){return function(n,r){e(n,r,t)}},df=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ff=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cf(e,t),e.prototype.setBeans=function(t){this.logger=t.create("selectionService"),this.reset()},e.prototype.init=function(){var t=this;this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",(function(e){return t.groupSelectsChildren=e.currentValue})),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(function(e){return t.rowSelection=e.currentValue})),this.addManagedListener(this.eventService,Yt.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))},e.prototype.isMultiselect=function(){return"multiple"===this.rowSelection},e.prototype.setNodesSelected=function(t){var e;if(0===t.nodes.length)return 0;var n=t.newValue,r=t.clearSelection,o=t.suppressFinishActions,i=t.rangeSelect;t.event;var s=t.source,a=void 0===s?"api":s;if(t.nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;var l=this.groupSelectsChildren&&!0===t.groupSelectsFiltered,u=t.nodes.map((function(t){return t.footer?t.sibling:t}));if(i){if(t.nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;var c=this.getLastSelectedNode();if(c)if(c!==(f=u[0])&&this.isMultiselect()){var p=this.selectRange(f,c,t.newValue,a);return this.setLastSelectedNode(f),p}}for(var h=0,d=0;d<u.length;d++){var f=u[d];if(!(l&&f.group))f.selectThisNode(n,t.event,a)&&h++;this.groupSelectsChildren&&(null===(e=f.childrenAfterGroup)||void 0===e?void 0:e.length)&&(h+=this.selectChildren(f,n,l,a))}if(!o){if(n&&(r||!this.isMultiselect())&&(h+=this.clearOtherNodes(u[0],a)),h>0){this.updateGroupsFromChildrenSelections(a);var g={type:Yt.EVENT_SELECTION_CHANGED,source:a};this.eventService.dispatchEvent(g)}n&&this.setLastSelectedNode(u[u.length-1])}return h},e.prototype.selectRange=function(t,e,n,r){var o=this;void 0===n&&(n=!0);var i=this.rowModel.getNodesInRangeForSelection(t,e),s=0;i.forEach((function(e){e.group&&o.groupSelectsChildren||!1===n&&t===e||e.selectThisNode(n,void 0,r)&&s++})),this.updateGroupsFromChildrenSelections(r);var a={type:Yt.EVENT_SELECTION_CHANGED,source:r};return this.eventService.dispatchEvent(a),s},e.prototype.selectChildren=function(t,e,n,r){var o=n?t.childrenAfterAggFilter:t.childrenAfterGroup;return uo.missing(o)?0:this.setNodesSelected({newValue:e,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:n,source:r,nodes:o})},e.prototype.setLastSelectedNode=function(t){this.lastSelectedNode=t},e.prototype.getLastSelectedNode=function(){return this.lastSelectedNode},e.prototype.getSelectedNodes=function(){var t=[];return g(this.selectedNodes,(function(e,n){n&&t.push(n)})),t},e.prototype.getSelectedRows=function(){var t=[];return g(this.selectedNodes,(function(e,n){n&&n.data&&t.push(n.data)})),t},e.prototype.getSelectionCount=function(){return Object.values(this.selectedNodes).length},e.prototype.filterFromSelection=function(t){var e={};Object.entries(this.selectedNodes).forEach((function(n){var r=df(n,2),o=r[0],i=r[1];i&&t(i)&&(e[o]=i)})),this.selectedNodes=e},e.prototype.updateGroupsFromChildrenSelections=function(t,e){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;var n=this.rowModel.getRootNode();e||(e=new Ah(!0,n)).setInactive();var r=!1;return e.forEachChangedNodeDepthFirst((function(e){if(e!==n){var o=e.calculateSelectedFromChildren();r=e.selectThisNode(null!==o&&o,void 0,t)||r}})),r},e.prototype.clearOtherNodes=function(t,e){var n=this,r={},o=0;return g(this.selectedNodes,(function(i,s){if(s&&s.id!==t.id){var a=n.selectedNodes[s.id];o+=a.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:e}),n.groupSelectsChildren&&s.parent&&(r[s.parent.id]=s.parent)}})),g(r,(function(t,n){var r=n.calculateSelectedFromChildren();n.selectThisNode(null!==r&&r,void 0,e)})),o},e.prototype.onRowSelected=function(t){var e=t.node;this.groupSelectsChildren&&e.group||(e.isSelected()?this.selectedNodes[e.id]=e:delete this.selectedNodes[e.id])},e.prototype.syncInRowNode=function(t,e){this.syncInOldRowNode(t,e),this.syncInNewRowNode(t)},e.prototype.syncInOldRowNode=function(t,e){if(o(e)&&t.id!==e.id&&e){var n=e.id;this.selectedNodes[n]==t&&(this.selectedNodes[e.id]=e)}},e.prototype.syncInNewRowNode=function(t){o(this.selectedNodes[t.id])?(t.setSelectedInitialValue(!0),this.selectedNodes[t.id]=t):t.setSelectedInitialValue(!1)},e.prototype.reset=function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null},e.prototype.getBestCostNodeSelection=function(){if("clientSide"===this.rowModel.getType()){var t=this.rowModel.getTopLevelNodes();if(null!==t){var e=[];return function t(n){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(i.isSelected())e.push(i);else{var s=i;s.group&&s.children&&t(s.children)}}}(t),e}}},e.prototype.isEmpty=function(){var t=0;return g(this.selectedNodes,(function(e,n){n&&t++})),0===t},e.prototype.deselectAllRowNodes=function(t){var e=function(t){return t.selectThisNode(!1,void 0,r)},n="clientSide"===this.rowModel.getType(),r=t.source,o=t.justFiltered,i=t.justCurrentPage;if(i||o){if(!n)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(o,i).forEach(e)}else g(this.selectedNodes,(function(t,n){n&&e(n)})),this.reset();n&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(r);var s={type:Yt.EVENT_SELECTION_CHANGED,source:r};this.eventService.dispatchEvent(s)},e.prototype.getSelectAllState=function(t,e){var n=this,r=0,o=0;return this.getNodesToSelect(t,e).forEach((function(t){n.groupSelectsChildren&&t.group||(t.isSelected()?r++:t.selectable&&o++)})),(0!==r||0!==o)&&(r>0&&o>0?null:r>0)},e.prototype.getNodesToSelect=function(t,e){var n=this;if(void 0===t&&(t=!1),void 0===e&&(e=!1),"clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var r=[];if(e)return this.paginationProxy.forEachNodeOnPage((function(t){if(t.group)if(t.expanded)n.groupSelectsChildren||r.push(t);else{var e=function(t){var n;r.push(t),(null===(n=t.childrenAfterFilter)||void 0===n?void 0:n.length)&&t.childrenAfterFilter.forEach(e)};e(t)}else r.push(t)})),r;var o=this.rowModel;return t?(o.forEachNodeAfterFilter((function(t){r.push(t)})),r):(o.forEachNode((function(t){r.push(t)})),r)},e.prototype.selectAllRowNodes=function(t){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var e=t.source,n=t.justFiltered,r=t.justCurrentPage;this.getNodesToSelect(n,r).forEach((function(t){return t.selectThisNode(!0,void 0,e)})),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(e);var o={type:Yt.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(o)},e.prototype.getServerSideSelectionState=function(){return null},e.prototype.setServerSideSelectionState=function(t){},pf([$("rowModel")],e.prototype,"rowModel",void 0),pf([$("paginationProxy")],e.prototype,"paginationProxy",void 0),pf([hf(0,nt("loggerFactory"))],e.prototype,"setBeans",null),pf([Z],e.prototype,"init",null),e=pf([J("selectionService")],e)}(jt),gf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},mf=function(){function t(){}return t.prototype.sizeColumnsToFit=function(t){"undefined"===typeof t&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(t,"api")},t.prototype.setColumnGroupOpened=function(t,e){this.columnModel.setColumnGroupOpened(t,e,"api")},t.prototype.getColumnGroup=function(t,e){return this.columnModel.getColumnGroup(t,e)},t.prototype.getProvidedColumnGroup=function(t){return this.columnModel.getProvidedColumnGroup(t)},t.prototype.getDisplayNameForColumn=function(t,e){return this.columnModel.getDisplayNameForColumn(t,e)||""},t.prototype.getDisplayNameForColumnGroup=function(t,e){return this.columnModel.getDisplayNameForColumnGroup(t,e)||""},t.prototype.getColumn=function(t){return this.columnModel.getPrimaryColumn(t)},t.prototype.getColumns=function(){return this.columnModel.getAllPrimaryColumns()},t.prototype.applyColumnState=function(t){return this.columnModel.applyColumnState(t,"api")},t.prototype.getColumnState=function(){return this.columnModel.getColumnState()},t.prototype.resetColumnState=function(){this.columnModel.resetColumnState("api")},t.prototype.getColumnGroupState=function(){return this.columnModel.getColumnGroupState()},t.prototype.setColumnGroupState=function(t){this.columnModel.setColumnGroupState(t,"api")},t.prototype.resetColumnGroupState=function(){this.columnModel.resetColumnGroupState("api")},t.prototype.isPinning=function(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()},t.prototype.isPinningLeft=function(){return this.columnModel.isPinningLeft()},t.prototype.isPinningRight=function(){return this.columnModel.isPinningRight()},t.prototype.getDisplayedColAfter=function(t){return this.columnModel.getDisplayedColAfter(t)},t.prototype.getDisplayedColBefore=function(t){return this.columnModel.getDisplayedColBefore(t)},t.prototype.setColumnVisible=function(t,e){this.columnModel.setColumnVisible(t,e,"api")},t.prototype.setColumnsVisible=function(t,e){this.columnModel.setColumnsVisible(t,e,"api")},t.prototype.setColumnPinned=function(t,e){this.columnModel.setColumnPinned(t,e,"api")},t.prototype.setColumnsPinned=function(t,e){this.columnModel.setColumnsPinned(t,e,"api")},t.prototype.getAllGridColumns=function(){return this.columnModel.getAllGridColumns()},t.prototype.getDisplayedLeftColumns=function(){return this.columnModel.getDisplayedLeftColumns()},t.prototype.getDisplayedCenterColumns=function(){return this.columnModel.getDisplayedCenterColumns()},t.prototype.getDisplayedRightColumns=function(){return this.columnModel.getDisplayedRightColumns()},t.prototype.getAllDisplayedColumns=function(){return this.columnModel.getAllDisplayedColumns()},t.prototype.getAllDisplayedVirtualColumns=function(){return this.columnModel.getViewportColumns()},t.prototype.moveColumn=function(t,e){this.columnModel.moveColumn(t,e,"api")},t.prototype.moveColumnByIndex=function(t,e){this.columnModel.moveColumnByIndex(t,e,"api")},t.prototype.moveColumns=function(t,e){this.columnModel.moveColumns(t,e,"api")},t.prototype.moveRowGroupColumn=function(t,e){this.columnModel.moveRowGroupColumn(t,e)},t.prototype.setColumnAggFunc=function(t,e){this.columnModel.setColumnAggFunc(t,e)},t.prototype.setColumnWidth=function(t,e,n,r){void 0===n&&(n=!0),this.columnModel.setColumnWidths([{key:t,newWidth:e}],!1,n,r)},t.prototype.setColumnWidths=function(t,e,n){void 0===e&&(e=!0),this.columnModel.setColumnWidths(t,!1,e,n)},t.prototype.setPivotMode=function(t){this.columnModel.setPivotMode(t)},t.prototype.isPivotMode=function(){return this.columnModel.isPivotMode()},t.prototype.getPivotResultColumn=function(t,e){return this.columnModel.getSecondaryPivotColumn(t,e)},t.prototype.setValueColumns=function(t){this.columnModel.setValueColumns(t,"api")},t.prototype.getValueColumns=function(){return this.columnModel.getValueColumns()},t.prototype.removeValueColumn=function(t){this.columnModel.removeValueColumn(t,"api")},t.prototype.removeValueColumns=function(t){this.columnModel.removeValueColumns(t,"api")},t.prototype.addValueColumn=function(t){this.columnModel.addValueColumn(t,"api")},t.prototype.addValueColumns=function(t){this.columnModel.addValueColumns(t,"api")},t.prototype.setRowGroupColumns=function(t){this.columnModel.setRowGroupColumns(t,"api")},t.prototype.removeRowGroupColumn=function(t){this.columnModel.removeRowGroupColumn(t,"api")},t.prototype.removeRowGroupColumns=function(t){this.columnModel.removeRowGroupColumns(t,"api")},t.prototype.addRowGroupColumn=function(t){this.columnModel.addRowGroupColumn(t,"api")},t.prototype.addRowGroupColumns=function(t){this.columnModel.addRowGroupColumns(t,"api")},t.prototype.getRowGroupColumns=function(){return this.columnModel.getRowGroupColumns()},t.prototype.setPivotColumns=function(t){this.columnModel.setPivotColumns(t,"api")},t.prototype.removePivotColumn=function(t){this.columnModel.removePivotColumn(t,"api")},t.prototype.removePivotColumns=function(t){this.columnModel.removePivotColumns(t,"api")},t.prototype.addPivotColumn=function(t){this.columnModel.addPivotColumn(t,"api")},t.prototype.addPivotColumns=function(t){this.columnModel.addPivotColumns(t,"api")},t.prototype.getPivotColumns=function(){return this.columnModel.getPivotColumns()},t.prototype.getLeftDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeLeft()},t.prototype.getCenterDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeCentre()},t.prototype.getRightDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeRight()},t.prototype.getAllDisplayedColumnGroups=function(){return this.columnModel.getAllDisplayedTrees()},t.prototype.autoSizeColumn=function(t,e){return this.columnModel.autoSizeColumn(t,e,"api")},t.prototype.autoSizeColumns=function(t,e){this.columnModel.autoSizeColumns({columns:t,skipHeader:e})},t.prototype.autoSizeAllColumns=function(t){this.columnModel.autoSizeAllColumns(t,"api")},t.prototype.setPivotResultColumns=function(t){this.columnModel.setSecondaryColumns(t,"api")},t.prototype.getPivotResultColumns=function(){return this.columnModel.getSecondaryColumns()},t.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(uo.removeAllReferences.bind(window,this,"Column API"),100)},t.prototype.getAllColumns=function(){return Ee("28.0","getAllColumns","getColumns"),this.getColumns()},t.prototype.getPrimaryColumns=function(){return Ee("28.0","getPrimaryColumns","getColumns"),this.getColumns()},t.prototype.getSecondaryColumns=function(){return Ee("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()},t.prototype.setSecondaryColumns=function(t){Ee("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(t)},t.prototype.getSecondaryPivotColumn=function(t,e){return Ee("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(t,e)},gf([$("columnModel")],t.prototype,"columnModel",void 0),gf([Q],t.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),t=gf([J("columnApi")],t)}(),yf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.initialised=!1,e.isSsrm=!1,e}return yf(e,t),e.prototype.init=function(){var t=this;this.isSsrm=this.gridOptionsService.isRowModelType("serverSide"),this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener(Yt.EVENT_CELL_VALUE_CHANGED,(function(e){return t.callColumnCellValueChangedHandler(e)}),this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",(function(e){return t.isTreeData=e.currentValue}))},e.prototype.getValue=function(t,e,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),this.initialised||this.init(),e){var o,i=t.getColDef(),s=i.field,a=t.getColId(),l=e.data,u=e.groupData&&void 0!==e.groupData[a],c=!r&&e.aggData&&void 0!==e.aggData[a],p=this.isSsrm&&r&&!!t.getColDef().aggFunc,h=this.isSsrm&&e.footer&&e.field&&(!0===t.getColDef().showRowGroup||t.getColDef().showRowGroup===e.field);if(n&&i.filterValueGetter?o=this.executeFilterValueGetter(i.filterValueGetter,l,t,e):this.isTreeData&&c?o=e.aggData[a]:this.isTreeData&&i.valueGetter?o=this.executeValueGetter(i.valueGetter,l,t,e):this.isTreeData&&s&&l?o=E(l,s,t.isFieldContainsDots()):u?o=e.groupData[a]:c?o=e.aggData[a]:i.valueGetter?o=this.executeValueGetter(i.valueGetter,l,t,e):h?o=E(l,e.field,t.isFieldContainsDots()):s&&l&&!p&&(o=E(l,s,t.isFieldContainsDots())),this.cellExpressions&&"string"===typeof o&&0===o.indexOf("=")){var d=o.substring(1);o=this.executeValueGetter(d,l,t,e)}if(null==o){var f=this.getOpenedGroup(e,t);if(null!=f)return f}return o}},e.prototype.getOpenedGroup=function(t,e){if(this.gridOptionsService.is("showOpenedGroup")&&e.getColDef().showRowGroup)for(var n=e.getColDef().showRowGroup,r=t.parent;null!=r;){if(r.rowGroupColumn&&(!0===n||n===r.rowGroupColumn.getColId()))return r.key;r=r.parent}},e.prototype.setValue=function(t,e,n,r){var s=this.columnModel.getPrimaryColumn(e);if(!t||!s)return!1;i(t.data)&&(t.data={});var a=s.getColDef(),l=a.field,u=a.valueSetter;if(i(l)&&i(u))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(s,n))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;var c,p={node:t,data:t.data,oldValue:this.getValue(s,t),newValue:n,colDef:s.getColDef(),column:s,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};if(p.newValue=n,void 0===(c=o(u)?"function"===typeof u?u(p):this.expressionService.evaluate(u,p):this.setValueUsingField(t.data,l,n,s.isFieldContainsDots()))&&(c=!0),!c)return!1;t.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),p.newValue=this.getValue(s,t);var h={type:Yt.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:p.column,api:p.api,columnApi:p.columnApi,colDef:p.colDef,context:p.context,data:t.data,node:t,oldValue:p.oldValue,newValue:p.newValue,value:p.newValue,source:r};return this.eventService.dispatchEvent(h),!0},e.prototype.callColumnCellValueChangedHandler=function(t){var e=t.colDef.onCellValueChanged;"function"===typeof e&&e({node:t.node,data:t.data,oldValue:t.oldValue,newValue:t.newValue,colDef:t.colDef,column:t.column,api:t.api,columnApi:t.columnApi,context:t.context})},e.prototype.setValueUsingField=function(t,e,n,r){if(!e)return!1;var o=!1;if(r)for(var i=e.split("."),s=t;i.length>0&&s;){var a=i.shift();0===i.length?(o=s[a]==n)||(s[a]=n):s=s[a]}else(o=t[e]==n)||(t[e]=n);return!o},e.prototype.executeFilterValueGetter=function(t,e,n,r){var o={data:e,node:r,column:n,colDef:n.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,r)};return"function"===typeof t?t(o):this.expressionService.evaluate(t,o)},e.prototype.executeValueGetter=function(t,e,n,r){var o=n.getColId(),i=this.valueCache.getValue(r,o);if(void 0!==i)return i;var s,a={data:e,node:r,column:n,colDef:n.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,r)};return s="function"===typeof t?t(a):this.expressionService.evaluate(t,a),this.valueCache.setValue(r,o,s),s},e.prototype.getValueCallback=function(t,e){var n=this.columnModel.getPrimaryColumn(e);return n?this.getValue(n,t):null},e.prototype.getKeyForNode=function(t,e){var n=this.getValue(t,e),r=t.getColDef().keyCreator,o=n;r&&(o=r({value:n,colDef:t.getColDef(),column:t,node:e,data:e.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}));return"string"===typeof o||null==o||"[object Object]"===(o=String(o))&&O((function(){console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")}),"getKeyForNode - warn about [object,object]"),o},vf([$("expressionService")],e.prototype,"expressionService",void 0),vf([$("columnModel")],e.prototype,"columnModel",void 0),vf([$("valueCache")],e.prototype,"valueCache",void 0),vf([$("dataTypeService")],e.prototype,"dataTypeService",void 0),vf([Z],e.prototype,"init",null),e=vf([J("valueService")],e)}(jt),wf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Cf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},bf=function(t,e){return function(n,r){e(n,r,t)}},xf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.expressionToFunctionCache={},e}return wf(e,t),e.prototype.setBeans=function(t){this.logger=t.create("ExpressionService")},e.prototype.evaluate=function(t,e){if("string"===typeof t)return this.evaluateExpression(t,e);console.error("AG Grid: value should be either a string or a function",t)},e.prototype.evaluateExpression=function(t,e){try{return this.createExpressionFunction(t)(e.value,e.context,e.oldValue,e.newValue,e.value,e.node,e.data,e.colDef,e.rowIndex,e.api,e.columnApi,e.getValue,e.column,e.columnGroup)}catch(n){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Params =",e),console.log("Exception = "+n),null}},e.prototype.createExpressionFunction=function(t){if(this.expressionToFunctionCache[t])return this.expressionToFunctionCache[t];var e=this.createFunctionBody(t),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",e);return this.expressionToFunctionCache[t]=n,n},e.prototype.createFunctionBody=function(t){return t.indexOf("return")>=0?t:"return "+t+";"},Cf([bf(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=Cf([J("expressionService")],e)}(jt),Ef=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateCache={},e.waitingCallbacks={},e}return Ef(e,t),e.prototype.getTemplate=function(t,e){var n=this.templateCache[t];if(n)return n;var r=this.waitingCallbacks[t],o=this;if(!r){r=[],this.waitingCallbacks[t]=r;var i=new XMLHttpRequest;i.onload=function(){o.handleHttpResult(this,t)},i.open("GET",t),i.send()}return e&&r.push(e),null},e.prototype.handleHttpResult=function(t,e){if(200===t.status&&null!==t.response){this.templateCache[e]=t.response||t.responseText;for(var n=this.waitingCallbacks[e],r=0;r<n.length;r++){(0,n[r])()}}else console.warn("AG Grid: Unable to get template error "+t.status+" - "+e)},e=Sf([J("templateService")],e)}(jt),Rf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Of=function(t,e){return function(n,r){e(n,r,t)}},If=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Rf(e,t),e.prototype.setBeans=function(t){this.logging=t.is("debug")},e.prototype.create=function(t){return new Af(t,this.isLogging.bind(this))},e.prototype.isLogging=function(){return this.logging},Pf([Of(0,nt("gridOptionsService"))],e.prototype,"setBeans",null),e=Pf([J("loggerFactory")],e)}(jt),Af=function(){function t(t,e){this.name=t,this.isLoggingFunc=e}return t.prototype.isLogging=function(){return this.isLoggingFunc()},t.prototype.log=function(t){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+t)},t}(),Df=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Lf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Df(e,t),e.prototype.setComp=function(t,e,n){var r=this;this.view=t,this.eGridHostDiv=e,this.eGui=n,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:function(){return r.eGui},isInterestedIn:function(t){return t===Gi.HeaderCell||t===Gi.ToolPanel},getIconName:function(){return zs.ICON_NOT_ALLOWED}}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(e),this.createManagedBean(new wl(this.view)),this.addRtlSupport(),this.addManagedListener(this,Yt.EVENT_KEYBOARD_FOCUS,(function(){r.view.addOrRemoveKeyboardFocusClass(!0)})),this.addManagedListener(this,Yt.EVENT_MOUSE_FOCUS,(function(){r.view.addOrRemoveKeyboardFocusClass(!1)}));var o=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((function(){return o()})),this.ctrlsService.registerGridCtrl(this)},e.prototype.isDetailGrid=function(){var t,e=this.focusService.findTabbableParent(this.getGui());return(null===(t=null===e||void 0===e?void 0:e.getAttribute("row-id"))||void 0===t?void 0:t.startsWith("detail"))||!1},e.prototype.showDropZones=function(){return W.__isRegistered(z.RowGroupingModule,this.context.getGridId())},e.prototype.showSideBar=function(){return W.__isRegistered(z.SideBarModule,this.context.getGridId())},e.prototype.showStatusBar=function(){return W.__isRegistered(z.StatusBarModule,this.context.getGridId())},e.prototype.showWatermark=function(){return W.__isRegistered(z.EnterpriseCoreModule,this.context.getGridId())},e.prototype.onGridSizeChanged=function(){var t={type:Yt.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(t)},e.prototype.addRtlSupport=function(){var t=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(t)},e.prototype.destroyGridUi=function(){this.view.destroyGridUi()},e.prototype.getGui=function(){return this.eGui},e.prototype.setResizeCursor=function(t){this.view.setCursor(t?"ew-resize":null)},e.prototype.disableUserSelect=function(t){this.view.setUserSelect(t?"none":null)},e.prototype.focusNextInnerContainer=function(t){var e=this.gridOptionsService.getDocument(),n=this.view.getFocusableContainers(),r=n.findIndex((function(t){return t.contains(e.activeElement)}))+(t?-1:1);return!(r<=0||r>=n.length)&&this.focusService.focusInto(n[r])},e.prototype.focusInnerElement=function(t){var e=this.view.getFocusableContainers(),n=this.columnModel.getAllDisplayedColumns();if(t){if(e.length>1)return this.focusService.focusInto(yt(e),!0);var r=yt(n);if(this.focusService.focusGridView(r,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(n[0]):this.focusService.focusFirstHeader()},e.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1),this.view.forceFocusOutOfContainer(t)},Mf([$("focusService")],e.prototype,"focusService",void 0),Mf([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Mf([$("columnModel")],e.prototype,"columnModel",void 0),Mf([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Mf([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Mf([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),e}(jt),Nf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ff=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},kf=function(t){function e(e){var n=t.call(this)||this;return n.eGridDiv=e,n}return Nf(e,t),e.prototype.postConstruct=function(){var t=this;this.logger=this.loggerFactory.create("GridComp");var e={destroyGridUi:function(){return t.destroyBean(t)},setRtlClass:function(e){return t.addCssClass(e)},addOrRemoveKeyboardFocusClass:function(e){return t.addOrRemoveCssClass(pp.AG_KEYBOARD_FOCUS,e)},forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:function(e){t.getGui().style.userSelect=null!=e?e:"",t.getGui().style.webkitUserSelect=null!=e?e:""},setCursor:function(e){t.getGui().style.cursor=null!=e?e:""}};this.ctrl=this.createManagedBean(new Lf);var n=this.createTemplate();this.setTemplate(n),this.ctrl.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:function(){},focusInnerElement:function(e){return t.ctrl.focusInnerElement(e)}})},e.prototype.insertGridIntoDom=function(){var t=this,e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc((function(){t.eGridDiv.removeChild(e),t.logger.log("Grid removed from DOM")}))},e.prototype.updateLayoutClasses=function(t,e){var n=this.eRootWrapperBody.classList;n.toggle(il.AUTO_HEIGHT,e.autoHeight),n.toggle(il.NORMAL,e.normal),n.toggle(il.PRINT,e.print),this.addOrRemoveCssClass(il.AUTO_HEIGHT,e.autoHeight),this.addOrRemoveCssClass(il.NORMAL,e.normal),this.addOrRemoveCssClass(il.PRINT,e.print)},e.prototype.createTemplate=function(){return'<div class="ag-root-wrapper" role="presentation">\n                '+(this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"")+'\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    '+(this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"")+"\n                </div>\n                "+(this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"")+"\n                <ag-pagination></ag-pagination>\n                "+(this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"")+"\n            </div>"},e.prototype.getFocusableElement=function(){return this.eRootWrapperBody},e.prototype.getFocusableContainers=function(){var t=[this.gridBodyComp.getGui()];return this.sideBarComp&&t.push(this.sideBarComp.getGui()),t.filter((function(t){return Er(t)}))},Ff([$("loggerFactory")],e.prototype,"loggerFactory",void 0),Ff([To("gridBody")],e.prototype,"gridBodyComp",void 0),Ff([To("sideBar")],e.prototype,"sideBarComp",void 0),Ff([To("rootWrapperBody")],e.prototype,"eRootWrapperBody",void 0),Ff([Z],e.prototype,"postConstruct",null),e}(od),Gf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Vf=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},zf=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return Gf(e,t),n=e,e.prototype.progressSort=function(t,e,n){var r=this.getNextSortDirection(t);this.setSortForColumn(t,r,e,n)},e.prototype.setSortForColumn=function(t,e,n,r){"asc"!==e&&"desc"!==e&&(e=null);var o=[t];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&t.getColDef().showRowGroup){var i=this.columnModel.getSourceColumnsForGroupColumn(t),s=null===i||void 0===i?void 0:i.filter((function(t){return t.getColDef().sortable}));s&&(o=zf([t],Vf(s)))}o.forEach((function(t){return t.setSort(e,r)})),(n||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(o,r),this.updateSortIndex(t),this.dispatchSortChangedEvents(r)},e.prototype.updateSortIndex=function(t){var e=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=this.columnModel.getGroupDisplayColumnForGroup(t.getId()),r=e&&n||t,o=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(t){return t.setSortIndex(null)}));var i=o.filter((function(t){return t!==r}));(r.getSort()?zf(zf([],Vf(i)),[r]):i).forEach((function(t,e){return t.setSortIndex(e)}))},e.prototype.onSortChanged=function(t){this.dispatchSortChangedEvents(t)},e.prototype.isSortActive=function(){var t=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(t){return!!t.getSort()}));return t&&t.length>0},e.prototype.dispatchSortChangedEvents=function(t){var e={type:Yt.EVENT_SORT_CHANGED,source:t};this.eventService.dispatchEvent(e)},e.prototype.clearSortBarTheseColumns=function(t,e){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(n){t.includes(n)||n.setSort(void 0,e)}))},e.prototype.getNextSortDirection=function(t){var e;if(e=t.getColDef().sortingOrder?t.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):n.DEFAULT_SORTING_ORDER,!Array.isArray(e)||e.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's "+e),null;var r,o=e.indexOf(t.getSort()),i=o<0,s=o==e.length-1;return r=i||s?e[0]:e[o+1],n.DEFAULT_SORTING_ORDER.indexOf(r)<0?(console.warn("AG Grid: invalid sort type "+r),null):r},e.prototype.getIndexedSortMap=function(){var t=this,e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(t){return!!t.getSort()}));if(this.columnModel.isPivotMode()){var n=this.gridOptionsService.isColumnsSortingCoupledToGroup();e=e.filter((function(e){var r=!!e.getAggFunc(),o=!e.isPrimary(),i=n?t.columnModel.getGroupDisplayColumnForGroup(e.getId()):e.getColDef().showRowGroup;return r||o||i}))}var r=this.columnModel.getRowGroupColumns().filter((function(t){return!!t.getSort()})),o=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!r.length;o&&(e=zf([],Vf(new Set(e.map((function(e){var n;return null!==(n=t.columnModel.getGroupDisplayColumnForGroup(e.getId()))&&void 0!==n?n:e}))))));var i={};e.forEach((function(t,e){return i[t.getId()]=e})),e.sort((function(t,e){var n=t.getSortIndex(),r=e.getSortIndex();return null!=n&&null!=r?n-r:null==n&&null==r?i[t.getId()]>i[e.getId()]?1:-1:null==r?-1:1}));var s=new Map;return e.forEach((function(t,e){return s.set(t,e)})),o&&r.forEach((function(e){var n=t.columnModel.getGroupDisplayColumnForGroup(e.getId());s.set(e,s.get(n))})),s},e.prototype.getColumnsWithSortingOrdered=function(){return zf([],Vf(this.getIndexedSortMap().entries())).sort((function(t,e){var n=Vf(t,2);n[0];var r=n[1],o=Vf(e,2);return o[0],r-o[1]})).map((function(t){return Vf(t,1)[0]}))},e.prototype.getSortModel=function(){return this.getColumnsWithSortingOrdered().map((function(t){return{sort:t.getSort(),colId:t.getId()}}))},e.prototype.getSortOptions=function(){return this.getColumnsWithSortingOrdered().map((function(t){return{sort:t.getSort(),column:t}}))},e.prototype.canColumnDisplayMixedSort=function(t){var e=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=!!t.getColDef().showRowGroup;return e&&n},e.prototype.getDisplaySortForColumn=function(t){var e=this.columnModel.getSourceColumnsForGroupColumn(t);if(!this.canColumnDisplayMixedSort(t)||!(null===e||void 0===e?void 0:e.length))return t.getSort();var n=null!=t.getColDef().field||!!t.getColDef().valueGetter?zf([t],Vf(e)):e,r=n[0].getSort();return n.every((function(t){return t.getSort()==r}))?r:"mixed"},e.prototype.getDisplaySortIndexForColumn=function(t){return this.getIndexedSortMap().get(t)},e.DEFAULT_SORTING_ORDER=["asc","desc",null],Bf([$("columnModel")],e.prototype,"columnModel",void 0),e=n=Bf([J("sortController")],e)}(jt),Hf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Uf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Hf(e,t),e.prototype.setMouseOver=function(t){this.selectedColumns=t;var e={type:Yt.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.clearMouseOver=function(){this.selectedColumns=null;var t={type:Yt.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)},e.prototype.isHovered=function(t){return!!this.selectedColumns&&this.selectedColumns.indexOf(t)>=0},e=Uf([J("columnHoverService")],e)}(jt),qf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Kf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.executeNextFuncs=[],e.executeLaterFuncs=[],e.active=!1,e.animationThreadCount=0,e}return qf(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){return t.gridBodyCtrl=e.gridBodyCtrl}))},e.prototype.isActive=function(){return this.active},e.prototype.start=function(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)},e.prototype.finish=function(){this.active&&(this.flush(),this.active=!1)},e.prototype.executeNextVMTurn=function(t){this.active?this.executeNextFuncs.push(t):t()},e.prototype.executeLaterVMTurn=function(t){this.active?this.executeLaterFuncs.push(t):t()},e.prototype.ensureAnimationCssClassPresent=function(){var t=this;this.animationThreadCount++;var e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push((function(){t.animationThreadCount===e&&t.gridBodyCtrl.setColumnMovingCss(!1)}))},e.prototype.flush=function(){var t=this.executeNextFuncs;this.executeNextFuncs=[];var e=this.executeLaterFuncs;this.executeLaterFuncs=[],0===t.length&&0===e.length||(window.setTimeout((function(){return t.forEach((function(t){return t()}))}),0),window.setTimeout((function(){return e.forEach((function(t){return t()}))}),300))},Xf([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Xf([Z],e.prototype,"postConstruct",null),e=Xf([J("columnAnimationService")],e)}(jt),Yf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zf=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yf(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.centerRowContainerCon=e.centerRowContainerCtrl,t.addManagedListener(t.eventService,Yt.EVENT_BODY_HEIGHT_CHANGED,t.checkPageSize.bind(t)),t.addManagedListener(t.eventService,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,t.checkPageSize.bind(t)),t.checkPageSize()}))},e.prototype.notActive=function(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon},e.prototype.checkPageSize=function(){var t=this;if(!this.notActive()){var e=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(e>0){var n=function(){var n=t.gridOptionsService.getRowHeightAsNumber(),r=Math.floor(e/n);t.gridOptionsService.set("paginationPageSize",r)};this.isBodyRendered?k((function(){return n()}),50)():(n(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},Zf([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Zf([Z],e.prototype,"postConstruct",null),e=Zf([J("paginationAutoPageSizeService")],e)}(jt),Jf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$f=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},tg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cacheVersion=0,e}return Jf(e,t),e.prototype.init=function(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")},e.prototype.onDataChanged=function(){this.neverExpires||this.expire()},e.prototype.expire=function(){this.cacheVersion++},e.prototype.setValue=function(t,e,n){this.active&&(t.__cacheVersion!==this.cacheVersion&&(t.__cacheVersion=this.cacheVersion,t.__cacheData={}),t.__cacheData[e]=n)},e.prototype.getValue=function(t,e){if(this.active&&t.__cacheVersion===this.cacheVersion)return t.__cacheData[e]},$f([Z],e.prototype,"init",null),e=$f([J("valueCache")],e)}(jt),eg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ng=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},rg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return eg(e,t),e.prototype.init=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,Yt.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))},e.prototype.onCellValueChanged=function(t){"paste"!==t.source&&this.doChangeDetection(t.node,t.column)},e.prototype.doChangeDetection=function(t,e){if(!this.gridOptionsService.is("suppressChangeDetection")){var n=[t];if(this.clientSideRowModel&&!t.isRowPinned()){var r=this.gridOptionsService.is("aggregateOnlyChangedColumns"),o=new Ah(r,this.clientSideRowModel.getRootNode());o.addParentNode(t.parent,[e]),this.clientSideRowModel.doAggregate(o),o.forEachChangedNodeDepthFirst((function(t){n.push(t)}))}this.rowRenderer.refreshCells({rowNodes:n})}},ng([$("rowModel")],e.prototype,"rowModel",void 0),ng([$("rowRenderer")],e.prototype,"rowRenderer",void 0),ng([Z],e.prototype,"init",null),e=ng([J("changeDetectionService")],e)}(jt),og=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ig=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},sg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return og(e,t),e.prototype.adaptFunction=function(t,e){var n=this.componentMetadataProvider.retrieve(t);return n&&n.functionAdapter?n.functionAdapter(e):null},e.prototype.adaptCellRendererFunction=function(t){return function(){function e(){}return e.prototype.refresh=function(t){return!1},e.prototype.getGui=function(){return this.eGui},e.prototype.init=function(e){var n=t(e),r=typeof n;this.eGui="string"!==r&&"number"!==r&&"boolean"!==r?null!=n?n:Sr("<span></span>"):Sr("<span>"+n+"</span>")},e}()},e.prototype.doesImplementIComponent=function(t){return!!t&&(t.prototype&&"getGui"in t.prototype)},ig([$("componentMetadataProvider")],e.prototype,"componentMetadataProvider",void 0),e=ig([J("agComponentUtils")],e)}(jt),ag=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ug=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ag(e,t),e.prototype.postConstruct=function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}},e.prototype.retrieve=function(t){return this.componentMetaData[t]},lg([$("agComponentUtils")],e.prototype,"agComponentUtils",void 0),lg([Z],e.prototype,"postConstruct",null),e=lg([J("componentMetadataProvider")],e)}(jt),cg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},hg=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},dg=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},fg={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},gg={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},mg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.calculatedSizes={},e}return cg(e,t),e.prototype.postConstruct=function(){var t,e=this,n=null!==(t=this.getTheme().el)&&void 0!==t?t:this.eGridDiv;this.mutationObserver=new MutationObserver((function(){e.calculatedSizes={},e.fireGridStylesChangedEvent()})),this.mutationObserver.observe(n||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})},e.prototype.fireGridStylesChangedEvent=function(){var t={type:Yt.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(t)},e.prototype.getSassVariable=function(t){var e=this.getTheme(),n=e.themeFamily,r=e.el;if(n&&0===n.indexOf("ag-theme")){this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[n]||(this.calculatedSizes[n]={});var o=this.calculatedSizes[n][t];return null!=o?o:(this.calculatedSizes[n][t]=this.calculateValueForSassProperty(t,n,r),this.calculatedSizes[n][t])}},e.prototype.calculateValueForSassProperty=function(t,e,n){var r,o="ag-theme-"+(e.match("material")?"material":e.match("balham")?"balham":e.match("alpine")?"alpine":"custom"),i=fg[o][t],s=this.gridOptionsService.getDocument();if(n||(n=this.eGridDiv),!gg[t])return i;var a=gg[t],l=s.createElement("div"),u=Array.from(n.classList);(r=l.classList).add.apply(r,dg([e],hg(u))),l.style.position="absolute";var c=a.reduce((function(t,e){var n=s.createElement("div");return n.style.position="static",n.classList.add(e),t.appendChild(n),n}),l),p=0;if(s.body){s.body.appendChild(l);var h=-1!==t.toLowerCase().indexOf("height")?"height":"width";p=parseInt(window.getComputedStyle(c)[h],10),s.body.removeChild(l)}return p||i},e.prototype.isThemeDark=function(){var t=this.getTheme().theme;return!!t&&t.indexOf("dark")>=0},e.prototype.chartMenuPanelWidth=function(){return this.getSassVariable("chartMenuPanelWidth")},e.prototype.getTheme=function(){for(var t=/\bag-(material|(?:theme-([\w\-]*)))\b/g,e=this.eGridDiv,n=null,r=[];e;){if(n=t.exec(e.className)){var o=e.className.match(t);o&&(r=o);break}e=e.parentElement||void 0}if(!n)return{allThemes:r};var i=n[0];return{theme:i,el:e,themeFamily:i.replace(/-dark$/,""),allThemes:r}},e.prototype.getFromTheme=function(t,e){var n;return null!==(n=this.getSassVariable(e))&&void 0!==n?n:t},e.prototype.getDefaultRowHeight=function(){return this.getFromTheme(25,"rowHeight")},e.prototype.getListItemHeight=function(){return this.getFromTheme(20,"listItemHeight")},e.prototype.setRowHeightVariable=function(t){var e=t+"px";this.eGridDiv.style.getPropertyValue("--ag-line-height").trim()!=e&&this.eGridDiv.style.setProperty("--ag-line-height",e)},e.prototype.getMinColWidth=function(){var t=this.getFromTheme(null,"headerCellMinWidth");return o(t)?Math.max(t,10):10},e.prototype.destroy=function(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),t.prototype.destroy.call(this)},pg([$("eGridDiv")],e.prototype,"eGridDiv",void 0),pg([Z],e.prototype,"postConstruct",null),e=pg([J("environment")],e)}(jt),yg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_g=function(t,e){return function(n,r){e(n,r,t)}},wg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollY=0,e.uiBodyHeight=0,e}return yg(e,t),e.prototype.agWire=function(t){this.logger=t.create("RowContainerHeightService")},e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Yt.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=zn(),this.logger.log("maxDivHeight = "+this.maxDivHeight)},e.prototype.isStretching=function(){return this.stretching},e.prototype.getDivStretchOffset=function(){return this.divStretchOffset},e.prototype.updateOffset=function(){if(this.stretching){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,e=this.getUiBodyHeight();(t!==this.scrollY||e!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=e,this.calculateOffset())}},e.prototype.calculateOffset=function(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var t=this.scrollY/this.maxScrollY,e=t*this.pixelsToShave;this.logger.log("Div Stretch Offset = "+e+" ("+this.pixelsToShave+" * "+t+")"),this.setDivStretchOffset(e)},e.prototype.setUiContainerHeight=function(t){t!==this.uiContainerHeight&&(this.uiContainerHeight=t,this.eventService.dispatchEvent({type:Yt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))},e.prototype.clearOffset=function(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)},e.prototype.setDivStretchOffset=function(t){var e="number"===typeof t?Math.floor(t):null;this.divStretchOffset!==e&&(this.divStretchOffset=e,this.eventService.dispatchEvent({type:Yt.EVENT_HEIGHT_SCALE_CHANGED}))},e.prototype.setModelHeight=function(t){this.modelHeight=t,this.stretching=null!=t&&this.maxDivHeight>0&&t>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()},e.prototype.getUiContainerHeight=function(){return this.uiContainerHeight},e.prototype.getRealPixelPosition=function(t){return t-this.divStretchOffset},e.prototype.getUiBodyHeight=function(){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return t.bottom-t.top},e.prototype.getScrollPositionForPixel=function(t){if(this.pixelsToShave<=0)return t;var e=t/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*e},vg([$("ctrlsService")],e.prototype,"ctrlsService",void 0),vg([_g(0,nt("loggerFactory"))],e.prototype,"agWire",null),vg([Z],e.prototype,"postConstruct",null),e=vg([J("rowContainerHeightService")],e)}(jt),Cg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Cg(e,t),e.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")},e.prototype.updateSelectableAfterGrouping=function(t){if(this.isRowSelectableFunc){this.recurseDown(t.childrenAfterGroup,(function(t){return t.childrenAfterGroup}))}},e.prototype.recurseDown=function(t,e){var n=this;t&&t.forEach((function(t){if(t.group){var r;if(t.hasChildren()&&n.recurseDown(e(t),e),n.groupSelectsChildren)r=o((e(t)||[]).find((function(t){return!0===t.selectable})));else r=!!n.isRowSelectableFunc&&n.isRowSelectableFunc(t);t.setRowSelectable(r)}}))},bg([Z],e.prototype,"init",null),e=bg([J("selectableService")],e)}(jt),Eg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tg=function(t){function e(){var e=t.call(this)||this;return e.previousAndFirstButtonsDisabled=!1,e.nextButtonDisabled=!1,e.lastButtonDisabled=!1,e.areListenersSetup=!1,e}return Eg(e,t),e.prototype.postConstruct=function(){var t=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate());var e=this.btFirst,n=this.btPrevious,r=this.btNext,o=this.btLast;this.activateTabIndex([e,n,r,o]),e.insertAdjacentElement("afterbegin",Xr(t?"last":"first",this.gridOptionsService)),n.insertAdjacentElement("afterbegin",Xr(t?"next":"previous",this.gridOptionsService)),r.insertAdjacentElement("afterbegin",Xr(t?"previous":"next",this.gridOptionsService)),o.insertAdjacentElement("afterbegin",Xr(t?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()},e.prototype.onPaginationChanged=function(){var t=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())},e.prototype.setupListeners=function(){var t=this;this.areListenersSetup||(this.addManagedListener(this.eventService,Yt.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((function(e){var n=e.el,r=e.fn;t.addManagedListener(n,"click",r),t.addManagedListener(n,"keydown",(function(t){t.key!==Yr.ENTER&&t.key!==Yr.SPACE||(t.preventDefault(),r())}))})),this.areListenersSetup=!0)},e.prototype.onBtFirst=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()},e.prototype.setCurrentPageLabel=function(){var t=this.paginationProxy.getTotalPages()>0,e=this.paginationProxy.getCurrentPage(),n=t?e+1:0;this.lbCurrent.innerHTML=this.formatNumber(n)},e.prototype.formatNumber=function(t){var e=this.gridOptionsService.getCallback("paginationNumberFormatter");if(e)return e({value:t});var n=this.localeService.getLocaleTextFunc();return Zn(t,n("thousandSeparator",","),n("decimalSeparator","."))},e.prototype.getTemplate=function(){var t=this.localeService.getLocaleTextFunc(),e=t("page","Page"),n=t("to","to"),r=t("of","of"),o=t("firstPage","First Page"),i=t("previousPage","Previous Page"),s=t("nextPage","Next Page"),a=t("lastPage","Last Page"),l=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'+l+'">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-'+l+'-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+l+'-to">'+n+'</span>\n                    <span id="ag-'+l+'-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+l+'-of">'+r+'</span>\n                    <span id="ag-'+l+'-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="'+o+'"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="'+i+'"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-'+l+'-start-page">'+e+'</span>\n                        <span id="ag-'+l+'-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-'+l+'-of-page">'+r+'</span>\n                        <span id="ag-'+l+'-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="'+s+'"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="'+a+'"></div>\n                </span>\n            </div>'},e.prototype.onBtNext=function(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()},e.prototype.onBtPrevious=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()},e.prototype.onBtLast=function(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()},e.prototype.enableOrDisableButtons=function(){var t=this.paginationProxy.getCurrentPage(),e=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===t,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);var r=this.isZeroPagesToDisplay(),o=e&&t===n-1;this.nextButtonDisabled=o||r,this.lastButtonDisabled=!e||r||t===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)},e.prototype.toggleButtonDisabled=function(t,e){sn(t,e),t.classList.toggle("ag-disabled",e)},e.prototype.updateRowLabels=function(){var t,e,n=this.paginationProxy.getCurrentPage(),r=this.paginationProxy.getPageSize(),o=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;if(this.isZeroPagesToDisplay()?t=e=0:(e=(t=r*n+1)+r-1,o&&e>i&&(e=i)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(t),this.rowNodeBlockLoader.isLoading()){var s=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=s("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(e)},e.prototype.isZeroPagesToDisplay=function(){var t=this.paginationProxy.isLastPageFound(),e=this.paginationProxy.getTotalPages();return t&&0===e},e.prototype.setTotalLabels=function(){var t=this.paginationProxy.isLastPageFound(),e=this.paginationProxy.getTotalPages(),n=t?this.paginationProxy.getMasterRowCount():null;if(1===n){var r=this.paginationProxy.getRow(0);if(r&&r.group&&!(r.groupData||r.aggData))return void this.setTotalLabelsToZero()}if(t)this.lbTotal.innerHTML=this.formatNumber(e),this.lbRecordCount.innerHTML=this.formatNumber(n);else{var o=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=o,this.lbRecordCount.innerHTML=o}},e.prototype.setTotalLabelsToZero=function(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)},Sg([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Sg([$("rowNodeBlockLoader")],e.prototype,"rowNodeBlockLoader",void 0),Sg([To("btFirst")],e.prototype,"btFirst",void 0),Sg([To("btPrevious")],e.prototype,"btPrevious",void 0),Sg([To("btNext")],e.prototype,"btNext",void 0),Sg([To("btLast")],e.prototype,"btLast",void 0),Sg([To("lbRecordCount")],e.prototype,"lbRecordCount",void 0),Sg([To("lbFirstRowOnPage")],e.prototype,"lbFirstRowOnPage",void 0),Sg([To("lbLastRowOnPage")],e.prototype,"lbLastRowOnPage",void 0),Sg([To("lbCurrent")],e.prototype,"lbCurrent",void 0),Sg([To("lbTotal")],e.prototype,"lbTotal",void 0),Sg([Z],e.prototype,"postConstruct",null),e}(Eo),Rg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.Loading=0]="Loading",t[t.NoRows=1]="NoRows"}(Vd||(Vd={}));var Og=function(t){function e(){var n=t.call(this,e.TEMPLATE)||this;return n.inProgress=!1,n.destroyRequested=!1,n.manuallyDisplayed=!1,n}return Rg(e,t),e.prototype.updateLayoutClasses=function(t,e){var n=this.eOverlayWrapper.classList;n.toggle(il.AUTO_HEIGHT,e.autoHeight),n.toggle(il.NORMAL,e.normal),n.toggle(il.PRINT,e.print)},e.prototype.postConstruct=function(){this.createManagedBean(new wl(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,Yt.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)},e.prototype.setWrapperTypeClass=function(t){var e=this.eOverlayWrapper.classList;e.toggle("ag-overlay-loading-wrapper",t===Vd.Loading),e.toggle("ag-overlay-no-rows-wrapper",t===Vd.NoRows)},e.prototype.showLoadingOverlay=function(){if(!this.gridOptionsService.is("suppressLoadingOverlay")){var t=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(t,Vd.Loading)}},e.prototype.showNoRowsOverlay=function(){if(!this.gridOptionsService.is("suppressNoRowsOverlay")){var t=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(t,Vd.NoRows)}},e.prototype.showOverlay=function(t,e){var n=this;this.inProgress||(this.setWrapperTypeClass(e),this.destroyActiveOverlay(),this.inProgress=!0,t&&t.then((function(t){n.inProgress=!1,n.eOverlayWrapper.appendChild(t.getGui()),n.activeOverlay=t,n.destroyRequested&&(n.destroyRequested=!1,n.destroyActiveOverlay())})),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))},e.prototype.destroyActiveOverlay=function(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),br(this.eOverlayWrapper))},e.prototype.hideOverlay=function(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})},e.prototype.destroy=function(){this.destroyActiveOverlay(),t.prototype.destroy.call(this)},e.prototype.showOrHideOverlay=function(){var t=this.paginationProxy.isEmpty(),e=this.gridOptionsService.is("suppressNoRowsOverlay");t&&!e?this.showNoRowsOverlay():this.hideOverlay()},e.prototype.onRowDataUpdated=function(){this.showOrHideOverlay()},e.prototype.onNewColumnsLoaded=function(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()},e.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',Pg([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Pg([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Pg([$("gridApi")],e.prototype,"gridApi",void 0),Pg([$("columnModel")],e.prototype,"columnModel",void 0),Pg([To("eOverlayWrapper")],e.prototype,"eOverlayWrapper",void 0),Pg([Z],e.prototype,"postConstruct",null),e}(Eo),Ig=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ag=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Dg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ig(e,t),e.prototype.getFirstRow=function(){var t,e=0;return this.pinnedRowModel.getPinnedTopRowCount()?t="top":this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(t="bottom"),void 0===t?null:{rowIndex:e,rowPinned:t}},e.prototype.getLastRow=function(){var t,e=null,n=this.pinnedRowModel.getPinnedBottomRowCount(),r=this.pinnedRowModel.getPinnedTopRowCount();return n?(e="bottom",t=n-1):this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageLastRow()):r&&(e="top",t=r-1),void 0===t?null:{rowIndex:t,rowPinned:e}},e.prototype.getRowNode=function(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},e.prototype.sameRow=function(t,e){return!t&&!e||!(t&&!e||!t&&e)&&(t.rowIndex===e.rowIndex&&t.rowPinned==e.rowPinned)},e.prototype.before=function(t,e){switch(t.rowPinned){case"top":if("top"!==e.rowPinned)return!0;break;case"bottom":if("bottom"!==e.rowPinned)return!1;break;default:if(o(e.rowPinned))return"top"!==e.rowPinned}return t.rowIndex<e.rowIndex},e.prototype.rowMax=function(t){var e,n=this;return t.forEach((function(t){(void 0===e||n.before(e,t))&&(e=t)})),e},e.prototype.rowMin=function(t){var e,n=this;return t.forEach((function(t){(void 0===e||n.before(t,e))&&(e=t)})),e},Ag([$("rowModel")],e.prototype,"rowModel",void 0),Ag([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Ag([$("paginationProxy")],e.prototype,"paginationProxy",void 0),e=Ag([J("rowPositionUtils")],e)}(jt),Mg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ng=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Mg(e,t),e.prototype.createId=function(t){var e=t.rowIndex,n=t.rowPinned,r=t.column;return this.createIdFromValues({rowIndex:e,column:r,rowPinned:n})},e.prototype.createIdFromValues=function(t){var e=t.rowIndex,n=t.rowPinned;return e+"."+(null==n?"null":n)+"."+t.column.getId()},e.prototype.equals=function(t,e){var n=t.column===e.column,r=t.rowPinned===e.rowPinned,o=t.rowIndex===e.rowIndex;return n&&r&&o},e=Lg([J("cellPositionUtils")],e)}(jt),Fg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kg=function(t){this.cellValueChanges=t},Gg=function(t){function e(e,n,r,o){var i=t.call(this,e)||this;return i.initialRange=n,i.finalRange=r,i.ranges=o,i}return Fg(e,t),e}(kg),Bg=function(){function t(e){this.actionStack=[],this.maxStackSize=e||t.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}return t.prototype.pop=function(){return this.actionStack.pop()},t.prototype.push=function(t){t.cellValueChanges&&t.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(t))},t.prototype.clear=function(){this.actionStack=[]},t.prototype.getCurrentStackSize=function(){return this.actionStack.length},t.DEFAULT_STACK_SIZE=10,t}(),Vg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zg=function(){return(zg=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},jg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Hg=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ug=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Wg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cellValueChanges=[],e.activeCellEdit=null,e.activeRowEdit=null,e.isPasting=!1,e.isRangeInAction=!1,e.onCellValueChanged=function(t){var n={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned},r=null!==e.activeCellEdit&&e.cellPositionUtils.equals(e.activeCellEdit,n),o=null!==e.activeRowEdit&&e.rowPositionUtils.sameRow(e.activeRowEdit,n);if(r||o||e.isPasting||e.isRangeInAction){var i=t.rowPinned,s=t.rowIndex,a=t.column,l=t.oldValue,u=t.value,c={rowPinned:i,rowIndex:s,columnId:a.getColId(),newValue:u,oldValue:l};e.cellValueChanges.push(c)}},e.clearStacks=function(){e.undoStack.clear(),e.redoStack.clear()},e}return Vg(e,t),e.prototype.init=function(){var t=this;if(this.gridOptionsService.is("undoRedoCellEditing")){var e=this.gridOptionsService.getNum("undoRedoCellEditingLimit");e<=0||(this.undoStack=new Bg(e),this.redoStack=new Bg(e),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,Yt.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,Yt.EVENT_MODEL_UPDATED,(function(e){e.keepUndoRedoStack||t.clearStacks()})),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,Yt.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl()})))}},e.prototype.getCurrentUndoStackSize=function(){return this.undoStack?this.undoStack.getCurrentStackSize():0},e.prototype.getCurrentRedoStackSize=function(){return this.redoStack?this.redoStack.getCurrentStackSize():0},e.prototype.undo=function(t){var e={type:Yt.EVENT_UNDO_STARTED,source:t};this.eventService.dispatchEvent(e);var n=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),r={type:Yt.EVENT_UNDO_ENDED,source:t,operationPerformed:n};this.eventService.dispatchEvent(r)},e.prototype.redo=function(t){var e={type:Yt.EVENT_REDO_STARTED,source:t};this.eventService.dispatchEvent(e);var n=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),r={type:Yt.EVENT_REDO_ENDED,source:t,operationPerformed:n};this.eventService.dispatchEvent(r)},e.prototype.undoRedo=function(t,e,n,r,o){if(!t)return!1;var i=t.pop();return!(!i||!i.cellValueChanges)&&(this.processAction(i,(function(t){return t[r]}),o),i instanceof Gg?this.processRange(i.ranges||[i[n]]):this.processCell(i.cellValueChanges),e.push(i),!0)},e.prototype.processAction=function(t,e,n){var r=this;t.cellValueChanges.forEach((function(t){var o=t.rowIndex,i=t.rowPinned,s=t.columnId,a={rowIndex:o,rowPinned:i},l=r.getRowNode(a);l.displayed&&l.setDataValue(s,e(t),n)}))},e.prototype.processRange=function(t){var e,n=this;this.rangeService.removeAllCellRanges(!0),t.forEach((function(r,o){if(r){var i=r.startRow,s=r.endRow;o===t.length-1&&(e={rowPinned:i.rowPinned,rowIndex:i.rowIndex,columnId:r.startColumn.getColId()},n.setLastFocusedCell(e));var a={rowStartIndex:i.rowIndex,rowStartPinned:i.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:r.startColumn,columns:r.columns};n.rangeService.addCellRange(a)}}))},e.prototype.processCell=function(t){var e=t[0],n={rowIndex:e.rowIndex,rowPinned:e.rowPinned},r=this.getRowNode(n),o={rowPinned:e.rowPinned,rowIndex:r.rowIndex,columnId:e.columnId};this.setLastFocusedCell(o,!!this.rangeService)},e.prototype.setLastFocusedCell=function(t,e){var n=t.rowIndex,r=t.columnId,o=t.rowPinned,i=this.gridBodyCtrl.getScrollFeature(),s=this.columnModel.getGridColumn(r);if(s){i.ensureIndexVisible(n),i.ensureColumnVisible(s);var a={rowIndex:n,column:s,rowPinned:o};this.focusService.setFocusedCell(zg(zg({},a),{forceBrowserFocus:!0})),e&&this.rangeService.setRangeToCell(a)}},e.prototype.addRowEditingListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_ROW_EDITING_STARTED,(function(e){t.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}})),this.addManagedListener(this.eventService,Yt.EVENT_ROW_EDITING_STOPPED,(function(){var e=new kg(t.cellValueChanges);t.pushActionsToUndoStack(e),t.activeRowEdit=null}))},e.prototype.addCellEditingListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_CELL_EDITING_STARTED,(function(e){t.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}})),this.addManagedListener(this.eventService,Yt.EVENT_CELL_EDITING_STOPPED,(function(e){if(t.activeCellEdit=null,e.valueChanged&&!t.activeRowEdit&&!t.isPasting&&!t.isRangeInAction){var n=new kg(t.cellValueChanges);t.pushActionsToUndoStack(n)}}))},e.prototype.addPasteListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_PASTE_START,(function(){t.isPasting=!0})),this.addManagedListener(this.eventService,Yt.EVENT_PASTE_END,(function(){var e=new kg(t.cellValueChanges);t.pushActionsToUndoStack(e),t.isPasting=!1}))},e.prototype.addFillListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_FILL_START,(function(){t.isRangeInAction=!0})),this.addManagedListener(this.eventService,Yt.EVENT_FILL_END,(function(e){var n=new Gg(t.cellValueChanges,e.initialRange,e.finalRange);t.pushActionsToUndoStack(n),t.isRangeInAction=!1}))},e.prototype.addCellKeyListeners=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,(function(){t.isRangeInAction=!0})),this.addManagedListener(this.eventService,Yt.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,(function(){var e;e=t.rangeService&&t.gridOptionsService.isEnableRangeSelection()?new Gg(t.cellValueChanges,void 0,void 0,Ug([],Hg(t.rangeService.getCellRanges()))):new kg(t.cellValueChanges),t.pushActionsToUndoStack(e),t.isRangeInAction=!1}))},e.prototype.pushActionsToUndoStack=function(t){this.undoStack.push(t),this.cellValueChanges=[],this.redoStack.clear()},e.prototype.getRowNode=function(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},jg([$("focusService")],e.prototype,"focusService",void 0),jg([$("ctrlsService")],e.prototype,"ctrlsService",void 0),jg([$("rowModel")],e.prototype,"rowModel",void 0),jg([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),jg([$("cellPositionUtils")],e.prototype,"cellPositionUtils",void 0),jg([$("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),jg([$("columnModel")],e.prototype,"columnModel",void 0),jg([tt("rangeService")],e.prototype,"rangeService",void 0),jg([Z],e.prototype,"init",null),e=jg([J("undoRedoService")],e)}(jt),qg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Kg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qg(e,t),e.prototype.findHeader=function(t,e){var n,r,o;if(t.column instanceof Kt?(r="getDisplayedGroup"+e,n=this.columnModel[r](t.column)):(o="getDisplayedCol"+e,n=this.columnModel[o](t.column)),n){var i=t.headerRowIndex;if(this.getHeaderRowType(i)===fc.COLUMN_GROUP){var s=n;if(s.isPadding()&&this.isAnyChildSpanningHeaderHeight(s)){var a=this.getColumnVisibleChild(s,i,e),l=a.nextFocusColumn,u=a.nextRow;l&&(n=l,i=u)}}return{column:n,headerRowIndex:i}}},e.prototype.isAnyChildSpanningHeaderHeight=function(t){return!!t&&t.getLeafColumns().some((function(t){return t.isSpanHeaderHeight()}))},e.prototype.getColumnVisibleParent=function(t,e){var n=this.getHeaderRowType(e),r=n===fc.FLOATING_FILTER,o=n===fc.COLUMN,i=r?t:t.getParent(),s=e-1;if(o&&this.isAnyChildSpanningHeaderHeight(t.getParent())){for(;i&&i.isPadding();)i=i.getParent(),s--;s<0&&(i=t,s=e)}return{nextFocusColumn:i,nextRow:s}},e.prototype.getColumnVisibleChild=function(t,e,n){void 0===n&&(n="After");var r=t,o=e+1;if(this.getHeaderRowType(e)===fc.COLUMN_GROUP){var i=t.getLeafColumns(),s="After"===n?i[0]:yt(i);if(this.isAnyChildSpanningHeaderHeight(s.getParent())){r=s;for(var a=s.getParent();a&&a!==t;)a=a.getParent(),o++}else r=t.getDisplayedChildren()[0]}return{nextFocusColumn:r,nextRow:o}},e.prototype.getHeaderRowType=function(t){var e=this.ctrlsService.getHeaderRowContainerCtrl();if(e)return e.getRowType(t)},e.prototype.findColAtEdgeForHeaderRow=function(t,e){var n=this.columnModel.getAllDisplayedColumns(),r=n["start"===e?0:n.length-1];if(r){var o=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()).getRowType(t);return o==fc.COLUMN_GROUP?{headerRowIndex:t,column:this.columnModel.getColumnGroupAtLevel(r,t)}:{headerRowIndex:null==o?-1:t,column:r}}},Xg([$("columnModel")],e.prototype,"columnModel",void 0),Xg([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=Xg([J("headerPositionUtils")],e)}(jt),Yg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zg=function(){function t(){}return t.prototype.buildColumnDefs=function(t,e,n){var r=this,o=[],i={};return t.forEach((function(t){for(var s=!0,a=r.createDefFromColumn(t,e,n),l=t.getOriginalParent(),u=null;l;){var c=null;if(l.isPadding())l=l.getOriginalParent();else{var p=i[l.getGroupId()];if(p){p.children.push(a),s=!1;break}if((c=r.createDefFromGroup(l))&&(c.children=[a],i[c.groupId]=c,a=c,l=l.getOriginalParent()),null!=l&&u===l){s=!1;break}u=l}}s&&o.push(a)})),o},t.prototype.createDefFromGroup=function(t){var e=y(t.getColGroupDef(),["children"]);return e&&(e.groupId=t.getGroupId()),e},t.prototype.createDefFromColumn=function(t,e,n){var r=y(t.getColDef());return r.colId=t.getColId(),r.width=t.getActualWidth(),r.rowGroup=t.isRowGroupActive(),r.rowGroupIndex=t.isRowGroupActive()?e.indexOf(t):null,r.pivot=t.isPivotActive(),r.pivotIndex=t.isPivotActive()?n.indexOf(t):null,r.aggFunc=t.isValueActive()?t.getAggFunc():null,r.hide=!t.isVisible()||void 0,r.pinned=t.isPinned()?t.getPinned():null,r.sort=t.getSort()?t.getSort():null,r.sortIndex=null!=t.getSortIndex()?t.getSortIndex():null,r},t=Yg([J("columnDefFactory")],t)}(),Qg=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Jg=function(){function t(){}return t.prototype.getInitialRowClasses=function(t){var e=[];return o(t.extraCssClass)&&e.push(t.extraCssClass),e.push("ag-row"),e.push(t.rowFocused?"ag-row-focus":"ag-row-no-focus"),t.fadeRowIn&&e.push("ag-opacity-zero"),e.push(t.rowIsEven?"ag-row-even":"ag-row-odd"),t.rowNode.isRowPinned()&&e.push("ag-row-pinned"),t.rowNode.isSelected()&&e.push("ag-row-selected"),t.rowNode.footer&&e.push("ag-row-footer"),e.push("ag-row-level-"+t.rowLevel),t.rowNode.stub&&e.push("ag-row-loading"),t.fullWidthRow&&e.push("ag-full-width-row"),t.expandable&&(e.push("ag-row-group"),e.push(t.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),t.rowNode.dragging&&e.push("ag-row-dragging"),Pt(e,this.processClassesFromGridOptions(t.rowNode)),Pt(e,this.preProcessRowClassRules(t.rowNode)),e.push(t.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),t.firstRowOnPage&&e.push("ag-row-first"),t.lastRowOnPage&&e.push("ag-row-last"),t.fullWidthRow&&("left"===t.pinned&&e.push("ag-cell-last-left-pinned"),"right"===t.pinned&&e.push("ag-cell-first-right-pinned")),e},t.prototype.processClassesFromGridOptions=function(t){var e=[],n=function(t){"string"===typeof t?e.push(t):Array.isArray(t)&&t.forEach((function(t){return e.push(t)}))},r=this.gridOptionsService.get("rowClass");if(r){if("function"===typeof r)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];n(r)}var o=this.gridOptionsService.getCallback("getRowClass");o&&n(o({data:t.data,node:t,rowIndex:t.rowIndex}));return e},t.prototype.preProcessRowClassRules=function(t){var e=[];return this.processRowClassRules(t,(function(t){e.push(t)}),(function(t){})),e},t.prototype.processRowClassRules=function(t,e,n){var r={data:t.data,node:t,rowIndex:t.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),r,e,n)},t.prototype.calculateRowLevel=function(t){return t.group?t.level:t.parent?t.parent.level+1:0},Qg([$("stylingService")],t.prototype,"stylingService",void 0),Qg([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),t=Qg([J("rowCssClassCalculator")],t)}(),$g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},em=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $g(e,t),e.prototype.init=function(){var t=this;this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",(function(e){return t.isAccentedSort=e.currentValue})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return t.primaryColumnsSortGroups=t.gridOptionsService.isColumnsSortingCoupledToGroup()}))},e.prototype.doFullSort=function(t,e){var n=t.map((function(t,e){return{currentPos:e,rowNode:t}}));return n.sort(this.compareRowNodes.bind(this,e)),n.map((function(t){return t.rowNode}))},e.prototype.compareRowNodes=function(t,e,n){for(var r=e.rowNode,o=n.rowNode,i=0,s=t.length;i<s;i++){var a=t[i],l="desc"===a.sort,u=this.getValue(r,a.column),c=this.getValue(o,a.column),p=void 0,h=this.getComparator(a,r);if(p=h?h(u,c,r,o,l):uo.defaultComparator(u,c,this.isAccentedSort),!isNaN(p)&&0!==p)return"asc"===a.sort?p:-1*p}return e.currentPos-n.currentPos},e.prototype.getComparator=function(t,e){var n=t.column,r=n.getColDef().comparator;if(null!=r)return r;if(n.getColDef().showRowGroup){var o=!e.group&&n.getColDef().field;if(o){var i=this.columnModel.getPrimaryColumn(o);if(i)return i.getColDef().comparator}}},e.prototype.getValue=function(t,e){var n,r;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(e,t,!1,!1);if(t.rowGroupColumn===e){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(e.getColDef().keyCreator)return t.key;var o=null===(n=t.allLeafChildren)||void 0===n?void 0:n[0];return o?this.valueService.getValue(e,o,!1,!1):void 0}var i=this.columnModel.getGroupDisplayColumnForGroup(e.getId());if(!i)return;return null===(r=t.groupData)||void 0===r?void 0:r[i.getId()]}return t.group&&e.getColDef().showRowGroup?void 0:this.valueService.getValue(e,t,!1,!1)},tm([$("valueService")],e.prototype,"valueService",void 0),tm([$("columnModel")],e.prototype,"columnModel",void 0),tm([Z],e.prototype,"init",null),e=tm([J("rowNodeSorter")],e)}(jt),nm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},om=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ready=!1,e.readyCallbacks=[],e}var n;return nm(e,t),n=e,e.prototype.checkReady=function(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){var t=this.createReadyParams();this.readyCallbacks.forEach((function(e){return e(t)})),this.readyCallbacks.length=0}},e.prototype.whenReady=function(t){this.ready?t(this.createReadyParams()):this.readyCallbacks.push(t)},e.prototype.createReadyParams=function(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}},e.prototype.registerFakeHScrollComp=function(t){this.fakeHScrollComp=t,this.checkReady()},e.prototype.registerFakeVScrollComp=function(t){this.fakeVScrollComp=t,this.checkReady()},e.prototype.registerGridHeaderCtrl=function(t){this.gridHeaderCtrl=t,this.checkReady()},e.prototype.registerCenterRowContainerCtrl=function(t){this.centerRowContainerCtrl=t,this.checkReady()},e.prototype.registerLeftRowContainerCtrl=function(t){this.leftRowContainerCtrl=t,this.checkReady()},e.prototype.registerRightRowContainerCtrl=function(t){this.rightRowContainerCtrl=t,this.checkReady()},e.prototype.registerTopCenterRowContainerCtrl=function(t){this.topCenterRowContainerCtrl=t,this.checkReady()},e.prototype.registerTopLeftRowContainerCon=function(t){this.topLeftRowContainerCtrl=t,this.checkReady()},e.prototype.registerTopRightRowContainerCtrl=function(t){this.topRightRowContainerCtrl=t,this.checkReady()},e.prototype.registerStickyTopCenterRowContainerCtrl=function(t){this.stickyTopCenterRowContainerCtrl=t,this.checkReady()},e.prototype.registerStickyTopLeftRowContainerCon=function(t){this.stickyTopLeftRowContainerCtrl=t,this.checkReady()},e.prototype.registerStickyTopRightRowContainerCtrl=function(t){this.stickyTopRightRowContainerCtrl=t,this.checkReady()},e.prototype.registerBottomCenterRowContainerCtrl=function(t){this.bottomCenterRowContainerCtrl=t,this.checkReady()},e.prototype.registerBottomLeftRowContainerCtrl=function(t){this.bottomLeftRowContainerCtrl=t,this.checkReady()},e.prototype.registerBottomRightRowContainerCtrl=function(t){this.bottomRightRowContainerCtrl=t,this.checkReady()},e.prototype.registerHeaderContainer=function(t,e){switch(e){case"left":this.leftHeaderRowContainerCtrl=t;break;case"right":this.rightHeaderRowContainerCtrl=t;break;default:this.centerHeaderRowContainerCtrl=t}this.checkReady()},e.prototype.registerGridBodyCtrl=function(t){this.gridBodyCtrl=t,this.checkReady()},e.prototype.registerGridCtrl=function(t){this.gridCtrl=t,this.checkReady()},e.prototype.getFakeHScrollComp=function(){return this.fakeHScrollComp},e.prototype.getFakeVScrollComp=function(){return this.fakeVScrollComp},e.prototype.getGridHeaderCtrl=function(){return this.gridHeaderCtrl},e.prototype.getGridCtrl=function(){return this.gridCtrl},e.prototype.getCenterRowContainerCtrl=function(){return this.centerRowContainerCtrl},e.prototype.getTopCenterRowContainerCtrl=function(){return this.topCenterRowContainerCtrl},e.prototype.getBottomCenterRowContainerCtrl=function(){return this.bottomCenterRowContainerCtrl},e.prototype.getStickyTopCenterRowContainerCtrl=function(){return this.stickyTopCenterRowContainerCtrl},e.prototype.getGridBodyCtrl=function(){return this.gridBodyCtrl},e.prototype.getHeaderRowContainerCtrls=function(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]},e.prototype.getHeaderRowContainerCtrl=function(t){switch(t){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}},e.NAME="ctrlsService",e=n=rm([J(n.NAME)],e)}(jt),im=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},am=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registry={},e}return im(e,t),e.prototype.register=function(t){this.registry[t.controllerName]=t.controllerClass},e.prototype.getInstance=function(t){var e=this.registry[t];if(null!=e)return new e},e=sm([J("ctrlsFactory")],e)}(jt),lm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),um=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},cm=function(t){function e(e,n){var r=t.call(this,e)||this;return r.direction=n,r.hideTimeout=null,r}return lm(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Yt.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",kn()||Gn())},e.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=qn(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))},e.prototype.addActiveListenerToggles=function(){var t=this,e=this.getGui();["mouseenter","mousedown","touchstart"].forEach((function(n){return t.addManagedListener(e,n,(function(){return t.addOrRemoveCssClass("ag-scrollbar-active",!0)}))})),["mouseleave","touchend"].forEach((function(n){return t.addManagedListener(e,n,(function(){return t.addOrRemoveCssClass("ag-scrollbar-active",!1)}))}))},e.prototype.onScrollVisibilityChanged=function(){var t=this;void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame((function(){return t.setScrollVisible()}))},e.prototype.hideAndShowInvisibleScrollAsNeeded=function(){var t=this;this.addManagedListener(this.eventService,Yt.EVENT_BODY_SCROLL,(function(e){e.direction===t.direction&&(null!==t.hideTimeout&&(window.clearTimeout(t.hideTimeout),t.hideTimeout=null),t.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))})),this.addManagedListener(this.eventService,Yt.EVENT_BODY_SCROLL_END,(function(){t.hideTimeout=window.setTimeout((function(){t.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),t.hideTimeout=null}),400)}))},e.prototype.attemptSettingScrollPosition=function(t){var e=this,n=this.getViewport();B((function(){return Er(n)}),(function(){return e.setScrollPosition(t)}),100)},e.prototype.getViewport=function(){return this.eViewport},e.prototype.getContainer=function(){return this.eContainer},e.prototype.onScrollCallback=function(t){this.addManagedListener(this.getViewport(),"scroll",t)},um([To("eViewport")],e.prototype,"eViewport",void 0),um([To("eContainer")],e.prototype,"eContainer",void 0),um([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),um([$("ctrlsService")],e.prototype,"ctrlsService",void 0),um([$("animationFrameService")],e.prototype,"animationFrameService",void 0),e}(Eo),pm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},dm=function(t){function e(){return t.call(this,e.TEMPLATE,"horizontal")||this}return pm(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this);var n=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,n),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,n),this.addManagedListener(this.eventService,Yt.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",n),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new Lu((function(t){return e.eContainer.style.width=t+"px"})))},e.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),t.prototype.initialiseInvisibleScrollbar.call(this),this.invisibleScrollbar&&this.refreshCompBottom())},e.prototype.onPinnedRowDataChanged=function(){this.refreshCompBottom()},e.prototype.refreshCompBottom=function(){if(this.invisibleScrollbar){var t=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=t+"px"}},e.prototype.onScrollVisibilityChanged=function(){t.prototype.onScrollVisibilityChanged.call(this),this.setFakeHScrollSpacerWidths()},e.prototype.setFakeHScrollSpacerWidths=function(){var t=this.scrollVisibleService.isVerticalScrollShowing(),e=this.columnModel.getDisplayedColumnsRightWidth(),n=!this.enableRtl&&t,r=this.gridOptionsService.getScrollbarWidth();n&&(e+=r),Nr(this.eRightSpacer,e),this.eRightSpacer.classList.toggle("ag-scroller-corner",e<=r);var o=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&t&&(o+=r),Nr(this.eLeftSpacer,o),this.eLeftSpacer.classList.toggle("ag-scroller-corner",o<=r)},e.prototype.setScrollVisible=function(){var t=this.scrollVisibleService.isHorizontalScrollShowing(),e=this.invisibleScrollbar,n=this.gridOptionsService.is("suppressHorizontalScroll"),r=t&&this.gridOptionsService.getScrollbarWidth()||0,o=n?0:0===r&&e?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",e),Fr(this.getGui(),o),Fr(this.eViewport,o),Fr(this.eContainer,o),this.setDisplayed(t,{skipAriaHidden:!0})},e.prototype.getScrollPosition=function(){return wr(this.getViewport(),this.enableRtl)},e.prototype.setScrollPosition=function(t){Er(this.getViewport())||this.attemptSettingScrollPosition(t),Cr(this.getViewport(),t,this.enableRtl)},e.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',hm([To("eLeftSpacer")],e.prototype,"eLeftSpacer",void 0),hm([To("eRightSpacer")],e.prototype,"eRightSpacer",void 0),hm([$("columnModel")],e.prototype,"columnModel",void 0),hm([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),hm([Z],e.prototype,"postConstruct",null),e}(cm),fm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},mm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fm(e,t),e.prototype.postConstruct=function(){var t=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedPropertyListener("domLayout",t)},e.prototype.checkContainerWidths=function(){var t=this.gridOptionsService.isDomLayout("print"),e=t?0:this.columnModel.getDisplayedColumnsLeftWidth(),n=t?0:this.columnModel.getDisplayedColumnsRightWidth();e!=this.leftWidth&&(this.leftWidth=e,this.eventService.dispatchEvent({type:Yt.EVENT_LEFT_PINNED_WIDTH_CHANGED})),n!=this.rightWidth&&(this.rightWidth=n,this.eventService.dispatchEvent({type:Yt.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))},e.prototype.getPinnedRightWidth=function(){return this.rightWidth},e.prototype.getPinnedLeftWidth=function(){return this.leftWidth},gm([$("columnModel")],e.prototype,"columnModel",void 0),gm([Z],e.prototype,"postConstruct",null),e=gm([J("pinnedWidthService")],e)}(jt),ym=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events=[],e}return ym(e,t),e.prototype.postConstruct=function(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},e.prototype.dispatchExpanded=function(t){var e=this;if(null!=this.clientSideRowModel){this.events.push(t);null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce((function(){e.clientSideRowModel&&e.clientSideRowModel.onRowGroupOpened(),e.events.forEach((function(t){return e.eventService.dispatchEvent(t)})),e.events=[]}))),this.dispatchExpandedDebounced()}else this.eventService.dispatchEvent(t)},vm([$("animationFrameService")],e.prototype,"animationFrameService",void 0),vm([$("rowModel")],e.prototype,"rowModel",void 0),vm([Z],e.prototype,"postConstruct",null),e=vm([J("rowNodeEventThrottle")],e)}(jt),wm=function(){return(wm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Cm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},bm=function(t,e){return function(n,r){e(n,r,t)}},xm=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Em=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};function Sm(t){return!0===t||"true"===t}var Tm,Rm=function(){function t(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new st}return Object.defineProperty(t.prototype,"context",{get:function(){return this.gridOptions.context},enumerable:!1,configurable:!0}),t.prototype.agWire=function(t,e){this.gridOptions.api=t,this.gridOptions.columnApi=e,this.api=t,this.columnApi=e},t.prototype.init=function(){this.gridOptionLookup=new Set(Em(Em([],xm(me.ALL_PROPERTIES)),xm(me.EVENT_CALLBACKS)));var t=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),t),this.getScrollbarWidth()},t.prototype.destroy=function(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0},t.prototype.is=function(t){return Sm(this.gridOptions[t])},t.prototype.get=function(t){return this.gridOptions[t]},t.prototype.getNum=function(t){return"number"==typeof(e=this.gridOptions[t])?e:"string"==typeof e?parseInt(e,10):void 0;var e},t.prototype.getCallback=function(t){return this.mergeGridCommonParams(this.gridOptions[t])},t.prototype.exists=function(t){return o(this.gridOptions[t])},t.prototype.mergeGridCommonParams=function(t){var e=this;if(t){return function(n){var r=n;return r.api=e.api,r.columnApi=e.columnApi,r.context=e.context,t(r)}}return t},t.prototype.set=function(t,e,n,r){if(void 0===n&&(n=!1),void 0===r&&(r={}),this.gridOptionLookup.has(t)){var o=this.gridOptions[t];if(n||o!==e){this.gridOptions[t]=e;var i=wm({type:t,currentValue:e,previousValue:o},r);this.propertyEventService.dispatchEvent(i)}}},t.prototype.addEventListener=function(t,e){this.propertyEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.propertyEventService.removeEventListener(t,e)},t.prototype.globalEventHandler=function(t,e){if(!this.destroyed){var n=me.getCallbackForEvent(t);"function"===typeof this.gridOptions[n]&&this.gridOptions[n](e)}},t.prototype.getGridId=function(){return this.api.getGridId()},t.prototype.getScrollbarWidth=function(){if(null==this.scrollbarWidth){var t="number"===typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:Un();null!=t&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:Yt.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth},t.prototype.isRowModelType=function(t){return this.gridOptions.rowModelType===t||"clientSide"===t&&i(this.gridOptions.rowModelType)},t.prototype.isDomLayout=function(t){var e;return(null!==(e=this.gridOptions.domLayout)&&void 0!==e?e:"normal")===t},t.prototype.isRowSelection=function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection},t.prototype.useAsyncEvents=function(){return!this.is("suppressAsyncEvents")},t.prototype.isGetRowHeightFunction=function(){return"function"===typeof this.gridOptions.getRowHeight},t.prototype.getRowHeightForNode=function(t,e,n){if(void 0===e&&(e=!1),null==n&&(n=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(e)return{height:n,estimated:!0};var r={node:t,data:t.data},o=this.getCallback("getRowHeight")(r);if(this.isNumeric(o))return 0===o&&O((function(){return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.")}),"invalidRowHeight"),{height:Math.max(1,o),estimated:!1}}return t.detail&&this.is("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:n,estimated:!1}},t.prototype.getMasterDetailRowHeight=function(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}},t.prototype.getRowHeightAsNumber=function(){if(!this.gridOptions.rowHeight||i(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();var t=this.gridOptions.rowHeight;return t&&this.isNumeric(t)?(this.environment.setRowHeightVariable(t),t):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())},t.prototype.isNumeric=function(t){return!isNaN(t)&&"number"===typeof t&&isFinite(t)},t.prototype.getDomDataKey=function(){return this.domDataKey},t.prototype.getDomData=function(t,e){var n=t[this.getDomDataKey()];return n?n[e]:void 0},t.prototype.setDomData=function(t,e,n){var r=this.getDomDataKey(),o=t[r];i(o)&&(o={},t[r]=o),o[e]=n},t.prototype.getDocument=function(){var t=null;return this.gridOptions.getDocument&&o(this.gridOptions.getDocument)?t=this.gridOptions.getDocument():this.eGridDiv&&(t=this.eGridDiv.ownerDocument),t&&o(t)?t:document},t.prototype.getWindow=function(){return this.getDocument().defaultView||window},t.prototype.getRootNode=function(){return this.eGridDiv.getRootNode()},t.prototype.getAsyncTransactionWaitMillis=function(){return o(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50},t.prototype.isAnimateRows=function(){return!this.is("ensureDomOrder")&&this.is("animateRows")},t.prototype.isGroupRowsSticky=function(){return!(this.is("suppressGroupRowsSticky")||this.is("paginateChildRows")||this.is("groupHideOpenParents"))},t.prototype.isTreeData=function(){return this.is("treeData")&&W.__assertRegistered(z.RowGroupingModule,"Tree Data",this.api.getGridId())},t.prototype.isMasterDetail=function(){return this.is("masterDetail")&&W.__assertRegistered(z.MasterDetailModule,"masterDetail",this.api.getGridId())},t.prototype.isEnableRangeSelection=function(){return this.is("enableRangeSelection")&&W.__isRegistered(z.RangeSelectionModule,this.api.getGridId())},t.prototype.isColumnsSortingCoupledToGroup=function(){var t=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!(null===t||void 0===t?void 0:t.comparator)&&!this.isTreeData()},t.prototype.getGroupAggFiltering=function(){var t=this.gridOptions.groupAggFiltering;return"function"===typeof t?this.getCallback("groupAggFiltering"):Sm(t)?function(){return!0}:void 0},t.prototype.isGroupMultiAutoColumn=function(){return this.gridOptions.groupDisplayType?Re("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")},t.prototype.isGroupUseEntireRow=function(t){return!t&&(!!this.gridOptions.groupDisplayType&&Re("groupRows",this.gridOptions.groupDisplayType))},Cm([$("gridOptions")],t.prototype,"gridOptions",void 0),Cm([$("eventService")],t.prototype,"eventService",void 0),Cm([$("environment")],t.prototype,"environment",void 0),Cm([$("eGridDiv")],t.prototype,"eGridDiv",void 0),Cm([bm(0,nt("gridApi")),bm(1,nt("columnApi"))],t.prototype,"agWire",null),Cm([Z],t.prototype,"init",null),Cm([Q],t.prototype,"destroy",null),t=Cm([J("gridOptionsService")],t)}(),Pm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Om=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Im=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pm(e,t),e.prototype.getLocaleTextFunc=function(){var t=this.gridOptionsService.getCallback("getLocaleText");if(t)return function(e,n,r){return t({key:e,defaultValue:n,variableValues:r})};var e=this.gridOptionsService.get("localeText");return function(t,n,r){var o=e&&e[t];if(o&&r&&r.length)for(var i=0;!(i>=r.length);){if(-1===o.indexOf("${variable}"))break;o=o.replace("${variable}",r[i++])}return null!==o&&void 0!==o?o:n}},e=Om([J("localeService")],e)}(jt),Am=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Mm=function(t){function e(){return t.call(this,e.TEMPLATE,"vertical")||this}return Am(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.createManagedBean(new Pu(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this),this.addManagedListener(this.eventService,Yt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))},e.prototype.setScrollVisible=function(){var t=this.scrollVisibleService.isVerticalScrollShowing(),e=this.invisibleScrollbar,n=t&&this.gridOptionsService.getScrollbarWidth()||0,r=0===n&&e?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",e),Nr(this.getGui(),r),Nr(this.eViewport,r),Nr(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})},e.prototype.onRowContainerHeightChanged=function(){var t=this.ctrlsService.getGridBodyCtrl().getBodyViewportElement();this.eViewport.scrollTop!=t.scrollTop&&(this.eViewport.scrollTop=t.scrollTop)},e.prototype.getScrollPosition=function(){return this.getViewport().scrollTop},e.prototype.setScrollPosition=function(t){Er(this.getViewport())||this.attemptSettingScrollPosition(t),this.getViewport().scrollTop=t},e.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',Dm([Z],e.prototype,"postConstruct",null),e}(cm),Lm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nm=function(){return(Nm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Fm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},km=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Gm=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Bm={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},Vm=["january","february","march","april","may","june","july","august","september","october","november","december"],zm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataTypeDefinitions={},e.isWaitingForRowData=!1,e.isColumnTypeOverrideInDataTypeDefinitions=!1,e.columnStateUpdatesPendingInference={},e.columnStateUpdateListenerDestroyFuncs=[],e}return Lm(e,t),e.prototype.init=function(){var t=this;this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",(function(){t.groupHideOpenParents=t.gridOptionsService.is("groupHideOpenParents")})),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",(function(){t.processDataTypeDefinitions(),t.columnModel.recreateColumnDefs("gridOptionsChanged")}))},e.prototype.processDataTypeDefinitions=function(){var t,e=this,n=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(n).forEach((function(t){var n=km(t,2),r=n[0],o=n[1];e.dataTypeDefinitions[r]=Nm(Nm({},o),{groupSafeValueFormatter:e.createGroupSafeValueFormatter(o)})}));var r=null!==(t=this.gridOptionsService.get("dataTypeDefinitions"))&&void 0!==t?t:{};this.dataTypeMatchers={},Object.entries(r).forEach((function(t){var o=km(t,2),i=o[0],s=o[1],a=e.processDataTypeDefinition(s,r,[i],n);a&&(e.dataTypeDefinitions[i]=a,s.dataTypeMatcher&&(e.dataTypeMatchers[i]=s.dataTypeMatcher))})),this.checkObjectValueHandlers(n),["dateString","text","number","boolean","date"].forEach((function(t){var r=e.dataTypeMatchers[t];r&&delete e.dataTypeMatchers[t],e.dataTypeMatchers[t]=null!==r&&void 0!==r?r:n[t].dataTypeMatcher}))},e.prototype.mergeDataTypeDefinitions=function(t,e){var n=Nm(Nm({},t),e);return t.columnTypes&&e.columnTypes&&e.appendColumnTypes&&(n.columnTypes=Gm(Gm([],km(this.convertColumnTypes(t.columnTypes))),km(this.convertColumnTypes(e.columnTypes)))),n},e.prototype.processDataTypeDefinition=function(t,e,n,r){var o,i=t.extendsDataType;if(t.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),t.extendsDataType===t.baseDataType){var s=r[i];if(!this.validateDataTypeDefinition(t,s,i))return;o=this.mergeDataTypeDefinitions(s,t)}else{if(n.includes(i))return void O((function(){return console.warn('AG Grid: Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.')}),"dataTypeExtendsCircularRef");var a=e[i];if(!this.validateDataTypeDefinition(t,a,i))return;var l=this.processDataTypeDefinition(a,e,Gm(Gm([],km(n)),[i]),r);if(!l)return;o=this.mergeDataTypeDefinitions(l,t)}return Nm(Nm({},o),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(o)})},e.prototype.validateDataTypeDefinition=function(t,e,n){return e?e.baseDataType===t.baseDataType||(O((function(){return console.warn('AG Grid: The "baseDataType" property of a data type definition must match that of its parent.')}),"dataTypeBaseTypesMatch"),!1):(O((function(){return console.warn("AG Grid: The data type definition "+n+" does not exist.")}),"dataTypeDefMissing"+n),!1)},e.prototype.createGroupSafeValueFormatter=function(t){var e=this;if(t.valueFormatter)return function(n){var r,o;if(!(null===(r=n.node)||void 0===r?void 0:r.group))return e.groupHideOpenParents&&n.column.isRowGroupActive()?"string"!==typeof n.value||(null===(o=t.dataTypeMatcher)||void 0===o?void 0:o.call(t,n.value))?t.valueFormatter(n):void 0:t.valueFormatter(n);var i=n.column.getAggFunc();if(i){if("first"===i||"last"===i)return t.valueFormatter(n);if("number"===t.baseDataType&&"count"!==i){if("number"===typeof n.value)return t.valueFormatter(n);if("object"===typeof n.value){if(!n.value)return;if("toNumber"in n.value)return t.valueFormatter(Nm(Nm({},n),{value:n.value.toNumber()}));if("value"in n.value)return t.valueFormatter(Nm(Nm({},n),{value:n.value.value}))}}}}},e.prototype.updateColDefAndGetDataTypeDefinitionColumnType=function(t,e,n){var r=e.cellDataType,o=e.field;if(void 0===r&&(r=t.cellDataType),null!=r&&!0!==r||(r=!!this.canInferCellDataType(t,e)&&this.inferCellDataType(o,n)),r){var i=this.dataTypeDefinitions[r];if(i)return t.cellDataType=r,i.groupSafeValueFormatter&&(t.valueFormatter=i.groupSafeValueFormatter),i.valueParser&&(t.valueParser=i.valueParser),i.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(t,i,n),i.columnTypes;O((function(){return console.warn('AG Grid: Missing data type definition - "'+r+'"')}),"dataTypeMissing"+r)}else t.cellDataType=!1},e.prototype.updateColDefAndGetColumnType=function(t,e,n){var r,o,i=this.updateColDefAndGetDataTypeDefinitionColumnType(t,e,n),s=null!==(o=null!==(r=e.type)&&void 0!==r?r:i)&&void 0!==o?o:t.type;return t.type=s,s?this.convertColumnTypes(s):void 0},e.prototype.addColumnListeners=function(t){if(this.isWaitingForRowData){var e=this.columnStateUpdatesPendingInference[t.getColId()];if(e){var n=function(t){e.add(t.key)};t.addEventListener(ht.EVENT_STATE_UPDATED,n),this.columnStateUpdateListenerDestroyFuncs.push((function(){return t.removeEventListener(ht.EVENT_STATE_UPDATED,n)}))}}},e.prototype.canInferCellDataType=function(t,e){var n,r=this;if("clientSide"!==this.rowModel.getType())return!1;var o={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(e,o))return!1;var i=null===e.type?t.type:e.type;if(i){var s=null!==(n=this.gridOptionsService.get("columnTypes"))&&void 0!==n?n:{};if(this.convertColumnTypes(i).some((function(t){var e=s[t.trim()];return e&&r.doColDefPropsPreventInference(e,o)})))return!1}return!this.doColDefPropsPreventInference(t,o)},e.prototype.doColDefPropsPreventInference=function(t,e){var n=this;return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some((function(r){var o=km(r,2),i=o[0],s=o[1];return n.doesColDefPropPreventInference(t,e,i,s)}))},e.prototype.doesColDefPropPreventInference=function(t,e,n,r){if(!e[n])return!1;var o=t[n];return null===o?(e[n]=!1,!1):void 0===r?!!o:o===r},e.prototype.inferCellDataType=function(t,e){var n;if(t){var r,o=this.getInitialData();if(o){var i=t.indexOf(".")>=0&&!this.gridOptionsService.is("suppressFieldDotNotation");r=E(o,t,i)}else this.initWaitForRowData(e);if(null!=r)return km(null!==(n=Object.entries(this.dataTypeMatchers).find((function(t){var e=km(t,2);return e[0],(0,e[1])(r)})))&&void 0!==n?n:["object"],1)[0]}},e.prototype.getInitialData=function(){var t=this.gridOptionsService.get("rowData");if(null===t||void 0===t?void 0:t.length)return t[0];if(this.initialData)return this.initialData;var e=this.rowModel.getRootNode().allLeafChildren;return(null===e||void 0===e?void 0:e.length)?e[0].data:null},e.prototype.initWaitForRowData=function(t){var e=this;if(this.columnStateUpdatesPendingInference[t]=new Set,!this.isWaitingForRowData){this.isWaitingForRowData=!0;var n=this.isColumnTypeOverrideInDataTypeDefinitions;n&&this.columnModel.queueResizeOperations();var r=this.addManagedListener(this.eventService,Yt.EVENT_ROW_DATA_UPDATE_STARTED,(function(t){var o=t.firstRowData;if(o){null===r||void 0===r||r(),e.isWaitingForRowData=!1,e.processColumnsPendingInference(o,n),e.columnStateUpdatesPendingInference={},n&&e.columnModel.processResizeOperations();var i={type:Yt.EVENT_DATA_TYPES_INFERRED};e.eventService.dispatchEvent(i)}}))}},e.prototype.isPendingInference=function(){return this.isWaitingForRowData},e.prototype.processColumnsPendingInference=function(t,e){var n=this;this.initialData=t;var r=[];this.columnStateUpdateListenerDestroyFuncs.forEach((function(t){return t()})),this.columnStateUpdateListenerDestroyFuncs=[];var o={},i={};Object.entries(this.columnStateUpdatesPendingInference).forEach((function(t){var s=km(t,2),a=s[0],l=s[1],u=n.columnModel.getGridColumn(a);if(u){var c=u.getColDef();if(n.columnModel.resetColumnDefIntoColumn(u)){var p=u.getColDef();if(e&&p.type&&p.type!==c.type){var h=n.getUpdatedColumnState(u,l);h.rowGroup&&null==h.rowGroupIndex&&(o[a]=h),h.pivot&&null==h.pivotIndex&&(i[a]=h),r.push(h)}}}})),e&&r.push.apply(r,Gm([],km(this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(o,i)))),r.length&&this.columnModel.applyColumnState({state:r},"cellDataTypeInferred"),this.initialData=null},e.prototype.getUpdatedColumnState=function(t,e){var n=this.columnModel.getColumnStateFromColDef(t);return e.forEach((function(t){delete n[t],"rowGroup"===t?delete n.rowGroupIndex:"pivot"===t&&delete n.pivotIndex})),n},e.prototype.checkObjectValueHandlers=function(t){var e=this.dataTypeDefinitions.object,n=t.object;this.hasObjectValueParser=e.valueParser!==n.valueParser,this.hasObjectValueFormatter=e.valueFormatter!==n.valueFormatter},e.prototype.convertColumnTypes=function(t){var e=[];t instanceof Array?t.some((function(t){return"string"!==typeof t}))?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):e=t:"string"===typeof t?e=t.split(","):console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");return e},e.prototype.getDateStringTypeDefinition=function(){return this.dataTypeDefinitions.dateString},e.prototype.getDateParserFunction=function(){return this.getDateStringTypeDefinition().dateParser},e.prototype.getDateFormatterFunction=function(){return this.getDateStringTypeDefinition().dateFormatter},e.prototype.getDataTypeDefinition=function(t){var e=t.getColDef();if(e.cellDataType)return this.dataTypeDefinitions[e.cellDataType]},e.prototype.getBaseDataType=function(t){var e;return null===(e=this.getDataTypeDefinition(t))||void 0===e?void 0:e.baseDataType},e.prototype.checkType=function(t,e){var n;if(null==e)return!0;var r=null===(n=this.getDataTypeDefinition(t))||void 0===n?void 0:n.dataTypeMatcher;return!r||r(e)},e.prototype.validateColDef=function(t){"object"===t.cellDataType&&(t.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||O((function(){return console.warn('AG Grid: Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"')}),"dataTypeObjectValueFormatter"),t.editable&&t.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&O((function(){return console.warn('AG Grid: Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"')}),"dataTypeObjectValueParser"))},e.prototype.setColDefPropertiesForBaseDataType=function(t,e,n){var r=this,i=function(t,n,o){var i=t.getColDef().valueFormatter;return i===e.groupSafeValueFormatter&&(i=e.valueFormatter),r.valueFormatterService.formatValue(t,n,o,i)},s=W.__isRegistered(z.SetFilterModule,this.context.getGridId()),a=this.localeService.getLocaleTextFunc(),l=function(e){var n=t.filterParams;t.filterParams="object"===typeof n?Nm(Nm({},n),e):e};switch(t.useValueFormatterForExport=!0,t.useValueParserForImport=!0,e.baseDataType){case"number":t.cellEditor="agNumberCellEditor",s&&l({comparator:function(t,e){var n=null==t?0:parseInt(t),r=null==e?0:parseInt(e);return n===r?0:n>r?1:-1}});break;case"boolean":t.cellEditor="agCheckboxCellEditor",t.cellRenderer="agCheckboxCellRenderer",t.suppressKeyboardEvent=function(t){return!!t.colDef.editable&&t.event.key===Yr.SPACE},l(s?{valueFormatter:function(t){return o(t.value)?a(String(t.value),t.value?"True":"False"):a("blanks","(Blanks)")}}:{maxNumConditions:1,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:function(t,e){return e},numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:function(t,e){return!1===e},numberOfInputs:0}]});break;case"date":t.cellEditor="agDateCellEditor",t.keyCreator=function(t){return i(t.column,t.node,t.value)},s&&l({valueFormatter:function(t){var e=i(t.column,t.node,t.value);return o(e)?e:a("blanks","(Blanks)")},treeList:!0,treeListFormatter:function(t,e){if(1===e&&null!=t){var n=Vm[Number(t)-1];return a(n,Bm[n])}return null!==t&&void 0!==t?t:a("blanks","(Blanks)")}});break;case"dateString":t.cellEditor="agDateStringCellEditor",t.keyCreator=function(t){return i(t.column,t.node,t.value)};var u=this.getDateParserFunction();l(s?{valueFormatter:function(t){var e=i(t.column,t.node,t.value);return o(e)?e:a("blanks","(Blanks)")},treeList:!0,treeListPathGetter:function(t){var e=u(null!==t&&void 0!==t?t:void 0);return e?[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())]:null},treeListFormatter:function(t,e){if(1===e&&null!=t){var n=Vm[Number(t)-1];return a(n,Bm[n])}return null!==t&&void 0!==t?t:a("blanks","(Blanks)")}}:{comparator:function(t,e){var n=u(e);return null==e||n<t?-1:n>t?1:0}});break;case"object":t.cellEditorParams={useFormatter:!0},t.comparator=function(t,e){var o=r.columnModel.getPrimaryColumn(n),s=null===o||void 0===o?void 0:o.getColDef();if(!o||!s)return 0;var a=null==t?"":i(o,null,t),l=null==e?"":i(o,null,e);return a===l?0:a>l?1:-1},t.keyCreator=function(t){return i(t.column,t.node,t.value)},s?l({valueFormatter:function(t){var e=i(t.column,t.node,t.value);return o(e)?e:a("blanks","(Blanks)")}}):t.filterValueGetter=function(t){return i(t.column,t.node,r.valueService.getValue(t.column,t.node))}}},e.prototype.getDefaultDataTypes=function(){var t=function(t){return!!t.match("^\\d{4}-\\d{2}-\\d{2}$")},e=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:function(t){return""===t.newValue?null:Number(t.newValue)},valueFormatter:function(t){return null==t.value?"":"number"!==typeof t.value||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value)},dataTypeMatcher:function(t){return"number"===typeof t}},text:{baseDataType:"text",valueParser:function(t){return""===t.newValue?null:a(t.newValue)},dataTypeMatcher:function(t){return"string"===typeof t}},boolean:{baseDataType:"boolean",valueParser:function(t){return""===t.newValue?null:"true"===String(t.newValue).toLowerCase()},valueFormatter:function(t){return null==t.value?"":String(t.value)},dataTypeMatcher:function(t){return"boolean"===typeof t}},date:{baseDataType:"date",valueParser:function(t){return nr(null==t.newValue?null:String(t.newValue))},valueFormatter:function(t){var n;return null==t.value?"":t.value instanceof Date&&!isNaN(t.value.getTime())?null!==(n=$n(t.value,!1))&&void 0!==n?n:"":e("invalidDate","Invalid Date")},dataTypeMatcher:function(t){return t instanceof Date}},dateString:{baseDataType:"dateString",dateParser:function(t){var e;return null!==(e=nr(t))&&void 0!==e?e:void 0},dateFormatter:function(t){var e;return null!==(e=$n(null!==t&&void 0!==t?t:null,!1))&&void 0!==e?e:void 0},valueParser:function(e){return t(String(e.newValue))?e.newValue:null},valueFormatter:function(e){return t(String(e.value))?e.value:""},dataTypeMatcher:function(e){return"string"===typeof e&&t(e)}},object:{baseDataType:"object",valueParser:function(){return null},valueFormatter:function(t){var e;return null!==(e=a(t.value))&&void 0!==e?e:""}}}},Fm([$("rowModel")],e.prototype,"rowModel",void 0),Fm([$("columnModel")],e.prototype,"columnModel",void 0),Fm([$("columnUtils")],e.prototype,"columnUtils",void 0),Fm([$("valueService")],e.prototype,"valueService",void 0),Fm([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),Fm([Z],e.prototype,"init",null),e=Fm([J("dataTypeService")],e)}(jt),jm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hm=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Um=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jm(e,t),e.prototype.parseValue=function(t,e,n,r){var i=t.getColDef(),s={node:e,data:null===e||void 0===e?void 0:e.data,oldValue:r,newValue:n,colDef:i,column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},a=i.valueParser;return o(a)?"function"===typeof a?a(s):this.expressionService.evaluate(a,s):n},Hm([$("expressionService")],e.prototype,"expressionService",void 0),e=Hm([J("valueParserService")],e)}(jt),Wm=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},qm=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Xm=function(){function t(t,e,n){e?(this.gridOptions=e,(new Ym).create(t,e,(function(e){var n=new kf(t);e.createBean(n)}),void 0,n)):console.error("AG Grid: no gridOptions provided to the grid")}return t.prototype.destroy=function(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()},t}(),Km=1,Ym=function(){function t(){}return t.prototype.create=function(t,e,n,r,o){var i,s=this,a=!!e.debug,l=null!==(i=e.gridId)&&void 0!==i?i:String(Km++),u=this.getRegisteredModules(o,l),c=this.createBeansList(e.rowModelType,u,l),p=this.createProvidedBeans(t,e,o);if(c){var h={providedBeanInstances:p,beanClasses:c,debug:a,gridId:l},d=new Af("AG Grid",(function(){return e.debug})),f=new Af("Context",(function(){return h.debug})),g=new K(h,f),m=g.getBean("beans");this.registerModuleUserComponents(m,u),this.registerStackComponents(m,u),this.registerControllers(m,u),n(g),m.ctrlsService.whenReady((function(){s.setColumnsAndData(m),s.dispatchGridReadyEvent(m);var t=W.__isRegistered(z.EnterpriseCoreModule,l);d.log("initialised successfully, enterprise = "+t)})),r&&r(g)}},t.prototype.registerControllers=function(t,e){e.forEach((function(e){e.controllers&&e.controllers.forEach((function(e){return t.ctrlsFactory.register(e)}))}))},t.prototype.registerStackComponents=function(t,e){var n=this.createAgStackComponentsList(e);t.agStackComponentsRegistry.setupComponents(n)},t.prototype.getRegisteredModules=function(t,e){var n=t?t.modules:null,r=W.__getRegisteredModules(e),o=[],i={},s=function(t,e,n){var r;i[(r=e).moduleName]||(i[r.moduleName]=!0,o.push(r),W.__register(r,t,n)),e.dependantModules&&e.dependantModules.forEach((function(e){return s(t,e,n)}))};return n&&n.forEach((function(t){return s(!0,t,e)})),r&&r.forEach((function(t){return s(!W.__isPackageBased(),t,void 0)})),o},t.prototype.registerModuleUserComponents=function(t,e){this.extractModuleEntity(e,(function(t){return t.userComponents?t.userComponents:[]})).forEach((function(e){t.userComponentRegistry.registerDefaultComponent(e.componentName,e.componentClass)}))},t.prototype.createProvidedBeans=function(t,e,n){var r=n?n.frameworkOverrides:null;i(r)&&(r=new $d);var o={gridOptions:e,eGridDiv:t,globalEventListener:n?n.globalEventListener:null,frameworkOverrides:r};return n&&n.providedBeanInstances&&Object.assign(o,n.providedBeanInstances),o},t.prototype.createAgStackComponentsList=function(t){var e=[{componentName:"AgCheckbox",componentClass:li},{componentName:"AgRadioButton",componentClass:ci},{componentName:"AgToggleButton",componentClass:Wh},{componentName:"AgInputTextField",componentClass:Di},{componentName:"AgInputTextArea",componentClass:Xh},{componentName:"AgInputNumberField",componentClass:Li},{componentName:"AgInputDateField",componentClass:Yh},{componentName:"AgInputRange",componentClass:Qh},{componentName:"AgRichSelect",componentClass:pd},{componentName:"AgSelect",componentClass:ri},{componentName:"AgSlider",componentClass:fd},{componentName:"AgGridBody",componentClass:Xu},{componentName:"AgHeaderRoot",componentClass:Up},{componentName:"AgSortIndicator",componentClass:os},{componentName:"AgPagination",componentClass:Tg},{componentName:"AgOverlayWrapper",componentClass:Og},{componentName:"AgGroupComponent",componentClass:yd},{componentName:"AgPanel",componentClass:Id},{componentName:"AgDialog",componentClass:Ld},{componentName:"AgRowContainer",componentClass:gc},{componentName:"AgFakeHorizontalScroll",componentClass:dm},{componentName:"AgFakeVerticalScroll",componentClass:Mm},{componentName:"AgAutocomplete",componentClass:Zd}],n=this.extractModuleEntity(t,(function(t){return t.agStackComponents?t.agStackComponents:[]}));return e=e.concat(n)},t.prototype.createBeansList=function(t,e,n){void 0===t&&(t="clientSide");var r=e.filter((function(e){return!e.rowModel||e.rowModel===t})),o={clientSide:z.ClientSideRowModelModule,infinite:z.InfiniteRowModelModule,serverSide:z.ServerSideRowModelModule,viewport:z.ViewportRowModelModule};if(o[t]){if(W.__assertRegistered(o[t],"rowModelType = '"+t+"'",n)){var i=[Xl,Dg,Ng,Kg,Qf,sl,Ia,sg,ug,oh,Qa,wg,Xp,Im,Te,Oh,nl,ze,st,Rm,jd,ff,cl,Ne,Gp,Vh,bh,xf,qt,Tf,uf,rc,tg,_f,If,Ge,ch,Zp,zs,mf,pp,$u,mg,of,Th,Hh,Zu,jf,Wf,Kf,xg,te,rg,ah,Wg,Ue,Zg,Jg,kh,em,om,mm,_m,am,zm,Um],s=this.extractModuleEntity(r,(function(t){return t.beans?t.beans:[]}));i.push.apply(i,qm([],Wm(s)));var a=[];return i.forEach((function(t){a.indexOf(t)<0&&a.push(t)})),a}}else console.error("AG Grid: could not find row model for rowModelType = "+t)},t.prototype.extractModuleEntity=function(t,e){return[].concat.apply([],qm([],Wm(t.map(e))))},t.prototype.setColumnsAndData=function(t){var e=t.gridOptionsService.get("columnDefs");t.columnModel.setColumnDefs(e||[],"gridInitializing"),t.rowModel.start()},t.prototype.dispatchGridReadyEvent=function(t){var e={type:Yt.EVENT_GRID_READY};t.eventService.dispatchEvent(e)},t}(),Zm=function(){function t(){}return t.prototype.wrap=function(t,e,n,r){var o=this;void 0===n&&(n=[]);var i=this.createWrapper(t,r);return e.forEach((function(t){o.createMethod(i,t,!0)})),n.forEach((function(t){o.createMethod(i,t,!1)})),i},t.prototype.unwrap=function(t){return t},t.prototype.createMethod=function(t,e,n){t.addMethod(e,this.createMethodProxy(t,e,n))},t.prototype.createMethodProxy=function(t,e,n){return function(){return t.hasMethod(e)?t.callMethod(e,arguments):(n&&console.warn("AG Grid: Framework component is missing the method "+e+"()"),null)}},t}(),Qm={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","doughnut"],lineGroup:["line"],scatterGroup:["scatter","bubble"],areaGroup:["area","stackedArea","normalizedArea"],histogramGroup:["histogram"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},Jm=["chartSettings","chartData","chartFormat"],$m=["chartUnlink","chartLink","chartDownload"],ty={settings:"chartSettings",data:"chartData",format:"chartFormat"},ey=0;!function(t){t.InsideBase="insideBase",t.InsideEnd="insideEnd",t.Center="center",t.OutsideEnd="outsideEnd"}(Tm||(Tm={}));var ny="undefined"===typeof t?{}:t;ny.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,ny.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,ny.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,ny.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,ny.Node="undefined"===typeof Node?{}:Node,ny.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var ry,oy=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},iy=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},sy=function(){function t(e,n,r,o,i,s){this.nextId=0,this.allNodesMap={},this.rootNode=e,this.gridOptionsService=n,this.eventService=r,this.columnModel=o,this.beans=s,this.selectionService=i,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=t.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return t.prototype.postConstruct=function(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()},t.prototype.getCopyOfNodesMap=function(){return uo.cloneObject(this.allNodesMap)},t.prototype.getRowNode=function(t){return this.allNodesMap[t]},t.prototype.setRowData=function(e){var n=this;if("string"!==typeof e){this.dispatchRowDataUpdateStartedEvent(e);var r=this.rootNode,o=this.rootNode.sibling;r.childrenAfterFilter=null,r.childrenAfterGroup=null,r.childrenAfterAggFilter=null,r.childrenAfterSort=null,r.childrenMapped=null,r.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?r.allLeafChildren=e.map((function(e){return n.createNode(e,n.rootNode,t.TOP_LEVEL)})):(r.allLeafChildren=[],r.childrenAfterGroup=[]),o&&(o.childrenAfterFilter=r.childrenAfterFilter,o.childrenAfterGroup=r.childrenAfterGroup,o.childrenAfterAggFilter=r.childrenAfterAggFilter,o.childrenAfterSort=r.childrenAfterSort,o.childrenMapped=r.childrenMapped,o.allLeafChildren=r.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},t.prototype.updateRowData=function(t,e){this.dispatchRowDataUpdateStartedEvent(t.add);var n={remove:[],update:[],add:[]},r=[];return this.executeRemove(t,n,r),this.executeUpdate(t,n,r),this.executeAdd(t,n),this.updateSelection(r,"rowDataChanged"),e&&uo.sortRowNodesByOrder(this.rootNode.allLeafChildren,e),n},t.prototype.dispatchRowDataUpdateStartedEvent=function(t){var e={type:Yt.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:(null===t||void 0===t?void 0:t.length)?t[0]:null};this.eventService.dispatchEvent(e)},t.prototype.updateSelection=function(t,e){var n=t.length>0;if(n&&this.selectionService.setNodesSelected({newValue:!1,nodes:t,suppressFinishActions:!0,source:e}),this.selectionService.updateGroupsFromChildrenSelections(e),n){var r={type:Yt.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(r)}},t.prototype.executeAdd=function(e,n){var r,o=this,i=e.add,s=e.addIndex;if(!uo.missingOrEmpty(i)){var a=i.map((function(e){return o.createNode(e,o.rootNode,t.TOP_LEVEL)}));if("number"===typeof s&&s>=0){var l=this.rootNode.allLeafChildren,u=l.length,c=s;if(this.doingTreeData&&s>0&&u>0)for(var p=0;p<u;p++)if((null===(r=l[p])||void 0===r?void 0:r.rowIndex)==s-1){c=p+1;break}var h=l.slice(0,c),d=l.slice(c,l.length);this.rootNode.allLeafChildren=iy(iy(iy([],oy(h)),oy(a)),oy(d))}else this.rootNode.allLeafChildren=iy(iy([],oy(this.rootNode.allLeafChildren)),oy(a));this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),n.add=a}},t.prototype.executeRemove=function(t,e,n){var r=this,o=t.remove;if(!uo.missingOrEmpty(o)){var i={};o.forEach((function(t){var o=r.lookupRowNode(t);o&&(o.isSelected()&&n.push(o),o.clearRowTopAndRowIndex(),i[o.id]=!0,delete r.allNodesMap[o.id],e.remove.push(o))})),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter((function(t){return!i[t.id]})),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}},t.prototype.executeUpdate=function(e,n,r){var o=this,i=e.update;uo.missingOrEmpty(i)||i.forEach((function(e){var i=o.lookupRowNode(e);i&&(i.updateData(e),!i.selectable&&i.isSelected()&&r.push(i),o.setMasterForRow(i,e,t.TOP_LEVEL,!1),n.update.push(i))}))},t.prototype.lookupRowNode=function(t){var e,n=this.gridOptionsService.getCallback("getRowId");if(n){var r=n({data:t,level:0});if(!(e=this.allNodesMap[r]))return console.error("AG Grid: could not find row id="+r+", data item was not found for this id"),null}else if(!(e=this.rootNode.allLeafChildren.find((function(e){return e.data===t}))))return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return e||null},t.prototype.createNode=function(t,e,n){var r=new Ds(this.beans);return r.group=!1,this.setMasterForRow(r,t,n,!0),e&&!this.suppressParentsInRowNodes&&(r.parent=e),r.level=n,r.setDataAndId(t,this.nextId.toString()),this.allNodesMap[r.id]&&console.warn("AG Grid: duplicate node id '"+r.id+"' detected from getRowId callback, this could cause issues in your grid."),this.allNodesMap[r.id]=r,this.nextId++,r},t.prototype.setMasterForRow=function(t,e,n,r){if(this.doingTreeData)t.setMaster(!1),r&&(t.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?t.setMaster(this.isRowMasterFunc(e)):t.setMaster(!0):t.setMaster(!1),r){var o=this.columnModel.getRowGroupColumns(),i=n+(o?o.length:0);t.expanded=!!t.master&&this.isExpanded(i)}},t.prototype.isExpanded=function(t){var e=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===e||t<e},t.TOP_LEVEL=0,t.ROOT_NODE_ID="ROOT_NODE_ID",t}(),ay=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ly=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},uy=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},cy=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};!function(t){t[t.Normal=0]="Normal",t[t.AfterFilter=1]="AfterFilter",t[t.AfterFilterAndSort=2]="AfterFilterAndSort",t[t.PivotNodes=3]="PivotNodes"}(ry||(ry={}));var py,hy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onRowHeightChanged_debounced=uo.debounce(e.onRowHeightChanged.bind(e),100),e.rowsToDisplay=[],e}return ay(e,t),e.prototype.init=function(){var t=this.refreshModel.bind(this,{step:$a.EVERYTHING}),e=!this.gridOptionsService.is("suppressAnimationFrame"),n=this.refreshModel.bind(this,{step:$a.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:e});this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,n),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:$a.PIVOT})),this.addManagedListener(this.eventService,Yt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_COLUMN_PIVOT_MODE_CHANGED,t),this.addManagedListener(this.eventService,Yt.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));var r=this.refreshModel.bind(this,{step:$a.MAP,keepRenderedRows:!0,animate:e});this.addManagedPropertyListener("groupRemoveSingleChildren",r),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",r),this.rootNode=new Ds(this.beans),this.nodeManager=new sy(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)},e.prototype.start=function(){var t=this.gridOptionsService.get("rowData");t&&this.setRowData(t)},e.prototype.ensureRowHeightsValid=function(t,e,n,r){var o,i=!1;do{o=!1;for(var s=this.getRowIndexAtPixel(t),a=this.getRowIndexAtPixel(e),l=Math.max(s,n),u=Math.min(a,r),c=l;c<=u;c++){var p=this.getRow(c);if(p.rowHeightEstimated){var h=this.gridOptionsService.getRowHeightForNode(p);p.setRowHeight(h.height),o=!0,i=!0}}o&&this.setRowTopAndRowIndex()}while(o);return i},e.prototype.setRowTopAndRowIndex=function(){for(var t=this.environment.getDefaultRowHeight(),e=0,n=new Set,r=this.gridOptionsService.isDomLayout("normal"),o=0;o<this.rowsToDisplay.length;o++){var i=this.rowsToDisplay[o];if(null!=i.id&&n.add(i.id),null==i.rowHeight){var s=this.gridOptionsService.getRowHeightForNode(i,r,t);i.setRowHeight(s.height,s.estimated)}i.setRowTop(e),i.setRowIndex(o),e+=i.rowHeight}return n},e.prototype.clearRowTopAndRowIndex=function(t,e){var n=t.isActive(),r=function(t){t&&null!=t.id&&!e.has(t.id)&&t.clearRowTopAndRowIndex()},o=function(t){if(r(t),r(t.detailNode),r(t.sibling),t.hasChildren()&&t.childrenAfterGroup){var e=-1==t.level;n&&!e&&!t.expanded||t.childrenAfterGroup.forEach(o)}};o(this.rootNode)},e.prototype.ensureRowsAtPixel=function(t,e,n){var r=this;void 0===n&&(n=0);var o=this.getRowIndexAtPixel(e),i=this.getRow(o),s=!this.gridOptionsService.is("suppressAnimationFrame");return i!==t[0]&&(t.forEach((function(t){uo.removeFromArray(r.rootNode.allLeafChildren,t)})),t.forEach((function(t,e){uo.insertIntoArray(r.rootNode.allLeafChildren,t,Math.max(o+n,0)+e)})),this.refreshModel({step:$a.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:s}),!0)},e.prototype.highlightRowAtPixel=function(t,e){var n=null!=e?this.getRowIndexAtPixel(e):null,r=null!=n?this.getRow(n):null;if(r&&t&&r!==t&&null!=e){var o=this.getHighlightPosition(e,r);this.lastHighlightedRow&&this.lastHighlightedRow!==r&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),r.setHighlighted(o),this.lastHighlightedRow=r}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)},e.prototype.getHighlightPosition=function(t,e){if(!e){var n=this.getRowIndexAtPixel(t);if(!(e=this.getRow(n||0)))return Ja.Below}return t-e.rowTop<e.rowHeight/2?Ja.Above:Ja.Below},e.prototype.getLastHighlightedRowNode=function(){return this.lastHighlightedRow},e.prototype.isLastRowIndexKnown=function(){return!0},e.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},e.prototype.getTopLevelRowCount=function(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;var t=this.rootNode.childrenAfterAggFilter;return t?t.length:0},e.prototype.getTopLevelRowDisplayedIndex=function(t){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return t;var e=this.rootNode.childrenAfterSort[t];if(this.gridOptionsService.is("groupHideOpenParents"))for(;e.expanded&&e.childrenAfterSort&&e.childrenAfterSort.length>0;)e=e.childrenAfterSort[0];return e.rowIndex},e.prototype.getRowBounds=function(t){if(uo.missing(this.rowsToDisplay))return null;var e=this.rowsToDisplay[t];return e?{rowTop:e.rowTop,rowHeight:e.rowHeight}:null},e.prototype.onRowGroupOpened=function(){var t=this.gridOptionsService.isAnimateRows();this.refreshModel({step:$a.MAP,keepRenderedRows:!0,animate:t})},e.prototype.onFilterChanged=function(t){if(!t.afterDataChange){var e=this.gridOptionsService.isAnimateRows(),n=0===t.columns.length||t.columns.some((function(t){return t.isPrimary()}))?$a.FILTER:$a.FILTER_AGGREGATES;this.refreshModel({step:n,keepRenderedRows:!0,animate:e})}},e.prototype.onSortChanged=function(){var t=this.gridOptionsService.isAnimateRows();this.refreshModel({step:$a.SORT,keepRenderedRows:!0,animate:t,keepEditingRows:!0})},e.prototype.getType=function(){return"clientSide"},e.prototype.onValueChanged=function(){this.columnModel.isPivotActive()?this.refreshModel({step:$a.PIVOT}):this.refreshModel({step:$a.AGGREGATE})},e.prototype.createChangePath=function(t){var e=uo.missingOrEmpty(t),n=new Ah(!1,this.rootNode);return(e||this.gridOptionsService.isTreeData())&&n.setInactive(),n},e.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(t){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==t.rowNodeTransactions)return!1;var e=t.rowNodeTransactions.filter((function(t){return null!=t.add&&t.add.length>0||null!=t.remove&&t.remove.length>0}));return null==e||0==e.length},e.prototype.buildRefreshModelParams=function(t){var e=$a.EVERYTHING,n={everything:$a.EVERYTHING,group:$a.EVERYTHING,filter:$a.FILTER,map:$a.MAP,aggregate:$a.AGGREGATE,sort:$a.SORT,pivot:$a.PIVOT};if(uo.exists(t)&&(e=n[t]),!uo.missing(e))return{step:e,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")};console.error("AG Grid: invalid step "+t+", available steps are "+Object.keys(n).join(", "))},e.prototype.refreshModel=function(t){var e="object"===typeof t&&"step"in t?t:this.buildRefreshModelParams(t);if(e&&!this.isSuppressModelUpdateAfterUpdateTransaction(e)){var n=this.createChangePath(e.rowNodeTransactions);switch(e.step){case $a.EVERYTHING:this.doRowGrouping(e.groupState,e.rowNodeTransactions,e.rowNodeOrder,n,!!e.afterColumnsChanged);case $a.FILTER:this.doFilter(n);case $a.PIVOT:this.doPivot(n);case $a.AGGREGATE:this.doAggregate(n);case $a.FILTER_AGGREGATES:this.doFilterAggregates(n);case $a.SORT:this.doSort(e.rowNodeTransactions,n);case $a.MAP:this.doRowsToDisplay()}var r=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(n,r);var o={type:Yt.EVENT_MODEL_UPDATED,animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack};this.eventService.dispatchEvent(o)}},e.prototype.isEmpty=function(){var t=uo.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return uo.missing(this.rootNode)||t||!this.columnModel.isReady()},e.prototype.isRowsToRender=function(){return uo.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0},e.prototype.getNodesInRangeForSelection=function(t,e){var n=!e,r=!1,o=[],i=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort((function(s){if(!r)if(n&&(s===e||s===t)&&(r=!0,s.group&&i))o.push.apply(o,cy([],uy(s.allLeafChildren)));else{if(!n){if(s!==e&&s!==t)return;n=!0}(!s.group||!i)&&o.push(s)}})),o},e.prototype.setDatasource=function(t){console.error("AG Grid: should never call setDatasource on clientSideRowController")},e.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},e.prototype.getRootNode=function(){return this.rootNode},e.prototype.getRow=function(t){return this.rowsToDisplay[t]},e.prototype.isRowPresent=function(t){return this.rowsToDisplay.indexOf(t)>=0},e.prototype.getRowIndexAtPixel=function(t){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;var e=0,n=this.rowsToDisplay.length-1;if(t<=0)return 0;if(uo.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;for(var r=-1,o=-1;;){var i=Math.floor((e+n)/2),s=this.rowsToDisplay[i];if(this.isRowInPixel(s,t))return i;if(s.rowTop<t?e=i+1:s.rowTop>t&&(n=i-1),r===e&&o===n)return i;r=e,o=n}},e.prototype.isRowInPixel=function(t,e){var n=t.rowTop,r=t.rowTop+t.rowHeight;return n<=e&&r>e},e.prototype.forEachLeafNode=function(t){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((function(e,n){return t(e,n)}))},e.prototype.forEachNode=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:cy([],uy(this.rootNode.childrenAfterGroup||[])),callback:t,recursionType:ry.Normal,index:0,includeFooterNodes:e})},e.prototype.forEachNodeAfterFilter=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:cy([],uy(this.rootNode.childrenAfterAggFilter||[])),callback:t,recursionType:ry.AfterFilter,index:0,includeFooterNodes:e})},e.prototype.forEachNodeAfterFilterAndSort=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:cy([],uy(this.rootNode.childrenAfterSort||[])),callback:t,recursionType:ry.AfterFilterAndSort,index:0,includeFooterNodes:e})},e.prototype.forEachPivotNode=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:t,recursionType:ry.PivotNodes,index:0,includeFooterNodes:e})},e.prototype.recursivelyWalkNodesAndCallback=function(t){var e,n=t.nodes,r=t.callback,o=t.recursionType,i=t.includeFooterNodes,s=t.index,a=n[0];i&&(null===(e=null===a||void 0===a?void 0:a.parent)||void 0===e?void 0:e.sibling)&&n.push(a.parent.sibling);for(var l=0;l<n.length;l++){var u=n[l];if(r(u,s++),u.hasChildren()&&!u.footer){var c=null;switch(o){case ry.Normal:c=u.childrenAfterGroup;break;case ry.AfterFilter:c=u.childrenAfterAggFilter;break;case ry.AfterFilterAndSort:c=u.childrenAfterSort;break;case ry.PivotNodes:c=u.leafGroup?null:u.childrenAfterSort}c&&(s=this.recursivelyWalkNodesAndCallback({nodes:cy([],uy(c)),callback:r,recursionType:o,index:s,includeFooterNodes:i}))}}return s},e.prototype.doAggregate=function(t){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:t})},e.prototype.doFilterAggregates=function(t){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:t}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter},e.prototype.expandOrCollapseAll=function(t){var e=this.gridOptionsService.isTreeData(),n=this.columnModel.isPivotActive(),r=function(o){o&&o.forEach((function(o){var i=function(){o.expanded=t,r(o.childrenAfterGroup)};e?uo.exists(o.childrenAfterGroup)&&i():n?!o.leafGroup&&i():o.group&&i()}))};this.rootNode&&r(this.rootNode.childrenAfterGroup),this.refreshModel({step:$a.MAP});var o=t?"expandAll":"collapseAll",i={type:Yt.EVENT_EXPAND_COLLAPSE_ALL,source:o};this.eventService.dispatchEvent(i)},e.prototype.doSort=function(t,e){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,changedPath:e})},e.prototype.doRowGrouping=function(t,e,n,r,o){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodeOrder:n,changedPath:r}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:r,afterColumnsChanged:o}),this.restoreGroupState(t)),this.gridOptionsService.is("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",r)){var i={type:Yt.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(i)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()},e.prototype.restoreGroupState=function(t){t&&uo.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(e,n){"boolean"===typeof t[n]&&(e.expanded=t[n])}))},e.prototype.doFilter=function(t){this.filterStage.execute({rowNode:this.rootNode,changedPath:t})},e.prototype.doPivot=function(t){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:t})},e.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;var t={};return uo.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(e,n){return t[n]=e.expanded})),t},e.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},e.prototype.getRowNode=function(t){if("string"==typeof t&&0==t.indexOf(Ds.ID_PREFIX_ROW_GROUP)){var e=void 0;return this.forEachNode((function(n){n.id===t&&(e=n)})),e}return this.nodeManager.getRowNode(t)},e.prototype.setRowData=function(t){var e=this.getGroupState();this.nodeManager.setRowData(t),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");var n={type:Yt.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(n),this.refreshModel({step:$a.EVERYTHING,groupState:e,newData:!0})},e.prototype.batchUpdateRowData=function(t,e){var n=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var r=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout((function(){n.executeBatchUpdateRowData()}),r)}this.rowDataTransactionBatch.push({rowDataTransaction:t,callback:e})},e.prototype.flushAsyncTransactions=function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())},e.prototype.executeBatchUpdateRowData=function(){var t=this;this.valueCache.onDataChanged();var e=[],n=[],r=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach((function(o){var i=t.nodeManager.updateRowData(o.rowDataTransaction,void 0);n.push(i),o.callback&&e.push(o.callback.bind(null,i)),"number"===typeof o.rowDataTransaction.addIndex&&(r=!0)})),this.commonUpdateRowData(n,void 0,r),e.length>0&&window.setTimeout((function(){e.forEach((function(t){return t()}))}),0),n.length>0){var o={type:Yt.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:n};this.eventService.dispatchEvent(o)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0},e.prototype.updateRowData=function(t,e){this.valueCache.onDataChanged();var n=this.nodeManager.updateRowData(t,e),r="number"===typeof t.addIndex;return this.commonUpdateRowData([n],e,r),n},e.prototype.createRowNodeOrder=function(){if(!this.gridOptionsService.is("suppressMaintainUnsortedOrder")){var t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var e=0;e<this.rootNode.allLeafChildren.length;e++){t[this.rootNode.allLeafChildren[e].id]=e}return t}},e.prototype.commonUpdateRowData=function(t,e,n){var r=!this.gridOptionsService.is("suppressAnimationFrame");n&&(e=this.createRowNodeOrder()),this.refreshModel({step:$a.EVERYTHING,rowNodeTransactions:t,rowNodeOrder:e,keepRenderedRows:!0,keepEditingRows:!0,animate:r}),this.filterManager.onNewRowsLoaded("rowDataUpdated");var o={type:Yt.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(o)},e.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},e.prototype.onRowHeightChanged=function(){this.refreshModel({step:$a.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})},e.prototype.onRowHeightChangedDebounced=function(){this.onRowHeightChanged_debounced()},e.prototype.resetRowHeights=function(){var t=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),t&&this.onRowHeightChanged()},e.prototype.resetRowHeightsForAllRowNodes=function(){var t=!1;return this.forEachNode((function(e){e.setRowHeight(e.rowHeight,!0);var n=e.detailNode;n&&n.setRowHeight(n.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t=!0})),t},e.prototype.onGridStylesChanges=function(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()},ly([$("columnModel")],e.prototype,"columnModel",void 0),ly([$("selectionService")],e.prototype,"selectionService",void 0),ly([$("filterManager")],e.prototype,"filterManager",void 0),ly([$("valueCache")],e.prototype,"valueCache",void 0),ly([$("beans")],e.prototype,"beans",void 0),ly([$("filterStage")],e.prototype,"filterStage",void 0),ly([$("sortStage")],e.prototype,"sortStage",void 0),ly([$("flattenStage")],e.prototype,"flattenStage",void 0),ly([tt("groupStage")],e.prototype,"groupStage",void 0),ly([tt("aggregationStage")],e.prototype,"aggregationStage",void 0),ly([tt("pivotStage")],e.prototype,"pivotStage",void 0),ly([tt("filterAggregatesStage")],e.prototype,"filterAggregatesStage",void 0),ly([Z],e.prototype,"init",null),e=ly([J("rowModel")],e)}(jt),dy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return dy(e,t),e.prototype.execute=function(t){var e=t.changedPath;this.filterService.filter(e)},fy([$("filterService")],e.prototype,"filterService",void 0),e=fy([J("filterStage")],e)}(jt),my=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},vy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return my(e,t),e.prototype.execute=function(t){var e=this,n=this.sortController.getSortOptions(),r=uo.exists(n)&&n.length>0,o=r&&uo.exists(t.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),i=n.some((function(t){return!!e.columnModel.getGroupDisplayColumnForGroup(t.column.getId())}));this.sortService.sort(n,r,o,t.rowNodeTransactions,t.changedPath,i)},yy([$("sortService")],e.prototype,"sortService",void 0),yy([$("sortController")],e.prototype,"sortController",void 0),yy([$("columnModel")],e.prototype,"columnModel",void 0),e=yy([J("sortStage")],e)}(jt),_y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Cy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _y(e,t),e.prototype.execute=function(t){var e=t.rowNode,n=[],r={value:0},o=this.columnModel.isPivotMode(),i=o&&e.leafGroup,s=i?[e]:e.childrenAfterSort;return this.recursivelyAddToRowsToDisplay(s,n,r,o,0),!i&&n.length>0&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(e.createFooter(),this.addRowNodeToRowsToDisplay(e.sibling,n,r,0)),n},e.prototype.recursivelyAddToRowsToDisplay=function(t,e,n,r,o){if(!uo.missingOrEmpty(t))for(var i=this.gridOptionsService.is("groupHideOpenParents"),s=this.gridOptionsService.is("groupRemoveSingleChildren"),a=!s&&this.gridOptionsService.is("groupRemoveLowestSingleChildren"),l=0;l<t.length;l++){var u=t[l],c=u.hasChildren(),p=r&&!c,h=s&&c&&1===u.childrenAfterGroup.length,d=a&&c&&u.leafGroup&&1===u.childrenAfterGroup.length,f=r&&u.leafGroup,g=i&&u.expanded&&!u.master&&!f;if(!p&&!g&&!h&&!d&&this.addRowNodeToRowsToDisplay(u,e,n,o),!r||!u.leafGroup)if(c){var m=h||d;if(u.expanded||m){var y=m?o:o+1;this.recursivelyAddToRowsToDisplay(u.childrenAfterSort,e,n,r,y),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(u.sibling,e,n,y)}}else if(u.master&&u.expanded){var v=this.createDetailNode(u);this.addRowNodeToRowsToDisplay(v,e,n,o)}}},e.prototype.addRowNodeToRowsToDisplay=function(t,e,n,r){var o=this.gridOptionsService.isGroupMultiAutoColumn();e.push(t),t.setUiLevel(o?0:r)},e.prototype.createDetailNode=function(t){if(uo.exists(t.detailNode))return t.detailNode;var e=new Ds(this.beans);return e.detail=!0,e.selectable=!1,e.parent=t,uo.exists(t.id)&&(e.id="detail_"+t.id),e.data=t.data,e.level=t.level+1,t.detailNode=e,e},wy([$("columnModel")],e.prototype,"columnModel",void 0),wy([$("beans")],e.prototype,"beans",void 0),e=wy([J("flattenStage")],e)}(jt),by=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ey=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return by(e,t),e.prototype.init=function(){this.postSortFunc=this.gridOptionsService.getCallback("postSortRows")},e.prototype.sort=function(t,e,n,r,o,i){var s=this,a=this.gridOptionsService.is("groupMaintainOrder"),l=this.columnModel.getAllGridColumns().some((function(t){return t.isRowGroupActive()})),u={};n&&r&&(u=this.calculateDirtyNodes(r));var c=this.columnModel.isPivotMode();o&&o.forEachChangedNodeDepthFirst((function(r){s.pullDownGroupDataForHideOpenParents(r.childrenAfterAggFilter,!0);var p=c&&r.leafGroup;if(a&&l&&!r.leafGroup&&!i){var h=r.childrenAfterAggFilter.slice(0);if(r.childrenAfterSort){var d={};r.childrenAfterSort.forEach((function(t,e){d[t.id]=e})),h.sort((function(t,e){var n,r;return(null!==(n=d[t.id])&&void 0!==n?n:0)-(null!==(r=d[e.id])&&void 0!==r?r:0)}))}r.childrenAfterSort=h}else r.childrenAfterSort=!e||p?r.childrenAfterAggFilter.slice(0):n?s.doDeltaSort(r,u,o,t):s.rowNodeSorter.doFullSort(r.childrenAfterAggFilter,t);if(r.sibling&&(r.sibling.childrenAfterSort=r.childrenAfterSort),s.updateChildIndexes(r),s.postSortFunc){var f={nodes:r.childrenAfterSort};s.postSortFunc(f)}})),this.updateGroupDataForHideOpenParents(o)},e.prototype.calculateDirtyNodes=function(t){var e={},n=function(t){t&&t.forEach((function(t){return e[t.id]=!0}))};return t&&t.forEach((function(t){n(t.add),n(t.update),n(t.remove)})),e},e.prototype.doDeltaSort=function(t,e,n,r){var o=this,i=t.childrenAfterAggFilter,s=t.childrenAfterSort;if(!s)return this.rowNodeSorter.doFullSort(i,r);var a={},l=[];i.forEach((function(t){e[t.id]||!n.canSkip(t)?l.push(t):a[t.id]=!0}));var u=s.filter((function(t){return a[t.id]})),c=function(t,e){return{currentPos:e,rowNode:t}},p=l.map(c).sort((function(t,e){return o.rowNodeSorter.compareRowNodes(r,t,e)}));return this.mergeSortedArrays(r,p,u.map(c)).map((function(t){return t.rowNode}))},e.prototype.mergeSortedArrays=function(t,e,n){for(var r=[],o=0,i=0;o<e.length&&i<n.length;){this.rowNodeSorter.compareRowNodes(t,e[o],n[i])<0?r.push(e[o++]):r.push(n[i++])}for(;o<e.length;)r.push(e[o++]);for(;i<n.length;)r.push(n[i++]);return r},e.prototype.updateChildIndexes=function(t){if(!uo.missing(t.childrenAfterSort))for(var e=t.childrenAfterSort,n=0;n<e.length;n++){var r=e[n],o=0===n,i=n===t.childrenAfterSort.length-1;r.setFirstChild(o),r.setLastChild(i),r.setChildIndex(n)}},e.prototype.updateGroupDataForHideOpenParents=function(t){var e=this;if(this.gridOptionsService.is("groupHideOpenParents")){if(this.gridOptionsService.isTreeData()){return uo.doOnce((function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")}),"sortService.hideOpenParentsWithTreeData"),!1}var n=function(t){e.pullDownGroupDataForHideOpenParents(t.childrenAfterSort,!1),t.childrenAfterSort.forEach((function(t){t.hasChildren()&&n(t)}))};t&&t.executeFromRootNode((function(t){return n(t)}))}},e.prototype.pullDownGroupDataForHideOpenParents=function(t,e){var n=this;this.gridOptionsService.is("groupHideOpenParents")&&!uo.missing(t)&&t.forEach((function(t){n.columnModel.getGroupDisplayColumns().forEach((function(r){var o=r.getColDef().showRowGroup;if("string"===typeof o){var i=o,s=n.columnModel.getPrimaryColumn(i);if(!(s===t.rowGroupColumn))if(e)t.setGroupValue(r.getId(),void 0);else{var a=t.getFirstChildOfFirstChild(s);a&&t.setGroupValue(r.getId(),a.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")}))}))},xy([$("columnModel")],e.prototype,"columnModel",void 0),xy([$("rowNodeSorter")],e.prototype,"rowNodeSorter",void 0),xy([Z],e.prototype,"init",null),e=xy([J("sortService")],e)}(jt),Sy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ty=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ry=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Sy(e,t),e.prototype.filter=function(t){var e=this.filterManager.isChildFilterPresent();this.filterNodes(e,t)},e.prototype.filterNodes=function(t,e){var n=this,r=function(e,r){e.hasChildren()?e.childrenAfterFilter=t&&!r?e.childrenAfterGroup.filter((function(t){var e=t.childrenAfterFilter&&t.childrenAfterFilter.length>0,r=t.data&&n.filterManager.doesRowPassFilter({rowNode:t});return e||r})):e.childrenAfterGroup:e.childrenAfterFilter=e.childrenAfterGroup,e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var o=function(t,e){if(t.childrenAfterGroup)for(var i=0;i<t.childrenAfterGroup.length;i++){var s=t.childrenAfterGroup[i],a=e||n.filterManager.doesRowPassFilter({rowNode:s});s.childrenAfterGroup?o(t.childrenAfterGroup[i],a):r(s,a)}r(t,e)};e.executeFromRootNode((function(t){return o(t,!1)}))}else{e.forEachChangedNodeDepthFirst((function(t){return r(t,!1)}),!0)}},e.prototype.doingTreeDataFiltering=function(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")},Ty([$("filterManager")],e.prototype,"filterManager",void 0),e=Ty([J("filterService")],e)}(jt),Py=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Iy=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ay=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Py(e,t),e.prototype.postConstruct=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},e.prototype.isActive=function(){var t=this.gridOptionsService.exists("getRowId");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&t},e.prototype.setRowData=function(t){var e=this.createTransactionForRowData(t);if(e){var n=Iy(e,2),r=n[0],o=n[1];this.clientSideRowModel.updateRowData(r,o)}},e.prototype.createTransactionForRowData=function(t){if(uo.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var e=this.gridOptionsService.getCallback("getRowId");if(null!=e){var n={remove:[],update:[],add:[]},r=this.clientSideRowModel.getCopyOfNodesMap(),o=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return uo.exists(t)&&t.forEach((function(t,i){var s=e({data:t,level:0}),a=r[s];(o&&(o[s]=i),a)?(a.data!==t&&n.update.push(t),r[s]=void 0):n.add.push(t)})),uo.iterateObject(r,(function(t,e){e&&n.remove.push(e.data)})),[n,o]}console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!")}},Oy([$("rowModel")],e.prototype,"rowModel",void 0),Oy([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Oy([Z],e.prototype,"postConstruct",null),e=Oy([J("immutableService")],e)}(jt),Dy={version:"30.1.0",moduleName:z.ClientSideRowModelModule,rowModel:"clientSide",beans:[hy,gy,vy,Cy,Ey,Ry,Ay]},My=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ly=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ny=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.parentCache=n,o.params=r,o.startRow=e*r.blockSize,o.endRow=o.startRow+r.blockSize,o}return My(e,t),e.prototype.postConstruct=function(){this.createRowNodes()},e.prototype.getBlockStateJson=function(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}},e.prototype.setDataAndId=function(t,e,n){uo.exists(e)?t.setDataAndId(e,n.toString()):t.setDataAndId(void 0,void 0)},e.prototype.loadFromDatasource=function(){var t=this,e=this.createLoadParams();uo.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout((function(){t.params.datasource.getRows(e)}),0)},e.prototype.processServerFail=function(){},e.prototype.createLoadParams=function(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}},e.prototype.forEachNode=function(t,e,n){var r=this;this.rowNodes.forEach((function(o,i){r.startRow+i<n&&t(o,e.next())}))},e.prototype.getLastAccessed=function(){return this.lastAccessed},e.prototype.getRow=function(t,e){void 0===e&&(e=!1),e||(this.lastAccessed=this.params.lastAccessedSequence.next());var n=t-this.startRow;return this.rowNodes[n]},e.prototype.getStartRow=function(){return this.startRow},e.prototype.getEndRow=function(){return this.endRow},e.prototype.createRowNodes=function(){this.rowNodes=[];for(var t=0;t<this.params.blockSize;t++){var e=this.startRow+t,n=new Ds(this.beans);n.setRowHeight(this.params.rowHeight),n.uiLevel=0,n.setRowIndex(e),n.setRowTop(this.params.rowHeight*e),this.rowNodes.push(n)}},e.prototype.processServerResult=function(t){var e=this;this.rowNodes.forEach((function(n,r){var o=t.rowData?t.rowData[r]:void 0;!n.id&&n.alreadyRendered&&o&&(e.rowNodes[r]=new Ds(e.beans),e.rowNodes[r].setRowIndex(n.rowIndex),e.rowNodes[r].setRowTop(n.rowTop),n.clearRowTopAndRowIndex()),e.setDataAndId(e.rowNodes[r],o,e.startRow+r)}));var n=null!=t.rowCount&&t.rowCount>=0?t.rowCount:void 0;this.parentCache.pageLoaded(this,n)},e.prototype.destroyRowNodes=function(){this.rowNodes.forEach((function(t){t.clearRowTopAndRowIndex()}))},Ly([$("beans")],e.prototype,"beans",void 0),Ly([Z],e.prototype,"postConstruct",null),Ly([Q],e.prototype,"destroyRowNodes",null),e}(Mh),Fy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ky=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Gy=function(t,e){return function(n,r){e(n,r,t)}},By=function(t){function e(e){var n=t.call(this)||this;return n.lastRowIndexKnown=!1,n.blocks={},n.blockCount=0,n.rowCount=e.initialRowCount,n.params=e,n}return Fy(e,t),e.prototype.setBeans=function(t){this.logger=t.create("InfiniteCache")},e.prototype.getRow=function(t,e){void 0===e&&(e=!1);var n=Math.floor(t/this.params.blockSize),r=this.blocks[n];if(!r){if(e)return;r=this.createBlock(n)}return r.getRow(t)},e.prototype.createBlock=function(t){var e=this.createBean(new Ny(t,this,this.params));return this.blocks[e.getId()]=e,this.blockCount++,this.purgeBlocksIfNeeded(e),this.params.rowNodeBlockLoader.addBlock(e),e},e.prototype.refreshCache=function(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach((function(t){return t.setStateWaitingToLoad()})),this.params.rowNodeBlockLoader.checkBlockToLoad())},e.prototype.destroyAllBlocks=function(){var t=this;this.getBlocksInOrder().forEach((function(e){return t.destroyBlock(e)}))},e.prototype.getRowCount=function(){return this.rowCount},e.prototype.isLastRowIndexKnown=function(){return this.lastRowIndexKnown},e.prototype.pageLoaded=function(t,e){this.isAlive()&&(this.logger.log("onPageLoaded: page = "+t.getId()+", lastRow = "+e),this.checkRowCount(t,e),this.onCacheUpdated())},e.prototype.purgeBlocksIfNeeded=function(t){var n=this,r=this.getBlocksInOrder().filter((function(e){return e!=t}));r.sort((function(t,e){return e.getLastAccessed()-t.getLastAccessed()}));var o=this.params.maxBlocksInCache>0,i=o?this.params.maxBlocksInCache-1:null,s=e.MAX_EMPTY_BLOCKS_TO_KEEP-1;r.forEach((function(t,e){if(t.getState()===Ny.STATE_WAITING_TO_LOAD&&e>=s||!!o&&e>=i){if(n.isBlockCurrentlyDisplayed(t))return;if(n.isBlockFocused(t))return;n.removeBlockFromCache(t)}}))},e.prototype.isBlockFocused=function(t){var e=this.focusService.getFocusCellToUseAfterRefresh();if(!e)return!1;if(null!=e.rowPinned)return!1;var n=t.getStartRow(),r=t.getEndRow();return e.rowIndex>=n&&e.rowIndex<r},e.prototype.isBlockCurrentlyDisplayed=function(t){var e=t.getStartRow(),n=t.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(e,n)},e.prototype.removeBlockFromCache=function(t){t&&this.destroyBlock(t)},e.prototype.checkRowCount=function(t,e){if("number"===typeof e&&e>=0)this.rowCount=e,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){var n=(t.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<n&&(this.rowCount=n)}},e.prototype.setRowCount=function(t,e){this.rowCount=t,uo.exists(e)&&(this.lastRowIndexKnown=e),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()},e.prototype.forEachNodeDeep=function(t){var e=this,n=new co;this.getBlocksInOrder().forEach((function(r){return r.forEachNode(t,n,e.rowCount)}))},e.prototype.getBlocksInOrder=function(){return uo.getAllValuesInObject(this.blocks).sort((function(t,e){return t.getId()-e.getId()}))},e.prototype.destroyBlock=function(t){delete this.blocks[t.getId()],this.destroyBean(t),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(t)},e.prototype.onCacheUpdated=function(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();var t={type:Yt.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(t)}},e.prototype.destroyAllBlocksPastVirtualRowCount=function(){var t=this,e=[];this.getBlocksInOrder().forEach((function(n){n.getId()*t.params.blockSize>=t.rowCount&&e.push(n)})),e.length>0&&e.forEach((function(e){return t.destroyBlock(e)}))},e.prototype.purgeCache=function(){var t=this;this.getBlocksInOrder().forEach((function(e){return t.removeBlockFromCache(e)})),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()},e.prototype.getRowNodesInRange=function(t,e){var n=this,r=[],o=-1,i=!1,s=new co;uo.missing(t)&&(i=!0);var a=!1;return this.getBlocksInOrder().forEach((function(l){a||(i&&o+1!==l.getId()?a=!0:(o=l.getId(),l.forEachNode((function(n){var o=n===t||n===e;(i||o)&&r.push(n),o&&(i=!i)}),s,n.rowCount)))})),a||i?[]:r},e.MAX_EMPTY_BLOCKS_TO_KEEP=2,ky([$("rowRenderer")],e.prototype,"rowRenderer",void 0),ky([$("focusService")],e.prototype,"focusService",void 0),ky([Gy(0,nt("loggerFactory"))],e.prototype,"setBeans",null),ky([Q],e.prototype,"destroyAllBlocks",null),e}(jt),Vy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vy(e,t),e.prototype.getRowBounds=function(t){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*t}},e.prototype.ensureRowHeightsValid=function(t,e,n,r){return!1},e.prototype.init=function(){var t=this;this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc((function(){return t.destroyCache()})),this.verifyProps())},e.prototype.verifyProps=function(){if(this.gridOptionsService.exists("initialGroupOrderComparator")){uo.doOnce((function(){return console.warn("AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.")}),"IRM.InitialGroupOrderComparator")}},e.prototype.start=function(){this.setDatasource(this.gridOptionsService.get("datasource"))},e.prototype.destroyDatasource=function(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)},e.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Yt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,Yt.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))},e.prototype.onFilterChanged=function(){this.reset()},e.prototype.onSortChanged=function(){this.reset()},e.prototype.onColumnEverything=function(){(!this.cacheParams||this.isSortModelDifferent())&&this.reset()},e.prototype.isSortModelDifferent=function(){return!uo.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())},e.prototype.getType=function(){return"infinite"},e.prototype.setDatasource=function(t){this.destroyDatasource(),this.datasource=t,t&&this.reset()},e.prototype.isEmpty=function(){return!this.infiniteCache},e.prototype.isRowsToRender=function(){return!!this.infiniteCache},e.prototype.getNodesInRangeForSelection=function(t,e){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(t,e):[]},e.prototype.reset=function(){if(this.datasource){null!=this.gridOptionsService.getCallback("getRowId")||this.selectionService.reset(),this.resetCache();var t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)}},e.prototype.createModelUpdatedEvent=function(){return{type:Yt.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}},e.prototype.resetCache=function(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new co},this.infiniteCache=this.createBean(new By(this.cacheParams))},e.prototype.defaultIfInvalid=function(t,e){return t>0?t:e},e.prototype.destroyCache=function(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))},e.prototype.onCacheUpdated=function(){var t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)},e.prototype.getRow=function(t){if(this.infiniteCache&&!(t>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(t)},e.prototype.getRowNode=function(t){var e;return this.forEachNode((function(n){n.id===t&&(e=n)})),e},e.prototype.forEachNode=function(t){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(t)},e.prototype.getTopLevelRowCount=function(){return this.getRowCount()},e.prototype.getTopLevelRowDisplayedIndex=function(t){return t},e.prototype.getRowIndexAtPixel=function(t){if(0!==this.rowHeight){var e=Math.floor(t/this.rowHeight),n=this.getRowCount()-1;return e>n?n:e}return 0},e.prototype.getRowCount=function(){return this.infiniteCache?this.infiniteCache.getRowCount():0},e.prototype.isRowPresent=function(t){return!!this.getRowNode(t.id)},e.prototype.refreshCache=function(){this.infiniteCache&&this.infiniteCache.refreshCache()},e.prototype.purgeCache=function(){this.infiniteCache&&this.infiniteCache.purgeCache()},e.prototype.isLastRowIndexKnown=function(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()},e.prototype.setRowCount=function(t,e){this.infiniteCache&&this.infiniteCache.setRowCount(t,e)},zy([$("filterManager")],e.prototype,"filterManager",void 0),zy([$("sortController")],e.prototype,"sortController",void 0),zy([$("selectionService")],e.prototype,"selectionService",void 0),zy([$("rowRenderer")],e.prototype,"rowRenderer",void 0),zy([$("rowNodeBlockLoader")],e.prototype,"rowNodeBlockLoader",void 0),zy([Z],e.prototype,"init",null),zy([Q],e.prototype,"destroyDatasource",null),e=zy([J("rowModel")],e)}(jt),Hy={version:"30.1.0",moduleName:z.InfiniteRowModelModule,rowModel:"infinite",beans:[jy]},Uy=function(){function t(){}return t.prototype.setBeans=function(t){this.beans=t},t.prototype.getFileName=function(t){var e=this.getDefaultFileExtension();return null!=t&&t.length||(t=this.getDefaultFileName()),-1===t.indexOf(".")?t+"."+e:t},t.prototype.getData=function(t){var e=this.createSerializingSession(t);return this.beans.gridSerializer.serialize(e,t)},t}(),Wy=function(){function t(t){this.groupColumns=[];var e=t.columnModel,n=t.valueService,r=t.gridOptionsService,o=t.valueFormatterService,i=t.valueParserService,s=t.processCellCallback,a=t.processHeaderCallback,l=t.processGroupHeaderCallback,u=t.processRowGroupCallback;this.columnModel=e,this.valueService=n,this.gridOptionsService=r,this.valueFormatterService=o,this.valueParserService=i,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=u}return t.prototype.prepare=function(t){this.groupColumns=t.filter((function(t){return!!t.getColDef().showRowGroup}))},t.prototype.extractHeaderValue=function(t){var e=this.getHeaderName(this.processHeaderCallback,t);return null!=e?e:""},t.prototype.extractRowCellValue=function(t,e,n,r,o){var i=this.gridOptionsService.is("groupHideOpenParents")&&!o.footer||!this.shouldRenderGroupSummaryCell(o,t,e)?this.valueService.getValue(t,o):this.createValueForGroupNode(o);return this.processCell({accumulatedRowIndex:n,rowNode:o,column:t,value:i,processCellCallback:this.processCellCallback,type:r})},t.prototype.shouldRenderGroupSummaryCell=function(t,e,n){var r;if(!(t&&t.group))return!1;if(-1!==this.groupColumns.indexOf(e)){if(null!=(null===(r=t.groupData)||void 0===r?void 0:r[e.getId()]))return!0;if(t.footer&&-1===t.level){var o=e.getColDef();return null==o||!0===o.showRowGroup||o.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}var i=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===n&&i},t.prototype.getHeaderName=function(t,e){return t?t({column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(e,"csv",!0)},t.prototype.createValueForGroupNode=function(t){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});var e=t.footer,n=[t.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;t.parent;)t=t.parent,n.push(t.key);var r=n.reverse().join(" -> ");return e?"Total "+r:r},t.prototype.processCell=function(t){var e,n=this,r=t.accumulatedRowIndex,o=t.rowNode,i=t.column,s=t.value,a=t.processCellCallback,l=t.type;return a?{value:null!==(e=a({accumulatedRowIndex:r,column:i,node:o,value:s,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:l,parseValue:function(t){return n.valueParserService.parseValue(i,o,t,n.valueService.getValue(i,o))},formatValue:function(t){var e;return null!==(e=n.valueFormatterService.formatValue(i,o,t))&&void 0!==e?e:t}}))&&void 0!==e?e:""}:i.getColDef().useValueFormatterForExport?{value:null!==s&&void 0!==s?s:"",valueFormatted:this.valueFormatterService.formatValue(i,o,s)}:{value:null!==s&&void 0!==s?s:""}},t}(),qy=function(){function t(){}return t.download=function(t,e){var n=document.defaultView||window;if(n){var r=document.createElement("a"),o=n.URL.createObjectURL(e);r.setAttribute("href",o),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(r),n.setTimeout((function(){n.URL.revokeObjectURL(o)}),0)}else console.warn("AG Grid: There is no `window` associated with the current `document`")},t}(),Xy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ky=function(t){function e(e){var n=t.call(this,e)||this;n.isFirstLine=!0,n.result="";var r=e.suppressQuotes,o=e.columnSeparator;return n.suppressQuotes=r,n.columnSeparator=o,n}return Xy(e,t),e.prototype.addCustomContent=function(t){var e=this;t&&("string"===typeof t?(/^\s*\n/.test(t)||this.beginNewLine(),t=t.replace(/\r?\n/g,"\r\n"),this.result+=t):t.forEach((function(t){e.beginNewLine(),t.forEach((function(t,n){0!==n&&(e.result+=e.columnSeparator),e.result+=e.putInQuotes(t.data.value||""),t.mergeAcross&&e.appendEmptyCells(t.mergeAcross)}))})))},e.prototype.onNewHeaderGroupingRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}},e.prototype.onNewHeaderGroupingRowColumn=function(t,e,n,r){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e),this.appendEmptyCells(r)},e.prototype.appendEmptyCells=function(t){for(var e=1;e<=t;e++)this.result+=this.columnSeparator+this.putInQuotes("")},e.prototype.onNewHeaderRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}},e.prototype.onNewHeaderRowColumn=function(t,e){0!=e&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(t))},e.prototype.onNewBodyRow=function(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}},e.prototype.onNewBodyRowColumn=function(t,e,n){var r;0!=e&&(this.result+=this.columnSeparator);var o=this.extractRowCellValue(t,e,e,"csv",n);this.result+=this.putInQuotes(null!==(r=o.valueFormatted)&&void 0!==r?r:o.value)},e.prototype.putInQuotes=function(t){return this.suppressQuotes?t:null===t||void 0===t?'""':("string"===typeof t?e=t:"function"===typeof t.toString?e=t.toString():(console.warn("AG Grid: unknown value type during csv conversion"),e=""),'"'+e.replace(/"/g,'""')+'"');var e},e.prototype.parse=function(){return this.result},e.prototype.beginNewLine=function(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1},e}(Wy),Yy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zy=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yy(e,t),e.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})},e.prototype.getMergedParams=function(t){var e=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},e,t)},e.prototype.export=function(t){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var e=this.getMergedParams(t),n=this.getData(e),r=new Blob(["\ufeff",n],{type:"text/plain"});return qy.download(this.getFileName(e.fileName),r),n},e.prototype.exportDataAsCsv=function(t){return this.export(t)},e.prototype.getDataAsCsv=function(t,e){void 0===e&&(e=!1);var n=e?Object.assign({},t):this.getMergedParams(t);return this.getData(n)},e.prototype.getDefaultFileName=function(){return"export.csv"},e.prototype.getDefaultFileExtension=function(){return"csv"},e.prototype.createSerializingSession=function(t){var e=this,n=e.columnModel,r=e.valueService,o=e.gridOptionsService,i=e.valueFormatterService,s=e.valueParserService,a=t,l=a.processCellCallback,u=a.processHeaderCallback,c=a.processGroupHeaderCallback,p=a.processRowGroupCallback,h=a.suppressQuotes,d=a.columnSeparator;return new Ky({columnModel:n,valueService:r,gridOptionsService:o,valueFormatterService:i,valueParserService:s,processCellCallback:l||void 0,processHeaderCallback:u||void 0,processGroupHeaderCallback:c||void 0,processRowGroupCallback:p||void 0,suppressQuotes:h||!1,columnSeparator:d||","})},e.prototype.isExportSuppressed=function(){return this.gridOptionsService.is("suppressCsvExport")},Zy([$("columnModel")],e.prototype,"columnModel",void 0),Zy([$("valueService")],e.prototype,"valueService",void 0),Zy([$("gridSerializer")],e.prototype,"gridSerializer",void 0),Zy([$("gridOptionsService")],e.prototype,"gridOptionsService",void 0),Zy([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),Zy([$("valueParserService")],e.prototype,"valueParserService",void 0),Zy([Z],e.prototype,"postConstruct",null),e=Zy([J("csvCreator")],e)}(Uy),Jy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$y=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.HEADER_GROUPING=0]="HEADER_GROUPING",t[t.HEADER=1]="HEADER",t[t.BODY=2]="BODY"}(py||(py={}));var tv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jy(e,t),e.prototype.serialize=function(t,e){void 0===e&&(e={});var n=this.getColumnsToExport(e.allColumns,e.columnKeys);return uo.compose(this.prepareSession(n),this.prependContent(e),this.exportColumnGroups(e,n),this.exportHeaders(e,n),this.processPinnedTopRows(e,n),this.processRows(e,n),this.processPinnedBottomRows(e,n),this.appendContent(e))(t).parse()},e.prototype.processRow=function(t,e,n,r){var o=e.shouldRowBeSkipped||function(){return!1},i=this.gridOptionsService.context,s=this.gridOptionsService.api,a=this.gridOptionsService.columnApi,l=this.gridOptionsService.is("groupRemoveSingleChildren"),u=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),c=null!=e.rowPositions||!!e.onlySelected,p=this.gridOptionsService.is("groupHideOpenParents")&&!c,h=this.columnModel.isPivotMode()?r.leafGroup:!r.group,d=!!r.footer,f=e.skipGroups||e.skipRowGroups,g=u&&r.leafGroup,m=1===r.allChildrenCount&&(l||g);if((f&&e.skipGroups&&uo.doOnce((function(){return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.")}),"gridSerializer-skipGroups"),!(!h&&!d&&(e.skipRowGroups||m||p)||e.onlySelected&&!r.isSelected()||e.skipPinnedTop&&"top"===r.rowPinned||e.skipPinnedBottom&&"bottom"===r.rowPinned))&&((!(-1===r.level)||h||d)&&!o({node:r,api:s,columnApi:a,context:i}))){var y=t.onNewBodyRow(r);if(n.forEach((function(t,e){y.onColumn(t,e,r)})),e.getCustomContentBelowRow){var v=e.getCustomContentBelowRow({node:r,api:s,columnApi:a,context:i});v&&t.addCustomContent(v)}}},e.prototype.appendContent=function(t){return function(e){var n=t.customFooter||t.appendContent;return n&&(t.customFooter&&uo.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.")}),"gridSerializer-customFooter"),e.addCustomContent(n)),e}},e.prototype.prependContent=function(t){return function(e){var n=t.customHeader||t.prependContent;return n&&(t.customHeader&&uo.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.")}),"gridSerializer-customHeader"),e.addCustomContent(n)),e}},e.prototype.prepareSession=function(t){return function(e){return e.prepare(t),e}},e.prototype.exportColumnGroups=function(t,e){var n=this;return function(r){if(t.skipColumnGroupHeaders)t.columnGroups&&uo.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.")}),"gridSerializer-columnGroups");else{var o=new Zt,i=n.displayedGroupCreator.createDisplayedGroups(e,o,null);n.recursivelyAddHeaderGroups(i,r,t.processGroupHeaderCallback)}return r}},e.prototype.exportHeaders=function(t,e){return function(n){if(t.skipHeader||t.skipColumnHeaders)t.skipHeader&&uo.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.")}),"gridSerializer-skipHeader");else{var r=n.onNewHeaderRow();e.forEach((function(t,e){r.onColumn(t,e,void 0)}))}return n}},e.prototype.processPinnedTopRows=function(t,e){var n=this;return function(r){var o=n.processRow.bind(n,r,t,e);return t.rowPositions?t.rowPositions.filter((function(t){return"top"===t.rowPinned})).sort((function(t,e){return t.rowIndex-e.rowIndex})).map((function(t){return n.pinnedRowModel.getPinnedTopRow(t.rowIndex)})).forEach(o):n.pinnedRowModel.forEachPinnedTopRow(o),r}},e.prototype.processRows=function(t,e){var n=this;return function(r){var o=n.rowModel,i=o.getType(),s="clientSide"===i,a="serverSide"===i,l=!s&&t.onlySelected,u=n.processRow.bind(n,r,t,e),c=t.exportedRows,p=void 0===c?"filteredAndSorted":c;if(t.rowPositions)t.rowPositions.filter((function(t){return null==t.rowPinned})).sort((function(t,e){return t.rowIndex-e.rowIndex})).map((function(t){return o.getRow(t.rowIndex)})).forEach(u);else if(n.columnModel.isPivotMode())s?o.forEachPivotNode(u,!0):o.forEachNode(u);else if(t.onlySelectedAllPages||l){var h=n.selectionService.getSelectedNodes();n.replicateSortedOrder(h),h.forEach(u)}else"all"===p?o.forEachNode(u):s?o.forEachNodeAfterFilterAndSort(u,!0):a?o.forEachNodeAfterFilterAndSort(u):o.forEachNode(u);return r}},e.prototype.replicateSortedOrder=function(t){var e=this,n=this.sortController.getSortOptions(),r=function(t,o){var i,s,a,l;return null!=t.rowIndex&&null!=o.rowIndex?t.rowIndex-o.rowIndex:t.level===o.level?(null===(i=t.parent)||void 0===i?void 0:i.id)===(null===(s=o.parent)||void 0===s?void 0:s.id)?e.rowNodeSorter.compareRowNodes(n,{rowNode:t,currentPos:null!==(a=t.rowIndex)&&void 0!==a?a:-1},{rowNode:o,currentPos:null!==(l=o.rowIndex)&&void 0!==l?l:-1}):r(t.parent,o.parent):t.level>o.level?r(t.parent,o):r(t,o.parent)};t.sort(r)},e.prototype.processPinnedBottomRows=function(t,e){var n=this;return function(r){var o=n.processRow.bind(n,r,t,e);return t.rowPositions?t.rowPositions.filter((function(t){return"bottom"===t.rowPinned})).sort((function(t,e){return t.rowIndex-e.rowIndex})).map((function(t){return n.pinnedRowModel.getPinnedBottomRow(t.rowIndex)})).forEach(o):n.pinnedRowModel.forEachPinnedBottomRow(o),r}},e.prototype.getColumnsToExport=function(t,e){void 0===t&&(t=!1);var n=this.columnModel.isPivotMode();return e&&e.length?this.columnModel.getGridColumns(e):t&&!n?(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([$t]):[]).concat(this.columnModel.getAllGridColumns()||[]):this.columnModel.getAllDisplayedColumns()},e.prototype.recursivelyAddHeaderGroups=function(t,e,n){var r=[];t.forEach((function(t){var e=t;e.getChildren&&e.getChildren().forEach((function(t){return r.push(t)}))})),t.length>0&&t[0]instanceof Kt&&this.doAddHeaderHeader(e,t,n),r&&r.length>0&&this.recursivelyAddHeaderGroups(r,e,n)},e.prototype.doAddHeaderHeader=function(t,e,n){var r=this,o=t.onNewHeaderGroupingRow(),i=0;e.forEach((function(t){var e,s=t;e=n?n({columnGroup:s,api:r.gridOptionsService.api,columnApi:r.gridOptionsService.columnApi,context:r.gridOptionsService.context}):r.columnModel.getDisplayNameForColumnGroup(s,"header");var a=s.getLeafColumns().reduce((function(t,e,n,r){var o=uo.last(t);return"open"===e.getColumnGroupShow()?o&&null==o[1]||(o=[n],t.push(o)):o&&null==o[1]&&(o[1]=n-1),n===r.length-1&&o&&null==o[1]&&(o[1]=n),t}),[]);o.onColumn(s,e||"",i++,s.getLeafColumns().length-1,a)}))},$y([$("displayedGroupCreator")],e.prototype,"displayedGroupCreator",void 0),$y([$("columnModel")],e.prototype,"columnModel",void 0),$y([$("rowModel")],e.prototype,"rowModel",void 0),$y([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),$y([$("selectionService")],e.prototype,"selectionService",void 0),$y([$("rowNodeSorter")],e.prototype,"rowNodeSorter",void 0),$y([$("sortController")],e.prototype,"sortController",void 0),e=$y([J("gridSerializer")],e)}(jt),ev={version:"30.1.0",moduleName:z.CsvExportModule,beans:[Qy,tv]},nv=function(){function t(){}return t.createHeader=function(t){void 0===t&&(t={});var e=["version"];return t.version||(t.version="1.0"),t.encoding&&e.push("encoding"),t.standalone&&e.push("standalone"),"<?xml "+e.map((function(e){return e+'="'+t[e]+'"'})).join(" ")+" ?>"},t.createXml=function(t,e){var n=this,r="";t.properties&&(t.properties.prefixedAttributes&&t.properties.prefixedAttributes.forEach((function(t){Object.keys(t.map).forEach((function(o){r+=n.returnAttributeIfPopulated(t.prefix+o,t.map[o],e)}))})),t.properties.rawMap&&Object.keys(t.properties.rawMap).forEach((function(o){r+=n.returnAttributeIfPopulated(o,t.properties.rawMap[o],e)})));var o="<"+t.name+r;return t.children||null!=t.textNode?null!=t.textNode?o+">"+t.textNode+"</"+t.name+">\r\n":(o+=">\r\n",t.children&&t.children.forEach((function(t){o+=n.createXml(t,e)})),o+"</"+t.name+">\r\n"):o+"/>\r\n"},t.returnAttributeIfPopulated=function(t,e,n){if(!e&&""!==e&&0!==e)return"";var r=e;return"boolean"===typeof e&&n&&(r=n(e))," "+t+'="'+r+'"'},t}(),rv=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ov=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),iv=function(){function t(){}return t.addFolders=function(t){t.forEach(this.addFolder.bind(this))},t.addFolder=function(t){this.folders.push({path:t,created:new Date,isBase64:!1})},t.addFile=function(t,e,n){void 0===n&&(n=!1),this.files.push({path:t,created:new Date,content:e,isBase64:n})},t.getContent=function(t){void 0===t&&(t="application/zip");var e=this.buildFileStream(),n=this.buildUint8Array(e);return this.clearStream(),new Blob([n],{type:t})},t.clearStream=function(){this.folders=[],this.files=[]},t.buildFileStream=function(t){var e,n;void 0===t&&(t="");var r=this.folders.concat(this.files),o=r.length,i="",s=0,a=0;try{for(var l=rv(r),u=l.next();!u.done;u=l.next()){var c=u.value,p=this.getHeader(c,s),h=p.fileHeader,d=p.folderHeader,f=p.content;s+=h.length+f.length,a+=d.length,t+=h+f,i+=d}}catch(g){e={error:g}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return t+i+this.buildFolderEnd(o,a,s)},t.getHeader=function(t,e){var n=t.content,r=t.path,o=t.created,i=t.isBase64,s=uo.utf8_encode,a=uo.decToHex,l=s(r),u=l!==r,c=this.convertTime(o),p=this.convertDate(o),h="";if(u){var d=a(1,1)+a(this.getFromCrc32Table(l),4)+l;h="up"+a(d.length,2)+d}var f=n?this.getConvertedContent(n,i):{size:0,content:""},g=f.size,m=f.content,y="\n\0"+(u?"\0\b":"\0\0")+"\0\0"+a(c,2)+a(p,2)+a(g?this.getFromCrc32Table(m):0,4)+a(g,4)+a(g,4)+a(l.length,2)+a(h.length,2);return{fileHeader:"PK\x03\x04"+y+l+h,folderHeader:"PK\x01\x02\x14\0"+y+"\0\0\0\0\0\0"+(n?"\0\0\0\0":"\x10\0\0\0")+a(e,4)+l+h,content:m||""}},t.getConvertedContent=function(t,e){return void 0===e&&(e=!1),e&&(t=t.split(";base64,")[1]),{size:(t=e?atob(t):t).length,content:t}},t.buildFolderEnd=function(t,e,n){var r=uo.decToHex;return"PK\x05\x06\0\0\0\0"+r(t,2)+r(t,2)+r(e,4)+r(n,4)+"\0\0"},t.buildUint8Array=function(t){for(var e=new Uint8Array(t.length),n=0;n<e.length;n++)e[n]=t.charCodeAt(n);return e},t.getFromCrc32Table=function(t){if(!t.length)return 0;for(var e=t.length,n=new Uint8Array(e),r=0;r<e;r++)n[r]=t.charCodeAt(r);var o=-1,i=0;for(r=0;r<e;r++)i=n[r],o=o>>>8^ov[255&(o^i)];return-1^o},t.convertTime=function(t){var e=t.getHours();return e<<=6,e|=t.getMinutes(),e<<=5,e|=t.getSeconds()/2},t.convertDate=function(t){var e=t.getFullYear()-1980;return e<<=4,e|=t.getMonth()+1,e<<=5,e|=t.getDate()},t.folders=[],t.files=[],t}(),sv=[Dy,Hy,ev];W.registerModules(sv)}.call(this,n(24))},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BeansContext=void 0;var o=r(n(0));e.BeansContext=o.default.createContext({})},function(t,e,n){"use strict";var r=n(15),o=Object.prototype.toString;function i(t){return"[object Array]"===o.call(t)}function s(t){return"undefined"===typeof t}function a(t){return null!==t&&"object"===typeof t}function l(t){return"[object Function]"===o.call(t)}function u(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),i(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}t.exports={isArray:i,isArrayBuffer:function(t){return"[object ArrayBuffer]"===o.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!==typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"===typeof t},isNumber:function(t){return"number"===typeof t},isObject:a,isUndefined:s,isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:l,isStream:function(t){return a(t)&&l(t.pipe)},isURLSearchParams:function(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:u,merge:function t(){var e={};function n(n,r){"object"===typeof e[r]&&"object"===typeof n?e[r]=t(e[r],n):e[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return e},deepMerge:function t(){var e={};function n(n,r){"object"===typeof e[r]&&"object"===typeof n?e[r]=t(e[r],n):e[r]="object"===typeof n?t({},n):n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return e},extend:function(t,e,n){return u(e,(function(e,o){t[o]=n&&"function"===typeof e?r(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.getNextValueIfDifferent=e.agFlushSync=e.isComponentStateless=e.CssClasses=e.classesList=void 0;var s=i(n(7));e.classesList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.filter((function(t){return null!=t&&""!==t}));return n.join(" ")};var a=function(){function t(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.classesMap={},e.forEach((function(e){t.classesMap[e]=!0}))}return t.prototype.setClass=function(e,n){if(!!this.classesMap[e]==n)return this;var o=new t;return o.classesMap=r({},this.classesMap),o.classesMap[e]=n,o},t.prototype.toString=function(){var t=this;return Object.keys(this.classesMap).filter((function(e){return t.classesMap[e]})).join(" ")},t}();e.CssClasses=a;e.isComponentStateless=function(t){return"function"===typeof t&&!(t.prototype&&t.prototype.isReactComponent)||"object"===typeof t&&t.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115)};var l=null!=s.default.createRoot&&null!=s.default.flushSync;e.agFlushSync=function(t,e){l&&t?s.default.flushSync(e):e()},e.getNextValueIfDifferent=function(t,e,n){if(null==e||null==t)return e;if(t===e||0===e.length&&0===t.length)return t;if(n||0===t.length&&e.length>0||t.length>0&&0===e.length)return e;for(var r=[],i=[],s=new Map,a=new Map,l=0;l<e.length;l++){var u=e[l];a.set(u.getInstanceId(),u)}for(l=0;l<t.length;l++){u=t[l];s.set(u.getInstanceId(),u),a.has(u.getInstanceId())&&r.push(u)}for(l=0;l<e.length;l++){var c=(u=e[l]).getInstanceId();s.has(c)||i.push(u)}return r.length===t.length&&0===i.length?t:0===r.length&&i.length===e.length?e:o(o([],r),i)}},function(t,e,n){t.exports=n(43)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createSyncJsComp=e.showJsComp=void 0;e.showJsComp=function(t,e,n,o){if(!(!t||t.componentFromFramework||e.isDestroyed())){var i=t.newAgStackInstance();if(i){var s,a,l=!1;return i.then((function(t){l?e.destroyBean(t):(a=(s=t).getGui(),n.appendChild(a),r(o,s))})),function(){l=!0,s&&(a&&a.parentElement&&a.parentElement.removeChild(a),e.destroyBean(s),o&&r(o,void 0))}}}};var r=function(t,e){t&&(t instanceof Function?t(e):t.current=e)};e.createSyncJsComp=function(t){var e=t.newAgStackInstance();if(e)return e.resolveNow(null,(function(t){return t}))}},function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}}(),t.exports=n(39)},function(t,e,n){t.exports=function(){"use strict";var t,e,n;function r(r,o){if(t)if(e){var i="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",s={};t(s),n=o(s),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(n.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"})))}else e=o;else t=o}return r(0,(function(t){var e="undefined"!=typeof self?self:{},n="2.15.0";let r;const o={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==r){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{r=null!=Object({NODE_ENV:"production",PUBLIC_URL:"/food-security-project",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_URL_REGEX?new RegExp(Object({NODE_ENV:"production",PUBLIC_URL:"/food-security-project",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).API_URL_REGEX):t}catch(e){r=t}}return r},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!o.API_URL)return null;try{const t=new URL(o.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch(t){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},i={supported:!1,testSupport:function(t){!l&&a&&(u?c(t):s=t)}};let s,a,l=!1,u=!1;function c(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.isContextLost())return;i.supported=!0}catch(t){}t.deleteTexture(e),l=!0}e.document&&(a=e.document.createElement("img"),a.onload=function(){s&&c(s),s=null,u=!0},a.onerror=function(){l=!0,s=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const p="01";function h(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var d=f;function f(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=r}f.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,r=0;r<8;r++){var o=this.sampleCurveX(n)-t;if(Math.abs(o)<e)return n;var i=this.sampleCurveDerivativeX(n);if(Math.abs(i)<1e-6)break;n-=o/i}var s=0,a=1;for(n=t,r=0;r<20&&(o=this.sampleCurveX(n),!(Math.abs(o-t)<e));r++)t>o?s=n:a=n,n=.5*(a-s)+s;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var g=h(d),m=y;function y(t,e){this.x=t,this.y=e}y.prototype={clone:function(){return new y(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},y.convert=function(t){return t instanceof y?t:Array.isArray(t)?new y(t[0],t[1]):t};var v=h(m);const _=Math.PI/180,w=180/Math.PI;function C(t){return t*_}function b(t){return t*w}const x=[[0,0],[1,0],[1,1],[0,1]];function E(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function S(t,e,n,r){const o=new g(t,e,n,r);return function(t){return o.solve(t)}}const T=S(.25,.1,.25,1);function R(t,e,n){return Math.min(n,Math.max(e,t))}function P(t,e,n){return(n=R((n-t)/(e-t),0,1))*n*(3-2*n)}function O(t,e,n){const r=n-e,o=((t-e)%r+r)%r+e;return o===e?n:o}function I(t,e,n){if(!t.length)return n(null,[]);let r=t.length;const o=new Array(t.length);let i=null;t.forEach((t,s)=>{e(t,(t,e)=>{t&&(i=t),o[s]=e,0==--r&&n(i,o)})})}function A(t){const e=[];for(const n in t)e.push(t[n]);return e}function D(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const o of n)for(const e in o)t[e]=o[e];return t}let M=1;function L(){return M++}function N(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function F(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function k(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function G(t,e){t.forEach(t=>{e[t]&&(e[t]=e[t].bind(e))})}function B(t,e){return-1!==t.indexOf(e,t.length-e.length)}function V(t,e,n){const r={};for(const o in t)r[o]=e.call(n||this,t[o],o,t);return r}function z(t,e,n){const r={};for(const o in t)e.call(n||this,t[o],o,t)&&(r[o]=t[o]);return r}function j(t){return Array.isArray(t)?t.map(j):"object"==typeof t&&t?V(t,j):t}const H={};function U(t){H[t]||("undefined"!=typeof console&&console.warn(t),H[t]=!0)}function W(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function q(t){let e=0;for(let n,r,o=0,i=t.length,s=i-1;o<i;s=o++)n=t[o],r=t[s],e+=(r.x-n.x)*(n.y+r.y);return e}function X(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function K(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(t,n,r,o)=>{const i=r||o;return e[n]=!i||i.toLowerCase(),""}),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let Y=null;function Z(t){if(null==Y){const e=t.navigator?t.navigator.userAgent:null;Y=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Y}function Q(t){try{const n=e[t];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch(t){return!1}}function J(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const $="mapbox-tiles";let tt,et,nt=500,rt=50;function ot(){try{return e.caches}catch(t){}}function it(){ot()&&!tt&&(tt=e.caches.open($))}function st(t){const e=t.indexOf("?");if(e<0)return t;const n=function(t){const e=t.indexOf("?");return e>0?t.slice(e+1).split("&"):[]}(t).filter(t=>{const e=t.split("=");return"language"===e[0]||"worldview"===e[0]});return n.length?"".concat(t.slice(0,e),"?").concat(n.join("&")):t.slice(0,e)}let at=1/0;const lt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(lt);class ut extends Error{constructor(t,e,n){401===e&&wt(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=n}toString(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}const ct=X()?()=>self.worker&&self.worker.referrer:()=>("blob:"===e.location.protocol?e.parent:e).location.href,pt=function(t,n){if(!(/^file:/.test(r=t.url)||/^file:/.test(ct())&&!/^\w+:/.test(r))){if(e.fetch&&e.Request&&e.AbortController&&e.Request.prototype.hasOwnProperty("signal"))return function(t,n){const r=new e.AbortController,o=new e.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:ct(),referrerPolicy:t.referrerPolicy,signal:r.signal});let i=!1,s=!1;const a=(l=o.url).indexOf("sku=")>0&&wt(l);var l;"json"===t.type&&o.headers.set("Accept","application/json");const u=(r,i,l)=>{if(s)return;if(r&&"SecurityError"!==r.message&&U(r.toString()),i&&l)return c(i);const u=Date.now();e.fetch(o).then(e=>{if(e.ok){const t=a?e.clone():null;return c(e,t,u)}return n(new ut(e.statusText,e.status,t.url))}).catch(e=>{"AbortError"!==e.name&&n(new Error("".concat(e.message," ").concat(t.url)))})},c=(r,a,l)=>{("arrayBuffer"===t.type?r.arrayBuffer():"json"===t.type?r.json():r.text()).then(t=>{s||(a&&l&&function(t,n,r){if(it(),!tt)return;const o={status:n.status,statusText:n.statusText,headers:new e.Headers};n.headers.forEach((t,e)=>o.headers.set(e,t));const i=K(n.headers.get("Cache-Control")||"");if(i["no-store"])return;i["max-age"]&&o.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString());const s=o.headers.get("Expires");s&&(new Date(s).getTime()-r<42e4||function(t,e){if(void 0===et)try{new Response(new ReadableStream),et=!0}catch(t){et=!1}et?e(t.body):t.blob().then(e)}(n,n=>{const r=new e.Response(n,o);it(),tt&&tt.then(e=>e.put(st(t.url),r)).catch(t=>U(t.message))}))}(o,a,l),i=!0,n(null,t,r.headers.get("Cache-Control"),r.headers.get("Expires")))}).catch(t=>{s||n(new Error(t.message))})};return a?function(t,e){if(it(),!tt)return e(null);const n=st(t.url);tt.then(t=>{t.match(n).then(r=>{const o=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),n=K(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(r);t.delete(n),o&&t.put(n,r.clone()),e(null,r,o)}).catch(e)}).catch(e)}(o,u):u(null,null),{cancel:()=>{s=!0,i||r.abort()}}}(t,n);if(X()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,n,void 0,!0)}var r;return function(t,n){const r=new e.XMLHttpRequest;r.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(r.responseType="arraybuffer");for(const e in t.headers)r.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===t.credentials,r.onerror=()=>{n(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let e=r.response;if("json"===t.type)try{e=JSON.parse(r.response)}catch(t){return n(t)}n(null,e,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else n(new ut(r.statusText,r.status,t.url))},r.send(t.body),{cancel:()=>r.abort()}}(t,n)},ht=function(t,e){return pt(D(t,{type:"arrayBuffer"}),e)};function dt(t){const n=e.document.createElement("a");return n.href=t,n.protocol===e.document.location.protocol&&n.host===e.document.location.host}const ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let gt,mt;gt=[],mt=0;const yt=function(t,n){if(i.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),mt>=o.MAX_PARALLEL_IMAGE_REQUESTS){const e={requestParameters:t,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return gt.push(e),e}mt++;let r=!1;const s=()=>{if(!r)for(r=!0,mt--;gt.length&&mt<o.MAX_PARALLEL_IMAGE_REQUESTS;){const t=gt.shift(),{requestParameters:e,callback:n,cancelled:r}=t;r||(t.cancel=yt(e,n).cancel)}},a=ht(t,(t,r,o,i)=>{s(),t?n(t):r&&(e.createImageBitmap?function(t,n){const r=new e.Blob([new Uint8Array(t)],{type:"image/png"});e.createImageBitmap(r).then(t=>{n(null,t)}).catch(t=>{n(new Error("Could not load image because of ".concat(t.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}(r,(t,e)=>n(t,e,o,i)):function(t,n){const r=new e.Image,o=e.URL;r.onload=()=>{n(null,r),o.revokeObjectURL(r.src),r.onload=null,e.requestAnimationFrame(()=>{r.src=ft})},r.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new e.Blob([new Uint8Array(t)],{type:"image/png"});r.src=t.byteLength?o.createObjectURL(i):ft}(r,(t,e)=>n(t,e,o,i)))});return{cancel:()=>{a.cancel(),s()}}},vt="NO_ACCESS_TOKEN";function _t(t){return 0===t.indexOf("mapbox:")}function wt(t){return o.API_URL_REGEX.test(t)}function Ct(t){return o.API_CDN_URL_REGEX.test(t)}function bt(t){return o.API_STYLE_REGEX.test(t)&&!xt(t)}function xt(t){return o.API_SPRITE_REGEX.test(t)}const Et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function St(t){const e=t.match(Et);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Tt(t){const e=t.params.length?"?".concat(t.params.join("&")):"";return"".concat(t.protocol,"://").concat(t.authority).concat(t.path).concat(e)}const Rt="mapbox.eventData";function Pt(t){if(!t)return null;const n=t.split(".");if(!n||3!==n.length)return null;try{return JSON.parse(decodeURIComponent(e.atob(n[1]).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(t){return null}}class Ot{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const n=Pt(o.ACCESS_TOKEN);let r="";return r=n&&n.u?e.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode(Number("0x"+e)))):o.ACCESS_TOKEN||"",t?"".concat(Rt,".").concat(t,":").concat(r):"".concat(Rt,":").concat(r)}fetchEventData(){const t=Q("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{const t=e.localStorage.getItem(n);t&&(this.eventData=JSON.parse(t));const o=e.localStorage.getItem(r);o&&(this.anonId=o)}catch(t){U("Unable to read from LocalStorage")}}saveEventData(){const t=Q("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{e.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&e.localStorage.setItem(n,JSON.stringify(this.eventData))}catch(t){U("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,e,n,r){if(!o.EVENTS_URL)return;const i=St(o.EVENTS_URL);i.params.push("access_token=".concat(r||o.ACCESS_TOKEN||""));const s={event:this.type,created:new Date(t).toISOString()},a=e?D(s,e):s,l={url:Tt(i),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=function(t,e){return pt(D(t,{method:"POST"}),e)}(l,t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(r)})}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const It=new class extends Ot{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){o.EVENTS_URL&&o.ACCESS_TOKEN&&Array.isArray(t)&&t.some(t=>_t(t)||wt(t))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Pt(o.ACCESS_TOKEN),r=e?e.u:o.ACCESS_TOKEN;let i=r!==this.eventData.tokenU;k(this.anonId)||(this.anonId=N(),i=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(s),n=(s-this.eventData.lastSuccess)/864e5;i=i||n>=1||n<-1||t.getDate()!==e.getDate()}else i=!0;i?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:p,"enabled.telemetry":!1,userId:this.anonId},t=>{t||(this.eventData.lastSuccess=s,this.eventData.tokenU=r)},t):this.processRequests()}},At=It.postTurnstileEvent.bind(It),Dt=new class extends Ot{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,r){this.skuToken=e,this.errorCb=r,o.EVENTS_URL&&(n||o.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(vt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),k(this.anonId)||(this.anonId=N()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:p,skuToken:this.skuToken,userId:this.anonId},t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t))}},Mt=Dt.postMapLoadEvent.bind(Dt),Lt=new class extends Ot{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){o.EVENTS_URL&&(t||o.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:r,performanceData:o}=this.queue.shift(),i=function(t){const r=e.performance.getEntriesByType("resource"),o=e.performance.getEntriesByType("mark"),i=function(t){const e={};if(t)for(const n in t)if("other"!==n)for(const r of t[n]){const t="".concat(n,"ResolveRangeMin"),o="".concat(n,"ResolveRangeMax"),i="".concat(n,"RequestCount"),s="".concat(n,"RequestCachedCount");e[t]=Math.min(e[t]||1/0,r.startTime),e[o]=Math.max(e[o]||-1/0,r.responseEnd);const a=t=>{void 0===e[t]&&(e[t]=0),++e[t]};void 0!==r.transferSize&&0===r.transferSize&&a(s),a(i)}return e}(function(t,e){const n={};if(t)for(const r of t){const t=e(r);void 0===n[t]&&(n[t]=[]),n[t].push(r)}return n}(r,zt)),s=e.devicePixelRatio,a=e.navigator.connection||e.navigator.mozConnection||e.navigator.webkitConnection,l={counters:[],metadata:[],attributes:[]},u=(t,e,n)=>{null!=n&&t.push({name:e,value:n.toString()})};for(const e in i)u(l.counters,e,i[e]);if(t.interactionRange[0]!==1/0&&t.interactionRange[1]!==-1/0&&(u(l.counters,"interactionRangeMin",t.interactionRange[0]),u(l.counters,"interactionRangeMax",t.interactionRange[1])),o)for(const e of Object.keys(Bt)){const t=Bt[e],n=o.find(e=>e.name===t);n&&u(l.counters,t,n.startTime)}return u(l.counters,"visibilityHidden",t.visibilityHidden),u(l.attributes,"style",function(t){if(t)for(const e of t){const t=e.name.split("?")[0];if(bt(t)){const e=t.split("/").slice(-2);if(2===e.length)return"mapbox://styles/".concat(e[0],"/").concat(e[1])}}}(r)),u(l.attributes,"terrainEnabled",t.terrainEnabled?"true":"false"),u(l.attributes,"fogEnabled",t.fogEnabled?"true":"false"),u(l.attributes,"projection",t.projection),u(l.attributes,"zoom",t.zoom),u(l.metadata,"devicePixelRatio",s),u(l.metadata,"connectionEffectiveType",a?a.effectiveType:void 0),u(l.metadata,"navigatorUserAgent",e.navigator.userAgent),u(l.metadata,"screenWidth",e.screen.width),u(l.metadata,"screenHeight",e.screen.height),u(l.metadata,"windowWidth",e.innerWidth),u(l.metadata,"windowHeight",e.innerHeight),u(l.metadata,"mapWidth",t.width/s),u(l.metadata,"mapHeight",t.height/s),u(l.metadata,"webglRenderer",t.renderer),u(l.metadata,"webglVendor",t.vendor),u(l.metadata,"sdkVersion",n),u(l.metadata,"sdkIdentifier","mapbox-gl-js"),l}(o);for(const e of i.metadata);for(const e of i.counters);for(const e of i.attributes);this.postEvent(r,i,()=>{},t)}},Nt=Lt.postPerformanceEvent.bind(Lt),Ft=new class extends Ot{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,r){if(!o.API_URL||!o.SESSION_PATH)return;const i=St(o.API_URL+o.SESSION_PATH);i.params.push("sku=".concat(e||"")),i.params.push("access_token=".concat(r||o.ACCESS_TOKEN||""));const s={url:Tt(i),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(t,e){return pt(D(t,{method:"GET"}),e)}(s,t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(r)})}getSessionAPI(t,e,n,r){this.skuToken=e,this.errorCb=r,o.SESSION_PATH&&o.API_URL&&(n||o.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(vt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t)}},kt=Ft.getSessionAPI.bind(Ft),Gt=new Set,Bt={create:"create",load:"load",fullLoad:"fullLoad"},Vt={mark(t){e.performance.mark(t)},measure(t,n,r){e.performance.measure(t,n,r)}};function zt(t){const e=t.name.split("?")[0];return Ct(e)&&e.includes("mapbox-gl.js")?"javascript":Ct(e)&&e.includes("mapbox-gl.css")?"css":function(t){return o.API_FONTS_REGEX.test(t)}(e)?"fontRange":xt(e)?"sprite":bt(e)?"style":function(t){return o.API_TILEJSON_REGEX.test(t)}(e)?"tilejson":"other"}const jt=e.performance;function Ht(t){const e=t?t.url.toString():void 0;return jt.getEntriesByName(e)}let Ut,Wt,qt,Xt;const Kt={now:()=>void 0!==qt?qt:e.performance.now(),setNow(t){qt=t},restoreNow(){qt=void 0},frame(t){const n=e.requestAnimationFrame(t);return{cancel:()=>e.cancelAnimationFrame(n)}},getImageData(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:r,height:o}=t;Xt||(Xt=e.document.createElement("canvas"));const i=Xt.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return(r>Xt.width||o>Xt.height)&&(Xt.width=r,Xt.height=o),i.clearRect(-n,-n,r+2*n,o+2*n),i.drawImage(t,0,0,r,o),i.getImageData(-n,-n,r+2*n,o+2*n)},resolveURL:t=>(Ut||(Ut=e.document.createElement("a")),Ut.href=t,Ut.href),get devicePixelRatio(){return e.devicePixelRatio},get prefersReducedMotion(){return!!e.matchMedia&&(null==Wt&&(Wt=e.matchMedia("(prefers-reduced-motion: reduce)")),Wt.matches)}};function Yt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Zt(t,e,n){if(n&&n[t]){const r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}class Qt{constructor(t){D(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=t}}class Jt extends Qt{constructor(t){super("error",D({error:t},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class $t{on(t,e){return this._listeners=this._listeners||{},Yt(t,e,this._listeners),this}off(t,e){return Zt(t,e,this._listeners),Zt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Yt(t,e,this._oneTimeListeners),this):new Promise(e=>this.once(t,e))}fire(t,e){"string"==typeof t&&(t=new Qt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const r=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const i of r)Zt(n,i,this._oneTimeListeners),i.call(this,t);const o=this._eventedParent;o&&(D(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),o.fire(t))}else t instanceof Jt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var te=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ee(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const o of n)for(const e in o)t[e]=o[e];return t}function ne(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function re(t){if(Array.isArray(t))return t.map(re);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=re(t[n]);return e}return ne(t)}class oe extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}var ie=oe;class se{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=t,this.bindings={};for(const[n,r]of e)this.bindings[n]=r}concat(t){return new se(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error("".concat(t," not found in scope."))}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var ae=se;const le={kind:"null"},ue={kind:"number"},ce={kind:"string"},pe={kind:"boolean"},he={kind:"color"},de={kind:"object"},fe={kind:"value"},ge={kind:"collator"},me={kind:"formatted"},ye={kind:"resolvedImage"};function ve(t,e){return{kind:"array",itemType:t,N:e}}function _e(t){if("array"===t.kind){const e=_e(t.itemType);return"number"==typeof t.N?"array<".concat(e,", ").concat(t.N,">"):"value"===t.itemType.kind?"array":"array<".concat(e,">")}return t.kind}const we=[le,ue,ce,pe,he,me,de,ve(fe),ye];function Ce(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Ce(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of we)if(!Ce(t,e))return null}return"Expected ".concat(_e(t)," but found ").concat(_e(e)," instead.")}function be(t,e){return e.some(e=>e.kind===t.kind)}function xe(t,e){return e.some(e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t)}var Ee,Se={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Te(t){return(t=Math.round(t))<0?0:t>255?255:t}function Re(t){return Te("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Pe(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Oe(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Ee={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Se)return Se[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var r=n.indexOf("("),o=n.indexOf(")");if(-1!==r&&o+1===n.length){var i=n.substr(0,r),s=n.substr(r+1,o-(r+1)).split(","),a=1;switch(i){case"rgba":if(4!==s.length)return null;a=Pe(s.pop());case"rgb":return 3!==s.length?null:[Re(s[0]),Re(s[1]),Re(s[2]),a];case"hsla":if(4!==s.length)return null;a=Pe(s.pop());case"hsl":if(3!==s.length)return null;var l=(parseFloat(s[0])%360+360)%360/360,u=Pe(s[1]),c=Pe(s[2]),p=c<=.5?c*(u+1):c+u-c*u,h=2*c-p;return[Te(255*Oe(h,p,l+1/3)),Te(255*Oe(h,p,l)),Te(255*Oe(h,p,l-1/3)),a];default:return null}}return null}}catch(t){}class Ie{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.r=t,this.g=e,this.b=n,this.a=r}static parse(t){if(!t)return;if(t instanceof Ie)return t;if("string"!=typeof t)return;const e=Ee(t);return e?new Ie(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,r]=this.toArray();return"rgba(".concat(Math.round(t),",").concat(Math.round(e),",").concat(Math.round(n),",").concat(r,")")}toArray(){const{r:t,g:e,b:n,a:r}=this;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]}toArray01(){const{r:t,g:e,b:n,a:r}=this;return 0===r?[0,0,0,0]:[t/r,e/r,n/r,r]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:n,a:r}=this;return[t,e,n,r]}}Ie.black=new Ie(0,0,0,1),Ie.white=new Ie(1,1,1,1),Ie.transparent=new Ie(0,0,0,0),Ie.red=new Ie(1,0,0,1),Ie.blue=new Ie(0,0,1,1);var Ae=Ie;class De{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Me{constructor(t,e,n,r,o){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=n,this.fontStack=r,this.textColor=o}}class Le{constructor(t){this.sections=t}static fromString(t){return new Le([new Me(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof Le?t:Le.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class Ne{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ne({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Fe(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value [".concat([t,e,n,r].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function ke(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Ae)return!0;if(t instanceof De)return!0;if(t instanceof Le)return!0;if(t instanceof Ne)return!0;if(Array.isArray(t)){for(const e of t)if(!ke(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ke(t[e]))return!1;return!0}return!1}function Ge(t){if(null===t)return le;if("string"==typeof t)return ce;if("boolean"==typeof t)return pe;if("number"==typeof t)return ue;if(t instanceof Ae)return he;if(t instanceof De)return ge;if(t instanceof Le)return me;if(t instanceof Ne)return ye;if(Array.isArray(t)){const e=t.length;let n;for(const r of t){const t=Ge(r);if(n){if(n===t)continue;n=fe;break}n=t}return ve(n||fe,e)}return de}function Be(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Ae||t instanceof Le||t instanceof Ne?t.toString():JSON.stringify(t)}class Ve{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!ke(t[1]))return e.error("invalid value");const n=t[1];let r=Ge(n);const o=e.expectedType;return"array"!==r.kind||0!==r.N||!o||"array"!==o.kind||"number"==typeof o.N&&0!==o.N||(r=o),new Ve(r,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Ae?["rgba"].concat(this.value.toArray()):this.value instanceof Le?this.value.serialize():this.value}}var ze=Ve,je=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const He={string:ce,number:ue,boolean:pe,object:de};class Ue{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,r=1;const o=t[0];if("array"===o){let o,i;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in He)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=He[n],r++}else o=fe;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);i=t[2],r++}n=ve(o,i)}else n=He[o];const i=[];for(;r<t.length;r++){const n=e.parse(t[r],r,fe);if(!n)return null;i.push(n)}return new Ue(n,i)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!Ce(this.type,Ge(n)))return n;if(e===this.args.length-1)throw new je("Expected value to be of type ".concat(_e(this.type),", but found ").concat(_e(Ge(n))," instead."))}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map(t=>t.serialize()))}}var We=Ue;class qe{constructor(t){this.type=me,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const r=[];let o=!1;for(let i=1;i<=t.length-1;++i){const n=t[i];if(o&&"object"==typeof n&&!Array.isArray(n)){o=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,ue),!t))return null;let i=null;if(n["text-font"]&&(i=e.parse(n["text-font"],1,ve(ce)),!i))return null;let s=null;if(n["text-color"]&&(s=e.parse(n["text-color"],1,he),!s))return null;const a=r[r.length-1];a.scale=t,a.font=i,a.textColor=s}else{const n=e.parse(t[i],1,fe);if(!n)return null;const s=n.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,r.push({content:n,scale:null,font:null,textColor:null})}}return new qe(r)}evaluate(t){return new Le(this.sections.map(e=>{const n=e.content.evaluate(t);return Ge(n)===ye?new Me("",n,null,null,null):new Me(Be(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Xe{constructor(t){this.type=ye,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ce);return n?new Xe(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=Ne.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ke={"to-boolean":pe,"to-color":he,"to-number":ue,"to-string":ce};class Ye{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const r=Ke[n],o=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],i,fe);if(!n)return null;o.push(n)}return new Ye(r,o)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const r of this.args){if(e=r.evaluate(t),n=null,e instanceof Ae)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?"Invalid rbga value ".concat(JSON.stringify(e),": expected an array containing either three or four numeric values."):Fe(e[0],e[1],e[2],e[3]),!n))return new Ae(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new je(n||"Could not parse color from value '".concat("string"==typeof e?e:String(JSON.stringify(e)),"'"))}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new je("Could not convert ".concat(JSON.stringify(e)," to number."))}return"formatted"===this.type.kind?Le.fromString(Be(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Ne.fromString(Be(this.args[0].evaluate(t))):Be(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new qe([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Xe(this.args[0]).serialize();const t=["to-".concat(this.type.kind)];return this.eachChild(e=>{t.push(e.serialize())}),t}}var Ze=Ye;const Qe=["Unknown","Point","LineString","Polygon"];var Je=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Qe[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:r}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(r*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Ae.parse(t)),e}};class $e{constructor(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const n=t[0],r=$e.definitions[n];if(!r)return e.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);const o=Array.isArray(r)?r[0]:r.type,i=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,s=i.filter(e=>{let[n]=e;return!Array.isArray(n)||n.length===t.length-1});let a=null;for(const[l,u]of s){a=new Rn(e.registry,e.path,null,e.scope);const r=[];let i=!1;for(let e=1;e<t.length;e++){const n=t[e],o=Array.isArray(l)?l[e-1]:l.type,s=a.parse(n,1+r.length,o);if(!s){i=!0;break}r.push(s)}if(!i)if(Array.isArray(l)&&l.length!==r.length)a.error("Expected ".concat(l.length," arguments, but found ").concat(r.length," instead."));else{for(let t=0;t<r.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=r[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new $e(n,o,u,r)}}if(1===s.length)e.errors.push(...a.errors);else{const n=(s.length?s:i).map(t=>{let[e]=t;return n=e,Array.isArray(n)?"(".concat(n.map(_e).join(", "),")"):"(".concat(_e(n.type),"...)");var n}).join(" | "),r=[];for(let o=1;o<t.length;o++){const n=e.parse(t[o],1+r.length);if(!n)return null;r.push(_e(n.type))}e.error("Expected arguments of type ".concat(n,", but found (").concat(r.join(", "),") instead."))}return null}static register(t,e){$e.definitions=e;for(const n in e)t[n]=$e}}var tn=$e;class en{constructor(t,e,n){this.type=ge,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,pe);if(!r)return null;const o=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,pe);if(!o)return null;let i=null;return n.locale&&(i=e.parse(n.locale,1,ce),!i)?null:new en(r,o,i)}evaluate(t){return new De(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const nn=8192;function rn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function on(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function sn(t,e){const n=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,o=Math.pow(2,e.z);return[Math.round(n*o*nn),Math.round(r*o*nn)]}function an(t,e,n){const r=t[0]-e[0],o=t[1]-e[1],i=t[0]-n[0],s=t[1]-n[1];return r*s-i*o==0&&r*i<=0&&o*s<=0}function ln(t,e){let n=!1;for(let s=0,a=e.length;s<a;s++){const a=e[s];for(let e=0,s=a.length;e<s-1;e++){if(an(t,a[e],a[e+1]))return!1;(o=a[e])[1]>(r=t)[1]!=(i=a[e+1])[1]>r[1]&&r[0]<(i[0]-o[0])*(r[1]-o[1])/(i[1]-o[1])+o[0]&&(n=!n)}}var r,o,i;return n}function un(t,e){for(let n=0;n<e.length;n++)if(ln(t,e[n]))return!0;return!1}function cn(t,e,n,r){const o=r[0]-n[0],i=r[1]-n[1],s=(t[0]-n[0])*i-o*(t[1]-n[1]),a=(e[0]-n[0])*i-o*(e[1]-n[1]);return s>0&&a<0||s<0&&a>0}function pn(t,e,n){for(const u of n)for(let n=0;n<u.length-1;++n)if(0!=(a=[(s=u[n+1])[0]-(i=u[n])[0],s[1]-i[1]])[0]*(l=[(o=e)[0]-(r=t)[0],o[1]-r[1]])[1]-a[1]*l[0]&&cn(r,o,i,s)&&cn(i,s,r,o))return!0;var r,o,i,s,a,l;return!1}function hn(t,e){for(let n=0;n<t.length;++n)if(!ln(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(pn(t[n],t[n+1],e))return!1;return!0}function dn(t,e){for(let n=0;n<e.length;n++)if(hn(t,e[n]))return!0;return!1}function fn(t,e,n){const r=[];for(let o=0;o<t.length;o++){const i=[];for(let r=0;r<t[o].length;r++){const s=sn(t[o][r],n);rn(e,s),i.push(s)}r.push(i)}return r}function gn(t,e,n){const r=[];for(let o=0;o<t.length;o++){const i=fn(t[o],e,n);r.push(i)}return r}function mn(t,e,n,r){if(t[0]<n[0]||t[0]>n[2]){const e=.5*r;let o=t[0]-n[0]>e?-r:n[0]-t[0]>e?r:0;0===o&&(o=t[0]-n[2]>e?-r:n[2]-t[0]>e?r:0),t[0]+=o}rn(e,t)}function yn(t,e,n,r){const o=Math.pow(2,r.z)*nn,i=[r.x*nn,r.y*nn],s=[];if(!t)return s;for(const a of t)for(const t of a){const r=[t.x+i[0],t.y+i[1]];mn(r,e,n,o),s.push(r)}return s}function vn(t,e,n,r){const o=Math.pow(2,r.z)*nn,i=[r.x*nn,r.y*nn],s=[];if(!t)return s;for(const l of t){const t=[];for(const n of l){const r=[n.x+i[0],n.y+i[1]];rn(e,r),t.push(r)}s.push(t)}if(e[2]-e[0]<=o/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const r of t)mn(r,e,n,o)}var a;return s}class _n{constructor(t,e){this.type=pe,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(ke(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new _n(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new _n(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new _n(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],o=t.canonicalID();if(!o)return!1;if("Polygon"===e.type){const i=fn(e.coordinates,r,o),s=yn(t.geometry(),n,r,o);if(!on(n,r))return!1;for(const t of s)if(!ln(t,i))return!1}if("MultiPolygon"===e.type){const i=gn(e.coordinates,r,o),s=yn(t.geometry(),n,r,o);if(!on(n,r))return!1;for(const t of s)if(!un(t,i))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],o=t.canonicalID();if(!o)return!1;if("Polygon"===e.type){const i=fn(e.coordinates,r,o),s=vn(t.geometry(),n,r,o);if(!on(n,r))return!1;for(const t of s)if(!hn(t,i))return!1}if("MultiPolygon"===e.type){const i=gn(e.coordinates,r,o),s=vn(t.geometry(),n,r,o);if(!on(n,r))return!1;for(const t of s)if(!dn(t,i))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var wn=_n;function Cn(t){if(t instanceof tn){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof wn)return!1;let e=!0;return t.eachChild(t=>{e&&!Cn(t)&&(e=!1)}),e}function bn(t){if(t instanceof tn&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(t=>{e&&!bn(t)&&(e=!1)}),e}function xn(t,e){if(t instanceof tn&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(t=>{n&&!xn(t,e)&&(n=!1)}),n}class En{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new En(n,e.scope.get(n)):e.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Sn=En;class Tn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ae,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.registry=t,this.path=e,this.key=e.map(t=>"[".concat(t,"]")).join(""),this.scope=r,this.errors=o,this.expectedType=n}parse(t,e,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e?this.concat(e,n,r)._parse(t,o):this._parse(t,o)}_parse(t,e){function n(t,e,n){return"assert"===n?new We(e,[t]):"coerce"===n?new Ze(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found ".concat(typeof r,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;const o=this.registry[r];if(o){let r=o.parse(t,this);if(!r)return null;if(this.expectedType){const t=this.expectedType,o=r.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==o.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==o.kind&&"string"!==o.kind){if(this.checkSubtype(t,o))return null}else r=n(r,t,e.typeAnnotation||"coerce");else r=n(r,t,e.typeAnnotation||"assert")}if(!(r instanceof ze)&&"resolvedImage"!==r.type.kind&&function t(e){if(e instanceof Sn)return t(e.boundExpression);if(e instanceof tn&&"error"===e.name)return!1;if(e instanceof en)return!1;if(e instanceof wn)return!1;const n=e instanceof Ze||e instanceof We;let r=!0;return e.eachChild(e=>{r=n?r&&t(e):r&&e instanceof ze}),!!r&&Cn(e)&&xn(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}(r)){const e=new Je;try{r=new ze(r.type,r.evaluate(e))}catch(t){return this.error(t.message),null}}return r}return this.error('Unknown expression "'.concat(r,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof t," instead."))}concat(t,e,n){const r="number"==typeof t?this.path.concat(t):this.path,o=n?this.scope.concat(n):this.scope;return new Tn(this.registry,r,e||null,o,this.errors)}error(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const o="".concat(this.key).concat(n.map(t=>"[".concat(t,"]")).join(""));this.errors.push(new ie(o,t))}checkSubtype(t,e){const n=Ce(t,e);return n&&this.error(n),n}}var Rn=Tn;function Pn(t,e){const n=t.length-1;let r,o,i=0,s=n,a=0;for(;i<=s;)if(a=Math.floor((i+s)/2),r=t[a],o=t[a+1],r<=e){if(a===n||e<o)return a;i=a+1}else{if(!(r>e))throw new je("Input is not a number.");s=a-1}return 0}class On{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[r,o]of n)this.labels.push(r),this.outputs.push(o)}static parse(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,ue);if(!n)return null;const r=[];let o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType);for(let i=1;i<t.length;i+=2){const n=1===i?-1/0:t[i],s=t[i+1],a=i,l=i+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(r.length&&r[r.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const u=e.parse(s,l,o);if(!u)return null;o=o||u.type,r.push([n,u])}return new On(o,n,r)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);const o=e.length;return r>=e[o-1]?n[o-1].evaluate(t):n[Pn(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var In=On;function An(t,e,n){return t*(1-n)+e*n}var Dn=Object.freeze({__proto__:null,array:function(t,e,n){return t.map((t,r)=>An(t,e[r],n))},color:function(t,e,n){return new Ae(An(t.r,e.r,n),An(t.g,e.g,n),An(t.b,e.b,n),An(t.a,e.a,n))},number:An});const Mn=6/29,Ln=3*Mn*Mn,Nn=Math.PI/180,Fn=180/Math.PI;function kn(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ln+4/29}function Gn(t){return t>Mn?t*t*t:Ln*(t-4/29)}function Bn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Vn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function zn(t){const e=Vn(t.r),n=Vn(t.g),r=Vn(t.b),o=kn((.4124564*e+.3575761*n+.1804375*r)/.95047),i=kn((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*i-16,a:500*(o-i),b:200*(i-kn((.0193339*e+.119192*n+.9503041*r)/1.08883)),alpha:t.a}}function jn(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=1*Gn(e),n=.95047*Gn(n),r=1.08883*Gn(r),new Ae(Bn(3.2404542*n-1.5371385*e-.4985314*r),Bn(-.969266*n+1.8760108*e+.041556*r),Bn(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function Hn(t,e,n){const r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}const Un={forward:zn,reverse:jn,interpolate:function(t,e,n){return{l:An(t.l,e.l,n),a:An(t.a,e.a,n),b:An(t.b,e.b,n),alpha:An(t.alpha,e.alpha,n)}}},Wn={forward:function(t){const{l:e,a:n,b:r}=zn(t),o=Math.atan2(r,n)*Fn;return{h:o<0?o+360:o,c:Math.sqrt(n*n+r*r),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Nn,n=t.c;return jn({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Hn(t.h,e.h,n),c:An(t.c,e.c,n),l:An(t.l,e.l,n),alpha:An(t.alpha,e.alpha,n)}}};var qn=Object.freeze({__proto__:null,hcl:Wn,lab:Un});class Xn{constructor(t,e,n,r,o){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(const[i,s]of o)this.labels.push(i),this.outputs.push(s)}static interpolationFactor(t,e,n,r){let o=0;if("exponential"===t.name)o=Kn(e,t.base,n,r);else if("linear"===t.name)o=Kn(e,1,n,r);else if("cubic-bezier"===t.name){const i=t.controlPoints;o=new g(i[0],i[1],i[2],i[3]).solve(Kn(e,1,n,r))}return o}static parse(t,e){let[n,r,o,...i]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const t=r[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:t}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type ".concat(String(r[0])),1,0);{const t=r.slice(1);if(4!==t.length||t.some(t=>"number"!=typeof t||t<0||t>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(o=e.parse(o,2,ue),!o)return null;const s=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=he:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let l=0;l<i.length;l+=2){const t=i[l],n=i[l+1],r=l+3,o=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(s.length&&s[s.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const u=e.parse(n,o,a);if(!u)return null;a=a||u.type,s.push([t,u])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Xn(a,n,r,o,s):e.error("Type ".concat(_e(a)," is not interpolatable."))}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);const o=e.length;if(r>=e[o-1])return n[o-1].evaluate(t);const i=Pn(e,r),s=Xn.interpolationFactor(this.interpolation,r,e[i],e[i+1]),a=n[i].evaluate(t),l=n[i+1].evaluate(t);return"interpolate"===this.operator?Dn[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?Wn.reverse(Wn.interpolate(Wn.forward(a),Wn.forward(l),s)):Un.reverse(Un.interpolate(Un.forward(a),Un.forward(l),s))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e}}function Kn(t,e,n,r){const o=r-n,i=t-n;return 0===o?0:1===e?i/o:(Math.pow(e,i)-1)/(Math.pow(e,o)-1)}var Yn=Xn;class Zn{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const r=e.expectedType;r&&"value"!==r.kind&&(n=r);const o=[];for(const s of t.slice(1)){const t=e.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,o.push(t)}const i=r&&o.some(t=>Ce(r,t.type));return new Zn(i?fe:n,o)}evaluate(t){let e,n=null,r=0;for(const o of this.args){if(r++,n=o.evaluate(t),n&&n instanceof Ne&&!n.available&&(e||(e=n),n=null,r===this.args.length))return e;if(null!==n)break}return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}var Qn=Zn;class Jn{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));const n=[];for(let o=1;o<t.length-1;o+=2){const r=t[o];if("string"!=typeof r)return e.error("Expected string, but found ".concat(typeof r," instead."),o);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",o);const i=e.parse(t[o+1],o+1);if(!i)return null;n.push([r,i])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return r?new Jn(n,r):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}var $n=Jn;class tr{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,ue),r=e.parse(t[2],2,ve(e.expectedType||fe));return n&&r?new tr(r.type.itemType,n,r):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new je("Array index out of bounds: ".concat(e," < 0."));if(e>=n.length)throw new je("Array index out of bounds: ".concat(e," > ").concat(n.length-1,"."));if(e!==Math.floor(e))throw new je("Array index must be an integer, but found ".concat(e," instead."));return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var er=tr;class nr{constructor(t,e){this.type=pe,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,fe),r=e.parse(t[2],2,fe);return n&&r?be(n.type,[pe,ce,ue,le,fe])?new nr(n,r):e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(n.type)," instead")):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(null==n)return!1;if(!xe(e,["boolean","string","number","null"]))throw new je("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(Ge(e))," instead."));if(!xe(n,["string","array"]))throw new je("Expected second argument to be of type array or string, but found ".concat(_e(Ge(n))," instead."));return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var rr=nr;class or{constructor(t,e,n){this.type=ue,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,fe),r=e.parse(t[2],2,fe);if(!n||!r)return null;if(!be(n.type,[pe,ce,ue,le,fe]))return e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(n.type)," instead"));if(4===t.length){const o=e.parse(t[3],3,ue);return o?new or(n,r,o):null}return new or(n,r)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!xe(e,["boolean","string","number","null"]))throw new je("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(Ge(e))," instead."));if(!xe(n,["string","array"]))throw new je("Expected second argument to be of type array or string, but found ".concat(_e(Ge(n))," instead."));if(this.fromIndex){const r=this.fromIndex.evaluate(t);return n.indexOf(e,r)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var ir=or;class sr{constructor(t,e,n,r,o,i){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=o,this.otherwise=i}static parse(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const o={},i=[];for(let l=2;l<t.length-1;l+=2){let s=t[l];const a=t[l+1];Array.isArray(s)||(s=[s]);const u=e.concat(l);if(0===s.length)return u.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,Ge(t)))return null}else n=Ge(t);if(void 0!==o[String(t)])return u.error("Branch labels must be unique.");o[String(t)]=i.length}const c=e.parse(a,l,r);if(!c)return null;r=r||c.type,i.push(c)}const s=e.parse(t[1],1,fe);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,r);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(n,s.type)?null:new sr(n,r,s,o,i,a):null}evaluate(t){const e=this.input.evaluate(t);return(Ge(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],r={};for(const i of e){const t=r[this.cases[i]];void 0===t?(r[this.cases[i]]=n.length,n.push([this.cases[i],[i]])):n[t][1].push(i)}const o=t=>"number"===this.inputType.kind?Number(t):t;for(const[i,s]of n)t.push(1===s.length?o(s[0]):s.map(o)),t.push(this.outputs[i].serialize());return t.push(this.otherwise.serialize()),t}}var ar=sr;class lr{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const r=[];for(let i=1;i<t.length-1;i+=2){const o=e.parse(t[i],i,pe);if(!o)return null;const s=e.parse(t[i+1],i+1,n);if(!s)return null;r.push([o,s]),n=n||s.type}const o=e.parse(t[t.length-1],t.length-1,n);return o?new lr(n,r,o):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every(t=>{let[e,n]=t;return n.outputDefined()})&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}var ur=lr;class cr{constructor(t,e,n,r){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,fe),r=e.parse(t[2],2,ue);if(!n||!r)return null;if(!be(n.type,[ve(fe),ce,fe]))return e.error("Expected first argument to be of type array or string, but found ".concat(_e(n.type)," instead"));if(4===t.length){const o=e.parse(t[3],3,ue);return o?new cr(n.type,n,r,o):null}return new cr(n.type,n,r)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!xe(e,["string","array"]))throw new je("Expected first argument to be of type array or string, but found ".concat(_e(Ge(e))," instead."));if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(n,r)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var pr=cr;function hr(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function dr(t,e,n,r){return 0===r.compare(e,n)}function fr(t,e,n){const r="=="!==t&&"!="!==t;return class o{constructor(t,e,n){this.type=pe,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let i=e.parse(t[1],1,fe);if(!i)return null;if(!hr(n,i.type))return e.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(_e(i.type),"'."));let s=e.parse(t[2],2,fe);if(!s)return null;if(!hr(n,s.type))return e.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(_e(s.type),"'."));if(i.type.kind!==s.type.kind&&"value"!==i.type.kind&&"value"!==s.type.kind)return e.error("Cannot compare types '".concat(_e(i.type),"' and '").concat(_e(s.type),"'."));r&&("value"===i.type.kind&&"value"!==s.type.kind?i=new We(s.type,[i]):"value"!==i.type.kind&&"value"===s.type.kind&&(s=new We(i.type,[s])));let a=null;if(4===t.length){if("string"!==i.type.kind&&"string"!==s.type.kind&&"value"!==i.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,ge),!a)return null}return new o(i,s,a)}evaluate(o){const i=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(r&&this.hasUntypedArgument){const e=Ge(i),n=Ge(s);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new je('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(e.kind,", ").concat(n.kind,") instead."))}if(this.collator&&!r&&this.hasUntypedArgument){const t=Ge(i),n=Ge(s);if("string"!==t.kind||"string"!==n.kind)return e(o,i,s)}return this.collator?n(o,i,s,this.collator.evaluate(o)):e(o,i,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild(t=>{e.push(t.serialize())}),e}}}const gr=fr("==",(function(t,e,n){return e===n}),dr),mr=fr("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!dr(0,e,n,r)})),yr=fr("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),vr=fr(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),_r=fr("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),wr=fr(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0}));class Cr{constructor(t,e,n,r,o,i){this.type=ce,this.number=t,this.locale=e,this.currency=n,this.unit=r,this.minFractionDigits=o,this.maxFractionDigits=i}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ue);if(!n)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let o=null;if(r.locale&&(o=e.parse(r.locale,1,ce),!o))return null;let i=null;if(r.currency&&(i=e.parse(r.currency,1,ce),!i))return null;let s=null;if(r.unit&&(s=e.parse(r.unit,1,ce),!s))return null;let a=null;if(r["min-fraction-digits"]&&(a=e.parse(r["min-fraction-digits"],1,ue),!a))return null;let l=null;return r["max-fraction-digits"]&&(l=e.parse(r["max-fraction-digits"],1,ue),!l)?null:new Cr(n,o,i,s,a,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class br{constructor(t){this.type=ue,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found ".concat(_e(n.type)," instead.")):new br(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new je("Expected value to be of type string or array, but found ".concat(_e(Ge(e))," instead."))}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const xr={"==":gr,"!=":mr,">":vr,"<":yr,">=":wr,"<=":_r,array:We,at:er,boolean:We,case:ur,coalesce:Qn,collator:en,format:qe,image:Xe,in:rr,"index-of":ir,interpolate:Yn,"interpolate-hcl":Yn,"interpolate-lab":Yn,length:br,let:$n,literal:ze,match:ar,number:We,"number-format":Cr,object:We,slice:pr,step:In,string:We,"to-boolean":Ze,"to-color":Ze,"to-number":Ze,"to-string":Ze,var:Sn,within:wn};function Er(t,e){let[n,r,o,i]=e;n=n.evaluate(t),r=r.evaluate(t),o=o.evaluate(t);const s=i?i.evaluate(t):1,a=Fe(n,r,o,s);if(a)throw new je(a);return new Ae(n/255*s,r/255*s,o/255*s,s)}function Sr(t,e){return t in e}function Tr(t,e){const n=e[t];return void 0===n?null:n}function Rr(t){return{type:t}}tn.register(xr,{error:[{kind:"error"},[ce],(t,e)=>{let[n]=e;throw new je(n.evaluate(t))}],typeof:[ce,[fe],(t,e)=>{let[n]=e;return _e(Ge(n.evaluate(t)))}],"to-rgba":[ve(ue,4),[he],(t,e)=>{let[n]=e;return n.evaluate(t).toArray()}],rgb:[he,[ue,ue,ue],Er],rgba:[he,[ue,ue,ue,ue],Er],has:{type:pe,overloads:[[[ce],(t,e)=>{let[n]=e;return Sr(n.evaluate(t),t.properties())}],[[ce,de],(t,e)=>{let[n,r]=e;return Sr(n.evaluate(t),r.evaluate(t))}]]},get:{type:fe,overloads:[[[ce],(t,e)=>{let[n]=e;return Tr(n.evaluate(t),t.properties())}],[[ce,de],(t,e)=>{let[n,r]=e;return Tr(n.evaluate(t),r.evaluate(t))}]]},"feature-state":[fe,[ce],(t,e)=>{let[n]=e;return Tr(n.evaluate(t),t.featureState||{})}],properties:[de,[],t=>t.properties()],"geometry-type":[ce,[],t=>t.geometryType()],id:[fe,[],t=>t.id()],zoom:[ue,[],t=>t.globals.zoom],pitch:[ue,[],t=>t.globals.pitch||0],"distance-from-center":[ue,[],t=>t.distanceFromCenter()],"heatmap-density":[ue,[],t=>t.globals.heatmapDensity||0],"line-progress":[ue,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[ue,[],t=>t.globals.skyRadialProgress||0],accumulated:[fe,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[ue,Rr(ue),(t,e)=>{let n=0;for(const r of e)n+=r.evaluate(t);return n}],"*":[ue,Rr(ue),(t,e)=>{let n=1;for(const r of e)n*=r.evaluate(t);return n}],"-":{type:ue,overloads:[[[ue,ue],(t,e)=>{let[n,r]=e;return n.evaluate(t)-r.evaluate(t)}],[[ue],(t,e)=>{let[n]=e;return-n.evaluate(t)}]]},"/":[ue,[ue,ue],(t,e)=>{let[n,r]=e;return n.evaluate(t)/r.evaluate(t)}],"%":[ue,[ue,ue],(t,e)=>{let[n,r]=e;return n.evaluate(t)%r.evaluate(t)}],ln2:[ue,[],()=>Math.LN2],pi:[ue,[],()=>Math.PI],e:[ue,[],()=>Math.E],"^":[ue,[ue,ue],(t,e)=>{let[n,r]=e;return Math.pow(n.evaluate(t),r.evaluate(t))}],sqrt:[ue,[ue],(t,e)=>{let[n]=e;return Math.sqrt(n.evaluate(t))}],log10:[ue,[ue],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))/Math.LN10}],ln:[ue,[ue],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))}],log2:[ue,[ue],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))/Math.LN2}],sin:[ue,[ue],(t,e)=>{let[n]=e;return Math.sin(n.evaluate(t))}],cos:[ue,[ue],(t,e)=>{let[n]=e;return Math.cos(n.evaluate(t))}],tan:[ue,[ue],(t,e)=>{let[n]=e;return Math.tan(n.evaluate(t))}],asin:[ue,[ue],(t,e)=>{let[n]=e;return Math.asin(n.evaluate(t))}],acos:[ue,[ue],(t,e)=>{let[n]=e;return Math.acos(n.evaluate(t))}],atan:[ue,[ue],(t,e)=>{let[n]=e;return Math.atan(n.evaluate(t))}],min:[ue,Rr(ue),(t,e)=>Math.min(...e.map(e=>e.evaluate(t)))],max:[ue,Rr(ue),(t,e)=>Math.max(...e.map(e=>e.evaluate(t)))],abs:[ue,[ue],(t,e)=>{let[n]=e;return Math.abs(n.evaluate(t))}],round:[ue,[ue],(t,e)=>{let[n]=e;const r=n.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[ue,[ue],(t,e)=>{let[n]=e;return Math.floor(n.evaluate(t))}],ceil:[ue,[ue],(t,e)=>{let[n]=e;return Math.ceil(n.evaluate(t))}],"filter-==":[pe,[ce,fe],(t,e)=>{let[n,r]=e;return t.properties()[n.value]===r.value}],"filter-id-==":[pe,[fe],(t,e)=>{let[n]=e;return t.id()===n.value}],"filter-type-==":[pe,[ce],(t,e)=>{let[n]=e;return t.geometryType()===n.value}],"filter-<":[pe,[ce,fe],(t,e)=>{let[n,r]=e;const o=t.properties()[n.value],i=r.value;return typeof o==typeof i&&o<i}],"filter-id-<":[pe,[fe],(t,e)=>{let[n]=e;const r=t.id(),o=n.value;return typeof r==typeof o&&r<o}],"filter->":[pe,[ce,fe],(t,e)=>{let[n,r]=e;const o=t.properties()[n.value],i=r.value;return typeof o==typeof i&&o>i}],"filter-id->":[pe,[fe],(t,e)=>{let[n]=e;const r=t.id(),o=n.value;return typeof r==typeof o&&r>o}],"filter-<=":[pe,[ce,fe],(t,e)=>{let[n,r]=e;const o=t.properties()[n.value],i=r.value;return typeof o==typeof i&&o<=i}],"filter-id-<=":[pe,[fe],(t,e)=>{let[n]=e;const r=t.id(),o=n.value;return typeof r==typeof o&&r<=o}],"filter->=":[pe,[ce,fe],(t,e)=>{let[n,r]=e;const o=t.properties()[n.value],i=r.value;return typeof o==typeof i&&o>=i}],"filter-id->=":[pe,[fe],(t,e)=>{let[n]=e;const r=t.id(),o=n.value;return typeof r==typeof o&&r>=o}],"filter-has":[pe,[fe],(t,e)=>{let[n]=e;return n.value in t.properties()}],"filter-has-id":[pe,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[pe,[ve(ce)],(t,e)=>{let[n]=e;return n.value.indexOf(t.geometryType())>=0}],"filter-id-in":[pe,[ve(fe)],(t,e)=>{let[n]=e;return n.value.indexOf(t.id())>=0}],"filter-in-small":[pe,[ce,ve(fe)],(t,e)=>{let[n,r]=e;return r.value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[pe,[ce,ve(fe)],(t,e)=>{let[n,r]=e;return function(t,e,n,r){for(;n<=r;){const o=n+r>>1;if(e[o]===t)return!0;e[o]>t?r=o-1:n=o+1}return!1}(t.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:pe,overloads:[[[pe,pe],(t,e)=>{let[n,r]=e;return n.evaluate(t)&&r.evaluate(t)}],[Rr(pe),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:pe,overloads:[[[pe,pe],(t,e)=>{let[n,r]=e;return n.evaluate(t)||r.evaluate(t)}],[Rr(pe),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[pe,[pe],(t,e)=>{let[n]=e;return!n.evaluate(t)}],"is-supported-script":[pe,[ce],(t,e)=>{let[n]=e;const r=t.globals&&t.globals.isSupportedScript;return!r||r(n.evaluate(t))}],upcase:[ce,[ce],(t,e)=>{let[n]=e;return n.evaluate(t).toUpperCase()}],downcase:[ce,[ce],(t,e)=>{let[n]=e;return n.evaluate(t).toLowerCase()}],concat:[ce,Rr(fe),(t,e)=>e.map(e=>Be(e.evaluate(t))).join("")],"resolved-locale":[ce,[ge],(t,e)=>{let[n]=e;return n.evaluate(t).resolvedLocale()}]});var Pr=xr;function Or(t){return{result:"success",value:t}}function Ir(t){return{result:"error",value:t}}function Ar(t){return"data-driven"===t["property-type"]}function Dr(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Mr(t){return!!t.expression&&t.expression.interpolated}function Lr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Nr(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Fr(t){return t}function kr(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Gr(t,e,n,r,o){return kr(typeof n===o?r[n]:void 0,t.default,e.default)}function Br(t,e,n){if("number"!==Lr(n))return kr(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const o=Pn(t.stops.map(t=>t[0]),n);return t.stops[o][1]}function Vr(t,e,n){const r=void 0!==t.base?t.base:1;if("number"!==Lr(n))return kr(t.default,e.default);const o=t.stops.length;if(1===o)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[o-1][0])return t.stops[o-1][1];const i=Pn(t.stops.map(t=>t[0]),n),s=function(t,e,n,r){const o=r-n,i=t-n;return 0===o?0:1===e?i/o:(Math.pow(e,i)-1)/(Math.pow(e,o)-1)}(n,r,t.stops[i][0],t.stops[i+1][0]),a=t.stops[i][1],l=t.stops[i+1][1];let u=Dn[e.type]||Fr;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=qn[t.colorSpace];u=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),s))}return"function"==typeof a.evaluate?{evaluate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=a.evaluate.apply(void 0,e),o=l.evaluate.apply(void 0,e);if(void 0!==r&&void 0!==o)return u(r,o,s)}}:u(a,l,s)}function zr(t,e,n){return"color"===e.type?n=Ae.parse(n):"formatted"===e.type?n=Le.fromString(n.toString()):"resolvedImage"===e.type?n=Ne.fromString(n.toString()):Lr(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),kr(n,t.default,e.default)}class jr{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Je,this._defaultValue=e?function(t){return"color"===t.type&&(Nr(t.default)||Array.isArray(t.default))?new Ae(0,0,0,0):"color"===t.type?Ae.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,r,o,i,s,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=r||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,r,o,i,s,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new je("Expected value to be one of ".concat(Object.keys(this._enumValues).map(t=>JSON.stringify(t)).join(", "),", but found ").concat(JSON.stringify(t)," instead."));return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function Hr(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Pr}function Ur(t,e){const n=new Rn(Pr,[],e?function(t){const e={color:he,string:ce,number:ue,enum:ce,boolean:pe,formatted:me,resolvedImage:ye};return"array"===t.type?ve(e[t.value]||fe,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Or(new jr(r,e)):Ir(n.errors)}class Wr{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!bn(e.expression)}evaluateWithoutErrorHandling(t,e,n,r,o,i){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,o,i)}evaluate(t,e,n,r,o,i){return this._styleExpression.evaluate(t,e,n,r,o,i)}}class qr{constructor(t,e,n,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!bn(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,n,r,o,i){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,o,i)}evaluate(t,e,n,r,o,i){return this._styleExpression.evaluate(t,e,n,r,o,i)}interpolationFactor(t,e,n){return this.interpolationType?Yn.interpolationFactor(this.interpolationType,t,e,n):0}}function Xr(t,e){if("error"===(t=Ur(t,e)).result)return t;const n=t.value.expression,r=Cn(n);if(!r&&!Ar(e))return Ir([new ie("","data expressions not supported")]);const o=xn(n,["zoom","pitch","distance-from-center"]);if(!o&&!Dr(e))return Ir([new ie("","zoom expressions not supported")]);const i=function t(e){let n=null;if(e instanceof $n)n=t(e.result);else if(e instanceof Qn){for(const r of e.args)if(n=t(r),n)break}else(e instanceof In||e instanceof Yn)&&e.input instanceof tn&&"zoom"===e.input.name&&(n=e);return n instanceof ie||e.eachChild(e=>{const r=t(e);r instanceof ie?n=r:!n&&r?n=new ie("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new ie("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}(n);return i||o?i instanceof ie?Ir([i]):i instanceof Yn&&!Mr(e)?Ir([new ie("",'"interpolate" expressions cannot be used with this property')]):Or(i?new qr(r?"camera":"composite",t.value,i.labels,i instanceof Yn?i.interpolation:void 0):new Wr(r?"constant":"source",t.value)):Ir([new ie("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Kr{constructor(t,e){this._parameters=t,this._specification=e,ee(this,function t(e,n){const r="color"===n.type,o=e.stops&&"object"==typeof e.stops[0][0],i=o||!(o||void 0!==e.property),s=e.type||(Mr(n)?"exponential":"interval");if(r&&((e=ee({},e)).stops&&(e.stops=e.stops.map(t=>[t[0],Ae.parse(t[1])])),e.default=Ae.parse(e.default?e.default:n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!qn[e.colorSpace])throw new Error("Unknown color space: ".concat(e.colorSpace));let a,l,u;if("exponential"===s)a=Vr;else if("interval"===s)a=Br;else if("categorical"===s){a=Gr,l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];u=typeof e.stops[0][0]}else{if("identity"!==s)throw new Error('Unknown function type "'.concat(s,'"'));a=zr}if(o){const r={},o=[];for(let t=0;t<e.stops.length;t++){const n=e.stops[t],i=n[0].zoom;void 0===r[i]&&(r[i]={zoom:i,type:e.type,property:e.property,default:e.default,stops:[]},o.push(i)),r[i].stops.push([n[0].value,n[1]])}const i=[];for(const e of o)i.push([r[e].zoom,t(r[e],n)]);const s={name:"linear"};return{kind:"composite",interpolationType:s,interpolationFactor:Yn.interpolationFactor.bind(void 0,s),zoomStops:i.map(t=>t[0]),evaluate:(t,r)=>{let{zoom:o}=t;return Vr({stops:i,base:e.base},n,o).evaluate(o,r)}}}if(i){const t="exponential"===s?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:t,interpolationFactor:Yn.interpolationFactor.bind(void 0,t),zoomStops:e.stops.map(t=>t[0]),evaluate:t=>{let{zoom:r}=t;return a(e,n,r,l,u)}}}return{kind:"source",evaluate(t,r){const o=r&&r.properties?r.properties[e.property]:void 0;return void 0===o?kr(e.default,n.default):a(e,n,o,l,u)}}}(this._parameters,this._specification))}static deserialize(t){return new Kr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}class Yr{constructor(t,e,n,r){this.message=(t?"".concat(t,": "):"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)}}function Zr(t){const e=t.key,n=t.value,r=t.valueSpec||{},o=t.objectElementValidators||{},i=t.style,s=t.styleSpec;let a=[];const l=Lr(n);if("object"!==l)return[new Yr(e,n,"object expected, ".concat(l," found"))];for(const u in n){const t=u.split(".")[0];let l;o[t]?l=o[t]:r[t]?l=Oo:o["*"]?l=o["*"]:r["*"]&&(l=Oo),l?a=a.concat(l({key:(e?"".concat(e,"."):e)+u,value:n[u],valueSpec:r[t]||r["*"],style:i,styleSpec:s,object:n,objectKey:u},n)):a.push(new Yr(e,n[u],'unknown property "'.concat(u,'"')))}for(const u in r)o[u]||r[u].required&&void 0===r[u].default&&void 0===n[u]&&a.push(new Yr(e,n,'missing required property "'.concat(u,'"')));return a}function Qr(t){const e=t.value,n=t.valueSpec,r=t.style,o=t.styleSpec,i=t.key,s=t.arrayElementValidator||Oo;if("array"!==Lr(e))return[new Yr(i,e,"array expected, ".concat(Lr(e)," found"))];if(n.length&&e.length!==n.length)return[new Yr(i,e,"array length ".concat(n.length," expected, length ").concat(e.length," found"))];if(n["min-length"]&&e.length<n["min-length"])return[new Yr(i,e,"array length at least ".concat(n["min-length"]," expected, length ").concat(e.length," found"))];let a={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};o.$version<7&&(a.function=n.function),"object"===Lr(n.value)&&(a=n.value);let l=[];for(let u=0;u<e.length;u++)l=l.concat(s({array:e,arrayIndex:u,value:e[u],valueSpec:a,style:r,styleSpec:o,key:"".concat(i,"[").concat(u,"]")}));return l}function Jr(t){const e=t.key,n=t.value,r=t.valueSpec;let o=Lr(n);if("number"===o&&n!=n&&(o="NaN"),"number"!==o)return[new Yr(e,n,"number expected, ".concat(o," found"))];if("minimum"in r){let o=r.minimum;if("array"===Lr(r.minimum)&&(o=r.minimum[t.arrayIndex]),n<o)return[new Yr(e,n,"".concat(n," is less than the minimum value ").concat(o))]}if("maximum"in r){let o=r.maximum;if("array"===Lr(r.maximum)&&(o=r.maximum[t.arrayIndex]),n>o)return[new Yr(e,n,"".concat(n," is greater than the maximum value ").concat(o))]}return[]}function $r(t){const e=t.valueSpec,n=ne(t.value.type);let r,o,i,s={};const a="categorical"!==n&&void 0===t.value.property,l=!a,u="array"===Lr(t.value.stops)&&"array"===Lr(t.value.stops[0])&&"object"===Lr(t.value.stops[0][0]),c=Zr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new Yr(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const r=t.value;return e=e.concat(Qr({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===Lr(r)&&0===r.length&&e.push(new Yr(t.key,r,"array must have at least one stop")),e},default:function(t){return Oo({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&a&&c.push(new Yr(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||c.push(new Yr(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Mr(t.valueSpec)&&c.push(new Yr(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Ar(t.valueSpec)?c.push(new Yr(t.key,t.value,"property functions not supported")):a&&!Dr(t.valueSpec)&&c.push(new Yr(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!u||void 0!==t.value.property||c.push(new Yr(t.key,t.value,'"property" property is required')),c;function p(t){let n=[];const r=t.value,a=t.key;if("array"!==Lr(r))return[new Yr(a,r,"array expected, ".concat(Lr(r)," found"))];if(2!==r.length)return[new Yr(a,r,"array length 2 expected, length ".concat(r.length," found"))];if(u){if("object"!==Lr(r[0]))return[new Yr(a,r,"object expected, ".concat(Lr(r[0])," found"))];if(void 0===r[0].zoom)return[new Yr(a,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new Yr(a,r,"object stop key must have value")];const e=ne(r[0].zoom);if("number"!=typeof e)return[new Yr(a,r[0].zoom,"stop zoom values must be numbers")];if(i&&i>e)return[new Yr(a,r[0].zoom,"stop zoom values must appear in ascending order")];e!==i&&(i=e,o=void 0,s={}),n=n.concat(Zr({key:"".concat(a,"[0]"),value:r[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Jr,value:h}}))}else n=n.concat(h({key:"".concat(a,"[0]"),value:r[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},r));return Hr(re(r[1]))?n.concat([new Yr("".concat(a,"[1]"),r[1],"expressions are not allowed in function stops.")]):n.concat(Oo({key:"".concat(a,"[1]"),value:r[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function h(t,i){const a=Lr(t.value),l=ne(t.value),u=null!==t.value?t.value:i;if(r){if(a!==r)return[new Yr(t.key,u,"".concat(a," stop domain type must match previous stop domain type ").concat(r))]}else r=a;if("number"!==a&&"string"!==a&&"boolean"!==a&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new Yr(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==n){let r="number expected, ".concat(a," found");return Ar(e)&&void 0===n&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Yr(t.key,u,r)]}return"categorical"!==n||"number"!==a||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===a&&"number"==typeof l&&"number"==typeof o&&void 0!==o&&l<o?[new Yr(t.key,u,"stop domain values must appear in ascending order")]:(o=l,"categorical"===n&&l in s?[new Yr(t.key,u,"stop domain values must be unique")]:(s[l]=!0,[])):[new Yr(t.key,u,"integer expected, found ".concat(String(l)))]}}function to(t){const e=("property"===t.expressionContext?Xr:Ur)(re(t.value),t.valueSpec);if("error"===e.result)return e.value.map(e=>new Yr("".concat(t.key).concat(e.key),t.value,e.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new Yr(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===t.expressionContext&&"layout"===t.propertyType&&!bn(n))return[new Yr(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return function t(e,n){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const i of n.valueSpec.expression.parameters)r.delete(i);if(0===r.size)return[];const o=[];return e instanceof tn&&r.has(e.name)?[new Yr(n.key,n.value,'["'.concat(e.name,'"] expression is not supported in a filter for a ').concat(n.object.type," layer with id: ").concat(n.object.id))]:(e.eachChild(e=>{o.push(...t(e,n))}),o)}(n,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!xn(n,["zoom","feature-state"]))return[new Yr(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Cn(n))return[new Yr(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function eo(t){const e=t.key,n=t.value,r=t.valueSpec,o=[];return Array.isArray(r.values)?-1===r.values.indexOf(ne(n))&&o.push(new Yr(e,n,"expected one of [".concat(r.values.join(", "),"], ").concat(JSON.stringify(n)," found"))):-1===Object.keys(r.values).indexOf(ne(n))&&o.push(new Yr(e,n,"expected one of [".concat(Object.keys(r.values).join(", "),"], ").concat(JSON.stringify(n)," found"))),o}function no(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!no(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function ro(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill";if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};no(t)||(t=co(t));const n=t;let r=!0;try{r=function(t){if(!so(t))return t;let e=re(t);return io(e),e=oo(e),e}(n)}catch(t){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(n,null,2),"\n        "))}const o=te["filter_".concat(e)],i=Ur(r,o);let s=null;if("error"===i.result)throw new Error(i.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));s=(t,e,n)=>i.value.evaluate(t,e,{},n);let a=null,l=null;if(r!==n){const t=Ur(n,o);if("error"===t.result)throw new Error(t.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));a=(e,n,r,o,i)=>t.value.evaluate(e,n,{},r,void 0,void 0,o,i),l=!Cn(t.value.expression)}return{filter:s,dynamicFilter:a||void 0,needGeometry:uo(r),needFeature:!!l}}function oo(t){if(!Array.isArray(t))return t;const e=function(t){if(ao.has(t[0]))for(let e=1;e<t.length;e++)if(so(t[e]))return!0;return t}(t);return!0===e?e:e.map(t=>oo(t))}function io(t){let e=!1;const n=[];if("case"===t[0]){for(let r=1;r<t.length-1;r+=2)e=e||so(t[r]),n.push(t[r+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||so(t[1]);for(let e=2;e<t.length-1;e+=2)n.push(t[e+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||so(t[1]);for(let e=1;e<t.length-1;e+=2)n.push(t[e+1])}e&&(t.length=0,t.push("any",...n));for(let r=1;r<t.length;r++)io(t[r])}function so(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let n=1;n<t.length;n++)if(so(t[n]))return!0;return!1}const ao=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function lo(t,e){return t<e?-1:t>e?1:0}function uo(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(uo(t[e]))return!0;return!1}function co(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?po(t[1],t[2],"=="):"!="===e?go(po(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?po(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(co))):"all"===e?["all"].concat(t.slice(1).map(co)):"none"===e?["all"].concat(t.slice(1).map(co).map(go)):"in"===e?ho(t[1],t.slice(2)):"!in"===e?go(ho(t[1],t.slice(2))):"has"===e?fo(t[1]):"!has"===e?go(fo(t[1])):"within"!==e||t;var n}function po(t,e,n){switch(t){case"$type":return["filter-type-".concat(n),e];case"$id":return["filter-id-".concat(n),e];default:return["filter-".concat(n),t,e]}}function ho(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",t,["literal",e.sort(lo)]]:["filter-in-small",t,["literal",e]]}}function fo(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function go(t){return["!",t]}function mo(t){return no(re(t.value))?to(ee({},t,{expressionContext:"filter",valueSpec:t.styleSpec["filter_".concat(t.layerType||"fill")]})):function t(e){const n=e.value,r=e.key;if("array"!==Lr(n))return[new Yr(r,n,"array expected, ".concat(Lr(n)," found"))];const o=e.styleSpec;let i,s=[];if(n.length<1)return[new Yr(r,n,"filter array must have at least 1 element")];switch(s=s.concat(eo({key:"".concat(r,"[0]"),value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),ne(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===ne(n[1])&&s.push(new Yr(r,n,'"$type" cannot be use with operator "'.concat(n[0],'"')));case"==":case"!=":3!==n.length&&s.push(new Yr(r,n,'filter array for operator "'.concat(n[0],'" must have 3 elements')));case"in":case"!in":n.length>=2&&(i=Lr(n[1]),"string"!==i&&s.push(new Yr("".concat(r,"[1]"),n[1],"string expected, ".concat(i," found"))));for(let t=2;t<n.length;t++)i=Lr(n[t]),"$type"===ne(n[1])?s=s.concat(eo({key:"".concat(r,"[").concat(t,"]"),value:n[t],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&s.push(new Yr("".concat(r,"[").concat(t,"]"),n[t],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let o=1;o<n.length;o++)s=s.concat(t({key:"".concat(r,"[").concat(o,"]"),value:n[o],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Lr(n[1]),2!==n.length?s.push(new Yr(r,n,'filter array for "'.concat(n[0],'" operator must have 2 elements'))):"string"!==i&&s.push(new Yr("".concat(r,"[1]"),n[1],"string expected, ".concat(i," found")));break;case"within":i=Lr(n[1]),2!==n.length?s.push(new Yr(r,n,'filter array for "'.concat(n[0],'" operator must have 2 elements'))):"object"!==i&&s.push(new Yr("".concat(r,"[1]"),n[1],"object expected, ".concat(i," found")))}return s}(t)}function yo(t,e){const n=t.key,r=t.style,o=t.styleSpec,i=t.value,s=t.objectKey,a=o["".concat(e,"_").concat(t.layerType)];if(!a)return[];const l=s.match(/^(.*)-transition$/);if("paint"===e&&l&&a[l[1]]&&a[l[1]].transition)return Oo({key:n,value:i,valueSpec:o.transition,style:r,styleSpec:o});const u=t.valueSpec||a[s];if(!u)return[new Yr(n,i,'unknown property "'.concat(s,'"'))];let c;if("string"===Lr(i)&&Ar(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(i))){const t='`{ "type": "identity", "property": '.concat(c?JSON.stringify(c[1]):'"_"'," }`");return[new Yr(n,i,'"'.concat(s,'" does not support interpolation syntax\nUse an identity property function instead: ').concat(t,"."))]}const p=[];return"symbol"===t.layerType&&("text-field"===s&&r&&!r.glyphs&&p.push(new Yr(n,i,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Nr(re(i))&&"identity"===ne(i.type)&&p.push(new Yr(n,i,'"text-font" does not support identity functions'))),p.concat(Oo({key:t.key,value:i,valueSpec:u,style:r,styleSpec:o,expressionContext:"property",propertyType:e,propertyKey:s}))}function vo(t){return yo(t,"paint")}function _o(t){return yo(t,"layout")}function wo(t){let e=[];const n=t.value,r=t.key,o=t.style,i=t.styleSpec;n.type||n.ref||e.push(new Yr(r,n,'either "type" or "ref" is required'));let s=ne(n.type);const a=ne(n.ref);if(n.id){const i=ne(n.id);for(let s=0;s<t.arrayIndex;s++){const t=o.layers[s];ne(t.id)===i&&e.push(new Yr(r,n.id,'duplicate layer id "'.concat(n.id,'", previously used at line ').concat(t.id.__line__)))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach(t=>{t in n&&e.push(new Yr(r,n[t],'"'.concat(t,'" is prohibited for ref layers')))}),o.layers.forEach(e=>{ne(e.id)===a&&(t=e)}),t?t.ref?e.push(new Yr(r,n.ref,"ref cannot reference another ref layer")):s=ne(t.type):"string"==typeof a&&e.push(new Yr(r,n.ref,'ref layer "'.concat(a,'" not found')))}else if("background"!==s&&"sky"!==s)if(n.source){const t=o.sources&&o.sources[n.source],i=t&&ne(t.type);t?"vector"===i&&"raster"===s?e.push(new Yr(r,n.source,'layer "'.concat(n.id,'" requires a raster source'))):"raster"===i&&"raster"!==s?e.push(new Yr(r,n.source,'layer "'.concat(n.id,'" requires a vector source'))):"vector"!==i||n["source-layer"]?"raster-dem"===i&&"hillshade"!==s?e.push(new Yr(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===i&&t.lineMetrics||e.push(new Yr(r,n,'layer "'.concat(n.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new Yr(r,n,'layer "'.concat(n.id,'" must specify a "source-layer"'))):e.push(new Yr(r,n.source,'source "'.concat(n.source,'" not found')))}else e.push(new Yr(r,n,'missing required property "source"'));return e=e.concat(Zr({key:r,value:n,valueSpec:i.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Oo({key:"".concat(r,".type"),value:n.type,valueSpec:i.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:t=>mo(ee({layerType:s},t)),layout:t=>Zr({layer:n,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>_o(ee({layerType:s},t))}}),paint:t=>Zr({layer:n,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>vo(ee({layerType:s},t))}})}})),e}function Co(t){const e=t.value,n=t.key,r=Lr(e);return"string"!==r?[new Yr(n,e,"string expected, ".concat(r," found"))]:[]}const bo={promoteId:function(t){let{key:e,value:n}=t;if("string"===Lr(n))return Co({key:e,value:n});{const t=[];for(const r in n)t.push(...Co({key:"".concat(e,".").concat(r),value:n[r]}));return t}}};function xo(t){const e=t.value,n=t.key,r=t.styleSpec,o=t.style;if(!e.type)return[new Yr(n,e,'"type" is required')];const i=ne(e.type);let s;switch(i){case"vector":case"raster":case"raster-dem":return s=Zr({key:n,value:e,valueSpec:r["source_".concat(i.replace("-","_"))],style:t.style,styleSpec:r,objectElementValidators:bo}),s;case"geojson":if(s=Zr({key:n,value:e,valueSpec:r.source_geojson,style:o,styleSpec:r,objectElementValidators:bo}),e.cluster)for(const t in e.clusterProperties){const[r,o]=e.clusterProperties[t],i="string"==typeof r?[r,["accumulated"],["get",t]]:r;s.push(...to({key:"".concat(n,".").concat(t,".map"),value:o,expressionContext:"cluster-map"})),s.push(...to({key:"".concat(n,".").concat(t,".reduce"),value:i,expressionContext:"cluster-reduce"}))}return s;case"video":return Zr({key:n,value:e,valueSpec:r.source_video,style:o,styleSpec:r});case"image":return Zr({key:n,value:e,valueSpec:r.source_image,style:o,styleSpec:r});case"canvas":return[new Yr(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return eo({key:"".concat(n,".type"),value:e.type,valueSpec:{values:Eo(r)},style:o,styleSpec:r})}}function Eo(t){return t.source.reduce((e,n)=>{const r=t[n];return"enum"===r.type.type&&(e=e.concat(Object.keys(r.type.values))),e},[])}function So(t){const e=t.value,n=t.styleSpec,r=n.light,o=t.style;let i=[];const s=Lr(e);if(void 0===e)return i;if("object"!==s)return i=i.concat([new Yr("light",e,"object expected, ".concat(s," found"))]),i;for(const a in e){const t=a.match(/^(.*)-transition$/);i=i.concat(t&&r[t[1]]&&r[t[1]].transition?Oo({key:a,value:e[a],valueSpec:n.transition,style:o,styleSpec:n}):r[a]?Oo({key:a,value:e[a],valueSpec:r[a],style:o,styleSpec:n}):[new Yr(a,e[a],'unknown property "'.concat(a,'"'))])}return i}function To(t){const e=t.value,n=t.key,r=t.style,o=t.styleSpec,i=o.terrain;let s=[];const a=Lr(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new Yr("terrain",e,"object expected, ".concat(a," found"))]),s;for(const l in e){const t=l.match(/^(.*)-transition$/);s=s.concat(t&&i[t[1]]&&i[t[1]].transition?Oo({key:l,value:e[l],valueSpec:o.transition,style:r,styleSpec:o}):i[l]?Oo({key:l,value:e[l],valueSpec:i[l],style:r,styleSpec:o}):[new Yr(l,e[l],'unknown property "'.concat(l,'"'))])}if(e.source){const t=r.sources&&r.sources[e.source],o=t&&ne(t.type);t?"raster-dem"!==o&&s.push(new Yr(n,e.source,"terrain cannot be used with a source of type ".concat(String(o),', it only be used with a "raster-dem" source type'))):s.push(new Yr(n,e.source,'source "'.concat(e.source,'" not found')))}else s.push(new Yr(n,e,'terrain is missing required property "source"'));return s}function Ro(t){const e=t.value,n=t.style,r=t.styleSpec,o=r.fog;let i=[];const s=Lr(e);if(void 0===e)return i;if("object"!==s)return i=i.concat([new Yr("fog",e,"object expected, ".concat(s," found"))]),i;for(const a in e){const t=a.match(/^(.*)-transition$/);i=i.concat(t&&o[t[1]]&&o[t[1]].transition?Oo({key:a,value:e[a],valueSpec:r.transition,style:n,styleSpec:r}):o[a]?Oo({key:a,value:e[a],valueSpec:o[a],style:n,styleSpec:r}):[new Yr(a,e[a],'unknown property "'.concat(a,'"'))])}return i}const Po={"*":()=>[],array:Qr,boolean:function(t){const e=t.value,n=t.key,r=Lr(e);return"boolean"!==r?[new Yr(n,e,"boolean expected, ".concat(r," found"))]:[]},number:Jr,color:function(t){const e=t.key,n=t.value,r=Lr(n);return"string"!==r?[new Yr(e,n,"color expected, ".concat(r," found"))]:null===Ee(n)?[new Yr(e,n,'color expected, "'.concat(n,'" found'))]:[]},enum:eo,filter:mo,function:$r,layer:wo,object:Zr,source:xo,light:So,terrain:To,fog:Ro,string:Co,formatted:function(t){return 0===Co(t).length?[]:to(t)},resolvedImage:function(t){return 0===Co(t).length?[]:to(t)},projection:function(t){const e=t.value,n=t.styleSpec,r=n.projection,o=t.style;let i=[];const s=Lr(e);if("object"===s)for(const a in e)i=i.concat(Oo({key:a,value:e[a],valueSpec:r[a],style:o,styleSpec:n}));else"string"!==s&&(i=i.concat([new Yr("projection",e,"object or string expected, ".concat(s," found"))]));return i}};function Oo(t){const e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&Nr(ne(e))?$r(t):n.expression&&Hr(re(e))?to(t):n.type&&Po[n.type]?Po[n.type](t):Zr(ee({},t,{valueSpec:n.type?r[n.type]:n}))}function Io(t){const e=t.value,n=t.key,r=Co(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new Yr(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new Yr(n,e,'"glyphs" url must include a "{range}" token'))),r}function Ao(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te;return Lo(Oo({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Io,"*":()=>[]}}))}const Do=t=>Lo(vo(t)),Mo=t=>Lo(_o(t));function Lo(t){return t.slice().sort((t,e)=>t.line&&e.line?t.line-e.line:0)}function No(t,e){let n=!1;if(e&&e.length)for(const r of e)t.fire(new Jt(new Error(r.message))),n=!0;return n}var Fo=ko;function ko(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var o=new Int32Array(this.arrayBuffer);t=o[0],this.d=(e=o[1])+2*(n=o[2]);for(var i=0;i<this.d*this.d;i++){var s=o[3+i],a=o[3+i+1];r.push(s===a?null:o.subarray(s,a))}var l=o[3+r.length+1];this.keys=o.subarray(o[3+r.length],l),this.bboxes=o.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var u=0;u<this.d*this.d;u++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var c=n/e*t;this.min=-c,this.max=t+c}ko.prototype.insert=function(t,e,n,r,o){this._forEachCell(e,n,r,o,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(o)},ko.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ko.prototype._insertCell=function(t,e,n,r,o,i){this.cells[o].push(i)},ko.prototype.query=function(t,e,n,r,o){var i=this.min,s=this.max;if(t<=i&&e<=i&&s<=n&&s<=r&&!o)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,r,this._queryCell,a,{},o),a},ko.prototype._queryCell=function(t,e,n,r,o,i,s,a){var l=this.cells[o];if(null!==l)for(var u=this.keys,c=this.bboxes,p=0;p<l.length;p++){var h=l[p];if(void 0===s[h]){var d=4*h;(a?a(c[d+0],c[d+1],c[d+2],c[d+3]):t<=c[d+2]&&e<=c[d+3]&&n>=c[d+0]&&r>=c[d+1])?(s[h]=!0,i.push(u[h])):s[h]=!1}}},ko.prototype._forEachCell=function(t,e,n,r,o,i,s,a){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),p=this._convertToCellCoord(r),h=l;h<=c;h++)for(var d=u;d<=p;d++){var f=this.d*d+h;if((!a||a(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&o.call(this,t,e,n,r,f,i,s,a))return}},ko.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},ko.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},ko.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var o=new Int32Array(e+n+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var i=e,s=0;s<t.length;s++){var a=t[s];o[3+s]=i,o.set(a,i),i+=a.length}return o[3+t.length]=i,o.set(this.keys,i),o[3+t.length+1]=i+=this.keys.length,o.set(this.bboxes,i),i+=this.bboxes.length,o.buffer};var Go=h(Fo);const Bo={};function Vo(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Bo[e]={klass:t,omit:n.omit||[]}}Vo(Object,"Object"),Go.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Go.deserialize=function(t){return new Go(t.buffer)},Object.defineProperty(Go,"name",{value:"Grid"}),Vo(Go,"Grid"),Vo(Ae,"Color"),Vo(Error,"Error"),Vo(ut,"AJAXError"),Vo(Ne,"ResolvedImage"),Vo(Kr,"StylePropertyFunction"),Vo(jr,"StyleExpression",{omit:["_evaluator"]}),Vo(qr,"ZoomDependentExpression"),Vo(Wr,"ZoomConstantExpression"),Vo(tn,"CompoundExpression",{omit:["_evaluate"]});for(const Ng in Pr)Bo[Pr[Ng]._classRegistryKey]||Vo(Pr[Ng],"Expression".concat(Ng));function zo(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function jo(t){return e.ImageBitmap&&t instanceof e.ImageBitmap}function Ho(t,n){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(zo(t)||jo(t))return n&&n.push(t),t;if(ArrayBuffer.isView(t)){const e=t;return n&&n.push(e.buffer),e}if(t instanceof e.ImageData)return n&&n.push(t.data.buffer),t;if(Array.isArray(t)){const e=[];for(const r of t)e.push(Ho(r,n));return e}if("object"==typeof t){const e=t.constructor,r=e._classRegistryKey;if(!r)throw new Error("can't serialize object of unregistered class ".concat(r));const o=e.serialize?e.serialize(t,n):{};if(!e.serialize){for(const e in t)t.hasOwnProperty(e)&&(Bo[r].omit.indexOf(e)>=0||(o[e]=Ho(t[e],n)));t instanceof Error&&(o.message=t.message)}if(o.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(o.$name=r),o}throw new Error("can't serialize object of type "+typeof t)}function Uo(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||zo(t)||jo(t)||ArrayBuffer.isView(t)||t instanceof e.ImageData)return t;if(Array.isArray(t))return t.map(Uo);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=Bo[e];if(!n)throw new Error("can't deserialize unregistered class ".concat(e));if(n.deserialize)return n.deserialize(t);const r=Object.create(n.prototype);for(const o of Object.keys(t))"$name"!==o&&(r[o]=Uo(t[o]));return r}throw new Error("can't deserialize object of type "+typeof t)}const Wo=t=>t>=128&&t<=255,qo=t=>t>=1536&&t<=1791,Xo=t=>t>=1872&&t<=1919,Ko=t=>t>=2208&&t<=2303,Yo=t=>t>=4352&&t<=4607,Zo=t=>t>=5120&&t<=5759,Qo=t=>t>=6016&&t<=6143,Jo=t=>t>=6320&&t<=6399,$o=t=>t>=8192&&t<=8303,ti=t=>t>=8448&&t<=8527,ei=t=>t>=8528&&t<=8591,ni=t=>t>=8960&&t<=9215,ri=t=>t>=9216&&t<=9279,oi=t=>t>=9280&&t<=9311,ii=t=>t>=9312&&t<=9471,si=t=>t>=9632&&t<=9727,ai=t=>t>=9728&&t<=9983,li=t=>t>=11008&&t<=11263,ui=t=>t>=11904&&t<=12031,ci=t=>t>=12032&&t<=12255,pi=t=>t>=12272&&t<=12287,hi=t=>t>=12288&&t<=12351,di=t=>t>=12352&&t<=12447,fi=t=>t>=12448&&t<=12543,gi=t=>t>=12544&&t<=12591,mi=t=>t>=12592&&t<=12687,yi=t=>t>=12688&&t<=12703,vi=t=>t>=12704&&t<=12735,_i=t=>t>=12736&&t<=12783,wi=t=>t>=12784&&t<=12799,Ci=t=>t>=12800&&t<=13055,bi=t=>t>=13056&&t<=13311,xi=t=>t>=13312&&t<=19903,Ei=t=>t>=19904&&t<=19967,Si=t=>t>=19968&&t<=40959,Ti=t=>t>=40960&&t<=42127,Ri=t=>t>=42128&&t<=42191,Pi=t=>t>=43360&&t<=43391,Oi=t=>t>=44032&&t<=55215,Ii=t=>t>=55216&&t<=55295,Ai=t=>t>=57344&&t<=63743,Di=t=>t>=63744&&t<=64255,Mi=t=>t>=64336&&t<=65023,Li=t=>t>=65040&&t<=65055,Ni=t=>t>=65072&&t<=65103,Fi=t=>t>=65104&&t<=65135,ki=t=>t>=65136&&t<=65279,Gi=t=>t>=65280&&t<=65519;function Bi(t){for(const e of t)if(ji(e.charCodeAt(0)))return!0;return!1}function Vi(t){for(const e of t)if(!zi(e.charCodeAt(0)))return!1;return!0}function zi(t){return!(qo(t)||Xo(t)||Ko(t)||Mi(t)||ki(t))}function ji(t){return!(746!==t&&747!==t&&(t<4352||!(vi(t)||gi(t)||Ni(t)&&!(t>=65097&&t<=65103)||Di(t)||bi(t)||ui(t)||_i(t)||!(!hi(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||xi(t)||Si(t)||Ci(t)||mi(t)||Pi(t)||Ii(t)||Yo(t)||Oi(t)||di(t)||pi(t)||yi(t)||ci(t)||wi(t)||fi(t)&&12540!==t||!(!Gi(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Fi(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Zo(t)||Jo(t)||Li(t)||Ei(t)||Ti(t)||Ri(t))))}function Hi(t){return!(ji(t)||function(t){return!!(Wo(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||$o(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||ti(t)||ei(t)||ni(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||ri(t)&&9251!==t||oi(t)||ii(t)||si(t)||ai(t)&&!(t>=9754&&t<=9759)||li(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||hi(t)||fi(t)||Ai(t)||Ni(t)||Fi(t)||Gi(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Ui(t){return t>=1424&&t<=2303||Mi(t)||ki(t)}function Wi(t,e){return!(!e&&Ui(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Qo(t))}function qi(t){for(const e of t)if(Ui(e.charCodeAt(0)))return!0;return!1}const Xi="deferred",Ki="loading",Yi="loaded";let Zi=null,Qi="unavailable",Ji=null;const $i=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Qi="error"),Zi&&Zi(t)};function ts(){es.fire(new Qt("pluginStateChange",{pluginStatus:Qi,pluginURL:Ji}))}const es=new $t,ns=function(){return Qi},rs=function(){if(Qi!==Xi||!Ji)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qi=Ki,ts(),Ji&&ht({url:Ji},t=>{t?$i(t):(Qi=Yi,ts())})},os={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Qi===Yi||null!=os.applyArabicShaping,isLoading:()=>Qi===Ki,setState(t){Qi=t.pluginStatus,Ji=t.pluginURL},isParsed:()=>null!=os.applyArabicShaping&&null!=os.processBidirectionalText&&null!=os.processStyledBidirectionalText,getPluginURL:()=>Ji};class is{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.transition=e.transition,this.pitch=e.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(t,e){for(const n of t)if(!Wi(n.charCodeAt(0),e))return!1;return!0}(t,os.isLoaded())}}class ss{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Nr(t))return new Kr(t,e);if(Hr(t)){const n=Xr(t,e);if("error"===n.result)throw new Error(n.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));return n.value}{let n=t;return"string"==typeof t&&"color"===e.type&&(n=Ae.parse(t)),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class as{constructor(t){this.property=t,this.value=new ss(t,void 0)}transitioned(t,e){return new us(this.property,this.value,e,D({},t.transition,this.transition),t.now)}untransitioned(){return new us(this.property,this.value,null,{},0)}}class ls{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return j(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new as(this._values[t].property)),this._values[t].value=new ss(this._values[t].property,null===e?void 0:j(e))}getTransition(t){return j(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new as(this._values[t].property)),this._values[t].transition=j(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const r=this.getTransition(e);void 0!==r&&(t["".concat(e,"-transition")]=r)}return t}transitioned(t,e){const n=new cs(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].transitioned(t,e._values[r]);return n}untransitioned(){const t=new cs(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class us{constructor(t,e,n,r,o){const i=r.delay||0,s=r.duration||0;o=o||0,this.property=t,this.value=e,this.begin=o+i,this.end=this.begin+s,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const r=t.now||0,o=this.value.possiblyEvaluate(t,e,n),i=this.prior;if(i){if(r>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(r<this.begin)return i.possiblyEvaluate(t,e,n);{const s=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(t,e,n),o,E(s))}}return o}}class cs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const r=new ds(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].possiblyEvaluate(t,e,n);return r}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ps{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return j(this._values[t].value)}setValue(t,e){this._values[t]=new ss(this._values[t].property,null===e?void 0:j(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const r=new ds(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].possiblyEvaluate(t,e,n);return r}}class hs{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,r){return this.property.evaluate(this.value,this.parameters,t,e,n,r)}}class ds{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class fs{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,n){const r=Dn[this.specification.type];return r?r(t,e,n):t}}class gs{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,r){return new hs(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,r)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new hs(this,{kind:"constant",value:void 0},t.parameters);const r=Dn[this.specification.type];return r?new hs(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,r,o,i){return"constant"===t.kind?t.value:t.evaluate(e,n,r,o,i)}}class ms{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,r){return!!t.expression.evaluate(e,null,{},n,r)}interpolate(){return!1}}class ys{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const e=new is(0,{});for(const n in t){const r=t[n];r.specification.overridable&&this.overridableProperties.push(n);const o=this.defaultPropertyValues[n]=new ss(r,void 0),i=this.defaultTransitionablePropertyValues[n]=new as(r);this.defaultTransitioningPropertyValues[n]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=o.possiblyEvaluate(e)}}}function vs(t,e){return 256*(t=R(Math.floor(t),0,255))+R(Math.floor(e),0,255)}Vo(gs,"DataDrivenProperty"),Vo(fs,"DataConstantProperty"),Vo(ms,"ColorRampProperty");const _s={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ws{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Cs{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function bs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,r=0;return{members:t.map(t=>{const o=_s[t.type].BYTES_PER_ELEMENT,i=n=xs(n,Math.max(e,o)),s=t.components||1;return r=Math.max(r,o),n+=o*s,{name:t.name,type:t.type,components:s,offset:i}}),size:xs(n,Math.max(r,e)),alignment:e}}function xs(t,e){return Math.ceil(t/e)*e}class Es extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t}}Es.prototype.bytesPerElement=4,Vo(Es,"StructArrayLayout2i4");class Ss extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const o=3*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,t}}Ss.prototype.bytesPerElement=6,Vo(Ss,"StructArrayLayout3i6");class Ts extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r)}emplace(t,e,n,r,o){const i=4*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,this.int16[i+3]=o,t}}Ts.prototype.bytesPerElement=8,Vo(Ts,"StructArrayLayout4i8");class Rs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,o,i,s)}emplace(t,e,n,r,o,i,s,a){const l=6*t,u=12*t,c=3*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[u+4]=r,this.uint8[u+5]=o,this.uint8[u+6]=i,this.uint8[u+7]=s,this.float32[c+2]=a,t}}Rs.prototype.bytesPerElement=12,Vo(Rs,"StructArrayLayout2i4ub1f12");class Ps extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r)}emplace(t,e,n,r,o){const i=4*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,this.float32[i+3]=o,t}}Ps.prototype.bytesPerElement=16,Vo(Ps,"StructArrayLayout4f16");class Os extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r,o)}emplace(t,e,n,r,o,i){const s=6*t,a=3*t;return this.uint16[s+0]=e,this.uint16[s+1]=n,this.uint16[s+2]=r,this.uint16[s+3]=o,this.float32[a+2]=i,t}}Os.prototype.bytesPerElement=12,Vo(Os,"StructArrayLayout4ui1f12");class Is extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r)}emplace(t,e,n,r,o){const i=4*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,this.uint16[i+3]=o,t}}Is.prototype.bytesPerElement=8,Vo(Is,"StructArrayLayout4ui8");class As extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,r,o,i)}emplace(t,e,n,r,o,i,s){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=r,this.int16[a+3]=o,this.int16[a+4]=i,this.int16[a+5]=s,t}}As.prototype.bytesPerElement=12,Vo(As,"StructArrayLayout6i12");class Ds extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i,s,a,l,u,c,p){const h=this.length;return this.resize(h+1),this.emplace(h,t,e,n,r,o,i,s,a,l,u,c,p)}emplace(t,e,n,r,o,i,s,a,l,u,c,p,h){const d=12*t;return this.int16[d+0]=e,this.int16[d+1]=n,this.int16[d+2]=r,this.int16[d+3]=o,this.uint16[d+4]=i,this.uint16[d+5]=s,this.uint16[d+6]=a,this.uint16[d+7]=l,this.int16[d+8]=u,this.int16[d+9]=c,this.int16[d+10]=p,this.int16[d+11]=h,t}}Ds.prototype.bytesPerElement=24,Vo(Ds,"StructArrayLayout4i4ui4i24");class Ms extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,r,o,i)}emplace(t,e,n,r,o,i,s){const a=10*t,l=5*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=r,this.float32[l+2]=o,this.float32[l+3]=i,this.float32[l+4]=s,t}}Ms.prototype.bytesPerElement=20,Vo(Ms,"StructArrayLayout3i3f20");class Ls extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Ls.prototype.bytesPerElement=4,Vo(Ls,"StructArrayLayout1ul4");class Ns extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i,s,a,l,u,c,p,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,r,o,i,s,a,l,u,c,p,h)}emplace(t,e,n,r,o,i,s,a,l,u,c,p,h,d){const f=20*t,g=10*t;return this.int16[f+0]=e,this.int16[f+1]=n,this.int16[f+2]=r,this.int16[f+3]=o,this.int16[f+4]=i,this.float32[g+3]=s,this.float32[g+4]=a,this.float32[g+5]=l,this.float32[g+6]=u,this.int16[f+14]=c,this.uint32[g+8]=p,this.uint16[f+18]=h,this.uint16[f+19]=d,t}}Ns.prototype.bytesPerElement=40,Vo(Ns,"StructArrayLayout5i4f1i1ul2ui40");class Fs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,o,i,s)}emplace(t,e,n,r,o,i,s,a){const l=8*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=r,this.int16[l+4]=o,this.int16[l+5]=i,this.int16[l+6]=s,this.int16[l+7]=a,t}}Fs.prototype.bytesPerElement=16,Vo(Fs,"StructArrayLayout3i2i2i16");class ks extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r,o)}emplace(t,e,n,r,o,i){const s=4*t,a=8*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=r,this.int16[a+6]=o,this.int16[a+7]=i,t}}ks.prototype.bytesPerElement=16,Vo(ks,"StructArrayLayout2f1f2i16");class Gs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r)}emplace(t,e,n,r,o){const i=12*t,s=3*t;return this.uint8[i+0]=e,this.uint8[i+1]=n,this.float32[s+1]=r,this.float32[s+2]=o,t}}Gs.prototype.bytesPerElement=12,Vo(Gs,"StructArrayLayout2ub2f12");class Bs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const o=3*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,t}}Bs.prototype.bytesPerElement=12,Vo(Bs,"StructArrayLayout3f12");class Vs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const o=3*t;return this.uint16[o+0]=e,this.uint16[o+1]=n,this.uint16[o+2]=r,t}}Vs.prototype.bytesPerElement=6,Vo(Vs,"StructArrayLayout3ui6");class zs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w){const C=this.length;return this.resize(C+1),this.emplace(C,t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w)}emplace(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w,C){const b=30*t,x=15*t,E=60*t;return this.int16[b+0]=e,this.int16[b+1]=n,this.int16[b+2]=r,this.float32[x+2]=o,this.float32[x+3]=i,this.uint16[b+8]=s,this.uint16[b+9]=a,this.uint32[x+5]=l,this.uint32[x+6]=u,this.uint32[x+7]=c,this.uint16[b+16]=p,this.uint16[b+17]=h,this.uint16[b+18]=d,this.float32[x+10]=f,this.float32[x+11]=g,this.uint8[E+48]=m,this.uint8[E+49]=y,this.uint8[E+50]=v,this.uint32[x+13]=_,this.int16[b+28]=w,this.uint8[E+58]=C,t}}zs.prototype.bytesPerElement=60,Vo(zs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class js extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w,C,b,x,E,S,T,R,P,O){const I=this.length;return this.resize(I+1),this.emplace(I,t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w,C,b,x,E,S,T,R,P,O)}emplace(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w,C,b,x,E,S,T,R,P,O,I){const A=38*t,D=19*t;return this.int16[A+0]=e,this.int16[A+1]=n,this.int16[A+2]=r,this.float32[D+2]=o,this.float32[D+3]=i,this.int16[A+8]=s,this.int16[A+9]=a,this.int16[A+10]=l,this.int16[A+11]=u,this.int16[A+12]=c,this.int16[A+13]=p,this.uint16[A+14]=h,this.uint16[A+15]=d,this.uint16[A+16]=f,this.uint16[A+17]=g,this.uint16[A+18]=m,this.uint16[A+19]=y,this.uint16[A+20]=v,this.uint16[A+21]=_,this.uint16[A+22]=w,this.uint16[A+23]=C,this.uint16[A+24]=b,this.uint16[A+25]=x,this.uint16[A+26]=E,this.uint16[A+27]=S,this.uint16[A+28]=T,this.uint32[D+15]=R,this.float32[D+16]=P,this.float32[D+17]=O,this.float32[D+18]=I,t}}js.prototype.bytesPerElement=76,Vo(js,"StructArrayLayout3i2f6i15ui1ul3f76");class Hs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Hs.prototype.bytesPerElement=4,Vo(Hs,"StructArrayLayout1f4");class Us extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,o){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r,o)}emplace(t,e,n,r,o,i){const s=5*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=r,this.float32[s+3]=o,this.float32[s+4]=i,t}}Us.prototype.bytesPerElement=20,Vo(Us,"StructArrayLayout5f20");class Ws extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r)}emplace(t,e,n,r,o){const i=6*t;return this.uint32[3*t+0]=e,this.uint16[i+2]=n,this.uint16[i+3]=r,this.uint16[i+4]=o,t}}Ws.prototype.bytesPerElement=12,Vo(Ws,"StructArrayLayout1ul3ui12");class qs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t}}qs.prototype.bytesPerElement=4,Vo(qs,"StructArrayLayout2ui4");class Xs extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Xs.prototype.bytesPerElement=2,Vo(Xs,"StructArrayLayout1ui2");class Ks extends Cs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t}}Ks.prototype.bytesPerElement=8,Vo(Ks,"StructArrayLayout2f8");class Ys extends ws{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ys.prototype.size=40;class Zs extends Ns{get(t){return new Ys(this,t)}}Vo(Zs,"CollisionBoxArray");class Qs extends ws{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Qs.prototype.size=60;class Js extends zs{get(t){return new Qs(this,t)}}Vo(Js,"PlacedSymbolArray");class $s extends ws{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}$s.prototype.size=76;class ta extends js{get(t){return new $s(this,t)}}Vo(ta,"SymbolInstanceArray");class ea extends Hs{getoffsetX(t){return this.float32[1*t+0]}}Vo(ea,"GlyphOffsetArray");class na extends Es{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Vo(na,"SymbolLineVertexArray");class ra extends ws{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ra.prototype.size=12;class oa extends Ws{get(t){return new ra(this,t)}}Vo(oa,"FeatureIndexArray");class ia extends qs{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Vo(ia,"FillExtrusionCentroidArray");const sa=bs([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),aa=bs([{name:"a_dash",components:4,type:"Uint16"}]);var la={exports:{}},ua={exports:{}};ua.exports=function(t,e){var n,r,o,i,s,a,l,u;for(r=t.length-(n=3&t.length),o=e,s=3432918353,a=461845907,u=0;u<r;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,o=27492+(65535&(i=5*(65535&(o=(o^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|o>>>19))+((5*(o>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:o^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return o^=t.length,o=2246822507*(65535&(o^=o>>>16))+((2246822507*(o>>>16)&65535)<<16)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0};var ca=ua.exports,pa={exports:{}};pa.exports=function(t,e){for(var n,r=t.length,o=e^r,i=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(i)|(255&t.charCodeAt(++i))<<8|(255&t.charCodeAt(++i))<<16|(255&t.charCodeAt(++i))<<24))+((1540483477*(n>>>16)&65535)<<16),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++i;switch(r){case 3:o^=(255&t.charCodeAt(i+2))<<16;case 2:o^=(255&t.charCodeAt(i+1))<<8;case 1:o=1540483477*(65535&(o^=255&t.charCodeAt(i)))+((1540483477*(o>>>16)&65535)<<16)}return o=1540483477*(65535&(o^=o>>>13))+((1540483477*(o>>>16)&65535)<<16),(o^=o>>>15)>>>0};var ha=ca,da=pa.exports;la.exports=ha,la.exports.murmur3=ha,la.exports.murmur2=da;var fa=h(la.exports);class ga{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,r){this.ids.push(ma(t)),this.positions.push(e,n,r)}getPositions(t){const e=ma(t);let n=0,r=this.ids.length-1;for(;n<r;){const t=n+r>>1;this.ids[t]>=e?r=t:n=t+1}const o=[];for(;this.ids[n]===e;)o.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return o}static serialize(t,e){const n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,n,r,o){for(;r<o;){const i=e[r+o>>1];let s=r-1,a=o+1;for(;;){do{s++}while(e[s]<i);do{a--}while(e[a]>i);if(s>=a)break;ya(e,s,a),ya(n,3*s,3*a),ya(n,3*s+1,3*a+1),ya(n,3*s+2,3*a+2)}a-r<o-a?(t(e,n,r,a),r=a+1):(t(e,n,a+1,o),o=a)}}(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}}static deserialize(t){const e=new ga;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function ma(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:fa(String(t))}function ya(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}Vo(ga,"FeaturePositionMap");class va{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,e){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,e),this.initialized=!0),!!this.location}}class _a extends va{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class wa extends va{constructor(t){super(t),this.current=[0,0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}class Ca extends va{constructor(t){super(t),this.current=Ae.transparent}set(t,e,n){this.fetchUniformLocation(t,e)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}const ba=new Float32Array(16),xa=new Float32Array(9),Ea=new Float32Array(4);function Sa(t){return[vs(255*t.r,255*t.g),vs(255*t.b,255*t.a)]}class Ta{constructor(t,e,n){this.value=t,this.uniformNames=e.map(t=>"u_".concat(t)),this.type=n}setUniform(t,e,n,r,o){e.set(t,o,r.constantOr(this.value))}getBinding(t,e){return"color"===this.type?new Ca(t):new _a(t)}}class Ra{constructor(t,e){this.uniformNames=e.map(t=>"u_".concat(t)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,e,n,r,o){const i="u_pattern"===o||"u_dash"===o?this.pattern:"u_pixel_ratio"===o?this.pixelRatio:null;i&&e.set(t,o,i)}getBinding(t,e){return"u_pattern"===e||"u_dash"===e?new wa(t):new _a(t)}}class Pa{constructor(t,e,n,r){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:"a_".concat(t),type:"Float32",components:"color"===n?2:1,offset:0})),this.paintVertexArray=new r}populatePaintArray(t,e,n,r,o,i){const s=this.paintVertexArray.length,a=this.expression.evaluate(new is(0),e,{},o,r,i);this.paintVertexArray.resize(t),this._setPaintValue(s,t,a)}updatePaintArray(t,e,n,r,o){const i=this.expression.evaluate({zoom:0},n,r,void 0,o);this._setPaintValue(t,e,i)}_setPaintValue(t,e,n){if("color"===this.type){const r=Sa(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Oa{constructor(t,e,n,r,o,i){this.expression=t,this.uniformNames=e.map(t=>"u_".concat(t,"_t")),this.type=n,this.useIntegerZoom=r,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:"a_".concat(t),type:"Float32",components:"color"===n?4:2,offset:0})),this.paintVertexArray=new i}populatePaintArray(t,e,n,r,o,i){const s=this.expression.evaluate(new is(this.zoom),e,{},o,r,i),a=this.expression.evaluate(new is(this.zoom+1),e,{},o,r,i),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,s,a)}updatePaintArray(t,e,n,r,o){const i=this.expression.evaluate({zoom:this.zoom},n,r,void 0,o),s=this.expression.evaluate({zoom:this.zoom+1},n,r,void 0,o);this._setPaintValue(t,e,i,s)}_setPaintValue(t,e,n,r){if("color"===this.type){const o=Sa(n),i=Sa(r);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,o[0],o[1],i[0],i[1])}else{for(let o=t;o<e;o++)this.paintVertexArray.emplace(o,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e,n,r,o){const i=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,s=R(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(t,o,s)}getBinding(t,e){return new _a(t)}}class Ia{constructor(t,e,n,r,o){this.expression=t,this.layerId=o,this.paintVertexAttributes=("array"===n?aa:sa).members;for(let i=0;i<e.length;++i);this.paintVertexArray=new r}populatePaintArray(t,e,n){const r=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,r,o,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)}_setPaintValues(t,e,n,r){if(!r||!n)return;const o=r[n];if(!o)return;const{tl:i,br:s,pixelRatio:a}=o;for(let l=t;l<e;l++)this.paintVertexArray.emplace(l,i[0],i[1],s[0],s[1],a)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Aa{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.binders={},this._buffers=[];const r=[];for(const o in t.paint._values){if(!n(o))continue;const i=t.paint.get(o);if(!(i instanceof hs&&Ar(i.property.specification)))continue;const s=La(o,t.type),a=i.value,l=i.property.specification.type,u=!!i.property.useIntegerZoom,c="line-dasharray"===o||o.endsWith("pattern"),p="line-dasharray"===o&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==a.kind||p)if("source"===a.kind||p||c){const e=ka(o,l,"source");this.binders[o]=c?new Ia(a,s,l,e,t.id):new Pa(a,s,l,e),r.push("/a_".concat(o))}else{const t=ka(o,l,"composite");this.binders[o]=new Oa(a,s,l,u,e,t),r.push("/z_".concat(o))}else this.binders[o]=c?new Ra(a.value,s):new Ta(a.value,s,l),r.push("/u_".concat(o))}this.cacheKey=r.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Pa||e instanceof Oa?e.maxValue:0}populatePaintArrays(t,e,n,r,o,i){for(const s in this.binders){const a=this.binders[s];(a instanceof Pa||a instanceof Oa||a instanceof Ia)&&a.populatePaintArray(t,e,n,r,o,i)}}setConstantPatternPositions(t){for(const e in this.binders){const n=this.binders[e];n instanceof Ra&&n.setConstantPatternPositions(t)}}updatePaintArrays(t,e,n,r,o,i){let s=!1;for(const a in t){const l=e.getPositions(a);for(const e of l){const l=n.feature(e.index);for(const n in this.binders){const u=this.binders[n];if((u instanceof Pa||u instanceof Oa||u instanceof Ia)&&!0===u.expression.isStateDependent){const c=r.paint.get(n);u.expression=c.value,u.updatePaintArray(e.start,e.end,l,t[a],o,i),s=!0}}}}return s}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Ta||n instanceof Ra)&&t.push(...n.uniformNames.map(t=>"#define HAS_UNIFORM_".concat(t)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Pa||n instanceof Oa||n instanceof Ia)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Ta||n instanceof Ra||n instanceof Oa)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const e=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Ta||r instanceof Ra||r instanceof Oa)for(const o of r.uniformNames)e.push({name:o,property:n,binding:r.getBinding(t,o)})}return e}setUniforms(t,e,n,r,o){for(const{name:i,property:s,binding:a}of n)this.binders[s].setUniform(t,a,o,r.get(s),i)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const e=this.binders[t];(e instanceof Pa||e instanceof Oa||e instanceof Ia)&&e.paintVertexBuffer&&this._buffers.push(e.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof Pa||n instanceof Oa||n instanceof Ia)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Pa||e instanceof Oa||e instanceof Ia)&&e.destroy()}}}class Da{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const r of t)this.programConfigurations[r.id]=new Aa(r,e,n);this.needsUpload=!1,this._featureMap=new ga,this._bufferOffset=0}populatePaintArrays(t,e,n,r,o,i,s){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,r,o,i,s);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,r,o){for(const i of n)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(t,this._featureMap,e,i,r,o)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Ma={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function La(t,e){return Ma[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}const Na={"line-pattern":{source:Os,composite:Os},"fill-pattern":{source:Os,composite:Os},"fill-extrusion-pattern":{source:Os,composite:Os},"line-dasharray":{source:Is,composite:Is}},Fa={color:{source:Ks,composite:Ps},number:{source:Hs,composite:Ks}};function ka(t,e,n){const r=Na[t];return r&&r[n]||Fa[e][n]}Vo(Ta,"ConstantBinder"),Vo(Ra,"PatternConstantBinder"),Vo(Pa,"SourceExpressionBinder"),Vo(Ia,"PatternCompositeBinder"),Vo(Oa,"CompositeExpressionBinder"),Vo(Aa,"ProgramConfiguration",{omit:["_buffers"]}),Vo(Da,"ProgramConfigurationSet");const Ga="-transition";class Ba extends $t{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new ps(e.layout)),e.paint)){this._transitionablePaint=new ls(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ds(e.paint)}}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=e&&this._validate(Mo,"layers.".concat(this.id,".layout.").concat(t),t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return B(t,Ga)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&this._validate(Do,"layers.".concat(this.id,".paint.").concat(t),t,e,n))return!1;if(B(t,Ga))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const n=this._transitionablePaint._values[t],r=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const i=this._transitionablePaint._values[t].value,s=i.isDataDriven(),a=B(t,"pattern")||"line-dasharray"===t;return s||r||a||this._handleOverridablePaintPropertyUpdate(t,o,i)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),z(t,(t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length))}_validate(t,e,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!o||!1!==o.validate)&&No(this,t.call(Ao,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof hs&&Ar(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ro(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Va=bs([{name:"a_pos",components:2,type:"Int16"}],4),za=bs([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ja{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=t}prepareSegment(t,e,n,r){let o=this.segments[this.segments.length-1];return t>ja.MAX_VERTEX_ARRAY_LENGTH&&U("Max vertices per segment is ".concat(ja.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t)),(!o||o.vertexLength+t>ja.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==r)&&(o={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(o.sortKey=r),this.segments.push(o)),o}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,r){return new ja([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}}ja.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vo(ja,"SegmentVector");var Ha=8192;class Ua{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof _u?new _u(t.lng,t.lat):_u.convert(t),this}setSouthWest(t){return this._sw=t instanceof _u?new _u(t.lng,t.lat):_u.convert(t),this}extend(t){const e=this._sw,n=this._ne;let r,o;if(t instanceof _u)r=t,o=t;else{if(!(t instanceof Ua))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ua.convert(t)):this.extend(_u.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(_u.convert(t)):this;if(r=t._sw,o=t._ne,!r||!o)return this}return e||n?(e.lng=Math.min(r.lng,e.lng),e.lat=Math.min(r.lat,e.lat),n.lng=Math.max(o.lng,n.lng),n.lat=Math.max(o.lat,n.lat)):(this._sw=new _u(r.lng,r.lat),this._ne=new _u(o.lng,o.lat)),this}getCenter(){return new _u((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new _u(this.getWest(),this.getNorth())}getSouthEast(){return new _u(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=_u.convert(t);let r=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&r}static convert(t){return!t||t instanceof Ua?t:new Ua(t)}}var Wa=1e-6,qa="undefined"!=typeof Float32Array?Float32Array:Array;function Xa(){var t=new qa(9);return qa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ka(t,e,n){var r=e[0],o=e[1],i=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=n[0],d=n[1],f=n[2],g=n[3],m=n[4],y=n[5],v=n[6],_=n[7],w=n[8];return t[0]=h*r+d*s+f*u,t[1]=h*o+d*a+f*c,t[2]=h*i+d*l+f*p,t[3]=g*r+m*s+y*u,t[4]=g*o+m*a+y*c,t[5]=g*i+m*l+y*p,t[6]=v*r+_*s+w*u,t[7]=v*o+_*a+w*c,t[8]=v*i+_*l+w*p,t}function Ya(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Za(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],p=e[9],h=e[10],d=e[11],f=e[12],g=e[13],m=e[14],y=e[15],v=n*a-r*s,_=n*l-o*s,w=n*u-i*s,C=r*l-o*a,b=r*u-i*a,x=o*u-i*l,E=c*g-p*f,S=c*m-h*f,T=c*y-d*f,R=p*m-h*g,P=p*y-d*g,O=h*y-d*m,I=v*O-_*P+w*R+C*T-b*S+x*E;return I?(t[0]=(a*O-l*P+u*R)*(I=1/I),t[1]=(o*P-r*O-i*R)*I,t[2]=(g*x-m*b+y*C)*I,t[3]=(h*b-p*x-d*C)*I,t[4]=(l*T-s*O-u*S)*I,t[5]=(n*O-o*T+i*S)*I,t[6]=(m*w-f*x-y*_)*I,t[7]=(c*x-h*w+d*_)*I,t[8]=(s*P-a*T+u*E)*I,t[9]=(r*T-n*P-i*E)*I,t[10]=(f*b-g*w+y*v)*I,t[11]=(p*w-c*b-d*v)*I,t[12]=(a*S-s*R-l*E)*I,t[13]=(n*R-r*S+o*E)*I,t[14]=(g*_-f*C-m*v)*I,t[15]=(c*C-p*_+h*v)*I,t):null}function Qa(t,e,n){var r=e[0],o=e[1],i=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],w=n[1],C=n[2],b=n[3];return t[0]=_*r+w*a+C*p+b*g,t[1]=_*o+w*l+C*h+b*m,t[2]=_*i+w*u+C*d+b*y,t[3]=_*s+w*c+C*f+b*v,t[4]=(_=n[4])*r+(w=n[5])*a+(C=n[6])*p+(b=n[7])*g,t[5]=_*o+w*l+C*h+b*m,t[6]=_*i+w*u+C*d+b*y,t[7]=_*s+w*c+C*f+b*v,t[8]=(_=n[8])*r+(w=n[9])*a+(C=n[10])*p+(b=n[11])*g,t[9]=_*o+w*l+C*h+b*m,t[10]=_*i+w*u+C*d+b*y,t[11]=_*s+w*c+C*f+b*v,t[12]=(_=n[12])*r+(w=n[13])*a+(C=n[14])*p+(b=n[15])*g,t[13]=_*o+w*l+C*h+b*m,t[14]=_*i+w*u+C*d+b*y,t[15]=_*s+w*c+C*f+b*v,t}function Ja(t,e,n){var r,o,i,s,a,l,u,c,p,h,d,f,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(o=e[1],i=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=r=e[0],t[1]=o,t[2]=i,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=r*g+a*m+p*y+e[12],t[13]=o*g+l*m+h*y+e[13],t[14]=i*g+u*m+d*y+e[14],t[15]=s*g+c*m+f*y+e[15]),t}function $a(t,e,n){var r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function tl(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+u*r,t[5]=s*o+c*r,t[6]=a*o+p*r,t[7]=l*o+h*r,t[8]=u*o-i*r,t[9]=c*o-s*r,t[10]=p*o-a*r,t[11]=h*o-l*r,t}function el(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o-u*r,t[1]=s*o-c*r,t[2]=a*o-p*r,t[3]=l*o-h*r,t[8]=i*r+u*o,t[9]=s*r+c*o,t[10]=a*r+p*o,t[11]=l*r+h*o,t}function nl(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rl(t,e,n){var r,o,i,s=n[0],a=n[1],l=n[2],u=Math.hypot(s,a,l);return u<Wa?null:(s*=u=1/u,a*=u,l*=u,r=Math.sin(e),o=Math.cos(e),t[0]=s*s*(i=1-o)+o,t[1]=a*s*i+l*r,t[2]=l*s*i-a*r,t[3]=0,t[4]=s*a*i-l*r,t[5]=a*a*i+o,t[6]=l*a*i+s*r,t[7]=0,t[8]=s*l*i+a*r,t[9]=a*l*i-s*r,t[10]=l*l*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ol=Qa;function il(){var t=new qa(3);return qa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function sl(t){var e=new qa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function al(t){return Math.hypot(t[0],t[1],t[2])}function ll(t,e,n){var r=new qa(3);return r[0]=t,r[1]=e,r[2]=n,r}function ul(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function cl(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function pl(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function hl(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function dl(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function fl(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function gl(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function ml(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function yl(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function vl(t,e,n){var r=e[0],o=e[1],i=e[2],s=n[0],a=n[1],l=n[2];return t[0]=o*l-i*a,t[1]=i*s-r*l,t[2]=r*a-o*s,t}function _l(t,e,n){var r=e[0],o=e[1],i=e[2],s=n[3]*r+n[7]*o+n[11]*i+n[15];return t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/(s=s||1),t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/s,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/s,t}function wl(t,e,n){var r=n[0],o=n[1],i=n[2],s=e[0],a=e[1],l=e[2],u=o*l-i*a,c=i*s-r*l,p=r*a-o*s,h=o*p-i*c,d=i*u-r*p,f=r*c-o*u,g=2*n[3];return c*=g,p*=g,d*=2,f*=2,t[0]=s+(u*=g)+(h*=2),t[1]=a+c+d,t[2]=l+p+f,t}var Cl,bl=cl,xl=pl,El=al;function Sl(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Tl(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],s=n*n+r*r+o*o+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=o*s,t[3]=i*s,t}function Rl(t,e,n){var r=e[0],o=e[1],i=e[2],s=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*s,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*s,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*s,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*s,t}function Pl(){var t=new qa(4);return qa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ol(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Il(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+s*a,t[1]=o*l+i*a,t[2]=i*l-o*a,t[3]=s*l-r*a,t}function Al(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l-i*a,t[1]=o*l+s*a,t[2]=i*l+r*a,t[3]=s*l-o*a,t}il(),Cl=new qa(4),qa!=Float32Array&&(Cl[0]=0,Cl[1]=0,Cl[2]=0,Cl[3]=0);var Dl=Tl;il(),ll(1,0,0),ll(0,1,0),Pl(),Pl(),Xa();const Ml=bs([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ll}=Ml,Nl=bs([{name:"a_pos_3",components:3,type:"Int16"}]);var Fl=bs([{name:"a_pos",type:"Int16",components:2}]);class kl{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(t,e,n){const r=yl(e,this.dir);if(Math.abs(r)<1e-6)return!1;const o=((t[0]-this.pos[0])*e[0]+(t[1]-this.pos[1])*e[1]+(t[2]-this.pos[2])*e[2])/r;return n[0]=this.pos[0]+this.dir[0]*o,n[1]=this.pos[1]+this.dir[1]*o,n[2]=this.pos[2]+this.dir[2]*o,!0}closestPointOnSphere(t,e,n){if(function(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],s=e[1],a=e[2];return Math.abs(n-i)<=Wa*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=Wa*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-a)<=Wa*Math.max(1,Math.abs(o),Math.abs(a))}(this.pos,t)||0===e)return n[0]=n[1]=n[2]=0,!1;const[r,o,i]=this.dir,s=this.pos[0]-t[0],a=this.pos[1]-t[1],l=this.pos[2]-t[2],u=r*r+o*o+i*i,c=2*(s*r+a*o+l*i),p=c*c-4*u*(s*s+a*a+l*l-e*e);if(p<0){const t=Math.max(-c/2,0),u=s+r*t,p=a+o*t,h=l+i*t,d=Math.hypot(u,p,h);return n[0]=u*e/d,n[1]=p*e/d,n[2]=h*e/d,!1}{const t=(-c-Math.sqrt(p))/(2*u);if(t<0){const t=Math.hypot(s,a,l);return n[0]=s*e/t,n[1]=a*e/t,n[2]=l*e/t,!1}return n[0]=s+r*t,n[1]=a+o*t,n[2]=l+i*t,!0}}}class Gl{constructor(t,e,n,r,o){this.TL=t,this.TR=e,this.BR=n,this.BL=r,this.horizon=o}static fromInvProjectionMatrix(t,e,n){const r=[-1,1,1],o=[1,1,1],i=[1,-1,1],s=[-1,-1,1],a=_l(r,r,t),l=_l(o,o,t),u=_l(i,i,t),c=_l(s,s,t);return new Gl(a,l,u,c,e/n)}}class Bl{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(t,e,n,r){const o=Math.pow(2,n),i=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(n=>{const i=Rl([],n,t),s=1/i[3]/e*o;return function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}(i,i,[s,s,r?1/i[3]:s,s])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(t=>{const e=ml([],vl([],bl([],i[t[0]],i[t[1]]),bl([],i[t[2]],i[t[1]]))),n=-yl(e,i[t[1]]);return e.concat(n)});return new Bl(i,s)}}class Vl{static fromPoints(t){const e=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];for(const r of t)hl(e,e,r),dl(n,n,r);return new Vl(e,n)}static applyTransform(t,e){const n=t.getCorners();for(let r=0;r<n.length;++r)_l(n[r],n[r],e);return Vl.fromPoints(n)}constructor(t,e){this.min=t,this.max=e,this.center=fl([],ul([],this.min,this.max),.5)}quadrant(t){const e=[t%2==0,t<2],n=sl(this.min),r=sl(this.max);for(let o=0;o<e.length;o++)n[o]=e[o]?this.min[o]:this.center[o],r[o]=e[o]?this.center[o]:this.max[o];return r[2]=this.max[2],new Vl(n,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,e=this.max;return[[t[0],t[1],t[2]],[e[0],t[1],t[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],e[2]],[t[0],e[1],e[2]]]}intersects(t){const e=this.getCorners();let n=!0;for(let r=0;r<t.planes.length;r++){const o=t.planes[r];let i=0;for(let t=0;t<e.length;t++)i+=yl(o,e[t])+o[3]>=0;if(0===i)return 0;i!==e.length&&(n=!1)}if(n)return 2;for(let r=0;r<3;r++){let e=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let o=0;o<t.points.length;o++){const i=t.points[o][r]-this.min[r];e=Math.min(e,i),n=Math.max(n,i)}if(n<0||e>this.max[r]-this.min[r])return 0}return 1}}const zl=Ha/Math.PI/2,jl=[64,32,16],Hl=-zl,Ul=zl,Wl=[new Vl([Hl,Hl,Hl],[Ul,Ul,Ul]),new Vl([Hl,Hl,Hl],[0,0,Ul]),new Vl([0,Hl,Hl],[Ul,0,Ul]),new Vl([Hl,0,Hl],[0,Ul,Ul]),new Vl([0,0,Hl],[Ul,Ul,Ul])];function ql(t){return t*zl/mu}function Xl(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=fl([],t._camera.position,t.worldSize),i=[e,n,1,1];Rl(i,i,t.pixelMatrixInverse),Sl(i,i,1/i[3]);const s=ml([],bl([],i,o)),a=t.globeMatrix,l=[a[12],a[13],a[14]],u=bl([],l,o),c=al(u),p=ml([],u),h=t.worldSize/(2*Math.PI),d=yl(p,s),f=Math.asin(h/c);if(f<Math.acos(d)){if(!r)return null;const t=[],e=[];fl(t,s,c/d),ml(e,bl(e,t,u)),ml(s,ul(s,u,fl(s,e,Math.tan(f)*c)))}const g=[];new kl(o,s).closestPointOnSphere(l,h,g);const m=ml([],J(a,0)),y=ml([],J(a,1)),v=ml([],J(a,2)),_=yl(m,g),w=yl(y,g),C=yl(v,g),x=b(Math.asin(-w/h));let E=b(Math.atan2(_,C));E=t.center.lng+function(t,e){const n=(e-t+180)%360-180;return n<-180?n+360:n}(t.center.lng,E);const S=Cu(E),T=R(bu(x),0,1);return new Ou(S,T)}class Kl{constructor(t,e,n){this.a=bl([],t,n),this.b=bl([],e,n),this.center=n;const r=ml([],this.a),o=ml([],this.b);this.angle=Math.acos(yl(r,o))}}function Yl(t,e){if(0===t.angle)return null;let n;return n=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(t,e,n,r){const o=Math.sin(n);return t*(Math.sin((1-r)*n)/o)+e*(Math.sin(r*n)/o)}(t.a[e],t.b[e],t.angle,R(n,0,1))+t.center[e]}function Zl(t){if(t.z<=1)return Wl[t.z+2*t.y+t.x];const e=eu(tu(t));return Vl.fromPoints(e)}function Ql(t,e,n){return fl(t,t,1-n),gl(t,t,e,n)}function Jl(t,e){const n=cu(e.zoom);if(0===n)return Zl(t);const r=tu(t),o=eu(r),i=Cu(r.getWest())*e.worldSize,s=Cu(r.getEast())*e.worldSize,a=bu(r.getNorth())*e.worldSize,l=bu(r.getSouth())*e.worldSize,u=[i,a,0],c=[s,a,0],p=[i,l,0],h=[s,l,0],d=Za([],e.globeMatrix);return _l(u,u,d),_l(c,c,d),_l(p,p,d),_l(h,h,d),o[0]=Ql(o[0],p,n),o[1]=Ql(o[1],h,n),o[2]=Ql(o[2],c,n),o[3]=Ql(o[3],u,n),Vl.fromPoints(o)}function $l(t,e,n){for(const r of t)_l(r,r,e),fl(r,r,n)}function tu(t){let{x:e,y:n,z:r}=t;const o=1/(1<<r),i=new _u(Eu(e*o),Su((n+1)*o)),s=new _u(Eu((e+1)*o),Su(n*o));return new Ua(i,s)}function eu(t){const e=C(t.getNorth()),n=C(t.getSouth()),r=Math.cos(e),o=Math.cos(n),i=Math.sin(e),s=Math.sin(n),a=t.getWest(),l=t.getEast();return[nu(o,s,a),nu(o,s,l),nu(r,i,l),nu(r,i,a)]}function nu(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zl;return n=C(n),[t*Math.sin(n)*r,-e*r,t*Math.cos(n)*r]}function ru(t,e,n){return nu(Math.cos(C(t)),Math.sin(C(t)),e,n)}function ou(t,e,n,r){const o=1<<n.z,i=(t/Ha+n.x)/o;return ru(Su((e/Ha+n.y)/o),Eu(i),r)}function iu(t){let{min:e,max:n}=t;return 16383/Math.max(n[0]-e[0],n[1]-e[1],n[2]-e[2])}const su=new Float64Array(16);function au(t){const e=iu(t),n=nl(su,[e,e,e]);return Ja(n,n,((r=[])[0]=-(o=t.min)[0],r[1]=-o[1],r[2]=-o[2],r));var r,o}function lu(t){const e=(r=t.min,(n=su)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n);var n,r;const o=1/iu(t);return $a(e,e,[o,o,o])}function uu(t,e,n,r,o){const i=function(t){const e=Ha/(2*Math.PI);return t/(2*Math.PI)/e}(n),s=[t,e,-n/(2*Math.PI)],a=Ya(new Float64Array(16));return Ja(a,a,s),$a(a,a,[i,i,i]),tl(a,a,C(-o)),el(a,a,C(-r)),a}function cu(t){return P(5,6,t)}function pu(t,e){const n=ru(e.lat,e.lng);return i=(r=cl([],function(t){const e=ru(t._center.lat,t._center.lng);let n=vl([],ll(0,1,0),e);const r=rl([],-t.angle,e);n=_l(n,n,r),rl(r,-t._pitch,n);const o=ml([],e);return fl(o,o,ql(t.cameraToCenterDistance/t.pixelsPerMeter)),_l(o,o,r),ul([],e,o)}(t),n))[0],s=r[1],a=r[2],l=(o=n)[0],u=o[1],c=o[2],h=(p=Math.sqrt(i*i+s*s+a*a)*Math.sqrt(l*l+u*u+c*c))&&yl(r,o)/p,Math.acos(Math.min(Math.max(h,-1),1));var r,o,i,s,a,l,u,c,p,h}function hu(t,e){return pu(t,e)>Math.PI/2*1.01}const du=C(85),fu=Math.cos(du),gu=Math.sin(du),mu=6371008.8,yu=2*Math.PI*mu;class vu{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(e,")"));if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vu(O(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(t){const e=Math.PI/180,n=this.lat*e,r=t.lat*e,o=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return mu*Math.acos(Math.min(o,1))}toBounds(){const t=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,e=t/Math.cos(Math.PI/180*this.lat);return new Ua(new vu(this.lng-e,this.lat-t),new vu(this.lng+e,this.lat+t))}toEcef(t){const e=ql(t);return ru(this.lat,this.lng,zl+e)}static convert(t){if(t instanceof vu)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new vu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new vu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var _u=vu;function wu(t){return yu*Math.cos(t*Math.PI/180)}function Cu(t){return(180+t)/360}function bu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function xu(t,e){return t/wu(e)}function Eu(t){return 360*t-180}function Su(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Tu(t,e){return t*wu(Su(e))}const Ru=85.051129;function Pu(t){return 1/Math.cos(t*Math.PI/180)}class Ou{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=_u.convert(t);return new Ou(Cu(n.lng),bu(n.lat),xu(e,n.lat))}toLngLat(){return new _u(Eu(this.x),Su(this.y))}toAltitude(){return Tu(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yu*Pu(Su(this.y))}}function Iu(t,e,n,r,o,i,s,a,l){const u=(e+r)/2,c=(n+o)/2,p=new v(u,c);a(p),function(t,e,n,r,o,i){const s=n-o,a=r-i;return Math.abs((r-e)*s-(n-t)*a)/Math.hypot(s,a)}(p.x,p.y,i.x,i.y,s.x,s.y)>=l?(Iu(t,e,n,u,c,i,p,a,l),Iu(t,u,c,r,o,p,s,a,l)):t.push(s)}function Au(t,e,n){let r=t[0],o=r.x,i=r.y;e(r);const s=[r];for(let a=1;a<t.length;a++){const l=t[a],{x:u,y:c}=l;e(l),Iu(s,o,i,u,c,r,l,e,n),o=u,i=c,r=l}return s}function Du(t,e,n,r){if(r(e,n)){const o=e.add(n)._mult(.5);Du(t,e,o,r),Du(t,o,n,r)}else t.push(n)}function Mu(t,e){let n=t[0];const r=[n];for(let o=1;o<t.length;o++){const i=t[o];Du(r,n,i,e),n=i}return r}const Lu=Math.pow(2,14)-1,Nu=-Lu-1;function Fu(t,e){const n=Math.round(t.x*e),r=Math.round(t.y*e);return t.x=R(n,Nu,Lu),t.y=R(r,Nu,Lu),(n<t.x||n>t.x+1||r<t.y||r>t.y+1)&&U("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function ku(t,e,n){const r=t.loadGeometry(),o=t.extent,i=Ha/o;if(e&&n&&n.projection.isReprojectedInTileSpace){const i=1<<e.z,{scale:s,x:a,y:l,projection:u}=n,c=t=>{const n=Eu((e.x+t.x/o)/i),r=Su((e.y+t.y/o)/i),c=u.project(n,r);t.x=(c.x*s-a)*o,t.y=(c.y*s-l)*o};for(let e=0;e<r.length;e++)if(1!==t.type)r[e]=Au(r[e],c,1);else{const t=[];for(const n of r[e])n.x<0||n.x>=o||n.y<0||n.y>=o||(c(n),t.push(n));r[e]=t}}for(const s of r)for(const t of s)Fu(t,i);return r}function Gu(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ku(t):[]}}function Bu(t,e,n,r,o){t.emplaceBack(2*e+(r+1)/2,2*n+(o+1)/2)}function Vu(t,e,n){const r=16384;t.emplaceBack(e.x,e.y,e.z,n[0]*r,n[1]*r,n[2]*r)}class zu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Es,this.indexArray=new Vs,this.segments=new ja,this.programConfigurations=new Da(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n,r){const o=this.layers[0],i=[];let s=null;"circle"===o.type&&(s=o.layout.get("circle-sort-key"));for(const{feature:l,id:u,index:c,sourceLayerIndex:p}of t){const t=this.layers[0]._featureFilter.needGeometry,e=Gu(l,t);if(!this.layers[0]._featureFilter.filter(new is(this.zoom),e,n))continue;const o=s?s.evaluate(e,{},n):void 0,a={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:t?e.geometry:ku(l,n,r),patterns:{},sortKey:o};i.push(a)}s&&i.sort((t,e)=>t.sortKey-e.sortKey);let a=null;"globe"===r.projection.name&&(this.globeExtVertexArray=new As,a=r.projection);for(const l of i){const{geometry:r,index:o,sourceLayerIndex:i}=l,s=t[o].feature;this.addFeature(l,r,o,e.availableImages,n,a),e.featureIndex.insert(s,r,o,i,this.index)}}update(t,e,n,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Va.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,za.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,e,n,r,o,i){for(const s of e)for(const e of s){const n=e.x,r=e.y;if(n<0||n>=Ha||r<0||r>=Ha)continue;if(i){const t=i.projectTilePoint(n,r,o),e=i.upVector(o,n,r),s=this.globeExtVertexArray;Vu(s,t,e),Vu(s,t,e),Vu(s,t,e),Vu(s,t,e)}const s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=s.vertexLength;Bu(this.layoutVertexArray,n,r,-1,-1),Bu(this.layoutVertexArray,n,r,1,-1),Bu(this.layoutVertexArray,n,r,1,1),Bu(this.layoutVertexArray,n,r,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),s.vertexLength+=4,s.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},r,o)}}function ju(t,e){for(let n=0;n<t.length;n++)if(Qu(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Qu(t,e[n]))return!0;return!!qu(t,e)}function Hu(t,e,n){return!!Qu(t,e)||!!Ku(e,t,n)}function Uu(t,e){if(1===t.length)return Zu(e,t[0]);for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++)if(Qu(t,r[e]))return!0}for(let n=0;n<t.length;n++)if(Zu(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(qu(t,e[n]))return!0;return!1}function Wu(t,e,n){if(t.length>1){if(qu(t,e))return!0;for(let r=0;r<e.length;r++)if(Ku(e[r],t,n))return!0}for(let r=0;r<t.length;r++)if(Ku(t[r],e,n))return!0;return!1}function qu(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const r=t[n],o=t[n+1];for(let t=0;t<e.length-1;t++)if(Xu(r,o,e[t],e[t+1]))return!0}return!1}function Xu(t,e,n,r){return W(t,n,r)!==W(e,n,r)&&W(t,e,n)!==W(t,e,r)}function Ku(t,e,n){const r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(let o=1;o<e.length;o++)if(Yu(t,e[o-1],e[o])<r)return!0;return!1}function Yu(t,e,n){const r=e.distSqr(n);if(0===r)return t.distSqr(e);const o=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return t.distSqr(o<0?e:o>1?n:n.sub(e)._mult(o)._add(e))}function Zu(t,e){let n,r,o,i=!1;for(let s=0;s<t.length;s++){n=t[s];for(let t=0,s=n.length-1;t<n.length;s=t++)r=n[t],o=n[s],r.y>e.y!=o.y>e.y&&e.x<(o.x-r.x)*(e.y-r.y)/(o.y-r.y)+r.x&&(i=!i)}return i}function Qu(t,e){let n=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const i=t[r],s=t[o];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(n=!n)}return n}function Ju(t,e,n,r,o){for(const s of t)if(e<=s.x&&n<=s.y&&r>=s.x&&o>=s.y)return!0;const i=[new v(e,n),new v(e,o),new v(r,o),new v(r,n)];if(t.length>2)for(const s of i)if(Qu(t,s))return!0;for(let s=0;s<t.length-1;s++)if($u(t[s],t[s+1],i))return!0;return!1}function $u(t,e,n){const r=n[0],o=n[2];if(t.x<r.x&&e.x<r.x||t.x>o.x&&e.x>o.x||t.y<r.y&&e.y<r.y||t.y>o.y&&e.y>o.y)return!1;const i=W(t,e,n[0]);return i!==W(t,e,n[1])||i!==W(t,e,n[2])||i!==W(t,e,n[3])}function tc(t,e,n){const r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).getMaxValue(t)}function ec(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function nc(t,e,n,r,o){if(!e[0]&&!e[1])return t;const i=v.convert(e)._mult(o);"viewport"===n&&i._rotate(-r);const s=[];for(let a=0;a<t.length;a++)s.push(t[a].sub(i));return s}function rc(t,e,n,r){const o=v.convert(t)._mult(r);return"viewport"===e&&o._rotate(-n),o}Vo(zu,"CircleBucket",{omit:["layers"]});const oc=new ys({"circle-sort-key":new gs(te.layout_circle["circle-sort-key"])});var ic={paint:new ys({"circle-radius":new gs(te.paint_circle["circle-radius"]),"circle-color":new gs(te.paint_circle["circle-color"]),"circle-blur":new gs(te.paint_circle["circle-blur"]),"circle-opacity":new gs(te.paint_circle["circle-opacity"]),"circle-translate":new fs(te.paint_circle["circle-translate"]),"circle-translate-anchor":new fs(te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fs(te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fs(te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gs(te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gs(te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gs(te.paint_circle["circle-stroke-opacity"])}),layout:oc};function sc(t,e,n,r,o,i,s,a,l){if(i&&t.queryGeometry.isAboveHorizon)return!1;i&&(l*=t.pixelToTileUnitsFactor);const u=t.tileID.canonical,c=n.projection.upVectorScale(u,n.center.lat,n.worldSize).metersToTile;for(const p of e)for(const e of p){const p=e.add(a),h=o&&n.elevation?n.elevation.exaggeration()*o.getElevationAt(p.x,p.y,!0):0,d=n.projection.projectTilePoint(p.x,p.y,u);if(h>0){const t=n.projection.upVector(u,p.x,p.y);d.x+=t[0]*c*h,d.y+=t[1]*c*h,d.z+=t[2]*c*h}const f=i?p:ac(d.x,d.y,d.z,r),g=i?t.tilespaceRays.map(t=>cc(t,h)):t.queryGeometry.screenGeometry,m=Rl([],[d.x,d.y,d.z,1],r);if(!s&&i?l*=m[3]/n.cameraToCenterDistance:s&&!i&&(l*=n.cameraToCenterDistance/m[3]),i){const t=Su((e.y/Ha+u.y)/(1<<u.z));l/=n.projection.pixelsPerMeter(t,1)/xu(1,t)}if(Hu(g,f,l))return!0}return!1}function ac(t,e,n,r){const o=Rl([],[t,e,n,1],r);return new v(o[0]/o[3],o[1]/o[3])}const lc=ll(0,0,0),uc=ll(0,0,1);function cc(t,e){const n=il();return lc[2]=e,t.intersectsPlane(lc,uc,n),new v(n[0],n[1])}class pc extends zu{}function hc(t,e,n,r){let{width:o,height:i}=e;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==o*i*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(o*i*n);return t.width=o,t.height=i,t.data=r,t}function dc(t,e,n){const{width:r,height:o}=e;r===t.width&&o===t.height||(fc(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,o)},n),t.width=r,t.height=o,t.data=e.data)}function fc(t,e,n,r,o,i){if(0===o.width||0===o.height)return e;if(o.width>t.width||o.height>t.height||n.x>t.width-o.width||n.y>t.height-o.height)throw new RangeError("out of range source coordinates for image copy");if(o.width>e.width||o.height>e.height||r.x>e.width-o.width||r.y>e.height-o.height)throw new RangeError("out of range destination coordinates for image copy");const s=t.data,a=e.data;for(let l=0;l<o.height;l++){const u=((n.y+l)*t.width+n.x)*i,c=((r.y+l)*e.width+r.x)*i;for(let t=0;t<o.width*i;t++)a[c+t]=s[u+t]}return e}Vo(pc,"HeatmapBucket",{omit:["layers"]});class gc{constructor(t,e){hc(this,t,1,e)}resize(t){dc(this,new gc(t),1)}clone(){return new gc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,r,o){fc(t,e,n,r,o,1)}}class mc{constructor(t,e){hc(this,t,4,e)}resize(t){dc(this,new mc(t),4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new mc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,r,o){fc(t,e,n,r,o,4)}}Vo(gc,"AlphaImage"),Vo(mc,"RGBAImage");var yc={paint:new ys({"heatmap-radius":new gs(te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gs(te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fs(te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ms(te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fs(te.paint_heatmap["heatmap-opacity"])})};function vc(t){const e={},n=t.resolution||256,r=t.clips?t.clips.length:1,o=t.image||new mc({width:n,height:r}),i=(n,r,i)=>{e[t.evaluationKey]=i;const s=t.expression.evaluate(e);o.data[n+r+0]=Math.floor(255*s.r/s.a),o.data[n+r+1]=Math.floor(255*s.g/s.a),o.data[n+r+2]=Math.floor(255*s.b/s.a),o.data[n+r+3]=Math.floor(255*s.a)};if(t.clips)for(let s=0,a=0;s<r;++s,a+=4*n)for(let e=0,r=0;e<n;e++,r+=4){const o=e/(n-1),{start:l,end:u}=t.clips[s];i(a,r,l*(1-o)+u*o)}else for(let s=0,a=0;s<n;s++,a+=4)i(0,a,s/(n-1));return o}var _c={paint:new ys({"hillshade-illumination-direction":new fs(te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fs(te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fs(te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fs(te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fs(te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fs(te.paint_hillshade["hillshade-accent-color"])})};const wc=bs([{name:"a_pos",components:2,type:"Int16"}],4),{members:Cc}=wc;var bc={exports:{}};function xc(t,e,n){n=n||2;var r,o,i,s,a,l,u,c=e&&e.length,p=c?e[0]*n:t.length,h=Ec(t,0,p,n,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(t,e,n,r){var o,i,s,a=[];for(o=0,i=e.length;o<i;o++)(s=Ec(t,e[o]*r,o<i-1?e[o+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),a.push(Nc(s));for(a.sort(Ac),o=0;o<a.length;o++)n=Dc(a[o],n);return n}(t,e,h,n)),t.length>80*n){r=i=t[0],o=s=t[1];for(var f=n;f<p;f+=n)(a=t[f])<r&&(r=a),(l=t[f+1])<o&&(o=l),a>i&&(i=a),l>s&&(s=l);u=0!==(u=Math.max(i-r,s-o))?32767/u:0}return Tc(h,d,n,r,o,u,0),d}function Ec(t,e,n,r,o){var i,s;if(o===Kc(t,e,n,r)>0)for(i=e;i<n;i+=r)s=Wc(i,t[i],t[i+1],s);else for(i=n-r;i>=e;i-=r)s=Wc(i,t[i],t[i+1],s);return s&&Bc(s,s.next)&&(qc(s),s=s.next),s}function Sc(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Bc(r,r.next)&&0!==Gc(r.prev,r,r.next))r=r.next;else{if(qc(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Tc(t,e,n,r,o,i,s){if(t){!s&&i&&function(t,e,n,r){var o=t;do{0===o.z&&(o.z=Lc(o.x,o.y,e,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,r,o,i,s,a,l,u=1;do{for(n=t,t=null,i=null,s=0;n;){for(s++,r=n,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(o=n,n=n.nextZ,a--):(o=r,r=r.nextZ,l--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;n=r}i.nextZ=null,u*=2}while(s>1)}(o)}(t,r,o,i);for(var a,l,u=t;t.prev!==t.next;)if(a=t.prev,l=t.next,i?Pc(t,r,o,i):Rc(t))e.push(a.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),qc(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?Tc(t=Oc(Sc(t),e,n),e,n,r,o,i,2):2===s&&Ic(t,e,n,r,o,i):Tc(Sc(t),e,n,r,o,i,1);break}}}function Rc(t){var e=t.prev,n=t,r=t.next;if(Gc(e,n,r)>=0)return!1;for(var o=e.x,i=n.x,s=r.x,a=e.y,l=n.y,u=r.y,c=o<i?o<s?o:s:i<s?i:s,p=a<l?a<u?a:u:l<u?l:u,h=o>i?o>s?o:s:i>s?i:s,d=a>l?a>u?a:u:l>u?l:u,f=r.next;f!==e;){if(f.x>=c&&f.x<=h&&f.y>=p&&f.y<=d&&Fc(o,a,i,l,s,u,f.x,f.y)&&Gc(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Pc(t,e,n,r){var o=t.prev,i=t,s=t.next;if(Gc(o,i,s)>=0)return!1;for(var a=o.x,l=i.x,u=s.x,c=o.y,p=i.y,h=s.y,d=a<l?a<u?a:u:l<u?l:u,f=c<p?c<h?c:h:p<h?p:h,g=a>l?a>u?a:u:l>u?l:u,m=c>p?c>h?c:h:p>h?p:h,y=Lc(d,f,e,n,r),v=Lc(g,m,e,n,r),_=t.prevZ,w=t.nextZ;_&&_.z>=y&&w&&w.z<=v;){if(_.x>=d&&_.x<=g&&_.y>=f&&_.y<=m&&_!==o&&_!==s&&Fc(a,c,l,p,u,h,_.x,_.y)&&Gc(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,w.x>=d&&w.x<=g&&w.y>=f&&w.y<=m&&w!==o&&w!==s&&Fc(a,c,l,p,u,h,w.x,w.y)&&Gc(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;_&&_.z>=y;){if(_.x>=d&&_.x<=g&&_.y>=f&&_.y<=m&&_!==o&&_!==s&&Fc(a,c,l,p,u,h,_.x,_.y)&&Gc(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;w&&w.z<=v;){if(w.x>=d&&w.x<=g&&w.y>=f&&w.y<=m&&w!==o&&w!==s&&Fc(a,c,l,p,u,h,w.x,w.y)&&Gc(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Oc(t,e,n){var r=t;do{var o=r.prev,i=r.next.next;!Bc(o,i)&&Vc(o,r,r.next,i)&&Hc(o,i)&&Hc(i,o)&&(e.push(o.i/n|0),e.push(r.i/n|0),e.push(i.i/n|0),qc(r),qc(r.next),r=t=i),r=r.next}while(r!==t);return Sc(r)}function Ic(t,e,n,r,o,i){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&kc(s,a)){var l=Uc(s,a);return s=Sc(s,s.next),l=Sc(l,l.next),Tc(s,e,n,r,o,i,0),void Tc(l,e,n,r,o,i,0)}a=a.next}s=s.next}while(s!==t)}function Ac(t,e){return t.x-e.x}function Dc(t,e){var n=function(t,e){var n,r=e,o=t.x,i=t.y,s=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>s&&(s=a,n=r.x<r.next.x?r:r.next,a===o))return n}r=r.next}while(r!==e);if(!n)return null;var l,u=n,c=n.x,p=n.y,h=1/0;r=n;do{o>=r.x&&r.x>=c&&o!==r.x&&Fc(i<p?o:s,i,c,p,i<p?s:o,i,r.x,r.y)&&(l=Math.abs(i-r.y)/(o-r.x),Hc(r,t)&&(l<h||l===h&&(r.x>n.x||r.x===n.x&&Mc(n,r)))&&(n=r,h=l)),r=r.next}while(r!==u);return n}(t,e);if(!n)return e;var r=Uc(n,t);return Sc(r,r.next),Sc(n,n.next)}function Mc(t,e){return Gc(t.prev,t,e.prev)<0&&Gc(e.next,t,t.next)<0}function Lc(t,e,n,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Nc(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Fc(t,e,n,r,o,i,s,a){return(o-s)*(e-a)>=(t-s)*(i-a)&&(t-s)*(r-a)>=(n-s)*(e-a)&&(n-s)*(i-a)>=(o-s)*(r-a)}function kc(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Vc(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Hc(t,e)&&Hc(e,t)&&function(t,e){var n=t,r=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Gc(t.prev,t,e.prev)||Gc(t,e.prev,e))||Bc(t,e)&&Gc(t.prev,t,t.next)>0&&Gc(e.prev,e,e.next)>0)}function Gc(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Bc(t,e){return t.x===e.x&&t.y===e.y}function Vc(t,e,n,r){var o=jc(Gc(t,e,n)),i=jc(Gc(t,e,r)),s=jc(Gc(n,r,t)),a=jc(Gc(n,r,e));return o!==i&&s!==a||!(0!==o||!zc(t,n,e))||!(0!==i||!zc(t,r,e))||!(0!==s||!zc(n,t,r))||!(0!==a||!zc(n,e,r))}function zc(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function jc(t){return t>0?1:t<0?-1:0}function Hc(t,e){return Gc(t.prev,t,t.next)<0?Gc(t,e,t.next)>=0&&Gc(t,t.prev,e)>=0:Gc(t,e,t.prev)<0||Gc(t,t.next,e)<0}function Uc(t,e){var n=new Xc(t.i,t.x,t.y),r=new Xc(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Wc(t,e,n,r){var o=new Xc(t,e,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function qc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Xc(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Kc(t,e,n,r){for(var o=0,i=e,s=n-r;i<n;i+=r)o+=(t[s]-t[i])*(t[i+1]+t[s+1]),s=i;return o}bc.exports=xc,bc.exports.default=xc,xc.deviation=function(t,e,n,r){var o=e&&e.length,i=Math.abs(Kc(t,0,o?e[0]*n:t.length,n));if(o)for(var s=0,a=e.length;s<a;s++)i-=Math.abs(Kc(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n));var l=0;for(s=0;s<r.length;s+=3){var u=r[s]*n,c=r[s+1]*n,p=r[s+2]*n;l+=Math.abs((t[u]-t[p])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[p+1]-t[u+1]))}return 0===i&&0===l?0:Math.abs((l-i)/i)},xc.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var s=0;s<e;s++)n.vertices.push(t[o][i][s]);o>0&&n.holes.push(r+=t[o-1].length)}return n};var Yc=h(bc.exports);function Zc(t,e,n,r,o){!function t(e,n,r,o,i){for(;o>r;){if(o-r>600){var s=o-r+1,a=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-a*u/s+c)),Math.min(o,Math.floor(n+(s-a)*u/s+c)),i)}var p=e[n],h=r,d=o;for(Qc(e,r,n),i(e[o],p)>0&&Qc(e,r,o);h<d;){for(Qc(e,h,d),h++,d--;i(e[h],p)<0;)h++;for(;i(e[d],p)>0;)d--}0===i(e[r],p)?Qc(e,r,d):Qc(e,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(t,e,n||0,r||t.length-1,o||Jc)}function Qc(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Jc(t,e){return t<e?-1:t>e?1:0}function $c(t,e){const n=t.length;if(n<=1)return[t];const r=[];let o,i;for(let s=0;s<n;s++){const e=q(t[s]);0!==e&&(t[s].area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(o&&r.push(o),o=[t[s]]):o.push(t[s]))}if(o&&r.push(o),e>1)for(let s=0;s<r.length;s++)r[s].length<=e||(Zc(r[s],e,1,r[s].length-1,tp),r[s]=r[s].slice(0,e));return r}function tp(t,e){return e.area-t.area}function ep(t,e,n){const r=n.patternDependencies;let o=!1;for(const i of e){const e=i.paint.get("".concat(t,"-pattern"));e.isConstant()||(o=!0);const n=e.constantOr(null);n&&(o=!0,r[n]=!0)}return o}function np(t,e,n,r,o){const i=o.patternDependencies;for(const s of e){const e=s.paint.get("".concat(t,"-pattern")).value;if("constant"!==e.kind){let t=e.evaluate({zoom:r},n,{},o.availableImages);t=t&&t.name?t.name:t,i[t]=!0,n.patterns[s.id]=t}}return n}class rp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Es,this.indexArray=new Vs,this.indexArray2=new qs,this.programConfigurations=new Da(t.layers,t.zoom),this.segments=new ja,this.segments2=new ja,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.projection=t.projection}populate(t,e,n,r){this.hasPattern=ep("fill",this.layers,e);const o=this.layers[0].layout.get("fill-sort-key"),i=[];for(const{feature:s,id:a,index:l,sourceLayerIndex:u}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Gu(s,t);if(!this.layers[0]._featureFilter.filter(new is(this.zoom),c,n))continue;const p=o?o.evaluate(c,{},n,e.availableImages):void 0,h={id:a,properties:s.properties,type:s.type,sourceLayerIndex:u,index:l,geometry:t?c.geometry:ku(s,n,r),patterns:{},sortKey:p};i.push(h)}o&&i.sort((t,e)=>t.sortKey-e.sortKey);for(const s of i){const{geometry:r,index:o,sourceLayerIndex:i}=s;if(this.hasPattern){const t=np("fill",this.layers,s,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(s,r,o,n,{},e.availableImages);e.featureIndex.insert(t[o].feature,r,o,i,this.index)}}update(t,e,n,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,r)}addFeatures(t,e,n,r,o){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Cc),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];for(const s of $c(e,500)){let t=0;for(const a of s)t+=a.length;const e=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=e.vertexLength,r=[],o=[];for(const a of s){if(0===a.length)continue;a!==s[0]&&o.push(r.length/2);const t=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),e=t.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(e+a.length-1,e),r.push(a[0].x),r.push(a[0].y);for(let n=1;n<a.length;n++)this.layoutVertexArray.emplaceBack(a[n].x,a[n].y),this.indexArray2.emplaceBack(e+n-1,e+n),r.push(a[n].x),r.push(a[n].y);t.vertexLength+=a.length,t.primitiveLength+=a.length}const i=Yc(r,o);for(let s=0;s<i.length;s+=3)this.indexArray.emplaceBack(n+i[s],n+i[s+1],n+i[s+2]);e.vertexLength+=t,e.primitiveLength+=i.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i,r)}}Vo(rp,"FillBucket",{omit:["layers","patternFeatures"]});const op=new ys({"fill-sort-key":new gs(te.layout_fill["fill-sort-key"])});var ip={paint:new ys({"fill-antialias":new fs(te.paint_fill["fill-antialias"]),"fill-opacity":new gs(te.paint_fill["fill-opacity"]),"fill-color":new gs(te.paint_fill["fill-color"]),"fill-outline-color":new gs(te.paint_fill["fill-outline-color"]),"fill-translate":new fs(te.paint_fill["fill-translate"]),"fill-translate-anchor":new fs(te.paint_fill["fill-translate-anchor"]),"fill-pattern":new gs(te.paint_fill["fill-pattern"])}),layout:op};const sp=bs([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ap=bs([{name:"a_centroid_pos",components:2,type:"Uint16"}]),lp=bs([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:up}=sp;var cp={},pp=m,hp=dp;function dp(t,e,n,r,o){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=o,t.readFields(fp,this,e)}function fp(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],o=e._values[t.readVarint()];e.properties[r]=o}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function gp(t){for(var e,n,r=0,o=0,i=t.length,s=i-1;o<i;s=o++)r+=((n=t[s]).x-(e=t[o]).x)*(e.y+n.y);return r}dp.types=["Unknown","Point","LineString","Polygon"],dp.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,o=0,i=0,s=0,a=[];t.pos<n;){if(o<=0){var l=t.readVarint();r=7&l,o=l>>3}if(o--,1===r||2===r)i+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&a.push(e),e=[]),e.push(new pp(i,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&a.push(e),a},dp.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,o=0,i=0,s=1/0,a=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(o+=t.readSVarint())<s&&(s=o),o>a&&(a=o),(i+=t.readSVarint())<l&&(l=i),i>u&&(u=i);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,a,u]},dp.prototype.toGeoJSON=function(t,e,n){var r,o,i=this.extent*Math.pow(2,n),s=this.extent*t,a=this.extent*e,l=this.loadGeometry(),u=dp.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+s)/i-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+a)/i)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(r=0;r<l.length;r++)p[r]=l[r][0];c(l=p);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,o=[],i=0;i<e;i++){var s=gp(t[i]);0!==s&&(void 0===r&&(r=s<0),r===s<0?(n&&o.push(n),n=[t[i]]):n.push(t[i]))}return n&&o.push(n),o}(l),r=0;r<l.length;r++)for(o=0;o<l[r].length;o++)c(l[r][o])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var mp=hp,yp=vp;function vp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(_p,this,e),this.length=this._features.length}function _p(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}vp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new mp(this._pbf,e,this.extent,this._keys,this._values)};var wp=yp;function Cp(t,e,n){if(3===t){var r=new wp(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}var bp=cp.VectorTile=function(t,e){this.layers=t.readFields(Cp,{},e)},xp=cp.VectorTileFeature=hp;function Ep(t,e,n,r){const o=[],i=0===r?(t,e,n,r,o,i)=>{t.push(new v(i,n+(i-e)/(r-e)*(o-n)))}:(t,e,n,r,o,i)=>{t.push(new v(e+(i-n)/(o-n)*(r-e),i))};for(const s of t){const t=[];for(const o of s){if(o.length<=2)continue;const s=[];for(let t=0;t<o.length-1;t++){const a=o[t].x,l=o[t].y,u=o[t+1].x,c=o[t+1].y,p=0===r?a:l,h=0===r?u:c;p<e?h>e&&i(s,a,l,u,c,e):p>n?h<n&&i(s,a,l,u,c,n):s.push(o[t]),h<e&&p>=e&&i(s,a,l,u,c,e),h>n&&p<=n&&i(s,a,l,u,c,n)}let a=o[o.length-1];const l=0===r?a.x:a.y;l>=e&&l<=n&&s.push(a),s.length&&(a=s[s.length-1],s[0].x===a.x&&s[0].y===a.y||s.push(s[0]),t.push(s))}t.length&&o.push(t)}return o}cp.VectorTileLayer=yp;const Sp=xp.types,Tp=Math.pow(2,13);function Rp(t,e,n,r,o,i,s,a){t.emplaceBack((e<<1)+s,(n<<1)+i,(Math.floor(r*Tp)<<1)+o,Math.round(a))}function Pp(t,e,n){const r=16384;t.emplaceBack(e.x,e.y,e.z,n[0]*r,n[1]*r,n[2]*r)}class Op{constructor(){this.acc=new v(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new v(t.x,t.y),this.max=new v(t.x,t.y))}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);const n=this.min,r=this.max;t.x<n.x?n.x=t.x:t.x>r.x&&(r.x=t.x),t.y<n.y?n.y=t.y:t.y>r.y&&(r.y=t.y),((0===t.x||t.x===Ha)&&t.x===e.x)!=((0===t.y||t.y===Ha)&&t.y===e.y)&&this.processBorderOverlap(t,e),e.x<0!=t.x<0&&this.addBorderIntersection(0,An(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>Ha!=t.x>Ha&&this.addBorderIntersection(1,An(e.y,t.y,(Ha-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,An(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>Ha!=t.y>Ha&&this.addBorderIntersection(3,An(e.x,t.x,(Ha-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[t];e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const n=0===t.x?0:1;this.addBorderIntersection(n,e.y),this.addBorderIntersection(n,t.y)}else{const n=0===t.y?2:3;this.addBorderIntersection(n,e.x),this.addBorderIntersection(n,t.x)}}centroid(){const t=this.polyCount.reduce((t,e)=>t+e.edges,0);return 0!==t?this.acc.div(t)._round():new v(0,0)}span(){return new v(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,e)=>t+ +(e[0]!==Number.MAX_VALUE),0)}}class Ip{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new Ts,this.centroidVertexArray=new ia,this.indexArray=new Vs,this.programConfigurations=new Da(t.layers,t.zoom),this.segments=new ja,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.enableTerrain=t.enableTerrain}populate(t,e,n,r){this.features=[],this.hasPattern=ep("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/Ha/(1<<t.z)}(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:o,id:i,index:s,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,l=Gu(o,t);if(!this.layers[0]._featureFilter.filter(new is(this.zoom),l,n))continue;const u={id:i,sourceLayerIndex:a,index:s,geometry:t?l.geometry:ku(o,n,r),properties:o.properties,type:o.type,patterns:{}},c=this.layoutVertexArray.length;this.hasPattern?this.features.push(np("fill-extrusion",this.layers,u,this.zoom,e)):this.addFeature(u,u.geometry,s,n,{},e.availableImages,r),e.featureIndex.insert(o,u.geometry,s,a,this.index,c)}this.sortBorders()}addFeatures(t,e,n,r,o){for(const i of this.features){const{geometry:t}=i;this.addFeature(i,t,i.index,e,n,r,o)}this.sortBorders()}update(t,e,n,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,up),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,lp.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,ap.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,r,o,i,s){const a=[new v(0,0),new v(Ha,Ha)],l=s.projection,u="globe"===l.name,c=this.enableTerrain&&!u?new Op:null,p="Polygon"===Sp[t.type];u&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new As);const h=$c(e,500);for(let m=h.length-1;m>=0;m--){const t=h[m];(0===t.length||(d=t[0]).every(t=>t.x<=0)||d.every(t=>t.x>=Ha)||d.every(t=>t.y<=0)||d.every(t=>t.y>=Ha))&&h.splice(m,1)}var d;let f;if(u)f=Gp(h,a,r);else{f=[];for(const t of h)f.push({polygon:t,bounds:a})}const g=p?this.edgeRadius:0;for(const{polygon:m,bounds:y}of f){let t=0,e=0;for(const r of m)p&&!r[0].equals(r[r.length-1])&&r.push(r[0]),e+=p?r.length-1:r.length;const n=this.segments.prepareSegment((p?5:4)*e,this.layoutVertexArray,this.indexArray);if(p){const e=[],o=[];t=n.vertexLength;for(const t of m){let i,s;t.length&&t!==m[0]&&o.push(e.length/2),i=t[1].sub(t[0])._perp()._unit();for(let o=1;o<t.length;o++){const a=t[o],c=t[o===t.length-1?1:o+1];let{x:p,y:h}=a;if(g){s=c.sub(a)._perp()._unit();const t=i.add(s)._unit(),e=g*Math.min(4,1/(i.x*t.x+i.y*t.y));p+=e*t.x,h+=e*t.y,i=s}Rp(this.layoutVertexArray,p,h,0,0,1,1,0),n.vertexLength++,e.push(a.x,a.y),u&&Pp(this.layoutVertexExtArray,l.projectTilePoint(p,h,r),l.upVector(r,p,h))}}const i=Yc(e,o);for(let r=0;r<i.length;r+=3)this.indexArray.emplaceBack(t+i[r],t+i[r+2],t+i[r+1]),n.primitiveLength++}for(const o of m){c&&o.length&&c.startRing(o[0]);let e,i,s,a=o.length>4&&Np(o[o.length-2],o[0],o[1]),h=g?Dp(o[o.length-2],o[0],o[1],g):0;i=o[1].sub(o[0])._perp()._unit();let d=!0;for(let f=1,m=0;f<o.length;f++){let v=o[f-1],_=o[f];const w=o[f===o.length-1?1:f+1];if(c&&p&&c.currentPolyCount.top++,Lp(_,v,y)){g&&(i=w.sub(_)._perp()._unit(),d=!d);continue}c&&c.append(_,v);const C=_.sub(v)._perp(),b=C.x/(Math.abs(C.x)+Math.abs(C.y)),x=C.y>0?1:0,E=v.dist(_);if(m+E>32768&&(m=0),g){s=w.sub(_)._perp()._unit();let t=Mp(v,_,w,Ap(i,s),g);isNaN(t)&&(t=0);const e=_.sub(v)._unit();v=v.add(e.mult(h))._round(),_=_.add(e.mult(-t))._round(),h=t,i=s}const S=n.vertexLength,T=o.length>4&&Np(v,_,w);let R=Fp(m,a,d);if(Rp(this.layoutVertexArray,v.x,v.y,b,x,0,0,R),Rp(this.layoutVertexArray,v.x,v.y,b,x,0,1,R),m+=E,R=Fp(m,T,!d),a=T,Rp(this.layoutVertexArray,_.x,_.y,b,x,0,0,R),Rp(this.layoutVertexArray,_.x,_.y,b,x,0,1,R),n.vertexLength+=4,this.indexArray.emplaceBack(S+0,S+1,S+2),this.indexArray.emplaceBack(S+1,S+3,S+2),n.primitiveLength+=2,g){const r=t+(1===f?o.length-2:f-2),i=1===f?t:r+1;if(this.indexArray.emplaceBack(S+1,r,S+3),this.indexArray.emplaceBack(r,i,S+3),n.primitiveLength+=2,void 0===e&&(e=S),!Lp(w,o[f],y)){const t=f===o.length-1?e:n.vertexLength;this.indexArray.emplaceBack(S+2,S+3,t),this.indexArray.emplaceBack(S+3,t+1,t),this.indexArray.emplaceBack(S+3,i,t+1),n.primitiveLength+=3}d=!d}if(u){const t=this.layoutVertexExtArray,e=l.projectTilePoint(v.x,v.y,r),n=l.projectTilePoint(_.x,_.y,r),o=l.upVector(r,v.x,v.y),i=l.upVector(r,_.x,_.y);Pp(t,e,o),Pp(t,e,o),Pp(t,n,i),Pp(t,n,i)}}p&&(t+=o.length-1)}}if(c&&c.polyCount.length>0){if(c.borders){c.vertexArrayOffset=this.centroidVertexArray.length;const t=c.borders,e=this.featuresOnBorder.push(c)-1;for(let n=0;n<4;n++)t[n][0]!==Number.MAX_VALUE&&this.borders[n].push(e)}this.encodeCentroid(c.borders?void 0:c.centroid(),c)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i,r)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((e,n)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[n].borders[t][0])}encodeCentroid(t,e){let n,r,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t)if(0!==t.y){const o=e.span()._mult(this.tileToMeter);n=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(o.x/10)),r=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(o.y/10))}else n=Math.ceil(7*(t.x+450)),r=0;else n=0,r=+o;let i=o?this.centroidVertexArray.length:e.vertexArrayOffset;for(const s of e.polyCount){o&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*s.edges+s.top);for(let t=0;t<s.top;t++)this.centroidVertexArray.emplace(i++,n,r);for(let t=0;t<2*s.edges;t++)this.centroidVertexArray.emplace(i++,0,r),this.centroidVertexArray.emplace(i++,n,r)}}}function Ap(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function Dp(t,e,n,r){const o=e.sub(t)._perp()._unit(),i=n.sub(e)._perp()._unit();return Mp(t,e,n,Ap(o,i),r)}function Mp(t,e,n,r,o){const i=Math.sqrt(1-r*r);return Math.min(t.dist(e)/3,e.dist(n)/3,o*i/r)}function Lp(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function Np(t,e,n){if(t.x<0||t.x>=Ha||e.x<0||e.x>=Ha||n.x<0||n.x>=Ha)return!1;const r=n.sub(e),o=r.perp(),i=t.sub(e);return(r.x*i.x+r.y*i.y)/Math.sqrt((r.x*r.x+r.y*r.y)*(i.x*i.x+i.y*i.y))>-.866&&o.x*i.x+o.y*i.y<0}function Fp(t,e,n){const r=e?2|t:-3&t;return n?1|r:-2&r}function kp(){const t=Math.PI/32,e=Math.tan(t),n=mu;return n*Math.sqrt(1+2*e*e)-n}function Gp(t,e,n){const r=1<<n.z,o=Eu(n.x/r),i=Eu((n.x+1)/r),s=Su(n.y/r),a=Su((n.y+1)/r);return function(t,e,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0;const s=[];if(!t.length||!n||!r)return s;const a=(t,e)=>{for(const n of t)s.push({polygon:n,bounds:e})},l=Math.ceil(Math.log2(n)),u=Math.ceil(Math.log2(r)),c=l-u,p=[];for(let f=0;f<Math.abs(c);f++)p.push(c>0?0:1);for(let f=0;f<Math.min(l,u);f++)p.push(0),p.push(1);let h=t;if(h=Ep(h,e[0].y-o,e[1].y+o,1),h=Ep(h,e[0].x-o,e[1].x+o,0),!h.length)return s;const d=[];for(p.length?d.push({polygons:h,bounds:e,depth:0}):a(h,e);d.length;){const t=d.pop(),e=t.depth,n=p[e],r=t.bounds[0],s=t.bounds[1],l=0===n?r.x:r.y,u=0===n?s.x:s.y,c=i?i(n,l,u):.5*(l+u),h=Ep(t.polygons,l-o,c+o,n),f=Ep(t.polygons,c-o,u+o,n);if(h.length){const t=[r,new v(0===n?c:s.x,1===n?c:s.y)];p.length>e+1?d.push({polygons:h,bounds:t,depth:e+1}):a(h,t)}if(f.length){const t=[new v(0===n?c:r.x,1===n?c:r.y),s];p.length>e+1?d.push({polygons:f,bounds:t,depth:e+1}):a(f,t)}}return s}(t,e,Math.ceil((i-o)/11.25),Math.ceil((s-a)/11.25),1,(t,e,o)=>{if(0===t)return.5*(e+o);{const t=Su((n.y+e/Ha)/r);return(bu(.5*(Su((n.y+o/Ha)/r)+t))*r-n.y)*Ha}})}Vo(Ip,"FillExtrusionBucket",{omit:["layers","features"]}),Vo(Op,"PartMetadata");const Bp=new ys({"fill-extrusion-edge-radius":new fs(te["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Vp={paint:new ys({"fill-extrusion-opacity":new fs(te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gs(te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fs(te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fs(te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new gs(te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gs(te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gs(te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fs(te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new fs(te["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new fs(te["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new fs(te["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Bp};function zp(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class jp{constructor(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Wp(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const n=function(t,e,n){var r=zp(256*t,256*(e=Math.pow(2,n)-e-1),n),o=zp(256*(t+1),256*(e+1),n);return r[0]+","+r[1]+","+o[0]+","+o[1]}(this.x,this.y,this.z),r=function(t,e,n){let r,o="";for(let i=t;i>0;i--)r=1<<i-1,o+=(e&r?1:0)+(n&r?2:0);return o}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",r).replace("{bbox-epsg-3857}",n)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}class Hp{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Wp(t,e.z,e.z,e.x,e.y)}}class Up{constructor(t,e,n,r,o){this.overscaledZ=t,this.wrap=e,this.canonical=new jp(n,+r,+o),this.key=0===e&&t===n?this.canonical.key:Wp(e,t,n,r,o)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new Up(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Up(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return Wp(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-t;return Wp(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Up(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new Up(e,this.wrap,e,n,r),new Up(e,this.wrap,e,n+1,r),new Up(e,this.wrap,e,n,r+1),new Up(e,this.wrap,e,n+1,r+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Up(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Up(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Hp(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}}function Wp(t,e,n,r,o){const i=1<<Math.min(n,22);let s=i*(o%i)+r%i;return t&&n<22&&(s+=i*i*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*s+n)+(e-n)}Vo(jp,"CanonicalTileID"),Vo(Up,"OverscaledTileID",{omit:["projMatrix"]});class qp extends v{constructor(t,e,n){super(t,e),this.z=n}}function Xp(t,e){return t.x*e.x+t.y*e.y}function Kp(t,e){if(1===t.length){let n=0;const r=e[n++];let o;for(;!o||r.equals(o);)if(o=e[n++],!o)return 1/0;for(;n<e.length;n++){const i=e[n],s=t[0],a=o.sub(r),l=i.sub(r),u=s.sub(r),c=Xp(a,a),p=Xp(a,l),h=Xp(l,l),d=Xp(u,a),f=Xp(u,l),g=c*h-p*p,m=(h*d-p*f)/g,y=(c*f-p*d)/g,v=r.z*(1-m-y)+o.z*m+i.z*y;if(isFinite(v))return v}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}function Yp(t,e,n,r,o,i,s,a){const l=s*o.getElevationAt(t,e,!0,!0),u=0!==i[0],c=u?0===i[1]?s*(i[0]/7-450):s*function(t,e,n){const r=Math.floor(e[0]/8),o=Math.floor(e[1]/8),i=10*(e[0]-8*r),s=10*(e[1]-8*o),a=t.getElevationAt(r,o,!0,!0),l=t.getMeterToDEM(n),u=Math.floor(.5*(i*l-1)),c=Math.floor(.5*(s*l-1)),p=t.tileCoordToPixel(r,o),h=2*u+1,d=2*c+1,f=function(t,e,n,r,o){return[t.getElevationAtPixel(e,n,!0),t.getElevationAtPixel(e+o,n,!0),t.getElevationAtPixel(e,n+o,!0),t.getElevationAtPixel(e+r,n+o,!0)]}(t,p.x-u,p.y-c,h,d),g=Math.abs(f[0]-f[1]),m=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),v=Math.min(.25,.5*l*(g+m)/h),_=Math.min(.25,.5*l*y/d);return a+Math.max(v*i,_*s)}(o,i,a):l;return{base:l+(0===n)?-1:n,top:u?Math.max(c+r,l+n+2):l+r}}const Zp=bs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Qp}=Zp,Jp=bs([{name:"a_packed",components:4,type:"Float32"}]),{members:$p}=Jp,th=xp.types,eh=Math.cos(Math.PI/180*37.5);class nh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new Rs,this.layoutVertexArray2=new Ps,this.indexArray=new Vs,this.programConfigurations=new Da(t.layers,t.zoom),this.segments=new ja,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n,r){this.hasPattern=ep("line",this.layers,e);const o=this.layers[0].layout.get("line-sort-key"),i=[];for(const{feature:u,id:c,index:p,sourceLayerIndex:h}of t){const t=this.layers[0]._featureFilter.needGeometry,e=Gu(u,t);if(!this.layers[0]._featureFilter.filter(new is(this.zoom),e,n))continue;const s=o?o.evaluate(e,{},n):void 0,a={id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:p,geometry:t?e.geometry:ku(u,n,r),patterns:{},sortKey:s};i.push(a)}o&&i.sort((t,e)=>t.sortKey-e.sortKey);const{lineAtlas:s,featureIndex:a}=e,l=this.addConstantDashes(s);for(const u of i){const{geometry:r,index:o,sourceLayerIndex:i}=u;if(l&&this.addFeatureDashes(u,s),this.hasPattern){const t=np("line",this.layers,u,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(u,r,o,n,s.positions,e.availableImages);a.insert(t[o].feature,r,o,i,this.index)}}addConstantDashes(t){let e=!1;for(const n of this.layers){const r=n.paint.get("line-dasharray").value,o=n.layout.get("line-cap").value;if("constant"!==r.kind||"constant"!==o.kind)e=!0;else{const e=o.value,n=r.value;if(!n)continue;t.addDash(n,e)}}return e}addFeatureDashes(t,e){const n=this.zoom;for(const r of this.layers){const o=r.paint.get("line-dasharray").value,i=r.layout.get("line-cap").value;if("constant"===o.kind&&"constant"===i.kind)continue;let s,a;if("constant"===o.kind){if(s=o.value,!s)continue}else s=o.evaluate({zoom:n},t);a="constant"===i.kind?i.value:i.evaluate({zoom:n},t),e.addDash(s,a),t.patterns[r.id]=e.getKey(s,a)}}update(t,e,n,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,r)}addFeatures(t,e,n,r,o){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,$p)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qp),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,r,o,i){const s=this.layers[0].layout,a=s.get("line-join").evaluate(t,{}),l=s.get("line-cap").evaluate(t,{}),u=s.get("line-miter-limit"),c=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const p of e)this.addLine(p,t,a,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i,r)}addLine(t,e,n,r,o,i){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===th[e.type];let a=t.length;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l=0;for(;l<a-1&&t[l].equals(t[l+1]);)l++;if(a<(s?3:2))return;"bevel"===n&&(o=1.05);const u=this.overscaling<=16?15*Ha/(512*this.overscaling):0,c=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let p,h,d,f,g;this.e1=this.e2=-1,s&&(p=t[a-2],g=t[l].sub(p)._unit()._perp());for(let m=l;m<a;m++){if(d=m===a-1?s?t[l+1]:void 0:t[m+1],d&&t[m].equals(d))continue;g&&(f=g),p&&(h=p),p=t[m],g=d?d.sub(p)._unit()._perp():f,f=f||g;let e=f.add(g);0===e.x&&0===e.y||e._unit();const y=f.x*g.x+f.y*g.y,v=e.x*g.x+e.y*g.y,_=0!==v?1/v:1/0,w=2*Math.sqrt(2-2*v),C=v<eh&&h&&d,b=f.x*g.y-f.y*g.x>0;if(C&&m>l){const t=p.dist(h);if(t>2*u){const e=p.sub(p.sub(h)._mult(u/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,f,0,0,c),h=e}}const x=h&&d;let E=x?n:s?"butt":r;if(x&&"round"===E&&(_<i?E="miter":_<=2&&(E="fakeround")),"miter"===E&&_>o&&(E="bevel"),"bevel"===E&&(_>2&&(E="flipbevel"),_<o&&(E="miter")),h&&this.updateDistance(h,p),"miter"===E)e._mult(_),this.addCurrentVertex(p,e,0,0,c);else if("flipbevel"===E){if(_>100)e=g.mult(-1);else{const t=_*f.add(g).mag()/f.sub(g).mag();e._perp()._mult(t*(b?-1:1))}this.addCurrentVertex(p,e,0,0,c),this.addCurrentVertex(p,e.mult(-1),0,0,c)}else if("bevel"===E||"fakeround"===E){const t=-Math.sqrt(_*_-1),e=b?t:0,n=b?0:t;if(h&&this.addCurrentVertex(p,f,e,n,c),"fakeround"===E){const t=Math.round(180*w/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*t*t+(.848013+y*(.215638*y-1.06021)))}const r=g.sub(f)._mult(n)._add(f)._unit()._mult(b?-1:1);this.addHalfVertex(p,r.x,r.y,!1,b,0,c)}}d&&this.addCurrentVertex(p,g,-e,-n,c)}else if("butt"===E)this.addCurrentVertex(p,e,0,0,c);else if("square"===E){const t=h?1:-1;h||this.addCurrentVertex(p,e,t,t,c),this.addCurrentVertex(p,e,0,0,c),h&&this.addCurrentVertex(p,e,t,t,c)}else"round"===E&&(h&&(this.addCurrentVertex(p,f,0,0,c),this.addCurrentVertex(p,f,1,1,c,!0)),d&&(this.addCurrentVertex(p,g,-1,-1,c,!0),this.addCurrentVertex(p,g,0,0,c)));if(C&&m<a-1){const t=p.dist(d);if(t>2*u){const e=p.add(d.sub(p)._mult(u/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,g,0,0,c),p=e}}}}addCurrentVertex(t,e,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=e.y*r-e.x,a=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,i,!1,n,o),this.addHalfVertex(t,s,a,i,!0,-r,o)}addHalfVertex(t,e,n,r,o,i,s){let{x:a,y:l}=t;this.layoutVertexArray.emplaceBack((a<<1)+(r?1:0),(l<<1)+(o?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===i?0:i<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),s.primitiveLength++),o?this.e2=u:this.e1=u}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}Vo(nh,"LineBucket",{omit:["layers","patternFeatures"]});const rh=new ys({"line-cap":new gs(te.layout_line["line-cap"]),"line-join":new gs(te.layout_line["line-join"]),"line-miter-limit":new fs(te.layout_line["line-miter-limit"]),"line-round-limit":new fs(te.layout_line["line-round-limit"]),"line-sort-key":new gs(te.layout_line["line-sort-key"])});var oh={paint:new ys({"line-opacity":new gs(te.paint_line["line-opacity"]),"line-color":new gs(te.paint_line["line-color"]),"line-translate":new fs(te.paint_line["line-translate"]),"line-translate-anchor":new fs(te.paint_line["line-translate-anchor"]),"line-width":new gs(te.paint_line["line-width"]),"line-gap-width":new gs(te.paint_line["line-gap-width"]),"line-offset":new gs(te.paint_line["line-offset"]),"line-blur":new gs(te.paint_line["line-blur"]),"line-dasharray":new gs(te.paint_line["line-dasharray"]),"line-pattern":new gs(te.paint_line["line-pattern"]),"line-gradient":new ms(te.paint_line["line-gradient"]),"line-trim-offset":new fs(te.paint_line["line-trim-offset"])}),layout:rh};const ih=new class extends gs{possiblyEvaluate(t,e){return e=new is(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,r){return e=D({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,r)}}(oh.paint.properties["line-width"].specification);function sh(t,e){return e>0?e+2*t:t}ih.useIntegerZoom=!0;const ah=bs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lh=bs([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),uh=bs([{name:"a_projected_pos",components:4,type:"Float32"}],4);bs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ch=bs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ph=bs([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);bs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hh=bs([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),dh=bs([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);bs([{name:"triangle",components:3,type:"Uint16"}]),bs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),bs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),bs([{type:"Float32",name:"offsetX"}]),bs([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);const fh=128;function gh(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new is(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:r}=n;let o=0;for(;o<e.length&&e[o]<=t;)o++;o=Math.max(0,o-1);let i=o;for(;i<e.length&&e[i]<t+1;)i++;i=Math.min(e.length-1,i);const s=e[o],a=e[i];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:a,minSize:n.evaluate(new is(s)),maxSize:n.evaluate(new is(a)),interpolationType:r}}}function mh(t,e,n){let{uSize:r,uSizeT:o}=e,{lowerSize:i,upperSize:s}=n;return"source"===t.kind?i/fh:"composite"===t.kind?An(i/fh,s/fh,o):r}function yh(t,e){let n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){const{interpolationType:o,minZoom:i,maxZoom:s}=t,a=o?R(Yn.interpolationFactor(o,e,i,s),0,1):0;"camera"===t.kind?r=An(t.minSize,t.maxSize,a):n=a}return{uSizeT:n,uSize:r}}var vh=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:fh,evaluateSizeForFeature:mh,evaluateSizeForZoom:yh,getSizeData:gh});function _h(t,e,n){return t.sections.forEach(t=>{t.text=function(t,e,n){const r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),os.applyArabicShaping&&(t=os.applyArabicShaping(t)),t}(t.text,e,n)}),t}const wh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Ch(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function bh(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var xh=Th,Eh=function(t,e,n,r,o){var i,s,a=8*o-r-1,l=(1<<a)-1,u=l>>1,c=-7,p=n?o-1:0,h=n?-1:1,d=t[e+p];for(p+=h,i=d&(1<<-c)-1,d>>=-c,c+=a;c>0;i=256*i+t[e+p],p+=h,c-=8);for(s=i&(1<<-c)-1,i>>=-c,c+=r;c>0;s=256*s+t[e+p],p+=h,c-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),i-=u}return(d?-1:1)*s*Math.pow(2,i-r)},Sh=function(t,e,n,r,o,i){var s,a,l,u=8*i-o-1,c=(1<<u)-1,p=c>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,f=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+p>=1?h/l:h*Math.pow(2,1-p))*l>=2&&(s++,l/=2),s+p>=c?(a=0,s=c):s+p>=1?(a=(e*l-1)*Math.pow(2,o),s+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,o),s=0));o>=8;t[n+d]=255&a,d+=f,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[n+d]=255&s,d+=f,s/=256,u-=8);t[n+d-f]|=128*g};function Th(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Th.Varint=0,Th.Fixed64=1,Th.Bytes=2,Th.Fixed32=5;var Rh=4294967296,Ph=1/Rh,Oh="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ih(t){return t.type===Th.Bytes?t.readVarint()+t.pos:t.pos+1}function Ah(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Dh(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var o=n.pos-1;o>=t;o--)n.buf[o+r]=n.buf[o]}function Mh(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Lh(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Nh(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Fh(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function kh(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Gh(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Bh(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Vh(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function zh(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function jh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Hh(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Uh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Th.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),o=r>>3,i=this.pos;this.type=7&r,t(o,e,this),this.pos===i&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=jh(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Uh(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=jh(this.buf,this.pos)+jh(this.buf,this.pos+4)*Rh;return this.pos+=8,t},readSFixed64:function(){var t=jh(this.buf,this.pos)+Uh(this.buf,this.pos+4)*Rh;return this.pos+=8,t},readFloat:function(){var t=Eh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Eh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,o,i=n.buf;if(r=(112&(o=i[n.pos++]))>>4,o<128)return Ah(t,r,e);if(r|=(127&(o=i[n.pos++]))<<3,o<128)return Ah(t,r,e);if(r|=(127&(o=i[n.pos++]))<<10,o<128)return Ah(t,r,e);if(r|=(127&(o=i[n.pos++]))<<17,o<128)return Ah(t,r,e);if(r|=(127&(o=i[n.pos++]))<<24,o<128)return Ah(t,r,e);if(r|=(1&(o=i[n.pos++]))<<31,o<128)return Ah(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Oh?function(t,e,n){return Oh.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",o=e;o<n;){var i,s,a,l=t[o],u=null,c=l>239?4:l>223?3:l>191?2:1;if(o+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(i=t[o+1]))&&(u=(31&l)<<6|63&i)<=127&&(u=null):3===c?(s=t[o+2],128==(192&(i=t[o+1]))&&128==(192&s)&&((u=(15&l)<<12|(63&i)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(s=t[o+2],a=t[o+3],128==(192&(i=t[o+1]))&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&i)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),o+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Th.Bytes)return t.push(this.readVarint(e));var n=Ih(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Th.Bytes)return t.push(this.readSVarint());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Th.Bytes)return t.push(this.readBoolean());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Th.Bytes)return t.push(this.readFloat());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Th.Bytes)return t.push(this.readDouble());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Th.Bytes)return t.push(this.readFixed32());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Th.Bytes)return t.push(this.readSFixed32());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Th.Bytes)return t.push(this.readFixed64());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Th.Bytes)return t.push(this.readSFixed64());var e=Ih(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Th.Varint)for(;this.buf[this.pos++]>127;);else if(e===Th.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Th.Fixed32)this.pos+=4;else{if(e!==Th.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Hh(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Hh(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Hh(this.buf,-1&t,this.pos),Hh(this.buf,Math.floor(t*Ph),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Hh(this.buf,-1&t,this.pos),Hh(this.buf,Math.floor(t*Ph),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,o,i=0;i<e.length;i++){if((r=e.charCodeAt(i))>55295&&r<57344){if(!o){r>56319||i+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):o=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,o=r;continue}r=o-55296<<10|r-56320|65536,o=null}else o&&(t[n++]=239,t[n++]=191,t[n++]=189,o=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Dh(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Sh(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Sh(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Dh(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Th.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Mh,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Lh,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,kh,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Nh,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Fh,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Gh,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Bh,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Vh,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,zh,e)},writeBytesField:function(t,e){this.writeTag(t,Th.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Th.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Th.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Th.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Th.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Th.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Th.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Th.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Th.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Th.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Wh=h(xh);function qh(t,e,n){e.glyphs=[],1===t&&n.readMessage(Xh,e)}function Xh(t,e,n){if(3===t){const{id:t,bitmap:r,width:o,height:i,left:s,top:a,advance:l}=n.readMessage(Kh,{});e.glyphs.push({id:t,bitmap:new gc({width:o+6,height:i+6},r),metrics:{width:o,height:i,left:s,top:a,advance:l}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function Kh(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function Yh(t){let e=0,n=0;for(const s of t)e+=s.w*s.h,n=Math.max(n,s.w);t.sort((t,e)=>e.h-t.h);const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let o=0,i=0;for(const s of t)for(let t=r.length-1;t>=0;t--){const e=r[t];if(!(s.w>e.w||s.h>e.h)){if(s.x=e.x,s.y=e.y,i=Math.max(i,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===e.w&&s.h===e.h){const e=r.pop();t<r.length&&(r[t]=e)}else s.h===e.h?(e.x+=s.w,e.w-=s.w):s.w===e.w?(e.y+=s.h,e.h-=s.h):(r.push({x:e.x+s.w,y:e.y,w:e.w-s.w,h:s.h}),e.y+=s.h,e.h-=s.h);break}}return{w:o,h:i,fill:e/(o*i)||0}}class Zh{constructor(t,e){let{pixelRatio:n,version:r,stretchX:o,stretchY:i,content:s}=e;this.paddedRect=t,this.pixelRatio=n,this.stretchX=o,this.stretchY=i,this.content=s,this.version=r}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Qh{constructor(t,e){const n={},r={};this.haveRenderCallbacks=[];const o=[];this.addImages(t,n,o),this.addImages(e,r,o);const{w:i,h:s}=Yh(o),a=new mc({width:i||1,height:s||1});for(const l in t){const e=t[l],r=n[l].paddedRect;mc.copy(e.data,a,{x:0,y:0},{x:r.x+1,y:r.y+1},e.data)}for(const l in e){const t=e[l],n=r[l].paddedRect,o=n.x+1,i=n.y+1,s=t.data.width,u=t.data.height;mc.copy(t.data,a,{x:0,y:0},{x:o,y:i},t.data),mc.copy(t.data,a,{x:0,y:u-1},{x:o,y:i-1},{width:s,height:1}),mc.copy(t.data,a,{x:0,y:0},{x:o,y:i+u},{width:s,height:1}),mc.copy(t.data,a,{x:s-1,y:0},{x:o-1,y:i},{width:1,height:u}),mc.copy(t.data,a,{x:0,y:0},{x:o+s,y:i},{width:1,height:u})}this.image=a,this.iconPositions=n,this.patternPositions=r}addImages(t,e,n){for(const r in t){const o=t[r],i={x:0,y:0,w:o.data.width+2,h:o.data.height+2};n.push(i),e[r]=new Zh(i,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(t,e){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(e=>t.hasImage(e)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[r,o]=t.tl;n.update(e.data,void 0,{x:r,y:o})}}Vo(Zh,"ImagePosition"),Vo(Qh,"ImageAtlas");const Jh={horizontal:1,vertical:2,horizontalOnly:3};class $h{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new $h;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new $h;return e.imageName=t,e}}class td{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new td;for(let r=0;r<t.sections.length;r++){const o=t.sections[r];o.image?n.addImageSection(o):n.addTextSection(o,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(t,e){let n="";for(let r=0;r<t.length;r++){const o=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;n+=!e&&(o&&Hi(o)&&!wh[t[r+1]]||i&&Hi(i)&&!wh[t[r-1]])||!wh[t[r]]?t[r]:wh[t[r]]}return n}(this.text,t)}trim(){let t=0;for(let n=0;n<this.text.length&&nd[this.text.charCodeAt(n)];n++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&nd[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new td;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,e)=>Math.max(t,this.sections[e].scale),0)}addTextSection(t,e){this.text+=t.text,this.sections.push($h.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let r=0;r<t.text.length;++r)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void U("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push($h.forImage(e)),this.sectionIndex.push(this.sections.length-1)):U("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ed(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f){const g=td.fromFeature(t,o);p===Jh.vertical&&g.verticalizePunctuation(h);let m=[];const y=function(t,e,n,r,o,i){if(!t)return[];const s=[],a=function(t,e,n,r,o,i){let s=0;for(let a=0;a<t.length();a++){const n=t.getSection(a);s+=od(t.getCharCode(a),n,r,o,e,i)}return s/Math.max(1,Math.ceil(s/n))}(t,e,n,r,o,i),l=t.text.indexOf("\u200b")>=0;let u=0;for(let p=0;p<t.length();p++){const n=t.getSection(p),h=t.getCharCode(p);if(nd[h]||(u+=od(h,n,r,o,e,i)),p<t.length()-1){const e=!((c=h)<11904||!(vi(c)||gi(c)||Ni(c)||Di(c)||bi(c)||ui(c)||_i(c)||hi(c)||xi(c)||Si(c)||Ci(c)||Gi(c)||di(c)||pi(c)||ci(c)||wi(c)||fi(c)||Li(c)||Ri(c)||Ti(c)));(rd[h]||e||n.imageName)&&s.push(ad(p+1,u,a,s,sd(h,t.getCharCode(p+1),e&&l),!1))}}var c;return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(ad(t.length(),u,a,s,0,!0))}(g,u,i,e,r,d),{processBidirectionalText:v,processStyledBidirectionalText:_}=os;if(v&&1===g.sections.length){const t=v(g.toString(),y);for(const e of t){const t=new td;t.text=e,t.sections=g.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);m.push(t)}}else if(_){const t=_(g.text,g.sectionIndex,y);for(const e of t){const t=new td;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,m.push(t)}}else m=function(t,e){const n=[],r=t.text;let o=0;for(const i of e)n.push(t.substring(o,i)),o=i;return o<r.length&&n.push(t.substring(o,r.length)),n}(g,y);const w=[],C={positionedLines:w,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(t,e,n,r,o,i,s,a,l,u,c,p){let h=0,d=0,f=0;const g="right"===a?1:"left"===a?0:.5;let m=!1;for(const b of o){const t=b.getSections();for(const n of t){if(n.imageName)continue;const t=e[n.fontStack];if(t&&(m=void 0!==t.ascender&&void 0!==t.descender,!m))break}if(!m)break}let y=0;for(const b of o){b.trim();const o=b.getMaxScale(),s=24*(o-1),a={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=a;const _=a.positionedGlyphs;let w=0;if(!b.length()){d+=i,++y;continue}let C=0,x=0;for(let i=0;i<b.length();i++){const s=b.getSection(i),a=b.getSectionIndex(i),f=b.getCharCode(i);let g=s.scale,y=null,E=null,S=null,T=24,R=0;const P=!(l===Jh.horizontal||!c&&!ji(f)||c&&(nd[f]||(v=f,qo(v)||Xo(v)||Ko(v)||Mi(v)||ki(v))));if(s.imageName){const e=r[s.imageName];if(!e)continue;S=s.imageName,t.iconsInText=t.iconsInText||!0,E=e.paddedRect;const n=e.displaySize;g=24*g/p,y={width:n[0],height:n[1],left:1,top:-3,advance:P?n[1]:n[0],localGlyph:!1},R=m?-y.height*g:24*o-17-n[1]*g,T=y.advance;const i=(P?n[0]:n[1])*g-24*o;i>0&&i>w&&(w=i)}else{const t=n[s.fontStack];if(!t)continue;t[f]&&(E=t[f]);const r=e[s.fontStack];if(!r)continue;const i=r.glyphs[f];if(!i)continue;if(y=i.metrics,T=8203!==f?24:0,m){const t=void 0!==r.ascender?Math.abs(r.ascender):0,e=void 0!==r.descender?Math.abs(r.descender):0,n=(t+e)*g;C<n&&(C=n,x=(t-e)/2*g),R=-t*g}else R=24*(o-g)-17}P?(t.verticalizable=!0,_.push({glyph:f,imageName:S,x:h,y:d+R,vertical:P,scale:g,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:E}),h+=T*g+u):(_.push({glyph:f,imageName:S,x:h,y:d+R,vertical:P,scale:g,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:E}),h+=y.advance*g+u)}0!==_.length&&(f=Math.max(h-u,f),m?ud(_,g,w,x,i*o/2):ud(_,g,w,0,i/2)),h=0;const E=i*o+w;a.lineOffset=Math.max(w,s),d+=E,++y}var v;const _=d,{horizontalAlign:w,verticalAlign:C}=ld(s);(function(t,e,n,r,o,i){const s=(e-n)*o,a=-i*r;for(const l of t)for(const t of l.positionedGlyphs)t.x+=s,t.y+=a})(t.positionedLines,g,w,C,f,_),t.top+=-C*_,t.bottom=t.top+_,t.left+=-w*f,t.right=t.left+f,t.hasBaseline=m}(C,e,n,r,m,s,a,l,p,u,h,f),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(w)&&C}const nd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rd={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function od(t,e,n,r,o,i){if(e.imageName){const t=r[e.imageName];return t?t.displaySize[0]*e.scale*24/i+o:0}{const r=n[e.fontStack],i=r&&r.glyphs[t];return i?i.metrics.advance*e.scale+o:0}}function id(t,e,n,r){const o=Math.pow(t-e,2);return r?t<e?o/2:2*o:o+Math.abs(n)*n}function sd(t,e,n){let r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function ad(t,e,n,r,o,i){let s=null,a=id(e,n,o,i);for(const l of r){const t=id(e-l.x,n,o,i)+l.badness;t<=a&&(s=l,a=t)}return{index:t,x:e,priorBreak:s,badness:a}}function ld(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function ud(t,e,n,r,o){if(!(e||n||r||o))return;const i=t.length-1,s=t[i],a=(s.x+s.metrics.advance*s.scale)*e;for(let l=0;l<=i;l++)t[l].x-=a,t[l].y+=n+r+o}function cd(t,e,n){const{horizontalAlign:r,verticalAlign:o}=ld(n),i=e[0]-t.displaySize[0]*r,s=e[1]-t.displaySize[1]*o;return{image:t,top:s,bottom:s+t.displaySize[1],left:i,right:i+t.displaySize[0]}}function pd(t,e,n,r,o,i){const s=t.image;let a;if(s.content){const t=s.content,e=s.pixelRatio||1;a=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*i,u=e.right*i;let c,p,h,d;"width"===n||"both"===n?(d=o[0]+l-r[3],p=o[0]+u+r[1]):(d=o[0]+(l+u-s.displaySize[0])/2,p=d+s.displaySize[0]);const f=e.top*i,g=e.bottom*i;return"height"===n||"both"===n?(c=o[1]+f-r[0],h=o[1]+g+r[2]):(c=o[1]+(f+g-s.displaySize[1])/2,h=c+s.displaySize[1]),{image:s,top:c,right:p,bottom:h,left:d,collisionPadding:a}}class hd extends v{constructor(t,e,n,r,o){super(t,e),this.angle=r,this.z=n,void 0!==o&&(this.segment=o)}clone(){return new hd(this.x,this.y,this.z,this.angle,this.segment)}}function dd(t,e,n,r,o){if(void 0===e.segment)return!0;let i=e,s=e.segment+1,a=0;for(;a>-n/2;){if(s--,s<0)return!1;a-=t[s].dist(i),i=t[s]}a+=t[s].dist(t[s+1]),s++;const l=[];let u=0;for(;a<n/2;){const e=t[s],n=t[s+1];if(!n)return!1;let i=t[s-1].angleTo(e)-e.angleTo(n);for(i=Math.abs((i+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:i}),u+=i;a-l[0].distance>r;)u-=l.shift().angleDelta;if(u>o)return!1;s++,a+=e.dist(n)}return!0}function fd(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function gd(t,e,n){return t?.6*e*n:0}function md(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function yd(t,e,n,r,o,i){const s=gd(n,o,i),a=md(n,r)*i;let l=0;const u=fd(t)/2;for(let c=0;c<t.length-1;c++){const n=t[c],r=t[c+1],o=n.dist(r);if(l+o>u){const i=(u-l)/o,p=An(n.x,r.x,i),h=An(n.y,r.y,i),d=new hd(p,h,0,r.angleTo(n),c);return!s||dd(t,d,a,s,e)?d:void 0}l+=o}}function vd(t,e,n,r,o,i,s,a,l){const u=gd(r,i,s),c=md(r,o),p=c*s,h=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-p<e/4&&(e=p+e/4),function t(e,n,r,o,i,s,a,l,u){const c=s/2,p=fd(e);let h=0,d=n-r,f=[];for(let g=0;g<e.length-1;g++){const t=e[g],n=e[g+1],a=t.dist(n),l=n.angleTo(t);for(;d+r<h+a;){d+=r;const m=(d-h)/a,y=An(t.x,n.x,m),v=An(t.y,n.y,m);if(y>=0&&y<u&&v>=0&&v<u&&d-c>=0&&d+c<=p){const t=new hd(y,v,0,l,g);t._round(),o&&!dd(e,t,s,o,i)||f.push(t)}}h+=a}return l||f.length||a||(f=t(e,h/2,r,o,i,s,a,!0,u)),f}(t,h?e/2*a%e:(c/2+2*i)*s*a%e,e,u,n,p,h,!1,l)}function _d(t,e,n,r,o){const i=[];for(let s=0;s<t.length;s++){const a=t[s];let l;for(let t=0;t<a.length-1;t++){let s=a[t],u=a[t+1];s.x<e&&u.x<e||(s.x<e?s=new v(e,s.y+(e-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x<e&&(u=new v(e,s.y+(e-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y<n&&u.y<n||(s.y<n?s=new v(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round():u.y<n&&(u=new v(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round()),s.x>=r&&u.x>=r||(s.x>=r?s=new v(r,s.y+(r-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x>=r&&(u=new v(r,s.y+(r-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y>=o&&u.y>=o||(s.y>=o?s=new v(s.x+(o-s.y)/(u.y-s.y)*(u.x-s.x),o)._round():u.y>=o&&(u=new v(s.x+(o-s.y)/(u.y-s.y)*(u.x-s.x),o)._round()),l&&s.equals(l[l.length-1])||(l=[s],i.push(l)),l.push(u)))))}}return i}Vo(hd,"Anchor");const wd=1e20;function Cd(t,e,n,r,o,i,s,a,l){for(let u=e;u<e+r;u++)bd(t,n*i+u,i,o,s,a,l);for(let u=n;u<n+o;u++)bd(t,u*i+e,1,r,s,a,l)}function bd(t,e,n,r,o,i,s){i[0]=0,s[0]=-wd,s[1]=wd,o[0]=t[e];for(let a=1,l=0,u=0;a<r;a++){o[a]=t[e+a*n];const r=a*a;do{const t=i[l];u=(o[a]-o[t]+r-t*t)/(a-t)/2}while(u<=s[l]&&--l>-1);l++,i[l]=a,s[l]=u,s[l+1]=wd}for(let a=0,l=0;a<r;a++){for(;s[l+1]<a;)l++;const r=i[l],u=a-r;t[e+a*n]=o[r]+u*u}}const xd={none:0,ideographs:1,all:2};class Ed{constructor(t,e,n){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,e){const n=[];for(const r in t)for(const e of t[r])n.push({stack:r,id:e});I(n,(t,e)=>{let{stack:n,id:r}=t,o=this.entries[n];o||(o=this.entries[n]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let i=o.glyphs[r];if(void 0!==i)return void e(null,{stack:n,id:r,glyph:i});if(i=this._tinySDF(o,n,r),i)return o.glyphs[r]=i,void e(null,{stack:n,id:r,glyph:i});const s=Math.floor(r/256);if(256*s>65535)return void e(new Error("glyphs > 65535 not supported"));if(o.ranges[s])return void e(null,{stack:n,id:r,glyph:i});let a=o.requests[s];a||(a=o.requests[s]=[],Ed.loadGlyphRange(n,s,this.url,this.requestManager,(t,e)=>{if(e){o.ascender=e.ascender,o.descender=e.descender;for(const t in e.glyphs)this._doesCharSupportLocalGlyph(+t)||(o.glyphs[+t]=e.glyphs[+t]);o.ranges[s]=!0}for(const n of a)n(t,e);delete o.requests[s]})),a.push((t,o)=>{t?e(t):o&&e(null,{stack:n,id:r,glyph:o.glyphs[r]||null})})},(t,n)=>{if(t)e(t);else if(n){const t={};for(const{stack:e,id:r,glyph:o}of n)void 0===t[e]&&(t[e]={}),void 0===t[e].glyphs&&(t[e].glyphs={}),t[e].glyphs[r]=o&&{id:o.id,bitmap:o.bitmap.clone(),metrics:o.metrics},t[e].ascender=this.entries[e].ascender,t[e].descender=this.entries[e].descender;e(null,t)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==xd.none&&(this.localGlyphMode===xd.all?!!this.localFontFamily:!!this.localFontFamily&&(Si(t)||Oi(t)||di(t)||fi(t)||hi(t)))}_tinySDF(t,e,n){const r=this.localFontFamily;if(!r||!this._doesCharSupportLocalGlyph(n))return;let o=t.tinySDF;if(!o){let n="400";/bold/i.test(e)?n="900":/medium/i.test(e)?n="500":/light/i.test(e)&&(n="200"),o=t.tinySDF=new Ed.TinySDF({fontFamily:r,fontWeight:n,fontSize:48,buffer:6,radius:16}),o.fontWeight=n}if(this.localGlyphs[o.fontWeight][n])return this.localGlyphs[o.fontWeight][n];const i=String.fromCharCode(n),{data:s,width:a,height:l,glyphWidth:u,glyphHeight:c,glyphLeft:p,glyphTop:h,glyphAdvance:d}=o.draw(i);return this.localGlyphs[o.fontWeight][n]={id:n,bitmap:new gc({width:a,height:l},s),metrics:{width:u/2,height:c/2,left:p/2,top:h/2-27,advance:d/2,localGlyph:!0}}}}function Sd(t,e,n,r){const o=[],i=t.image,s=i.pixelRatio,a=i.paddedRect.w-2,l=i.paddedRect.h-2,u=t.right-t.left,c=t.bottom-t.top,p=i.stretchX||[[0,a]],h=i.stretchY||[[0,l]],d=(t,e)=>t+e[1]-e[0],f=p.reduce(d,0),g=h.reduce(d,0),m=a-f,y=l-g;let _=0,w=f,C=0,b=g,x=0,E=m,S=0,T=y;if(i.content&&r){const t=i.content;_=Td(p,0,t[0]),C=Td(h,0,t[1]),w=Td(p,t[0],t[2]),b=Td(h,t[1],t[3]),x=t[0]-_,S=t[1]-C,E=t[2]-t[0]-w,T=t[3]-t[1]-b}const R=(r,o,a,l)=>{const p=Pd(r.stretch-_,w,u,t.left),h=Od(r.fixed-x,E,r.stretch,f),d=Pd(o.stretch-C,b,c,t.top),m=Od(o.fixed-S,T,o.stretch,g),y=Pd(a.stretch-_,w,u,t.left),R=Od(a.fixed-x,E,a.stretch,f),P=Pd(l.stretch-C,b,c,t.top),O=Od(l.fixed-S,T,l.stretch,g),I=new v(p,d),A=new v(y,d),D=new v(y,P),M=new v(p,P),L=new v(h/s,m/s),N=new v(R/s,O/s),F=e*Math.PI/180;if(F){const t=Math.sin(F),e=Math.cos(F),n=[e,-t,t,e];I._matMult(n),A._matMult(n),M._matMult(n),D._matMult(n)}const k=r.stretch+r.fixed,G=o.stretch+o.fixed;return{tl:I,tr:A,bl:M,br:D,tex:{x:i.paddedRect.x+1+k,y:i.paddedRect.y+1+G,w:a.stretch+a.fixed-k,h:l.stretch+l.fixed-G},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:N,minFontScaleX:E/s/u,minFontScaleY:T/s/c,isSDF:n}};if(r&&(i.stretchX||i.stretchY)){const t=Rd(p,m,f),e=Rd(h,y,g);for(let n=0;n<t.length-1;n++){const r=t[n],i=t[n+1];for(let t=0;t<e.length-1;t++)o.push(R(r,e[t],i,e[t+1]))}}else o.push(R({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:l+1}));return o}function Td(t,e,n){let r=0;for(const o of t)r+=Math.max(e,Math.min(n,o[1]))-Math.max(e,Math.min(n,o[0]));return r}function Rd(t,e,n){const r=[{fixed:-1,stretch:0}];for(const[o,i]of t){const t=r[r.length-1];r.push({fixed:o-t.stretch,stretch:t.stretch}),r.push({fixed:o-t.stretch,stretch:t.stretch+(i-o)})}return r.push({fixed:e+1,stretch:n}),r}function Pd(t,e,n,r){return t/e*n+r}function Od(t,e,n,r){return t-e*n/r}function Id(t,e,n,r){const o=e+t.positionedLines[r].lineOffset;return 0===r?n+o/2:n+(o+(e+t.positionedLines[r-1].lineOffset))/2}Ed.loadGlyphRange=function(t,e,n,r,o){const i=256*e,s=i+255,a=r.transformRequest(r.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}","".concat(i,"-").concat(s)),lt.Glyphs);ht(a,(t,e)=>{if(t)o(t);else if(e){const t={},n=function(t){return new Wh(t).readFields(qh,{})}(e);for(const e of n.glyphs)t[e.id]=e;o(null,{glyphs:t,ascender:n.ascender,descender:n.descender})}})},Ed.TinySDF=class{constructor(){let{fontSize:t=24,buffer:e=3,radius:n=8,cutoff:r=.25,fontFamily:o="sans-serif",fontWeight:i="normal",fontStyle:s="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=e,this.cutoff=r,this.radius=n;const a=this.size=t+4*e,l=this._createCanvas(a),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font="".concat(s," ").concat(i," ").concat(t,"px ").concat(o),u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:o,actualBoundingBoxRight:i}=this.ctx.measureText(t),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(i-o))),l=Math.min(this.size-this.buffer,s+Math.ceil(r)),u=a+2*this.buffer,c=l+2*this.buffer,p=Math.max(u*c,0),h=new Uint8ClampedArray(p),d={data:h,width:u,height:c,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return d;const{ctx:f,buffer:g,gridInner:m,gridOuter:y}=this;f.clearRect(g,g,a,l),f.fillText(t,g,g+s);const v=f.getImageData(g,g,a,l);y.fill(wd,0,p),m.fill(0,0,p);for(let _=0;_<l;_++)for(let t=0;t<a;t++){const e=v.data[4*(_*a+t)+3]/255;if(0===e)continue;const n=(_+g)*u+t+g;if(1===e)y[n]=0,m[n]=wd;else{const t=.5-e;y[n]=t>0?t*t:0,m[n]=t<0?t*t:0}}Cd(y,0,0,u,c,u,this.f,this.v,this.z),Cd(m,g,g,a,l,u,this.f,this.v,this.z);for(let _=0;_<p;_++){const t=Math.sqrt(y[_])-Math.sqrt(m[_]);h[_]=Math.round(255-255*(t/this.radius+this.cutoff))}return d}};class Ad{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dd;if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const o=t-1>>1,i=e[o];if(n(r,i)>=0)break;e[t]=i,t=o}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,o=e[t];for(;t<r;){let r=1+(t<<1),i=e[r];const s=r+1;if(s<this.length&&n(e[s],i)<0&&(r=s,i=e[s]),n(i,o)>=0)break;e[t]=i,t=r}e[t]=o}}function Dd(t,e){return t<e?-1:t>e?1:0}function Md(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1/0,o=1/0,i=-1/0,s=-1/0;const a=t[0];for(let d=0;d<a.length;d++){const t=a[d];(!d||t.x<r)&&(r=t.x),(!d||t.y<o)&&(o=t.y),(!d||t.x>i)&&(i=t.x),(!d||t.y>s)&&(s=t.y)}const l=Math.min(i-r,s-o);let u=l/2;const c=new Ad([],Ld);if(0===l)return new v(r,o);for(let d=r;d<i;d+=l)for(let e=o;e<s;e+=l)c.push(new Nd(d+u,e+u,u,t));let p=function(t){let e=0,n=0,r=0;const o=t[0];for(let i=0,s=o.length,a=s-1;i<s;a=i++){const t=o[i],s=o[a],l=t.x*s.y-s.x*t.y;n+=(t.x+s.x)*l,r+=(t.y+s.y)*l,e+=3*l}return new Nd(n/e,r/e,0,t)}(t),h=c.length;for(;c.length;){const r=c.pop();(r.d>p.d||!p.d)&&(p=r,n&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,h)),r.max-p.d<=e||(u=r.h/2,c.push(new Nd(r.p.x-u,r.p.y-u,u,t)),c.push(new Nd(r.p.x+u,r.p.y-u,u,t)),c.push(new Nd(r.p.x-u,r.p.y+u,u,t)),c.push(new Nd(r.p.x+u,r.p.y+u,u,t)),h+=4)}return n&&(console.log("num probes: ".concat(h)),console.log("best distance: ".concat(p.d))),p.p}function Ld(t,e){return e.max-t.max}class Nd{constructor(t,e,n,r){this.p=new v(t,e),this.h=n,this.d=function(t,e){let n=!1,r=1/0;for(let o=0;o<e.length;o++){const i=e[o];for(let e=0,o=i.length,s=o-1;e<o;s=e++){const o=i[e],a=i[s];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(n=!n),r=Math.min(r,Yu(t,o,a))}}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}}const Fd=Number.POSITIVE_INFINITY,kd=Math.sqrt(2);function Gd(t,e){let[n,r]=e,o=0,i=0;if(r===Fd){n<0&&(n=0);const e=n/kd;switch(t){case"top-right":case"top-left":i=e-7;break;case"bottom-right":case"bottom-left":i=7-e;break;case"bottom":i=7-n;break;case"top":i=n-7}switch(t){case"top-right":case"bottom-right":o=-e;break;case"top-left":case"bottom-left":o=e;break;case"left":o=n;break;case"right":o=-n}}else{switch(n=Math.abs(n),r=Math.abs(r),t){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(t){case"top-right":case"bottom-right":case"right":o=-n;break;case"top-left":case"bottom-left":case"left":o=n}}return[o,i]}function Bd(t,e,n,r,o,i,s,a,l,u){t.createArrays(),t.tilePixelRatio=Ha/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const c=t.layers[0].layout,p=t.layers[0]._unevaluatedLayout._values,h={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.textSizeData;h.compositeTextSizes=[p["text-size"].possiblyEvaluate(new is(e),a),p["text-size"].possiblyEvaluate(new is(n),a)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.iconSizeData;h.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new is(e),a),p["icon-size"].possiblyEvaluate(new is(n),a)]}h.layoutTextSize=p["text-size"].possiblyEvaluate(new is(l+1),a),h.layoutIconSize=p["icon-size"].possiblyEvaluate(new is(l+1),a),h.textMaxSize=p["text-size"].possiblyEvaluate(new is(18),a);const d="map"===c.get("text-rotation-alignment")&&"point"!==c.get("symbol-placement"),f=c.get("text-size");for(const g of t.features){const i=c.get("text-font").evaluate(g,{},a).join(","),l=f.evaluate(g,{},a),p=h.layoutTextSize.evaluate(g,{},a),m=(h.layoutIconSize.evaluate(g,{},a),{horizontal:{},vertical:void 0}),y=g.text;let v,_=[0,0];if(y){const r=y.toString(),s=24*c.get("text-letter-spacing").evaluate(g,{},a),u=24*c.get("text-line-height").evaluate(g,{},a),h=Vi(r)?s:0,f=c.get("text-anchor").evaluate(g,{},a),v=c.get("text-variable-anchor");if(!v){const t=c.get("text-radial-offset").evaluate(g,{},a);_=t?Gd(f,[24*t,Fd]):c.get("text-offset").evaluate(g,{},a).map(t=>24*t)}let w=d?"center":c.get("text-justify").evaluate(g,{},a);const C="point"===c.get("symbol-placement"),b=C?24*c.get("text-max-width").evaluate(g,{},a):1/0,x=s=>{t.allowVerticalPlacement&&Bi(r)&&(m.vertical=ed(y,e,n,o,i,b,u,f,s,h,_,Jh.vertical,!0,p,l))};if(!d&&v){const t="auto"===w?v.map(t=>Vd(t)):[w];let r=!1;for(let s=0;s<t.length;s++){const a=t[s];if(!m.horizontal[a])if(r)m.horizontal[a]=m.horizontal[0];else{const t=ed(y,e,n,o,i,b,u,"center",a,h,_,Jh.horizontal,!1,p,l);t&&(m.horizontal[a]=t,r=1===t.positionedLines.length)}}x("left")}else{if("auto"===w&&(w=Vd(f)),C||c.get("text-writing-mode").indexOf("horizontal")>=0||!Bi(r)){const t=ed(y,e,n,o,i,b,u,f,w,h,_,Jh.horizontal,!1,p,l);t&&(m.horizontal[w]=t)}x(C?"left":w)}}let w=!1;if(g.icon&&g.icon.name){const e=r[g.icon.name];e&&(v=cd(o[g.icon.name],c.get("icon-offset").evaluate(g,{},a),c.get("icon-anchor").evaluate(g,{},a)),w=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&U("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==c.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const C=Wd(m.horizontal)||m.vertical;t.iconsInText||(t.iconsInText=!!C&&C.iconsInText),(C||v)&&zd(t,g,m,v,r,h,p,0,_,w,s,a,u)}i&&t.generateCollisionDebugBuffers(l,t.collisionBoxArray)}function Vd(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zd(t,e,n,r,o,i,s,a,l,u,c,p,h){let d=i.textMaxSize.evaluate(e,{},p);void 0===d&&(d=s);const f=t.layers[0].layout,g=f.get("icon-offset").evaluate(e,{},p),m=Wd(n.horizontal)||n.vertical,y="globe"===h.name,v=s/24,_=t.tilePixelRatio*d/24,w=(O=t.overscaling,t.zoom>18&&O>2&&(O>>=1),Math.max(Ha/(512*O),1)*f.get("symbol-spacing")),b=f.get("text-padding")*t.tilePixelRatio,x=f.get("icon-padding")*t.tilePixelRatio,E=C(f.get("text-max-angle")),S="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),T="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),R=f.get("symbol-placement"),P=w/2;var O;const I=f.get("icon-text-fit");let A;r&&"none"!==I&&(t.allowVerticalPlacement&&n.vertical&&(A=pd(r,n.vertical,I,f.get("icon-text-fit-padding"),g,v)),m&&(r=pd(r,m,I,f.get("icon-text-fit-padding"),g,v)));const D=(s,a,d)=>{if(a.x<0||a.x>=Ha||a.y<0||a.y>=Ha)return;let f=null;if(y){const{x:t,y:e,z:n}=h.projectTilePoint(a.x,a.y,d);f={anchor:new hd(t,e,n,0,void 0),up:h.upVector(d,a.x,a.y)}}!function(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,w,C,b,x,E){const S=t.addToLineVertexArray(e,r);let T,R,P,O,I,A,D,M=0,L=0,N=0,F=0,k=-1,G=-1;const B={};let V=fa("");const z=n?n.anchor:e;let j=0,H=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[j,H]=l.layout.get("text-offset").evaluate(w,{},E).map(t=>24*t):(j=24*l.layout.get("text-radial-offset").evaluate(w,{},E),H=Fd),t.allowVerticalPlacement&&o.vertical){const t=o.vertical;if(f)A=Xd(t),a&&(D=Xd(a));else{const n=l.layout.get("text-rotate").evaluate(w,{},E)+90;P=qd(u,z,e,c,p,h,t,d,n,g),a&&(O=qd(u,z,e,c,p,h,a,y,n))}}if(i){const r=l.layout.get("icon-rotate").evaluate(w,{},E),o="none"!==l.layout.get("icon-text-fit"),s=Sd(i,r,b,o),d=a?Sd(a,r,b,o):void 0;R=qd(u,z,e,c,p,h,i,y,r),M=4*s.length;const f=t.iconSizeData;let g=null;"source"===f.kind?(g=[fh*l.layout.get("icon-size").evaluate(w,{},E)],g[0]>Hd&&U("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(jd,'. Reduce your "icon-size".'))):"composite"===f.kind&&(g=[fh*C.compositeIconSizes[0].evaluate(w,{},E),fh*C.compositeIconSizes[1].evaluate(w,{},E)],(g[0]>Hd||g[1]>Hd)&&U("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(jd,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,s,g,_,v,w,!1,n,e,S.lineStartIndex,S.lineLength,-1,x,E),k=t.icon.placedSymbolArray.length-1,d&&(L=4*d.length,t.addSymbols(t.icon,d,g,_,v,w,Jh.vertical,n,e,S.lineStartIndex,S.lineLength,-1,x,E),G=t.icon.placedSymbolArray.length-1)}for(const U in o.horizontal){const r=o.horizontal[U];T||(V=fa(r.text),f?I=Xd(r):T=qd(u,z,e,c,p,h,r,d,l.layout.get("text-rotate").evaluate(w,{},E),g));const i=1===r.positionedLines.length;if(N+=Ud(t,n,e,r,s,l,f,w,g,S,o.vertical?Jh.horizontal:Jh.horizontalOnly,i?Object.keys(o.horizontal):[U],B,k,C,x,E),i)break}o.vertical&&(F+=Ud(t,n,e,o.vertical,s,l,f,w,g,S,Jh.vertical,["vertical"],B,G,C,x,E));let W=-1;const q=(t,e)=>t?Math.max(t,e):e;W=q(I,W),W=q(A,W),W=q(D,W);const X=W>-1?1:0;t.glyphOffsetArray.length>=Rf.MAX_GLYPHS&&U("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,w.sortKey),t.symbolInstances.emplaceBack(z.x,z.y,z.z,e.x,e.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical>=0?B.vertical:-1,k,G,V,void 0!==T?T:t.collisionBoxArray.length,void 0!==T?T+1:t.collisionBoxArray.length,void 0!==P?P:t.collisionBoxArray.length,void 0!==P?P+1:t.collisionBoxArray.length,void 0!==R?R:t.collisionBoxArray.length,void 0!==R?R+1:t.collisionBoxArray.length,O||t.collisionBoxArray.length,O?O+1:t.collisionBoxArray.length,c,N,F,M,L,X,0,j,H,W)}(t,a,f,s,n,r,o,A,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,b,S,l,0,x,T,g,e,i,u,c,p)};if("line"===R)for(const C of _d(e.geometry,0,0,Ha,Ha)){const e=vd(C,w,E,n.vertical||m,r,24,_,t.overscaling,Ha);for(const n of e)m&&Kd(t,m.text,P,n)||D(C,n,p)}else if("line-center"===R){for(const C of e.geometry)if(C.length>1){const t=yd(C,E,n.vertical||m,r,24,_);t&&D(C,t,p)}}else if("Polygon"===e.type)for(const C of $c(e.geometry,0)){const t=Md(C,16);D(C[0],new hd(t.x,t.y,0,0,void 0),p)}else if("LineString"===e.type)for(const C of e.geometry)D(C,new hd(C[0].x,C[0].y,0,0,void 0),p);else if("Point"===e.type)for(const C of e.geometry)for(const t of C)D([t],new hd(t.x,t.y,0,0,void 0),p)}const jd=255,Hd=jd*fh;function Ud(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m){const y=function(t,e,n,r,o,i,s,a){const l=[];if(0===e.positionedLines.length)return l;const u=r.layout.get("text-rotate").evaluate(i,{})*Math.PI/180,c=function(t){const e=t[0],n=t[1],r=e*n;return r>0?[e,-n]:r<0?[-e,n]:0===e?[n,e]:[n,-e]}(n);let p=Math.abs(e.top-e.bottom);for(const g of e.positionedLines)p-=g.lineOffset;const h=e.positionedLines.length,d=p/h;let f=e.top-n[1];for(let g=0;g<h;++g){const t=e.positionedLines[g];f=Id(e,d,f,g);for(const r of t.positionedGlyphs){if(!r.rect)continue;const t=r.rect||{};let i=4,p=!0,h=1,d=0;if(r.imageName){const t=s[r.imageName];if(!t)continue;if(t.sdf){U("SDF images are not supported in formatted text and will be ignored.");continue}p=!1,h=t.pixelRatio,i=1/h}const g=(o||a)&&r.vertical,m=r.metrics.advance*r.scale/2,y=r.metrics,_=r.rect;if(null===_)continue;a&&e.verticalizable&&(d=r.imageName?m-r.metrics.width*r.scale/2:0);const w=o?[r.x+m,r.y]:[0,0];let C=[0,0],b=[0,0],x=!1;o||(g?(b=[r.x+m+c[0],r.y+c[1]-d],x=!0):C=[r.x+m+n[0],r.y+n[1]-d]);const E=_.w*r.scale/(h*(r.localGlyph?2:1)),S=_.h*r.scale/(h*(r.localGlyph?2:1));let T,R,P,O;if(g){const t=r.y-f,e=new v(-m,m-t),n=-Math.PI/2,o=new v(...b);T=new v(-m+C[0],C[1]),T._rotateAround(n,e)._add(o),T.x+=-t+m,T.y-=(y.left-i)*r.scale;const s=r.imageName?y.advance*r.scale:24*r.scale,a=String.fromCharCode(r.glyph);Ch(a)?T.x+=(1-i)*r.scale:bh(a)?T.x+=s-y.height*r.scale+(-i-1)*r.scale:T.x+=r.imageName||y.width+2*i===_.w&&y.height+2*i===_.h?(s-S)/2:(s-(y.height+2*i)*r.scale)/2,R=new v(T.x,T.y-E),P=new v(T.x+S,T.y),O=new v(T.x+S,T.y-E)}else{const t=(y.left-i)*r.scale-m+C[0],e=(-y.top-i)*r.scale+C[1],n=t+E,o=e+S;T=new v(t,e),R=new v(n,e),P=new v(t,o),O=new v(n,o)}if(u){let t;t=o?new v(0,0):x?new v(c[0],c[1]):new v(n[0],n[1]),T._rotateAround(u,t),R._rotateAround(u,t),P._rotateAround(u,t),O._rotateAround(u,t)}const I=new v(0,0),A=new v(0,0);l.push({tl:T,tr:R,bl:P,br:O,tex:t,writingMode:e.writingMode,glyphOffset:w,sectionIndex:r.sectionIndex,isSDF:p,pixelOffsetTL:I,pixelOffsetBR:A,minFontScaleX:0,minFontScaleY:0})}}return l}(0,r,l,i,s,a,o,t.allowVerticalPlacement),_=t.textSizeData;let w=null;"source"===_.kind?(w=[fh*i.layout.get("text-size").evaluate(a,{},m)],w[0]>Hd&&U("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(jd,'. Reduce your "text-size".'))):"composite"===_.kind&&(w=[fh*f.compositeTextSizes[0].evaluate(a,{},m),fh*f.compositeTextSizes[1].evaluate(a,{},m)],(w[0]>Hd||w[1]>Hd)&&U("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(jd,'. Reduce your "text-size".'))),t.addSymbols(t.text,y,w,l,s,a,c,e,n,u.lineStartIndex,u.lineLength,d,g,m);for(const v of p)h[v]=t.text.placedSymbolArray.length-1;return 4*y.length}function Wd(t){for(const e in t)return t[e];return null}function qd(t,e,n,r,o,i,s,a,l,u){let c=s.top,p=s.bottom,h=s.left,d=s.right;const f=s.collisionPadding;if(f&&(h-=f[0],c-=f[1],d+=f[2],p+=f[3]),l){const t=new v(h,c),e=new v(d,c),n=new v(h,p),r=new v(d,p),o=C(l);let i=new v(0,0);u&&(i=new v(u[0],u[1])),t._rotateAround(o,i),e._rotateAround(o,i),n._rotateAround(o,i),r._rotateAround(o,i),h=Math.min(t.x,e.x,n.x,r.x),d=Math.max(t.x,e.x,n.x,r.x),c=Math.min(t.y,e.y,n.y,r.y),p=Math.max(t.y,e.y,n.y,r.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,h,c,d,p,a,r,o,i),t.length-1}function Xd(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Kd(t,e,n,r){const o=t.compareText;if(e in o){const t=o[e];for(let e=t.length-1;e>=0;e--)if(r.dist(t[e])<n)return!0}else o[e]=[];return o[e].push(r),!1}function Yd(t,e){const n=t.fovAboveCenter,r=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,o=(t._camera.position[2]*t.worldSize-r)/Math.cos(t._pitch),i=Math.sin(n)*o/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),s=Math.sin(t._pitch)*i+o;return Math.min(1.01*s,o*(1/t._horizonShift))}function Zd(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),r=t.x*n,o=(t.x+1)*n,i=t.y*n,s=(t.y+1)*n,a=Eu(r),l=Eu(o),u=Su(i),c=Su(s),p=e.project(a,u),h=e.project(l,u),d=e.project(l,c),f=e.project(a,c);let g=Math.min(p.x,h.x,d.x,f.x),m=Math.min(p.y,h.y,d.y,f.y),y=Math.max(p.x,h.x,d.x,f.x),v=Math.max(p.y,h.y,d.y,f.y);const _=n/16;function w(t,n,r,o,i,s){const a=(r+i)/2,l=(o+s)/2,u=e.project(Eu(a),Su(l)),c=Math.max(0,g-u.x,m-u.y,u.x-y,u.y-v);g=Math.min(g,u.x),y=Math.max(y,u.x),m=Math.min(m,u.y),v=Math.max(v,u.y),c>_&&(w(t,u,r,o,a,l),w(u,n,a,l,i,s))}w(p,h,r,i,o,i),w(h,d,o,i,o,s),w(d,f,o,s,r,s),w(f,p,r,s,r,i),g-=_,m-=_,y+=_,v+=_;const C=1/Math.max(y-g,v-m);return{scale:C,x:g*C,y:m*C,x2:y*C,y2:v*C,projection:e}}const Qd=Ya(new Float32Array(16));class Jd{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,e){return{x:0,y:0,z:0}}unproject(t,e){return new _u(0,0)}projectTilePoint(t,e,n){return{x:t,y:e,z:0}}locationPoint(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t._coordinatePoint(t.locationCoordinate(e),n)}pixelsPerMeter(t,e){return xu(1,t)*e}pixelSpaceConversion(t,e,n){return 1}farthestPixelDistance(t){return Yd(t,t.pixelsPerMeter)}pointCoordinate(t,e,n,r){const o=t.horizonLineFromTop(!1),i=new v(e,Math.max(o,n));return t.rayIntersectionCoordinate(t.pointRayIntersection(i,r))}pointCoordinate3D(t,e,n){const r=new v(e,n);if(t.elevation)return t.elevation.pointCoordinate(r);{const e=this.pointCoordinate(t,r.x,r.y,0);return[e.x,e.y,e.z]}}isPointAboveHorizon(t,e){if(t.elevation)return!this.pointCoordinate3D(t,e.x,e.y);const n=t.horizonLineFromTop();return e.y<n}createInversionMatrix(t,e){return Qd}createTileMatrix(t,e,n){let r,o,i;const s=n.canonical,a=Ya(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=Zd(s,this);r=1,o=l.x+n.wrap*l.scale,i=l.y,$a(a,a,[r/l.scale,r/l.scale,t.pixelsPerMeter/e])}else r=e/t.zoomScale(s.z),o=(s.x+Math.pow(2,s.z)*n.wrap)*r,i=s.y*r;return Ja(a,a,[o,i,0]),$a(a,a,[r/Ha,r/Ha,1]),a}upVector(t,e,n){return[0,0,1]}upVectorScale(t,e,n){return{metersToTile:1}}}class $d extends Jd{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[e,n]=this.parallels=t.parallels||[29.5,45.5],r=Math.sin(C(e));this.n=(r+Math.sin(C(n)))/2,this.c=1+r*(2*this.n-r),this.r0=Math.sqrt(this.c)/this.n}project(t,e){const{n:n,c:r,r0:o}=this,i=C(t-this.center[0]),s=C(e),a=Math.sqrt(r-2*n*Math.sin(s))/n;return{x:a*Math.sin(i*n),y:a*Math.cos(i*n)-o,z:0}}unproject(t,e){const{n:n,c:r,r0:o}=this,i=o+e;let s=Math.atan2(t,Math.abs(i))*Math.sign(i);i*n<0&&(s-=Math.PI*Math.sign(t)*Math.sign(i));const a=C(this.center[0])*n;s=O(s,-Math.PI-a,Math.PI-a);const l=R(b(s/n)+this.center[0],-180,180),u=Math.asin(R((r-(t*t+i*i)*n*n)/(2*n),-1,1)),c=R(b(u),-Ru,Ru);return new _u(l,c)}}const tf=1.340264,ef=-.081106,nf=893e-6,rf=.003796,of=Math.sqrt(3)/2;class sf extends Jd{project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const n=Math.asin(of*Math.sin(e)),r=n*n,o=r*r*r;return{x:.5*(t*Math.cos(n)/(of*(tf+3*ef*r+o*(7*nf+9*rf*r)))/Math.PI+.5),y:1-.5*(n*(tf+ef*r+o*(nf+rf*r))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,r=n*n,o=r*r*r;for(let u,c,p,h=0;h<12&&(c=n*(tf+ef*r+o*(nf+rf*r))-e,p=tf+3*ef*r+o*(7*nf+9*rf*r),u=c/p,n=R(n-u,-Math.PI/3,Math.PI/3),r=n*n,o=r*r*r,!(Math.abs(u)<1e-12));++h);const i=of*t*(tf+3*ef*r+o*(7*nf+9*rf*r))/Math.cos(n),s=Math.asin(Math.sin(n)/of),a=R(180*i/Math.PI,-180,180),l=R(180*s/Math.PI,-Ru,Ru);return new _u(a,l)}}class af extends Jd{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){return{x:.5+t/360,y:.5-e/360,z:0}}unproject(t,e){const n=360*(t-.5),r=R(360*(.5-e),-Ru,Ru);return new _u(n,r)}}const lf=Math.PI/2;function uf(t){return Math.tan((lf+t)/2)}class cf extends Jd{constructor(t){super(t),this.center=t.center||[0,30];const[e,n]=this.parallels=t.parallels||[30,30];let r=C(e),o=C(n);this.southernCenter=r+o<0,this.southernCenter&&(r=-r,o=-o);const i=Math.cos(r),s=uf(r);this.n=r===o?Math.sin(r):Math.log(i/Math.cos(o))/Math.log(uf(o)/s),this.f=i*Math.pow(uf(r),this.n)/this.n}project(t,e){e=C(e),this.southernCenter&&(e=-e),t=C(t-this.center[0]);const n=1e-6,{n:r,f:o}=this;o>0?e<-lf+n&&(e=-lf+n):e>lf-n&&(e=lf-n);const i=o/Math.pow(uf(e),r);let s=i*Math.sin(r*t),a=o-i*Math.cos(r*t);return s=.5*(s/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:s,y:this.southernCenter?a:1-a,z:0}}unproject(t,e){t=(2*t-.5)*Math.PI,this.southernCenter&&(e=1-e),e=(2*(1-e)-.5)*Math.PI;const{n:n,f:r}=this,o=r-e,i=Math.sign(o),s=Math.sign(n)*Math.sqrt(t*t+o*o);let a=Math.atan2(t,Math.abs(o))*i;o*n<0&&(a-=Math.PI*Math.sign(t)*i);const l=R(b(a/n)+this.center[0],-180,180),u=R(b(2*Math.atan(Math.pow(r/s,1/n))-lf),-Ru,Ru);return new _u(l,this.southernCenter?-u:u)}}class pf extends Jd{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,e){return{x:Cu(t),y:bu(e),z:0}}unproject(t,e){const n=Eu(t),r=Su(e);return new _u(n,r)}}const hf=C(Ru);class df extends Jd{project(t,e){const n=(e=C(e))*e,r=n*n;return{x:.5*((t=C(t))*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,r=25,o=0,i=n*n;do{i=n*n;const t=i*i;o=(n*(1.007226+i*(.015085+t*(.028874*i-.044475-.005916*t)))-e)/(1.007226+i*(.045255+t*(.259866*i-.311325-.005916*11*t))),n=R(n-o,-hf,hf)}while(Math.abs(o)>1e-6&&--r>0);i=n*n;const s=R(b(t/(.8707+i*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979))),-180,180),a=b(n);return new _u(s,a)}}const ff=C(Ru);class gf extends Jd{project(t,e){e=C(e),t=C(t);const n=Math.cos(e),r=2/Math.PI,o=Math.acos(n*Math.cos(t/2)),i=Math.sin(o)/o,s=.5*(t*r+2*n*Math.sin(t/2)/i)||0,a=.5*(e+Math.sin(e)/i)||0;return{x:.5*(s/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(t,e){let n=t=(2*t-.5)*Math.PI,r=e=(2*(1-e)-1)*Math.PI,o=25;const i=1e-6;let s=0,a=0;do{const o=Math.cos(r),i=Math.sin(r),l=2*i*o,u=i*i,c=o*o,p=Math.cos(n/2),h=Math.sin(n/2),d=2*p*h,f=h*h,g=1-c*p*p,m=g?1/g:0,y=g?Math.acos(o*p)*Math.sqrt(1/g):0,v=.5*(2*y*o*h+2*n/Math.PI)-t,_=.5*(y*i+r)-e,w=.5*m*(c*f+y*o*p*u)+1/Math.PI,C=m*(d*l/4-y*i*h),b=.125*m*(l*h-y*i*c*d),x=.5*m*(u*p+y*f*o)+.5,E=C*b-x*w;s=(_*C-v*x)/E,a=(v*b-_*w)/E,n=R(n-s,-Math.PI,Math.PI),r=R(r-a,-ff,ff)}while((Math.abs(s)>i||Math.abs(a)>i)&&--o>0);return new _u(b(n),b(r))}}class mf extends Jd{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(C(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){const{scale:n,cosPhi:r}=this;return{x:C(t)*r*n+.5,y:-Math.sin(C(e))/r*n+.5,z:0}}unproject(t,e){const{scale:n,cosPhi:r}=this,o=-(e-.5)/n,i=R(b((t-.5)/n)/r,-180,180),s=Math.asin(R(o*r,-1,1)),a=R(b(s),-Ru,Ru);return new _u(i,a)}}class yf extends pf{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,e,n){const r=ou(t,e,n);return _l(r,r,au(Zl(n))),{x:r[0],y:r[1],z:r[2]}}locationPoint(t,e){const n=ru(e.lat,e.lng),r=ml([],n),o=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(e),t._centerAltitude):t._centerAltitude;gl(n,n,r,xu(1,0)*Ha*o);const i=Ya(new Float64Array(16));return Qa(i,t.pixelMatrix,t.globeMatrix),_l(n,n,i),new v(n[0],n[1])}pixelsPerMeter(t,e){return xu(1,0)*e}pixelSpaceConversion(t,e,n){const r=xu(1,t)*e,o=An(xu(1,45)*e,r,n);return this.pixelsPerMeter(t,e)/o}createTileMatrix(t,e,n){const r=lu(Zl(n.canonical));return Qa(new Float64Array(16),t.globeMatrix,r)}createInversionMatrix(t,e){const{center:n}=t,r=au(Zl(e));return el(r,r,C(n.lng)),tl(r,r,C(n.lat)),$a(r,r,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(r)}pointCoordinate(t,e,n,r){return Xl(t,e,n,!0)||new Ou(0,0)}pointCoordinate3D(t,e,n){const r=this.pointCoordinate(t,e,n,0);return[r.x,r.y,r.z]}isPointAboveHorizon(t,e){return!Xl(t,e.x,e.y,!1)}farthestPixelDistance(t){const e=function(t,e){const n=t.cameraToCenterDistance,r=t._centerAltitude*e,o=t._camera,i=t._camera.forward(),s=ul([],fl([],i,-n),[0,0,r]),a=t.worldSize/(2*Math.PI),l=[0,0,-a],u=t.width/t.height,c=Math.tan(t.fovAboveCenter),p=fl([],o.up(),c),h=fl([],o.right(),c*u),d=ml([],ul([],ul([],i,p),h)),f=[];let g;if(new kl(s,d).closestPointOnSphere(l,a,f)){const e=ul([],f,l),n=bl([],e,s);g=Math.cos(t.fovAboveCenter)*al(n)}else{const t=bl([],s,l),e=bl([],l,s);ml(e,e);const n=al(t)-a;g=Math.sqrt(n*(n+2*a));const r=Math.acos(g/(a+n))-Math.acos(yl(i,e));g*=Math.cos(r)}return 1.01*g}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),n=cu(t.zoom);if(n>0){const r=Yd(t,xu(1,t.center.lat)*t.worldSize),o=t.worldSize/(2*Math.PI),i=Math.max(t.width,t.height)/t.worldSize*Math.PI;return An(e,r+o*(1-Math.cos(i)),Math.pow(n,10))}return e}upVector(t,e,n){return ou(e,n,t,1)}upVectorScale(t){return{metersToTile:ql(iu(Zl(t)))}}}function vf(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new pf(t);case"equirectangular":return new af(t);case"naturalEarth":return new df(t);case"equalEarth":return new sf(t);case"winkelTripel":return new gf(t);case"albers":return n?new mf(t):new $d(t);case"lambertConformalConic":return n?new mf(t):new cf(t);case"globe":return new yf(t)}throw new Error("Invalid projection name: ".concat(t.name))}const _f=xp.types,wf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cf(t,e,n,r,o,i,s,a,l,u,c,p,h){const d=a?Math.min(Hd,Math.round(a[0])):0,f=a?Math.min(Hd,Math.round(a[1])):0;t.emplaceBack(e,n,Math.round(32*r),Math.round(32*o),i,s,(d<<1)+(l?1:0),f,16*u,16*c,256*p,256*h)}function bf(t,e,n,r,o,i,s){t.emplaceBack(e,n,r,o,i,s)}function xf(t,e,n,r,o){t.emplaceBack(e,n,r,o),t.emplaceBack(e,n,r,o),t.emplaceBack(e,n,r,o),t.emplaceBack(e,n,r,o)}function Ef(t){for(const e of t.sections)if(qi(e.text))return!0;return!1}class Sf{constructor(t){this.layoutVertexArray=new Ds,this.indexArray=new Vs,this.programConfigurations=t,this.segments=new ja,this.dynamicLayoutVertexArray=new Ps,this.opacityVertexArray=new Ls,this.placedSymbolArray=new Js,this.globeExtVertexArray=new Ms}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ah.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,uh.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,wf,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,lh.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Vo(Sf,"SymbolBuffers");class Tf{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new ja,this.collisionVertexArray=new Gs,this.collisionVertexArrayExt=new Bs}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ch.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,ph.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Vo(Tf,"CollisionBuffers");class Rf{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ya([]),this.placementViewportMatrix=Ya([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gh(this.zoom,e["text-size"]),this.iconSizeData=gh(this.zoom,e["icon-size"]);const n=this.layers[0].layout,r=n.get("symbol-sort-key"),o=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==o&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map(t=>Jh[t]),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new Sf(new Da(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Sf(new Da(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ea,this.lineVertexArray=new na,this.symbolInstances=new ta}calculateGlyphDependencies(t,e,n,r,o){for(let i=0;i<t.length;i++)if(e[t.charCodeAt(i)]=!0,r&&o){const n=wh[t.charAt(i)];n&&(e[n.charCodeAt(0)]=!0)}}populate(t,e,n,r){const o=this.layers[0],i=o.layout,s="globe"===this.projection.name,a=i.get("text-font"),l=i.get("text-field"),u=i.get("icon-image"),c=("constant"!==l.value.kind||l.value.value instanceof Le&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),p="constant"!==u.value.kind||!!u.value.value||Object.keys(u.parameters).length>0,h=i.get("symbol-sort-key");if(this.features=[],!c&&!p)return;const d=e.iconDependencies,f=e.glyphDependencies,g=e.availableImages,m=new is(this.zoom);for(const{feature:y,id:v,index:_,sourceLayerIndex:w}of t){const t=o._featureFilter.needGeometry,e=Gu(y,t);if(!o._featureFilter.filter(m,e,n))continue;if(t||(e.geometry=ku(y,n,r)),s&&1!==y.type&&n.z<=5){const t=e.geometry,r=.98078528056,o=(t,e)=>yl(ou(t.x,t.y,n,1),ou(e.x,e.y,n,1))<r;for(let e=0;e<t.length;e++)t[e]=Mu(t[e],o)}let l,u;if(c){const t=o.getValueAndResolveTokens("text-field",e,n,g),r=Le.factory(t);Ef(r)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ns()||this.hasRTLText&&os.isParsed())&&(l=_h(r,o,e))}if(p){const t=o.getValueAndResolveTokens("icon-image",e,n,g);u=t instanceof Ne?t:Ne.fromString(t)}if(!l&&!u)continue;const C=this.sortFeaturesByKey?h.evaluate(e,{},n):void 0;if(this.features.push({id:v,text:l,icon:u,index:_,sourceLayerIndex:w,geometry:e.geometry,properties:y.properties,type:_f[y.type],sortKey:C}),u&&(d[u.name]=!0),l){const t=a.evaluate(e,{},n).join(","),r="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Jh.vertical)>=0;for(const e of l.sections)if(e.image)d[e.image.name]=!0;else{const n=Bi(l.toString()),o=e.fontStack||t,i=f[o]=f[o]||{};this.calculateGlyphDependencies(e.text,i,r,this.allowVerticalPlacement,n)}}}"line"===i.get("symbol-placement")&&(this.features=function(t){const e={},n={},r=[];let o=0;function i(e){r.push(t[e]),o++}function s(t,e,o){const i=n[t];return delete n[t],n[e]=i,r[i].geometry[0].pop(),r[i].geometry[0]=r[i].geometry[0].concat(o[0]),i}function a(t,n,o){const i=e[n];return delete e[n],e[t]=i,r[i].geometry[0].shift(),r[i].geometry[0]=o[0].concat(r[i].geometry[0]),i}function l(t,e,n){const r=n?e[0][e[0].length-1]:e[0][0];return"".concat(t,":").concat(r.x,":").concat(r.y)}for(let u=0;u<t.length;u++){const c=t[u],p=c.geometry,h=c.text?c.text.toString():null;if(!h){i(u);continue}const d=l(h,p),f=l(h,p,!0);if(d in n&&f in e&&n[d]!==e[f]){const t=a(d,f,p),o=s(d,f,r[t].geometry);delete e[d],delete n[f],n[l(h,r[o].geometry,!0)]=o,r[t].geometry=null}else d in n?s(d,f,p):f in e?a(d,f,p):(i(u),e[d]=o-1,n[f]=o-1)}return r.filter(t=>t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((t,e)=>t.sortKey-e.sortKey)}update(t,e,n,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n,r))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=vf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment)for(const{x:r,y:o}of e)this.lineVertexArray.emplaceBack(r,o);return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,e,n,r,o,i,s,a,l,u,c,p,h,d){const f=t.indexArray,g=t.layoutVertexArray,m=t.globeExtVertexArray,y=t.segments.prepareSegment(4*e.length,g,f,this.canOverlap?i.sortKey:void 0),v=this.glyphOffsetArray.length,_=y.vertexLength,w=this.allowVerticalPlacement&&s===Jh.vertical?Math.PI/2:0,C=i.text&&i.text.sections;for(let x=0;x<e.length;x++){const{tl:r,tr:o,bl:s,br:u,tex:c,pixelOffsetTL:p,pixelOffsetBR:v,minFontScaleX:_,minFontScaleY:b,glyphOffset:E,isSDF:S,sectionIndex:T}=e[x],R=y.vertexLength,P=E[1];if(Cf(g,l.x,l.y,r.x,P+r.y,c.x,c.y,n,S,p.x,p.y,_,b),Cf(g,l.x,l.y,o.x,P+o.y,c.x+c.w,c.y,n,S,v.x,p.y,_,b),Cf(g,l.x,l.y,s.x,P+s.y,c.x,c.y+c.h,n,S,p.x,v.y,_,b),Cf(g,l.x,l.y,u.x,P+u.y,c.x+c.w,c.y+c.h,n,S,v.x,v.y,_,b),a){const{x:e,y:n,z:r}=a.anchor,[o,i,s]=a.up;bf(m,e,n,r,o,i,s),bf(m,e,n,r,o,i,s),bf(m,e,n,r,o,i,s),bf(m,e,n,r,o,i,s),xf(t.dynamicLayoutVertexArray,e,n,r,w)}else xf(t.dynamicLayoutVertexArray,l.x,l.y,l.z,w);f.emplaceBack(R,R+1,R+2),f.emplaceBack(R+1,R+2,R+3),y.vertexLength+=4,y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(E[0]),x!==e.length-1&&T===e[x+1].sectionIndex||t.programConfigurations.populatePaintArrays(g.length,i,i.index,{},h,d,C&&C[T])}const b=a?a.anchor:l;t.placedSymbolArray.emplaceBack(b.x,b.y,b.z,l.x,l.y,v,this.glyphOffsetArray.length-v,_,u,c,l.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],s,0,!1,0,p,0)}_commitLayoutVertex(t,e,n,r,o,i,s){t.emplaceBack(e,n,r,o,i,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(t,e,n,r,o,i,s){const a=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=a.vertexLength,u=s.tileAnchorX,c=s.tileAnchorY;for(let h=0;h<4;h++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),n.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(n.layoutVertexArray,r,o,i,u,c,new v(t.x1,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,r,o,i,u,c,new v(t.x2,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,r,o,i,u,c,new v(t.x2,t.y2)),this._commitLayoutVertex(n.layoutVertexArray,r,o,i,u,c,new v(t.x1,t.y2)),a.vertexLength+=4;const p=n.indexArray;p.emplaceBack(l,l+1),p.emplaceBack(l+1,l+2),p.emplaceBack(l+2,l+3),p.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,n,r,o,i){for(let s=r;s<o;s++){const r=n.get(s),o=this.getSymbolInstanceTextSize(t,i,e,s);this._addCollisionDebugVertices(r,o,this.textCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,i)}}_addIconDebugCollisionBoxes(t,e,n,r,o,i){for(let s=r;s<o;s++){const r=n.get(s),o=this.getSymbolInstanceIconSize(t,e,i.placedIconSymbolIndex);this._addCollisionDebugVertices(r,o,this.iconCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,i)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Tf(Fs,hh.members,qs),this.iconCollisionBox=new Tf(Fs,hh.members,qs);const n=yh(this.iconSizeData,t),r=yh(this.textSizeData,t);for(let o=0;o<this.symbolInstances.length;o++){const i=this.symbolInstances.get(o);this._addTextDebugCollisionBoxes(r,t,e,i.textBoxStartIndex,i.textBoxEndIndex,i),this._addTextDebugCollisionBoxes(r,t,e,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i),this._addIconDebugCollisionBoxes(n,t,e,i.iconBoxStartIndex,i.iconBoxEndIndex,i),this._addIconDebugCollisionBoxes(n,t,e,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i)}}getSymbolInstanceTextSize(t,e,n,r){const o=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:r),i=mh(this.textSizeData,t,o)/24;return this.tilePixelRatio*i}getSymbolInstanceIconSize(t,e,n){const r=this.icon.placedSymbolArray.get(n),o=mh(this.iconSizeData,t,r);return this.tilePixelRatio*o}_commitDebugCollisionVertexUpdate(t,e,n){t.emplaceBack(e,-n,-n),t.emplaceBack(e,n,-n),t.emplaceBack(e,n,n),t.emplaceBack(e,-n,n)}_updateTextDebugCollisionBoxes(t,e,n,r,o,i){for(let s=r;s<o;s++){const r=n.get(s),o=this.getSymbolInstanceTextSize(t,i,e,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,o,r.padding)}}_updateIconDebugCollisionBoxes(t,e,n,r,o,i){for(let s=r;s<o;s++){const r=n.get(s),o=this.getSymbolInstanceIconSize(t,e,i);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,o,r.padding)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=yh(this.iconSizeData,t),r=yh(this.textSizeData,t);for(let o=0;o<this.symbolInstances.length;o++){const i=this.symbolInstances.get(o);this._updateTextDebugCollisionBoxes(r,t,e,i.textBoxStartIndex,i.textBoxEndIndex,i),this._updateTextDebugCollisionBoxes(r,t,e,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i),this._updateIconDebugCollisionBoxes(n,t,e,i.iconBoxStartIndex,i.iconBoxEndIndex,i.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(n,t,e,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,n,r,o,i,s,a,l){const u={};if(e<n){const{x1:n,y1:r,x2:o,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(e);u.textBox={x1:n,y1:r,x2:o,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.textFeatureIndex=d}if(r<o){const{x1:e,y1:n,x2:o,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(r);u.verticalTextBox={x1:e,y1:n,x2:o,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.verticalTextFeatureIndex=d}if(i<s){const{x1:e,y1:n,x2:r,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(i);u.iconBox={x1:e,y1:n,x2:r,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.iconFeatureIndex=d}if(a<l){const{x1:e,y1:n,x2:r,y2:o,padding:i,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(a);u.verticalIconBox={x1:e,y1:n,x2:r,y2:o,padding:i,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.verticalIconFeatureIndex=d}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs;for(let o=n.vertexStartIndex;o<r;o+=4)t.indexArray.emplaceBack(o,o+1,o+2),t.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),r=[],o=[],i=[];for(let s=0;s<this.symbolInstances.length;++s){i.push(s);const t=this.symbolInstances.get(s);r.push(0|Math.round(e*t.tileAnchorX+n*t.tileAnchorY)),o.push(t.featureIndex)}return i.sort((t,e)=>r[t]-r[e]||o[e]-o[t]),i}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex);const{rightJustifiedTextSymbolIndex:n,centerJustifiedTextSymbolIndex:r,leftJustifiedTextSymbolIndex:o,verticalPlacedTextSymbolIndex:i,placedIconSymbolIndex:s,verticalPlacedIconSymbolIndex:a}=e;n>=0&&this.addIndicesForPlacedSymbol(this.text,n),r>=0&&r!==n&&this.addIndicesForPlacedSymbol(this.text,r),o>=0&&o!==r&&o!==n&&this.addIndicesForPlacedSymbol(this.text,o),i>=0&&this.addIndicesForPlacedSymbol(this.text,i),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Vo(Rf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Rf.MAX_GLYPHS=65535,Rf.addDynamicAttributes=xf;const Pf=new ys({"symbol-placement":new fs(te.layout_symbol["symbol-placement"]),"symbol-spacing":new fs(te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fs(te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gs(te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fs(te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fs(te.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fs(te.layout_symbol["icon-ignore-placement"]),"icon-optional":new fs(te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fs(te.layout_symbol["icon-rotation-alignment"]),"icon-size":new gs(te.layout_symbol["icon-size"]),"icon-text-fit":new fs(te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fs(te.layout_symbol["icon-text-fit-padding"]),"icon-image":new gs(te.layout_symbol["icon-image"]),"icon-rotate":new gs(te.layout_symbol["icon-rotate"]),"icon-padding":new fs(te.layout_symbol["icon-padding"]),"icon-keep-upright":new fs(te.layout_symbol["icon-keep-upright"]),"icon-offset":new gs(te.layout_symbol["icon-offset"]),"icon-anchor":new gs(te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fs(te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fs(te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fs(te.layout_symbol["text-rotation-alignment"]),"text-field":new gs(te.layout_symbol["text-field"]),"text-font":new gs(te.layout_symbol["text-font"]),"text-size":new gs(te.layout_symbol["text-size"]),"text-max-width":new gs(te.layout_symbol["text-max-width"]),"text-line-height":new gs(te.layout_symbol["text-line-height"]),"text-letter-spacing":new gs(te.layout_symbol["text-letter-spacing"]),"text-justify":new gs(te.layout_symbol["text-justify"]),"text-radial-offset":new gs(te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fs(te.layout_symbol["text-variable-anchor"]),"text-anchor":new gs(te.layout_symbol["text-anchor"]),"text-max-angle":new fs(te.layout_symbol["text-max-angle"]),"text-writing-mode":new fs(te.layout_symbol["text-writing-mode"]),"text-rotate":new gs(te.layout_symbol["text-rotate"]),"text-padding":new fs(te.layout_symbol["text-padding"]),"text-keep-upright":new fs(te.layout_symbol["text-keep-upright"]),"text-transform":new gs(te.layout_symbol["text-transform"]),"text-offset":new gs(te.layout_symbol["text-offset"]),"text-allow-overlap":new fs(te.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fs(te.layout_symbol["text-ignore-placement"]),"text-optional":new fs(te.layout_symbol["text-optional"])});var Of={paint:new ys({"icon-opacity":new gs(te.paint_symbol["icon-opacity"]),"icon-color":new gs(te.paint_symbol["icon-color"]),"icon-halo-color":new gs(te.paint_symbol["icon-halo-color"]),"icon-halo-width":new gs(te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gs(te.paint_symbol["icon-halo-blur"]),"icon-translate":new fs(te.paint_symbol["icon-translate"]),"icon-translate-anchor":new fs(te.paint_symbol["icon-translate-anchor"]),"text-opacity":new gs(te.paint_symbol["text-opacity"]),"text-color":new gs(te.paint_symbol["text-color"],{runtimeType:he,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new gs(te.paint_symbol["text-halo-color"]),"text-halo-width":new gs(te.paint_symbol["text-halo-width"]),"text-halo-blur":new gs(te.paint_symbol["text-halo-blur"]),"text-translate":new fs(te.paint_symbol["text-translate"]),"text-translate-anchor":new fs(te.paint_symbol["text-translate-anchor"])}),layout:Pf};class If{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:le,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vo(If,"FormatSectionOverride",{omit:["defaultValue"]});class Af extends Ba{constructor(t){super(t,Of)}recalculate(t,e){super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const t=[];for(const e of n)t.indexOf(e)<0&&t.push(e);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,r){const o=this.layout.get(t).evaluate(e,{},n,r),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||Hr(i.value)||!o?o:function(t,e){return e.replace(/{([^{}]+)}/g,(e,n)=>n in t?String(t[n]):"")}(e.properties,o)}createBucket(t){return new Rf(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Of.paint.overridableProperties){if(!Af.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new If(e),r=new jr(n,e.property.specification);let o=null;o="constant"===e.value.kind||"source"===e.value.kind?new Wr("source",r):new qr("composite",r,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new hs(e.property,o,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&Af.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),r=Of.paint.properties[e];let o=!1;const i=t=>{for(const e of t)if(r.overrides&&r.overrides.hasOverride(e))return void(o=!0)};if("constant"===n.value.kind&&n.value.value instanceof Le)i(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{o||(e instanceof ze&&Ge(e.value)===me?i(e.value.sections):e instanceof qe?i(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return o}getProgramConfiguration(t){return new Aa(this,t)}}var Df={paint:new ys({"background-color":new fs(te.paint_background["background-color"]),"background-pattern":new fs(te.paint_background["background-pattern"]),"background-opacity":new fs(te.paint_background["background-opacity"])})},Mf={paint:new ys({"raster-opacity":new fs(te.paint_raster["raster-opacity"]),"raster-hue-rotate":new fs(te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fs(te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fs(te.paint_raster["raster-brightness-max"]),"raster-saturation":new fs(te.paint_raster["raster-saturation"]),"raster-contrast":new fs(te.paint_raster["raster-contrast"]),"raster-resampling":new fs(te.paint_raster["raster-resampling"]),"raster-fade-duration":new fs(te.paint_raster["raster-fade-duration"])})};class Lf extends Ba{constructor(t){super(t,{}),this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var Nf={paint:new ys({"sky-type":new fs(te.paint_sky["sky-type"]),"sky-atmosphere-sun":new fs(te.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new fs(te.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new fs(te.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new fs(te.paint_sky["sky-gradient-radius"]),"sky-gradient":new ms(te.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new fs(te.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new fs(te.paint_sky["sky-atmosphere-color"]),"sky-opacity":new fs(te.paint_sky["sky-opacity"])})};function Ff(t,e,n){const r=[0,0,1],o=Ol([]);return Al(o,o,n?-C(t)+Math.PI:C(t)),Il(o,o,-C(e)),wl(r,r,o),ml(r,r)}const kf={circle:class extends Ba{constructor(t){super(t,ic)}createBucket(t){return new zu(t)}queryRadius(t){const e=t;return tc("circle-radius",this,e)+tc("circle-stroke-width",this,e)+ec(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,r,o,i,s,a){const l=rc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return sc(t,r,i,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,u)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Aa(this,t)}},heatmap:class extends Ba{createBucket(t){return new pc(t)}constructor(t){super(t,yc),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return tc("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,r,o,i,s,a){const l=this.paint.get("heatmap-radius").evaluate(e,n);return sc(t,r,i,s,a,!0,!0,new v(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Aa(this,t)}},hillshade:class extends Ba{constructor(t){super(t,_c)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ba{constructor(t){super(t,ip)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new Aa(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new rp(t)}queryRadius(){return ec(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,r,o,i){return!t.queryGeometry.isAboveHorizon&&Uu(nc(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),r)}isTileClipped(){return!0}},"fill-extrusion":class extends Ba{constructor(t){super(t,Vp)}createBucket(t){return new Ip(t)}queryRadius(){return ec(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Aa(this,t)}queryIntersectsFeature(t,e,n,r,o,i,s,a,l){const u=rc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),c=this.paint.get("fill-extrusion-height").evaluate(e,n),p=this.paint.get("fill-extrusion-base").evaluate(e,n),h=[0,0],d=a&&i.elevation,f=i.elevation?i.elevation.exaggeration():1,g=t.tile.getBucket(this);if(d&&g instanceof Ip){const t=g.centroidVertexArray,e=l+1;e<t.length&&(h[0]=t.geta_centroid_pos0(e),h[1]=t.geta_centroid_pos1(e))}if(0===h[0]&&1===h[1])return!1;"globe"===i.projection.name&&(r=Gp([r],[new v(0,0),new v(Ha,Ha)],t.tileID.canonical).map(t=>t.polygon).flat());const m=d?a:null,[y,_]=function(t,e,n,r,o,i,s,a,l,u,c){return"globe"===t.projection.name?function(t,e,n,r,o,i,s,a,l,u,c){const p=[],h=[],d=t.projection.upVectorScale(c,t.center.lat,t.worldSize).metersToTile,f=[0,0,0,1],g=[0,0,0,1],m=(t,e,n,r)=>{t[0]=e,t[1]=n,t[2]=r,t[3]=1},y=kp();n>0&&(n+=y),r+=y;for(const v of e){const e=[],y=[];for(const p of v){const h=p.x+o.x,v=p.y+o.y,_=t.projection.projectTilePoint(h,v,c),w=t.projection.upVector(c,p.x,p.y);let C=n,b=r;if(s){const t=Yp(h,v,n,r,s,a,l,u);C+=t.base,b+=t.top}0!==n?m(f,_.x+w[0]*d*C,_.y+w[1]*d*C,_.z+w[2]*d*C):m(f,_.x,_.y,_.z),m(g,_.x+w[0]*d*b,_.y+w[1]*d*b,_.z+w[2]*d*b),_l(f,f,i),_l(g,g,i),e.push(new qp(f[0],f[1],f[2])),y.push(new qp(g[0],g[1],g[2]))}p.push(e),h.push(y)}return[p,h]}(t,e,n,r,o,i,s,a,l,u,c):s?function(t,e,n,r,o,i,s,a,l){const u=[],c=[],p=[0,0,0,1];for(const h of t){const t=[],d=[];for(const u of h){const c=u.x+r.x,h=u.y+r.y,f=Yp(c,h,e,n,i,s,a,l);p[0]=c,p[1]=h,p[2]=f.base,p[3]=1,Rl(p,p,o),p[3]=Math.max(p[3],1e-5);const g=new qp(p[0]/p[3],p[1]/p[3],p[2]/p[3]);p[0]=c,p[1]=h,p[2]=f.top,p[3]=1,Rl(p,p,o),p[3]=Math.max(p[3],1e-5);const m=new qp(p[0]/p[3],p[1]/p[3],p[2]/p[3]);t.push(g),d.push(m)}u.push(t),c.push(d)}return[u,c]}(e,n,r,o,i,s,a,l,u):function(t,e,n,r,o){const i=[],s=[],a=o[8]*e,l=o[9]*e,u=o[10]*e,c=o[11]*e,p=o[8]*n,h=o[9]*n,d=o[10]*n,f=o[11]*n;for(const g of t){const t=[],e=[];for(const n of g){const i=n.x+r.x,s=n.y+r.y,g=o[0]*i+o[4]*s+o[12],m=o[1]*i+o[5]*s+o[13],y=o[2]*i+o[6]*s+o[14],v=o[3]*i+o[7]*s+o[15],_=g+a,w=m+l,C=y+u,b=Math.max(v+c,1e-5),x=g+p,E=m+h,S=y+d,T=Math.max(v+f,1e-5);t.push(new qp(_/b,w/b,C/b)),e.push(new qp(x/T,E/T,S/T))}i.push(t),s.push(e)}return[i,s]}(e,n,r,o,i)}(i,r,p,c,u,s,m,h,f,i.center.lat,t.tileID.canonical),w=t.queryGeometry;return function(t,e,n){let r=1/0;Uu(n,e)&&(r=Kp(n,e[0]));for(let o=0;o<e.length;o++){const i=e[o],s=t[o];for(let t=0;t<i.length-1;t++){const e=i[t],o=[e,i[t+1],s[t+1],s[t],e];ju(n,o)&&(r=Math.min(r,Kp(n,o)))}}return r!==1/0&&r}(y,_,w.isPointQuery()?w.screenBounds:w.screenGeometry)}},line:class extends Ba{constructor(t){super(t,oh),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof In,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=ih.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new nh(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Aa(this,t)}queryRadius(t){const e=t,n=sh(tc("line-width",this,e),tc("line-gap-width",this,e)),r=tc("line-offset",this,e);return n/2+Math.abs(r)+ec(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,r,o,i){if(t.queryGeometry.isAboveHorizon)return!1;const s=nc(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),a=t.pixelToTileUnitsFactor/2*sh(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(r=function(t,e){const n=[],r=new v(0,0);for(let o=0;o<t.length;o++){const i=t[o],s=[];for(let t=0;t<i.length;t++){const n=i[t],o=i[t+1],a=0===t?r:n.sub(i[t-1])._unit()._perp(),l=t===i.length-1?r:o.sub(n)._unit()._perp(),u=a._add(l)._unit();u._mult(1/(u.x*l.x+u.y*l.y)),s.push(u._mult(e)._add(n))}n.push(s)}return n}(r,l*t.pixelToTileUnitsFactor)),function(t,e,n){for(let r=0;r<e.length;r++){const o=e[r];if(t.length>=3)for(let e=0;e<o.length;e++)if(Qu(t,o[e]))return!0;if(Wu(t,o,n))return!0}return!1}(s,r,a)}isTileClipped(){return!0}},symbol:Af,background:class extends Ba{constructor(t){super(t,Df)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ba{constructor(t){super(t,Mf)}getProgramIds(){return["raster"]}},sky:class extends Ba{constructor(t){super(t,Nf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=vc({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const n=this.paint.get("sky-atmosphere-sun"),r=!n,o=t.style.light,i=o.properties.get("position");return r&&"viewport"===o.properties.get("anchor")&&U("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),r?Ff(i.azimuthal,90-i.polar,e):Ff(n[0],90-n[1],e)}const n=this.paint.get("sky-gradient-center");return Ff(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class Gf{constructor(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)}update(t,n,r){const{width:o,height:i}=t,{context:s}=this,{gl:a}=s,{HTMLImageElement:l,HTMLCanvasElement:u,HTMLVideoElement:c,ImageData:p,ImageBitmap:h}=e;if(a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!n||!1!==n.premultiply)),r||this.size&&this.size[0]===o&&this.size[1]===i){const{x:e,y:n}=r||{x:0,y:0};t instanceof l||t instanceof u||t instanceof c||t instanceof p||h&&t instanceof h?a.texSubImage2D(a.TEXTURE_2D,0,e,n,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,n,o,i,a.RGBA,a.UNSIGNED_BYTE,t.data)}else this.size=[o,i],t instanceof l||t instanceof u||t instanceof c||t instanceof p||h&&t instanceof h?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,o,i,0,this.format,a.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&a.generateMipmap(a.TEXTURE_2D)}bind(t,e){const{context:n}=this,{gl:r}=n;r.bindTexture(r.TEXTURE_2D,this.texture),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.useMipmap?t===r.NEAREST?r.NEAREST_MIPMAP_NEAREST:r.LINEAR_MIPMAP_NEAREST:t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Bf{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Vf{constructor(){this.tasks={},this.taskQueue=[],G(["process"],this),this.invoker=new Bf(this.process),this.nextId=0}add(t,e){const n=this.nextId++,r=function(t){let{type:e,isSymbolTile:n,zoom:r}=t;return r=r||0,"message"===e?0:"maybePrepare"!==e||n?"parseTile"!==e||n?"parseTile"===e&&n?300-r:"maybePrepare"===e&&n?400-r:500:200-r:100-r}(e);if(0===r){X();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:t,metadata:e,priority:r,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){X();try{if(this.taskQueue=this.taskQueue.filter(t=>!!this.tasks[t]),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let r=0;r<this.taskQueue.length;r++){const n=this.tasks[this.taskQueue[r]];n.priority<e&&(e=n.priority,t=r)}if(null===t)return null;const n=this.taskQueue[t];return this.taskQueue.splice(t,1),n}remove(){this.invoker.remove()}}class zf{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const jf=["tile","layer","source","sourceLayer","state"];class Hf{constructor(t,e,n,r,o){this.type="Feature",this._vectorTileFeature=t,this._z=e,this._x=n,this._y=r,this.properties=t.properties,this.id=o}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(t.id=this.id);for(const e of jf)void 0!==this[e]&&(t[e]=this[e]);return t}}const Uf=new Uint16Array(8184);for(let Ng=0;Ng<2046;Ng++){let t=Ng+2,e=0,n=0,r=0,o=0,i=0,s=0;for(1&t?r=o=i=32:e=n=s=32;(t>>=1)>1;){const a=e+r>>1,l=n+o>>1;1&t?(r=e,o=n,e=i,n=s):(e=r,n=o,r=i,o=s),i=a,s=l}const a=4*Ng;Uf[a+0]=e,Uf[a+1]=n,Uf[a+2]=r,Uf[a+3]=o}const Wf=new Uint16Array(2178),qf=new Uint8Array(1089),Xf=new Uint16Array(1089);function Kf(t){return 0===t?-.03125:32===t?.03125:0}var Yf=bs([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Zf={type:2,extent:Ha,loadGeometry:()=>[[new v(0,0),new v(8193,0),new v(8193,8193),new v(0,8193),new v(0,0)]]};class Qf{constructor(t,e,n,r,o){this.tileID=t,this.uid=L(),this.uses=0,this.tileSize=e,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=o,this.expiredRequestCount=0,this.state="loading",r&&r.transform&&(this.projection=r.transform.projection)}registerFadeDuration(t){const e=t+this.timeAdded;e<Kt.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Zd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,e,n){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const r of t){const t=r.layerIds.map(t=>e.getLayer(t)).filter(Boolean);if(0!==t.length){r.layers=t,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map(e=>t.filter(t=>t.id===e)[0]));for(const e of t)n[e.id]=r}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Rf){if(this.hasSymbolBuckets=!0,!n)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof Rf&&e.hasRTLText){this.hasRTLText=!0,os.isLoading()||os.isLoaded()||"deferred"!==ns()||rs();break}}this.queryPadding=0;for(const t in this.buckets){const n=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(n))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new Zs}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const n in this.buckets){const e=this.buckets[n];e.uploadPending()&&e.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Gf(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Gf(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Gf(t,this.lineAtlas.image,e.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,r,o,i,s,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:r,pixelPosMatrix:s,transform:i,params:o,tileTransform:this.tileTransform},t,e,n):{}}querySourceFeatures(t,e){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const r=n.loadVTLayers(),o=e?e.sourceLayer:"",i=r._geojsonTileLayer||r[o];if(!i)return;const s=ro(e&&e.filter),{z:a,x:l,y:u}=this.tileID.canonical,c={z:a,x:l,y:u};for(let p=0;p<i.length;p++){const e=i.feature(p);if(s.needGeometry){const t=Gu(e,!0);if(!s.filter(new is(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new is(this.tileID.overscaledZ),e))continue;const r=n.getId(e,o),h=new Hf(e,a,l,u,r);h.tile=c,t.push(h)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=K(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let n=!1;if(this.expirationTime>t)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{const r=this.expirationTime-e;r?this.expirationTime=t+Math.max(r,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length||!e)return;const n=this.latestFeatureIndex.loadVTLayers(),r=e.style.listImages();for(const o in this.buckets){if(!e.style.hasLayer(o))continue;const i=this.buckets[o],s=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[s],l=t[s];if(!a||!l||0===Object.keys(l).length)continue;if(i.update(l,a,r,this.imageAtlas&&this.imageAtlas.patternPositions||{}),i instanceof nh||i instanceof rp){const t=e.style._getSourceCache(i.layers[0].source);e._terrain&&e._terrain.enabled&&t&&i.programConfigurations.needsUpload&&e._terrain._clearRenderCacheForTile(t.id,this.tileID)}const u=e&&e.style&&e.style.getLayer(o);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Kt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Kt.now()+t}setTexture(t,e){const n=e.context,r=n.gl;this.texture=this.texture||e.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new Gf(n,t,r.RGBA,{useMipmap:!0}),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE))}setDependencies(t,e){const n={};for(const r of e)n[r]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,e){if(!e||"mercator"===e.name||this._tileDebugBuffer)return;const n=ku(Zf,this.tileID.canonical,this.tileTransform)[0],r=new Es,o=new Xs;for(let i=0;i<n.length;i++){const{x:t,y:e}=n[i];r.emplaceBack(t,e),o.emplaceBack(i)}o.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(o),this._tileDebugBuffer=t.createVertexBuffer(r,Fl.members),this._tileDebugSegments=ja.simpleSegment(0,0,r.length,o.length)}_makeTileBoundsBuffers(t,e){if(this._tileBoundsBuffer||!e||"mercator"===e.name)return;const n=ku(Zf,this.tileID.canonical,this.tileTransform)[0];let r,o;if(this.isRaster){const t=function(t,e){const n=Zd(t,e),r=Math.pow(2,t.z);for(let u=0;u<33;u++)for(let o=0;o<33;o++){const i=Eu((t.x+(o+Kf(o))/32)/r),s=Su((t.y+(u+Kf(u))/32)/r),a=e.project(i,s),l=33*u+o;Wf[2*l+0]=Math.round((a.x*n.scale-n.x)*Ha),Wf[2*l+1]=Math.round((a.y*n.scale-n.y)*Ha)}qf.fill(0),Xf.fill(0);for(let u=2045;u>=0;u--){const t=4*u,e=Uf[t+0],n=Uf[t+1],r=Uf[t+2],o=Uf[t+3],i=e+r>>1,s=n+o>>1,a=i+s-n,l=s+e-i,c=33*n+e,p=33*o+r,h=33*s+i,d=Math.hypot((Wf[2*c+0]+Wf[2*p+0])/2-Wf[2*h+0],(Wf[2*c+1]+Wf[2*p+1])/2-Wf[2*h+1])>=16;qf[h]=qf[h]||(d?1:0),u<1022&&(qf[h]=qf[h]||qf[33*(n+l>>1)+(e+a>>1)]||qf[33*(o+l>>1)+(r+a>>1)])}const o=new Ts,i=new Vs;let s=0;function a(t,e){const n=33*e+t;return 0===Xf[n]&&(o.emplaceBack(Wf[2*n+0],Wf[2*n+1],t*Ha/32,e*Ha/32),Xf[n]=++s),Xf[n]-1}function l(t,e,n,r,o,s){const u=t+n>>1,c=e+r>>1;if(Math.abs(t-o)+Math.abs(e-s)>1&&qf[33*c+u])l(o,s,t,e,u,c),l(n,r,o,s,u,c);else{const l=a(t,e),u=a(n,r),c=a(o,s);i.emplaceBack(l,u,c)}}return l(0,0,32,32,32,0),l(32,32,0,0,0,32),{vertices:o,indices:i}}(this.tileID.canonical,e);r=t.vertices,o=t.indices}else{r=new Ts,o=new Vs;for(const{x:e,y:o}of n)r.emplaceBack(e,o,0,0);const t=Yc(r.int16,void 0,4);for(let e=0;e<t.length;e+=3)o.emplaceBack(t[e],t[e+1],t[e+2])}this._tileBoundsBuffer=t.createVertexBuffer(r,Yf.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(o),this._tileBoundsSegments=ja.simpleSegment(0,0,r.length,o.length)}_makeGlobeTileDebugBuffers(t,e){const n=e.projection;if(!n||"globe"!==n.name||e.freezeTileCoverage)return;const r=this.tileID.canonical,o=au(Jl(r,e)),i=cu(e.zoom);let s;i>0&&(s=Za(new Float64Array(16),e.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,r,e,o,s,i),this._makeGlobeTileDebugTextBuffer(t,r,e,o,s,i)}_globePoint(t,e,n,r,o,i,s){let a=ou(t,e,n);if(i){const o=1<<n.z,l=Cu(r.center.lng),u=bu(r.center.lat),c=(n.x+.5)/o-l;let p=0;c>.5?p=-1:c<-.5&&(p=1);let h=(t/Ha+n.x)/o+p,d=(e/Ha+n.y)/o;h=(h-l)*r._pixelsPerMercatorPixel+l,d=(d-u)*r._pixelsPerMercatorPixel+u;const f=[h*r.worldSize,d*r.worldSize,0];_l(f,f,i),a=Ql(a,f,s)}return _l(a,a,o)}_makeGlobeTileDebugBorderBuffer(t,e,n,r,o,i){const s=new Es,a=new Xs,l=new Ss,u=(t,u,c,p,h)=>{const d=(c-t)/(h-1),f=(p-u)/(h-1),g=s.length;for(let m=0;m<h;m++){const c=t+m*d,p=u+m*f;s.emplaceBack(c,p);const h=this._globePoint(c,p,e,n,r,o,i);l.emplaceBack(h[0],h[1],h[2]),a.emplaceBack(g+m)}},c=Ha;u(0,0,c,0,16),u(c,0,c,c,16),u(c,c,0,c,16),u(0,c,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(a),this._tileDebugBuffer=t.createVertexBuffer(s,Fl.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(l,Nl.members),this._tileDebugSegments=ja.simpleSegment(0,0,s.length,a.length)}_makeGlobeTileDebugTextBuffer(t,e,n,r,o,i){const s=new Es,a=new Vs,l=new Ss,u=25;a.reserve(32),s.reserve(u),l.reserve(u);const c=(t,e)=>u*t+e;for(let p=0;p<u;p++){const t=2048*p;for(let a=0;a<u;a++){const u=2048*a;s.emplaceBack(u,t);const c=this._globePoint(u,t,e,n,r,o,i);l.emplaceBack(c[0],c[1],c[2])}}for(let p=0;p<4;p++)for(let t=0;t<4;t++){const e=c(p,t),n=c(p,t+1),r=c(p+1,t),o=c(p+1,t+1);a.emplaceBack(e,n,r),a.emplaceBack(r,n,o)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(a),this._tileDebugTextBuffer=t.createVertexBuffer(s,Fl.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(l,Nl.members),this._tileDebugTextSegments=ja.simpleSegment(0,0,u,32)}}class Jf{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,n){const r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},D(this.stateChanges[t][r],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==r&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][r]){this.deletedStates[t][r]={};for(const e in this.state[t][r])n[e]||(this.deletedStates[t][r][e]=null)}else for(const o in n)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][o]&&delete this.deletedStates[t][r][o]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}getState(t,e){const n=String(e),r=D({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const n=this.deletedStates[t][e];if(null===n)return{};for(const t in n)delete r[t]}return r}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const n={};for(const r in this.stateChanges){this.state[r]=this.state[r]||{};const t={};for(const e in this.stateChanges[r])this.state[r][e]||(this.state[r][e]={}),D(this.state[r][e],this.stateChanges[r][e]),t[e]=this.state[r][e];n[r]=t}for(const r in this.deletedStates){this.state[r]=this.state[r]||{};const t={};if(null===this.deletedStates[r])for(const e in this.state[r])t[e]={},this.state[r][e]={};else for(const e in this.deletedStates[r]){if(null===this.deletedStates[r][e])this.state[r][e]={};else if(this.state[r][e])for(const t of Object.keys(this.deletedStates[r][e]))delete this.state[r][e][t];t[e]=this.state[r][e]}n[r]=n[r]||{},D(n[r],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const r in t)t[r].setFeatureState(n,e)}}class $f{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const n=this.toIdx(t,e);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function tg(t,e,n,r){let o=0,i=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(r[s])<1e-15){if(n[s]<t[s]||n[s]>e[s])return null}else{const a=1/r[s];let l=(t[s]-n[s])*a,u=(e[s]-n[s])*a;if(l>u){const t=l;l=u,u=t}if(l>o&&(o=l),u<i&&(i=u),o>i)return null}return o}function eg(t,e,n,r,o,i,s,a,l,u,c){const p=r-t,h=o-e,d=i-n,f=s-t,g=a-e,m=l-n,y=c[1]*m-c[2]*g,v=c[2]*f-c[0]*m,_=c[0]*g-c[1]*f,w=p*y+h*v+d*_;if(Math.abs(w)<1e-15)return null;const C=1/w,b=u[0]-t,x=u[1]-e,E=u[2]-n,S=(b*y+x*v+E*_)*C;if(S<0||S>1)return null;const T=x*d-E*h,R=E*p-b*d,P=b*h-x*p,O=(c[0]*T+c[1]*R+c[2]*P)*C;return O<0||S+O>1?null:(f*T+g*R+m*P)*C}function ng(t,e,n){return(t-e)/(n-e)}function rg(t,e,n,r,o,i,s,a,l){const u=1<<n,c=i-r,p=s-o,h=(t+1)/u*c+r,d=(e+0)/u*p+o,f=(e+1)/u*p+o;a[0]=(t+0)/u*c+r,a[1]=d,l[0]=h,l[1]=f}class og{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),n=[];let r=Math.ceil(Math.pow(2,e));const o=1/r,i=(t,e,n,r,o)=>{const i=r?1:0,s=(t+1)*n-i,a=e*n,l=(e+1)*n-i;o[0]=t*n,o[1]=a,o[2]=s,o[3]=l};let s=new $f(r);const a=[];for(let l=0;l<r*r;l++){i(l%r,Math.floor(l/r),o,!1,a);const e=sg(a[0],a[1],t),n=sg(a[2],a[1],t),u=sg(a[2],a[3],t),c=sg(a[0],a[3],t);s.minimums.push(Math.min(e,n,u,c)),s.maximums.push(Math.max(e,n,u,c)),s.leaves.push(1)}for(n.push(s),r/=2;r>=1;r/=2){const t=n[n.length-1];s=new $f(r);for(let e=0;e<r*r;e++){i(e%r,Math.floor(e/r),2,!0,a);const n=t.getElevation(a[0],a[1]),o=t.getElevation(a[2],a[1]),l=t.getElevation(a[2],a[3]),u=t.getElevation(a[0],a[3]),c=t.isLeaf(a[0],a[1]),p=t.isLeaf(a[2],a[1]),h=t.isLeaf(a[2],a[3]),d=t.isLeaf(a[0],a[3]),f=Math.min(n.min,o.min,l.min,u.min),g=Math.max(n.max,o.max,l.max,u.max),m=c&&p&&h&&d;s.maximums.push(g),s.minimums.push(f),s.leaves.push(g-f<=5&&m?1:0)}n.push(s)}return n}(this.dem),n=e.length-1,r=e[n];this._addNode(r.minimums[0],r.maximums[0],r.leaves[0]),this._construct(e,0,0,n,0)}raycastRoot(t,e,n,r,o,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return tg([t,e,-100],[n,r,this.maximums[0]*s],o,i)}raycast(t,e,n,r,o,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;const a=this.raycastRoot(t,e,n,r,o,i,s);if(null==a)return null;const l=[],u=[],c=[],p=[],h=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;h.length>0;){const{idx:a,t:d,nodex:f,nodey:g,depth:m}=h.pop();if(this.leaves[a]){rg(f,g,m,t,e,n,r,c,p);const a=1<<m,l=(f+0)/a,u=(f+1)/a,h=(g+0)/a,y=(g+1)/a,v=sg(l,h,this.dem)*s,_=sg(u,h,this.dem)*s,w=sg(u,y,this.dem)*s,C=sg(l,y,this.dem)*s,b=eg(c[0],c[1],v,p[0],c[1],_,p[0],p[1],w,o,i),x=eg(p[0],p[1],w,c[0],p[1],C,c[0],c[1],v,o,i),E=Math.min(null!==b?b:Number.MAX_VALUE,null!==x?x:Number.MAX_VALUE);if(E!==Number.MAX_VALUE)return E;{const t=gl([],o,i,d);if(ig(v,_,C,w,ng(t[0],c[0],p[0]),ng(t[1],c[1],p[1]))>=t[2])return d}continue}let y=0;for(let h=0;h<this._siblingOffset.length;h++){rg((f<<1)+this._siblingOffset[h][0],(g<<1)+this._siblingOffset[h][1],m+1,t,e,n,r,c,p),c[2]=-100,p[2]=this.maximums[this.childOffsets[a]+h]*s;const d=tg(c,p,o,i);if(null!=d){const t=d;l[h]=t;let e=!1;for(let n=0;n<y&&!e;n++)t>=l[u[n]]&&(u.splice(n,0,h),e=!0);e||(u[y]=h),y++}}for(let t=0;t<y;t++){const e=u[t];h.push({idx:this.childOffsets[a]+e,t:l[e],nodex:(f<<1)+this._siblingOffset[e][0],nodey:(g<<1)+this._siblingOffset[e][1],depth:m+1})}}return null}_addNode(t,e,n){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,n,r,o){if(1===t[r].isLeaf(e,n))return;this.childOffsets[o]||(this.childOffsets[o]=this.nodeCount);const i=r-1,s=t[i];let a=0,l=0;for(let u=0;u<this._siblingOffset.length;u++){const t=2*e+this._siblingOffset[u][0],r=2*n+this._siblingOffset[u][1],o=s.getElevation(t,r),i=s.isLeaf(t,r),c=this._addNode(o.min,o.max,i);i&&(a|=1<<u),l||(l=c)}for(let u=0;u<this._siblingOffset.length;u++)a&1<<u||this._construct(t,2*e+this._siblingOffset[u][0],2*n+this._siblingOffset[u][1],i,l+u)}}function ig(t,e,n,r,o,i){return An(An(t,n,i),An(e,r,i),o)}function sg(t,e,n){const r=n.dim,o=R(t*r-.5,0,r-1),i=R(e*r-.5,0,r-1),s=Math.floor(o),a=Math.floor(i),l=Math.min(s+1,r-1),u=Math.min(a+1,r-1);return ig(n.get(s,a),n.get(l,a),n.get(s,u),n.get(l,u),o-s,i-a)}const ag={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function lg(t,e,n){return(256*t*256+256*e+n)/10-1e4}function ug(t,e,n){return 256*t+e+n/256-32768}class cg{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return U('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=e.height;const i=this.dim=e.height-2,s=new Uint32Array(e.data.buffer);if(this.pixels=new Uint8Array(e.data.buffer),this.encoding=n||"mapbox",this.borderReady=r,!r){for(let t=0;t<i;t++)s[this._idx(-1,t)]=s[this._idx(0,t)],s[this._idx(i,t)]=s[this._idx(i-1,t)],s[this._idx(t,-1)]=s[this._idx(t,0)],s[this._idx(t,i)]=s[this._idx(t,i-1)];s[this._idx(-1,-1)]=s[this._idx(0,0)],s[this._idx(i,-1)]=s[this._idx(i-1,0)],s[this._idx(-1,i)]=s[this._idx(0,i-1)],s[this._idx(i,i)]=s[this._idx(i-1,i-1)],o&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new og(this)}get(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(t=R(t,-1,this.dim),e=R(e,-1,this.dim));const n=4*this._idx(t,e);return("terrarium"===this.encoding?ug:lg)(this.pixels[n],this.pixels[n+1],this.pixels[n+2])}static getUnpackVector(t){return ag[t]}get unpackVector(){return ag[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}static pack(t,e){const n=[0,0,0,0],r=cg.getUnpackVector(e);let o=Math.floor((t+r[3])/r[2]);return n[2]=o%256,o=Math.floor(o/256),n[1]=o%256,o=Math.floor(o/256),n[0]=o,n}getPixels(){return new mc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let r=e*this.dim,o=e*this.dim+this.dim,i=n*this.dim,s=n*this.dim+this.dim;switch(e){case-1:r=o-1;break;case 1:o=r+1}switch(n){case-1:i=s-1;break;case 1:s=i+1}const a=-e*this.dim,l=-n*this.dim;for(let u=i;u<s;u++)for(let e=r;e<o;e++){const n=4*this._idx(e,u),r=4*this._idx(e+a,u+l);this.pixels[n+0]=t.pixels[r+0],this.pixels[n+1]=t.pixels[r+1],this.pixels[n+2]=t.pixels[r+2],this.pixels[n+3]=t.pixels[r+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Vo(cg,"DEMData"),Vo(og,"DemMinMaxQuadTree",{omit:["dem"]});class pg{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout(()=>{this.remove(t,o)},n)),this.data[r].push(o),this.order.push(r),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),o=this.data[n][r];return this.data[n].splice(r,1),o.timeout&&clearTimeout(o.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(o.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const r of this.data[n])t(r.value)||e.push(r);for(const n of e)this.remove(n.value.tileID,n)}}class hg{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}hg.ReadOnly=!1,hg.ReadWrite=!0,hg.disabled=new hg(519,hg.ReadOnly,[0,1]);class dg{constructor(t,e,n,r,o,i){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=o,this.pass=i}}dg.disabled=new dg({func:519,mask:0},0,0,7680,7680,7680);class fg{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}fg.Replace=[1,0],fg.disabled=new fg(fg.Replace,Ae.transparent,[!1,!1,!1,!1]),fg.unblended=new fg(fg.Replace,Ae.transparent,[!0,!0,!0,!0]),fg.alphaBlended=new fg([1,771],Ae.transparent,[!0,!0,!0,!0]);class gg{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}gg.disabled=new gg(!1,1029,2305),gg.backCCW=new gg(!0,1029,2305),gg.backCW=new gg(!0,1029,2304),gg.frontCW=new gg(!0,1028,2304),gg.frontCCW=new gg(!0,1028,2305);class mg extends $t{constructor(t,e,n){super(),this.id=t,this._onlySymbols=n,e.on("data",t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),e.on("error",()=>{this._sourceErrored=!0}),this._source=e,this._tiles={},this._cache=new pg(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Jf,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(t){this.map=t,this._minTileCacheSize=void 0===this._minTileCacheSize&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return A(this._tiles).map(t=>t.tileID).sort(yg).map(t=>t.key)}getRenderableIds(t){const e=[];for(const n in this._tiles)this._isIdRenderable(+n,t)&&e.push(this._tiles[n]);return t?e.sort((t,e)=>{const n=t.tileID,r=e.tileID,o=new v(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),i=new v(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-r.overscaledZ||i.y-o.y||i.x-o.x}).map(t=>t.tileID.key):e.map(t=>t.tileID).sort(yg).map(t=>t.key)}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(t,e,n,r){if(r)if(t.state="errored",404!==r.status)this._source.fire(new Jt(r,{tile:t}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const t=this.map.painter.terrain;this.update(this.transform,t.getScaledDemTileSize(),!0),t.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Kt.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Qt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let r=0;r<e.length;r++){const o=e[r];if(t.neighboringTiles&&t.neighboringTiles[o]){const e=this.getTileByID(o);n(t,e),n(e,t)}}function n(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const r=e.tileID.canonical.y-t.tileID.canonical.y,o=Math.pow(2,t.tileID.canonical.z),i=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+o)?n+=o:1===Math.abs(n-o)&&(n-=o)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[i]&&(t.neighboringTiles[i].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,r){for(const o in this._tiles){let i=this._tiles[o];if(r[o]||!i.hasData()||i.tileID.overscaledZ<=e||i.tileID.overscaledZ>n)continue;let s=i.tileID;for(;i&&i.tileID.overscaledZ>e+1;){const t=i.tileID.scaledTo(i.tileID.overscaledZ-1);i=this._tiles[t.key],i&&i.hasData()&&(s=t)}let a=s;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){r[s.key]=s;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),r=this._getLoadedTile(e);if(r)return r}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const n=Math.ceil(t.width/e)+1,r=Math.ceil(t.height/e)+1,o=Math.floor(n*r*5),i="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,o):o,s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(s)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const r=this._tiles[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),t[r.tileID.key]=r}this._tiles=t;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(+e,this._tiles[e])}}update(t,e,n){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let r;this.updateCacheSize(t,e),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(t=>new Up(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)):(r=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(r=r.filter(t=>this._source.hasTile(t)))):r=[];const o=this._updateRetainedTiles(r);if(vg(this._source.type)&&0!==r.length){const t={},e={},n=Object.keys(o);for(const r of n){const n=o[r],i=this._tiles[r];if(!i||i.fadeEndTime&&i.fadeEndTime<=Kt.now())continue;const s=this.findLoadedParent(n,Math.max(n.overscaledZ-mg.maxOverzooming,this._source.minzoom));s&&(this._addTile(s.tileID),t[s.tileID.key]=s.tileID),e[r]=n}const i=r[r.length-1].overscaledZ;for(const r in this._tiles){const t=this._tiles[r];if(o[r]||!t.hasData())continue;let n=t.tileID;for(;n.overscaledZ>i;){n=n.scaledTo(n.overscaledZ-1);const i=this._tiles[n.key];if(i&&i.hasData()&&e[n.key]){o[r]=t.tileID;break}}}for(const r in t)o[r]||(this._coveredTiles[r]=!0,o[r]=t[r])}for(const s in o)this._tiles[s].clearFadeHold();const i=function(t,e){const n=[];for(const r in t)r in e||n.push(r);return n}(this._tiles,o);for(const s of i){const t=this._tiles[s];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(+s)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const n={},r=t.reduce((t,e)=>Math.min(t,e.overscaledZ),1/0),o=t[0].overscaledZ,i=Math.max(o-mg.maxOverzooming,this._source.minzoom),s=Math.max(o+mg.maxUnderzooming,this._source.minzoom),a={};for(const l of t){const t=this._addTile(l);e[l.key]=l,t.hasData()||r<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,r,s,e);for(const l of t){let t=this._tiles[l.key];if(t.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const t=l.children(this._source.maxzoom)[0],n=this.getTile(t);if(n&&n.hasData()){e[t.key]=t;continue}}else{const t=l.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let r=t.wasRequested();for(let o=l.overscaledZ-1;o>=i;--o){const i=l.scaledTo(o);if(n[i.key])break;if(n[i.key]=!0,t=this.getTile(i),!t&&r&&(t=this._addTile(i)),t&&(e[i.key]=i,r=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,r=this._tiles[t].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}e.push(r.key);const t=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;r=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const n=Boolean(e);if(!n){const n=this.map?this.map.painter:null;e=new Qf(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,n,this._isRaster),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))}return e?(e.uses++,this._tiles[t.key]=e,n||this._source.fire(new Qt("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,e,n){const r=[],o=this.transform;if(!o)return r;const i="globe"===o.projection.name,s=Cu(o.center.lng);for(const a in this._tiles){const l=this._tiles[a];if(n&&l.clearQueryDebugViz(),l.holdingForFade())continue;let u;if(i){const t=l.tileID.canonical;if(0===t.z){const e=[Math.abs(R(s,..._g(t,-1))-s),Math.abs(R(s,..._g(t,1))-s)];u=[0,2*e.indexOf(Math.min(...e))-1]}else{const e=[Math.abs(R(s,..._g(t,-1))-s),Math.abs(R(s,..._g(t,0))-s),Math.abs(R(s,..._g(t,1))-s)];u=[e.indexOf(Math.min(...e))-1]}}else u=[0];for(const n of u){const i=t.containsTile(l,o,e,n);i&&r.push(i)}}return r}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map(t=>this._tiles[t].tileID);for(const n of e)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(vg(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=Kt.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const r=this._tiles[t];r&&r.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(+n,"reloading");this._cache.filter(n=>!n.hasDependency(t,e))}_preloadTiles(t,e){if(!this._sourceLoaded){const n=()=>{this._sourceLoaded&&(this._source.off("data",n),this._preloadTiles(t,e))};return void this._source.on("data",n)}const n=new Map,r=Array.isArray(t)?t:[t],o=this.map.painter.terrain,i=this.usedForTerrain&&o?o.getScaledDemTileSize():this._source.tileSize;for(const s of r){const t=s.coveringTiles({tileSize:i,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const e of t)n.set(e.key,e);this.usedForTerrain&&s.updateElevation(!1)}I(Array.from(n.values()),(t,e)=>{const n=new Qf(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(n,t=>{"raster-dem"===this._source.type&&n.dem&&this._backfillDEM(n),e(t,n)})},e)}}function yg(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function vg(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function _g(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}mg.maxOverzooming=10,mg.maxUnderzooming=3;class wg{constructor(t,e,n){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=n}static create(t,e,n){const r=n||t.findDEMTileFor(e);if(!r||!r.dem)return;const o=r.dem,i=r.tileID,s=1<<e.canonical.z-i.canonical.z;return new wg(r,r.tileSize/Ha/s,[(e.canonical.x/s-i.canonical.x)*o.dim,(e.canonical.y/s-i.canonical.y)*o.dim])}tileCoordToPixel(t,e){const n=e*this._scale+this._offset[1],r=Math.floor(t*this._scale+this._offset[0]),o=Math.floor(n);return new v(r,o)}getElevationAt(t,e,n,r){const o=t*this._scale+this._offset[0],i=e*this._scale+this._offset[1],s=Math.floor(o),a=Math.floor(i),l=this._dem;return r=!!r,n?An(An(l.get(s,a,r),l.get(s,a+1,r),i-a),An(l.get(s+1,a,r),l.get(s+1,a+1,r),i-a),o-s):l.get(s,a,r)}getElevationAtPixel(t,e,n){return this._dem.get(t,e,!!n)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*xu(1,t)*this._dem.stride}}class Cg{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Go(Ha,16,0),this.featureIndexArray=new oa,this.promoteId=e}insert(t,e,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,o,i);const a=this.grid;for(let l=0;l<e.length;l++){const t=e[l],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<t.length;e++){const r=t[e];n[0]=Math.min(n[0],r.x),n[1]=Math.min(n[1],r.y),n[2]=Math.max(n[2],r.x),n[3]=Math.max(n[3],r.y)}n[0]<Ha&&n[1]<Ha&&n[2]>=0&&n[3]>=0&&a.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new bp(new Wh(this.rawTileData)).layers,this.sourceLayerCoder=new zf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,e,n,r){var o=this;this.loadVTLayers();const i=t.params||{},s=ro(i.filter),a=t.tileResult,l=t.transform,u=a.bufferedTilespaceBounds,c=this.grid.query(u.min.x,u.min.y,u.max.x,u.max.y,(t,e,n,r)=>Ju(a.bufferedTilespaceGeometry,t,e,n,r));c.sort(xg);let p=null;l.elevation&&c.length>0&&(p=wg.create(l.elevation,this.tileID));const h={};let d;for(let f=0;f<c.length;f++){const l=c[f];if(l===d)continue;d=l;const u=this.featureIndexArray.get(l);let g=null;this.loadMatchingFeature(h,u,s,i.layers,i.availableImages,e,n,r,(function(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return g||(g=ku(e,o.tileID.canonical,t.tileTransform)),n.queryIntersectsFeature(a,e,r,g,o.z,t.transform,t.pixelPosMatrix,p,i)}))}return h}loadMatchingFeature(t,e,n,r,o,i,s,a,l){const{featureIndex:u,bucketIndex:c,sourceLayerIndex:p,layoutVertexArrayOffset:h}=e,d=this.bucketLayerIDs[c];if(r&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(r,d))return;const f=this.sourceLayerCoder.decode(p),g=this.vtLayers[f].feature(u);if(n.needGeometry){const t=Gu(g,!0);if(!n.filter(new is(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new is(this.tileID.overscaledZ),g))return;const m=this.getId(g,f);for(let y=0;y<d.length;y++){const e=d[y];if(r&&r.indexOf(e)<0)continue;const n=i[e];if(!n)continue;let c={};void 0!==m&&a&&(c=a.getState(n.sourceLayer||"_geojsonTileLayer",m));const p=D({},s[e]);p.paint=bg(p.paint,n.paint,g,c,o),p.layout=bg(p.layout,n.layout,g,c,o);const f=!l||l(g,n,c,h);if(!f)continue;const v=new Hf(g,this.z,this.x,this.y,m);v.layer=p;let _=t[e];void 0===_&&(_=t[e]=[]),_.push({featureIndex:u,feature:v,intersectionZ:f})}}lookupSymbolFeatures(t,e,n,r,o,i,s,a){const l={};this.loadVTLayers();const u=ro(o);for(const c of t)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:r,featureIndex:c,layoutVertexArrayOffset:0},u,i,s,a,e);return l}loadFeature(t){const{featureIndex:e,sourceLayerIndex:n}=t;this.loadVTLayers();const r=this.sourceLayerCoder.decode(n),o=this.vtFeatures[r];if(o[e])return o[e];const i=this.vtLayers[r].feature(e);return o[e]=i,i}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;if(this.promoteId){const r="string"==typeof this.promoteId?this.promoteId:this.promoteId[e];null!=r&&(n=t.properties[r]),"boolean"==typeof n&&(n=Number(n))}return n}}function bg(t,e,n,r,o){return V(t,(t,i)=>{const s=e instanceof ds?e.get(i):null;return s&&s.evaluate?s.evaluate(n,r,o):s})}function xg(t,e){return e-t}Vo(Cg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Eg{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new gc({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const n=this.getKey(t,e);return this.positions[n]}trim(){const t=this.width,e=this.height=F(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,n){const r=[];let o=t.length%2==1?-t[t.length-1]*n:0,i=t[0]*n,s=!0;r.push({left:o,right:i,isDash:s,zeroLength:0===t[0]});let a=t[0];for(let l=1;l<t.length;l++){s=!s;const e=t[l];o=a*n,a+=e,i=a*n,r.push({left:o,right:i,isDash:s,zeroLength:0===e})}return r}addRoundDash(t,e,n){const r=e/2;for(let o=-n;o<=n;o++){const e=this.width*(this.nextRow+n+o);let i=0,s=t[i];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++i]);const l=Math.abs(a-s.left),u=Math.abs(a-s.right),c=Math.min(l,u);let p;const h=o/n*(r+1);if(s.isDash){const t=r-Math.abs(h);p=Math.sqrt(c*c+t*t)}else p=r-Math.sqrt(c*c+h*h);this.image.data[e+a]=Math.max(0,Math.min(255,p+128))}}}addRegularDash(t,e){for(let a=t.length-1;a>=0;--a){const e=t[a],n=t[a+1];e.zeroLength?t.splice(a,1):n&&n.isDash===e.isDash&&(n.left=e.left,t.splice(a,1))}const n=t[0],r=t[t.length-1];n.isDash===r.isDash&&(n.left=r.left-this.width,r.right=n.right+this.width);const o=this.width*this.nextRow;let i=0,s=t[i];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++i]);const n=Math.abs(a-s.left),r=Math.abs(a-s.right),l=Math.min(n,r);this.image.data[o+a]=Math.max(0,Math.min(255,(s.isDash?l:-l)+e+128))}}addDash(t,e){const n=this.getKey(t,e);if(this.positions[n])return this.positions[n];const r="round"===e,o=r?7:0,i=2*o+1;if(this.nextRow+i>this.height)return U("LineAtlas out of space"),null;0===t.length&&t.push(1);let s=0;for(let u=0;u<t.length;u++)t[u]<0&&(U("Negative value is found in line dasharray, replacing values with 0"),t[u]=0),s+=t[u];if(0!==s){const n=this.width/s,i=this.getDashRanges(t,this.width,n);r?this.addRoundDash(i,n,o):this.addRegularDash(i,"square"===e?.5*n:0)}const a=this.nextRow+o;this.nextRow+=i;const l={tl:[a,o],br:[s,0]};return this.positions[n]=l,l}}Vo(Eg,"LineAtlas");class Sg{constructor(t){const e={},n=[];for(const s in t){const r=t[s],o=e[s]={};for(const t in r.glyphs){const e=r.glyphs[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const i=e.metrics.localGlyph?2:1,s={x:0,y:0,w:e.bitmap.width+2*i,h:e.bitmap.height+2*i};n.push(s),o[t]=s}}const{w:r,h:o}=Yh(n),i=new gc({width:r||1,height:o||1});for(const s in t){const n=t[s];for(const t in n.glyphs){const r=n.glyphs[+t];if(!r||0===r.bitmap.width||0===r.bitmap.height)continue;const o=e[s][t],a=r.metrics.localGlyph?2:1;gc.copy(r.bitmap,i,{x:0,y:0},{x:o.x+a,y:o.y+a},r.bitmap)}}this.image=i,this.positions=e}}Vo(Sg,"GlyphAtlas");class Tg{constructor(t){this.tileID=new Up(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Zd(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,e,n,r,o){this.status="parsing",this.data=t,this.collisionBoxArray=new Zs;const i=new zf(Object.keys(t.layers).sort()),s=new Cg(this.tileID,this.promoteId);s.bucketLayerIDs=[];const a={},l=new Eg(256,256),u={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:n},c=e.familiesBySource[this.source];for(const w in c){const e=t.layers[w];if(!e)continue;let r=!1,o=!1;for(const t of c[w])"symbol"===t[0].type?r=!0:o=!0;if(!0===this.isSymbolTile&&!r)continue;if(!1===this.isSymbolTile&&!o)continue;1===e.version&&U('Vector tile source "'.concat(this.source,'" layer "').concat(w,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));const l=i.encode(w),p=[];for(let t=0;t<e.length;t++){const n=e.feature(t),r=s.getId(n,w);p.push({feature:n,id:r,index:t,sourceLayerIndex:l})}for(const t of c[w]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(Rg(t,this.zoom,n),(a[e.id]=e.createBucket({index:s.bucketLayerIDs.length,layers:t,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:n})).populate(p,u,this.tileID.canonical,this.tileTransform),s.bucketLayerIDs.push(t.map(t=>t.id)))}}let p,h,d,f;l.trim();const g={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},m=()=>{if(p)return o(p);if(h&&d&&f){const t=new Sg(h),e=new Qh(d,f);for(const r in a){const o=a[r];o instanceof Rf?(Rg(o.layers,this.zoom,n),Bd(o,h,t.positions,d,e.iconPositions,this.showCollisionBoxes,n,this.tileID.canonical,this.tileZoom,this.projection)):o.hasPattern&&(o instanceof nh||o instanceof rp||o instanceof Ip)&&(Rg(o.layers,this.zoom,n),o.addFeatures(u,this.tileID.canonical,e.patternPositions,n,this.tileTransform))}this.status="done",o(null,{buckets:A(a).filter(t=>!t.isEmpty()),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:l,imageAtlas:e,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?t.positions:null})}},y=V(u.glyphDependencies,t=>Object.keys(t).map(Number));Object.keys(y).length?r.send("getGlyphs",{uid:this.uid,stacks:y},(t,e)=>{p||(p=t,h=e,m())},void 0,!1,g):h={};const v=Object.keys(u.iconDependencies);v.length?r.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"icons"},(t,e)=>{p||(p=t,d=e,m())},void 0,!1,g):d={};const _=Object.keys(u.patternDependencies);_.length?r.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"patterns"},(t,e)=>{p||(p=t,f=e,m())},void 0,!1,g):f={},m()}}function Rg(t,e,n){const r=new is(e);for(const o of t)o.recalculate(r,n)}class Pg{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,r){const o=this.entries[t]=this.entries[t]||{callbacks:[]};if(o.result){const[t,n]=o.result;return this.scheduler?this.scheduler.add(()=>{r(t,n)},e):r(t,n),()=>{}}return o.callbacks.push(r),o.cancel||(o.cancel=n((n,r)=>{o.result=[n,r];for(const t of o.callbacks)this.scheduler?this.scheduler.add(()=>{t(n,r)},e):t(n,r);setTimeout(()=>delete this.entries[t],3e3)})),()=>{o.result||(o.callbacks=o.callbacks.filter(t=>t!==r),o.callbacks.length||(o.cancel(),delete this.entries[t]))}}}function Og(t,e,n){const r=JSON.stringify(t.request);return t.data&&(this.deduped.entries[r]={result:[null,t.data]}),this.deduped.request(r,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},e=>{const r=ht(t.request,(t,r,o,i)=>{t?e(t):r&&e(null,{vectorTile:n?void 0:new bp(new Wh(r)),rawData:r,cacheControl:o,expires:i})});return()=>{r.cancel(),e()}},e)}const Ig=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ag{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const r=n>>4;if(1!==r)throw new Error("Got v".concat(r," data when expected v1."));const o=Ig[15&n];if(!o)throw new Error("Unrecognized array type.");const[i]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new Ag(s,i,o,t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=arguments.length>3?arguments[3]:void 0;if(isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const o=Ig.indexOf(this.ArrayType),i=2*t*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(n,"."));r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+a,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+i+s+a),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+a,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+o]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error("Added ".concat(t," items when expected ").concat(this.numItems,"."));return function t(e,n,r,o,i,s){if(i-o<=r)return;const a=o+i>>1;(function t(e,n,r,o,i,s){for(;i>o;){if(i-o>600){const a=i-o+1,l=r-o+1,u=Math.log(a),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(e,n,r,Math.max(o,Math.floor(r-l*c/a+p)),Math.min(i,Math.floor(r+(a-l)*c/a+p)),s)}const a=n[2*r+s];let l=o,u=i;for(Dg(e,n,o,r),n[2*i+s]>a&&Dg(e,n,o,i);l<u;){for(Dg(e,n,l,u),l++,u--;n[2*l+s]<a;)l++;for(;n[2*u+s]>a;)u--}n[2*o+s]===a?Dg(e,n,o,u):(u++,Dg(e,n,u,i)),u<=r&&(o=u+1),r<=u&&(i=u-1)}})(e,n,a,o,i,s),t(e,n,r,o,a-1,1-s),t(e,n,r,a+1,i,1-s)}(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:s}=this,a=[0,o.length-1,0],l=[];for(;a.length;){const u=a.pop()||0,c=a.pop()||0,p=a.pop()||0;if(c-p<=s){for(let s=p;s<=c;s++){const a=i[2*s],u=i[2*s+1];a>=t&&a<=n&&u>=e&&u<=r&&l.push(o[s])}continue}const h=p+c>>1,d=i[2*h],f=i[2*h+1];d>=t&&d<=n&&f>=e&&f<=r&&l.push(o[h]),(0===u?t<=d:e<=f)&&(a.push(p),a.push(h-1),a.push(1-u)),(0===u?n>=d:r>=f)&&(a.push(h+1),a.push(c),a.push(1-u))}return l}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:o,nodeSize:i}=this,s=[0,r.length-1,0],a=[],l=n*n;for(;s.length;){const u=s.pop()||0,c=s.pop()||0,p=s.pop()||0;if(c-p<=i){for(let n=p;n<=c;n++)Lg(o[2*n],o[2*n+1],t,e)<=l&&a.push(r[n]);continue}const h=p+c>>1,d=o[2*h],f=o[2*h+1];Lg(d,f,t,e)<=l&&a.push(r[h]),(0===u?t-n<=d:e-n<=f)&&(s.push(p),s.push(h-1),s.push(1-u)),(0===u?t+n>=d:e+n>=f)&&(s.push(h+1),s.push(c),s.push(1-u))}return a}}function Dg(t,e,n,r){Mg(t,n,r),Mg(e,2*n,2*r),Mg(e,2*n+1,2*r+1)}function Mg(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Lg(t,e,n,r){const o=t-n,i=e-r;return o*o+i*i}t.ARRAY_TYPE=qa,t.AUTH_ERR_MSG=vt,t.Aabb=Vl,t.Actor=class{constructor(t,n,r){this.target=t,this.parent=n,this.mapId=r,this.callbacks={},this.cancelCallbacks={},G(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=X()?t:e,this.scheduler=new Vf}send(t,e,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=i,this.callbacks[s]=n);const a=Z(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:t,hasCallback:!!n,targetMapId:r,mustQueue:o,sourceMapId:this.mapId,data:Ho(e,a)},a),{cancel:()=>{n&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t.cancel()}else if(e.mustQueue||X()){const t=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),t&&t.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(Uo(e.error)):n(null,Uo(e.data)))}else{const n=Z(this.globalScope)?void 0:[],r=e.hasCallback?(e,r)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?Ho(e):null,data:Ho(r,n)},n)}:t=>{},o=Uo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,o,r);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],o.source)[t[1]](o,r)}else r(new Error("Could not find function ".concat(e.type)))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=jp,t.Color=Ae,t.ColorMode=fg,t.CullFaceMode=gg,t.DEMData=cg,t.DataConstantProperty=fs,t.DedupedRequest=Pg,t.DepthMode=hg,t.EXTENT=Ha,t.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,r=1<<n,o=Math.floor(t.x),i=Math.floor((t.x-o)*r),s=Math.floor(t.y*r),a=this.findDEMTileFor(new Up(n,o,n,i,s));return!(!a||!a.dem)}getAtPointOrZero(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(t,e)||0}getAtPoint(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isUsingMockSource())return null;null==e&&(e=null);const r=this._source();if(!r)return e;if(t.y<0||t.y>1)return e;const o=r.getSource().maxzoom,i=1<<o,s=Math.floor(t.x),a=t.x-s,l=new Up(o,s,o,Math.floor(a*i),Math.floor(t.y*i)),u=this.findDEMTileFor(l);if(!u||!u.dem)return e;const c=u.dem,p=1<<u.tileID.canonical.z,h=(a*p-u.tileID.canonical.x)*c.dim,d=(t.y*p-u.tileID.canonical.y)*c.dim,f=Math.floor(h),g=Math.floor(d);return(n?this.exaggeration():1)*An(An(c.get(f,g),c.get(f,g+1),d-g),An(c.get(f+1,g),c.get(f+1,g+1),d-g),h-f)}getAtTileOffset(t,e,n){const r=1<<t.canonical.z;return this.getAtPointOrZero(new Ou(t.wrap+(t.canonical.x+e/Ha)/r,(t.canonical.y+n/Ha)/r))}getAtTileOffsetFunc(t,e,n,r){return o=>{const i=this.getAtTileOffset(t,o.x,o.y),s=r.upVector(t.canonical,o.x,o.y);return fl(s,s,i*r.upVectorScale(t.canonical,e,n).metersToTile),s}}getForTilePoints(t,e,n,r){if(this.isUsingMockSource())return!1;const o=wg.create(this,t,r);return!!o&&(e.forEach(t=>{t[2]=this.exaggeration()*o.getElevationAt(t[0],t[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,r=e.tileID,o=1<<t.canonical.z-r.canonical.z;let i=t.canonical.x/o-r.canonical.x,s=t.canonical.y/o-r.canonical.y,a=0;for(let l=0;l<t.canonical.z-r.canonical.z&&!n.leaves[a];l++){i*=2,s*=2;const t=2*Math.floor(s)+Math.floor(i);a=n.childOffsets[a]+t,i%=1,s%=1}return{min:this.exaggeration()*n.minimums[a],max:this.exaggeration()*n.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Jt,t.EvaluationParameters=is,t.Event=Qt,t.Evented=$t,t.FillExtrusionBucket=Ip,t.Frustum=Bl,t.FrustumCorners=Gl,t.GLOBE_RADIUS=zl,t.GLOBE_SCALE_MATCH_LATITUDE=45,t.GLOBE_ZOOM_THRESHOLD_MAX=6,t.GLOBE_ZOOM_THRESHOLD_MIN=5,t.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_fillGridMeshWithLods(t,e){const n=new Es,r=new Vs,o=[],i=t+1+2,s=e[0]+1,a=e[0]+1+(1+e.length),l=(t,e,n)=>{let r=t===i-1?t-2:0===t?t:t-1;return r+=n?24575:0,[r,e]};for(let u=0;u<i;++u)n.emplaceBack(...l(u,0,!0));for(let u=0;u<s;++u)for(let t=0;t<i;++t)n.emplaceBack(...l(t,u,(0===t||t===i-1)&&!0));for(let u=0;u<e.length;++u){const t=e[u];for(let e=0;e<i;++e)n.emplaceBack(...l(e,t,!0))}for(let u=0;u<e.length;++u){const t=r.length,s=e[u]+1+2,l=new Vs;for(let n=0;n<s-1;n++){const t=n===s-2,o=t?i*(a-e.length+u-n):i;for(let e=0;e<i-1;e++){const s=n*i+e;0===n||t||0===e||e===i-2?(l.emplaceBack(s+1,s,s+o),l.emplaceBack(s+o,s+o+1,s+1)):(r.emplaceBack(s+1,s,s+o),r.emplaceBack(s+o,s+o+1,s+1))}}const c=ja.simpleSegment(0,t,n.length,r.length-t);for(let e=0;e<l.uint16.length;e+=3)r.emplaceBack(l.uint16[e],l.uint16[e+1],l.uint16[e+2]);const p=ja.simpleSegment(0,t,n.length,r.length-t);o.push({withoutSkirts:c,withSkirts:p})}return{vertices:n,indices:r,segments:o}}_createGrid(t){const e=this._fillGridMeshWithLods(64,jl);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Fl.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new Vs;for(let o=0;o<=64;o++)e.emplaceBack(0,o+1,o+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new Us,r=new Us;this._poleSegments=[];for(let o=0,i=0;o<5;o++){const t=360/(1<<o);n.emplaceBack(0,-zl,0,.5,0),r.emplaceBack(0,-zl,0,.5,1);for(let e=0;e<=64;e++){const o=e/64,i=An(0,t,o),[s,a,l]=nu(fu,gu,i,zl);n.emplaceBack(s,a,l,o,0),r.emplaceBack(s,a,l,o,1)}this._poleSegments.push(ja.simpleSegment(i,0,66,64)),i+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,Ll,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(r,Ll,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const e=new qs,n=64,r=n+1+2,o=1;this._wireframeSegments=[];for(let t=0,i=0;t<jl.length;t++){const s=jl[t];for(let t=o;t<s+o;t++)for(let i=o;i<n+o;i++){const n=t*r+i;e.emplaceBack(n,n+1),e.emplaceBack(n,n+r),e.emplaceBack(n,n+r+1)}const a=s*n*3;this._wireframeSegments.push(ja.simpleSegment(0,i,(s+1)*r,a)),i+=a}this._wireframeIndexBuffer=t.createIndexBuffer(e)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},t.GlyphManager=Ed,t.ImagePosition=Zh,t.KDBush=Ag,t.LivePerformanceUtils=Vt,t.LngLat=_u,t.LngLatBounds=Ua,t.LocalGlyphMode=xd,t.MAX_MERCATOR_LATITUDE=Ru,t.MercatorCoordinate=Ou,t.ONE_EM=24,t.OverscaledTileID=Up,t.PerformanceMarkers=Bt,t.Point=v,t.Properties=ys,t.RGBAImage=mc,t.Ray=kl,t.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",p,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!_t(t))return t;const n=St(t);return n.path="/styles/v1".concat(n.path),this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!_t(t))return t;const n=St(t);return n.path="/fonts/v1".concat(n.path),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,r){if(!_t(t))return t;const o=St(t);return o.path="/v4/".concat(o.authority,".json"),o.params.push("secure"),n&&o.params.push("language=".concat(n)),r&&o.params.push("worldview=".concat(r)),this._makeAPIURL(o,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,r){const o=St(t);return _t(t)?(o.path="/styles/v1".concat(o.path,"/sprite").concat(e).concat(n),this._makeAPIURL(o,this._customAccessToken||r)):(o.path+="".concat(e).concat(n),Tt(o))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!_t(t))return t;const r=St(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(e||n&&"raster"!==r.authority&&512===n?"@2x":"").concat(i.supported?".webp":"$1")),"raster"===r.authority?r.path="/".concat(o.RASTER_URL_PREFIX).concat(r.path):(r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/".concat(o.TILE_URL_VERSION).concat(r.path));const s=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(r.params)||o.ACCESS_TOKEN;return o.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&r.params.push("sku=".concat(this._skuToken)),this._makeAPIURL(r,s)}canonicalizeTileURL(t,e){const n=St(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let r="mapbox://";n.path.match(/^\/raster\/v1\//)?r+="raster/".concat(n.path.replace("/".concat(o.RASTER_URL_PREFIX,"/"),"")):r+="tiles/".concat(n.path.replace("/".concat(o.TILE_URL_VERSION,"/"),""));let i=n.params;return e&&(i=i.filter(t=>!t.match(/^access_token=/))),i.length&&(r+="?".concat(i.join("&"))),r}canonicalizeTileset(t,e){const n=!!e&&_t(e),r=[];for(const o of t.tiles||[])wt(o)?r.push(this.canonicalizeTileURL(o,n)):r.push(o);return r}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",r=St(o.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==r.path&&(t.path="".concat(r.path).concat(t.path)),!o.REQUIRE_ACCESS_TOKEN)return Tt(t);if(e=e||o.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error("An API access token is required to use Mapbox GL. ".concat(n));if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(n))}return t.params=t.params.filter(t=>-1===t.indexOf("access_token")),t.params.push("access_token=".concat(e||"")),Tt(t)}},t.ResourceType=lt,t.SegmentVector=ja,t.SourceCache=mg,t.StencilMode=dg,t.StructArrayLayout1ui2=Xs,t.StructArrayLayout2f1f2i16=ks,t.StructArrayLayout2i4=Es,t.StructArrayLayout2ui4=qs,t.StructArrayLayout3f12=Bs,t.StructArrayLayout3ui6=Vs,t.StructArrayLayout4i8=Ts,t.StructArrayLayout5f20=Us,t.Texture=Gf,t.Tile=Qf,t.Transitionable=ls,t.Uniform1f=_a,t.Uniform1i=class extends va{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},t.Uniform2f=class extends va{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},t.Uniform3f=class extends va{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},t.Uniform4f=wa,t.UniformColor=Ca,t.UniformMatrix2f=class extends va{constructor(t){super(t),this.current=Ea}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let r=0;r<4;r++)if(n[r]!==this.current[r]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},t.UniformMatrix3f=class extends va{constructor(t){super(t),this.current=xa}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let r=0;r<9;r++)if(n[r]!==this.current[r]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},t.UniformMatrix4f=class extends va{constructor(t){super(t),this.current=ba}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},t.UnwrappedTileID=Hp,t.ValidationError=Yr,t.VectorTileFeature=xp,t.VectorTileWorkerSource=class extends $t{constructor(t,e,n,r,o){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=o||Og,this.loading={},this.loaded={},this.deduped=new Pg(t.scheduler),this.isSpriteLoaded=r,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,r=t&&t.request,o=r&&r.collectResourceTiming,i=this.loading[n]=new Tg(t);i.abort=this.loadVectorData(t,(s,a)=>{const l=!this.loading[n];if(delete this.loading[n],l||s||!a)return i.status="done",l||(this.loaded[n]=i),e(s);const u=a.rawData,c={};a.expires&&(c.expires=a.expires),a.cacheControl&&(c.cacheControl=a.cacheControl),i.vectorTile=a.vectorTile||new bp(new Wh(u));const p=()=>{i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,(t,n)=>{if(t||!n)return e(t);const i={};if(o){const t=Ht(r);t.length>0&&(i.resourceTiming=JSON.parse(JSON.stringify(t)))}e(null,D({rawTileData:u.slice(0)},n,c,i))})};this.isSpriteLoaded?p():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(p,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):p()}),this.loaded=this.loaded||{},this.loaded[n]=i})}reloadTile(t,e){const n=this.loaded,r=t.uid,o=this;if(n&&n[r]){const i=n[r];i.showCollisionBoxes=t.showCollisionBoxes,i.enableTerrain=!!t.enableTerrain,i.projection=t.projection,i.tileTransform=Zd(t.tileID.canonical,t.projection);const s=(t,n)=>{const r=i.reloadCallback;r&&(delete i.reloadCallback,i.parse(i.vectorTile,o.layerIndex,this.availableImages,o.actor,r)),e(t,n)};"parsing"===i.status?i.reloadCallback=s:"done"===i.status&&(i.vectorTile?i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}abortTile(t,e){const n=t.uid,r=this.loading[n];r&&(r.abort&&r.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()}},t.WritingMode=Jh,t.ZoomDependentExpression=qr,t.add=ul,t.addDynamicAttributes=xf,t.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=s*c-a*u,t[1]=o*u-r*c,t[2]=r*a-o*s,t[3]=a*l-i*c,t[4]=n*c-o*l,t[5]=o*i-n*a,t[6]=i*u-s*l,t[7]=r*l-n*u,t[8]=n*s-r*i,t},t.asyncAll=I,t.bezier=S,t.bindAll=G,t.boundsAttributes=Yf,t.bufferConvexPolygon=function(t,e){const n=[];for(let r=0;r<t.length;r++){const o=O(r-1,-1,t.length-1),i=O(r+1,-1,t.length-1),s=t[r],a=t[i],l=t[o].sub(s).unit(),u=a.sub(s).unit(),c=u.angleWithSep(l.x,l.y),p=l.add(u).unit().mult(-1*e/Math.sin(c/2));n.push(s.add(p))}return n},t.cacheEntryPossiblyAdded=function(t){at++,at>rt&&(t.getActor().send("enforceCacheSizeLimit",nt),at=0)},t.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:r}=t.point,o=uu(n,r,t.worldSize/t._pixelsPerMercatorPixel,0,0);return Qa(o,o,lu(Zl(e)))},t.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:r,lat:o}=t._center;return uu(e,n,t.worldSize,r,o)},t.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/xu(1,t.center.lat),r=Ya(new Float64Array(16));return Ja(r,r,[t.point.x,t.point.y,0]),$a(r,r,[n,n,e]),Float32Array.from(r)},t.circumferenceAtLatitude=wu,t.clamp=R,t.clearTileCache=function(t){if(!ot())return;const n=e.caches.delete($);t&&n.catch(t).then(()=>t())},t.clipLine=_d,t.clone=function(t){var e=new qa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=j,t.collisionCircleLayout=dh,t.config=o,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.create=function(){var t=new qa(16);return qa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=Xa,t.createExpression=Ur,t.createLayout=bs,t.createStyleLayer=function(t){return"custom"===t.type?new Lf(t):new kf[t.type](t)},t.cross=vl,t.degToRad=C,t.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},t.dot=yl,t.earthRadius=mu,t.ease=T,t.easeCubicInOut=E,t.ecefToLatLng=function(t){let[e,n,r]=t;const o=Math.hypot(e,n,r),i=Math.atan2(e,r),s=.5*Math.PI-Math.acos(-n/o);return new _u(b(i),b(s))},t.emitValidationErrors=No,t.endsWith=B,t.enforceCacheSizeLimit=function(t){it(),tt&&tt.then(e=>{e.keys().then(n=>{for(let r=0;r<n.length-t;r++)e.delete(n[r])})})},t.evaluateSizeForFeature=mh,t.evaluateSizeForZoom=yh,t.evaluateVariableOffset=Gd,t.evented=es,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=Kt,t.exported$1=i,t.extend=D,t.extend$1=ee,t.fillExtrusionHeightLift=kp,t.filterObject=z,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],s=n+n,a=r+r,l=o+o,u=n*s,c=r*s,p=r*a,h=o*s,d=o*a,f=o*l,g=i*s,m=i*a,y=i*l;return t[0]=1-p-f,t[1]=c+y,t[2]=h-m,t[3]=0,t[4]=c-y,t[5]=1-u-f,t[6]=d+g,t[7]=0,t[8]=h+m,t[9]=d-g,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=nl,t.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return x[e]},t.getAABBPointSquareDist=function(t,e,n){let r=0;for(let o=0;o<2;++o){const i=n?n[o]:0;t[o]>i&&(r+=(t[o]-i)*(t[o]-i)),e[o]<i&&(r+=(i-e[o])*(i-e[o]))}return r},t.getAnchorAlignment=ld,t.getAnchorJustification=Vd,t.getBounds=function(t){let e=1/0,n=1/0,r=-1/0,o=-1/0;for(const i of t)e=Math.min(e,i.x),n=Math.min(n,i.y),r=Math.max(r,i.x),o=Math.max(o,i.y);return{min:new v(e,n),max:new v(r,o)}},t.getColumn=J,t.getDefaultExportFromCjs=h,t.getGridMatrix=function(t,e,n,r){const o=e.getNorth(),i=e.getSouth(),s=e.getWest(),a=e.getEast(),l=1<<t.z,u=a-s,c=o-i,p=u/64,h=-c/jl[n],d=[0,p,0,h,0,0,o,s,0];if(t.z>0){const t=180/r;Ka(d,d,[t/u+1,0,0,0,t/c+1,0,-.5*t/p,.5*t/h,1])}return d[2]=l,d[5]=t.x,d[8]=t.y,d},t.getImage=yt,t.getJSON=function(t,e){return pt(D(t,{type:"json"}),e)},t.getLatitudinalLod=function(t){const e=Ru-5;t=R(t,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(C(t))),3);return Math.round(n*(jl.length-1))},t.getMapSessionAPI=kt,t.getPerformanceMeasurement=Ht,t.getProjection=vf,t.getRTLTextPluginStatus=ns,t.getReferrer=ct,t.getTilePoint=function(t,e){let{x:n,y:r}=e,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new v(((n-o)*t.scale-t.x)*Ha,(r*t.scale-t.y)*Ha)},t.getTileVec3=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ll(((e.x-n)*t.scale-t.x)*Ha,(e.y*t.scale-t.y)*Ha,Tu(e.z,e.y))},t.getVideo=function(t,n){const r=e.document.createElement("video");r.muted=!0,r.onloadstart=function(){n(null,r)};for(let o=0;o<t.length;o++){const n=e.document.createElement("source");dt(t[o])||(r.crossOrigin="Anonymous"),n.src=t[o],r.appendChild(n)}return{cancel:()=>{}}},t.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=Ya(new Float64Array(16));return Qa(n,t.pixelMatrix,t.globeMatrix),_l(e,e,n),new v(e[0],e[1])},t.globeDenormalizeECEF=lu,t.globeECEFOrigin=function(t,e){const n=[0,0,0];return _l(n,n,au(Zl(e.canonical))),_l(n,n,t),n},t.globeMetersToEcef=ql,t.globeNormalizeECEF=au,t.globePixelsToTileUnits=function(t,e){return Ha/(512*Math.pow(2,t))*iu(Zl(e))},t.globePoleMatrixForTile=function(t,e,n){const r=Ya(new Float64Array(16)),o=(e/(1<<t)-.5)*Math.PI*2;return el(r,n.globeMatrix,o),Float32Array.from(r)},t.globeTileBounds=Zl,t.globeTiltAtLngLat=pu,t.globeToMercatorTransition=cu,t.globeUseCustomAntiAliasing=function(t,e,n){const r=cu(n.zoom),o=t.style.map._antialias,i=!!e.extStandardDerivatives,s=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===r&&!o&&!s&&i},t.identity=Ya,t.identity$1=Ol,t.invert=Za,t.isFullscreen=function(){return!!e.document.fullscreenElement||!!e.document.webkitFullscreenElement},t.isLngLatBehindGlobe=hu,t.isMapAuthenticated=function(t){return Gt.has(t)},t.isMapboxURL=_t,t.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!Z(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},t.latFromMercatorY=Su,t.latLngToECEF=ru,t.len=El,t.length=al,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.lngFromMercatorX=Eu,t.loadVectorTile=Og,t.makeRequest=pt,t.mapValue=function(t,e,n,r,o){return R((t-e)/(n-e)*(o-r)+r,r,o)},t.mercatorScale=Pu,t.mercatorXfromLng=Cu,t.mercatorYfromLat=bu,t.mercatorZfromAltitude=xu,t.mul=ol,t.mul$1=xl,t.multiply=Qa,t.multiply$1=Ka,t.multiply$2=pl,t.nextPowerOfTwo=F,t.normalize=ml,t.normalize$1=Dl,t.normalize$2=Tl,t.number=An,t.ortho=function(t,e,n,r,o,i,s){var a=1/(e-n),l=1/(r-o),u=1/(i-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(o+r)*l,t[14]=(s+i)*u,t[15]=1,t},t.pbf=xh,t.perspective=function(t,e,n,r,o){var i,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(t[10]=(o+r)*(i=1/(r-o)),t[14]=2*o*r*i):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){const n={};for(let r=0;r<e.length;r++){const o=e[r];o in t&&(n[o]=t[o])}return n},t.plugin=os,t.pointGeometry=m,t.polesInViewport=function(t){const e=Ya(new Float64Array(16));Qa(e,t.pixelMatrix,t.globeMatrix);const n=[0,Hl,0],r=[0,Ul,0];return _l(n,n,e),_l(r,r,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!hu(t,new _u(t.center.lat,90)),r[0]>0&&r[0]<=t.width&&r[1]>0&&r[1]<=t.height&&!hu(t,new _u(t.center.lat,-90))]},t.polygonContainsPoint=Qu,t.polygonIntersectsBox=Ju,t.polygonIntersectsPolygon=ju,t.polygonizeBounds=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=new v(n,n),i=t.sub(o),s=e.add(o),a=[i,new v(s.x,i.y),s,new v(i.x,s.y)];return r&&a.push(i.clone()),a},t.posAttributes=Fl,t.postMapLoadEvent=Mt,t.postPerformanceEvent=Nt,t.postTurnstileEvent=At,t.potpack=Yh,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=b,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:Qi,pluginURL:Ji}),es.on("pluginStateChange",t),t},t.removeAuthState=function(t){Gt.delete(t)},t.renderColorRamp=vc,t.resample=Au,t.rotateX=tl,t.rotateX$1=Il,t.rotateY=el,t.rotateY$1=Al,t.rotateZ=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+u*r,t[1]=s*o+c*r,t[2]=a*o+p*r,t[3]=l*o+h*r,t[4]=u*o-i*r,t[5]=c*o-s*r,t[6]=p*o-a*r,t[7]=h*o-l*r,t},t.rotateZ$1=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*a,t[1]=o*l-r*a,t[2]=i*l+s*a,t[3]=s*l-i*a,t},t.scale=$a,t.scale$1=Sl,t.scale$2=fl,t.scaleAndAdd=gl,t.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},t.setCacheLimits=function(t,e){nt=t,rt=e},t.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},t.setRTLTextPlugin=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qi===Xi||Qi===Ki||Qi===Yi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ji=Kt.resolveURL(t),Qi=Xi,Zi=e,ts(),n||rs()},t.smoothstep=P,t.spec=te,t.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},t.storeAuthState=function(t,e){e?Gt.add(t):Gt.delete(t)},t.sub=bl,t.subtract=cl,t.symbolSize=vh,t.tileAABB=function(t,e,n,r,o,i,s,a,l){if("globe"===l.name)return function(t,e,n){const r=e/t.worldSize,o=t.globeMatrix;if(n.z<=1){const t=Zl(n).getCorners();return $l(t,o,r),Vl.fromPoints(t)}const i=tu(n),s=eu(i);$l(s,o,r);const a=Number.MAX_VALUE,l=[-a,-a,-a],u=[a,a,a];if(i.contains(t.center)){for(const t of s)hl(u,u,t),dl(l,l,t);l[2]=0;const e=t.point,n=[e.x*r,e.y*r,0];return hl(u,u,n),dl(l,l,n),new Vl(u,l)}const c=[o[12]*r,o[13]*r,o[14]*r],p=i.getCenter(),h=R(t.center.lat,-Ru,Ru),d=R(p.lat,-Ru,Ru),f=Cu(t.center.lng),g=bu(h);let m=f-Cu(p.lng);const y=g-bu(d);m>.5?m-=1:m<-.5&&(m+=1);let v=0;Math.abs(m)>Math.abs(y)?v=m>=0?1:3:(v=y>=0?0:2,gl(c,c,[o[4]*r,o[5]*r,o[6]*r],-Math.sin(C(y>=0?i.getSouth():i.getNorth()))*zl));const _=s[v],w=s[(v+1)%4],b=new Kl(_,w,c),x=[Yl(b,0)||_[0],Yl(b,1)||_[1],Yl(b,2)||_[2]],E=cu(t.zoom);if(E>0){const r=function(t,e,n,r,o){let{x:i,y:s,z:a}=t;const l=1/(1<<a);let u=i*l,c=u+l,p=s*l,h=p+l,d=0;const f=(u+c)/2-r;return f>.5?d=-1:f<-.5&&(d=1),u=((u+d)*e-(r*=e))*n+r,c=((c+d)*e-r)*n+r,p=(p*e-(o*=e))*n+o,h=(h*e-o)*n+o,[[u,h,0],[c,h,0],[c,p,0],[u,p,0]]}(n,e,t._pixelsPerMercatorPixel,f,g);for(let t=0;t<s.length;t++)Ql(s[t],r[t],E);const o=ul([],r[v],r[(v+1)%4]);fl(o,o,.5),Ql(x,o,E)}for(const C of s)hl(u,u,C),dl(l,l,C);return u[2]=Math.min(_[2],w[2]),hl(u,u,x),dl(l,l,x),new Vl(u,l)}(t,e,new jp(n,r,o));const u=Zd({z:n,x:r,y:o},l);return new Vl([(i+u.x/u.scale)*e,e*(u.y/u.scale),s],[(i+u.x2/u.scale)*e,e*(u.y2/u.scale),a])},t.tileCornersToBounds=tu,t.tileTransform=Zd,t.transformMat3=function(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t},t.transformMat4=_l,t.transformMat4$1=Rl,t.transformQuat=wl,t.transitionTileAABBinECEF=Jl,t.translate=Ja,t.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},t.triggerPluginCompletionEvent=$i,t.uniqueId=L,t.updateGlobeVertexNormal=function(t,e,n,r,o){const i=5*e+2;t.float32[i+0]=n,t.float32[i+1]=r,t.float32[i+2]=o},t.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===t.render&&e.push({message:"layers.".concat(n,': missing required method "render"')}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),e},t.validateFilter=t=>Lo(mo(t)),t.validateFog=t=>Lo(Ro(t)),t.validateLayer=t=>Lo(wo(t)),t.validateLight=t=>Lo(So(t)),t.validateSource=t=>Lo(xo(t)),t.validateStyle=Ao,t.validateTerrain=t=>Lo(To(t)),t.values=A,t.vectorTile=cp,t.version=n,t.warnOnce=U,t.window=e,t.wrap=O})),r(0,(function(t){function e(t){if("number"==typeof t||"boolean"==typeof t||"string"==typeof t||null==t)return JSON.stringify(t);if(Array.isArray(t)){let n="[";for(const r of t)n+="".concat(e(r),",");return"".concat(n,"]")}let n="{";for(const r of Object.keys(t).sort())n+="".concat(r,":").concat(e(t[r]),",");return"".concat(n,"}")}function n(n){let r="";for(const o of t.refProperties)r+="/".concat(e(n[o]));return r}class r{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,r){for(const n of e)this._layerConfigs[n.id]=n,(this._layers[n.id]=t.createStyleLayer(n)).compileFilter(),this.keyCache[n.id]&&delete this.keyCache[n.id];for(const t of r)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const o=function(t,e){const r={};for(let i=0;i<t.length;i++){const o=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=o);let s=r[o];s||(s=r[o]=[]),s.push(t[i])}const o=[];for(const n in r)o.push(r[n]);return o}(t.values(this._layerConfigs),this.keyCache);for(const t of o){const e=t.map(t=>this._layers[t.id]),n=e[0];if("none"===n.visibility)continue;const r=n.source||"";let o=this.familiesBySource[r];o||(o=this.familiesBySource[r]={});const i=n.sourceLayer||"_geojsonTileLayer";let s=o[i];s||(s=o[i]=[]),s.push(e)}}}class o{loadTile(e,n){const{uid:r,encoding:o,rawImageData:i,padding:s,buildQuadTree:a}=e,l=t.window.ImageBitmap&&i instanceof t.window.ImageBitmap?this.getImageData(i,s):i;n(null,new t.DEMData(r,l,o,s<1,a))}getImageData(t,e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);const n=this.offscreenCanvasContext.getImageData(-e,-e,t.width+2*e,t.height+2*e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),n}}function i(t,e){if(0!==t.length){s(t[0],e);for(var n=1;n<t.length;n++)s(t[n],!e)}}function s(t,e){for(var n=0,r=0,o=0,i=t.length,s=i-1;o<i;s=o++){var a=(t[o][0]-t[s][0])*(t[s][1]+t[o][1]),l=n+a;r+=Math.abs(n)>=Math.abs(a)?n-l+a:a-l+n,n=l}n+r>=0!=!!e&&t.reverse()}var a=t.getDefaultExportFromCjs((function t(e,n){var r,o=e&&e.type;if("FeatureCollection"===o)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===o)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===o)t(e.geometry,n);else if("Polygon"===o)i(e.coordinates,n);else if("MultiPolygon"===o)for(r=0;r<e.coordinates.length;r++)i(e.coordinates[r],n);return e}));const l=t.VectorTileFeature.prototype.toGeoJSON;var u={exports:{}},c=t.pointGeometry,p=t.vectorTile.VectorTileFeature,h=d;function d(t,e){this.options=e||{},this.features=t,this.length=t.length}function f(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}d.prototype.feature=function(t){return new f(this.features[t],this.options.extent)},f.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],r=[],o=0;o<n.length;o++)r.push(new c(n[o][0],n[o][1]));this.geometry.push(r)}return this.geometry},f.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,o=-1/0,i=0;i<t.length;i++)for(var s=t[i],a=0;a<s.length;a++){var l=s[a];e=Math.min(e,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),o=Math.max(o,l.y)}return[e,r,n,o]},f.prototype.toGeoJSON=p.prototype.toGeoJSON;var g=t.pbf,m=h;function y(t){var e=new g;return function(t,e){for(var n in t.layers)e.writeMessage(3,v,t.layers[n])}(t,e),e.finish()}function v(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,_,r);var o=r.keys;for(n=0;n<o.length;n++)e.writeStringField(3,o[n]);var i=r.values;for(n=0;n<i.length;n++)e.writeMessage(4,E,i[n])}function _(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,w,t),e.writeVarintField(3,n.type),e.writeMessage(4,x,n)}function w(t,e){var n=t.feature,r=t.keys,o=t.values,i=t.keycache,s=t.valuecache;for(var a in n.properties){var l=n.properties[a],u=i[a];if(null!==l){void 0===u&&(r.push(a),i[a]=u=r.length-1),e.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var p=c+":"+l,h=s[p];void 0===h&&(o.push(l),s[p]=h=o.length-1),e.writeVarint(h)}}}function C(t,e){return(e<<3)+(7&t)}function b(t){return t<<1^t>>31}function x(t,e){for(var n=t.loadGeometry(),r=t.type,o=0,i=0,s=n.length,a=0;a<s;a++){var l=n[a],u=1;1===r&&(u=l.length),e.writeVarint(C(1,u));for(var c=3===r?l.length-1:l.length,p=0;p<c;p++){1===p&&1!==r&&e.writeVarint(C(2,c-1));var h=l[p].x-o,d=l[p].y-i;e.writeVarint(b(h)),e.writeVarint(b(d)),o+=h,i+=d}3===r&&e.writeVarint(C(7,1))}}function E(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}u.exports=y,u.exports.fromVectorTileJs=y,u.exports.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new m(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return y({layers:n})},u.exports.GeoJSONWrapper=m;var S=t.getDefaultExportFromCjs(u.exports);const T={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},R=Math.fround||(P=new Float32Array(1),t=>(P[0]=+t,P[0]));var P;class O{constructor(t){this.options=Object.assign(Object.create(T),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:n,maxZoom:r}=this.options;e&&console.time("total time");const o="prepare ".concat(t.length," points");e&&console.time(o),this.points=t;const i=[];for(let a=0;a<t.length;a++){const e=t[a];if(!e.geometry)continue;const[n,r]=e.geometry.coordinates,o=R(D(n)),s=R(M(r));i.push(o,s,1/0,a,-1,1),this.options.reduce&&i.push(0)}let s=this.trees[r+1]=this._createTree(i);e&&console.timeEnd(o);for(let a=r;a>=n;a--){const t=+Date.now();s=this.trees[a]=this._createTree(this._cluster(s,a)),e&&console.log("z%d: %d clusters in %dms",a,s.numItems,+Date.now()-t)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let o=180===t[2]?180:((t[2]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,o=180;else if(n>o){const t=this.getClusters([n,r,180,i],e),s=this.getClusters([-180,r,o,i],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],a=s.range(D(n),M(i),D(o),M(r)),l=s.data,u=[];for(const c of a){const t=this.stride*c;u.push(l[t+5]>1?I(l,t,this.clusterProps):this.points[l[t+3]])}return u}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(r);const i=o.data;if(e*this.stride>=i.length)throw new Error(r);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=o.within(i[e*this.stride],i[e*this.stride+1],s),l=[];for(const u of a){const e=u*this.stride;i[e+4]===t&&l.push(i[e+5]>1?I(i,e,this.clusterProps):this.points[i[e+3]])}if(0===l.length)throw new Error(r);return l}getLeaves(t,e,n){const r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r}getTile(t,e,n){const r=this.trees[this._limitZoom(t)],o=Math.pow(2,t),{extent:i,radius:s}=this.options,a=s/i,l=(n-a)/o,u=(n+1+a)/o,c={features:[]};return this._addTileFeatures(r.range((e-a)/o,l,(e+1+a)/o,u),r.data,e,n,o,c),0===e&&this._addTileFeatures(r.range(1-a/o,l,1,u),r.data,o,n,o,c),e===o-1&&this._addTileFeatures(r.range(0,l,a/o,u),r.data,-1,n,o,c),c.features.length?c:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,r,o){const i=this.getChildren(e);for(const s of i){const e=s.properties;if(e&&e.cluster?o+e.point_count<=r?o+=e.point_count:o=this._appendLeaves(t,e.cluster_id,n,r,o):o<r?o++:t.push(s),t.length===n)break}return o}_createTree(e){const n=new t.KDBush(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)n.add(e[t],e[t+1]);return n.finish(),n.data=e,n}_addTileFeatures(t,e,n,r,o,i){for(const s of t){const t=s*this.stride,a=e[t+5]>1;let l,u,c;if(a)l=A(e,t,this.clusterProps),u=e[t],c=e[t+1];else{const n=this.points[e[t+3]];l=n.properties;const[r,o]=n.geometry.coordinates;u=D(r),c=M(o)}const p={type:1,geometry:[[Math.round(this.options.extent*(u*o-n)),Math.round(this.options.extent*(c*o-r))]],tags:l};let h;h=a||this.options.generateId?e[t+3]:this.points[e[t+3]].id,void 0!==h&&(p.id=h),i.features.push(p)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:n,extent:r,reduce:o,minPoints:i}=this.options,s=n/(r*Math.pow(2,e)),a=t.data,l=[],u=this.stride;for(let c=0;c<a.length;c+=u){if(a[c+2]<=e)continue;a[c+2]=e;const n=a[c],r=a[c+1],p=t.within(a[c],a[c+1],s),h=a[c+5];let d=h;for(const t of p){const n=t*u;a[n+2]>e&&(d+=a[n+5])}if(d>h&&d>=i){let t,i=n*h,s=r*h,f=-1;const g=((c/u|0)<<5)+(e+1)+this.points.length;for(const n of p){const r=n*u;if(a[r+2]<=e)continue;a[r+2]=e;const l=a[r+5];i+=a[r]*l,s+=a[r+1]*l,a[r+4]=g,o&&(t||(t=this._map(a,c,!0),f=this.clusterProps.length,this.clusterProps.push(t)),o(t,this._map(a,r)))}a[c+4]=g,l.push(i/d,s/d,1/0,g,-1,d),o&&l.push(f)}else{for(let t=0;t<u;t++)l.push(a[c+t]);if(d>1)for(const t of p){const n=t*u;if(!(a[n+2]<=e)){a[n+2]=e;for(let t=0;t<u;t++)l.push(a[n+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,n){if(t[e+5]>1){const r=this.clusterProps[t[e+6]];return n?Object.assign({},r):r}const r=this.points[t[e+3]].properties,o=this.options.map(r);return n&&o===r?Object.assign({},o):o}}function I(t,e,n){return{type:"Feature",id:t[e+3],properties:A(t,e,n),geometry:{type:"Point",coordinates:[(r=t[e],360*(r-.5)),L(t[e+1])]}};var r}function A(t,e,n){const r=t[e+5],o=r>=1e4?"".concat(Math.round(r/1e3),"k"):r>=1e3?Math.round(r/100)/10+"k":r,i=t[e+6],s=-1===i?{}:Object.assign({},n[i]);return Object.assign(s,{cluster:!0,cluster_id:t[e+3],point_count:r,point_count_abbreviated:o})}function D(t){return t/360+.5}function M(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function L(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function N(t,e,n,r,o,i){var s=o-n,a=i-r;if(0!==s||0!==a){var l=((t-n)*s+(e-r)*a)/(s*s+a*a);l>1?(n=o,r=i):l>0&&(n+=s*l,r+=a*l)}return(s=t-n)*s+(a=e-r)*a}function F(t,e,n,r){var o={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)k(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)k(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)k(t,e[r][o])}(o),o}function k(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function G(t,e,n,r){if(e.geometry){var o=e.geometry.coordinates,i=e.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===i)B(o,a);else if("MultiPoint"===i)for(var u=0;u<o.length;u++)B(o[u],a);else if("LineString"===i)V(o,a,s,!1);else if("MultiLineString"===i){if(n.lineMetrics){for(u=0;u<o.length;u++)V(o[u],a=[],s,!1),t.push(F(l,"LineString",a,e.properties));return}z(o,a,s,!1)}else if("Polygon"===i)z(o,a,s,!0);else{if("MultiPolygon"!==i){if("GeometryCollection"===i){for(u=0;u<e.geometry.geometries.length;u++)G(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<o.length;u++){var c=[];z(o[u],c,s,!0),a.push(c)}}t.push(F(l,i,a,e.properties))}}function B(t,e){e.push(j(t[0])),e.push(H(t[1])),e.push(0)}function V(t,e,n,r){for(var o,i,s=0,a=0;a<t.length;a++){var l=j(t[a][0]),u=H(t[a][1]);e.push(l),e.push(u),e.push(0),a>0&&(s+=r?(o*u-l*i)/2:Math.sqrt(Math.pow(l-o,2)+Math.pow(u-i,2))),o=l,i=u}var c=e.length-3;e[2]=1,function t(e,n,r,o){for(var i,s=o,a=r-n>>1,l=r-n,u=e[n],c=e[n+1],p=e[r],h=e[r+1],d=n+3;d<r;d+=3){var f=N(e[d],e[d+1],u,c,p,h);if(f>s)i=d,s=f;else if(f===s){var g=Math.abs(d-a);g<l&&(i=d,l=g)}}s>o&&(i-n>3&&t(e,n,i,o),e[i+2]=s,r-i>3&&t(e,i,r,o))}(e,0,c,n),e[c+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function z(t,e,n,r){for(var o=0;o<t.length;o++){var i=[];V(t[o],i,n,r),e.push(i)}}function j(t){return t/360+.5}function H(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function U(t,e,n,r,o,i,s,a){if(r/=e,i>=(n/=e)&&s<r)return t;if(s<n||i>=r)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,h=c.type,d=0===o?c.minX:c.minY,f=0===o?c.maxX:c.maxY;if(d>=n&&f<r)l.push(c);else if(!(f<n||d>=r)){var g=[];if("Point"===h||"MultiPoint"===h)W(p,g,n,r,o);else if("LineString"===h)q(p,g,n,r,o,!1,a.lineMetrics);else if("MultiLineString"===h)K(p,g,n,r,o,!1);else if("Polygon"===h)K(p,g,n,r,o,!0);else if("MultiPolygon"===h)for(var m=0;m<p.length;m++){var y=[];K(p[m],y,n,r,o,!0),y.length&&g.push(y)}if(g.length){if(a.lineMetrics&&"LineString"===h){for(m=0;m<g.length;m++)l.push(F(c.id,h,g[m],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===g.length?(h="LineString",g=g[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===g.length?"Point":"MultiPoint"),l.push(F(c.id,h,g,c.tags))}}}return l.length?l:null}function W(t,e,n,r,o){for(var i=0;i<t.length;i+=3){var s=t[i+o];s>=n&&s<=r&&(e.push(t[i]),e.push(t[i+1]),e.push(t[i+2]))}}function q(t,e,n,r,o,i,s){for(var a,l,u=X(t),c=0===o?Z:Q,p=t.start,h=0;h<t.length-3;h+=3){var d=t[h],f=t[h+1],g=t[h+2],m=t[h+3],y=t[h+4],v=0===o?d:f,_=0===o?m:y,w=!1;s&&(a=Math.sqrt(Math.pow(d-m,2)+Math.pow(f-y,2))),v<n?_>n&&(l=c(u,d,f,m,y,n),s&&(u.start=p+a*l)):v>r?_<r&&(l=c(u,d,f,m,y,r),s&&(u.start=p+a*l)):Y(u,d,f,g),_<n&&v>=n&&(l=c(u,d,f,m,y,n),w=!0),_>r&&v<=r&&(l=c(u,d,f,m,y,r),w=!0),!i&&w&&(s&&(u.end=p+a*l),e.push(u),u=X(t)),s&&(p+=a)}var C=t.length-3;d=t[C],f=t[C+1],g=t[C+2],(v=0===o?d:f)>=n&&v<=r&&Y(u,d,f,g),C=u.length-3,i&&C>=3&&(u[C]!==u[0]||u[C+1]!==u[1])&&Y(u,u[0],u[1],u[2]),u.length&&e.push(u)}function X(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function K(t,e,n,r,o,i){for(var s=0;s<t.length;s++)q(t[s],e,n,r,o,i,!1)}function Y(t,e,n,r){t.push(e),t.push(n),t.push(r)}function Z(t,e,n,r,o,i){var s=(i-e)/(r-e);return t.push(i),t.push(n+(o-n)*s),t.push(1),s}function Q(t,e,n,r,o,i){var s=(i-n)/(o-n);return t.push(e+(r-e)*s),t.push(i),t.push(1),s}function J(t,e){for(var n=[],r=0;r<t.length;r++){var o,i=t[r],s=i.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)o=$(i.geometry,e);else if("MultiLineString"===s||"Polygon"===s){o=[];for(var a=0;a<i.geometry.length;a++)o.push($(i.geometry[a],e))}else if("MultiPolygon"===s)for(o=[],a=0;a<i.geometry.length;a++){for(var l=[],u=0;u<i.geometry[a].length;u++)l.push($(i.geometry[a][u],e));o.push(l)}n.push(F(i.id,s,o,i.tags))}return n}function $(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function tt(t,e){if(t.transformed)return t;var n,r,o,i=1<<t.z,s=t.x,a=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(r=0;r<u.length;r+=2)l.geometry.push(et(u[r],u[r+1],e,i,s,a));else for(r=0;r<u.length;r++){var p=[];for(o=0;o<u[r].length;o+=2)p.push(et(u[r][o],u[r][o+1],e,i,s,a));l.geometry.push(p)}}return t.transformed=!0,t}function et(t,e,n,r,o,i){return[Math.round(n*(t*r-o)),Math.round(n*(e*r-i))]}function nt(t,e,n,r,o){for(var i=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<t.length;a++){s.numFeatures++,rt(s,t[a],i,o);var l=t[a].minX,u=t[a].minY,c=t[a].maxX,p=t[a].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),p>s.maxY&&(s.maxY=p)}return s}function rt(t,e,n,r){var o=e.geometry,i=e.type,s=[];if("Point"===i||"MultiPoint"===i)for(var a=0;a<o.length;a+=3)s.push(o[a]),s.push(o[a+1]),t.numPoints++,t.numSimplified++;else if("LineString"===i)ot(s,o,t,n,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(a=0;a<o.length;a++)ot(s,o[a],t,n,"Polygon"===i,0===a);else if("MultiPolygon"===i)for(var l=0;l<o.length;l++){var u=o[l];for(a=0;a<u.length;a++)ot(s,u[a],t,n,!0,0===a)}if(s.length){var c=e.tags||null;if("LineString"===i&&r.lineMetrics){for(var p in c={},e.tags)c[p]=e.tags[p];c.mapbox_clip_start=o.start/o.size,c.mapbox_clip_end=o.end/o.size}var h={geometry:s,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:c};null!==e.id&&(h.id=e.id),t.features.push(h)}}function ot(t,e,n,r,o,i){var s=r*r;if(r>0&&e.size<(o?s:r))n.numPoints+=e.length/3;else{for(var a=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>s)&&(n.numSimplified++,a.push(e[l]),a.push(e[l+1])),n.numPoints++;o&&function(t,e){for(var n=0,r=0,o=t.length,i=o-2;r<o;i=r,r+=2)n+=(t[r]-t[i])*(t[r+1]+t[i+1]);if(n>0===e)for(r=0,o=t.length;r<o/2;r+=2){var s=t[r],a=t[r+1];t[r]=t[o-2-r],t[r+1]=t[o-1-r],t[o-2-r]=s,t[o-1-r]=a}}(a,i),t.push(a)}}function it(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)G(n,t.features[r],e,r);else G(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,o=U(t,1,-1-n,n,0,-1,2,e),i=U(t,1,1-n,2+n,0,-1,2,e);return(o||i)&&(r=U(t,1,-n,1+n,0,-1,2,e)||[],o&&(r=J(o,1).concat(r)),i&&(r=r.concat(J(i,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function st(t,e,n){return 32*((1<<t)*n+e)+t}function at(e,n){const r=e.tileID.canonical;if(!this._geoJSONIndex)return n(null,null);const o=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!o)return n(null,null);const i=new class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(e){return new class{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.Point(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const r=[];for(const e of n)r.push(new t.Point(e[0],e[1]));e.push(r)}return e}}toGeoJSON(t,e,n){return l.call(this,t,e,n)}}(this._features[e])}}(o.features);let s=S(i);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),n(null,{vectorTile:i,rawData:s.buffer})}it.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},it.prototype.splitTile=function(t,e,n,r,o,i,s){for(var a=[t,e,n,r],l=this.options,u=l.debug;a.length;){r=a.pop(),n=a.pop(),e=a.pop(),t=a.pop();var c=1<<e,p=st(e,n,r),h=this.tiles[p];if(!h&&(u>1&&console.time("creation"),h=this.tiles[p]=nt(t,e,n,r,l),this.tileCoords.push({z:e,x:n,y:r}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=t,o){if(e===l.maxZoom||e===o)continue;var f=1<<o-e;if(n!==Math.floor(i/f)||r!==Math.floor(s/f))continue}else if(e===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==t.length){u>1&&console.time("clipping");var g,m,y,v,_,w,C=.5*l.buffer/l.extent,b=.5-C,x=.5+C,E=1+C;g=m=y=v=null,_=U(t,c,n-C,n+x,0,h.minX,h.maxX,l),w=U(t,c,n+b,n+E,0,h.minX,h.maxX,l),t=null,_&&(g=U(_,c,r-C,r+x,1,h.minY,h.maxY,l),m=U(_,c,r+b,r+E,1,h.minY,h.maxY,l),_=null),w&&(y=U(w,c,r-C,r+x,1,h.minY,h.maxY,l),v=U(w,c,r+b,r+E,1,h.minY,h.maxY,l),w=null),u>1&&console.timeEnd("clipping"),a.push(g||[],e+1,2*n,2*r),a.push(m||[],e+1,2*n,2*r+1),a.push(y||[],e+1,2*n+1,2*r),a.push(v||[],e+1,2*n+1,2*r+1)}}},it.prototype.getTile=function(t,e,n){var r=this.options,o=r.extent,i=r.debug;if(t<0||t>24)return null;var s=1<<t,a=st(t,e=(e%s+s)%s,n);if(this.tiles[a])return tt(this.tiles[a],o);i>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,p=n;!l&&u>0;)u--,c=Math.floor(c/2),p=Math.floor(p/2),l=this.tiles[st(u,c,p)];return l&&l.source?(i>1&&console.log("found parent tile z%d-%d-%d",u,c,p),i>1&&console.time("drilling down"),this.splitTile(l.source,u,c,p,t,e,n),i>1&&console.timeEnd("drilling down"),this.tiles[a]?tt(this.tiles[a],o):null):null};class lt extends t.VectorTileWorkerSource{constructor(t,e,n,r,o){super(t,e,n,r,at),o&&(this.loadGeoJSON=o)}loadData(e,n){const r=e&&e.request,o=r&&r.collectResourceTiming;this.loadGeoJSON(e,(i,s)=>{if(i||!s)return n(i);if("object"!=typeof s)return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));{a(s,!0);try{if(e.filter){const n=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));const r=s.features.filter(t=>n.value.evaluate({zoom:0},t));s={type:"FeatureCollection",features:r}}this._geoJSONIndex=e.cluster?new O(function(e){let{superclusterOptions:n,clusterProperties:r}=e;if(!r||!n)return n;const o={},i={},s={accumulated:null,zoom:0},a={properties:null},l=Object.keys(r);for(const u of l){const[e,n]=r[u],s=t.createExpression(n),a=t.createExpression("string"==typeof e?[e,["accumulated"],["get",u]]:e);o[u]=s.value,i[u]=a.value}return n.map=t=>{a.properties=t;const e={};for(const n of l)e[n]=o[n].evaluate(s,a);return e},n.reduce=(t,e)=>{a.properties=e;for(const n of l)s.accumulated=t[n],t[n]=i[n].evaluate(s,a)},n}(e)).load(s.features):function(t,e){return new it(t,e)}(s,e.geojsonVtOptions)}catch(i){return n(i)}this.loaded={};const l={};if(o){const n=t.getPerformanceMeasurement(r);n&&(l.resourceTiming={},l.resourceTiming[e.source]=JSON.parse(JSON.stringify(n)))}n(null,l)}})}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class ut{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=t.getProjection({name:"mercator"}),this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:lt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error('Worker source with name "'.concat(t,'" already registered.'));this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}clearCaches(t,e,n){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t],n()}checkIfReady(t,e,n){n()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,n){this.isSpriteLoaded[e]=n;for(const r in this.workerSources[e]){const o=this.workerSources[e][r];for(const e in o)o[e]instanceof t.VectorTileWorkerSource&&(o[e].isSpriteLoaded=n,o[e].fire(new t.Event("isSpriteLoaded")))}}setImages(t,e,n){this.availableImages[t]=e;for(const r in this.workerSources[t]){const n=this.workerSources[t][r];for(const t in n)n[t].availableImages=e}n()}enableTerrain(t,e,n){this.terrain=e,n()}setProjection(e,n){this.projections[e]=t.getProjection(n)}setLayers(t,e,n){this.getLayerIndex(t).replace(e),n()}updateLayers(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}loadTile(e,n,r){const o=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;o.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,n.type,n.source).loadTile(o,r)}loadDEMTile(e,n,r){const o=this.enableTerrain?t.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(e,n.source).loadTile(o,r)}reloadTile(e,n,r){const o=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;o.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,n.type,n.source).reloadTile(o,r)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}removeSource(t,e,n){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,r){try{t.plugin.setState(n);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const n=t.plugin.isParsed();r(n?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(e)),n)}}catch(t){r(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e}getWorkerSource(t,e,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){const r={send:(e,n,r,o,i,s)=>{this.actor.send(e,n,r,t,i,s)},scheduler:this.actor.scheduler};this.workerSources[t][e][n]=new this.workerSourceTypes[e](r,this.getLayerIndex(t),this.getAvailableImages(t),this.isSpriteLoaded[t])}return this.workerSources[t][e][n]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new o),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,n){t.enforceCacheSizeLimit(n)}getWorkerPerformanceMetrics(t,e,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new ut(self)),ut})),r(0,(function(t){function e(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(!e(t[r],n[r]))return!1;return!0}return t===n}var n=r;function r(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===o[e=t&&t.failIfMajorPerformanceCaveat]&&(o[e]=function(t){var e,n=function(t){var e=document.createElement("canvas"),n=Object.create(r.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,e.getContext("webgl",n)||e.getContext("experimental-webgl",n)}(t);if(!n)return!1;try{e=n.createShader(n.VERTEX_SHADER)}catch(t){return!1}return!(!e||n.isContextLost())&&(n.shaderSource(e,"void main() {}"),n.compileShader(e),!0===n.getShaderParameter(e,n.COMPILE_STATUS))}(e)),o[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var o={};function i(e,n,r){const o=t.window.document.createElement(e);return void 0!==n&&(o.className=n),r&&r.appendChild(o),o}function s(e,n,r){const o=t.window.document.createElementNS("http://www.w3.org/2000/svg",e);for(const t of Object.keys(n))o.setAttributeNS(null,t,n[t]);return r&&r.appendChild(o),o}r.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const a=t.window.document&&t.window.document.documentElement.style,l=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let u;function c(){a&&l&&(u=a[l],a[l]="none")}function p(){a&&l&&(a[l]=u)}function h(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",h,!0)}function d(){t.window.addEventListener("click",h,!0),t.window.setTimeout(()=>{t.window.removeEventListener("click",h,!0)},0)}function f(t,e){const n=t.getBoundingClientRect();return y(t,n,e)}function g(t,e){const n=t.getBoundingClientRect(),r=[];for(let o=0;o<e.length;o++)r.push(y(t,n,e[o]));return r}function m(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button}function y(e,n,r){const o=e.offsetWidth===n.width?1:e.offsetWidth/n.width;return new t.Point((r.clientX-n.left)*o,(r.clientY-n.top)*o)}function v(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],s=n*i-o*r;return s?(t[0]=i*(s=1/s),t[1]=-r*s,t[2]=-o*s,t[3]=n*s,t):null}function _(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class w extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e)}_validate(e,n){let r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "content" value')))),r=!1),r}_validateStretch(t,e){if(!t)return!0;let n=0;for(const r of t){if(r[0]<n||r[1]<r[0]||e<r[1])return!1;n=r[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let n=!0;if(!this.isLoaded())for(const r of t)this.images[r]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,n){const r={};for(const o of e){this.images[o]||this.fire(new t.Event("styleimagemissing",{id:o}));const e=this.images[o];e?r[o]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce('Image "'.concat(o,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}n(null,r)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{const n={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new t.ImagePosition(n,r);this.patterns[e]={bin:n,position:o}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture&&this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:r}=t.potpack(e),o=this.atlasImage;o.resize({width:n||1,height:r||1});for(const i in this.patterns){const{bin:e}=this.patterns[i],n=e.x+1,r=e.y+1,s=this.images[i].data,a=s.width,l=s.height;t.RGBAImage.copy(s,o,{x:0,y:0},{x:n,y:r},{width:a,height:l}),t.RGBAImage.copy(s,o,{x:0,y:l-1},{x:n,y:r-1},{width:a,height:1}),t.RGBAImage.copy(s,o,{x:0,y:0},{x:n,y:r+l},{width:a,height:1}),t.RGBAImage.copy(s,o,{x:a-1,y:0},{x:n-1,y:r},{width:1,height:l}),t.RGBAImage.copy(s,o,{x:0,y:0},{x:n+a,y:r},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];_(t)&&this.updateImage(e,t)}}}const C=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,n){return function(e){let[n,r,o]=e;const i=t.degToRad(r+90),s=t.degToRad(o);return{x:n*Math.cos(i)*Math.sin(s),y:n*Math.sin(i)*Math.sin(s),z:n*Math.cos(s),azimuthal:r,polar:o}}(e.expression.evaluate(n))}interpolate(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r),azimuthal:t.number(e.azimuthal,n.azimuthal,r),polar:t.number(e.polar,n.polar,r)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)});class b extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(C),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.validateLight,e,n))for(const r in e){const n=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-11),n):this._transitionable.setValue(r,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const x=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)});let E=class extends t.Evented{constructor(e,n){super(),this._transitionable=new t.Transitionable(x),this.set(e),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(e){for(const n in e){const r=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),r):this._transitionable.setValue(n,r)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}};function S(e,n,r,o){const i=t.smoothstep(45,65,r),[s,a]=T(e,o),l=t.length(n);let u=1-Math.min(1,Math.exp((l-s)/(a-s)*-6));return u*=u*u,u=Math.min(1,1.00747*u),u*i*e.alpha}function T(t,e){const n=.5/Math.tan(.5*e);return[t.range[0]+n,t.range[1]+n]}const R=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"high-color":new t.DataConstantProperty(t.spec.fog["high-color"]),"space-color":new t.DataConstantProperty(t.spec.fog["space-color"]),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"]),"star-intensity":new t.DataConstantProperty(t.spec.fog["star-intensity"])});class P extends t.Evented{constructor(e,n){super(),this._transitionable=new t.Transitionable(R),this.set(e),this._transitioning=this._transitionable.untransitioned(),this._transform=n}get state(){const e=this._transform,n="globe"===e.projection.name,r=t.globeToMercatorTransition(e.zoom),o=this.properties.get("range"),i=[.5,3];return{range:n?[t.number(i[0],o[0],r),t.number(i[1],o[1],r)]:o,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.validateFog,e,n)){for(const n of Object.keys(t.spec.fog))e&&void 0===e[n]&&(e[n]=t.spec.fog[n].default);for(const n in e){const r=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),r):this._transitionable.setValue(n,r)}}}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:t.smoothstep(45,65,e))*n.a}getOpacityAtLatLng(e,n){return this._transform.projection.supportsFog?function(e,n,r){const o=t.MercatorCoordinate.fromLngLat(n),i=r.elevation?r.elevation.getAtPointOrZero(o):0,s=[o.x,o.y,i];return t.transformMat4(s,s,r.mercatorFogMatrix),S(e,s,r.pitch,r._fov)}(this.state,e,n):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?T(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class O{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const r=this.workerPool.acquire(this.id);for(let t=0;t<r.length;t++){const e=new O.Actor(r[t],n,this.id);e.name="Worker ".concat(t),this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,n,r){t.asyncAll(this.actors,(t,r)=>{t.send(e,n,r)},r=r||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function I(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}O.Actor=t.Actor;class A{constructor(t,e,n,r){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,r)}static createFromScreenPoints(e,n){let r,o;if(e instanceof t.Point||"number"==typeof e[0]){const i=t.Point.convert(e);r=[i],o=n.isPointAboveHorizon(i)}else{const i=t.Point.convert(e[0]),s=t.Point.convert(e[1]);r=[i,s],o=t.polygonizeBounds(i,s).every(t=>n.isPointAboveHorizon(t))}return new A(r,n.getCameraPoint(),o,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],o=t.polygonizeBounds(n,r,0,!1);return this.cameraPoint.y>r.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<r.x?o.splice(3,0,this.cameraPoint):this.cameraPoint.x>=r.x?o[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(o[3]=this.cameraPoint)),t.bufferConvexPolygon(o,e)}bufferedCameraGeometryGlobe(e){const n=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],o=t.polygonizeBounds(n,r,e),i=this.cameraPoint.clone();switch(3*((i.y>n.y)+(i.y>r.y))+((i.x>n.x)+(i.x>r.x))){case 0:o[0]=i,o[4]=i.clone();break;case 1:o.splice(1,0,i);break;case 2:o[1]=i;break;case 3:o.splice(4,0,i);break;case 5:o.splice(2,0,i);break;case 6:o[3]=i;break;case 7:o.splice(3,0,i);break;case 8:o[2]=i}return o}containsTile(e,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=e.queryPadding/n._pixelsPerMercatorPixel+1,s=r?this._bufferedCameraMercator(i,n):this._bufferedScreenMercator(i,n);let a=e.tileID.wrap+(s.unwrapped?o:0);const l=s.polygon.map(n=>t.getTilePoint(e.tileTransform,n,a));if(!t.polygonIntersectsBox(l,0,0,t.EXTENT,t.EXTENT))return;a=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?o:0);const u=this.screenGeometryMercator.polygon.map(n=>t.getTileVec3(e.tileTransform,n,a)),c=u.map(e=>new t.Point(e[0],e[1])),p=n.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),h=t.getTileVec3(e.tileTransform,p,a),d=u.map(e=>{const n=t.sub(e,e,h);return t.normalize(n,n),new t.Ray(h,n)}),f=I(e,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:c,tilespaceRays:d,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(g=t.getBounds(l),g.min.x=t.clamp(g.min.x,0,t.EXTENT),g.min.y=t.clamp(g.min.y,0,t.EXTENT),g.max.x=t.clamp(g.max.x,0,t.EXTENT),g.max.y=t.clamp(g.max.y,0,t.EXTENT),g),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:f};var g}_bufferedScreenMercator(t,e){const n=L(t);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{let r;return r="globe"===e.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),e):{polygon:this.bufferedScreenGeometry(t).map(t=>e.pointCoordinate3D(t)),unwrapped:!0},this._screenRaycastCache[n]=r,r}}_bufferedCameraMercator(t,e){const n=L(t);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{let r;return r="globe"===e.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),e):{polygon:this.bufferedCameraGeometry(t).map(t=>e.pointCoordinate3D(t)),unwrapped:!0},this._cameraRaycastCache[n]=r,r}}_projectAndResample(e,n){const r=function(e,n){const r=t.multiply([],n.pixelMatrix,n.globeMatrix),o=[0,-t.GLOBE_RADIUS,0,1],i=[0,t.GLOBE_RADIUS,0,1],s=[0,0,0,1];t.transformMat4$1(o,o,r),t.transformMat4$1(i,i,r),t.transformMat4$1(s,s,r);const a=new t.Point(o[0]/o[3],o[1]/o[3]),l=new t.Point(i[0]/i[3],i[1]/i[3]),u=t.polygonContainsPoint(e,a)&&o[3]<s[3],c=t.polygonContainsPoint(e,l)&&i[3]<s[3];if(!u&&!c)return null;const p=function(t,e,n){for(let r=1;r<t.length;r++){const o=M(e.pointCoordinate3D(t[r-1]).x),i=M(e.pointCoordinate3D(t[r]).x);if(n<0){if(o<i)return{idx:r,t:-o/(i-1-o)}}else if(i<o)return{idx:r,t:(1-o)/(i+1-o)}}return null}(e,n,u?-1:1);if(!p)return null;const{idx:h,t:d}=p;let f=h>1?D(e.slice(0,h),n):[],g=h<e.length?D(e.slice(h),n):[];f=f.map(e=>new t.Point(M(e.x),e.y)),g=g.map(e=>new t.Point(M(e.x),e.y));const m=[...f];0===m.length&&m.push(g[g.length-1]);const y=t.number(m[m.length-1].y,(0===g.length?f[0]:g[0]).y,d);let v;return v=u?[new t.Point(0,y),new t.Point(0,0),new t.Point(1,0),new t.Point(1,y)]:[new t.Point(1,y),new t.Point(1,1),new t.Point(0,1),new t.Point(0,y)],m.push(...v),0===g.length?m.push(f[0]):m.push(...g),{polygon:m.map(e=>new t.MercatorCoordinate(e.x,e.y)),unwrapped:!1}}(e,n);if(r)return r;const o=function(e,n){let r=!1,o=-1/0,i=0;for(let t=0;t<e.length-1;t++)e[t].x>o&&(o=e[t].x,i=t);for(let t=0;t<e.length-1;t++){const n=(i+t)%(e.length-1),o=e[n],s=e[n+1];Math.abs(o.x-s.x)>.5&&(o.x<s.x?(o.x+=1,0===n&&(e[e.length-1].x+=1)):(s.x+=1,n+1===e.length-1&&(e[0].x+=1)),r=!0)}const s=t.mercatorXfromLng(n.center.lng);return r&&s<Math.abs(s-1)&&e.forEach(t=>{t.x-=1}),{polygon:e,unwrapped:r}}(D(e,n).map(e=>new t.Point(M(e.x),e.y)),n);return{polygon:o.polygon.map(e=>new t.MercatorCoordinate(e.x,e.y)),unwrapped:o.unwrapped}}}function D(e,n){return t.resample(e,t=>{const e=n.pointCoordinate3D(t);t.x=e.x,t.y=e.y},1/256)}function M(t){return t<0?1+t%1:t%1}function L(t){return 100*t|0}function N(e,n,r,o,i){const s=function(r,o){if(r)return i(r);if(o){e.url&&o.tiles&&e.tiles&&delete e.tiles;const r=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(r.vectorLayers=o.vector_layers,r.vectorLayerIds=r.vectorLayers.map(t=>t.id)),r.tiles=n.canonicalizeTileset(r,e.url),i(null,r)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url,null,r,o),t.ResourceType.Source),s):t.exported.frame(()=>s(null,e))}class F{constructor(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),o=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),i=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),s=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<i&&e.y>=o&&e.y<s}}class k{constructor(t,e,n){this.context=t;const r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||e.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const G={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class B{constructor(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;const o=t.gl;this.buffer=o.createBuffer(),t.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||e.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const r=e.attributes[this.attributes[n].name];void 0!==r&&t.enableVertexAttribArray(r)}}setVertexAttribPointers(t,e,n){for(let r=0;r<this.attributes.length;r++){const o=this.attributes[r],i=e.attributes[o.name];void 0!==i&&t.vertexAttribPointer(i,o.components,t[G[o.type]],!1,this.itemSize,o.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class V{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class z extends V{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class j extends V{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class H extends V{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class U extends V{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class W extends V{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class q extends V{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class X extends V{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class K extends V{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Y extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class Z extends V{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Q extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class J extends V{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class $ extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class tt extends V{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class et extends V{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class nt extends V{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class rt extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class ot extends V{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class it extends V{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let st,at=class extends V{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}};class lt extends V{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ut extends V{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ct extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class pt extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ht extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class dt extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ft extends V{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gt extends V{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class mt extends V{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class yt extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class vt extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class _t extends V{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class wt extends _t{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ct extends _t{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class bt extends Ct{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xt{constructor(t,e,n,r){this.context=t,this.width=e,this.height=n;const o=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new wt(t,o),r&&(this.depthAttachment=new Ct(t,o))}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Et{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.gl=t,this.isWebGL2=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),e){const e=t;this.extVertexArrayObject={createVertexArrayOES:e.createVertexArray.bind(t),deleteVertexArrayOES:e.deleteVertexArray.bind(t),bindVertexArrayOES:e.bindVertexArray.bind(t)}}this.clearColor=new z(this),this.clearDepth=new j(this),this.clearStencil=new H(this),this.colorMask=new U(this),this.depthMask=new W(this),this.stencilMask=new q(this),this.stencilFunc=new X(this),this.stencilOp=new K(this),this.stencilTest=new Y(this),this.depthRange=new Z(this),this.depthTest=new Q(this),this.depthFunc=new J(this),this.blend=new $(this),this.blendFunc=new tt(this),this.blendColor=new et(this),this.blendEquation=new nt(this),this.cullFace=new rt(this),this.cullFaceSide=new ot(this),this.frontFace=new it(this),this.program=new at(this),this.activeTexture=new lt(this),this.viewport=new ut(this),this.bindFramebuffer=new ct(this),this.bindRenderbuffer=new pt(this),this.bindTexture=new ht(this),this.bindVertexBuffer=new dt(this),this.bindElementBuffer=new ft(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gt(this),this.pixelStoreUnpack=new mt(this),this.pixelStoreUnpackPremultiplyAlpha=new yt(this),this.pixelStoreUnpackFlipY=new vt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),e||(this.extTextureHalfFloat=t.getExtension("OES_texture_half_float")),(e||this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=e||t.getExtension("OES_standard_derivatives"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new k(this,t,e)}createVertexBuffer(t,e,n){return new B(this,t,e,n)}createRenderbuffer(t,e,n){const r=this.gl,o=r.createRenderbuffer();return this.bindRenderbuffer.set(o),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),o}createFramebuffer(t,e,n){return new xt(this,t,e,n)}clear(t){let{color:e,depth:n,stencil:r}=t;const o=this.gl;let i=0;e&&(i|=o.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=o.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==r&&(i|=o.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),o.clear(i)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(n){e(n.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class St extends t.Evented{constructor(e,n,r,o){if(super(),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(n,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(e){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=N(this._options,this.map._requestManager,n,r,(o,i)=>{this._tileJSONRequest=null,this._loaded=!0,o?(n&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ".concat(n)),r&&2!==r.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: ".concat(r)),this.fire(new t.ErrorEvent(o))):i&&(t.extend(this,i),i.bounds&&(this.tileBounds=new F(i.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),e&&e(o)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}loadTile(e,n){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(o.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",o,i.bind(this));else if(e.actor=this._tileWorkers[r]=this._tileWorkers[r]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",o,i.bind(this),void 0,!0);else{const n=t.loadVectorTile.call({deduped:this._deduped},o,(t,n)=>{t||!n?i.call(this,t):(o.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},e.actor&&e.actor.send("loadTile",o,i.bind(this),void 0,!0))},!0);e.request={cancel:n}}function i(r,o){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&o&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Tt extends t.Evented{constructor(e,n,r,o){super(),this.id=e,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=N(this._options,this.map._requestManager,null,null,(n,r)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new t.ErrorEvent(n)):r&&(t.extend(this,r),r.bounds&&(this.tileBounds=new F(r.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(r.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),e&&e(n)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const r=t.exported.devicePixelRatio>=2,o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(o,t.ResourceType.Tile),(r,o,i,s)=>(delete e.request,e.aborted?(e.state="unloaded",n(null)):r?(e.state="errored",n(r)):o?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:i,expires:s}),e.setTexture(o,this.map.painter),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),void n(null)):n(null)))}static loadTileData(t,e,n){t.setTexture(e,n)}static unloadTileData(t,e){t.texture&&e.saveTileTexture(t.texture)}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Rt(e,n,r,o,i,s,a,l){const u=[e,r,i,n,o,s,1,1,1],c=[a,l,1],p=t.adjoint([],u),[h,d,f]=t.transformMat3(c,c,t.transpose(p,p));return t.multiply$1(u,[h,0,0,0,d,0,0,0,f],u)}class Pt extends t.Evented{constructor(t,e,n,r){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=e,this._dirty=!1}load(e,n){this._loaded=n||!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(n,r)=>{if(this._imageRequest=null,this._loaded=!0,n)this.fire(new t.ErrorEvent(n));else if(r){const{HTMLImageElement:n}=t.window;this.image=r instanceof n?t.exported.getImageData(r):r,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(e){this.coordinates=e,this._boundsArray=void 0;const n=e.map(t.MercatorCoordinate.fromLngLat);return this.tileID=function(e){let n=1/0,r=1/0,o=-1/0,i=-1/0;for(const t of e)n=Math.min(n,t.x),r=Math.min(r,t.y),o=Math.max(o,t.x),i=Math.max(i,t.y);const s=Math.max(o-n,i-r),a=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,a);return new t.CanonicalTileID(a,Math.floor((n+o)/2*l),Math.floor((r+i)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(e){for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}if(this._boundsArray)return;const n=t.tileTransform(this.tileID,this.map.transform.projection),[r,o,i,s]=this.coordinates.map(e=>{const r=n.projection.project(e[0],e[1]);return t.getTilePoint(n,r)._round()});this.perspectiveTransform=function(e,n,r,o,i,s,a,l,u,c){const p=Rt(0,0,e,0,0,n,e,n),h=Rt(r,o,i,s,a,l,u,c);return t.multiply$1(h,t.adjoint(p,p),h),[h[6]/h[8]*e/t.EXTENT,h[7]/h[8]*n/t.EXTENT]}(this.width,this.height,r.x,r.y,o.x,o.y,s.x,s.y,i.x,i.y);const a=this._boundsArray=new t.StructArrayLayout4i8;a.emplaceBack(r.x,r.y,0,0),a.emplaceBack(o.x,o.y,t.EXTENT,0),a.emplaceBack(s.x,s.y,0,t.EXTENT),a.emplaceBack(i.x,i.y,t.EXTENT,t.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=e.createVertexBuffer(a,t.boundsAttributes.members),this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(e)}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ot={vector:St,raster:Tt,"raster-dem":class extends Tt{constructor(e,n,r,o){super(e,n,r,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(e,n){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function o(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,i,s,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:s,expires:a});const n=t.window.ImageBitmap&&i instanceof t.window.ImageBitmap&&(null==st&&(st=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof t.window.createImageBitmap),st),r=1-(i.width-t.prevPowerOfTwo(i.width))/2;r<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=n?i:t.exported.getImageData(i,r),u={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:r};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",u,o.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(e){const n=e.canonical,r=Math.pow(2,n.z),o=(n.x-1+r)%r,i=0===n.x?e.wrap-1:e.wrap,s=(n.x+1+r)%r,a=n.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,i,n.z,o,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,i,n.z,o,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new t.OverscaledTileID(e.overscaledZ,i,n.z,o,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends t.Evented{constructor(e,n,r,o){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(o),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const i=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*i,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*i,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*i,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),n=this._data;"string"==typeof n?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(n),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(n),this._pendingLoad=this.actor.send("".concat(this.type,".loadData"),e,(e,n)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else{const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[this.id]&&(e.resourceTiming=n.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,n){const r=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(r,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(t,o)=>(delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,this.map.painter,"reloadTile"===r),n(null))),void 0,"loadTile"===r)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Pt{constructor(t,e,n,r){super(t,e,n,r),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.ResourceType.Source).url);t.getVideo(this.urls,(e,n)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Pt,canvas:class extends Pt{constructor(e,n,r,o){super(e,n,r,o),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(t=>!Array.isArray(t)||2!==t.length||t.some(t=>"number"!=typeof t))||this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}},custom:class extends t.Evented{constructor(e,n,r,o){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=n,this.setEventedParent(o),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new t.ErrorEvent(new Error("Missing implementation for ".concat(this.id," custom source")))),this._implementation.loadTile||this.fire(new t.ErrorEvent(new Error("Missing loadTile implementation for ".concat(this.id," custom source")))),this._implementation.bounds&&(this.tileBounds=new F(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),t.extend(this,t.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return t.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this._map=e,this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(t){this._implementation.onRemove&&this._implementation.onRemove(t)}hasTile(t){if(this._implementation.hasTile){const{x:e,y:n,z:r}=t.canonical;return this._implementation.hasTile({x:e,y:n,z:r})}return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const{x:r,y:o,z:i}=e.tileID.canonical,s=new t.window.AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:r,y:o,z:i},{signal:s.signal})).then(function(r){return delete e.request,e.aborted?(e.state="unloaded",n(null)):void 0===r?(e.state="errored",n(null)):null===r?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",n(null)):function(e){return e instanceof t.window.ImageData||e instanceof t.window.HTMLCanvasElement||e instanceof t.window.ImageBitmap||e instanceof t.window.HTMLImageElement}(r)?(this.loadTileData(e,r),e.state="loaded",void n(null)):(e.state="errored",n(new Error("Can't infer data type for ".concat(this.id,", only raster data supported at the moment"))))}.bind(this)).catch(t=>{20!==t.code&&(e.state="errored",n(t))}),e.request.cancel=()=>s.abort()}loadTileData(t,e){Tt.loadTileData(t,e,this._map.painter)}unloadTileData(t){Tt.unloadTileData(t,this._map.painter)}unloadTile(t,e){if(this.unloadTileData(t),this._implementation.unloadTile){const{x:e,y:n,z:r}=t.tileID.canonical;this._implementation.unloadTile({x:e,y:n,z:r})}e()}abortTile(t,e){t.request&&t.request.cancel&&(t.request.cancel(),delete t.request),e()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(t=>({x:t.canonical.x,y:t.canonical.y,z:t.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}}},It=function(e,n,r,o){const i=new Ot[n.type](e,n,r,o);if(i.id!==e)throw new Error("Expected Source id to be ".concat(e," instead of ").concat(i.id));return t.bindAll(["load","abort","unload","serialize","prepare"],i),i};function At(e,n){const r=t.identity([]);return t.scale(r,r,[.5*e.width,.5*-e.height,1]),t.translate(r,r,[1,-1,0]),t.multiply(r,r,e.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(r)}function Dt(t,e,n,r,o,i,s){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=t.tilesIn(r,s,a);l.sort(Lt);const u=[];for(const p of l)u.push({wrappedTileID:p.tile.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,n,t._state,p,o,i,At(t.transform,p.tile.tileID),a)});const c=function(t){const e={},n={};for(const r of t){const t=r.queryResults,o=r.wrappedTileID,i=n[o]=n[o]||{};for(const n in t){const r=t[n],o=i[n]=i[n]||{},s=e[n]=e[n]||[];for(const t of r)o[t.featureIndex]||(o[t.featureIndex]=!0,s.push(t))}}return e}(u);for(const p in c)c[p].forEach(e=>{const n=e.feature,r=n.layer;r&&"background"!==r.type&&"sky"!==r.type&&(n.source=r.source,r["source-layer"]&&(n.sourceLayer=r["source-layer"]),n.state=void 0!==n.id?t.getFeatureState(r["source-layer"],n.id):{})});return c}function Mt(t,e){const n=t.getRenderableIds().map(e=>t.getTileByID(e)),r=[],o={};for(let i=0;i<n.length;i++){const t=n[i],s=t.tileID.canonical.key;o[s]||(o[s]=!0,t.querySourceFeatures(r,e))}return r}function Lt(t,e){const n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}function Nt(){return null!=gi.workerClass?new gi.workerClass:new t.window.Worker(gi.workerUrl)}const Ft="mapboxgl_preloaded_worker_pool";class kt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<kt.workerCount;)this.workers.push(new Nt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ft]}numActive(){return Object.keys(this.active).length}}let Gt;function Bt(){return Gt||(Gt=new kt),Gt}function Vt(e,n){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return t.refProperties.forEach(t=>{t in n&&(r[t]=n[t])}),r}function zt(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Vt(t[n],e[t[n].ref]));return t}kt.workerCount=2;const jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ht(t,e,n){n.push({command:jt.addSource,args:[t,e[t]]})}function Ut(t,e,n){e.push({command:jt.removeSource,args:[t]}),n[t]=!0}function Wt(t,e,n,r){Ut(t,n,r),Ht(t,e,n)}function qt(t,n,r){let o;for(o in t[r])if(t[r].hasOwnProperty(o)&&"data"!==o&&!e(t[r][o],n[r][o]))return!1;for(o in n[r])if(n[r].hasOwnProperty(o)&&"data"!==o&&!e(t[r][o],n[r][o]))return!1;return!0}function Xt(t,n,r,o,i,s){let a;for(a in n=n||{},t=t||{})t.hasOwnProperty(a)&&(e(t[a],n[a])||r.push({command:s,args:[o,a,n[a],i]}));for(a in n)n.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(e(t[a],n[a])||r.push({command:s,args:[o,a,n[a],i]}))}function Kt(t){return t.id}function Yt(t,e){return t[e.id]=e,t}class Zt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let n=1,r=this._distances[n];const o=e*this.paddedLength+this.padding;for(;r<o&&n<this._distances.length;)r=this._distances[++n];const i=n-1,s=this._distances[i],a=r-s,l=a>0?(o-s)/a:0;return this.points[i].mult(1-l).add(this.points[n].mult(l))}}class Qt{constructor(t,e,n){const r=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let i=0;i<this.xCellCount*this.yCellCount;i++)r.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,r,o){this._forEachCell(e,n,r,o,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(o)}insertCircle(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)}_insertBoxCell(t,e,n,r,o,i){this.boxCells[o].push(i)}_insertCircleCell(t,e,n,r,o,i){this.circleCells[o].push(i)}_query(t,e,n,r,o,i){if(n<0||t>this.width||r<0||e>this.height)return!o&&[];const s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(o)return!0;for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],r=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-r,y1:n-r,x2:e+r,y2:n+r})}return i?s.filter(i):s}return this._forEachCell(t,e,n,r,this._queryCell,s,{hitTest:o,seenUids:{box:{},circle:{}}},i),o?s.length>0:s}_queryCircle(t,e,n,r,o){const i=t-n,s=t+n,a=e-n,l=e+n;if(s<0||i>this.width||l<0||a>this.height)return!r&&[];const u=[];return this._forEachCell(i,a,s,l,this._queryCellCircle,u,{hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},o),r?u.length>0:u}query(t,e,n,r,o){return this._query(t,e,n,r,!1,o)}hitTest(t,e,n,r,o){return this._query(t,e,n,r,!0,o)}hitTestCircle(t,e,n,r){return this._queryCircle(t,e,n,!0,r)}_queryCell(t,e,n,r,o,i,s,a){const l=s.seenUids,u=this.boxCells[o];if(null!==u){const o=this.bboxes;for(const c of u)if(!l.box[c]){l.box[c]=!0;const u=4*c;if(t<=o[u+2]&&e<=o[u+3]&&n>=o[u+0]&&r>=o[u+1]&&(!a||a(this.boxKeys[c]))){if(s.hitTest)return i.push(!0),!0;i.push({key:this.boxKeys[c],x1:o[u],y1:o[u+1],x2:o[u+2],y2:o[u+3]})}}}const c=this.circleCells[o];if(null!==c){const o=this.circles;for(const u of c)if(!l.circle[u]){l.circle[u]=!0;const c=3*u;if(this._circleAndRectCollide(o[c],o[c+1],o[c+2],t,e,n,r)&&(!a||a(this.circleKeys[u]))){if(s.hitTest)return i.push(!0),!0;{const t=o[c],e=o[c+1],n=o[c+2];i.push({key:this.circleKeys[u],x1:t-n,y1:e-n,x2:t+n,y2:e+n})}}}}}_queryCellCircle(t,e,n,r,o,i,s,a){const l=s.circle,u=s.seenUids,c=this.boxCells[o];if(null!==c){const t=this.bboxes;for(const e of c)if(!u.box[e]){u.box[e]=!0;const n=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!a||a(this.boxKeys[e])))return i.push(!0),!0}}const p=this.circleCells[o];if(null!==p){const t=this.circles;for(const e of p)if(!u.circle[e]){u.circle[e]=!0;const n=3*e;if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[e])))return i.push(!0),!0}}}_forEachCell(t,e,n,r,o,i,s,a){const l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),p=this._convertToYCellCoord(r);for(let h=l;h<=c;h++)for(let l=u;l<=p;l++)if(o.call(this,t,e,n,r,this.xCellCount*l+h,i,s,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,r,o,i){const s=r-t,a=o-e,l=n+i;return l*l>s*s+a*a}_circleAndRectCollide(t,e,n,r,o,i,s){const a=(i-r)/2,l=Math.abs(t-(r+a));if(l>a+n)return!1;const u=(s-o)/2,c=Math.abs(e-(o+u));if(c>u+n)return!1;if(l<=a||c<=u)return!0;const p=l-a,h=c-u;return p*p+h*h<=n*n}}const Jt=0,$t=1,te=2,ee=Math.tan(85*Math.PI/180);function ne(e,n,r,o,i,s,a){const l=t.create();if(r)if("globe"===s.name){const e=t.calculateGlobeLabelMatrix(i,n);t.multiply(l,l,e)}else{const e=v([],a);l[0]=e[0],l[1]=e[1],l[4]=e[2],l[5]=e[3],o||t.rotateZ(l,l,i.angle)}else t.multiply(l,i.labelPlaneMatrix,e);return l}function re(t,e,n,r,o,i,s){const a=ne(t,e,n,r,o,i,s);return"globe"===i.name&&n||(a[2]=a[6]=a[10]=a[14]=0),a}function oe(e,n,r,o,i,s,a){if(r){if("globe"===s.name){const l=ne(e,n,r,o,i,s,a);return t.invert(l,l),t.multiply(l,e,l),l}{const n=t.clone(e),r=t.identity([]);return r[0]=a[0],r[1]=a[1],r[4]=a[2],r[5]=a[3],t.multiply(n,n,r),o||t.rotateZ(n,n,-i.angle),n}}return i.glCoordMatrix}function ie(e,n,r,o){const i=[e,n,r,1];r?t.transformMat4$1(i,i,o):me(i,i,o);const s=i[3];return i[0]/=s,i[1]/=s,i[2]/=s,i}function se(t,e){return Math.min(.5+t/e*.5,1.5)}function ae(t,e){const n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function le(e,n,r,o,i,s,a,l,u,c){const p=r.transform,h=o?e.textSizeData:e.iconSizeData,d=t.evaluateSizeForZoom(h,r.transform.zoom),f="globe"===p.projection.name,g=[256/r.width*2+1,256/r.height*2+1],m=o?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;m.clear();let y=null;f&&(y=o?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const v=e.lineVertexArray,_=o?e.text.placedSymbolArray:e.icon.placedSymbolArray,w=r.transform.width/r.transform.height;let C,b=!1;for(let x=0;x<_.length;x++){const o=_.get(x),{numGlyphs:f,writingMode:E}=o;if(E!==t.WritingMode.vertical||b||C===t.WritingMode.horizontal||(b=!0),C=E,(o.hidden||E===t.WritingMode.vertical)&&!b){ge(f,m);continue}b=!1;const S=new t.Point(o.tileAnchorX,o.tileAnchorY);let{x:T,y:R,z:P}=p.projection.projectTilePoint(S.x,S.y,c.canonical);if(u){const[t,e,n]=u(S);T+=t,R+=e,P+=n}const O=[T,R,P,1];if(t.transformMat4$1(O,O,n),!ae(O,g)){ge(f,m);continue}const I=se(r.transform.cameraToCenterDistance,O[3]),A=t.evaluateSizeForFeature(h,d,o),D=a?A/I:A*I,M=ie(T,R,P,i);if(M[3]<=0){ge(f,m);continue}let L={};const N=a?null:u,F=pe(o,D,!1,l,n,i,s,e.glyphOffsetArray,v,m,y,M,S,L,w,N,p.projection,c,a);b=F.useVertical,N&&F.needsFlipping&&(L={}),(F.notEnoughRoom||b||F.needsFlipping&&pe(o,D,!0,l,n,i,s,e.glyphOffsetArray,v,m,y,M,S,L,w,N,p.projection,c,a).notEnoughRoom)&&ge(f,m)}o?(e.text.dynamicLayoutVertexBuffer.updateData(m),y&&e.text.globeExtVertexBuffer.updateData(y)):(e.icon.dynamicLayoutVertexBuffer.updateData(m),y&&e.icon.globeExtVertexBuffer.updateData(y))}function ue(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g){const{lineStartIndex:m,glyphStartIndex:y,segment:v}=a,_=y+a.numGlyphs,w=m+a.lineLength,C=e.getoffsetX(y),b=e.getoffsetX(_-1),x=fe(t*C,n,r,o,i,s,v,m,w,l,u,c,p,h,!0,d,f,g);if(!x)return null;const E=fe(t*b,n,r,o,i,s,v,m,w,l,u,c,p,h,!0,d,f,g);return E?{first:x,last:E}:null}function ce(e,n,r,o){return e===t.WritingMode.horizontal&&Math.abs(o)>Math.abs(r)?{useVertical:!0}:e===t.WritingMode.vertical?o>0?{needsFlipping:!0}:null:n!==Jt&&function(t,e){return 0===t||Math.abs(e/t)>ee}(r,o)?n===$t?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function pe(e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_){const w=n/24,C=e.lineOffsetX*w,b=e.lineOffsetY*w,{lineStartIndex:x,glyphStartIndex:E,numGlyphs:S,segment:T,writingMode:R,flipState:P}=e,O=x+e.lineLength,I=e=>{if(p){const[n,r,o]=e.up,i=c.length;t.updateGlobeVertexNormal(p,i+0,n,r,o),t.updateGlobeVertexNormal(p,i+1,n,r,o),t.updateGlobeVertexNormal(p,i+2,n,r,o),t.updateGlobeVertexNormal(p,i+3,n,r,o)}const[n,r,o]=e.point;t.addDynamicAttributes(c,n,r,o,e.angle)};if(S>1){const t=ue(w,l,C,b,r,h,d,e,u,s,f,m,!1,y,v,_);if(!t)return{notEnoughRoom:!0};if(o&&!r){let[n,r,o]=t.first.point,[i,s,l]=t.last.point;[n,r]=ie(n,r,o,a),[i,s]=ie(i,s,l,a);const u=ce(R,P,(i-n)*g,s-r);if(e.flipState=u&&u.needsFlipping?$t:te,u)return u}I(t.first);for(let e=E+1;e<E+S-1;e++){const t=fe(w*l.getoffsetX(e),C,b,r,h,d,T,x,O,u,s,f,m,!1,!1,y,v,_);if(!t)return c.length-=4*(e-E),{notEnoughRoom:!0};I(t)}I(t.last)}else{if(o&&!r){const n=ie(d.x,d.y,0,i),r=x+T+1,o=new t.Point(u.getx(r),u.gety(r)),s=ie(o.x,o.y,0,i),a=s[3]>0?s:de(d,o,n,1,i,void 0,y,v.canonical),l=ce(R,P,(a[0]-n[0])*g,a[1]-n[1]);if(e.flipState=l&&l.needsFlipping?$t:te,l)return l}const n=fe(w*l.getoffsetX(E),C,b,r,h,d,T,x,O,u,s,f,m,!1,!1,y,v,_);if(!n)return{notEnoughRoom:!0};I(n)}return{}}function he(t,e,n,r,o){const{x:i,y:s,z:a}=r.projectTilePoint(t.x,t.y,e);if(!o)return ie(i,s,a,n);const[l,u,c]=o(t);return ie(i+l,s+u,a+c,n)}function de(e,n,r,o,i,s,a,l){const u=he(e.sub(n)._unit()._add(e),l,i,a,s);return t.sub(u,r,u),t.normalize(u,u),t.scaleAndAdd(u,r,u,o)}function fe(e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y,v){const _=o?e-n:e+n;let w=_>0?1:-1,C=0;o&&(w*=-1,C=Math.PI),w<0&&(C+=Math.PI);let b=l+a+(w>0?0:1)|0,x=i,E=i,S=0,T=0;const R=Math.abs(_),P=[],O=[];let I=s,A=I;const D=()=>de(A,I,E,R-S+1,p,d,m,y.canonical);for(;S+T<=R;){if(b+=w,b<l||b>=u)return null;if(E=x,A=I,P.push(E),f&&O.push(A),I=new t.Point(c.getx(b),c.gety(b)),x=h[b],!x){const t=he(I,y.canonical,p,m,d);x=t[3]>0?h[b]=t:D()}S+=T,T=t.distance(E,x)}g&&d&&(h[b]&&(x=D(),T=t.distance(E,x)),h[b]=x);const M=(R-S)/T,L=I.sub(A)._mult(M)._add(A),N=t.sub([],x,E),F=t.scaleAndAdd([],E,N,M);let k=[0,0,1],G=N[0],B=N[1];if(v&&(k=m.upVector(y.canonical,L.x,L.y),0!==k[0]||0!==k[1]||1!==k[2])){const e=[k[2],0,-k[0]],n=t.cross([],k,e);t.normalize(e,e),t.normalize(n,n),G=t.dot(N,e),B=t.dot(N,n)}if(r){const e=t.cross([],k,N);t.normalize(e,e),t.scaleAndAdd(F,F,e,r*w)}const V=C+Math.atan2(B,G);return P.push(F),f&&O.push(L),{point:F,angle:V,path:P,tilePath:O,up:k}}function ge(t,e){const n=e.length,r=n+4*t;e.resize(r),e.float32.fill(-1/0,4*n,4*r)}function me(t,e,n){const r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t[3]=n[3]*r+n[7]*o+n[15],t}const ye=100;class ve{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Qt(t.width+200,t.height+200,25),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Qt(t.width+200,t.height+200,25);this.transform=t,this.grid=n,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ye,this.screenBottomBoundary=t.height+ye,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,n,r,o,i,s,a){let l=n.projectedAnchorX,u=n.projectedAnchorY,c=n.projectedAnchorZ;const p=n.elevation,h=n.tileID,d=t.getProjection();if(p&&h){const[t,e,r]=d.upVector(h.canonical,n.tileAnchorX,n.tileAnchorY),o=d.upVectorScale(h.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=t*p*o,u+=e*p*o,c+=r*p*o}const f=this.projectAndGetPerspectiveRatio(s,l,u,c,n.tileID,"globe"===d.name||!!p||this.transform.pitch>0,d),g=i*f.perspectiveRatio,m=(n.x1*e+r.x-n.padding)*g+f.point.x,y=(n.y1*e+r.y-n.padding)*g+f.point.y,v=(n.x2*e+r.x+n.padding)*g+f.point.x,_=(n.y2*e+r.y+n.padding)*g+f.point.y,w=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(m,y,v,_)||!o&&this.grid.hitTest(m,y,v,_,a)||w?{box:[],offscreen:!1,occluded:f.occluded}:{box:[m,y,v,_],offscreen:this.isOffscreen(m,y,v,_),occluded:!1}}placeCollisionCircles(e,n,r,o,i,s,a,l,u,c,p,h,d,f,g){const m=[],y=this.transform.elevation,v=e.getProjection(),_=y?y.getAtTileOffsetFunc(g,this.transform.center.lat,this.transform.worldSize,v):null,w=new t.Point(r.tileAnchorX,r.tileAnchorY);let{x:C,y:b,z:x}=v.projectTilePoint(w.x,w.y,g.canonical);if(_){const[t,e,n]=_(w);C+=t,b+=e,x+=n}const E="globe"===v.name,S=this.projectAndGetPerspectiveRatio(a,C,b,x,g,E||!!y||this.transform.pitch>0,v),{perspectiveRatio:T}=S,R=(p?s/T:s*T)/t.ONE_EM,P=ie(C,b,x,l),O=S.signedDistanceFromCamera>0?ue(R,i,r.lineOffsetX*R,r.lineOffsetY*R,!1,P,w,r,o,l,{},y&&!p?_:null,p&&!!y,v,g,p):null;let I=!1,A=!1,D=!0;if(O&&!S.occluded){const e=.5*d*T+f,r=new t.Point(-100,-100),o=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),i=new Zt,{first:s,last:a}=O,l=s.path.length;let p=[];for(let t=l-1;t>=1;t--)p.push(s.path[t]);for(let t=1;t<a.path.length;t++)p.push(a.path[t]);const g=2.5*e;u&&(p=p.map((t,e)=>{let[n,r,o]=t;return _&&!E&&(o=_(e<l-1?s.tilePath[l-1-e]:a.tilePath[e-l+2])[2]),ie(n,r,o,u)}),p.some(t=>t[3]<=0)&&(p=[]));let y=[];if(p.length>0){let e=1/0,n=-1/0,i=1/0,s=-1/0;for(const t of p)e=Math.min(e,t[0]),i=Math.min(i,t[1]),n=Math.max(n,t[0]),s=Math.max(s,t[1]);n>=r.x&&e<=o.x&&s>=r.y&&i<=o.y&&(y=[p.map(e=>new t.Point(e[0],e[1]))],(e<r.x||n>o.x||i<r.y||s>o.y)&&(y=t.clipLine(y,r.x,r.y,o.x,o.y)))}for(const t of y){i.reset(t,.25*e);let r=0;r=i.length<=.5*e?1:Math.ceil(i.paddedLength/g)+1;for(let t=0;t<r;t++){const o=t/Math.max(r-1,1),s=i.lerp(o),a=s.x+ye,l=s.y+ye;m.push(a,l,e,0);const u=a-e,p=l-e,d=a+e,f=l+e;if(D=D&&this.isOffscreen(u,p,d,f),A=A||this.isInsideGrid(u,p,d,f),!n&&this.grid.hitTestCircle(a,l,e,h)&&(I=!0,!c))return{circles:[],offscreen:!1,collisionDetected:I,occluded:!1}}}}return{circles:!c&&I||!A?[]:m,offscreen:D,collisionDetected:I,occluded:S.occluded}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let r=1/0,o=1/0,i=-1/0,s=-1/0;for(const c of e){const e=new t.Point(c.x+ye,c.y+ye);r=Math.min(r,e.x),o=Math.min(o,e.y),i=Math.max(i,e.x),s=Math.max(s,e.y),n.push(e)}const a=this.grid.query(r,o,i,s).concat(this.ignoredGrid.query(r,o,i,s)),l={},u={};for(const c of a){const e=c.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const r=[new t.Point(c.x1,c.y1),new t.Point(c.x2,c.y1),new t.Point(c.x2,c.y2),new t.Point(c.x1,c.y2)];t.polygonIntersectsPolygon(n,r)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===u[e.bucketInstanceId]&&(u[e.bucketInstanceId]=[]),u[e.bucketInstanceId].push(e.featureIndex))}return u}insertCollisionBox(t,e,n,r,o){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,r,o){const i=e?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:r,collisionGroupID:o};for(let a=0;a<t.length;a+=4)i.insertCircle(s,t[a],t[a+1],t[a+2])}projectAndGetPerspectiveRatio(e,n,r,o,i,s,a){const l=[n,r,o,1];let u=!1;o||this.transform.pitch>0?(t.transformMat4$1(l,l,e),this.fogState&&i&&"globe"!==a.name&&(u=function(e,n,r,o,i,s){const a=s.calculateFogTileMatrix(i),l=[n,r,o];return t.transformMat4(l,l,a),S(e,l,s.pitch,s._fov)}(this.fogState,n,r,o,i.toUnwrapped(),this.transform)>.9)):me(l,l,e);const c=l[3];return{point:new t.Point((l[0]/c+1)/2*this.transform.width+ye,(-l[1]/c+1)/2*this.transform.height+ye),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/c*.5,1.5),signedDistanceFromCamera:c,occluded:s&&l[2]>c||u}}isOffscreen(t,e,n,r){return n<ye||t>=this.screenRightBoundary||r<ye||e>this.screenBottomBoundary}isInsideGrid(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}function _e(e,n,r){const o=n.createTileMatrix(e,e.worldSize,r.toUnwrapped());return t.multiply(new Float32Array(16),e.projMatrix,o)}function we(t,e,n){if(e.projection.name===n.projection.name)return t.projMatrix;const r=n.clone();return r.setProjection(e.projection),_e(r,e.getProjection(),t)}function Ce(t,e,n){return e.name===n.projection.name?t.projMatrix:_e(n,e,t)}class be{constructor(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class xe{constructor(t,e,n,r,o){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.text=new be(t?t.text:null,e,n,o),this.icon=new be(t?t.icon:null,e,r,o),this.clipped=i}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ee{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.text=t,this.icon=e,this.skipFade=n,this.clipped=r}}class Se{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class Te{constructor(t,e,n,r,o){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=o}}class Re{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Pe(e,n,r,o,i){const{horizontalAlign:s,verticalAlign:a}=t.getAnchorAlignment(e),l=-(s-.5)*n,u=-(a-.5)*r,c=t.evaluateVariableOffset(e,o);return new t.Point(l+c[0]*i,u+c[1]*i)}function Oe(e,n,r,o,i){const s=new t.Point(e,n);return r&&s._rotate(o?i:-i),s}class Ie{constructor(t,e,n,r,o){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new ve(this.transform,o),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Re(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,r,o){const i=r.getBucket(n),s=r.latestFeatureIndex;if(!i||!s||n.id!==i.layerIds[0])return;const a=i.layers[0].layout,l=r.collisionBoxArray,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,p=r.tileID.toUnwrapped();this.transform.setProjection(i.projection);const h=(d=r.tileID,f=i.getProjection(),g=this.transform,f.name===this.projection?g.calculateProjMatrix(d.toUnwrapped()):_e(g,f,d));var d,f,g;const m="map"===a.get("text-pitch-alignment"),y="map"===a.get("text-rotation-alignment");n.compileFilter();const v=n.dynamicFilter(),_=n.dynamicFilterNeedsFeature(),w=this.transform.calculatePixelsToTileUnitsMatrix(r),C=re(h,r.tileID.canonical,m,y,this.transform,i.getProjection(),w);let b=null;if(m){const e=oe(h,r.tileID.canonical,m,y,this.transform,i.getProjection(),w);b=t.multiply([],this.transform.labelPlaneMatrix,e)}let x=null;v&&r.latestFeatureIndex&&(x={unwrappedTileID:p,dynamicFilter:v,dynamicFilterNeedsFeature:_,featureIndex:r.latestFeatureIndex}),this.retainedQueryData[i.bucketInstanceId]=new Te(i.bucketInstanceId,s,i.sourceLayerIndex,i.index,r.tileID);const E={bucket:i,layout:a,posMatrix:h,textLabelPlaneMatrix:C,labelToScreenMatrix:b,clippingData:x,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(i.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(i.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(i.sourceID)};if(o)for(const t of i.sortKeyRanges){const{sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:o}=t;e.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:o,parameters:E})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:i.symbolInstances.length,parameters:E})}attemptAnchorPlacement(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y){const{textOffset0:v,textOffset1:_,crossTileID:w}=p,C=[v,_],b=Pe(t,n,r,C,o),x=this.collisionIndex.placeCollisionBox(d,o,e,Oe(b.x,b.y,i,s,this.transform.angle),c,a,l,u.predicate);if(g){const t=d.getSymbolInstanceIconSize(y,this.transform.zoom,p.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(d,t,g,Oe(b.x,b.y,i,s,this.transform.angle),c,a,l,u.predicate).box.length)return}if(x.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[w]&&this.prevPlacement.placements[w]&&this.prevPlacement.placements[w].text&&(e=this.prevPlacement.variableOffsets[w].anchor),this.variableOffsets[w]={textOffset:C,width:n,height:r,anchor:t,textScale:o,prevAnchor:e},this.markUsedJustification(d,t,p,f),d.allowVerticalPlacement&&(this.markUsedOrientation(d,f,p),this.placedOrientations[w]=f),{shift:b,placedGlyphBoxes:x}}}placeLayerBucketPart(e,n,r,o){const{bucket:i,layout:s,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:u,clippingData:c,textPixelRatio:p,holdingForFade:h,collisionBoxArray:d,partiallyEvaluatedTextSize:f,partiallyEvaluatedIconSize:g,collisionGroup:m}=e.parameters,y=s.get("text-optional"),v=s.get("icon-optional"),_=s.get("text-allow-overlap"),w=s.get("icon-allow-overlap"),C="map"===s.get("text-rotation-alignment"),b="map"===s.get("text-pitch-alignment"),x="none"!==s.get("icon-text-fit"),E="viewport-y"===s.get("symbol-z-order");this.transform.setProjection(i.projection);let S=_&&(w||!i.hasIconData()||v),T=w&&(_||!i.hasTextData()||y);!i.collisionArrays&&d&&i.deserializeCollisionBoxes(d),r&&o&&i.updateCollisionDebugBuffers(this.transform.zoom,d);const R=(e,o,d)=>{const{crossTileID:E,numVerticalGlyphVertices:R}=e;if(c){const r={zoom:this.transform.zoom,pitch:this.transform.pitch};let o=null;if(c.dynamicFilterNeedsFeature){const t=this.retainedQueryData[i.bucketInstanceId];o=c.featureIndex.loadFeature({featureIndex:e.featureIndex,bucketIndex:t.bucketIndex,sourceLayerIndex:t.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,c.dynamicFilter)(r,o,this.retainedQueryData[i.bucketInstanceId].tileID.canonical,new t.Point(e.tileAnchorX,e.tileAnchorY),this.transform.calculateDistanceTileData(c.unwrappedTileID)))return this.placements[E]=new Ee(!1,!1,!1,!0),void n.add(E)}if(n.has(E))return;if(h)return void(this.placements[E]=new Ee(!1,!1,!1));let P=!1,O=!1,I=!0,A=!1,D=!1,M=null,L={box:null,offscreen:null,occluded:null},N={box:null,offscreen:null,occluded:null},F=null,k=null,G=null,B=0,V=0,z=0;d.textFeatureIndex?B=d.textFeatureIndex:e.useRuntimeCollisionCircles&&(B=e.featureIndex),d.verticalTextFeatureIndex&&(V=d.verticalTextFeatureIndex);const j=t=>{t.tileID=this.retainedQueryData[i.bucketInstanceId].tileID;const e=this.transform.elevation;(e||t.elevation)&&(t.elevation=e?e.getAtTileOffset(t.tileID,t.tileAnchorX,t.tileAnchorY):0)},H=d.textBox;if(H){j(H);const n=n=>{let r=t.WritingMode.horizontal;if(i.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[E];t&&(this.placedOrientations[E]=t,r=t,this.markUsedOrientation(i,r,e))}return r},r=(e,n)=>{if(i.allowVerticalPlacement&&R>0&&d.verticalTextBox){for(const r of i.writingModes)if(r===t.WritingMode.vertical?(L=n(),N=L):L=e(),L&&L.box&&L.box.length)break}else L=e()};if(s.get("text-variable-anchor")){let l=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E]){const t=this.prevPlacement.variableOffsets[E];l.indexOf(t.anchor)>0&&(l=l.filter(e=>e!==t.anchor),l.unshift(t.anchor))}const u=(t,n,r)=>{const s=i.getSymbolInstanceTextSize(f,e,this.transform.zoom,o),u=(t.x2-t.x1)*s+2*t.padding,c=(t.y2-t.y1)*s+2*t.padding,h=x&&!w?n:null;h&&j(h);let d={box:[],offscreen:!1,occluded:!1};const y=_?2*l.length:l.length;for(let v=0;v<y;++v){const n=this.attemptAnchorPlacement(l[v%l.length],t,u,c,s,C,b,p,a,m,v>=l.length,e,o,i,r,h,f,g);if(n&&(d=n.placedGlyphBoxes,d&&d.box&&d.box.length)){P=!0,M=n.shift;break}}return d};r(()=>u(H,d.iconBox,t.WritingMode.horizontal),()=>{const e=d.verticalTextBox;return e&&j(e),i.allowVerticalPlacement&&!(L&&L.box&&L.box.length)&&R>0&&e?u(e,d.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),L&&(P=L.box,I=L.offscreen,A=L.occluded);const c=n(!(!L||!L.box));if(!P&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[E];t&&(this.variableOffsets[E]=t,this.markUsedJustification(i,t.anchor,e,c))}}else{const s=(n,r)=>{const s=i.getSymbolInstanceTextSize(f,e,this.transform.zoom,o),l=this.collisionIndex.placeCollisionBox(i,s,n,new t.Point(0,0),_,p,a,m.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(i,r,e),this.placedOrientations[E]=r),l};r(()=>s(H,t.WritingMode.horizontal),()=>{const e=d.verticalTextBox;return i.allowVerticalPlacement&&R>0&&e?(j(e),s(e,t.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),n(!!(L&&L.box&&L.box.length))}}if(F=L,P=F&&F.box&&F.box.length>0,I=F&&F.offscreen,A=F&&F.occluded,e.useRuntimeCollisionCircles){const n=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex),o=t.evaluateSizeForFeature(i.textSizeData,f,n),c=s.get("text-padding");k=this.collisionIndex.placeCollisionCircles(i,_,n,i.lineVertexArray,i.glyphOffsetArray,o,a,l,u,r,b,m.predicate,e.collisionCircleDiameter*o/t.ONE_EM,c,this.retainedQueryData[i.bucketInstanceId].tileID),P=_||k.circles.length>0&&!k.collisionDetected,I=I&&k.offscreen,A=k.occluded}if(d.iconFeatureIndex&&(z=d.iconFeatureIndex),d.iconBox){const n=n=>{j(n);const r=x&&M?Oe(M.x,M.y,C,b,this.transform.angle):new t.Point(0,0),o=i.getSymbolInstanceIconSize(g,this.transform.zoom,e.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(i,o,n,r,w,p,a,m.predicate)};N&&N.box&&N.box.length&&d.verticalIconBox?(G=n(d.verticalIconBox),O=G.box.length>0):(G=n(d.iconBox),O=G.box.length>0),I=I&&G.offscreen,D=G.occluded}const U=y||0===e.numHorizontalGlyphVertices&&0===R,W=v||0===e.numIconVertices;if(U||W?W?U||(O=O&&P):P=O&&P:O=P=O&&P,P&&F&&F.box&&this.collisionIndex.insertCollisionBox(F.box,s.get("text-ignore-placement"),i.bucketInstanceId,N&&N.box&&V?V:B,m.ID),O&&G&&this.collisionIndex.insertCollisionBox(G.box,s.get("icon-ignore-placement"),i.bucketInstanceId,z,m.ID),k&&(P&&this.collisionIndex.insertCollisionCircles(k.circles,s.get("text-ignore-placement"),i.bucketInstanceId,B,m.ID),r)){const t=i.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new Se);for(let n=0;n<k.circles.length;n+=4)e.circles.push(k.circles[n+0]),e.circles.push(k.circles[n+1]),e.circles.push(k.circles[n+2]),e.circles.push(k.collisionDetected?1:0)}const q="globe"!==i.projection.name;S=S&&(q||!A),T=T&&(q||!D),this.placements[E]=new Ee(P||S,O||T,I||i.justReloaded),n.add(E)};if(E){const t=i.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];R(i.symbolInstances.get(n),n,i.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)R(i.symbolInstances.get(t),t,i.collisionArrays[t]);if(r&&i.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[i.bucketInstanceId];t.invert(e.invProjMatrix,a),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}i.justReloaded=!1}markUsedJustification(e,n,r,o){const{leftJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:u}=r,c=t.getAnchorJustification(n),p=o===t.WritingMode.vertical?l:"left"===c?i:"center"===c?s:"right"===c?a:-1;i>=0&&(e.text.placedSymbolArray.get(i).crossTileID=p>=0&&i!==p?0:u),s>=0&&(e.text.placedSymbolArray.get(s).crossTileID=p>=0&&s!==p?0:u),a>=0&&(e.text.placedSymbolArray.get(a).crossTileID=p>=0&&a!==p?0:u),l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=p>=0&&l!==p?0:u)}markUsedOrientation(e,n,r){const o=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,i=n===t.WritingMode.vertical?n:0,{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:u}=r,c=e.text.placedSymbolArray;s>=0&&(c.get(s).placedOrientation=o),a>=0&&(c.get(a).placedOrientation=o),l>=0&&(c.get(l).placedOrientation=o),u>=0&&(c.get(u).placedOrientation=i)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const r=e?e.symbolFadeChange(t):1,o=e?e.opacities:{},i=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const a in this.placements){const t=this.placements[a],e=o[a];e?(this.opacities[a]=new xe(e,r,t.text,t.icon,null,t.clipped),n=n||t.text!==e.text.placed||t.icon!==e.icon.placed):(this.opacities[a]=new xe(null,r,t.text,t.icon,t.skipFade,t.clipped),n=n||t.text||t.icon)}for(const a in o){const t=o[a];if(!this.opacities[a]){const e=new xe(t,r,!1,!1);e.isHidden()||(this.opacities[a]=e,n=n||t.text.placed||t.icon.placed)}}for(const a in i)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=i[a]);for(const a in s)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=s[a]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n=new Set;for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,n,r.collisionBoxArray)}}updateBucketOpacities(e,n,r){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const o=e.layers[0].layout,i=!!e.layers[0].dynamicFilter(),s=new xe(null,0,!1,!1,!0),a=o.get("text-allow-overlap"),l=o.get("icon-allow-overlap"),u=o.get("text-variable-anchor"),c="map"===o.get("text-rotation-alignment"),p="map"===o.get("text-pitch-alignment"),h="none"!==o.get("icon-text-fit"),d=new xe(null,0,a&&(l||!e.hasIconData()||o.get("icon-optional")),l&&(a||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);const f=(t,e,n)=>{for(let r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)};let g=0;for(let m=0;m<e.symbolInstances.length;m++){const r=e.symbolInstances.get(m),{numHorizontalGlyphVertices:o,numVerticalGlyphVertices:a,crossTileID:l,numIconVertices:y}=r,v=n.has(l);let _=this.opacities[l];v?_=s:_||(_=d,this.opacities[l]=_),n.add(l);const w=o>0||a>0,C=y>0,b=this.placedOrientations[l],x=b===t.WritingMode.vertical,E=b===t.WritingMode.horizontal||b===t.WritingMode.horizontalOnly;if(!w&&!C||_.isHidden()||g++,w){const t=Be(_.text);f(e.text,o,x?Ve:t),f(e.text,a,E?Ve:t);const n=_.text.isHidden(),{leftJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:c}=r,p=e.text.placedSymbolArray,h=n||x?1:0;i>=0&&(p.get(i).hidden=h),s>=0&&(p.get(s).hidden=h),u>=0&&(p.get(u).hidden=h),c>=0&&(p.get(c).hidden=n||E?1:0);const d=this.variableOffsets[l];d&&this.markUsedJustification(e,d.anchor,r,b);const g=this.placedOrientations[l];g&&(this.markUsedJustification(e,"left",r,g),this.markUsedOrientation(e,g,r))}if(C){const t=Be(_.icon),{placedIconSymbolIndex:n,verticalPlacedIconSymbolIndex:o}=r,i=e.icon.placedSymbolArray,s=_.icon.isHidden()?1:0;n>=0&&(f(e.icon,y,x?Ve:t),i.get(n).hidden=s),o>=0&&(f(e.icon,r.numVerticalIconVertices,E?Ve:t),i.get(o).hidden=s)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[m];if(n){let r=new t.Point(0,0),o=!0;if(n.textBox||n.verticalTextBox){if(u){const t=this.variableOffsets[l];t?(r=Pe(t.anchor,t.width,t.height,t.textOffset,t.textScale),c&&r._rotate(p?this.transform.angle:-this.transform.angle)):o=!1}i&&(o=!_.clipped),n.textBox&&Ae(e.textCollisionBox.collisionVertexArray,_.text.placed,!o||x,r.x,r.y),n.verticalTextBox&&Ae(e.textCollisionBox.collisionVertexArray,_.text.placed,!o||E,r.x,r.y)}const s=o&&Boolean(!E&&n.verticalIconBox);n.iconBox&&Ae(e.iconCollisionBox.collisionVertexArray,_.icon.placed,s,h?r.x:0,h?r.y:0),n.verticalIconBox&&Ae(e.iconCollisionBox.collisionVertexArray,_.icon.placed,!s,h?r.x:0,h?r.y:0)}}}if(e.fullyClipped=0===g,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function Ae(t,e,n,r,o){t.emplaceBack(e?1:0,n?1:0,r||0,o||0),t.emplaceBack(e?1:0,n?1:0,r||0,o||0),t.emplaceBack(e?1:0,n?1:0,r||0,o||0),t.emplaceBack(e?1:0,n?1:0,r||0,o||0)}const De=Math.pow(2,25),Me=Math.pow(2,24),Le=Math.pow(2,17),Ne=Math.pow(2,16),Fe=Math.pow(2,9),ke=Math.pow(2,8),Ge=Math.pow(2,1);function Be(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*De+e*Me+n*Le+e*Ne+n*Fe+e*ke+n*Ge+e}const Ve=0;class ze{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,e,n,r,o){const i=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(i,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,o())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,i.sort((t,e)=>t.sortKey-e.sortKey));this._currentPartIndex<i.length;){const t=i[this._currentPartIndex];if(e.placeLayerBucketPart(t,this._seenCrossTileIDs,n,0===t.symbolInstanceStart),this._currentPartIndex++,o())return!0}return!1}}class je{constructor(t,e,n,r,o,i,s,a){this.placement=new Ie(t,o,i,s,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(e,n,r){const o=t.exported.now(),i=()=>{const e=t.exported.now()-o;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=n[e[this._currentPlacementIndex]],o=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=o)&&(!t.maxzoom||t.maxzoom>o)){if(this._inProgressLayer||(this._inProgressLayer=new ze(t)),this._inProgressLayer.continuePlacement(r[t.source],this.placement,this._showCollisionBoxes,t,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const He=512/t.EXTENT/2;class Ue{constructor(e,n,r){this.tileID=e,this.bucketInstanceId=r,this.index=new t.KDBush(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const o=e.canonical.x*t.EXTENT,i=e.canonical.y*t.EXTENT;for(let t=0;t<n.length;t++){const{key:e,crossTileID:r,tileAnchorX:s,tileAnchorY:a}=n.get(t),l=Math.floor((o+s)*He),u=Math.floor((i+a)*He);this.index.add(l,u),this.keys.push(e),this.crossTileIDs.push(r)}this.index.finish()}findMatches(e,n,r){const o=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),i=He/Math.pow(2,n.canonical.z-this.tileID.canonical.z),s=n.canonical.x*t.EXTENT,a=n.canonical.y*t.EXTENT;for(let t=0;t<e.length;t++){const n=e.get(t);if(n.crossTileID)continue;const{key:l,tileAnchorX:u,tileAnchorY:c}=n,p=Math.floor((s+u)*i),h=Math.floor((a+c)*i),d=this.index.range(p-o,h-o,p+o,h+o);for(const t of d){const e=this.crossTileIDs[t];if(this.keys[t]===l&&!r.has(e)){r.add(e),n.crossTileID=e;break}}}}}class We{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qe{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const n in this.indexes){const t=this.indexes[n],r={};for(const n in t){const o=t[n];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+e),r[o.tileID.key]=o}this.indexes[n]=r}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let o=0;o<e.symbolInstances.length;o++)e.symbolInstances.get(o).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const r=this.usedCrossTileIDs[t.overscaledZ];for(const o in this.indexes){const n=this.indexes[o];if(Number(o)>t.overscaledZ)for(const o in n){const i=n[o];i.tileID.isChildOf(t)&&i.findMatches(e.symbolInstances,t,r)}else{const i=n[t.scaledTo(Number(o)).key];i&&i.findMatches(e.symbolInstances,t,r)}}for(let o=0;o<e.symbolInstances.length;o++){const t=e.symbolInstances.get(o);t.crossTileID||(t.crossTileID=n.generate(),r.add(t.crossTileID))}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ue(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n of e.crossTileIDs)this.usedCrossTileIDs[t].delete(n)}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const r=this.indexes[n];for(const o in r)t[r[o].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[o]),delete r[o],e=!0)}return e}}class Xe{constructor(){this.layerIndexes={},this.crossTileIDs=new We,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n,r){let o=this.layerIndexes[t.id];void 0===o&&(o=this.layerIndexes[t.id]=new qe);let i=!1;const s={};"globe"!==r.name&&o.handleWrapJump(n);for(const a of e){const e=a.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),o.addBucket(a.tileID,e,this.crossTileIDs)&&(i=!0),s[e.bucketInstanceId]=!0)}return o.removeStaleBuckets(s)&&(i=!0),i}pruneUnusedLayers(t){const e={};t.forEach(t=>{e[t]=!0});for(const n in this.layerIndexes)e[n]||delete this.layerIndexes[n]}}const Ke=(e,n)=>t.emitValidationErrors(e,n&&n.filter(t=>"source.canvas"!==t.identifier)),Ye=t.pick(jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ze=t.pick(jt,["setCenter","setZoom","setBearing","setPitch"]),Qe={version:8,layers:[],sources:{}},Je={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class $e extends t.Evented{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.map=e,this.dispatcher=new O(Bt(),this),this.imageManager=new w,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,n.localFontFamily?t.LocalGlyphMode.all:n.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,n.localFontFamily||n.localIdeographFontFamily),this.crossTileSymbolIndex=new Xe,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const r=this;this._rtlTextPluginCallback=$e.registerForPluginStateChange(e=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(e,n)=>{if(t.triggerPluginCompletionEvent(e),n&&n.every(t=>t))for(const t in r._sourceCaches){const e=r._sourceCaches[t],n=e.getSource().type;"vector"!==n&&"geojson"!==n||e.reload()}})}),this.on("data",t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const n in this._layers){const t=this._layers[n];t.source===e.id&&this._validateLayer(t)}})}loadURL(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new t.Event("dataloading",{dataType:"style"}));const r="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);const o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(e,n)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):n&&this._load(n,r)})}loadJSON(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(e,!1!==n.validate)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Qe,!1)}_updateLayerCount(t,e){const n=e?1:-1;t.is3D()&&(this._num3DLayers+=n),"circle"===t.type&&(this._numCircleLayers+=n),"symbol"===t.type&&(this._numSymbolLayers+=n)}_load(e,n){if(n&&Ke(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=t.clone$1(e),this._updateMapProjection();for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const r=zt(this.stylesheet.layers);this._order=r.map(t=>t.id),this._layers={},this._serializedLayers={};for(const o of r){const e=t.createStyleLayer(o);e.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=e,this._serializedLayers[e.id]=e.serialize(),this._updateLayerCount(e,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new b(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(e){this._spriteRequest=function(e,n,r){let o,i,s;const a=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,a,".json"),t.ResourceType.SpriteJSON),(t,e)=>{l=null,s||(s=t,o=e,c())}),u=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,a,".png"),t.ResourceType.SpriteImage),(t,e)=>{u=null,s||(s=t,i=e,c())});function c(){if(s)r(s);else if(o&&i){const e=t.exported.getImageData(i),n={};for(const r in o){const{width:i,height:s,x:a,y:l,sdf:u,pixelRatio:c,stretchX:p,stretchY:h,content:d}=o[r],f=new t.RGBAImage({width:i,height:s});t.RGBAImage.copy(e,f,{x:a,y:l},{x:0,y:0},{width:i,height:s}),n[r]={data:f,pixelRatio:c,sdf:u,stretchX:p,stretchY:h,content:d}}r(null,n)}}return{cancel(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e,this.map._requestManager,(e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(n)for(const t in n)this.imageManager.addImage(t,n[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(e){const n=this.getSource(e.source);if(!n)return;const r=e.sourceLayer;r&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'.concat(r,'" does not exist on source "').concat(n.id,'" as specified by style layer "').concat(e.id,'"'))))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&("function"==typeof t.isLayerDraped?t.isLayerDraped():Je[t.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;const n=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];"reload"===t?this._reloadSource(e):"clear"===t&&this._clearSource(e)}this._updateTilesForChangedImages();for(const r in this._updatedPaintProps)this._layers[r].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const r={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];r[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];if(n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)){const t=this._getLayerSourceCache(n);t&&(t.used=!0)}const r=this.map.painter;if(r){const t=n.getProgramIds();if(!t)continue;const o=n.getProgramConfiguration(e.zoom);for(const e of t)r.useProgram(e,o)}}for(const o in r){const e=this._sourceCaches[o];r[o]!==e.used&&e.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:e.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),Ke(this,t.validateStyle(n)))return!1;(n=t.clone$1(n)).layers=zt(n.layers);const r=function(t,n){if(!t)return[{command:jt.setStyle,args:[n]}];let r=[];try{if(!e(t.version,n.version))return[{command:jt.setStyle,args:[n]}];e(t.center,n.center)||r.push({command:jt.setCenter,args:[n.center]}),e(t.zoom,n.zoom)||r.push({command:jt.setZoom,args:[n.zoom]}),e(t.bearing,n.bearing)||r.push({command:jt.setBearing,args:[n.bearing]}),e(t.pitch,n.pitch)||r.push({command:jt.setPitch,args:[n.pitch]}),e(t.sprite,n.sprite)||r.push({command:jt.setSprite,args:[n.sprite]}),e(t.glyphs,n.glyphs)||r.push({command:jt.setGlyphs,args:[n.glyphs]}),e(t.transition,n.transition)||r.push({command:jt.setTransition,args:[n.transition]}),e(t.light,n.light)||r.push({command:jt.setLight,args:[n.light]}),e(t.fog,n.fog)||r.push({command:jt.setFog,args:[n.fog]}),e(t.projection,n.projection)||r.push({command:jt.setProjection,args:[n.projection]});const o={},i=[];!function(t,n,r,o){let i;for(i in n=n||{},t=t||{})t.hasOwnProperty(i)&&(n.hasOwnProperty(i)||Ut(i,r,o));for(i in n){if(!n.hasOwnProperty(i))continue;const s=n[i];t.hasOwnProperty(i)?e(t[i],s)||("geojson"===t[i].type&&"geojson"===s.type&&qt(t,n,i)?r.push({command:jt.setGeoJSONSourceData,args:[i,s.data]}):Wt(i,n,r,o)):Ht(i,n,r)}}(t.sources,n.sources,i,o);const s=[];t.layers&&t.layers.forEach(t=>{t.source&&o[t.source]?r.push({command:jt.removeLayer,args:[t.id]}):s.push(t)});let a=t.terrain;a&&o[a.source]&&(r.push({command:jt.setTerrain,args:[void 0]}),a=void 0),r=r.concat(i),e(a,n.terrain)||r.push({command:jt.setTerrain,args:[n.terrain]}),function(t,n,r){n=n||[];const o=(t=t||[]).map(Kt),i=n.map(Kt),s=t.reduce(Yt,{}),a=n.reduce(Yt,{}),l=o.slice(),u=Object.create(null);let c,p,h,d,f,g,m;for(c=0,p=0;c<o.length;c++)h=o[c],a.hasOwnProperty(h)?p++:(r.push({command:jt.removeLayer,args:[h]}),l.splice(l.indexOf(h,p),1));for(c=0,p=0;c<i.length;c++)h=i[i.length-1-c],l[l.length-1-c]!==h&&(s.hasOwnProperty(h)?(r.push({command:jt.removeLayer,args:[h]}),l.splice(l.lastIndexOf(h,l.length-p),1)):p++,g=l[l.length-c],r.push({command:jt.addLayer,args:[a[h],g]}),l.splice(l.length-c,0,h),u[h]=!0);for(c=0;c<i.length;c++)if(h=i[c],d=s[h],f=a[h],!u[h]&&!e(d,f))if(e(d.source,f.source)&&e(d["source-layer"],f["source-layer"])&&e(d.type,f.type)){for(m in Xt(d.layout,f.layout,r,h,null,jt.setLayoutProperty),Xt(d.paint,f.paint,r,h,null,jt.setPaintProperty),e(d.filter,f.filter)||r.push({command:jt.setFilter,args:[h,f.filter]}),e(d.minzoom,f.minzoom)&&e(d.maxzoom,f.maxzoom)||r.push({command:jt.setLayerZoomRange,args:[h,f.minzoom,f.maxzoom]}),d)d.hasOwnProperty(m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Xt(d[m],f[m],r,h,m.slice(6),jt.setPaintProperty):e(d[m],f[m])||r.push({command:jt.setLayerProperty,args:[h,m,f[m]]}));for(m in f)f.hasOwnProperty(m)&&!d.hasOwnProperty(m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Xt(d[m],f[m],r,h,m.slice(6),jt.setPaintProperty):e(d[m],f[m])||r.push({command:jt.setLayerProperty,args:[h,m,f[m]]}))}else r.push({command:jt.removeLayer,args:[h]}),g=l[l.lastIndexOf(h)+1],r.push({command:jt.addLayer,args:[f,g]})}(s,n.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:jt.setStyle,args:[n]}]}return r}(this.serialize(),n).filter(t=>!(t.command in Ze));if(0===r.length)return!1;const o=r.filter(t=>!(t.command in Ye));if(o.length>0)throw new Error("Unimplemented: ".concat(o.map(t=>t.command).join(", "),"."));return r.forEach(t=>{"setTransition"!==t.command&&"setProjection"!==t.command&&this[t.command].apply(this,t.args)}),this.stylesheet=n,this._updateMapProjection(),!0}addImage(e,n){return this.getImage(e)?this.fire(new t.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,n),this._afterImageUpdated(e),this)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e),this._afterImageUpdated(e),this):this.fire(new t.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getSource(e))throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateSource,"sources.".concat(e),n,null,r))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const o=It(e,n,this.dispatcher,this);o.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(e),source:o.serialize(),sourceId:e}));const i=n=>{const r=(n?"symbol:":"other:")+e,i=this._sourceCaches[r]=new t.SourceCache(r,o,n);(n?this._symbolSourceCaches:this._otherSourceCaches)[e]=i,i.style=this,i.onAdd(this.map)};i(!1),"vector"!==n.type&&"geojson"!==n.type||i(!0),o.onAdd&&o.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const n=this.getSource(e);if(!n)throw new Error("There is no source with this ID");for(const o in this._layers)if(this._layers[o].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(o,'" is using it.'))));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(new Error('Source "'.concat(e,'" cannot be removed while terrain is using it.'))));const r=this._getSourceCaches(e);for(const o of r)delete this._sourceCaches[o.id],delete this._updatedSources[o.id],o.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o.getSource().id})),o.setEventedParent(null),o.clearTiles();return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}_getSources(){const t=[];for(const e in this._otherSourceCaches){const n=this._getSourceCache(e);n&&t.push(n.getSource())}return t}addLayer(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const o=e.id;if(this.getLayer(o))return void this.fire(new t.ErrorEvent(new Error('Layer with id "'.concat(o,'" already exists on this map'))));let i;if("custom"===e.type){if(Ke(this,t.validateCustomStyleLayer(e)))return;i=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(o,e.source),e=t.clone$1(e),e=t.extend(e,{source:o})),this._validate(t.validateLayer,"layers.".concat(o),e,{arrayIndex:-1},r))return;i=t.createStyleLayer(e),this._validateLayer(i),i.setEventedParent(this,{layer:{id:o}}),this._serializedLayers[i.id]=i.serialize(),this._updateLayerCount(i,!0)}const s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)return void this.fire(new t.ErrorEvent(new Error('Layer with id "'.concat(n,'" does not exist on this map.'))));this._order.splice(s,0,o),this._layerOrderChanged=!0,this._layers[o]=i;const a=this._getLayerSourceCache(i);if(this._removedLayers[o]&&i.source&&a&&"custom"!==i.type){const t=this._removedLayers[o];delete this._removedLayers[o],t.type!==i.type?this._updatedSources[i.source]="clear":(this._updatedSources[i.source]="reload",a.pause())}this._updateLayer(i),i.onAdd&&i.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));if(e===n)return;const r=this._order.indexOf(e);this._order.splice(r,1);const o=n?this._order.indexOf(n):this._order.length;n&&-1===o?this.fire(new t.ErrorEvent(new Error('Layer with id "'.concat(n,'" does not exist on this map.')))):(this._order.splice(o,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be removed."))));n.setEventedParent(null),this._updateLayerCount(n,!1);const r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(e,n,r){this._checkLoaded();const o=this.getLayer(e);o?o.minzoom===n&&o.maxzoom===r||(null!=n&&(o.minzoom=n),null!=r&&(o.maxzoom=r),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot have zoom extent."))))}setFilter(n,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=this.getLayer(n);if(i){if(!e(i.filter,r))return null==r?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateFilter,"layers.".concat(i.id,".filter"),r,{layerType:i.type},o)||(i.filter=t.clone$1(r),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be filtered."))))}getFilter(e){const n=this.getLayer(e);return n&&t.clone$1(n.filter)}setLayoutProperty(n,r,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const s=this.getLayer(n);s?e(s.getLayoutProperty(r),o)||(s.setLayoutProperty(r,o,i),this._updateLayer(s)):this.fire(new t.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be styled."))))}getLayoutProperty(e,n){const r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style."))))}setPaintProperty(n,r,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const s=this.getLayer(n);s?e(s.getPaintProperty(r),o)||(s.setPaintProperty(r,o,i)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new t.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be styled."))))}getPaintProperty(t,e){const n=this.getLayer(t);return n&&n.getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const r=e.source,o=e.sourceLayer,i=this.getSource(r);if(!i)return void this.fire(new t.ErrorEvent(new Error("The source '".concat(r,"' does not exist in the map's style."))));const s=i.type;if("geojson"===s&&o)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!o)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(r);for(const t of a)t.setFeatureState(o,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const r=e.source,o=this.getSource(r);if(!o)return void this.fire(new t.ErrorEvent(new Error("The source '".concat(r,"' does not exist in the map's style."))));const i=o.type,s="vector"===i?e.sourceLayer:void 0;if("vector"===i&&!s)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(r);for(const t of a)t.removeFeatureState(s,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,r=e.sourceLayer,o=this.getSource(n);if(o){if("vector"!==o.type||r)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(r,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const n=this._sourceCaches[t].getSource();e[n.id]||(e[n.id]=n.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:e,layers:this._serializeLayers(this._order)},t=>void 0!==t)}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},r=[];for(let i=this._order.length-1;i>=0;i--){const o=this._order[i];if(e(o)){n[o]=i;for(const e of t){const t=e[o];if(t)for(const e of t)r.push(e)}}}r.sort((t,e)=>e.intersectionZ-t.intersectionZ);const o=[];for(let i=this._order.length-1;i>=0;i--){const s=this._order[i];if(e(s))for(let t=r.length-1;t>=0;t--){const e=r[t].feature;if(n[e.layer.id]<i)break;o.push(e),r.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)o.push(e.feature)}}return o}queryRenderedFeatures(e,n,r){n&&n.filter&&this._validate(t.validateFilter,"queryRenderedFeatures.filter",n.filter,null,n);const o={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be queried for features.")))),[];o[n.source]=!0}}const i=[];n.availableImages=this._availableImages;const s=n&&n.layers?n.layers.some(t=>{const e=this.getLayer(t);return e&&e.is3D()}):this.has3DLayers(),a=A.createFromScreenPoints(e,r);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;n.layers&&!o[e]||i.push(Dt(this._sourceCaches[t],this._layers,this._serializedLayers,a,n,r,s,!!this.map._showQueryGeometry))}return this.placement&&i.push(function(t,e,n,r,o,i,s){const a={},l=i.queryRenderedSymbols(r),u=[];for(const c of Object.keys(l).map(Number))u.push(s[c]);u.sort(Lt);for(const c of u){const n=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],e,c.bucketIndex,c.sourceLayerIndex,o.filter,o.layers,o.availableImages,t);for(const t in n){const e=a[t]=a[t]||[],r=n[t];r.sort((t,e)=>{const n=c.featureSortOrder;if(n){const r=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-r}return e.featureIndex-t.featureIndex});for(const t of r)e.push(t)}}for(const c in a)a[c].forEach(e=>{const r=e.feature,o=n(t[c]);if(!o)return;const i=o.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=i});return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(i)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.validateFilter,"querySourceFeatures.filter",n.filter,null,n);const r=this._getSourceCaches(e);let o=[];for(const t of r)o=o.concat(Mt(t,n));return o}addSourceType(t,e,n){return $e.getSourceType(t)?n(new Error('A source type called "'.concat(t,'" already exists.'))):($e.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const r=this.light.getLight();let o=!1;for(const s in t)if(!e(t[s],r[s])){o=!0;break}if(!o)return;const i=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(t,n),this.light.updateTransitions(i)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let o=n;if(1===r){if("object"==typeof o.source){const e="terrain-dem-src";this.addSource(e,o.source),o=t.clone$1(o),o=t.extend(o,{source:e})}if(this._validate(t.validateTerrain,"terrain",o))return}if(!this.terrain||this.terrain&&r!==this.terrain.drapeRenderMode){if(!o)return;this._createTerrain(o,r)}else{const n=this.terrain,r=n.get();for(const e of Object.keys(t.spec.terrain))!o.hasOwnProperty(e)&&t.spec.terrain[e].default&&(o[e]=t.spec.terrain[e].default);for(const t in o)if(!e(o[t],r[t])){n.set(o),this.stylesheet.terrain=o;const t=this._setTransitionParameters({duration:0});n.updateTransitions(t);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const e=this.fog=new P(t,this.map.transform);this.stylesheet.fog=t;const n=this._setTransitionParameters({duration:0});e.updateTransitions(n)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog,r=n.get();0===Object.keys(t).length&&n.set(t);for(const o in t)if(!e(t[o],r[o])){n.set(t),this.stylesheet.fog=t;const e=this._setTransitionParameters({duration:0});n.updateTransitions(e);break}}else this._createFog(t);this._markersNeedUpdate=!0}_setTransitionParameters(e){return{now:t.exported.now(),transition:t.extend(e,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(t=>this.isLayerDraped(this._layers[t])),e=this._order.filter(t=>!this.isLayerDraped(this._layers[t]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(t,e){const n=this.terrain=new E(t,e);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const r=this._setTransitionParameters({duration:0});n.updateTransitions(r)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"symbol"===e.type&&this._updateLayer(e)}}_validate(e,n,r,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!i||!1!==i.validate)&&Ke(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.spec},o)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const e=this._getSourceCaches(t);for(const n of e)n.clearTiles()}_reloadSource(t){const e=this._getSourceCaches(t);for(const n of e)n.resume(),n.reload()}_reloadSources(){for(const t of this._getSources())t.reload&&t.reload()}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,n,r,o){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=!1,a=!1;const l={};for(const t of this._order){const n=this._layers[t];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this._getLayerSourceCache(n);if(!t)continue;l[n.source]=t.getRenderableIds(!0).map(e=>t.getTileByID(e)).sort((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1))}const r=this.crossTileSymbolIndex.addLayer(n,l[n.source],e.center.lng,e.projection);s=s||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),i=i||this._layerOrderChanged||0===r,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(i||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new je(e,this._order,i,n,r,o,this.placement,this.fog&&e.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),a=!0),s&&this.pauseablePlacement.placement.setStale()),a||s)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();const r=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};r(this._otherSourceCaches[e.source]),r(this._symbolSourceCaches[e.source])}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}getResource(e,n,r){return t.makeRequest(n,r)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}_isSourceCacheLoaded(e){const n=this._getSourceCaches(e);return 0===n.length?(this.fire(new t.ErrorEvent(new Error("There is no source with ID '".concat(e,"'")))),!1):n.every(t=>t.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}$e.getSourceType=function(t){return Ot[t]},$e.setSourceType=function(t,e){Ot[t]=e},$e.registerForPluginStateChange=t.registerForPluginStateChange;var tn="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",en="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",nn="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",rn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",on="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let sn={},an={};const ln=[];dn(tn,ln),dn(nn,ln),dn(rn,ln),dn(on,ln),sn=fn("",nn),an=fn(on,rn);const un=fn("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),cn=tn,pn="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var hn={background:fn("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:fn("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:fn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:fn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:fn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:fn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:fn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:fn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:fn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:fn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:fn("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:fn("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:fn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:fn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:fn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:fn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:fn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:fn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:fn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:fn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:fn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:fn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",en),skyboxGradient:fn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",en),skyboxCapture:fn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:fn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:fn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function dn(t,e){const n=t.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let r of n)if(r=r.trim(),"#"===r[0]&&r.includes("if")&&!r.includes("endif")){r=r.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const t=r.split(" ");for(const n of t)e.includes(n)||e.push(n)}}function fn(t,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),o={},i=[...ln];return dn(t,i),dn(e,i),{fragmentSource:t=t.replace(n,(t,e,n,r,i)=>(o[i]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nvarying ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"))),vertexSource:e=e.replace(n,(t,e,n,r,i)=>{const s="float"===r?"vec2":"vec4",a=i.match(/color/)?"color":s;return o[i]?"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(s," a_").concat(i,";\nvarying ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = unpack_mix_").concat(a,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(s," a_").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = unpack_mix_").concat(a,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n")}),staticAttributes:r,usedDefines:i}}class gn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,e,n,r,o,i,s){this.context=t;let a=this.boundPaintVertexBuffers.length!==r.length;for(let u=0;!a&&u<r.length;u++)this.boundPaintVertexBuffers[u]!==r[u]&&(a=!0);let l=this.boundDynamicVertexBuffers.length!==s.length;for(let u=0;!l&&u<s.length;u++)this.boundDynamicVertexBuffers[u]!==s[u]&&(l=!0);if(!t.extVertexArrayObject||!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||a||l||this.boundIndexBuffer!==o||this.boundVertexOffset!==i)this.freshBind(e,n,r,o,i,s);else{t.bindVertexArrayOES.set(this.vao);for(const t of s)t&&t.bind();o&&o.dynamicDraw&&o.bind()}}freshBind(t,e,n,r,o,i){let s;const a=t.numAttributes,l=this.context,u=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=o,this.boundDynamicVertexBuffers=i;else{s=l.currentNumAttributes||0;for(let t=a;t<s;t++)u.disableVertexAttribArray(t)}e.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,o);for(const c of n)c.enableAttributes(u,t),c.bind(),c.setVertexAttribPointers(u,t,o);for(const c of i)c&&(c.enableAttributes(u,t),c.bind(),c.setVertexAttribPointers(u,t,o));r&&r.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function mn(e,n){const r=Math.pow(2,n.canonical.z),o=n.canonical.y;return[new t.MercatorCoordinate(0,o/r).toLngLat().lat,new t.MercatorCoordinate(0,(o+1)/r).toLngLat().lat]}function yn(e,n,r,o,i,s,a){const l=e.context,u=l.gl,c=r.fbo;if(!c)return;e.prepareDrawTile();const p=e.useProgram("hillshade");l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());const h=((t,e,n,r)=>{const o=n.paint.get("hillshade-shadow-color"),i=n.paint.get("hillshade-highlight-color"),s=n.paint.get("hillshade-accent-color");let a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);const l=!t.options.moving;return{u_matrix:r||t.transform.calculateProjMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:mn(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:o,u_highlight:i,u_accent:s}})(e,r,o,e.terrain?n.projMatrix:null);e.prepareDrawProgram(l,p,n.toUnwrapped());const{tileBoundsBuffer:d,tileBoundsIndexBuffer:f,tileBoundsSegments:g}=e.getTileBoundsBuffers(r);p.draw(l,u.TRIANGLES,i,s,a,t.CullFaceMode.disabled,h,o.id,d,f,g)}function vn(e,n,r){if(!n.needsDEMTextureUpload)return;const o=e.context,i=o.gl;o.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(r.stride);const s=r.getPixels();n.demTexture?n.demTexture.update(s,{premultiply:!1}):n.demTexture=new t.Texture(o,s,i.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function _n(e,n,r,o,i,s){const a=e.context,l=a.gl;if(!n.dem)return;const u=n.dem;if(a.activeTexture.set(l.TEXTURE1),vn(e,n,u),!n.demTexture)return;n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const c=u.dim;a.activeTexture.set(l.TEXTURE0);let p=n.fbo;if(!p){const e=new t.Texture(a,{width:c,height:c,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=n.fbo=a.createFramebuffer(c,c,!0),p.colorAttachment.set(e.texture)}a.bindFramebuffer.set(p.framebuffer),a.viewport.set([0,0,c,c]);const{tileBoundsBuffer:h,tileBoundsIndexBuffer:d,tileBoundsSegments:f}=e.getMercatorTileBoundsBuffers();e.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,o,i,s,t.CullFaceMode.disabled,((e,n)=>{const r=n.stride,o=t.create();return t.ortho(o,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(o,o,[0,-t.EXTENT,0]),{u_matrix:o,u_image:1,u_dimension:[r,r],u_zoom:e.overscaledZ,u_unpack:n.unpackVector}})(n.tileID,u),r.id,h,d,f),n.needsHillshadePrepare=!1}const wn=e=>({u_matrix:new t.UniformMatrix4f(e),u_image0:new t.Uniform1i(e),u_skirt_height:new t.Uniform1f(e)}),Cn=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),bn=(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f)=>({u_proj_matrix:Float32Array.from(t),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(r),u_merc_matrix:n,u_zoom_transition:o,u_merc_center:i,u_image0:0,u_frustum_tl:s,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:u,u_globe_pos:c,u_globe_radius:p,u_viewport:h,u_grid_matrix:f?Float32Array.from(f):new Float32Array(9),u_skirt_height:d});function xn(t,e){return null!=t&&null!=e&&!(!t.hasData()||!e.hasData())&&null!=t.demTexture&&null!=e.demTexture&&t.tileID.key!==e.tileID.key}const En=new class{constructor(){this.operations={}}newMorphing(t,e,n,r,o){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==n.tileID.key&&(e.queued=n)}else this.operations[t]={startTime:r,phase:0,duration:o,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},Sn={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Tn(t){return 6*Math.pow(1.5,22-t)}function Rn(t,e){const n=1<<t.z;return!e&&(0===t.x||t.x===n-1)||0===t.y||t.y===n-1}const Pn=t=>({u_matrix:t});function On(e,n,r,o,i){if(i>0){const s=t.exported.now(),a=(s-e.timeAdded)/i,l=n?(s-n.timeAdded)/i:-1,u=r.getSource(),c=o.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-c)>Math.abs(e.tileID.overscaledZ-c),h=p&&e.refreshedUponExpiration?1:t.clamp(p?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}class In extends t.SourceCache{constructor(t){const e={type:"raster-dem",maxzoom:t.transform.maxZoom},n=new O(Bt(),null),r=It("mock-dem",e,n,t.style);super("mock-dem",r,!1),r.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,e){t.state="loaded",e(null)}}class An extends t.SourceCache{constructor(t){const e=It("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new O(Bt(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,r){if(e.freezeTileCoverage)return;this.transform=e;const o=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((n,r)=>{if(n[r.key]="",!this._tiles[r.key]){const n=new t.Tile(r,this._source.tileSize*r.overscaleFactor(),e.tileZoom);n.state="loaded",this._tiles[r.key]=n}return n},{});for(const t in this._tiles)t in o||(this.freeFBO(t),this._tiles[t].unloadVectorData(),delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const n=Object.values(e);this.renderCachePool.push(...n),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Dn extends t.OverscaledTileID{constructor(t,e,n){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=n}}class Mn extends t.Elevation{constructor(e,n){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[r,o,i]=function(e){const n=new t.StructArrayLayout2i4,r=new t.StructArrayLayout3ui6,o=131;n.reserve(17161),r.reserve(33800);const i=t.EXTENT/128,s=t.EXTENT+i/2,a=s+i;for(let u=-i;u<a;u+=i)for(let e=-i;e<a;e+=i){const r=e<0||e>s||u<0||u>s?24575:0,o=t.clamp(Math.round(e),0,t.EXTENT),i=t.clamp(Math.round(u),0,t.EXTENT);n.emplaceBack(o+r,i)}const l=(t,e)=>{const n=e*o+t;r.emplaceBack(n+1,n,n+o),r.emplaceBack(n+o,n+o+1,n+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach(t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)}),[n,r,32768]}(),s=e.context;this.gridBuffer=s.createVertexBuffer(r,t.posAttributes.members),this.gridIndexBuffer=s.createIndexBuffer(o),this.gridSegments=t.SegmentVector.simpleSegment(0,0,r.length,o.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,r.length,i),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new An(n.map),this.orthoMatrix=t.create(),t.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,t.EXTENT,0,t.EXTENT,0,1);const a=s.gl;this._overlapStencilMode=new t.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new In(n.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(e,n,r){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const o=e.terrain.properties;this.sourceCache=0===e.terrain.drapeRenderMode?this._mockSourceCache:e._getSourceCache(o.get("source")),this._exaggeration=o.get("exaggeration");const i=()=>{this.sourceCache.used&&t.warnOnce("Raster DEM source '".concat(this.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));const e=this.getScaledDemTileSize();this.sourceCache.update(n,e,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,i(),this._initializing=!0),i(),n.updateElevation(!0,r),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce("Terrain render cache efficiency is not optimal (".concat(e.efficiency,"%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(e.firstUndrapedLayer,"' or create a map using optimizeForTerrain: true option."))}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=0===r._centerAltitude&&-1===this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(r.center),-1),this._emptyDEMTextureDirty=!this._initializing);const o=this.proxyCoords=n.getIds().map(t=>{const e=n.getTileByID(t).tileID;return e.projMatrix=r.calculateProjMatrix(e.toUnwrapped()),e});!function(e,n){const r=n.transform.pointCoordinate(n.transform.getCameraPoint()),o=new t.Point(r.x,r.y);e.sort((e,n)=>{if(n.overscaledZ-e.overscaledZ)return n.overscaledZ-e.overscaledZ;const r=new t.Point(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),i=new t.Point(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),s=o.mult(1<<e.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(r)-s.distSqr(i)})}(o,this.painter),this._previousZoom=r.zoom;const i=this.proxyToSource||{};this.proxyToSource={},o.forEach(t=>{this.proxyToSource[t.key]={}}),this.terrainTileForTile={};const s=this._style._sourceCaches;for(const t in s){const n=s[t];if(!n.used)continue;if(n!==this.sourceCache&&this.resetTileLookupCache(n.id),this._setupProxiedCoordsForOrtho(n,e[t],i),n.usedForTerrain)continue;const r=e[t];n.getSource().reparseOverscaled&&this._assignTerrainTiles(r)}this.proxiedCoords[n.id]=o.map(t=>new Dn(t,t.key,this.orthoMatrix)),this._assignTerrainTiles(o),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(i),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const a={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const n=e.tileID.key;n in a||(this._visibleDemTiles.push(e),a[n]=n)}}_assignTerrainTiles(t){this._initializing||t.forEach(t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)})}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const n in this.terrainTileForTile){const r=this.terrainTileForTile[n],o=r.dem;!o||r.demTexture&&!r.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),vn(this.painter,r,o))}}_prepareDemTileUniforms(t,e,n,r){if(!e||null==e.demTexture)return!1;const o=t.tileID.canonical,i=Math.pow(2,e.tileID.canonical.z-o.z),s=r||"";return n["u_dem_tl".concat(s)]=[o.x*i%1,o.y*i%1],n["u_dem_scale".concat(s)]=i,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const e=this.painter.context,n=e.gl;if(!this._emptyDepthBufferTexture){const r=new t.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new t.Texture(e,r,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce((e,n)=>{if(!n.dem)return e;const r=n.dem.tree.minimums[0];return r>0&&t++,e+r},0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const r=this._getLoadedAreaMinimum(),o=new t.RGBAImage({width:1,height:1},new Uint8Array(t.DEMData.pack(r,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let i=this._emptyDEMTexture;return i?i.update(o,{premultiply:!1}):i=this._emptyDEMTexture=new t.Texture(e,o,n.RGBA,{premultiply:!1}),i}setupElevationDraw(e,n,r){const o=this.painter.context,i=o.gl,s=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();let l=null,u=null,c=1;if(r&&r.morphing&&this._useVertexMorphing){const t=r.morphing.srcDemTile,n=r.morphing.dstDemTile;c=r.morphing.phase,t&&n&&(this._prepareDemTileUniforms(e,t,s,"_prev")&&(u=t),this._prepareDemTileUniforms(e,n,s)&&(l=n))}if(u&&l?(o.activeTexture.set(i.TEXTURE2),l.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE,i.NEAREST),o.activeTexture.set(i.TEXTURE4),u.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE,i.NEAREST),s.u_dem_lerp=c):(l=this.terrainTileForTile[e.tileID.key],o.activeTexture.set(i.TEXTURE2),(this._prepareDemTileUniforms(e,l,s)?l.demTexture:this.emptyDEMTexture).bind(i.NEAREST,i.CLAMP_TO_EDGE)),o.activeTexture.set(i.TEXTURE3),r&&r.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE),this._depthFBO&&(s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE),s.u_depth_size_inv=[1,1]),r&&r.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=e}if(r&&r.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=r.labelPlaneMatrixInv),n.setTerrainUniformValues(o,s),"globe"===this.painter.transform.projection.name){const t=this.globeUniformValues(this.painter.transform,e.tileID.canonical,r&&r.useDenormalizedUpVectorScale);n.setGlobeUniformValues(o,t)}}globeUniformValues(e,n,r){const o=e.projection;return{u_tile_tl_up:o.upVector(n,0,0),u_tile_tr_up:o.upVector(n,t.EXTENT,0),u_tile_br_up:o.upVector(n,t.EXTENT,t.EXTENT),u_tile_bl_up:o.upVector(n,0,t.EXTENT),u_tile_up_scale:r?t.globeMetersToEcef(1):o.upVectorScale(n,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const n=this.painter,r=this.painter.context;0!==e.length&&(r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(e,n,r,o,i){if("globe"===e.transform.projection.name)!function(e,n,r,o,i){const s=e.context,a=s.gl;let l,u;const c=e.options.showTerrainWireframe?2:0,p=e.transform,h=t.globeUseCustomAntiAliasing(e,s,p),d=(t,n)=>{if(u===t)return;const r=[Sn[t],"PROJECTION_GLOBE_VIEW"];h&&r.push("CUSTOM_ANTIALIASING"),n&&r.push(Sn[c]),l=e.useProgram("globeRaster",null,r),u=t},f=e.colorModeForRenderPass(),g=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);En.update(i);const m=t.calculateGlobeMercatorMatrix(p),y=[t.mercatorXfromLng(p.center.lng),t.mercatorYfromLat(p.center.lat)],v=c?[!1,!0]:[!1],_=e.globeSharedBuffers,w=[p.width*t.exported.devicePixelRatio,p.height*t.exported.devicePixelRatio],C=Float32Array.from(p.globeMatrix),b={useDenormalizedUpVectorScale:!0};if(v.forEach(c=>{const p=e.transform,h=Tn(p.zoom)*n.exaggeration();u=-1;const v=c?a.LINES:a.TRIANGLES;for(const u of o){const o=r.getTile(u),x=t.StencilMode.disabled,E=n.prevTerrainTileForTile[u.key],S=n.terrainTileForTile[u.key];xn(E,S)&&En.newMorphing(u.key,E,S,i,250),s.activeTexture.set(a.TEXTURE0),o.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const T=En.getMorphValuesForProxy(u.key),R=T?1:0;T&&t.extend$1(b,{morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:t.easeCubicInOut(T.phase)}});const P=t.tileCornersToBounds(u.canonical),O=t.getLatitudinalLod(P.getCenter().lat),I=t.getGridMatrix(u.canonical,P,O,p.worldSize/p._pixelsPerMercatorPixel),A=t.globeNormalizeECEF(t.globeTileBounds(u.canonical)),D=bn(p.projMatrix,C,m,A,t.globeToMercatorTransition(p.zoom),y,p.frustumCorners.TL,p.frustumCorners.TR,p.frustumCorners.BR,p.frustumCorners.BL,p.globeCenterInViewSpace,p.globeRadius,w,h,I);if(d(R,c),n.setupElevationDraw(o,l,b),e.prepareDrawProgram(s,l,u.toUnwrapped()),_){const[n,r,o]=c?_.getWirefameBuffers(e.context,O):_.getGridBuffers(O,0!==h);l.draw(s,v,g,x,f,t.CullFaceMode.backCCW,D,"globe_raster",n,r,o)}}}),_){const i=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&i.push("CUSTOM_ANTIALIASING"),l=e.useProgram("globeRaster",null,i);for(const u of o){const{x:o,y:i,z:c}=u.canonical,h=0===i,d=i===(1<<c)-1,[m,v,C,x]=_.getPoleBuffers(c);if(x&&(h||d)){const i=r.getTile(u);s.activeTexture.set(a.TEXTURE0),i.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let _=t.globePoleMatrixForTile(c,o,p);const E=t.globeNormalizeECEF(t.globeTileBounds(u.canonical)),S=(e,n)=>e.draw(s,a.TRIANGLES,g,t.StencilMode.disabled,f,t.CullFaceMode.disabled,bn(p.projMatrix,_,_,E,0,y,p.frustumCorners.TL,p.frustumCorners.TR,p.frustumCorners.BR,p.frustumCorners.BL,p.globeCenterInViewSpace,p.globeRadius,w,0),"globe_pole_raster",n,C,x);n.setupElevationDraw(i,l,b),e.prepareDrawProgram(s,l,u.toUnwrapped()),h&&S(l,m),d&&(_=t.scale(t.create(),_,[1,-1,1]),S(l,v))}}}}(e,n,r,o,i);else{const s=e.context,a=s.gl;let l,u;const c=e.options.showTerrainWireframe?2:0,p=(t,n)=>{if(u===t)return;const r=[Sn[t]];n&&r.push(Sn[c]),l=e.useProgram("terrainRaster",null,r),u=t},h=e.colorModeForRenderPass(),d=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);En.update(i);const f=e.transform,g=Tn(f.zoom)*n.exaggeration();(c?[!1,!0]:[!1]).forEach(c=>{u=-1;const m=c?a.LINES:a.TRIANGLES,[y,v]=c?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments];for(const u of o){const o=r.getTile(u),_=t.StencilMode.disabled,w=n.prevTerrainTileForTile[u.key],C=n.terrainTileForTile[u.key];xn(w,C)&&En.newMorphing(u.key,w,C,i,250),s.activeTexture.set(a.TEXTURE0),o.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const b=En.getMorphValuesForProxy(u.key),x=b?1:0;let E;b&&(E={morphing:{srcDemTile:b.from,dstDemTile:b.to,phase:t.easeCubicInOut(b.phase)}});const S=Cn(u.projMatrix,Rn(u.canonical,f.renderWorldCopies)?g/10:g);p(x,c),n.setupElevationDraw(o,l,E),e.prepareDrawProgram(s,l,u.toUnwrapped()),l.draw(s,m,d,_,h,t.CullFaceMode.backCCW,S,"terrain_raster",n.gridBuffer,y,v)}})}}(n,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const n=this.painter,r=this.painter.context,o=this.proxySourceCache,i=this.proxiedCoords[o.id],s=this._drapedRenderBatches.shift(),a=[],l=n.style.order;let u=0;for(const c of i){const i=o.getTileByID(c.proxyTileKey),p=o.proxyCachedFBO[c.key]?o.proxyCachedFBO[c.key][e]:void 0,h=void 0!==p?o.renderCache[p]:this.pool[u++],d=void 0!==p;if(i.texture=h.tex,d&&!h.dirty){a.push(i.tileID);continue}let f;r.bindFramebuffer.set(h.fb.framebuffer),this.renderedToTile=!1,h.dirty&&(r.clear({color:t.Color.transparent,stencil:0}),h.dirty=!1);for(let t=s.start;t<=s.end;++t){const e=n.style._layers[l[t]];if(e.isHidden(n.transform.zoom))continue;const o=n.style._getLayerSourceCache(e),i=o?this.proxyToSource[c.key][o.id]:[c];if(!i)continue;const s=i;r.viewport.set([0,0,h.fb.width,h.fb.height]),f!==(o?o.id:null)&&(this._setupStencil(h,i,e,o),f=o?o.id:null),n.renderLayer(n,o,e,s)}this.renderedToTile?(h.dirty=!0,a.push(i.tileID)):d||--u,5===u&&(u=0,this.renderToBackBuffer(a))}return this.renderToBackBuffer(a),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),s.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return{efficiency:100};let n,r=0,o=0,i=!1;for(let s=0;s<e;++s){const e=t._layers[t.order[s]];this._style.isLayerDraped(e)?(i&&++r,++o):i||(i=!0,n=e.id)}return 0===o?{efficiency:100}:{efficiency:100*(1-r/o),firstUndrapedLayer:n}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(t=>t.dem).forEach(e=>{t=Math.min(t,e.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,e,n){if(!this._visibleDemTiles)return null;const r=this._visibleDemTiles.filter(t=>t.dem).map(r=>{const o=r.tileID,i=1<<o.overscaledZ,{x:s,y:a}=o.canonical,l=s/i,u=(s+1)/i,c=a/i,p=(a+1)/i;return{minx:l,miny:c,maxx:u,maxy:p,t:r.dem.tree.raycastRoot(l,c,u,p,t,e,n),tile:r}});r.sort((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE));for(const o of r){if(null==o.t)return null;const r=o.tile.dem.tree.raycast(o.minx,o.miny,o.maxx,o.maxy,t,e,n);if(null!=r)return r}return null}_createFBO(){const e=this.painter.context,n=e.gl,r=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const o=new t.Texture(e,{width:r[0],height:r[1],data:null},n.RGBA);o.bind(n.LINEAR,n.CLAMP_TO_EDGE);const i=e.createFramebuffer(r[0],r[1],!1);return i.colorAttachment.set(o.texture),i.depthAttachment=new bt(e,i.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,r[0],r[1]),this._stencilRef=0,i.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):i.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:i,tex:o,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const e=this._style._layers[t],n=e.isHidden(this.painter.transform.zoom);return"custom"===e.type?!n&&e.shouldRedrape():!n&&e.hasTransition()})}_clearLineLayersFromRenderCache(){let e=!1;for(const t of this._style._getSources())if(t instanceof St){e=!0;break}if(!e)return;const n={};for(let r=0;r<this._style.order.length;++r){const e=this._style._layers[this._style.order[r]],o=this._style._getLayerSourceCache(e);if(o&&!n[o.id]&&!e.isHidden(this.painter.transform.zoom)&&"line"===e.type&&e.widthExpression()instanceof t.ZoomDependentExpression){n[o.id]=!0;for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][o.id];if(e)for(const t of e)this._clearRenderCacheForTile(o.id,t)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n]._source instanceof Tt){t=!0;break}if(!t)return;const e={};for(let n=0;n<this._style.order.length;++n){const t=this._style._layers[this._style.order[n]],r=this._style._getLayerSourceCache(t);if(!r||e[r.id])continue;if(t.isHidden(this.painter.transform.zoom)||"raster"!==t.type)continue;const o=t.paint.get("raster-fade-duration");for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][r.id];if(t)for(const e of t){const t=On(r.getTile(e),r.findLoadedParent(e,0),r,this.painter.transform,o);(1!==t.opacity||0!==t.mix)&&this._clearRenderCacheForTile(r.id,e)}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const n=[];let r,o=0,i=this._style._layers[t[o]];for(;!this._style.isLayerDraped(i)&&i.isHidden(this.painter.transform.zoom)&&++o<e;)i=this._style._layers[t[o]];for(;o<e;++o){const e=this._style._layers[t[o]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===r&&(r=o):void 0!==r&&(n.push({start:r,end:o-1}),r=void 0))}void 0!==r&&n.push({start:r,end:o-1}),this._drapedRenderBatches=n}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let n=0;n<t.length;++n){const r=Object.values(t[n]);e.renderCachePool.push(...r)}}return}this._clearRasterLayersFromRenderCache();const n=this.proxyCoords,r=this._tilesDirty;for(let i=n.length-1;i>=0;i--){const o=n[i];if(e.getTileByID(o.key),void 0!==e.proxyCachedFBO[o.key]){const n=t[o.key],i=this.proxyToSource[o.key];let s=0;for(const t in i){const e=i[t],o=n[t];if(!o||o.length!==e.length||e.some((e,n)=>e!==o[n]||r[t]&&r[t].hasOwnProperty(e.key))){s=-1;break}++s}for(const t in e.proxyCachedFBO[o.key])e.renderCache[e.proxyCachedFBO[o.key][t]].dirty=s<0||s!==Object.values(n).length}}const o=[...this._drapedRenderBatches];o.sort((t,e)=>e.end-e.start-(t.end-t.start));for(const i of o)for(const t of n){if(e.proxyCachedFBO[t.key])continue;let n=e.renderCachePool.pop();void 0===n&&e.renderCache.length<50&&(n=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==n&&(e.proxyCachedFBO[t.key]={},e.proxyCachedFBO[t.key][i.start]=n,e.renderCache[n].dirty=!0)}this._tilesDirty={}}_setupStencil(t,e,n,r){if(!r||!this._sourceTilesOverlap[r.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const o=this.painter.context,i=o.gl;if(e.length<=1)return void(this._overlapStencilType=!1);let s;if(n.isTileClipped())s=e.length,this._overlapStencilMode.test={func:i.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(e[0].overscaledZ>e[e.length-1].overscaledZ))return void(this._overlapStencilType=!1);s=1,this._overlapStencilMode.test={func:i.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+s>255&&(o.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=s,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(e,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,n){const r=this.painter,o=this.painter.context,i=o.gl;r._tileClippingMaskIDs={},o.setColorMode(t.ColorMode.disabled),o.setDepthMode(t.DepthMode.disabled);const s=r.useProgram("clippingMask");for(const a of e){const e=r._tileClippingMaskIDs[a.key]=--n;s.draw(o,i.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:i.ALWAYS,mask:0},e,255,i.KEEP,i.KEEP,i.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Pn(a.projMatrix),"$clipping",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const r=[e.x,e.y,1,1];t.transformMat4$1(r,r,n.pixelMatrixInverse),t.scale$1(r,r,1/r[3]),r[0]/=n.worldSize,r[1]/=n.worldSize;const o=n._camera.position,i=t.mercatorZfromAltitude(1,n.center.lat),s=[o[0],o[1],o[2]/i,0],a=t.subtract([],r.slice(0,3),s);t.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=i,s):null}drawDepth(){const e=this.painter,n=e.context,r=this.proxySourceCache,o=Math.ceil(e.width),i=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===o&&this._depthFBO.height===i||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const e=n.gl,r=n.createFramebuffer(o,i,!0);n.activeTexture.set(e.TEXTURE0);const s=new t.Texture(n,{width:o,height:i,data:null},e.RGBA);s.bind(e.NEAREST,e.CLAMP_TO_EDGE),r.colorAttachment.set(s.texture);const a=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,o,i);r.depthAttachment.set(a),this._depthFBO=r,this._depthTexture=s}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,o,i]),function(e,n,r,o){if("globe"===e.transform.projection.name)return;const i=e.context,s=i.gl;i.clear({depth:1});const a=e.useProgram("terrainDepth"),l=new t.DepthMode(s.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const u of o){const e=r.getTile(u),o=Cn(u.projMatrix,0);n.setupElevationDraw(e,a),a.draw(i,s.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,o,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(e,this,r,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,e,n){if(t.getSource()instanceof Pt)return this._setupProxiedCoordsForImageSource(t,e,n);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const r=this.proxiedCoords[t.id]=[],o=this.proxyCoords;for(let s=0;s<o.length;s++){const e=o[s],i=this._findTileCoveringTileID(e,t);if(i){const o=this._createProxiedId(e,i,n[e.key]&&n[e.key][t.id]);r.push(o),this.proxyToSource[e.key][t.id]=[o]}}let i=!1;for(let s=0;s<e.length;s++){const o=t.getTile(e[s]);if(!o||!o.hasData())continue;const a=this._findTileCoveringTileID(o.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==o.tileID.canonical.z){const e=this.proxyToSource[a.tileID.key][t.id],s=this._createProxiedId(a.tileID,o,n[a.tileID.key]&&n[a.tileID.key][t.id]);e?e.splice(e.length-1,0,s):this.proxyToSource[a.tileID.key][t.id]=[s],r.push(s),i=!0}}this._sourceTilesOverlap[t.id]=i}_setupProxiedCoordsForImageSource(e,n,r){if(!e.getSource().loaded())return;const o=this.proxiedCoords[e.id]=[],i=this.proxyCoords,s=e.getSource(),a=new t.Point(s.tileID.x,s.tileID.y)._div(1<<s.tileID.z),l=s.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce((t,e)=>(t.min.x=Math.min(t.min.x,e.x-a.x),t.min.y=Math.min(t.min.y,e.y-a.y),t.max.x=Math.max(t.max.x,e.x-a.x),t.max.y=Math.max(t.max.y,e.y-a.y),t),{min:new t.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(e,n)=>{const r=e.wrap+e.canonical.x/(1<<e.canonical.z),o=e.canonical.y/(1<<e.canonical.z),i=t.EXTENT/(1<<e.canonical.z),s=n.wrap+n.canonical.x/(1<<n.canonical.z),a=n.canonical.y/(1<<n.canonical.z);return r+i<s+l.min.x||r>s+l.max.x||o+i<a+l.min.y||o>a+l.max.y};for(let t=0;t<i.length;t++){const s=i[t];for(let t=0;t<n.length;t++){const i=e.getTile(n[t]);if(!i||!i.hasData())continue;if(u(s,i.tileID))continue;const a=this._createProxiedId(s,i,r[s.key]&&r[s.key][e.id]),l=this.proxyToSource[s.key][e.id];l?l.push(a):this.proxyToSource[s.key][e.id]=[a],o.push(a)}}}_createProxiedId(e,n,r){let o=this.orthoMatrix;if(r){const t=r.find(t=>t.key===n.tileID.key);if(t)return t}if(n.tileID.key!==e.key){const r=e.canonical.z-n.tileID.canonical.z;let i,s,a;o=t.create();const l=n.tileID.wrap-e.wrap<<e.overscaledZ;r>0?(i=t.EXTENT>>r,s=i*((n.tileID.canonical.x<<r)-e.canonical.x+l),a=i*((n.tileID.canonical.y<<r)-e.canonical.y)):(i=t.EXTENT<<-r,s=t.EXTENT*(n.tileID.canonical.x-(e.canonical.x+l<<-r)),a=t.EXTENT*(n.tileID.canonical.y-(e.canonical.y<<-r))),t.ortho(o,0,i,0,i,0,1),t.translate(o,o,[s,a,0])}return new Dn(n.tileID,e.key,o)}_findTileCoveringTileID(e,n){let r=n.getTile(e);if(r&&r.hasData())return r;const o=this._findCoveringTileCache[n.id],i=o[e.key];if(r=i?n.getTileByID(i):null,r&&r.hasData()||null===i)return r;let s=r?r.tileID:e,a=s.overscaledZ;const l=n.getSource().minzoom,u=[];if(!i){const o=n.getSource().maxzoom;if(e.canonical.z>=o){const r=e.canonical.z-o;n.getSource().reparseOverscaled?(a=Math.max(e.canonical.z+2,n.transform.tileZoom),s=new t.OverscaledTileID(a,e.wrap,o,e.canonical.x>>r,e.canonical.y>>r)):0!==r&&(a=o,s=new t.OverscaledTileID(a,e.wrap,o,e.canonical.x>>r,e.canonical.y>>r))}s.key!==e.key&&(u.push(s.key),r=n.getTile(s))}const c=t=>{u.forEach(e=>{o[e]=t}),u.length=0};for(a-=1;a>=l&&(!r||!r.hasData());a--){r&&c(r.tileID.key);const t=s.calculateScaledKey(a);if(r=n.getTileByID(t),r&&r.hasData())break;const e=o[t];if(null===e)break;void 0===e?u.push(t):r=n.getTileByID(e)}return c(r?r.tileID.key:null),r&&r.hasData()?r:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,e){let n=this._tilesDirty[t];n||(n=this._tilesDirty[t]={}),n[e.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let n=0;const r=new t.StructArrayLayout2ui4,o=131;for(let t=1;t<129;t++){for(let e=1;e<129;e++)n=t*o+e,r.emplaceBack(n,n+1),r.emplaceBack(n,n+o),r.emplaceBack(n+1,n+o),128===t&&r.emplaceBack(n+o,n+o+1);r.emplaceBack(n+1,n+1+o)}return r}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ln{static cacheKey(t,e,n,r){let o="".concat(e).concat(r?r.cacheKey:"");for(const i of n)t.usedDefines.includes(i)&&(o+="/".concat(i));return o}constructor(e,n,r,o,i,s){const a=e.gl;this.program=a.createProgram();const l=function(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const r=t[n].split(" ");e.push(r.pop())}return e}(r.staticAttributes),u=o?o.getBinderAttributes():[],c=l.concat(u);let p=o?o.defines():[];p=p.concat(s.map(t=>"#define ".concat(t)));const h=e.isWebGL2?"#version 300 es\n":"",d=h+p.concat(e.extStandardDerivatives&&0===h.length?"#extension GL_OES_standard_derivatives : enable\n".concat(pn):pn,pn,cn,un.fragmentSource,an.fragmentSource,r.fragmentSource).join("\n"),f=h+p.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",cn,un.vertexSource,an.vertexSource,sn.vertexSource,r.vertexSource).join("\n"),g=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(g,d),a.compileShader(g),a.attachShader(this.program,g);const m=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(m,f),a.compileShader(m),a.attachShader(this.program,m),this.attributes={},this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)c[t]&&(a.bindAttribLocation(this.program,t,c[t]),this.attributes[c[t]]=t);a.linkProgram(this.program),a.deleteShader(m),a.deleteShader(g),this.fixedUniforms=i(e),this.binderUniforms=o?o.getUniforms(e):[],s.includes("TERRAIN")&&(this.terrainUniforms=(e=>({u_dem:new t.Uniform1i(e),u_dem_prev:new t.Uniform1i(e),u_dem_unpack:new t.Uniform4f(e),u_dem_tl:new t.Uniform2f(e),u_dem_scale:new t.Uniform1f(e),u_dem_tl_prev:new t.Uniform2f(e),u_dem_scale_prev:new t.Uniform1f(e),u_dem_size:new t.Uniform1f(e),u_dem_lerp:new t.Uniform1f(e),u_exaggeration:new t.Uniform1f(e),u_depth:new t.Uniform1i(e),u_depth_size_inv:new t.Uniform2f(e),u_meter_to_dem:new t.Uniform1f(e),u_label_plane_matrix_inv:new t.UniformMatrix4f(e)}))(e)),s.includes("GLOBE")&&(this.globeUniforms=(e=>({u_tile_tl_up:new t.Uniform3f(e),u_tile_tr_up:new t.Uniform3f(e),u_tile_br_up:new t.Uniform3f(e),u_tile_bl_up:new t.Uniform3f(e),u_tile_up_scale:new t.Uniform1f(e)}))(e)),s.includes("FOG")&&(this.fogUniforms=(e=>({u_fog_matrix:new t.UniformMatrix4f(e),u_fog_range:new t.Uniform2f(e),u_fog_color:new t.Uniform4f(e),u_fog_horizon_blend:new t.Uniform1f(e),u_fog_temporal_offset:new t.Uniform1f(e),u_frustum_tl:new t.Uniform3f(e),u_frustum_tr:new t.Uniform3f(e),u_frustum_br:new t.Uniform3f(e),u_frustum_bl:new t.Uniform3f(e),u_globe_pos:new t.Uniform3f(e),u_globe_radius:new t.Uniform1f(e),u_globe_transition:new t.Uniform1f(e),u_is_globe:new t.Uniform1i(e),u_viewport:new t.Uniform2f(e)}))(e))}}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t]&&n[t].set(this.program,t,e[t])}}setGlobeUniformValues(t,e){if(!this.globeUniforms)return;const n=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t]&&n[t].set(this.program,t,e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(this.program,t,e[t])}}draw(t,e,n,r,o,i,s,a,l,u,c,p,h,d,f){const g=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(o),t.setCullFace(i);for(const y of Object.keys(this.fixedUniforms))this.fixedUniforms[y].set(this.program,y,s[y]);d&&d.setUniforms(this.program,t,this.binderUniforms,p,{zoom:h});const m={[g.LINES]:2,[g.TRIANGLES]:3,[g.LINE_STRIP]:1}[e];for(const y of c.get()){const n=y.vaos||(y.vaos={});(n[a]||(n[a]=new gn)).bind(t,this,l,d?d.getPaintVertexBuffers():[],u,y.vertexOffset,f||[]),g.drawElements(e,y.primitiveLength*m,g.UNSIGNED_SHORT,y.primitiveOffset*m*2)}}}function Nn(t,e){const n=Math.pow(2,e.tileID.overscaledZ),r=e.tileSize*Math.pow(2,t.transform.tileZoom)/n,o=r*(e.tileID.canonical.x+e.tileID.wrap*n),i=r*e.tileID.canonical.y;return{u_image:0,u_texsize:e.imageAtlasTexture.size,u_tile_units_to_pixels:1/I(e,1,t.transform.tileZoom),u_pixel_coord_upper:[o>>16,i>>16],u_pixel_coord_lower:[65535&o,65535&i]}}const Fn=t.create(),kn=(e,n,r,o,i,s,a,l,u,c,p)=>{const h=n.style.light,d=h.properties.get("position"),f=[d.x,d.y,d.z],g=t.create$1();"viewport"===h.properties.get("anchor")&&(t.fromRotation(g,-n.transform.angle),t.transformMat3(f,f,g));const m=h.properties.get("color"),y=n.transform,v={u_matrix:e,u_lightpos:f,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[m.r,m.g,m.b],u_vertical_gradient:+r,u_opacity:o,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fn,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:i,u_edge_radius:s};return"globe"===y.projection.name&&(v.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],v.u_zoom_transition=u,v.u_inv_rot_matrix=p,v.u_merc_center=c,v.u_up_dir=y.projection.upVector(new t.CanonicalTileID(0,0,0),c[0]*t.EXTENT,c[1]*t.EXTENT),v.u_height_lift=l),v},Gn=(e,n,r,o,i,s,a,l,u,c,p,h)=>{const d=kn(e,n,r,o,i,s,a,u,c,p,h),f={u_height_factor:-Math.pow(2,a.overscaledZ)/l.tileSize/8};return t.extend(d,Nn(n,l),f)},Bn=t=>({u_matrix:t}),Vn=(e,n,r)=>t.extend(Bn(e),Nn(n,r)),zn=(t,e)=>({u_matrix:t,u_world:e}),jn=(e,n,r,o)=>t.extend(Vn(e,n,r),{u_world:o}),Hn=t.create(),Un=(e,n,r,o,i,s)=>{const a=e.transform,l="globe"===a.projection.name;let u;if("map"===s.paint.get("circle-pitch-alignment"))if(l){const e=t.globePixelsToTileUnits(a.zoom,n.canonical)*a._pixelsPerMercatorPixel;u=Float32Array.from([e,0,0,e])}else u=a.calculatePixelsToTileUnitsMatrix(r);else u=new Float32Array([a.pixelsToGLUnits[0],0,0,a.pixelsToGLUnits[1]]);const c={u_camera_to_center_distance:a.cameraToCenterDistance,u_matrix:e.translatePosMatrix(n.projMatrix,r,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:u,u_inv_rot_matrix:Hn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(l){c.u_inv_rot_matrix=o,c.u_merc_center=i,c.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],c.u_zoom_transition=t.globeToMercatorTransition(a.zoom);const e=i[0]*t.EXTENT,r=i[1]*t.EXTENT;c.u_up_dir=a.projection.upVector(new t.CanonicalTileID(0,0,0),e,r)}return c},Wn=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},qn=(e,n,r,o)=>{const i=t.EXTENT/r.tileSize;return{u_matrix:e,u_camera_to_center_distance:n.getCameraToCenterDistance(o),u_extrude_scale:[n.pixelsToGLUnits[0]/i,n.pixelsToGLUnits[1]/i]}},Xn=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}},Kn=t.create(),Yn=(e,n,r,o,i,s,a)=>{const l=e.transform,u="globe"===l.projection.name,c=u?t.globePixelsToTileUnits(l.zoom,n.canonical)*l._pixelsPerMercatorPixel:I(r,1,s),p={u_matrix:n.projMatrix,u_extrude_scale:c,u_intensity:a,u_inv_rot_matrix:Kn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){p.u_inv_rot_matrix=o,p.u_merc_center=i,p.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],p.u_zoom_transition=t.globeToMercatorTransition(l.zoom);const e=i[0]*t.EXTENT,r=i[1]*t.EXTENT;p.u_up_dir=l.projection.upVector(new t.CanonicalTileID(0,0,0),e,r)}return p},Zn=(t,e,n,r,o,i,s)=>{const a=t.transform,l=a.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:$n(t,e,n,r),u_pixels_to_tile_units:l,u_device_pixel_ratio:i,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:o,u_texsize:tr(n)?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Jn(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:s}},Qn=(t,e,n,r,o)=>{const i=t.transform;return{u_matrix:$n(t,e,n,r),u_texsize:e.imageAtlasTexture.size,u_pixels_to_tile_units:i.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:o,u_image:0,u_tile_units_to_pixels:Jn(e,i),u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Jn(t,e){return 1/I(t,1,e.tileZoom)}function $n(t,e,n,r){return t.translatePosMatrix(r||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}function tr(t){const e=t.paint.get("line-dasharray").value;return e.value||"constant"!==e.kind}const er=(t,e,n,r,o,i)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_fade_t:r.mix,u_opacity:r.opacity*o.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:o.paint.get("raster-brightness-min"),u_brightness_high:o.paint.get("raster-brightness-max"),u_saturation_factor:(a=o.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(s=o.paint.get("raster-contrast"),s>0?1/(1-s):1+s),u_spin_weights:nr(o.paint.get("raster-hue-rotate")),u_perspective_transform:i};var s,a};function nr(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const rr=t.create(),or=(e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m)=>{const y=i.transform,v={u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:y.cameraToCenterDistance,u_rotate_symbol:+r,u_aspect_ratio:y.width/y.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+o,u_texsize:c,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:rr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:rr,u_up_vector:[0,-1,0]};return"globe"===m.name&&(v.u_tile_id=[p.canonical.x,p.canonical.y,1<<p.canonical.z],v.u_zoom_transition=h,v.u_inv_rot_matrix=f,v.u_merc_center=d,v.u_camera_forward=y._camera.forward(),v.u_ecef_origin=t.globeECEFOrigin(y.globeMatrix,p.toUnwrapped()),v.u_tile_matrix=Float32Array.from(y.globeMatrix),v.u_up_vector=g),v},ir=(e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m,y)=>t.extend(or(e,n,r,o,i,s,a,l,u,c,h,d,f,g,m,y),{u_gamma_scale:o?i.transform.cameraToCenterDistance*Math.cos(i.terrain?0:i.transform._pitch):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+p}),sr=(e,n,r,o,i,s,a,l,u,c,p,h,d,f,g,m)=>t.extend(ir(e,n,r,o,i,s,a,l,!0,u,!0,p,h,d,f,g,m),{u_texsize_icon:c,u_texture_icon:1}),ar=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),lr=(e,n,r,o,i)=>t.extend(function(t,e,n){const r=e.imageManager.getPattern(t.toString()),{width:o,height:i}=e.imageManager.getPixelSize(),s=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,e.transform.tileZoom)/s,l=a*(n.tileID.canonical.x+n.tileID.wrap*s),u=a*n.tileID.canonical.y;return{u_image:0,u_pattern_tl:r.tl,u_pattern_br:r.br,u_texsize:[o,i],u_pattern_size:r.displaySize,u_tile_units_to_pixels:1/I(n,1,e.transform.tileZoom),u_pixel_coord_upper:[l>>16,u>>16],u_pixel_coord_lower:[65535&l,65535&u]}}(o,r,i),{u_matrix:e,u_opacity:n}),ur={fillExtrusion:e=>({u_matrix:new t.UniformMatrix4f(e),u_lightpos:new t.Uniform3f(e),u_lightintensity:new t.Uniform1f(e),u_lightcolor:new t.Uniform3f(e),u_vertical_gradient:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e),u_edge_radius:new t.Uniform1f(e),u_ao:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_up_dir:new t.Uniform3f(e),u_height_lift:new t.Uniform1f(e)}),fillExtrusionPattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_lightpos:new t.Uniform3f(e),u_lightintensity:new t.Uniform1f(e),u_lightcolor:new t.Uniform3f(e),u_vertical_gradient:new t.Uniform1f(e),u_height_factor:new t.Uniform1f(e),u_edge_radius:new t.Uniform1f(e),u_ao:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_up_dir:new t.Uniform3f(e),u_height_lift:new t.Uniform1f(e),u_image:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e)}),fill:e=>({u_matrix:new t.UniformMatrix4f(e)}),fillPattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_image:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e)}),fillOutline:e=>({u_matrix:new t.UniformMatrix4f(e),u_world:new t.Uniform2f(e)}),fillOutlinePattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_world:new t.Uniform2f(e),u_image:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e)}),circle:e=>({u_camera_to_center_distance:new t.Uniform1f(e),u_extrude_scale:new t.UniformMatrix2f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_up_dir:new t.Uniform3f(e)}),collisionBox:e=>({u_matrix:new t.UniformMatrix4f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_extrude_scale:new t.Uniform2f(e)}),collisionCircle:e=>({u_matrix:new t.UniformMatrix4f(e),u_inv_matrix:new t.UniformMatrix4f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_viewport_size:new t.Uniform2f(e)}),debug:e=>({u_color:new t.UniformColor(e),u_matrix:new t.UniformMatrix4f(e),u_overlay:new t.Uniform1i(e),u_overlay_scale:new t.Uniform1f(e)}),clippingMask:e=>({u_matrix:new t.UniformMatrix4f(e)}),heatmap:e=>({u_extrude_scale:new t.Uniform1f(e),u_intensity:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_up_dir:new t.Uniform3f(e)}),heatmapTexture:e=>({u_image:new t.Uniform1i(e),u_color_ramp:new t.Uniform1i(e),u_opacity:new t.Uniform1f(e)}),hillshade:e=>({u_matrix:new t.UniformMatrix4f(e),u_image:new t.Uniform1i(e),u_latrange:new t.Uniform2f(e),u_light:new t.Uniform2f(e),u_shadow:new t.UniformColor(e),u_highlight:new t.UniformColor(e),u_accent:new t.UniformColor(e)}),hillshadePrepare:e=>({u_matrix:new t.UniformMatrix4f(e),u_image:new t.Uniform1i(e),u_dimension:new t.Uniform2f(e),u_zoom:new t.Uniform1f(e),u_unpack:new t.Uniform4f(e)}),line:e=>({u_matrix:new t.UniformMatrix4f(e),u_pixels_to_tile_units:new t.UniformMatrix2f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_units_to_pixels:new t.Uniform2f(e),u_dash_image:new t.Uniform1i(e),u_gradient_image:new t.Uniform1i(e),u_image_height:new t.Uniform1f(e),u_texsize:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e),u_alpha_discard_threshold:new t.Uniform1f(e),u_trim_offset:new t.Uniform2f(e)}),linePattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_texsize:new t.Uniform2f(e),u_pixels_to_tile_units:new t.UniformMatrix2f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_image:new t.Uniform1i(e),u_units_to_pixels:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e),u_alpha_discard_threshold:new t.Uniform1f(e)}),raster:e=>({u_matrix:new t.UniformMatrix4f(e),u_tl_parent:new t.Uniform2f(e),u_scale_parent:new t.Uniform1f(e),u_fade_t:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e),u_image0:new t.Uniform1i(e),u_image1:new t.Uniform1i(e),u_brightness_low:new t.Uniform1f(e),u_brightness_high:new t.Uniform1f(e),u_saturation_factor:new t.Uniform1f(e),u_contrast_factor:new t.Uniform1f(e),u_spin_weights:new t.Uniform3f(e),u_perspective_transform:new t.Uniform2f(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new t.Uniform1i(e),u_is_size_feature_constant:new t.Uniform1i(e),u_size_t:new t.Uniform1f(e),u_size:new t.Uniform1f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_rotate_symbol:new t.Uniform1i(e),u_aspect_ratio:new t.Uniform1f(e),u_fade_change:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_label_plane_matrix:new t.UniformMatrix4f(e),u_coord_matrix:new t.UniformMatrix4f(e),u_is_text:new t.Uniform1i(e),u_pitch_with_map:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_camera_forward:new t.Uniform3f(e),u_tile_matrix:new t.UniformMatrix4f(e),u_up_vector:new t.Uniform3f(e),u_ecef_origin:new t.Uniform3f(e),u_texture:new t.Uniform1i(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new t.Uniform1i(e),u_is_size_feature_constant:new t.Uniform1i(e),u_size_t:new t.Uniform1f(e),u_size:new t.Uniform1f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_rotate_symbol:new t.Uniform1i(e),u_aspect_ratio:new t.Uniform1f(e),u_fade_change:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_label_plane_matrix:new t.UniformMatrix4f(e),u_coord_matrix:new t.UniformMatrix4f(e),u_is_text:new t.Uniform1i(e),u_pitch_with_map:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_texture:new t.Uniform1i(e),u_gamma_scale:new t.Uniform1f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_camera_forward:new t.Uniform3f(e),u_tile_matrix:new t.UniformMatrix4f(e),u_up_vector:new t.Uniform3f(e),u_ecef_origin:new t.Uniform3f(e),u_is_halo:new t.Uniform1i(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new t.Uniform1i(e),u_is_size_feature_constant:new t.Uniform1i(e),u_size_t:new t.Uniform1f(e),u_size:new t.Uniform1f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_rotate_symbol:new t.Uniform1i(e),u_aspect_ratio:new t.Uniform1f(e),u_fade_change:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_label_plane_matrix:new t.UniformMatrix4f(e),u_coord_matrix:new t.UniformMatrix4f(e),u_is_text:new t.Uniform1i(e),u_pitch_with_map:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_texsize_icon:new t.Uniform2f(e),u_texture:new t.Uniform1i(e),u_texture_icon:new t.Uniform1i(e),u_gamma_scale:new t.Uniform1f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_is_halo:new t.Uniform1i(e)}),background:e=>({u_matrix:new t.UniformMatrix4f(e),u_opacity:new t.Uniform1f(e),u_color:new t.UniformColor(e)}),backgroundPattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_opacity:new t.Uniform1f(e),u_image:new t.Uniform1i(e),u_pattern_tl:new t.Uniform2f(e),u_pattern_br:new t.Uniform2f(e),u_texsize:new t.Uniform2f(e),u_pattern_size:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e)}),terrainRaster:wn,terrainDepth:wn,skybox:e=>({u_matrix:new t.UniformMatrix4f(e),u_sun_direction:new t.Uniform3f(e),u_cubemap:new t.Uniform1i(e),u_opacity:new t.Uniform1f(e),u_temporal_offset:new t.Uniform1f(e)}),skyboxGradient:e=>({u_matrix:new t.UniformMatrix4f(e),u_color_ramp:new t.Uniform1i(e),u_center_direction:new t.Uniform3f(e),u_radius:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e),u_temporal_offset:new t.Uniform1f(e)}),skyboxCapture:e=>({u_matrix_3f:new t.UniformMatrix3f(e),u_sun_direction:new t.Uniform3f(e),u_sun_intensity:new t.Uniform1f(e),u_color_tint_r:new t.Uniform4f(e),u_color_tint_m:new t.Uniform4f(e),u_luminance:new t.Uniform1f(e)}),globeRaster:e=>({u_proj_matrix:new t.UniformMatrix4f(e),u_globe_matrix:new t.UniformMatrix4f(e),u_normalize_matrix:new t.UniformMatrix4f(e),u_merc_matrix:new t.UniformMatrix4f(e),u_zoom_transition:new t.Uniform1f(e),u_merc_center:new t.Uniform2f(e),u_image0:new t.Uniform1i(e),u_grid_matrix:new t.UniformMatrix3f(e),u_skirt_height:new t.Uniform1f(e),u_frustum_tl:new t.Uniform3f(e),u_frustum_tr:new t.Uniform3f(e),u_frustum_br:new t.Uniform3f(e),u_frustum_bl:new t.Uniform3f(e),u_globe_pos:new t.Uniform3f(e),u_globe_radius:new t.Uniform1f(e),u_viewport:new t.Uniform2f(e)}),globeAtmosphere:e=>({u_frustum_tl:new t.Uniform3f(e),u_frustum_tr:new t.Uniform3f(e),u_frustum_br:new t.Uniform3f(e),u_frustum_bl:new t.Uniform3f(e),u_horizon:new t.Uniform1f(e),u_transition:new t.Uniform1f(e),u_fadeout_range:new t.Uniform1f(e),u_color:new t.Uniform4f(e),u_high_color:new t.Uniform4f(e),u_space_color:new t.Uniform4f(e),u_star_intensity:new t.Uniform1f(e),u_star_density:new t.Uniform1f(e),u_star_size:new t.Uniform1f(e),u_temporal_offset:new t.Uniform1f(e),u_horizon_angle:new t.Uniform1f(e),u_rotation_matrix:new t.UniformMatrix4f(e)})};let cr;function pr(e,n,r,o,i,s,a){const l=e.context,u=l.gl,c=e.transform,p=e.useProgram("collisionBox"),h=[];let d=0,f=0;for(let C=0;C<o.length;C++){const g=o[C],m=n.getTile(g),y=m.getBucket(r);if(!y)continue;const v=we(g,y,c);let _=v;0===i[0]&&0===i[1]||(_=e.translatePosMatrix(v,m,i,s));const w=a?y.textCollisionBox:y.iconCollisionBox,b=y.collisionCircleArray;if(b.length>0){const e=t.create(),n=_;t.mul(e,y.placementInvProjMatrix,c.glCoordMatrix),t.mul(e,e,y.placementViewportMatrix),h.push({circleArray:b,circleOffset:f,transform:n,invTransform:e,projection:y.getProjection()}),d+=b.length/4,f=d}w&&(e.terrain&&e.terrain.setupElevationDraw(m,p),p.draw(l,u.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,qn(_,c,m,y.getProjection()),r.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,null,c.zoom,null,[w.collisionVertexBuffer,w.collisionVertexBufferExt]))}if(!a||!h.length)return;const g=e.useProgram("collisionCircle"),m=new t.StructArrayLayout2f1f2i16;m.resize(4*d),m._trim();let y=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,r=t.circleArray[n+0],o=t.circleArray[n+1],i=t.circleArray[n+2],s=t.circleArray[n+3];m.emplace(y++,r,o,i,s,0),m.emplace(y++,r,o,i,s,1),m.emplace(y++,r,o,i,s,2),m.emplace(y++,r,o,i,s,3)}(!cr||cr.length<2*d)&&(cr=function(e){const n=2*e,r=new t.StructArrayLayout3ui6;r.resize(n),r._trim();for(let t=0;t<n;t++){const e=6*t;r.uint16[e+0]=4*t+0,r.uint16[e+1]=4*t+1,r.uint16[e+2]=4*t+2,r.uint16[e+3]=4*t+2,r.uint16[e+4]=4*t+3,r.uint16[e+5]=4*t+0}return r}(d));const v=l.createIndexBuffer(cr,!0),_=l.createVertexBuffer(m,t.collisionCircleLayout.members,!0);for(const C of h){const n={u_matrix:C.transform,u_inv_matrix:C.invTransform,u_camera_to_center_distance:(w=c).getCameraToCenterDistance(C.projection),u_viewport_size:[w.width,w.height]};g.draw(l,u.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,n,r.id,_,v,t.SegmentVector.simpleSegment(0,2*C.circleOffset,C.circleArray.length,C.circleArray.length/2),null,c.zoom)}var w;_.destroy(),v.destroy()}const hr=t.create();function dr(e,n){let{width:r,height:o,anchor:i,textOffset:s,textScale:a}=e;const{horizontalAlign:l,verticalAlign:u}=t.getAnchorAlignment(i),c=-(l-.5)*r,p=-(u-.5)*o,h=t.evaluateVariableOffset(i,s);return new t.Point((c/a+h[0])*n,(p/a+h[1])*n)}function fr(e,n,r,o,i,s,a,l,u,c,p){const h=e.text.placedSymbolArray,d=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,g={},m=e.getProjection(),y=Ce(l,m,s),v=s.elevation,_=m.upVectorScale(l.canonical,s.center.lat,s.worldSize).metersToTile;d.clear();for(let w=0;w<h.length;w++){const f=h.get(w),{tileAnchorX:C,tileAnchorY:b,numGlyphs:x}=f,E=f.hidden||!f.crossTileID||e.allowVerticalPlacement&&!f.placedOrientation?null:o[f.crossTileID];if(E){let o=0,h=0,w=0;if(v){const t=v?v.getAtTileOffset(l,C,b):0,[e,n,r]=m.upVector(l.canonical,C,b);o=t*e*_,h=t*n*_,w=t*r*_}let[S,T,R,P]=ie(f.projectedAnchorX+o,f.projectedAnchorY+h,f.projectedAnchorZ+w,r?y:a);const O=se(s.getCameraToCenterDistance(m),P);let I=i.evaluateSizeForFeature(e.textSizeData,c,f)*O/t.ONE_EM;r&&(I*=e.tilePixelRatio/u);const A=dr(E,I);r?(({x:S,y:T,z:R}=m.projectTilePoint(C+A.x,b+A.y,l.canonical)),[S,T,R]=ie(S+o,T+h,R+w,a)):(n&&A._rotate(-s.angle),S+=A.x,T+=A.y,R=0);const D=e.allowVerticalPlacement&&f.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<x;e++)t.addDynamicAttributes(d,S,T,R,D);p&&f.associatedIconIndex>=0&&(g[f.associatedIconIndex]={x:S,y:T,z:R,angle:D})}else ge(x,d)}if(p){f.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const r=n.get(e),{numGlyphs:o}=r,i=g[e];if(r.hidden||!i)ge(o,f);else{const{x:e,y:n,z:r,angle:s}=i;for(let i=0;i<o;i++)t.addDynamicAttributes(f,e,n,r,s)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(d)}function gr(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function mr(e,n,r,o,i,s,a,l,u,c,p,h){const d=e.context,f=d.gl,g=e.transform,m="map"===l,y="map"===u,v=m&&"point"!==r.layout.get("symbol-placement"),_=m&&!y&&!v,w=void 0!==r.layout.get("symbol-sort-key").constantOr(1);let C=!1;const b=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),x=[t.mercatorXfromLng(g.center.lng),t.mercatorYfromLat(g.center.lat)],E=r.layout.get("text-variable-anchor"),S="globe"===g.projection.name,T=[],R=[0,-1,0];let P=R;!S&&!g.mercatorFromTransition||m||(P=function(e){const n=e._camera.getWorldToCamera(e.worldSize,1),r=t.multiply([],n,e.globeMatrix);t.invert(r,r);const o=[0,0,0],i=[0,1,0,0];return t.transformMat4$1(i,i,r),o[0]=i[0],o[1]=i[1],o[2]=i[2],t.normalize(o,o),o}(g));for(const O of o){const o=n.getTile(O),l=o.getBucket(r);if(!l)continue;if("mercator"===l.projection.name&&S)continue;const u=i?l.text:l.icon;if(!u||l.fullyClipped||!u.segments.get().length)continue;const p=u.programConfigurations.get(r.id),h=i||l.sdfIcons,d=i?l.textSizeData:l.iconSizeData,b=y||0!==g.pitch,I=t.evaluateSizeForZoom(d,g.zoom);let A,D,M,L,N=[0,0],F=null;if(i)D=o.glyphAtlasTexture,M=f.LINEAR,A=o.glyphAtlasTexture.size,l.iconsInText&&(N=o.imageAtlasTexture.size,F=o.imageAtlasTexture,L=b||e.options.rotating||e.options.zooming||"composite"===d.kind||"camera"===d.kind?f.LINEAR:f.NEAREST);else{const t=1!==r.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;D=o.imageAtlasTexture,M=h||e.options.rotating||e.options.zooming||t||b?f.LINEAR:f.NEAREST,A=o.imageAtlasTexture.size}const k="globe"===l.projection.name,G=k?P:R,B=k?t.globeToMercatorTransition(g.zoom):0,V=Ce(O,l.getProjection(),g),z=g.calculatePixelsToTileUnitsMatrix(o),j=ne(V,o.tileID.canonical,y,m,g,l.getProjection(),z),H=e.terrain&&y&&v?t.invert(t.create(),j):hr,U=oe(V,o.tileID.canonical,y,m,g,l.getProjection(),z),W=E&&l.hasTextData(),q="none"!==r.layout.get("icon-text-fit")&&W&&l.hasIconData();if(v){const t=g.elevation,n=t?t.getAtTileOffsetFunc(O,g.center.lat,g.worldSize,l.getProjection()):null,r=re(V,o.tileID.canonical,y,m,g,l.getProjection(),z);le(l,V,e,i,r,U,y,c,n,O)}const X=v||i&&E||q,K=e.translatePosMatrix(V,o,s,a),Y=X?hr:j,Z=e.translatePosMatrix(U,o,s,a,!0),Q=l.getProjection().createInversionMatrix(g,O.canonical),J=[];e.terrainRenderModeElevated()&&y&&J.push("PITCH_WITH_MAP_TERRAIN"),k&&J.push("PROJECTION_GLOBE_VIEW"),X&&J.push("PROJECTED_POS_ON_VIEWPORT");const $=h&&0!==r.paint.get(i?"text-halo-width":"icon-halo-width").constantOr(1);let tt;tt=h?l.iconsInText?sr(d.kind,I,_,y,e,K,Y,Z,A,N,O,B,x,Q,G,l.getProjection()):ir(d.kind,I,_,y,e,K,Y,Z,i,A,!0,O,B,x,Q,G,l.getProjection()):or(d.kind,I,_,y,e,K,Y,Z,i,A,O,B,x,Q,G,l.getProjection());const et={program:e.useProgram(gr(h,i,l),p,J),buffers:u,uniformValues:tt,atlasTexture:D,atlasTextureIcon:F,atlasInterpolation:M,atlasInterpolationIcon:L,isSDF:h,hasHalo:$,tile:o,labelPlaneMatrixInv:H};if(w&&l.canOverlap){C=!0;const e=u.segments.get();for(const n of e)T.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:et})}else T.push({segments:u.segments,sortKey:0,state:et})}C&&T.sort((t,e)=>t.sortKey-e.sortKey);for(const t of T){const n=t.state;if(e.terrain&&e.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!S,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),d.activeTexture.set(f.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,f.CLAMP_TO_EDGE),n.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),n.isSDF){const o=n.uniformValues;n.hasHalo&&(o.u_is_halo=1,yr(n.buffers,t.segments,r,e,n.program,b,p,h,o)),o.u_is_halo=0}yr(n.buffers,t.segments,r,e,n.program,b,p,h,n.uniformValues)}}function yr(e,n,r,o,i,s,a,l,u){const c=o.context,p=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.globeExtVertexBuffer];i.draw(c,c.gl.TRIANGLES,s,a,l,t.CullFaceMode.disabled,u,r.id,e.layoutVertexBuffer,e.indexBuffer,n,r.paint,o.transform.zoom,e.programConfigurations.get(r.id),p)}function vr(e,n,r,o,i,s,a){const l=e.context.gl,u=r.paint.get("fill-pattern"),c=u&&u.constantOr(1);let p,h,d,f,g;a?(h=c&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=l.LINES):(h=c?"fillPattern":"fill",p=l.TRIANGLES);for(const m of o){const o=n.getTile(m);if(c&&!o.patternsLoaded())continue;const y=o.getBucket(r);if(!y)continue;e.prepareDrawTile();const v=y.programConfigurations.get(r.id),_=e.useProgram(h,v);c&&(e.context.activeTexture.set(l.TEXTURE0),o.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers());const w=u.constantOr(null);if(w&&o.imageAtlas){const t=o.imageAtlas.patternPositions[w.toString()];t&&v.setConstantPatternPositions(t)}const C=e.translatePosMatrix(m.projMatrix,o,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(a){f=y.indexBuffer2,g=y.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];d="fillOutlinePattern"===h&&c?jn(C,e,o,t):zn(C,t)}else f=y.indexBuffer,g=y.segments,d=c?Vn(C,e,o):Bn(C);e.prepareDrawProgram(e.context,_,m.toUnwrapped()),_.draw(e.context,p,i,e.stencilModeForClipping(m),s,t.CullFaceMode.disabled,d,r.id,y.layoutVertexBuffer,f,g,r.paint,e.transform.zoom,v)}}function _r(e,n,r,o,i,s,a){const l=e.context,u=l.gl,c=e.transform,p=r.paint.get("fill-extrusion-pattern"),h=p.constantOr(1),d=r.paint.get("fill-extrusion-opacity"),f=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),r.paint.get("fill-extrusion-ambient-occlusion-radius")],g=r.layout.get("fill-extrusion-edge-radius"),m=g>0&&!r.paint.get("fill-extrusion-rounded-roof"),y=m?0:g,v="globe"===c.projection.name?t.fillExtrusionHeightLift():0,_="globe"===c.projection.name,w=_?t.globeToMercatorTransition(c.zoom):0,C=[t.mercatorXfromLng(c.center.lng),t.mercatorYfromLat(c.center.lat)],b=[];_&&b.push("PROJECTION_GLOBE_VIEW"),f[0]>0&&b.push("FAUX_AO"),m&&b.push("ZERO_ROOF_RADIUS");for(const x of o){const o=n.getTile(x),g=o.getBucket(r);if(!g||g.projection.name!==c.projection.name)continue;const m=g.programConfigurations.get(r.id),E=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",m,b);if(e.terrain){const t=e.terrain;if(e.style.terrainSetForDrapingOnly())t.setupElevationDraw(o,E,{useMeterToDem:!0});else{if(!g.enableTerrain)continue;if(t.setupElevationDraw(o,E,{useMeterToDem:!0}),wr(l,n,x,g,r,t),!g.centroidVertexBuffer){const t=E.attributes.a_centroid_pos;void 0!==t&&u.vertexAttrib2f(t,0,0)}}}h&&(e.context.activeTexture.set(u.TEXTURE0),o.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),m.updatePaintBuffers());const S=p.constantOr(null);if(S&&o.imageAtlas){const t=o.imageAtlas.patternPositions[S.toString()];t&&m.setConstantPatternPositions(t)}const T=e.translatePosMatrix(x.projMatrix,o,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),R=c.projection.createInversionMatrix(c,x.canonical),P=r.paint.get("fill-extrusion-vertical-gradient"),O=h?Gn(T,e,P,d,f,y,x,o,v,w,C,R):kn(T,e,P,d,f,y,x,v,w,C,R);e.prepareDrawProgram(l,E,x.toUnwrapped());const I=[];e.terrain&&I.push(g.centroidVertexBuffer),_&&I.push(g.layoutVertexExtBuffer),E.draw(l,l.gl.TRIANGLES,i,s,a,t.CullFaceMode.backCCW,O,r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,r.paint,e.transform.zoom,m,I)}}function wr(e,n,r,o,i,s){const a=[e=>{let n=e.canonical.x-1,r=e.wrap;return n<0&&(n=(1<<e.canonical.z)-1,r--),new t.OverscaledTileID(e.overscaledZ,r,e.canonical.z,n,e.canonical.y)},e=>{let n=e.canonical.x+1,r=e.wrap;return n===1<<e.canonical.z&&(n=0,r++),new t.OverscaledTileID(e.overscaledZ,r,e.canonical.z,n,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=n.getSource().minzoom,r=t=>{const e=n.getTileByID(t);if(e&&e.hasData())return e.getBucket(i)},o=[0,-1,1];for(const n of o){if(t.overscaledZ+n<e)continue;const o=r(t.calculateScaledKey(t.overscaledZ+n));if(o)return o}},u=[0,0,0],c=(e,n)=>(u[0]=Math.min(e.min.y,n.min.y),u[1]=Math.max(e.max.y,n.max.y),u[2]=t.EXTENT-n.min.x>e.max.x?n.min.x-t.EXTENT:e.max.x,u),p=(e,n)=>(u[0]=Math.min(e.min.x,n.min.x),u[1]=Math.max(e.max.x,n.max.x),u[2]=t.EXTENT-n.min.y>e.max.y?n.min.y-t.EXTENT:e.max.y,u),h=[(t,e)=>c(t,e),(t,e)=>c(e,t),(t,e)=>p(t,e),(t,e)=>p(e,t)],d=new t.Point(0,0);let f,g,m;const y=(e,n,o,i,a)=>{const l=[[i?o:e,i?e:o,0],[i?o:n,i?n:o,0]],u=a<0?t.EXTENT+a:a,c=[i?u:(e+n)/2,i?(e+n)/2:u,0];return 0===o&&a<0||0!==o&&a>0?s.getForTilePoints(m,[c],!0,g):l.push(c),s.getForTilePoints(r,l,!0,f),Math.max(l[0][2],l[1][2],c[2])/s.exaggeration()};for(let v=0;v<4;v++){const e=(v<2?1:5)-v,n=o.borders[v];if(0===n.length)continue;const i=m=a[v](r),u=l(i);if(!(u&&u instanceof t.FillExtrusionBucket&&u.enableTerrain))continue;if(o.borderDoneWithNeighborZ[v]===u.canonical.z&&u.borderDoneWithNeighborZ[e]===o.canonical.z)continue;if(g=s.findDEMTileFor(i),!g||!g.dem)continue;if(!f){const t=s.findDEMTileFor(r);if(!t||!t.dem)return;f=t}const c=u.borders[e];let p=0;const _=u.borderDoneWithNeighborZ[e]!==o.canonical.z;if(o.canonical.z===u.canonical.z){for(let r=0;r<n.length;r++){const i=o.featuresOnBorder[n[r]],s=i.borders[v];let a;for(;p<c.length&&(a=u.featuresOnBorder[c[p]],!(a.borders[e][1]>s[0]+3));)_&&u.encodeCentroid(void 0,a,!1),p++;if(a&&p<c.length){const n=p;let r=0;for(;!(a.borders[e][0]>s[1]-3)&&(r++,++p!==c.length);)a=u.featuresOnBorder[c[p]];if(a=u.featuresOnBorder[c[n]],i.intersectsCount()>1||a.intersectsCount()>1||1!==r){1!==r&&(p=n),o.encodeCentroid(void 0,i,!1),_&&u.encodeCentroid(void 0,a,!1);continue}const l=h[v](i,a),f=v%2?t.EXTENT-1:0;d.x=y(l[0],Math.min(t.EXTENT-1,l[1]),f,v<2,l[2]),d.y=0,o.encodeCentroid(d,i,!1),_&&u.encodeCentroid(d,a,!1)}else o.encodeCentroid(void 0,i,!1)}o.borderDoneWithNeighborZ[v]=u.canonical.z,o.needsCentroidUpdate=!0,_&&(u.borderDoneWithNeighborZ[e]=o.canonical.z,u.needsCentroidUpdate=!0)}else{for(const t of n)o.encodeCentroid(void 0,o.featuresOnBorder[t],!1);if(_){for(const t of c)u.encodeCentroid(void 0,u.featuresOnBorder[t],!1);u.borderDoneWithNeighborZ[e]=o.canonical.z,u.needsCentroidUpdate=!0}o.borderDoneWithNeighborZ[v]=u.canonical.z,o.needsCentroidUpdate=!0}}(o.needsCentroidUpdate||!o.centroidVertexBuffer&&0!==o.centroidVertexArray.length)&&o.uploadCentroid(e)}const Cr=new t.Color(1,0,0,1),br=new t.Color(0,1,0,1),xr=new t.Color(0,0,1,1),Er=new t.Color(1,0,1,1),Sr=new t.Color(0,1,1,1);function Tr(e,n,r){const o=e.context,i=e.transform,s=o.gl,a="globe"===i.projection.name,l=a?["PROJECTION_GLOBE_VIEW"]:null;let u=r.projMatrix;if(a&&t.globeToMercatorTransition(i.zoom)>0){const e=t.transitionTileAABBinECEF(r.canonical,i),n=t.globeDenormalizeECEF(e);u=t.multiply(new Float32Array(16),i.globeMatrix,n),t.multiply(u,i.projMatrix,u)}const c=e.useProgram("debug",null,l),p=n.getTileByID(r.key);e.terrain&&e.terrain.setupElevationDraw(p,c);const h=t.DepthMode.disabled,d=t.StencilMode.disabled,f=e.colorModeForRenderPass(),g="$debug";o.activeTexture.set(s.TEXTURE0),e.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),a?p._makeGlobeTileDebugBuffers(e.context,i):p._makeDebugTileBoundsBuffers(e.context,i.projection);const m=p._tileDebugBuffer||e.debugBuffer,y=p._tileDebugIndexBuffer||e.debugIndexBuffer,v=p._tileDebugSegments||e.debugSegments;c.draw(o,s.LINE_STRIP,h,d,f,t.CullFaceMode.disabled,Xn(u,t.Color.red),g,m,y,v,null,null,null,[p._globeTileDebugBorderBuffer]);const _=p.latestRawTileData,w=Math.floor((_&&_.byteLength||0)/1024),C=n.getTile(r).tileSize,b=512/Math.min(C,512)*(r.overscaledZ/i.zoom)*.5;let x=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(x+=" => ".concat(r.overscaledZ)),x+=" ".concat(w,"kb"),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,r=t.context.gl,o=t.debugOverlayCanvas.getContext("2d");o.clearRect(0,0,n.width,n.height),o.shadowColor="white",o.shadowBlur=2,o.lineWidth=1.5,o.strokeStyle="white",o.textBaseline="top",o.font="bold 36px Open Sans, sans-serif",o.fillText(e,5,5),o.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,x);const E=p._tileDebugTextBuffer||e.debugBuffer,S=p._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,T=p._tileDebugTextSegments||e.debugSegments;c.draw(o,s.TRIANGLES,h,d,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Xn(u,t.Color.transparent,b),g,E,S,T,null,null,null,[p._globeTileDebugTextBuffer])}function Rr(t,e,n,r){Or(t,0,e+n/2,t.transform.width,n,r)}function Pr(t,e,n,r){Or(t,e-n/2,0,n,t.transform.height,r)}function Or(e,n,r,o,i,s){const a=e.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,o*t.exported.devicePixelRatio,i*t.exported.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}const Ir=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ar}=Ir;function Dr(t,e,n,r){t.emplaceBack(e,n,r)}class Mr{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,Dr(this.vertexArray,-1,-1,1),Dr(this.vertexArray,1,-1,1),Dr(this.vertexArray,-1,1,1),Dr(this.vertexArray,1,1,1),Dr(this.vertexArray,-1,-1,-1),Dr(this.vertexArray,1,-1,-1),Dr(this.vertexArray,-1,1,-1),Dr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Ar),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function Lr(e,n,r,o,i,s){const a=e.gl,l=n.paint.get("sky-atmosphere-color"),u=n.paint.get("sky-atmosphere-halo-color"),c=n.paint.get("sky-atmosphere-sun-intensity"),p=((t,e,n,r,o)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:n,u_color_tint_r:[r.r,r.g,r.b,r.a],u_color_tint_m:[o.r,o.g,o.b,o.a],u_luminance:5e-5}))(t.fromMat4(t.create$1(),o),i,c,l,u);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,n.skyboxTexture,0),r.draw(e,a.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,p,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Nr=t.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fr{constructor(e){const n=new t.StructArrayLayout5f20;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const r=new t.StructArrayLayout3ui6;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(n,Nr.members),this.indexBuffer=e.createIndexBuffer(r),this.segments=t.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const kr={symbol:function(e,n,r,o,i){if("translucent"!==e.renderPass)return;const s=t.StencilMode.disabled,a=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,o,i,s,a){const l=n.transform,u="map"===i,c="map"===s;for(const p of e){const e=o.getTile(p),n=e.getBucket(r);if(!n||!n.text||!n.text.segments.get().length)continue;const i=t.evaluateSizeForZoom(n.textSizeData,l.zoom),s=Ce(p,n.getProjection(),l),h=l.calculatePixelsToTileUnitsMatrix(e),d=ne(s,e.tileID.canonical,c,u,l,n.getProjection(),h),f="none"!==r.layout.get("icon-text-fit")&&n.hasIconData();if(i){const r=Math.pow(2,l.zoom-e.tileID.overscaledZ);fr(n,u,c,a,t.symbolSize,l,d,p,r,i,f)}}}(o,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),i),0!==r.paint.get("icon-opacity").constantOr(1)&&mr(e,n,r,o,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),s,a),0!==r.paint.get("text-opacity").constantOr(1)&&mr(e,n,r,o,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),s,a),n.map.showCollisionBoxes&&(pr(e,n,r,o,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),pr(e,n,r,o,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,r,o){if("translucent"!==e.renderPass)return;const i=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),a=r.paint.get("circle-stroke-opacity"),l=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0===i.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const u=e.context,c=u.gl,p=e.transform,h=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),d=t.StencilMode.disabled,f=e.colorModeForRenderPass(),g="globe"===p.projection.name,m=[t.mercatorXfromLng(p.center.lng),t.mercatorYfromLat(p.center.lat)],y=[];for(let _=0;_<o.length;_++){const i=o[_],s=n.getTile(i),a=s.getBucket(r);if(!a||a.projection.name!==p.projection.name)continue;const u=a.programConfigurations.get(r.id),c=Wn(r);g&&c.push("PROJECTION_GLOBE_VIEW");const h=e.useProgram("circle",u,c),d=a.layoutVertexBuffer,f=a.globeExtVertexBuffer,v=a.indexBuffer,w=p.projection.createInversionMatrix(p,i.canonical),C={programConfiguration:u,program:h,layoutVertexBuffer:d,globeExtVertexBuffer:f,indexBuffer:v,uniformValues:Un(e,i,s,w,m,r),tile:s};if(l){const e=a.segments.get();for(const n of e)y.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:C})}else y.push({segments:a.segments,sortKey:0,state:C})}l&&y.sort((t,e)=>t.sortKey-e.sortKey);const v={useDepthForOcclusion:!g};for(const _ of y){const{programConfiguration:n,program:o,layoutVertexBuffer:i,globeExtVertexBuffer:s,indexBuffer:a,uniformValues:l,tile:g}=_.state,m=_.segments;e.terrain&&e.terrain.setupElevationDraw(g,o,v),e.prepareDrawProgram(u,o,g.tileID.toUnwrapped()),o.draw(u,c.TRIANGLES,h,d,f,t.CullFaceMode.disabled,l,r.id,i,a,m,r.paint,p.zoom,n,[s])}},heatmap:function(e,n,r,o){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const i=e.context,s=i.gl,a=t.StencilMode.disabled,l=new t.ColorMode([s.ONE,s.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n,r){const o=t.gl,i=e.width*r,s=e.height*r;t.activeTexture.set(o.TEXTURE1),t.viewport.set([0,0,i,s]);let a=n.heatmapFbo;if(!a||a&&(a.width!==i||a.height!==s)){a&&a.destroy();const e=o.createTexture();o.bindTexture(o.TEXTURE_2D,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),a=n.heatmapFbo=t.createFramebuffer(i,s,!1),function(t,e,n,r,o,i){const s=t.gl;s.texImage2D(s.TEXTURE_2D,0,t.isWebGL2&&t.extRenderToTextureHalfFloat?s.RGBA16F:s.RGBA,o,i,0,s.RGBA,t.extRenderToTextureHalfFloat?t.isWebGL2?s.HALF_FLOAT:t.extTextureHalfFloat.HALF_FLOAT_OES:s.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(t,0,e,a,i,s)}else o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),t.bindFramebuffer.set(a.framebuffer)}(i,e,r,"globe"===e.transform.projection.name?.5:.25),i.clear({color:t.Color.transparent});const u=e.transform,c="globe"===u.projection.name,p=c?["PROJECTION_GLOBE_VIEW"]:null,h=c?t.CullFaceMode.frontCCW:t.CullFaceMode.disabled,d=[t.mercatorXfromLng(u.center.lng),t.mercatorYfromLat(u.center.lat)];for(let f=0;f<o.length;f++){const g=o[f];if(n.hasRenderableParent(g))continue;const m=n.getTile(g),y=m.getBucket(r);if(!y||y.projection.name!==u.projection.name)continue;const v=y.programConfigurations.get(r.id),_=e.useProgram("heatmap",v,p),{zoom:w}=e.transform;e.terrain&&e.terrain.setupElevationDraw(m,_),e.prepareDrawProgram(i,_,g.toUnwrapped());const C=u.projection.createInversionMatrix(u,g.canonical);_.draw(i,s.TRIANGLES,t.DepthMode.disabled,a,l,h,Yn(e,g,m,C,d,w,r.paint.get("heatmap-intensity")),r.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,r.paint,e.transform.zoom,v,c?[y.globeExtVertexBuffer]:null)}i.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const r=e.context,o=r.gl,i=n.heatmapFbo;if(!i)return;r.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i.colorAttachment.get()),r.activeTexture.set(o.TEXTURE1);let s=n.colorRampTexture;s||(s=n.colorRampTexture=new t.Texture(r,n.colorRamp,o.RGBA)),s.bind(o.LINEAR,o.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,o.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((t,e,n,r)=>({u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}))(0,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,r))},line:function(e,n,r,o){if("translucent"!==e.renderPass)return;const i=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0===i.constantOr(1)||0===s.constantOr(1))return;const a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),u=e.terrain&&e.terrain.renderingToTexture?1:t.exported.devicePixelRatio,c=r.paint.get("line-dasharray"),p=c.constantOr(1),h=r.layout.get("line-cap"),d=r.paint.get("line-pattern"),f=d.constantOr(1),g=r.paint.get("line-gradient"),m=f?"linePattern":"line",y=e.context,v=y.gl,_=(t=>{const e=[];tr(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const n=t.paint.get("line-trim-offset");0===n[0]&&0===n[1]||e.push("RENDER_LINE_TRIM_OFFSET");const r=t.paint.get("line-pattern").constantOr(1),o=1!==t.paint.get("line-opacity").constantOr(1);return!r&&o&&e.push("RENDER_LINE_ALPHA_DISCARD"),e})(r);let w=_.includes("RENDER_LINE_ALPHA_DISCARD");e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(w=!1);for(const C of o){const o=n.getTile(C);if(f&&!o.patternsLoaded())continue;const i=o.getBucket(r);if(!i)continue;e.prepareDrawTile();const s=i.programConfigurations.get(r.id),b=e.useProgram(m,s,_),x=d.constantOr(null);if(x&&o.imageAtlas){const t=o.imageAtlas.patternPositions[x.toString()];t&&s.setConstantPatternPositions(t)}const E=c.constantOr(null),S=h.constantOr(null);if(!f&&E&&S&&o.lineAtlas){const t=o.lineAtlas.getDash(E,S);t&&s.setConstantPatternPositions(t)}let[T,R]=r.paint.get("line-trim-offset");if("round"===S||"square"===S){const t=1;T!==R&&(0===T&&(T-=t),1===R&&(R+=t))}const P=e.terrain?C.projMatrix:null,O=f?Qn(e,o,r,P,u):Zn(e,o,r,P,i.lineClipsArray.length,u,[T,R]);if(g){const o=i.gradients[r.id];let s=o.texture;if(r.gradientVersion!==o.version){let a=256;if(r.stepInterpolant){const r=n.getSource().maxzoom,o=C.canonical.z===r?Math.ceil(1<<e.transform.maxZoom-C.canonical.z):1;a=t.clamp(t.nextPowerOfTwo(i.maxLineLength/t.EXTENT*1024*o),256,y.maxTextureSize)}o.gradient=t.renderColorRamp({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:o.gradient||void 0,clips:i.lineClipsArray}),o.texture?o.texture.update(o.gradient):o.texture=new t.Texture(y,o.gradient,v.RGBA),o.version=r.gradientVersion,s=o.texture}y.activeTexture.set(v.TEXTURE1),s.bind(r.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}p&&(y.activeTexture.set(v.TEXTURE0),o.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),s.updatePaintBuffers()),f&&(y.activeTexture.set(v.TEXTURE0),o.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),s.updatePaintBuffers()),e.prepareDrawProgram(y,b,C.toUnwrapped());const I=n=>{b.draw(y,v.TRIANGLES,a,n,l,t.CullFaceMode.disabled,O,r.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,r.paint,e.transform.zoom,s,[i.layoutVertexBuffer2])};if(w){const n=e.stencilModeForClipping(C).ref;0===n&&e.terrain&&y.clear({stencil:0});const r={func:v.EQUAL,mask:255};O.u_alpha_discard_threshold=.8,I(new t.StencilMode(r,n,255,v.KEEP,v.KEEP,v.INVERT)),O.u_alpha_discard_threshold=0,I(new t.StencilMode(r,n,255,v.KEEP,v.KEEP,v.KEEP))}else I(e.stencilModeForClipping(C))}w&&(e.resetStencilClippingMasks(),e.terrain&&y.clear({stencil:0}))},fill:function(e,n,r,o){const i=r.paint.get("fill-color"),s=r.paint.get("fill-opacity");if(0===s.constantOr(1))return;const a=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===i.constantOr(t.Color.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const i=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);vr(e,n,r,o,i,a,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const i=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);vr(e,n,r,o,i,a,!0)}},"fill-extrusion":function(e,n,r,o){const i=r.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===e.renderPass){const s=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==i||r.paint.get("fill-extrusion-pattern").constantOr(1))_r(e,n,r,o,s,t.StencilMode.disabled,t.ColorMode.disabled),_r(e,n,r,o,s,e.stencilModeFor3D(),e.colorModeForRenderPass()),e.resetStencilClippingMasks();else{const i=e.colorModeForRenderPass();_r(e,n,r,o,s,t.StencilMode.disabled,i)}}},hillshade:function(e,n,r,o){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const i=e.context,s=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),a=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[u,c]="translucent"!==e.renderPass||l?[{},o]:e.stencilConfigForOverlap(o);for(const p of c){const o=n.getTile(p);if(o.needsHillshadePrepare&&"offscreen"===e.renderPass)_n(e,o,r,s,t.StencilMode.disabled,a);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(p):u[p.overscaledZ];yn(e,p,o,r,s,t,a)}}i.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,n,r,o,i,s){if("translucent"!==e.renderPass)return;if(0===r.paint.get("raster-opacity"))return;if(!o.length)return;const a=e.context,l=a.gl,u=n.getSource(),c=e.useProgram("raster"),p=e.colorModeForRenderPass(),h=e.terrain&&e.terrain.renderingToTexture,[d,f]=u instanceof Pt||h?[{},o]:e.stencilConfigForOverlap(o),g=f[f.length-1].overscaledZ,m=!e.options.moving;for(const y of f){const o=h?t.DepthMode.disabled:e.depthModeForSublayer(y.overscaledZ-g,1===r.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),i=y.toUnwrapped(),f=n.getTile(y);if(h&&(!f||!f.hasData()))continue;const v=h?y.projMatrix:e.transform.calculateProjMatrix(i,m),_=e.terrain&&h?e.terrain.stencilModeForRTTOverlap(y):d[y.overscaledZ],w=s?0:r.paint.get("raster-fade-duration");f.registerFadeDuration(w);const C=n.findLoadedParent(y,0),b=On(f,C,n,e.transform,w);let x,E;e.terrain&&e.terrain.prepareDrawTile();const S="nearest"===r.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),f.texture.bind(S,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),C?(C.texture.bind(S,l.CLAMP_TO_EDGE),x=Math.pow(2,C.tileID.overscaledZ-f.tileID.overscaledZ),E=[f.tileID.canonical.x*x%1,f.tileID.canonical.y*x%1]):f.texture.bind(S,l.CLAMP_TO_EDGE),f.texture.useMipmap&&a.extTextureFilterAnisotropic&&e.transform.pitch>20&&l.texParameterf(l.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax);const T=er(v,E||[0,0],x||1,b,r,u instanceof Pt?u.perspectiveTransform:[0,0]);if(e.prepareDrawProgram(a,c,i),u instanceof Pt)u.boundsBuffer&&u.boundsSegments&&c.draw(a,l.TRIANGLES,o,t.StencilMode.disabled,p,t.CullFaceMode.disabled,T,r.id,u.boundsBuffer,e.quadTriangleIndexBuffer,u.boundsSegments);else{const{tileBoundsBuffer:n,tileBoundsIndexBuffer:i,tileBoundsSegments:s}=e.getTileBoundsBuffers(f);c.draw(a,l.TRIANGLES,o,_,p,t.CullFaceMode.disabled,T,r.id,n,i,s)}}e.resetStencilClippingMasks()},background:function(e,n,r,o){const i=r.paint.get("background-color"),s=r.paint.get("background-opacity");if(0===s)return;const a=e.context,l=a.gl,u=e.transform,c=u.tileSize,p=r.paint.get("background-pattern");if(e.isPatternMissing(p))return;const h=!p&&1===i.a&&1===s&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==h)return;const d=t.StencilMode.disabled,f=e.depthModeForSublayer(0,"opaque"===h?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),g=e.colorModeForRenderPass(),m=e.useProgram(p?"backgroundPattern":"background");let y,v=o;v||(y=e.getBackgroundTiles(),v=Object.values(y).map(t=>t.tileID)),p&&(a.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));for(const _ of v){const h=_.toUnwrapped(),v=o?_.projMatrix:e.transform.calculateProjMatrix(h);e.prepareDrawTile();const w=n?n.getTile(_):y?y[_.key]:new t.Tile(_,c,u.zoom,e),C=p?lr(v,s,e,p,{tileID:_,tileSize:c}):ar(v,s,i);e.prepareDrawProgram(a,m,h);const{tileBoundsBuffer:b,tileBoundsIndexBuffer:x,tileBoundsSegments:E}=e.getTileBoundsBuffers(w);m.draw(a,l.TRIANGLES,f,d,g,t.CullFaceMode.disabled,C,r.id,b,x,E)}},sky:function(e,n,r){const o=e.transform,i="mercator"===o.projection.name||"globe"===o.projection.name?1:t.smoothstep(7,8,o.zoom),s=r.paint.get("sky-opacity")*i;if(0===s)return;const a=e.context,l=r.paint.get("sky-type"),u=new t.DepthMode(a.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),c=e.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===e.renderPass?r.needsSkyboxCapture(e)&&(function(e,n,r,o){const i=e.context,s=i.gl;let a=n.skyboxFbo;if(!a){a=n.skyboxFbo=i.createFramebuffer(32,32,!1),n.skyboxGeometry=new Mr(i),n.skyboxTexture=i.gl.createTexture(),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);for(let t=0;t<6;++t)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,s.RGBA,32,32,0,s.RGBA,s.UNSIGNED_BYTE,null)}i.bindFramebuffer.set(a.framebuffer),i.viewport.set([0,0,32,32]);const l=n.getCenter(e,!0),u=e.useProgram("skyboxCapture"),c=new Float64Array(16);t.identity(c),t.rotateY(c,c,.5*-Math.PI),Lr(i,n,u,c,l,0),t.identity(c),t.rotateY(c,c,.5*Math.PI),Lr(i,n,u,c,l,1),t.identity(c),t.rotateX(c,c,.5*-Math.PI),Lr(i,n,u,c,l,2),t.identity(c),t.rotateX(c,c,.5*Math.PI),Lr(i,n,u,c,l,3),t.identity(c),Lr(i,n,u,c,l,4),t.identity(c),t.rotateY(c,c,Math.PI),Lr(i,n,u,c,l,5),i.viewport.set([0,0,e.width,e.height])}(e,r),r.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,n,r,o,i){const s=e.context,a=s.gl,l=e.transform,u=e.useProgram("skybox");s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,n.skyboxTexture);const c=((t,e,n,r,o)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:r,u_temporal_offset:o}))(l.skyboxMatrix,n.getCenter(e,!1),0,o,i);e.prepareDrawProgram(s,u),u.draw(s,a.TRIANGLES,r,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,c,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,r,u,s,c):"gradient"===l&&"sky"===e.renderPass&&function(e,n,r,o,i){const s=e.context,a=s.gl,l=e.transform,u=e.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new Mr(s)),s.activeTexture.set(a.TEXTURE0);let c=n.colorRampTexture;c||(c=n.colorRampTexture=new t.Texture(s,n.colorRamp,a.RGBA)),c.bind(a.LINEAR,a.CLAMP_TO_EDGE);const p=((e,n,r,o,i)=>({u_matrix:e,u_color_ramp:0,u_center_direction:n,u_radius:t.degToRad(r),u_opacity:o,u_temporal_offset:i}))(l.skyboxMatrix,n.getCenter(e,!1),n.paint.get("sky-gradient-radius"),o,i);e.prepareDrawProgram(s,u),u.draw(s,a.TRIANGLES,r,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,p,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,r,u,s,c)},debug:function(t,e,n){for(let r=0;r<n.length;r++)Tr(t,e,n[r])},custom:function(e,n,r,o){const i=e.context,s=r.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||"offscreen"===e.renderPass)&&r.isLayerDraped()){if("offscreen"===e.renderPass){const n=s.prerender;if(n){if(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),"globe"===e.transform.projection.name){const r=e.transform.pointMerc;n.call(s,i.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(e.transform.zoom),[r.x,r.y],e.transform.pixelsPerMeterRatio)}else n.call(s,i.gl,e.transform.customLayerMatrix());i.setDirty(),e.setBaseState()}}else if("translucent"===e.renderPass){if(e.terrain&&e.terrain.renderingToTexture){const n=s.renderToTile;if(n){const r=o[0].canonical,a=new t.MercatorCoordinate(r.x+o[0].wrap*(1<<r.z),r.y,r.z);i.setDepthMode(t.DepthMode.disabled),i.setStencilMode(t.StencilMode.disabled),i.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),n.call(s,i.gl,a),i.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(t.StencilMode.disabled);const n="3d"===s.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);if(i.setDepthMode(n),"globe"===e.transform.projection.name){const n=e.transform.pointMerc;s.render(i.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(e.transform.zoom),[n.x,n.y],e.transform.pixelsPerMeterRatio)}else s.render(i.gl,e.transform.customLayerMatrix());i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null)}}else t.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Gr{constructor(e,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context=new Et(e,r),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(t,e){const n=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Mn(this,t));const r=this._terrain;this.transform.elevation=n?r:null,r.update(t,this.transform,e)}_updateFog(t){const e=t.fog;if(!e||"globe"===this.transform.projection.name||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,r]=e.getFovAdjustedRange(this.transform._fov);if(n>r)return void(this.transform.fogCullDistSq=null);const o=n+.78*(r-n);this.transform.fogCullDistSq=o*o}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,n){if(this.width=e*t.exported.devicePixelRatio,this.height=n*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize()}setup(){const e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const o=new t.StructArrayLayout2i4;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(-1,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.mercatorBoundsBuffer=e.createVertexBuffer(i,t.boundsAttributes.members),this.mercatorBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);const a=new t.StructArrayLayout1ui2;for(const t of[0,1,3,2,0])a.emplaceBack(t);this.debugIndexBuffer=e.createIndexBuffer(a),this.emptyTexture=new t.Texture(e,new t.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=t.create();const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now()),this.atmosphereBuffer=new Fr(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(e,n.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,Pn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,n,r){if(!n||this.currentStencilSource===n.id||!e.isTileClipped()||!r||0===r.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let t=!1;for(const e of r)if(void 0===this._tileClippingMaskIDs[e.key]){t=!0;break}if(!t)return}this.currentStencilSource=n.id;const o=this.context,i=o.gl;this.nextStencilID+r.length>256&&this.clearStencil(),o.setColorMode(t.ColorMode.disabled),o.setDepthMode(t.DepthMode.disabled);const s=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of r){const e=n.getTile(a),r=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,{tileBoundsBuffer:l,tileBoundsIndexBuffer:u,tileBoundsSegments:c}=this.getTileBoundsBuffers(e);s.draw(o,i.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:i.ALWAYS,mask:0},r,255,i.KEEP,i.KEEP,i.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Pn(a.projMatrix),"$clipping",l,u,c)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new t.StencilMode({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new t.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,r=e.sort((t,e)=>e.overscaledZ-t.overscaledZ),o=r[r.length-1].overscaledZ,i=r[0].overscaledZ-o+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let r=0;r<i;r++)e[r+o]=new t.StencilMode({func:n.GEQUAL,mask:255},r+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=i,[e,r]}return[{[o]:t.StencilMode.disabled},r]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,n,r){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const o=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(r||this.context.gl.LEQUAL,n,[o,o])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const r=this.style.order,o=this.style._sourceCaches;for(const t in o){const e=o[t];e.used&&e.prepare(this.context)}const i={},s={},a={};for(const t in o){const e=o[t];i[t]=e.getVisibleCoordinates(),s[t]=i[t].slice().reverse(),a[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<r.length;t++)if(this.style._layers[r[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new t.GlobeSharedBuffers(this.context)),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const t of r){const n=this.style._layers[t],r=e._getLayerSourceCache(n);if(!n.hasOffscreenPass()||n.isHidden(this.transform.zoom))continue;const o=r?s[r.id]:void 0;("custom"===n.type||n.isSky()||o&&o.length)&&this.renderLayer(this,r,n,o)}this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon];const l=this.terrain;if(l&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&l.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[r[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky())continue;const o=n?s[n.id]:void 0;this._renderTileClippingMasks(t,n,o),this.renderLayer(this,n,t,o)}if(this.style.fog&&this.transform.projection.supportsFog&&function(e,n){const r=e.context,o=r.gl,i=e.transform,s=new t.DepthMode(o.LEQUAL,t.DepthMode.ReadOnly,[0,1]),a=e.useProgram("globeAtmosphere",null,"globe"===i.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=t.globeToMercatorTransition(i.zoom),u=n.properties.get("color").toArray01(),c=n.properties.get("high-color").toArray01(),p=n.properties.get("space-color").toArray01PremultipliedAlpha(),h=t.identity$1([]);t.rotateY$1(h,h,-t.degToRad(i._center.lng)),t.rotateX$1(h,h,t.degToRad(i._center.lat)),t.rotateZ$1(h,h,i.angle),t.rotateX$1(h,h,-i._pitch);const d=t.fromQuat(new Float32Array(16),h),f=t.mapValue(n.properties.get("star-intensity"),0,1,0,.25),g=5e-4,m=t.mapValue(n.properties.get("horizon-blend"),0,1,g,.25),y=t.globeUseCustomAntiAliasing(e,r,i)&&m===g?i.worldSize/(2*Math.PI*1.025)-1:i.globeRadius,v=e.frameCounter/1e3%1,_=t.length(i.globeCenterInViewSpace),w=Math.sqrt(Math.pow(_,2)-Math.pow(y,2)),C=Math.acos(w/_),b=((e,n,r,o,i,s,a,l,u,c,p,h,d,f)=>({u_frustum_tl:e,u_frustum_tr:n,u_frustum_br:r,u_frustum_bl:o,u_horizon:i,u_transition:s,u_fadeout_range:a,u_color:l,u_high_color:u,u_space_color:c,u_star_intensity:p,u_star_size:5*t.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:h,u_horizon_angle:d,u_rotation_matrix:f}))(i.frustumCorners.TL,i.frustumCorners.TR,i.frustumCorners.BR,i.frustumCorners.BL,i.frustumCorners.horizon,l,m,u,c,p,f,v,C,d);e.prepareDrawProgram(r,a);const x=e.atmosphereBuffer;x&&a.draw(r,o.TRIANGLES,s,t.StencilMode.disabled,t.ColorMode.alphaBlended,t.CullFaceMode.backCW,b,"skybox",x.vertexBuffer,x.indexBuffer,x.segments)}(this,this.style.fog),this.renderPass="sky",(t.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const t=this.style._layers[r[this.currentLayer]],n=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,n,t,n?s[n.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;){const t=this.style._layers[r[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const o=n?("symbol"===t.type?a:s)[n.id]:void 0;this._renderTileClippingMasks(t,n,n?i[n.id]:void 0),this.renderLayer(this,n,t,o),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let n=null;t.values(this.style._layers).forEach(t=>{const r=e._getLayerSourceCache(t);r&&!t.isHidden(this.transform.zoom)&&(!n||n.getSource().maxzoom<r.getSource().maxzoom)&&(n=r)}),n&&this.options.showTileBoundaries&&kr.debug(this,n,n.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;Rr(t,t.transform.height-(e.top||0),3,Cr),Rr(t,e.bottom||0,3,br),Pr(t,e.left||0,3,xr),Pr(t,t.transform.width-(e.right||0),3,Er);const n=t.transform.centerPoint;!function(t,e,n,r){Or(t,e-1,n-10,2,20,r),Or(t,e-10,n-1,20,2,r)}(t,n.x,t.transform.height-n.y,Sr)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||r&&r.length)&&(this.id=n.id,this.gpuTimingStart(n),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(n.type)||t.terrain&&"custom"===n.type)&&kr[n.type](t,e,n,r,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,e=t.createQueryEXT();this.deferredRenderGpuTimeQueries.push(e),t.beginQueryEXT(t.TIME_ELAPSED_EXT,e)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const e={};for(const n in t){const r=t[n],o=this.context.extTimerQuery,i=o.getQueryObjectEXT(r.query,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(r.query),e[n]=i}return e}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const e=this.context.extTimerQuery;let n=0;for(const r of t)n+=e.getQueryObjectEXT(r,e.QUERY_RESULT_EXT)/1e6,e.deleteQueryEXT(r);return n}translatePosMatrix(e,n,r,o,i){if(!r[0]&&!r[1])return e;const s=i?"map"===o?this.transform.angle:0:"viewport"===o?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);r=[r[0]*e-r[1]*t,r[0]*t+r[1]*e]}const a=[i?r[0]:I(n,r[0],this.transform.zoom),i?r[1]:I(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,a),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){return null===t||void 0!==t&&!this.imageManager.getPattern(t.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=this.terrain&&0===this.terrain.exaggeration(),n=this.style&&this.style.fog,r=[];return this.terrainRenderModeElevated()&&r.push("TERRAIN"),"globe"===this.transform.projection.name&&r.push("GLOBE"),e&&r.push("ZERO_EXAGGERATION"),n&&!t&&0!==n.getOpacity(this.transform.pitch)&&r.push("FOG"),t&&r.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&r.push("OVERDRAW_INSPECTOR"),r}useProgram(t,e,n){this.cache=this.cache||{};const r=n||[],o=this.currentGlobalDefines().concat(r),i=Ln.cacheKey(hn[t],t,o,e);return this.cache[i]||(this.cache[i]=new Ln(this.context,t,hn[t],e,ur[t],o)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(e,n,r){if(this.terrain&&this.terrain.renderingToTexture)return;const o=this.style.fog;if(o){const i=o.getOpacity(this.transform.pitch),s=((e,n,r,o,i,s,a,l,u,c,p)=>{const h=e.transform,d=n.properties.get("color").toArray01();d[3]=o;const f=e.frameCounter/1e3%1;return{u_fog_matrix:r?h.calculateFogTileMatrix(r):e.identityMat,u_fog_range:n.getFovAdjustedRange(h._fov),u_fog_color:d,u_fog_horizon_blend:n.properties.get("horizon-blend"),u_fog_temporal_offset:f,u_frustum_tl:i,u_frustum_tr:s,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:u,u_globe_radius:c,u_viewport:p,u_globe_transition:t.globeToMercatorTransition(h.zoom),u_is_globe:+("globe"===h.projection.name)}})(this,o,r,i,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*t.exported.devicePixelRatio,this.transform.height*t.exported.devicePixelRatio]);n.setFogUniformValues(e,s)}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,n=this._backgroundTiles={},r=this.transform.coveringTiles({tileSize:512});for(const o of r)n[o.key]=e[o.key]||new t.Tile(o,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}}class Br{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=r}interpolate(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,r)),this}getCenter(e,n){const r=t.clamp((this.left+e-this.right)/2,0,e),o=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.Point(r,o)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Br(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Vr(e,n){const r=t.getColumn(e,3);t.fromQuat(e,n),t.setColumn(e,3,r)}function zr(e,n){const r=t.identity$1([]);return t.rotateZ$1(r,r,-n),t.rotateX$1(r,r,-e),r}function jr(e,n){const r=[e[0],e[1],0],o=[n[0],n[1],0];if(t.length(r)>=1e-15){const e=t.normalize([],r);t.scale$2(o,e,t.dot(o,e)),n[0]=o[0],n[1]=o[1]}const i=t.cross([],n,e);if(t.len(i)<1e-15)return null;const s=Math.atan2(-i[1],i[0]);return zr(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),s)}class Hr{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){if(e){const n=e instanceof t.MercatorCoordinate?e:new t.MercatorCoordinate(e[0],e[1],e[2]);this._renderWorldCopies&&(n.x=t.wrap(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const r=this.position,o=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)):0,i=t.MercatorCoordinate.fromLngLat(e,o),s=[i.x-r.x,i.y-r.y,i.z-r.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=jr(s,n)}setPitchBearing(e,n){this.orientation=zr(t.degToRad(e),t.degToRad(-n))}}class Ur{constructor(e,n){this._transform=t.identity([]),this.orientation=n,this.position=e}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const e=t.getColumn(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var n;e&&t.setColumn(this._transform,3,[(n=e)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||t.identity$1([]),e&&Vr(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=zr(t,e),Vr(this._transform,this._orientation)}forward(){const e=t.getColumn(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=t.getColumn(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=t.getColumn(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,n){const r=new Float64Array(16);return t.invert(r,this.getWorldToCamera(e,n)),r}getWorldToCameraPosition(e,n,r){const o=this.position;t.scale$2(o,o,-e);const i=new Float64Array(16);return t.fromScaling(i,[r,r,r]),t.translate(i,i,o),i[10]*=n,i}getWorldToCamera(e,n){const r=new Float64Array(16),o=new Float64Array(4),i=this.position;return t.conjugate(o,this._orientation),t.scale$2(i,i,-e),t.fromQuat(r,o),t.translate(r,r,i),r[1]*=-1,r[5]*=-1,r[9]*=-1,r[13]*=-1,r[8]*=n,r[9]*=n,r[10]*=n,r[11]*=n,r}getCameraToClipPerspective(e,n,r,o){const i=new Float64Array(16);return t.perspective(i,e,n,r,o),i}getDistanceToElevation(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=0===e?0:t.mercatorZfromAltitude(e,n?t.latFromMercatorY(this.position[1]):this.position[1]),o=this.forward();return(r-this.position[2])/o[2]}clone(){return new Ur([...this.position],[...this.orientation])}}function Wr(e,n){const r=Xr(e.projection,e.zoom,e.width,e.height),o=function(e,n,r,o,i){const s=new t.LngLat(r.lng-180*Kr,r.lat),a=new t.LngLat(r.lng+180*Kr,r.lat),l=e.project(s.lng,s.lat),u=e.project(a.lng,a.lat),c=-Math.atan2(u.y-l.y,u.x-l.x),p=t.MercatorCoordinate.fromLngLat(r);p.y=t.clamp(p.y,-1+Kr,1-Kr);const h=p.toLngLat(),d=e.project(h.lng,h.lat),f=t.MercatorCoordinate.fromLngLat(h);f.x+=Kr;const g=f.toLngLat(),m=e.project(g.lng,g.lat),y=Zr(m.x-d.x,m.y-d.y,c),v=t.MercatorCoordinate.fromLngLat(h);v.y+=Kr;const _=v.toLngLat(),w=e.project(_.lng,_.lat),C=Zr(w.x-d.x,w.y-d.y,c),b=Math.abs(y.x)/Math.abs(C.y),x=t.identity([]);t.rotateZ(x,x,-c*(1-(i?0:o)));const E=t.identity([]);return t.scale(E,E,[1,1-(1-b)*o,1]),E[4]=-C.x/C.y*o,t.rotateZ(E,E,c),t.multiply(E,x,E),E}(e.projection,0,e.center,r,n),i=qr(e);return t.scale(o,o,[i,i,1]),o}function qr(e){const n=e.projection,r=Xr(e.projection,e.zoom,e.width,e.height),o=Yr(n,e.center),i=Yr(n,t.LngLat.convert(n.center));return Math.pow(2,o*r+(1-r)*i)}function Xr(e,n,r,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const s=e.range;if(!s)return 0;const a=Math.min(i,Math.max(r,o)),l=Math.log(a/1024)/Math.LN2;return t.smoothstep(s[0]+l,s[1]+l,n)}const Kr=1/4e4;function Yr(e,n){const r=t.clamp(n.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),o=new t.LngLat(n.lng-180*Kr,r),i=new t.LngLat(n.lng+180*Kr,r),s=e.project(o.lng,r),a=e.project(i.lng,r),l=t.MercatorCoordinate.fromLngLat(o),u=t.MercatorCoordinate.fromLngLat(i),c=a.x-s.x,p=a.y-s.y,h=u.x-l.x,d=u.y-l.y,f=Math.sqrt((h*h+d*d)/(c*c+p*p));return Math.log(f)/Math.LN2}function Zr(t,e,n){const r=Math.cos(n),o=Math.sin(n);return{x:t*r-e*o,y:t*o+e*r}}class Qr{constructor(e,n,r,o,i,s,a){this.tileSize=512,this._renderWorldCopies=void 0===i||i,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==o?60:o,this.setProjection(s),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Br,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ur,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const t=new Qr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||n)&&this._updateCameraOnTerrain(),(t||n)&&this._constrainCamera(e),this._calcMatrices()}getProjection(){return t.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=t.getProjection(this.projectionOptions);const o=!e(r,this.getProjection());return o&&this._calcMatrices(),this.mercatorFromTransition=!1,o}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=t.getProjection({name:"mercator"});const n=e!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.Point(this.width,this.height)}get bearing(){return t.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const n=-e*Math.PI/180;var r;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(r=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r),function(t,e,n){var r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l+i*a,t[1]=o*l+s*a,t[2]=r*-a+i*l,t[3]=o*-a+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=t.degToRad(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],r=this.horizonLineFromTop();let o=0,i=0;for(let s=0;s<n.length;s++){const a=new t.Point(n[s][0]*this.width,r+n[s][1]*(this.height-r)),l=e.pointCoordinate(a);if(!l)continue;const u=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);o+=l[3]*u,i+=u}return 0===i?NaN:o/i}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,e=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),n=this.pixelsPerMeter/this.worldSize*e,r=this._mercatorZfromZoom(t),o=this._mercatorZfromZoom(this._maxZoom),i=Math.max(r-n,o);this._setZoom(this._zoomFromMercatorZ(i))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let r;r=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const o=t.length(t.sub([],this._camera.position,r));return t.clamp(this._zoomFromMercatorZ(o),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const r=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(r,this._camera.position)||(this._setCameraPosition(r),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new Hr;return n.position=new t.MercatorCoordinate(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(e){if(!t.length$1(e))return!1;t.normalize$1(e,e);const n=t.transformQuat([],[0,0,-1],e),r=t.transformQuat([],[0,-1,0],e);if(r[2]<0)return!1;const o=jr(n,r);return!!o&&(this._camera.orientation=o,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,r=this.zoomScale(this.maxZoom)*this.tileSize,o=this.cameraToCenterDistance;e[2]=t.clamp(e[2],o/r,o/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.UnwrappedTileID(0,e)];if(this.renderWorldCopies){const r=this.pointCoordinate(new t.Point(0,0)),o=this.pointCoordinate(new t.Point(this.width,0)),i=this.pointCoordinate(new t.Point(this.width,this.height)),s=this.pointCoordinate(new t.Point(0,this.height)),a=Math.floor(Math.min(r.x,o.x,i.x,s.x)),l=Math.floor(Math.max(r.x,o.x,i.x,s.x)),u=1;for(let c=a-u;c<=l+u;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e))}return n}coveringTiles(e){let n=this.coveringZoomLevel(e);const r=n,o=this.elevation&&!e.isTerrainDEM,i="mercator"===this.projection.name;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const s=this.locationCoordinate(this.center),a=this.center.lat,l=1<<n,u=[l*s.x,l*s.y,0],c="globe"===this.projection.name,p=!c,h=t.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,p),d=c?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),f=l*t.mercatorZfromAltitude(1,this.center.lat),g=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),m=[l*d.x,l*d.y,g*(p?1:f)],y=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),v=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?n:0,_=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,w=e.isTerrainDEM?-_:this._elevation?this._elevation.getMinElevationBelowMSL():0,C=this.projection.isReprojectedInTileSpace?qr(this):1,b=e=>{const n=1/4e4,r=new t.MercatorCoordinate(e.x+n,e.y,e.z),o=new t.MercatorCoordinate(e.x,e.y+n,e.z),i=e.toLngLat(),s=r.toLngLat(),a=o.toLngLat(),l=this.locationCoordinate(i),u=this.locationCoordinate(s),c=this.locationCoordinate(a),p=Math.hypot(u.x-l.x,u.y-l.y),h=Math.hypot(c.x-l.x,c.y-l.y);return Math.sqrt(p*h)*C/n},x=e=>{const n=_,r=w;return{aabb:t.tileAABB(this,l,0,0,0,e,r,n,this.projection),zoom:0,x:0,y:0,minZ:r,maxZ:n,wrap:e,fullyVisible:!1}},E=[];let S=[];const T=n,R=e.reparseOverscaled?r:n,P=t=>t*t,O=P((g-this._centerAltitude)*f),I=t=>{if(!this._elevation||!t.tileID||!i)return;const e=this._elevation.getMinMaxForTile(t.tileID),n=t.aabb;e?(n.min[2]=e.min,n.max[2]=e.max,n.center[2]=(n.min[2]+n.max[2])/2):(t.shouldSplit=A(t),t.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},A=e=>{if(e.zoom<v)return!0;if(e.zoom===T)return!1;if(null!=e.shouldSplit)return e.shouldSplit;const n=e.aabb.distanceX(m),i=e.aabb.distanceY(m);let s=O,l=1;if(c){s=P(e.aabb.distanceZ(m));const n=Math.pow(2,e.zoom),r=t.latFromMercatorY((e.y+1)/n),o=t.latFromMercatorY(e.y/n),i=Math.min(Math.max(a,r),o),u=t.circumferenceAtLatitude(i)/t.circumferenceAtLatitude(a);if(l=i===a?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,u/this._mercatorScaleRatio),this.zoom<=t.GLOBE_ZOOM_THRESHOLD_MIN&&e.zoom===T-1&&u>=.9)return!0}else if(o&&(s=P(e.aabb.distanceZ(m)*f)),this.projection.isReprojectedInTileSpace&&r<=5){const n=Math.pow(2,e.zoom),r=b(new t.MercatorCoordinate((e.x+.5)/n,(e.y+.5)/n));l=r>.85?1:r}const u=n*n+i*i+s;return u<P((1<<T-e.zoom)*y*l*((t,e)=>{if(e*P(.707)<t)return 1;const n=Math.sqrt(e/t);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(s,O),u))};if(this.renderWorldCopies)for(let t=1;t<=3;t++)E.push(x(-t)),E.push(x(t));for(E.push(x(0));E.length>0;){const r=E.pop(),s=r.x,a=r.y;let p=r.fullyVisible;if(!p){const t=r.aabb.intersects(h);if(0===t)continue;p=2===t}if(r.zoom!==T&&A(r))for(let e=0;e<4;e++){const n=(s<<1)+e%2,u=(a<<1)+(e>>1),h={aabb:i?r.aabb.quadrant(e):t.tileAABB(this,l,r.zoom+1,n,u,r.wrap,r.minZ,r.maxZ,this.projection),zoom:r.zoom+1,x:n,y:u,wrap:r.wrap,fullyVisible:p,tileID:void 0,shouldSplit:void 0,minZ:r.minZ,maxZ:r.maxZ};o&&!c&&(h.tileID=new t.OverscaledTileID(r.zoom+1===T?R:r.zoom+1,r.wrap,r.zoom+1,n,u),I(h)),E.push(h)}else{const o=r.zoom===T?R:r.zoom;if(e.minzoom&&e.minzoom>o)continue;const i=u[0]-(.5+s+(r.wrap<<r.zoom))*(1<<n-r.zoom),l=u[1]-.5-a,c=r.tileID?r.tileID:new t.OverscaledTileID(o,r.wrap,r.zoom,s,a);S.push({tileID:c,distanceSq:i*i+l*l})}}if(this.fogCullDistSq){const n=this.fogCullDistSq,r=this.horizonLineFromTop();S=S.filter(o=>{const i=[0,0,0,1],s=[t.EXTENT,t.EXTENT,0,1],a=this.calculateFogTileMatrix(o.tileID.toUnwrapped());t.transformMat4$1(i,i,a),t.transformMat4$1(s,s,a);const l=t.getAABBPointSquareDist(i,s);if(0===l)return!0;let u=!1;const c=this._elevation;if(c&&l>n&&0!==r){const n=this.calculateProjMatrix(o.tileID.toUnwrapped());let i;e.isTerrainDEM||(i=c.getMinMaxForTile(o.tileID)),i||(i={min:w,max:_});const s=t.furthestTileCorner(this.rotation),a=[s[0]*t.EXTENT,s[1]*t.EXTENT,i.max];t.transformMat4(a,a,n),u=(1-a[1])*this.height*.5<r}return l<n||u})}return S.sort((t,e)=>t.distanceSq-e.distanceSq).map(t=>t.tileID)}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.clamp(e.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),r=this.projection.project(e.lng,n);return new t.Point(r.x*this.worldSize,r.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/t.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,n){let r,o;const i=this.centerPoint;if("globe"===this.projection.name){const t=this.worldSize;r=(n.x-i.x)/t,o=(n.y-i.y)/t}else{const t=this.pointCoordinate(n),e=this.pointCoordinate(i);r=t.x-e.x,o=t.y-e.y}const s=this.locationCoordinate(e);this.setLocation(new t.MercatorCoordinate(s.x-r,s.y-o))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e,n){const r=n?t.mercatorZfromAltitude(n,e.lat):void 0,o=this.projection.project(e.lng,e.lat);return new t.MercatorCoordinate(o.x,o.y,r)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(e,n){const r=null!=n?n:this._centerAltitude,o=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4$1(o,o,this.pixelMatrixInverse),t.transformMat4$1(i,i,this.pixelMatrixInverse);const s=i[3];t.scale$1(o,o,1/o[3]),t.scale$1(i,i,1/s);const a=o[2],l=i[2];return{p0:o,p1:i,t:a===l?0:(r-a)/(l-a)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],r=[e.x,e.y,1,1];return t.transformMat4$1(n,n,this.pixelMatrixInverse),t.transformMat4$1(r,r,this.pixelMatrixInverse),t.scale$1(n,n,1/n[3]),t.scale$1(r,r,1/r[3]),n[2]=t.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,r[2]=t.mercatorZfromAltitude(r[2],this._center.lat)*this.worldSize,t.scale$1(n,n,1/this.worldSize),t.scale$1(r,r,1/this.worldSize),new t.Ray([n[0],n[1],n[2]],t.normalize([],t.sub([],r,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:r,t:o}=e,i=t.mercatorZfromAltitude(n[2],this._center.lat),s=t.mercatorZfromAltitude(r[2],this._center.lat);return new t.MercatorCoordinate(t.number(n[0],r[0],o)/this.worldSize,t.number(n[1],r[1],o)/this.worldSize,t.number(i,s,o))}pointCoordinate(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,t.x,t.y,e)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let n=this.projection.pointCoordinate3D(this,e.x,e.y);if(n)return new t.MercatorCoordinate(n[0],n[1],n[2]);let r=0,o=this.horizonLineFromTop();if(e.y>o)return this.pointCoordinate(e);const i=.02*o,s=e.clone();for(let a=0;a<10&&o-r>i;a++){s.y=t.number(r,o,.66);const e=this.projection.pointCoordinate3D(this,s.x,s.y);e?(o=s.y,n=e):r=s.y}return n?new t.MercatorCoordinate(n[0],n[1],n[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(e);const n=this.pointCoordinate(e);return n.y>=0&&n.y<=1}_coordinatePoint(e,n){const r=n&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,o=[e.x*this.worldSize,e.y*this.worldSize,r+e.toAltitude(),1];return t.transformMat4$1(o,o,this.pixelMatrix),o[3]>0?new t.Point(o[0]/o[3],o[1]/o[3]):new t.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:n}=this._edgeInsets,r=this.height-this._edgeInsets.bottom,o=this.width-this._edgeInsets.right,i=this.pointLocation3D(new t.Point(n,e)),s=this.pointLocation3D(new t.Point(o,e)),a=this.pointLocation3D(new t.Point(o,r)),l=this.pointLocation3D(new t.Point(n,r));let u=Math.min(i.lng,s.lng,a.lng,l.lng),c=Math.max(i.lng,s.lng,a.lng,l.lng),p=Math.min(i.lat,s.lat,a.lat,l.lat),h=Math.max(i.lat,s.lat,a.lat,l.lat);const d=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,g=(e,n,r,o,i)=>{const s=(e+r)/2,a=(n+o)/2,l=new t.Point(s,a),{lng:m,lat:y}=this.pointLocation3D(l),v=Math.max(0,u-m,p-y,m-c,y-h);u=Math.min(u,m),c=Math.max(c,m),p=Math.min(p,y),h=Math.max(h,y),(i<f||v>d)&&(g(e,n,s,a,i+1),g(s,a,r,o,i+1))};if(g(n,e,o,e,1),g(o,e,o,r,1),g(o,r,n,r,1),g(n,r,n,e,1),"globe"===this.projection.name){const[e,n]=t.polesInViewport(this);e?(h=90,c=180,u=-180):n&&(p=-90,c=180,u=-180)}return new t.LngLatBounds(new t.LngLat(u,p),new t.LngLat(c,h))}_getBoundsRectangular(e,n){const{top:r,left:o}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,a=new t.Point(o,r),l=new t.Point(s,r),u=new t.Point(s,i),c=new t.Point(o,i);let p=this.pointCoordinate(a,e),h=this.pointCoordinate(l,e);const d=this.pointCoordinate(u,n),f=this.pointCoordinate(c,n),g=(t,e)=>(e.y-t.y)/(e.x-t.x);return p.y>1&&h.y>=0?p=new t.MercatorCoordinate((1-f.y)/g(f,p)+f.x,1):p.y<0&&h.y<=1&&(p=new t.MercatorCoordinate(-f.y/g(f,p)+f.x,0)),h.y>1&&p.y>=0?h=new t.MercatorCoordinate((1-d.y)/g(d,h)+d.x,1):h.y<0&&p.y<=1&&(h=new t.MercatorCoordinate(-d.y/g(d,h)+d.x,0)),(new t.LngLatBounds).extend(this.coordinateLocation(p)).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(d))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const e=t.visibleDemTiles.reduce((t,e)=>{if(e.dem){const n=e.dem.tree;t.min=Math.min(t.min,n.minimums[0]),t.max=Math.max(t.max,n.maximums[0])}return t},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(e.min*t.exaggeration(),e.max*t.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-e*(1-this._horizonShift);return t?Math.max(0,n):n}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-t.MAX_MERCATOR_LATITUDE,this.maxLat=t.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=t.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=t.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=t.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,e){return this.projection.createTileMatrix(this,e,t)}calculateDistanceTileData(e){const n=e.key,r=this._distanceTileDataCache;if(r[n])return r[n];const o=e.canonical,i=1/this.height,s=this.cameraWorldSize,a=s/this.zoomScale(o.z),l=(o.x+Math.pow(2,o.z)*e.wrap)*a,u=o.y*a,c=this.point;c.x*=s/this.worldSize,c.y*=s/this.worldSize;const p=this.angle,h=Math.sin(-p),d=-Math.cos(-p);return r[n]={bearing:[h,d],center:[(c.x-l)*i,(c.y-u)*i],scale:a/t.EXTENT*i},r[n]}calculateFogTileMatrix(e){const n=e.key,r=this._fogTileMatrixCache;if(r[n])return r[n];const o=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return t.multiply(o,this.worldToFogMatrix,o),r[n]=new Float32Array(o),r[n]}calculateProjMatrix(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.key,o=n?this._alignedProjMatrixCache:this._projMatrixCache;if(o[r])return o[r];const i=this.calculatePosMatrix(e,this.worldSize);return t.multiply(i,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:n?this.alignedProjMatrix:this.projMatrix,i),o[r]=new Float32Array(i),o[r]}calculatePixelsToTileUnitsMatrix(e){const n=e.tileID.key,r=this._pixelsToTileUnitsCache;if(r[n])return r[n];const o=function(e,n){const{scale:r}=e.tileTransform,o=r*t.EXTENT/(e.tileSize*Math.pow(2,n.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return i=new Float32Array(4),l=(s=n.inverseAdjustmentMatrix)[1],u=s[2],c=s[3],h=(a=[o,o])[1],i[0]=s[0]*(p=a[0]),i[1]=l*p,i[2]=u*h,i[3]=c*h,i;var i,s,a,l,u,c,p,h}(e,this);return r[n]=o,r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const e=1/this.worldSize,n=t.fromScaling([],[e,e,e]);return t.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const e=this._elevation;this._updateCameraState();const n=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(n),o=this._camera.forward(),i=t.mercatorZfromAltitude(1,this._center.lat);r[2]/=i,o[2]/=i,t.normalize(o,o);const s=e.raycast(r,o,e.exaggeration());if(s){const e=t.scaleAndAdd([],r,o,s),n=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),a=(n.z+t.length([n.x-r[0],n.y-r[1],n.z-r[2]*i]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=n.toAltitude(),this._center=this.coordinateLocation(n),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._elevation)return;const n=this._elevation,r=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,o=this._computeCameraPosition(r),i=n.getAtPointOrZero(new t.MercatorCoordinate(...o)),s=this.pixelsPerMeter/this.worldSize*i,a=this._minimumHeightOverTerrain(),l=o[2]-s;if(l<=a)if(l<0||e){const e=this.locationCoordinate(this._center,this._centerAltitude),n=[o[0],o[1],e.z-o[2]],r=t.length(n);n[2]-=(a-l)/this._pixelsPerMercatorPixel;const i=t.length(n);if(0===i)return;t.scale$2(n,n,r/i*this._pixelsPerMercatorPixel),this._camera.position=[o[0],o[1],e.z*this._pixelsPerMercatorPixel-n[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const n=this.center;return n.lat=t.clamp(n.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(n.lng=t.clamp(n.lng,this.minLng,this.maxLng)),this.center=n,void(this._constraining=!1)}const n=this._unmodified,{x:r,y:o}=this.point;let i=0,s=r,a=o;const l=this.width/2,u=this.height/2,c=this.worldMinY*this.scale,p=this.worldMaxY*this.scale;if(o-u<c&&(a=c+u),o+u>p&&(a=p-u),p-c<this.height&&(i=Math.max(i,this.height/(p-c)),a=(p+c)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const t=this.worldMinX*this.scale,e=this.worldMaxX*this.scale,n=this.worldSize/2-(t+e)/2;s=(r+n+this.worldSize)%this.worldSize-n,s-l<t&&(s=t+l),s+l>e&&(s=e-l),e-t<this.width&&(i=Math.max(i,this.width/(e-t)),s=(e+t)/2)}s===r&&a===o||(this.center=this.unproject(new t.Point(s,a))),i&&(this.zoom+=this.scaleZoom(i)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=t.mercatorZfromAltitude(1,this.center.lat)/t.mercatorZfromAltitude(1,t.GLOBE_SCALE_MATCH_LATITUDE));const r=Xr(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,r),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const o="meters"===this.projection.zAxisUnit?n:1,i=this._camera.getWorldToCamera(this.worldSize,o),s=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);s[8]=2*-e.x/this.width,s[9]=2*e.y/this.height;let a=t.mul([],s,i);if(this.projection.isReprojectedInTileSpace){const e=this.locationCoordinate(this.center),n=t.identity([]);t.translate(n,n,[e.x*this.worldSize,e.y*this.worldSize,0]),t.multiply(n,n,Wr(this)),t.translate(n,n,[-e.x*this.worldSize,-e.y*this.worldSize,0]),t.multiply(a,a,n),this.inverseAdjustmentMatrix=function(t){const e=Wr(t,!0);return v([],[e[0],e[1],e[4],e[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=t.scale([],a,[this.worldSize,this.worldSize,this.worldSize/o,1]),this.projMatrix=a,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const l=t.invert([],s);this.frustumCorners=t.FrustumCorners.fromInvProjectionMatrix(l,this.horizonLineFromTop(),this.height);const u=new Float32Array(16);t.identity(u),t.scale(u,u,[1,-1,1]),t.rotateX(u,u,this._pitch),t.rotateZ(u,u,this.angle);const c=t.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),p=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;c[8]=2*-e.x/this.width,c[9]=2*(e.y+p)/this.height,this.skyboxMatrix=t.multiply(u,c,u);const h=this.point,d=h.x,f=h.y,g=this.width%2/2,m=this.height%2/2,y=Math.cos(this.angle),_=Math.sin(this.angle),w=d-Math.round(d)+y*g+_*m,C=f-Math.round(f)+y*m+_*g,b=new Float64Array(a);if(t.translate(b,b,[w>.5?w-1:w,C>.5?C-1:C,0]),this.alignedProjMatrix=b,a=t.create(),t.scale(a,a,[this.width/2,-this.height/2,1]),t.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=t.create(),t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},a=t.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=a,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=t.calculateGlobeMatrix(this);const e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=t.transformMat4(e,e,i),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=a;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,r=this._camera.position,o=1/this.height/this._pixelsPerMercatorPixel,i=[e,e,n];t.scale$2(i,i,o),t.scale$2(r,r,-1),t.multiply$2(r,r,i);const s=t.create();t.translate(s,s,r),t.scale(s,s,i),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,n,o)}_computeCameraPosition(t){const e=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,n=this._camera.forward(),r=this.point,o=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*e-t/this.worldSize*this._centerAltitude;return[r.x/this.worldSize-n[0]*o,r.y/this.worldSize-n[1]*o,t/this.worldSize*this._centerAltitude-n[2]*o]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),r=this._camera.position[2],o=e[2];let i=1;this.projection.wrap&&(this.center=this.center.wrap()),o>0&&(i=Math.min((n-r)/o,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,i),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:r,bearing:o}=this._camera.getPitchBearing(),i=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),a=Math.max((e[2]-i)/Math.cos(r),s),l=this._zoomFromMercatorZ(a);t.scaleAndAdd(e,e,n,a),this._pitch=t.clamp(r,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(o,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new t.MercatorCoordinate(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(e){let n=0,r=t.GLOBE_ZOOM_THRESHOLD_MAX,o=0,i=1/0;for(;r-n>1e-6&&r>n;){const t=n+.5*(r-n),s=this.tileSize*Math.pow(2,t),a=this.getCameraToCenterDistance(this.projection,t,s),l=this.scaleZoom(a/(e*this.tileSize)),u=Math.abs(t-l);u<i&&(i=u,o=t),t<l?n=t:r=t}return o}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(t.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,n){const r=Math.min(e.x,n.x),o=Math.max(e.x,n.x),i=Math.min(e.y,n.y),s=Math.max(e.y,n.y);if(i<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new t.Point(r,i),new t.Point(o,s),new t.Point(r,s),new t.Point(o,i)],l=this.renderWorldCopies?-3:0,u=this.renderWorldCopies?4:1;for(const t of a){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const n=this.rayIntersectionCoordinate(e);if(n.x<l||n.y<0||n.x>u||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.Point(0,0),new t.Point(this.width,this.height))}zoomDeltaToMovement(e,n){const r=t.length(t.sub([],this._camera.position,e)),o=this._zoomFromMercatorZ(r)+n;return r-this._mercatorZfromZoom(o)}getCameraPoint(){if("globe"===this.projection.name){const e=function(e,n){let[r,o,i]=e;const s=[r,o,i,1];t.transformMat4$1(s,s,n);const a=s[3]=Math.max(s[3],1e-6);return s[0]/=a,s[1]/=a,s[2]/=a,s}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new t.Point(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))}}getCameraToCenterDistance(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldSize;const r=Xr(t,e,this.width,this.height,1024),o=t.pixelSpaceConversion(this.center.lat,n,r);return.5/Math.tan(.5*this._fov)*this.height*o}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&t.multiply(e,e,this.globeMatrix),e}}function Jr(t,e){let n=!1,r=null;const o=()=>{r=null,n&&(t(),r=setTimeout(o,e),n=!1)};return()=>(n=!0,r||o(),r)}class $r{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Jr(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),t.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const n=to(e);if(this._hashName){const e=this._hashName;let r=!1;const o=t.window.location.hash.slice(1).split("&").map(t=>{const o=t.split("=")[0];return o===e?(r=!0,"".concat(o,"=").concat(n)):t}).filter(t=>t);return r||o.push("".concat(e,"=").concat(n)),"#".concat(o.join("&"))}return"#".concat(n)}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(t=>t.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const e=this._getCurrentHash();if(e.length>=3&&!e.some(t=>isNaN(t))){const n=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(e[3]||0):t.getBearing();return t.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:n,pitch:+(e[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e)}}function to(t,e){const n=t.getCenter(),r=Math.round(100*t.getZoom())/100,o=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,o),s=Math.round(n.lng*i)/i,a=Math.round(n.lat*i)/i,l=t.getBearing(),u=t.getPitch();let c=e?"/".concat(s,"/").concat(a,"/").concat(r):"".concat(r,"/").concat(a,"/").concat(s);return(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+="/".concat(Math.round(u))),c}const eo={linearity:.3,easing:t.bezier(0,0,.3,1)},no=t.extend({deceleration:2500,maxSpeed:1400},eo),ro=t.extend({deceleration:20,maxSpeed:1400},eo),oo=t.extend({deceleration:1e3,maxSpeed:360},eo),io=t.extend({deceleration:1e3,maxSpeed:90},eo);class so{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.exported.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,o={};if(n.pan.mag()){const i=lo(n.pan.mag(),r,t.extend({},no,e||{}));o.offset=n.pan.mult(i.amount/n.pan.mag()),o.center=this._map.transform.center,ao(o,i)}if(n.zoom){const t=lo(n.zoom,r,ro);o.zoom=this._map.transform.zoom+t.amount,ao(o,t)}if(n.bearing){const e=lo(n.bearing,r,oo);o.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),ao(o,e)}if(n.pitch){const t=lo(n.pitch,r,io);o.pitch=this._map.transform.pitch+t.amount,ao(o,t)}if(o.zoom||o.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;o.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),o.noMoveStart=!0,o}}function ao(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function lo(e,n,r){const{maxSpeed:o,linearity:i,deceleration:s}=r,a=t.clamp(e*i/(n/1e3),-o,o),l=Math.abs(a)/(s*i);return{easing:r.easing,duration:1e3*l,amount:a*(l/2)}}class uo extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=f(n.getCanvasContainer(),r),s=n.unproject(i);super(e,t.extend({point:i,lngLat:s,originalEvent:r},o)),this._defaultPrevented=!1,this.target=n}}class co extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,r){const o="touchend"===e?r.changedTouches:r.touches,i=g(n.getCanvasContainer(),o),s=i.map(t=>n.unproject(t)),a=i.reduce((t,e,n,r)=>t.add(e.div(r.length)),new t.Point(0,0));super(e,{points:i,point:a,lngLats:s,lngLat:n.unproject(a),originalEvent:r}),this._defaultPrevented=!1}}class po extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class ho{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new po(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new uo(t.type,this._map,t))}mouseup(t){this._map.fire(new uo(t.type,this._map,t))}preclick(e){const n=t.extend({},e);n.type="preclick",this._map.fire(new uo(n.type,this._map,n))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||(this.preclick(t),this._map.fire(new uo(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new uo(t.type,this._map,t))}mouseover(t){this._map.fire(new uo(t.type,this._map,t))}mouseout(t){this._map.fire(new uo(t.type,this._map,t))}touchstart(t){return this._firePreventable(new co(t.type,this._map,t))}touchmove(t){this._map.fire(new co(t.type,this._map,t))}touchend(t){this._map.fire(new co(t.type,this._map,t))}touchcancel(t){this._map.fire(new co(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fo{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new uo(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new uo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new uo(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class go{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(c(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e,r=this._startPos,o=this._lastPos;if(!r||!o||o.equals(n)||!this._box&&n.dist(r)<this._clickTolerance)return;this._lastPos=n,this._box||(this._box=i("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const s=Math.min(r.x,n.x),a=Math.max(r.x,n.x),l=Math.min(r.y,n.y),u=Math.max(r.y,n.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform="translate(".concat(s,"px,").concat(l,"px)"),this._box.style.width=a-s+"px",this._box.style.height=u-l+"px")})}mouseupWindow(e,n){if(!this._active)return;const r=this._startPos,o=n;if(r&&0===e.button){if(this.reset(),d(),r.x!==o.x||r.y!==o.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(r,o,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),p(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}function mo(t,e){const n={};for(let r=0;r<t.length;r++)n[t[r].identifier]=e[r];return n}class yo{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){const n=new t.Point(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=mo(r,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const r=mo(n,e);for(const o in this.touches){const t=r[o];(!t||t.dist(this.touches[o])>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class vo{constructor(t){this.singleTap=new yo(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const r=this.singleTap.touchend(t,e,n);if(r){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(r)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class _o{constructor(){this._zoomIn=new vo({numTouches:1,numTaps:2}),this._zoomOut=new vo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const r=this._zoomIn.touchend(t,e,n),o=this._zoomOut.touchend(t,e,n);return r?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(r)},{originalEvent:t})}):o?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const wo={0:1,2:2};class Co{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=m(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),null!=this._eventButton&&function(t,e){const n=wo[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&m(t)===this._eventButton&&(this._moved&&d(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bo extends Co{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class xo extends Co{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class Eo extends Co{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class So{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),t.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(e,n,r){if(this._active&&!(r.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===r.length&&!t.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,n,r)}}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,r){r.length>0&&(this._active=!0);const o=mo(r,n),i=new t.Point(0,0),s=new t.Point(0,0);let a=0;for(const t in o){const e=o[t],n=this._touches[t];n&&(i._add(e),s._add(e.sub(n)),a++,o[t]=e)}if(this._touches=o,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:i.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=i("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class To{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){const r=this._firstTwoTouches;if(!r)return;t.preventDefault();const[o,i]=r,s=Ro(n,e,o),a=Ro(n,e,i);if(!s||!a)return;const l=this._aroundCenter?null:s.add(a).div(2);return this._move([s,a],l,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[r,o]=this._firstTwoTouches,i=Ro(n,e,r),s=Ro(n,e,o);i&&s||(this._active&&d(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ro(t,e,n){for(let r=0;r<t.length;r++)if(t[r].identifier===n)return e[r]}function Po(t,e){return Math.log(t/e)/Math.LN2}class Oo extends To{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Po(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Po(this._distance,n),pinchAround:e}}}function Io(t,e){return 180*t.angleWith(e)/Math.PI}class Ao extends To{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),n&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Io(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=this._startVector;if(!n)return!1;const r=Io(t,n);return Math.abs(r)<e}}function Do(t){return Math.abs(t.y)>Math.abs(t.x)}class Mo extends To{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,Do(t[0].sub(t[1]))&&(this._valid=!1)}_move(e,n,r){const o=this._lastPoints;if(!o)return;const i=e[0].sub(o[0]),s=e[1].sub(o[1]);return this._map._cooperativeGestures&&!t.isFullscreen()&&r.touches.length<3||(this._valid=this.gestureBeginsVertically(i,s,r.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(i.y+s.y)/2*-.5})}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const r=t.mag()>=2,o=e.mag()>=2;if(!r&&!o)return;if(!r||!o)return null==this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const i=t.y>0==e.y>0;return Do(t)&&Do(e)&&i}}const Lo={panStep:100,bearingStep:15,pitchStep:10};class No{constructor(){const t=Lo;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,r=0,o=0,i=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),i=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),i=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Fo,zoom:e?Math.round(a)+e*(t.shiftKey?2:1):a,bearing:s.getBearing()+n*this._bearingStep,pitch:s.getPitch()+r*this._pitchStep,offset:[-o*this._panStep,-i*this._panStep],center:s.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Fo(t){return t*(2-t)}const ko=4.000244140625;class Go{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||t.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=t.exported.now(),o=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%ko==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(o*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=f(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform;"wheel"===this._type&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>ko?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==r&&(r=1/r);const o=n(),i=Math.pow(2,o),s="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):i;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(s*r))),"wheel"===this._type&&(this._startZoom=o,this._easing=this._smoothOutEasing(200)),this._delta=0}const r="number"==typeof this._targetZoom?this._targetZoom:n(),o=this._startZoom,i=this._easing;let s,a=!1;if("wheel"===this._type&&o&&i){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),n=i(e);s=t.number(o,r,n),e<1?this._frameId||(this._frameId=!0):a=!0}else s=r,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:s-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.ease;if(this._prevEase){const e=this._prevEase,r=(t.exported.now()-e.start)/e.duration,o=e.easing(r+.01)-e.easing(r),i=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-i*i);n=t.bezier(i,s,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=i("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(t.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Bo{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vo{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zo{constructor(){this._tap=new vo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const r=e[0],o=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:o/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jo{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ho{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Uo{constructor(t,e,n,r){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wo=t=>t.zoom||t.drag||t.pitch||t.rotate;class qo extends t.Event{}class Xo{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const r=t.sub([],n,e);this.radius=t.length(r[2]<0?t.div([],r,this.constants):[r[0],r[1],0])}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$1(e,e,this.constants);const n=t.scale$2([],e,this.radius);if(n[2]>0){const e=t.scale$2([],[0,0,1],t.dot(n,[0,0,1])),r=t.scale$2([],t.normalize([],[n[0],n[1],0]),this.radius),o=t.add([],n,t.scale$2([],t.sub([],t.add([],r,e),n),2));n[0]=o[0],n[1]=o[1]}return n}}function Ko(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class Yo{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new so(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Xo,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),t.bindAll(["handleEvent","handleWindowEvent"],this);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[o,i,s]of this._listeners)o.addEventListener(i,o===t.window.document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[e,n,r]of this._listeners)e.removeEventListener(n,e===t.window.document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new ho(e,t));const r=e.boxZoom=new go(e,t);this._add("boxZoom",r);const o=new _o,i=new Vo;e.doubleClickZoom=new Bo(i,o),this._add("tapZoom",o),this._add("clickZoom",i);const s=new zo;this._add("tapDragZoom",s);const a=e.touchPitch=new Mo(e);this._add("touchPitch",a);const l=new xo(t),u=new Eo(t);e.dragRotate=new Ho(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);const c=new bo(t),p=new So(e,t);e.dragPan=new jo(n,c,p),this._add("mousePan",c),this._add("touchPan",p,["touchZoom","touchRotate"]);const h=new Ao,d=new Oo;e.touchZoomRotate=new Uo(n,d,h,s),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]),this._add("blockableMapEvent",new fo(e));const f=e.scrollZoom=new Go(e,this);this._add("scrollZoom",f,["mousePan"]);const g=e.keyboard=new No;this._add("keyboard",g);for(const m of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[m]&&e[m].enable(t[m])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wo(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,e,n){for(const r in t)if(r!==n&&(!e||e.indexOf(r)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,"".concat(t.type,"Window"))}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){this._updatingCamera=!0;const n="renderFrame"===t.type,r=n?void 0:t,o={needsRenderFrame:!1},i={},s={},a=t.touches?this._getMapTouches(t.touches):void 0,l=a?g(this._el,a):n?void 0:f(this._el,t);for(const{handlerName:p,handler:h,allowed:d}of this._handlers){if(!h.isEnabled())continue;let n;this._blockedByActive(s,d,p)?h.reset():h[e||t.type]&&(n=h[e||t.type](t,l,a),this.mergeHandlerResult(o,i,n,p,r),n&&n.needsRenderFrame&&this._triggerRenderFrame()),(n||h.isActive())&&(s[p]=h)}const u={};for(const p in this._previousActiveHandlers)s[p]||(u[p]=r);this._previousActiveHandlers=s,(Object.keys(u).length||Ko(o))&&(this._changes.push([o,i,u]),this._triggerRenderFrame()),(Object.keys(s).length||Ko(o))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:c}=o;c&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],c(this._map))}mergeHandlerResult(e,n,r,o,i){if(!r)return;t.extend(e,r);const s={handlerName:o,originalEvent:r.originalEvent||i};void 0!==r.zoomDelta&&(n.zoom=s),void 0!==r.panDelta&&(n.drag=s),void 0!==r.pitchDelta&&(n.pitch=s),void 0!==r.bearingDelta&&(n.rotate=s)}_applyChanges(){const e={},n={},r={};for(const[o,i,s]of this._changes)o.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(o.panDelta)),o.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+o.zoomDelta),o.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+o.bearingDelta),o.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+o.pitchDelta),void 0!==o.around&&(e.around=o.around),void 0!==o.aroundCoord&&(e.aroundCoord=o.aroundCoord),void 0!==o.pinchAround&&(e.pinchAround=o.pinchAround),o.noInertia&&(e.noInertia=o.noInertia),t.extend(n,i),t.extend(r,s);this._updateMapTransform(e,n,r),this._changes=[]}_updateMapTransform(e,n,r){const o=this._map,i=o.transform,s=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!Ko(e)){const t=i.zoom;i.cameraElevationReference="sea",i.recenterOnTerrain(),i.cameraElevationReference="ground",t!==i.zoom&&this._map._update(!0)}if(i._isCameraConstrained&&o._stop(!0),!Ko(e))return void this._fireEvents(n,r,!0);let{panDelta:a,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:p,aroundCoord:h,pinchAround:d}=e;i._isCameraConstrained&&(l>0&&(l=0),i._isCameraConstrained=!1),void 0!==d&&(p=d),(l||(t=>n[t]&&!this._eventsInProgress[t])("drag"))&&p&&(this._dragOrigin=s(i.pointCoordinate3D(p)),this._trackingEllipsoid.setup(i._camera.position,this._dragOrigin)),i.cameraElevationReference="sea",o._stop(!0),p=p||o.transform.centerPoint,u&&(i.bearing+=u),c&&(i.pitch+=c),i._updateCameraState();const f=[0,0,0];if(a)if("mercator"===i.projection.name){const t=this._trackingEllipsoid.projectRay(i.screenPointToMercatorRay(p).dir),e=this._trackingEllipsoid.projectRay(i.screenPointToMercatorRay(p.sub(a)).dir);f[0]=e[0]-t[0],f[1]=e[1]-t[1]}else{const e=i.pointCoordinate(p);if("globe"===i.projection.name){a=a.rotate(-i.angle);const n=i._pixelsPerMercatorPixel/i.worldSize;f[0]=-a.x*t.mercatorScale(t.latFromMercatorY(e.y))*n,f[1]=-a.y*t.mercatorScale(i.center.lat)*n}else{const t=i.pointCoordinate(p.sub(a));e&&t&&(f[0]=t.x-e.x,f[1]=t.y-e.y)}}const g=i.zoom,m=[0,0,0];if(l){const e=s(h||i.pointCoordinate3D(p)),n={dir:t.normalize([],t.sub([],e,i._camera.position))};if(n.dir[2]<0){const r=i.zoomDeltaToMovement(e,l);t.scale$2(m,n.dir,r)}}const y=t.add(f,f,m);i._translateCameraConstrained(y),l&&Math.abs(i.zoom-g)>1e-4&&i.recenterOnTerrain(),i.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,r,!0)}_fireEvents(e,n,r){const o=Wo(this._eventsInProgress),i=Wo(e),s={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(s["".concat(t,"start")]=n),this._eventsInProgress[t]=e[t]}!o&&i&&this._fireEvent("movestart",i.originalEvent);for(const t in s)this._fireEvent(t,s[t]);i&&this._fireEvent("move",i.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const a={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:r}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||r,a["".concat(t,"end")]=l)}for(const t in a)this._fireEvent(t,a[t]);const u=Wo(this._eventsInProgress);if(r&&(o||i)&&!u){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new qo("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Zo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Qo extends t.Evented{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=!1!==n.respectPrefersReducedMotion,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)}panTo(e,n,r){return this.easeTo(t.extend({center:e},n),r)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)}resetNorth(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.LngLatBounds.convert(e);const r=n&&n.bearing||0,o=n&&n.pitch||0,i=e.getNorthWest(),s=e.getSouthEast();return this._cameraForBounds(this.transform,i,s,r,o,n)}_extendCameraOptions(e){const n={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t}}return e.padding=t.extend(n,e.padding),e}_minimumAABBFrustumDistance(t,e){const n=e.max[0]-e.min[0],r=e.max[1]-e.min[1];return n/r>t.aspect?n/(2*Math.tan(.5*t.fovX)*t.aspect):r/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(e,n,r,o,i,s){const a=e.clone(),l=this._extendCameraOptions(s);a.bearing=o,a.pitch=i;const u=t.LngLat.convert(n),c=t.LngLat.convert(r),p=.5*(u.lat+c.lat),h=.5*(u.lng+c.lng),d=t.latLngToECEF(p,h),f=t.normalize([],d),g=t.normalize([],t.cross([],f,[0,1,0])),m=t.cross([],g,f),y=[g[0],g[1],g[2],0,m[0],m[1],m[2],0,f[0],f[1],f[2],0,0,0,0,1],v=[d,t.latLngToECEF(u.lat,u.lng),t.latLngToECEF(c.lat,u.lng),t.latLngToECEF(c.lat,c.lng),t.latLngToECEF(u.lat,c.lng),t.latLngToECEF(p,u.lng),t.latLngToECEF(p,c.lng),t.latLngToECEF(u.lat,h),t.latLngToECEF(c.lat,h)];let _=t.Aabb.fromPoints(v.map(e=>[t.dot(g,e),t.dot(m,e),t.dot(f,e)]));const w=t.transformMat4([],_.center,y);0===t.squaredLength(w)&&t.set(w,0,0,1),t.normalize(w,w),t.scale$2(w,w,t.GLOBE_RADIUS),a.center=t.ecefToLatLng(w);const C=a.getWorldToCameraMatrix(),b=t.invert(new Float64Array(16),C);_=t.Aabb.applyTransform(_,t.multiply([],C,y)),t.transformMat4(w,w,C);const x=.5*(_.max[2]-_.min[2]),E=this._minimumAABBFrustumDistance(a,_),S=t.scale$2([],[0,0,1],x),T=t.add(S,w,S),R=E+(0===a.pitch?0:t.distance(w,T)),P=a.globeCenterInViewSpace,O=t.sub([],w,[P[0],P[1],P[2]]);t.normalize(O,O),t.scale$2(O,O,R);const I=t.add([],w,O);t.transformMat4(I,I,b);const A=t.earthRadius/t.GLOBE_RADIUS,D=t.length(I),M=t.mercatorZfromAltitude(Math.max(D*A-t.earthRadius,Number.EPSILON),0),L=Math.min(a.zoomFromMercatorZAdjusted(M),l.maxZoom);return L>.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"mercator"}),a.zoom=L,this._cameraForBounds(a,n,r,o,i,s)):{center:a.center,zoom:L,bearing:o,pitch:i}}queryTerrainElevation(e,n){const r=this.transform.elevation;return r?(n=t.extend({},{exaggerated:!0},n),r.getAtPoint(t.MercatorCoordinate.fromLngLat(e),null,n.exaggerated)):null}_cameraForBounds(e,n,r,o,i,s){if("globe"===e.projection.name)return this._cameraForBoundsOnGlobe(e,n,r,o,i,s);const a=e.clone(),l=this._extendCameraOptions(s),u=a.padding;a.bearing=o,a.pitch=i;const c=t.LngLat.convert(n),p=t.LngLat.convert(r),h=new t.LngLat(c.lng,p.lat),d=new t.LngLat(p.lng,c.lat),f=a.project(c),g=a.project(p),m=this.queryTerrainElevation(c),y=this.queryTerrainElevation(p),v=this.queryTerrainElevation(h),_=this.queryTerrainElevation(d),w=[[f.x,f.y,Math.min(m||0,y||0,v||0,_||0)],[g.x,g.y,Math.max(m||0,y||0,v||0,_||0)]];let C=t.Aabb.fromPoints(w);const b=a.getWorldToCameraMatrix(),x=t.invert(new Float64Array(16),b);C=t.Aabb.applyTransform(C,b);const E=t.sub([],C.max,C.min),S=u.left||0,T=u.right||0,R=u.bottom||0,P=u.top||0,{left:O,right:I,top:A,bottom:D}=l.padding,M=.5*(S+T),L=.5*(P+R),N=Math.min(a.scaleZoom(a.scale*Math.min((a.width-(S+T+O+I))/E[0],(a.height-(R+P+D+A))/E[1])),l.maxZoom),F=a.scale/a.zoomScale(N);C=new t.Aabb([C.min[0]-(O+M)*F,C.min[1]-(D+L)*F,C.min[2]],[C.max[0]+(I+M)*F,C.max[1]+(A+L)*F,C.max[2]]);const k=.5*E[2],G=this._minimumAABBFrustumDistance(a,C),B=[0,0,1,0];t.transformMat4$1(B,B,b),t.normalize$2(B,B);const V=t.scale$2([],B,G+k),z=t.add([],C.center,V),j=("number"==typeof l.offset.x&&"number"==typeof l.offset.y?new t.Point(l.offset.x,l.offset.y):t.Point.convert(l.offset)).rotate(-t.degToRad(o));C.center[0]-=j.x*F,C.center[1]+=j.y*F,t.transformMat4(C.center,C.center,x),t.transformMat4(z,z,x);const H=[C.center[0],C.center[1],z[2]*a.pixelsPerMeter];t.scale$2(H,H,1/a.worldSize);const U=t.lngFromMercatorX(H[0]),W=t.latFromMercatorY(H[1]),q=Math.min(a._zoomFromMercatorZ(H[2]),l.maxZoom),X=new t.LngLat(U,W);return a.mercatorFromTransition&&q<.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"globe"}),a.zoom=q,this._cameraForBounds(a,n,r,o,i,s)):{center:X,zoom:q,bearing:o,pitch:i}}fitBounds(t,e,n){const r=this.cameraForBounds(t,e);return this._fitInternal(r,e,n)}fitScreenCoordinates(e,n,r,o,i){const s=t.Point.convert(e),a=t.Point.convert(n),l=new t.Point(Math.min(s.x,a.x),Math.min(s.y,a.y)),u=new t.Point(Math.max(s.x,a.x),Math.max(s.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(s,a))return this;const c=this.transform.pointLocation3D(l),p=this.transform.pointLocation3D(u),h=this.transform.pointLocation3D(new t.Point(l.x,u.y)),d=this.transform.pointLocation3D(new t.Point(u.x,l.y)),f=[Math.min(c.lng,p.lng,h.lng,d.lng),Math.min(c.lat,p.lat,h.lat,d.lat)],g=[Math.max(c.lng,p.lng,h.lng,d.lng),Math.max(c.lat,p.lat,h.lat,d.lat)],m=o&&o.pitch?o.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,f,g,r,m,o);return this._fitInternal(y,o,i)}_fitInternal(e,n,r){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this}jumpTo(e,n){this.stop();const r=e.preloadOnly?this.transform.clone():this.transform;let o=!1,i=!1,s=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(o=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(i=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(s=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),e.preloadOnly?(this._preloadTiles(r),this):(this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),o&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),i&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),s&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||t.warnOnce(Zo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){const r=this.transform;if(!r.projection.supportsFreeCamera)return t.warnOnce(Zo),this;this.stop();const o=r.zoom,i=r.pitch,s=r.bearing;r.setFreeCameraOptions(e);const a=o!==r.zoom,l=i!==r.pitch,u=s!==r.bearing;return this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),a&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),u&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),l&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||this._prefersReducedMotion(e))&&(e.duration=0);const r=this.transform,o=this.getZoom(),i=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:r.padding,h=t.Point.convert(e.offset);let d,f,g;if("globe"===r.projection.name){const n=t.MercatorCoordinate.fromLngLat(r.center),o=h.rotate(-r.angle);n.x+=o.x/r.worldSize,n.y+=o.y/r.worldSize;const i=n.toLngLat(),s=t.LngLat.convert(e.center||i);this._normalizeCenter(s),d=r.centerPoint.add(o),f=new t.Point(n.x,n.y).mult(r.worldSize),g=new t.Point(t.mercatorXfromLng(s.lng),t.mercatorYfromLat(s.lat)).mult(r.worldSize).sub(f)}else{d=r.centerPoint.add(h);const n=r.pointLocation(d),o=t.LngLat.convert(e.center||n);this._normalizeCenter(o),f=r.project(n),g=r.project(o).sub(f)}const m=r.zoomScale(l-o);let y,v;e.around&&(y=t.LngLat.convert(e.around),v=r.locationPoint(y));const _=this._zooming||l!==o,w=this._rotating||i!==u,C=this._pitching||c!==s,b=!r.isPaddingEqual(p),x=r=>x=>{if(_&&(r.zoom=t.number(o,l,x)),w&&(r.bearing=t.number(i,u,x)),C&&(r.pitch=t.number(s,c,x)),b&&(r.interpolatePadding(a,p,x),d=r.centerPoint.add(h)),y)r.setLocationAtPoint(y,v);else{const t=r.zoomScale(r.zoom-o),e=l>o?Math.min(2,m):Math.max(.5,m),n=Math.pow(e,1-x),i=r.unproject(f.add(g.mult(x*n)).mult(t));r.setLocationAtPoint(r.renderWorldCopies?i.wrap():i,d)}return e.preloadOnly||this._fireMoveEvents(n),r};if(e.preloadOnly){const t=this._emulate(x,e.duration,r);return this._preloadTiles(t),this}const E={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_,this._rotating=w,this._pitching=C,this._padding=b,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,E),this._ease(x(r),t=>{r.recenterOnTerrain(),this._afterEase(n,t)},e),this}_prepareEase(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",n||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const r=this._zooming,o=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),o&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,n){if(this._prefersReducedMotion(e)){const r=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const r=this.transform,o=this.getZoom(),i=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,r.minZoom,r.maxZoom):o,u="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:r.padding,h=r.zoomScale(l-o),d=t.Point.convert(e.offset);let f=r.centerPoint.add(d);const g=r.pointLocation(f),m=t.LngLat.convert(e.center||g);this._normalizeCenter(m);const y=r.project(g),v=r.project(m).sub(y);let _=e.curve;const w=Math.max(r.width,r.height),C=w/h,b=v.mag();if("minZoom"in e){const n=t.clamp(Math.min(e.minZoom,o,l),r.minZoom,r.maxZoom),i=w/r.zoomScale(n-o);_=Math.sqrt(i/b*2)}const x=_*_;function E(t){const e=(C*C-w*w+(t?-1:1)*x*x*b*b)/(2*(t?C:w)*x*b);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}const R=E(0);let P=function(t){return T(R)/T(R+_*t)},O=function(t){return w*((T(R)*(S(e=R+_*t)/T(e))-S(R))/x)/b;var e},I=(E(1)-R)/_;if(Math.abs(b)<1e-6||!isFinite(I)){if(Math.abs(w-C)<1e-6)return this.easeTo(e,n);const t=C<w?-1:1;I=Math.abs(Math.log(C/w))/_,O=function(){return 0},P=function(e){return Math.exp(t*_*e)}}e.duration="duration"in e?+e.duration:1e3*I/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const A=i!==u,D=c!==s,M=!r.isPaddingEqual(p),L=r=>h=>{const g=h*I,_=1/P(g);r.zoom=1===h?l:o+r.scaleZoom(_),A&&(r.bearing=t.number(i,u,h)),D&&(r.pitch=t.number(s,c,h)),M&&(r.interpolatePadding(a,p,h),f=r.centerPoint.add(d));const w=1===h?m:r.unproject(y.add(v.mult(O(g))).mult(_));return r.setLocationAtPoint(r.renderWorldCopies?w.wrap():w,f),r._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(n),r};if(e.preloadOnly){const t=this._emulate(L,e.duration,r);return this._preloadTiles(t),this}return this._zooming=!0,this._rotating=A,this._pitching=D,this._padding=M,this._prepareEase(n,!1),this._ease(L(r),()=>this._afterEase(n),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const t=this._onEaseEnd;this._onEaseEnd=void 0,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.wrap(e,-180,180);const r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.maxBounds)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&t.exported.prefersReducedMotion&&!(e&&e.essential)}_emulate(t,e,n){const r=Math.ceil(15*e/1e3),o=[],i=t(n.clone());for(let s=0;s<=r;s++){const t=i(s/r);o.push(t.clone())}return o}}class Jo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=i("button","mapboxgl-ctrl-attrib-button",this._container),i("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=i("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString("AttributionControl.".concat(e));t.setAttribute("aria-label",n),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const r=n.reduce((t,e,r)=>(e.value&&(t+="".concat(e.key,"=").concat(e.value).concat(r<n.length-1?"&":"")),t),"?");e.href="".concat(t.config.FEEDBACK_URL,"/").concat(r,"#").concat(to(this._map,!0)),e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._sourceCaches;for(const r in e){const n=e[r];if(n.used){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort((t,e)=>t.length-e.length),t=t.filter((e,n)=>{for(let r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class $o{constructor(){t.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=i("div","mapboxgl-ctrl");const e=i("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const n=t[e].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class ti{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const r of n)if(r.id===t)return void(r.cancelled=!0)}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ei(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){const o=new t.LngLat(e.lng-360,e.lat),i=new t.LngLat(e.lng+360,e.lat),s=360*Math.ceil(Math.abs(e.lng-r.center.lng)/360),a=r.locationPoint(e).distSqr(n),l=n.x<0||n.y<0||n.x>r.width||n.y>r.height;r.locationPoint(o).distSqr(n)<a&&(l||Math.abs(o.lng-r.center.lng)<s)?e=o:r.locationPoint(i).distSqr(n)<a&&(l||Math.abs(i.lng-r.center.lng)<s)&&(e=i)}for(;Math.abs(e.lng-r.center.lng)>180;){const t=r.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=r.width&&t.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}const ni={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ri extends t.Evented{constructor(e,n){if(super(),(e instanceof t.window.HTMLElement||n)&&(e=t.extend({element:e},n)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=t.Point.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=i("div");const n=41,r=27,o=s("svg",{display:"block",height:n*this._scale+"px",width:r*this._scale+"px",viewBox:"0 0 ".concat(r," ").concat(n)},this._element),a=s("radialGradient",{id:"shadowGradient"},s("defs",{},o));s("stop",{offset:"10%","stop-opacity":.4},a),s("stop",{offset:"100%","stop-opacity":.05},a),s("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},o),s("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},o),s("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},o),s("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},o),this._offset=t.Point.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()});const r=this._element.classList;for(const t in ni)r.remove("mapboxgl-marker-anchor-".concat(t));r.add("mapboxgl-marker-anchor-".concat(this._anchor)),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,r=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-n+r)],"bottom-right":[-r,-1*(e-n+r)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,e=this._pos;if(!t||!e)return!1;const n=t.unproject(e),r=t.getFreeCameraOptions();if(!r.position)return!1;const o=r.position.toLngLat();return o.distanceTo(n)<.9*o.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const n=this._pos;if(!n||n.x<0||n.x>e.transform.width||n.y<0||n.y>e.transform.height)return void this._clearFadeTimer();const r=e.unproject(n);let o;e._showingGlobe()&&t.isLngLatBehindGlobe(e.transform,this._lngLat)?o=0:(o=1-e._queryFogOpacity(r),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(o*=this._occludedOpacity)),this._element.style.opacity="".concat(o),this._element.style.pointerEvents=o>0?"auto":"none",this._popup&&this._popup._setOpacity(o),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const e=this._offset.mult(this._scale);this._element.style.transform="\n            translate(".concat(t.x,"px,").concat(t.y,"px)\n            ").concat(ni[this._anchor],"\n            ").concat(this._calculateXYTransform()," ").concat(this._calculateZTransform(),"\n            translate(").concat(e.x,"px,").concat(e.y,"px)\n        ")}_calculateXYTransform(){const e=this._pos,n=this._map,r=this.getPitchAlignment();if(!n||!e||"map"!==r)return"";if(!n._showingGlobe()){const t=n.getPitch();return t?"rotateX(".concat(t,"deg)"):""}const o=t.radToDeg(t.globeTiltAtLngLat(n.transform,this._lngLat)),i=e.sub(t.globeCenterToScreenPoint(n.transform)),s=Math.abs(i.x)+Math.abs(i.y);if(0===s)return"";const a=o/s;return"rotateX(".concat(-i.y*a,"deg) rotateY(").concat(i.x*a,"deg)")}_calculateZTransform(){const e=this._pos,n=this._map;if(!n||!e)return"";let r=0;const o=this.getRotationAlignment();if("map"===o)if(n._showingGlobe()){const e=n.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),o=n.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(e);r=t.radToDeg(Math.atan2(o.y,o.x))-90}else r=-n.getBearing();else if("horizon"===o){const o=t.smoothstep(4,6,n.getZoom()),i=t.globeCenterToScreenPoint(n.transform);i.y+=o*n.transform.height;const s=e.sub(i),a=t.radToDeg(Math.atan2(s.y,s.x));r=(a>90?a-270:a+90)*(1-o)}return r+=this._rotation,r?"rotateZ(".concat(r,"deg)"):""}_update(e){t.window.cancelAnimationFrame(this._updateFrameId);const n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=ei(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),!0===e?this._updateFrameId=t.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),n._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(n._showingGlobe()||n.getTerrain()||n.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(e){return this._offset=t.Point.convert(e),this._update(),this}_onMove(e){const n=this._map;if(!n)return;const r=this._pointerdownPos,o=this._positionDelta;if(r&&o){if(!this._isDragging){const t=this._clickTolerance||n._clickTolerance;if(e.point.dist(r)<t)return;this._isDragging=!0}this._pos=e.point.sub(o),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){const e=this._map,n=this._pos;e&&n&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(n),this._pointerdownPos=t.point,this._state="pending",e.on("mousemove",this._onMove),e.on("touchmove",this._onMove),e.once("mouseup",this._onUp),e.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const e=this._map;return e&&(t?(e.on("mousedown",this._addDragHandler),e.on("touchstart",this._addDragHandler)):(e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const oi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ii=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function si(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t.Point(0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof e){const r=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(n){case"top":return new t.Point(0,e);case"top-left":return new t.Point(r,r);case"top-right":return new t.Point(-r,r);case"bottom":return new t.Point(0,-e);case"bottom-left":return new t.Point(r,-r);case"bottom-right":return new t.Point(-r,-r);case"left":return new t.Point(e,0);case"right":return new t.Point(-e,0)}return new t.Point(0,0)}return e instanceof t.Point||Array.isArray(e)?t.Point.convert(e):t.Point.convert(e[n]||[0,0])}class ai{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const n=t.easeCubicInOut((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,n){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+n}}const li={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ui={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},ci={showCompass:!0,showZoom:!0,visualizePitch:!1};class pi{constructor(e,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._clickTolerance=10,this.element=n,this.mouseRotate=new xo({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,r&&(this.mousePitch=new Eo({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),c()}move(t,e){const n=this.map,r=this.mouseRotate.mousemoveWindow(t,e),o=r&&r.bearingDelta;if(o&&n.setBearing(n.getBearing()+o),this.mousePitch){const r=this.mousePitch.mousemoveWindow(t,e),o=r&&r.pitchDelta;o&&n.setPitch(n.getPitch()+o)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){p(),t.window.removeEventListener("mousemove",this.mousemove),t.window.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),f(this.element,e)),t.window.addEventListener("mousemove",this.mousemove),t.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,f(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=g(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=g(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const hi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},di={maxWidth:100,unit:"metric"},fi={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},gi={version:t.version,supported:n,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Qo{constructor(e){if(t.LivePerformanceUtils.mark(t.PerformanceMarkers.create),null!=(e=t.extend({},ui,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&t.isSafariWithAntialiasingBug(t.window)&&(e.antialias=!1,t.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qr(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._useWebGL2=e.useWebGL2,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new ti,this._domRenderTaskQueue=new ti,this._controls=[],this._markers=[],this._popups=[],this._mapId=t.uniqueId(),this._locale=t.extend({},li,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ai(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '".concat(e.container,"' not found."))}else{if(!(e.container instanceof t.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&t.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1),t.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Yo(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),this._hash=e.hash&&new $r("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),e.attributionControl&&this.addControl(new Jo({customAttribution:e.customAttribution})),this._logoControl=new $o,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.Event("".concat(e.dataType,"data"),e))}),this.on("dataloading",e=>{this.fire(new t.Event("".concat(e.dataType,"dataloading"),e))})}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const o=this._controlPositions[n];return-1!==n.indexOf("bottom")?o.insertBefore(r,o.firstChild):o.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)),this.fire(new t.Event("resize",e)),n&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?85:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return"auto"===e?t.window.navigator.language:Array.isArray(e)?0===e.length?void 0:e.map(e=>"auto"===e?t.window.navigator.language:e):e}setLanguage(t){const e=this._parseLanguage(t);if(!this.style||e===this._language)return this;this._language=e,this.style._reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(t){return this.style&&t!==this._worldview?(this._worldview=t,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(t){return this._lazyInitEmptyStyle(),t?"string"==typeof t&&(t={name:t}):t=null,this._useExplicitProjection=!!t,this._prioritizeAndUpdateProjection(t,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const e=this.transform,n=e.projection.name;let r;"globe"===n&&e.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?(e.setMercatorFromTransition(),r=!0):"mercator"===n&&e.zoom<t.GLOBE_ZOOM_THRESHOLD_MAX&&(e.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(t,e){return this._updateProjection(t||e||{name:"mercator"})}_updateProjection(e){let n;if(n="globe"===e.name&&this.transform.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),n){this.painter.clearBackgroundTiles();for(const t in this.style._sourceCaches)this.style._sourceCaches[t].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.Point.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let r=!1;const o=o=>{const i=e.filter(t=>this.getLayer(t)),s=i.length?this.queryRenderedFeatures(o.point,{layers:i}):[];s.length?r||(r=!0,n.call(this,new uo(t,this,o.originalEvent,{features:s}))):r=!1},i=()=>{r=!1};return{layers:new Set(e),listener:n,delegates:{mousemove:o,mouseout:i}}}if("mouseleave"===t||"mouseout"===t){let r=!1;const o=o=>{const i=e.filter(t=>this.getLayer(t));(i.length?this.queryRenderedFeatures(o.point,{layers:i}):[]).length?r=!0:r&&(r=!1,n.call(this,new uo(t,this,o.originalEvent)))},i=e=>{r&&(r=!1,n.call(this,new uo(t,this,e.originalEvent)))};return{layers:new Set(e),listener:n,delegates:{mousemove:o,mouseout:i}}}{const r=t=>{const r=e.filter(t=>this.getLayer(t)),o=r.length?this.queryRenderedFeatures(t.point,{layers:r}):[];o.length&&(t.features=o,n.call(this,t),delete t.features)};return{layers:new Set(e),listener:n,delegates:{[t]:r}}}}on(t,e,n){if(void 0===n)return super.on(t,e);Array.isArray(e)||(e=[e]);const r=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r);for(const o in r.delegates)this.on(o,r.delegates[o]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);Array.isArray(e)||(e=[e]);const r=this._createDelegatedListener(t,e,n);for(const o in r.delegates)this.once(o,r.delegates[o]);return this}off(t,e,n){if(void 0===n)return super.off(t,e);e=new Set(Array.isArray(e)?e:[e]);const r=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0},o=this._delegatedListeners?this._delegatedListeners[t]:void 0;return o&&(t=>{for(let o=0;o<t.length;o++){const i=t[o];if(i.listener===n&&r(i.layers,e)){for(const t in i.delegates)this.off(t,i.delegates[t]);return t.splice(o,1),this}}})(o),this}queryRenderedFeatures(e,n){return this.style?(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}isPointOnSurface(e){const{name:n}=this.transform.projection;return"globe"!==n&&"mercator"!==n&&t.warnOnce("".concat(n," projection does not support isPointOnSurface, this API may behave unexpectedly.")),this.transform.isPointOnSurface(t.Point.convert(e))}setStyle(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(e,n))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error("Missing UI string '".concat(t,"'"));return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),t&&(this.style=new $e(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new $e(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const r=this._requestManager.normalizeStyleURL(e),o=this._requestManager.transformRequest(r,t.ResourceType.Style);t.getJSON(o,(e,r)=>{e?this.fire(new t.ErrorEvent(e)):r&&this._updateDiff(r,n)})}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce("Unable to perform style diff: ".concat(r.message||r.error||r,".  Rebuilding the style from scratch.")),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(t.warnOnce("There is no style added to the map."),!1)}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){return!!this.style&&this.style._isSourceCacheLoaded(t)}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,n){this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,n){let{pixelRatio:r=1,sdf:o=!1,stretchX:i,stretchY:s,content:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._lazyInitEmptyStyle(),n instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&n instanceof t.window.ImageBitmap){const{width:l,height:u,data:c}=t.exported.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:r,stretchX:i,stretchY:s,content:a,sdf:o,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:u}=n,c=n;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},new Uint8Array(c.data)),pixelRatio:r,stretchX:i,stretchY:s,content:a,sdf:o,version:0,userImage:c}),c.onAdd&&c.onAdd(this,e)}}updateImage(e,n){const r=this.style.getImage(e);if(!r)return void this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const o=n instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&n instanceof t.window.ImageBitmap?t.exported.getImageData(n):n,{width:i,height:s}=o;void 0!==i&&void 0!==s?i===r.data.width&&s===r.data.height?(r.data.replace(o.data,!(n instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&n instanceof t.window.ImageBitmap)),this.style.updateImage(e,r)):this.fire(new t.ErrorEvent(new Error("The width and height of the updated image (".concat(i,", ").concat(s,")\n                must be that same as the previous version of the image\n                (").concat(r.data.width,", ").concat(r.data.height,")")))):this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),(e,r)=>{n(e,r instanceof t.window.HTMLImageElement?t.exported.getImageData(r):r)})}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(t,e,n,r),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(t,e,n,r),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),!t&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e),this.transform):0}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let r,o,i,s=this._container;for(;s&&(!o||!i);){const e=t.window.getComputedStyle(s).transform;e&&"none"!==e&&(r=e.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&"0"!==r[0]&&"1"!==r[0]&&(o=r[0]),r[3]&&"0"!==r[3]&&"1"!==r[3]&&(i=r[3])),s=s.parentElement}this._containerWidth=o?Math.abs(e/o):e,this._containerHeight=i?Math.abs(n/i):n}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=i("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=i("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=i("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=i("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(t=>{r[t]=i("div","mapboxgl-ctrl-".concat(t),n)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,n){const r=t.exported.devicePixelRatio||1;this._canvas.width=r*Math.ceil(e),this._canvas.height=r*Math.ceil(n),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(n,"px")}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_addPopup(t){this._popups.push(t)}_removePopup(t){const e=this._popups.indexOf(t);-1!==e&&this._popups.splice(e,1)}_setupPainter(){const e=t.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",e),o=r||this._canvas.getContext("webgl",e)||this._canvas.getContext("experimental-webgl",e);o?(this._useWebGL2&&!r&&t.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),t.storeAuthState(o,!0),this.painter=new Gr(o,this.transform,!!r),this.on("data",t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)}),t.exported$1.testSupport(o)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t)}_render(e){let n;const r=this.painter.context.extTimerQuery,o=t.exported.now();if(this.listens("gpu-timing-frame")&&(n=r.createQueryEXT(),r.beginQueryEXT(r.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],t.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],t.window.performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const i=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=this.transform.pitch,r=t.exported.now(),o=new t.EvaluationParameters(e,{now:r,fadeDuration:i,pitch:n,transition:this.style.getTransition()});this.style.update(o)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let s=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),s=this._updateAverageElevation(o),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):s=this._updateAverageElevation(o),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const e=t.exported.now()-o;r.endQueryEXT(r.TIME_ELAPSED_EXT,n),setTimeout(()=>{const i=r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:i})),t.window.performance.mark("frame-gpu",{startTime:o,detail:{gpuTime:i}})},50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout(()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:n}))},50)}if(this.listens("gpu-timing-deferred-render")){const e=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const n=this.painter.queryGpuTimeDeferredRender(e);this.fire(new t.Event("gpu-timing-deferred-render",{gpuTime:n}))},50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty||s;if(a||this._repaint)this.triggerRepaint();else{const e=!this.isMoving()&&this.loaded();if(e&&(s=this._updateAverageElevation(o,!0)),s)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,t.LivePerformanceUtils.mark(t.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&t.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(t){for(const e of this._markers)t&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!t||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let r=this.transform.sampleAverageElevation(),o=!1;this.transform.elevation&&(o=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(r)?r=0:this._averageElevationLastSampledAt=t;const i=Math.abs(e-r);if(i>1){if(this._isInitialLoad||o)return this._averageElevation.jumpTo(r),n(r);this._averageElevation.easeTo(r,t,300)}else if(i>1e-4)return this._averageElevation.jumpTo(r),n(r)}return!!this._averageElevation.isEasing(t)&&n(this._averageElevation.getValue(t))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof $o&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const t=this._isDragging();this.painter.updateTerrain(this.style,t)}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,r=n.createFramebuffer();function o(t){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const e=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,e),e}return n.bindFramebuffer(n.FRAMEBUFFER,r),this._canvasPixelComparison(o(t),e.canvasCopies.map(o),e.timeStamps)}_canvasPixelComparison(t,e,n){let r=n[1]-n[0];const o=t.length/4;for(let i=0;i<e.length;i++){const s=e[i];let a=0;for(let e=0;e<s.length;e+=4)s[e]===t[e]&&s[e+1]===t[e+1]&&s[e+2]===t[e+2]&&s[e+3]===t[e+3]&&(a+=1);r+=(n[i+2]-n[i+1])*(1-a/o)}return r}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1),t.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame(t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)}))}_preloadTiles(e){const n=this.style?Object.values(this.style._sourceCaches):[];return t.asyncAll(n,(t,n)=>t._preloadTiles(e,n),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}_onVisibilityChange(){"hidden"===t.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(t){this._showTileAABBs!==t&&(this._showTileAABBs=t,t&&this._update())}_setCacheLimits(e,n){t.setCacheLimits(e,n)}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},ci,e),this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),i("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),i("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const e=this._map;e&&(this.options.visualizePitch?e.resetNorthPitch({},{originalEvent:t}):e.resetNorth({},{originalEvent:t}))}),this._compassIcon=i("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map;if(!t)return;const e=t.getZoom(),n=e===t.getMaxZoom(),r=e===t.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())}_rotateCompassArrow(){const t=this._map;if(!t)return;const e=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(t.transform.pitch,"deg) rotateZ(").concat(t.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(t.transform.angle*(180/Math.PI),"deg)");t._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=e)})}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),t.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&t.on("pitch",this._rotateCompassArrow),t.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pi(t,this._compass,this.options.visualizePitch)),this._container}onRemove(){const t=this._map;t&&(this._container.remove(),this.options.showZoom&&t.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&t.off("pitch",this._rotateCompassArrow),t.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(t,e){const n=i("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){if(!this._map)return;const n=this._map._getUIString("NavigationControl.".concat(e));t.setAttribute("aria-label",n),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({geolocation:t.window.navigator.geolocation},hi,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Jr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(t){return this._map=t,this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){var n=this;const r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!!n.options.geolocation;n._supportsGeolocation=t,e(t)};void 0!==this._supportsGeolocation?e(this._supportsGeolocation):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(t=>r("denied"!==t.state)).catch(()=>r()):r()}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return!!e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,o=this._map.getBearing(),i=t.extend({bearing:o},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),i,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,n=t.mercatorZfromAltitude(1,e._center.lat)*e.worldSize,r=Math.ceil(2*this._accuracy*n);this._circleElement.style.width="".concat(r,"px"),this._circleElement.style.height="".concat(r,"px")}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=i("button","mapboxgl-ctrl-geolocate",this._container),i("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i("div","mapboxgl-user-location"),this._dotElement.appendChild(i("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(i("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ri({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=i("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ri({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:!0===t.absolute&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{t.window.addEventListener("ondeviceorientationabsolute"in t.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==t.window.DeviceMotionEvent&&"function"==typeof t.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(t=>{"granted"===t&&e()}).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),t.window.removeEventListener("deviceorientation",this._onDeviceOrientation),t.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Jo,ScaleControl:class{constructor(e){this.options=t.extend({},di,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(t){return!1}}(),t.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const t=this.options.maxWidth||100,e=this._map,n=e._containerHeight/2,r=e._containerWidth/2-t/2,o=e.unproject([r,n]),i=e.unproject([r+t,n]),s=o.distanceTo(i);if("imperial"===this.options.unit){const e=3.2808*s;e>5280?this._setScale(t,e/5280,"mile"):this._setScale(t,e,"foot")}else"nautical"===this.options.unit?this._setScale(t,s/1852,"nautical-mile"):s>=1e3?this._setScale(t,s/1e3,"kilometer"):this._setScale(t,s,"meter")}_setScale(t,e,n){this._map._requestDomTask(()=>{const r=function(t){const e=Math.pow(10,"".concat(Math.floor(t)).length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(e),o=r/e;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==n?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(r):"".concat(r,"&nbsp;").concat(fi[n]),this._container.style.width=t*o+"px"})}onAdd(t){return this._map=t,this._language=t.getLanguage(),this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(t){this._language=t,this._update()}setUnit(t){this.options.unit=t,this._update()}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=i("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=i("button","mapboxgl-ctrl-fullscreen",this._controlContainer);i("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(oi),e),t.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const t=this._map;return t&&(t.off("move",this._update),t.on("mousemove",this._onMouseEvent),t.on("drag",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const n=t.window.document.createDocumentFragment(),r=t.window.document.createElement("body");let o;for(r.innerHTML=e;o=r.firstChild,o;)n.appendChild(o);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=i("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(t),this.options.closeButton){const t=this._closeButton=i("button","mapboxgl-popup-close-button",e);t.type="button",t.setAttribute("aria-label","Close popup"),t.setAttribute("aria-hidden","true"),t.innerHTML="&#215;",t.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._updateClassList(),e}_onMouseEvent(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._map,n=this._container,r=this._pos;if(!e||!n||!r)return"bottom";const o=n.offsetWidth,i=n.offsetHeight,s=r.x<o/2,a=r.x>e.transform.width-o/2;if(r.y+t<i)return s?"top-left":a?"top-right":"top";if(r.y>e.transform.height-i){if(s)return"bottom-left";if(a)return"bottom-right"}return s?"left":a?"right":"bottom"}_updateClassList(){const t=this._container;if(!t)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push("mapboxgl-popup-anchor-".concat(this._anchor)),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),t.className=e.join(" ")}_update(e){const n=this._map,r=this._content;if(!n||!this._lngLat&&!this._trackPointer||!r)return;let o=this._container;if(o||(o=this._container=i("div","mapboxgl-popup",n.getContainer()),this._tip=i("div","mapboxgl-popup-tip",o),o.appendChild(r)),this.options.maxWidth&&o.style.maxWidth!==this.options.maxWidth&&(o.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ei(this._lngLat,this._pos,n.transform)),!this._trackPointer||e){const t=this._pos=this._trackPointer&&e?e:n.project(this._lngLat),r=si(this.options.offset),o=this._anchor=this._getAnchor(r.y),i=si(this.options.offset,o),s=t.add(i).round();n._requestDomTask(()=>{this._container&&o&&(this._container.style.transform="".concat(ni[o]," translate(").concat(s.x,"px,").concat(s.y,"px)"))})}if(!this._marker&&n._showingGlobe()){const e=t.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(e)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(ii);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._container&&(this._container.style.opacity="".concat(t)),this._content&&(this._content.style.pointerEvents=t?"auto":"none")}},Marker:ri,Style:$e,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:Hr,Evented:t.Evented,config:t.config,prewarm:function(){Bt().acquire(Ft)},clearPrewarmedResources:function(){const t=Gt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Ft),Gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return kt.workerCount},set workerCount(t){kt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return gi})),n}()},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReactFire=e.AgGridReactLegacy=e.AgGridReact=void 0;var i=n(66);Object.defineProperty(e,"AgGridReact",{enumerable:!0,get:function(){return i.AgGridReact}});var s=n(25);Object.defineProperty(e,"AgGridReactLegacy",{enumerable:!0,get:function(){return s.AgGridReactLegacy}});var a=n(11);Object.defineProperty(e,"AgGridReactFire",{enumerable:!0,get:function(){return a.AgGridReactUi}}),o(n(89),e)},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function s(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(t,e){for(var n,a,l=s(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))o.call(n,c)&&(l[c]=n[c]);if(r){a=r(n);for(var p=0;p<a.length;p++)i.call(n,a[p])&&(l[a[p]]=n[a[p]])}}return l}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReactUi=void 0;var u=n(1),c=a(n(0)),p=n(29),h=n(30),d=n(31),f=l(n(74));e.AgGridReactUi=function(t){var e,n,r=c.useRef(null),i=c.useRef(null),s=c.useRef(null),a=c.useRef([]),l=c.useRef([]),p=c.useRef(t),m=c.useRef(!1),y=c.useState(void 0),v=y[0],_=y[1],w=c.useCallback((function(t){t.rowDataChangeDetectionStrategy&&u._.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")}),[]),C=c.useState(0)[1],b=c.useCallback((function(e){if(i.current=e,!i.current)return a.current.forEach((function(t){return t()})),void(a.current.length=0);var n=t.modules||[];s.current||(s.current=new h.PortalManager((function(){return C((function(t){return t+1}))}),t.componentWrappingElement,t.maxComponentCreationTimeMs),a.current.push((function(){var t;null===(t=s.current)||void 0===t||t.destroy(),s.current=null})));var o={providedBeanInstances:{frameworkComponentWrapper:new g(s.current)},modules:n,frameworkOverrides:new d.ReactFrameworkOverrides(!0)};r.current=t.gridOptions||{},r.current=u.ComponentUtil.copyAttributesToGridOptions(r.current,t),w(t);(new u.GridCoreCreator).create(i.current,r.current,(function(e){_(e),a.current.push((function(){e.destroy()})),e.getBean(u.CtrlsService.NAME).whenReady((function(){if(!e.isDestroyed()&&r.current){var n=r.current.api;n&&t.setGridApi&&t.setGridApi(n,r.current.columnApi)}}))}),(function(t){t.getBean(u.CtrlsService.NAME).whenReady((function(){l.current.forEach((function(t){return t()})),l.current.length=0,m.current=!0}))}),o)}),[]),x=c.useMemo((function(){return o({height:"100%"},t.containerStyle||{})}),[t.containerStyle]),E=c.useCallback((function(t){m.current?t():l.current.push(t)}),[]);return c.useEffect((function(){var e={};!function(t,e,n){var r=!!e.debug;Object.keys(e).forEach((function(o){u.ComponentUtil.ALL_PROPERTIES_SET.has(o)&&t[o]!==e[o]&&(r&&console.log(" agGridReact: ["+o+"] property changed"),n[o]={previousValue:t[o],currentValue:e[o]})})),u.ComponentUtil.EVENT_CALLBACKS.forEach((function(o){t[o]!==e[o]&&(r&&console.log("agGridReact: ["+o+"] event callback changed"),n[o]={previousValue:t[o],currentValue:e[o]})}))}(p.current,t,e),p.current=t,E((function(){var t;(null===(t=r.current)||void 0===t?void 0:t.api)&&u.ComponentUtil.processOnChange(e,r.current.api)}))}),[t]),c.default.createElement("div",{style:x,className:t.className,ref:b},v&&!v.isDestroyed()?c.default.createElement(f.default,{context:v}):null,null!==(n=null===(e=s.current)||void 0===e?void 0:e.getPortals())&&void 0!==n?n:null)};var g=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return r(e,t),e.prototype.createWrapper=function(t,e){return new p.NewReactComponent(t,this.parent,e)},e}(u.BaseComponentWrapper)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t,e){r.useEffect((function(){var n=e.current;if(n){var r=n.parentElement;if(r){var o=document.createComment(t);return r.insertBefore(o,n),function(){r.removeChild(o)}}}}),[t])}},function(t,e,n){(function(t){!function(e){"use strict";var n=6371008.8,r={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*n,kilometers:6371.0088,kilometres:6371.0088,meters:n,metres:n,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:n/1852,radians:1,yards:6967335.223679999},o={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/n,yards:1.0936133},i={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function s(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function a(t,e,n){switch(t){case"Point":return l(e).geometry;case"LineString":return h(e).geometry;case"Polygon":return c(e).geometry;case"MultiPoint":return m(e).geometry;case"MultiLineString":return g(e).geometry;case"MultiPolygon":return y(e).geometry;default:throw new Error(t+" is invalid")}}function l(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P(t[0])||!P(t[1]))throw new Error("coordinates must contain numbers");return s({type:"Point",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),f(t.map((function(t){return l(t,e)})),n)}function c(t,e,n){void 0===n&&(n={});for(var r=0,o=t;r<o.length;r++){var i=o[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return s({type:"Polygon",coordinates:t},e,n)}function p(t,e,n){return void 0===n&&(n={}),f(t.map((function(t){return c(t,e)})),n)}function h(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return s({type:"LineString",coordinates:t},e,n)}function d(t,e,n){return void 0===n&&(n={}),f(t.map((function(t){return h(t,e)})),n)}function f(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function g(t,e,n){return void 0===n&&(n={}),s({type:"MultiLineString",coordinates:t},e,n)}function m(t,e,n){return void 0===n&&(n={}),s({type:"MultiPoint",coordinates:t},e,n)}function y(t,e,n){return void 0===n&&(n={}),s({type:"MultiPolygon",coordinates:t},e,n)}function v(t,e,n){return void 0===n&&(n={}),s({type:"GeometryCollection",geometries:t},e,n)}function _(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function w(t,e){void 0===e&&(e="kilometers");var n=r[e];if(!n)throw new Error(e+" units is invalid");return t*n}function C(t,e){void 0===e&&(e="kilometers");var n=r[e];if(!n)throw new Error(e+" units is invalid");return t/n}function b(t,e){return E(C(t,e))}function x(t){var e=t%360;return e<0&&(e+=360),e}function E(t){return t%(2*Math.PI)*180/Math.PI}function S(t){return t%360*Math.PI/180}function T(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return w(C(t,e),n)}function R(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=i[e];if(!r)throw new Error("invalid original units");var o=i[n];if(!o)throw new Error("invalid final units");return t/r*o}function P(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function O(t){return!!t&&t.constructor===Object}function I(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!P(t))throw new Error("bbox must only contain numbers")}))}function A(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var D=Object.freeze({__proto__:null,earthRadius:n,factors:r,unitsFactors:o,areaFactors:i,feature:s,geometry:a,point:l,points:u,polygon:c,polygons:p,lineString:h,lineStrings:d,featureCollection:f,multiLineString:g,multiPoint:m,multiPolygon:y,geometryCollection:v,round:_,radiansToLength:w,lengthToRadians:C,lengthToDegrees:b,bearingToAzimuth:x,radiansToDegrees:E,degreesToRadians:S,convertLength:T,convertArea:R,isNumber:P,isObject:O,validateBBox:I,validateId:A});function M(t,e,n){if(null!==t)for(var r,o,i,s,a,l,u,c,p=0,h=0,d=t.type,f="FeatureCollection"===d,g="Feature"===d,m=f?t.features.length:1,y=0;y<m;y++){a=(c=!!(u=f?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var _=0,w=0;if(null!==(s=c?u.geometries[v]:u)){l=s.coordinates;var C=s.type;switch(p=!n||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===e(l,h,y,_,w))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===e(l[r],h,y,_,w))return!1;h++,"MultiPoint"===C&&_++}"LineString"===C&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-p;o++){if(!1===e(l[r][o],h,y,_,w))return!1;h++}"MultiLineString"===C&&_++,"Polygon"===C&&w++}"Polygon"===C&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(w=0,o=0;o<l[r].length;o++){for(i=0;i<l[r][o].length-p;i++){if(!1===e(l[r][o][i],h,y,_,w))return!1;h++}w++}_++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===M(s.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function L(t,e,n,r){var o=n;return M(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o}function N(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function F(t,e,n){var r=n;return N(t,(function(t,o){r=0===o&&void 0===n?t:e(r,t,o)})),r}function k(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function G(t,e,n){var r=n;return k(t,(function(t,o){r=0===o&&void 0===n?t:e(r,t,o)})),r}function B(t){var e=[];return M(t,(function(t){e.push(t)})),e}function V(t,e){var n,r,o,i,s,a,l,u,c,p,h=0,d="FeatureCollection"===t.type,f="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:f?t.geometry:t,u=d?t.features[n].properties:f?t.properties:{},c=d?t.features[n].bbox:f?t.bbox:void 0,p=d?t.features[n].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<s;o++)if(null!==(i=l?a.geometries[o]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,u,c,p))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===e(i.geometries[r],h,u,c,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,u,c,p))return!1;h++}}function z(t,e,n){var r=n;return V(t,(function(t,o,i,s,a){r=0===o&&void 0===n?t:e(r,t,o,i,s,a)})),r}function j(t,e){V(t,(function(t,n,r,o,i){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(s(t,r,{bbox:o,id:i}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u];if(!1===e(s({type:a,coordinates:c},r),n,u))return!1}}))}function H(t,e,n){var r=n;return j(t,(function(t,o,i){r=0===o&&0===i&&void 0===n?t:e(r,t,o,i)})),r}function U(t,e){j(t,(function(t,n,r){var o=0;if(t.geometry){var i=t.geometry.type;if("Point"!==i&&"MultiPoint"!==i){var s,a=0,l=0,u=0;return!1!==M(t,(function(i,c,p,d,f){if(void 0===s||n>a||d>l||f>u)return s=i,a=n,l=d,u=f,void(o=0);var g=h([s,i],t.properties);if(!1===e(g,n,r,f,o))return!1;o++,s=i}))&&void 0}}}))}function W(t,e,n){var r=n,o=!1;return U(t,(function(t,i,s,a,l){r=!1===o&&void 0===n?t:e(r,t,i,s,a,l),o=!0})),r}function q(t,e){if(!t)throw new Error("geojson is required");j(t,(function(t,n,r){if(null!==t.geometry){var o=t.geometry.type,i=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var s=0;s<i.length;s++)if(!1===e(h(i[s],t.properties),n,r,s))return!1}}}))}function X(t,e,n){var r=n;return q(t,(function(t,o,i,s){r=0===o&&void 0===n?t:e(r,t,o,i,s)})),r}function K(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,i=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var l=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=l.length+s-1),h([l[s],l[s+1]],a,e);case"Polygon":return i<0&&(i=l.length+i),s<0&&(s=l[i].length+s-1),h([l[i][s],l[i][s+1]],a,e);case"MultiLineString":return o<0&&(o=l.length+o),s<0&&(s=l[o].length+s-1),h([l[o][s],l[o][s+1]],a,e);case"MultiPolygon":return o<0&&(o=l.length+o),i<0&&(i=l[o].length+i),s<0&&(s=l[o][i].length-s-1),h([l[o][i][s],l[o][i][s+1]],a,e)}throw new Error("geojson is invalid")}function Y(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,i=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return l(u,a,e);case"MultiPoint":return o<0&&(o=u.length+o),l(u[o],a,e);case"LineString":return s<0&&(s=u.length+s),l(u[s],a,e);case"Polygon":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),l(u[i][s],a,e);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),l(u[o][s],a,e);case"MultiPolygon":return o<0&&(o=u.length+o),i<0&&(i=u[o].length+i),s<0&&(s=u[o][i].length-s),l(u[o][i][s],a,e)}throw new Error("geojson is invalid")}var Z=Object.freeze({__proto__:null,coordAll:B,coordEach:M,coordReduce:L,featureEach:k,featureReduce:G,findPoint:Y,findSegment:K,flattenEach:j,flattenReduce:H,geomEach:V,geomReduce:z,lineEach:q,lineReduce:X,propEach:N,propReduce:F,segmentEach:U,segmentReduce:W});function Q(t){var e=[1/0,1/0,-1/0,-1/0];return M(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function J(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function $(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function tt(t){if(t.length>1&&P(t[0])&&P(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return tt(t[0]);throw new Error("coordinates must only contain numbers")}function et(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function nt(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function rt(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,o=t.features;r<o.length;r++){var i=o[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+i.geometry.type)}}function ot(t){return"Feature"===t.type?t.geometry:t}function it(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}Q.default=Q;var st=Object.freeze({__proto__:null,getCoord:J,getCoords:$,containsNumber:tt,geojsonType:et,featureOf:nt,collectionOf:rt,getGeom:ot,getType:it}),at=Object.getOwnPropertySymbols,lt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;function ct(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var pt=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,r,o=ct(t),i=1;i<arguments.length;i++){for(var s in n=Object(arguments[i]))lt.call(n,s)&&(o[s]=n[s]);if(at){r=at(n);for(var a=0;a<r.length;a++)ut.call(n,r[a])&&(o[r[a]]=n[r[a]])}}return o},ht={successCallback:null,verbose:!1},dt={};function ft(t,e,n){n=n||{};for(var r=Object.keys(ht),o=0;o<r.length;o++){var i=r[o],s=n[i];s=null!=s?s:ht[i],dt[i]=s}dt.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var a=function(t){var e=[],n=0;return t.cells.forEach((function(r,o){r.forEach((function(r,i){if(void 0!==r&&5!==(h=r).cval&&10!==h.cval&&!mt(r)){var s=function(t,e,n){var r,o,i=t.length,s=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],c=t[e][n],p=c.cval,h=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][p],d=vt(c,h);s.push([n+d[0],e+d[1]]),d=vt(c,h=u[p]),s.push([n+d[0],e+d[1]]),yt(c);for(var f=n+a[p],g=e+l[p],m=p;f>=0&&g>=0&&g<i&&(f!=n||g!=e)&&void 0!==(c=t[g][f]);){if(0===(p=c.cval)||15===p)return{path:s,info:"mergeable"};h=u[p],r=a[p],o=l[p],5!==p&&10!==p||(5===p?c.flipped?-1===l[m]?(h="left",r=-1,o=0):(h="right",r=1,o=0):-1===a[m]&&(h="bottom",r=0,o=-1):10===p&&(c.flipped?-1===a[m]?(h="top",r=0,o=1):(h="bottom",r=0,o=-1):1===l[m]&&(h="left",r=-1,o=0))),d=vt(c,h),s.push([f+d[0],g+d[1]]),yt(c),f+=r,g+=o,m=p}return{path:s,info:"closed"}}(t.cells,o,i),a=!1;if("mergeable"===s.info)for(var l=s.path[s.path.length-1][0],u=s.path[s.path.length-1][1],c=n-1;c>=0;c--)if(Math.abs(e[c][0][0]-l)<=1e-7&&Math.abs(e[c][0][1]-u)<=1e-7){for(var p=s.path.length-2;p>=0;--p)e[c].unshift(s.path[p]);a=!0;break}a||(e[n++]=s.path)}var h}))})),e}(function(t,e){for(var n=t.length-1,r=t[0].length-1,o={rows:n,cols:r,cells:[]},i=0;i<n;++i){o.cells[i]=[];for(var s=0;s<r;++s){var a=0,l=t[i+1][s],u=t[i+1][s+1],c=t[i][s+1],p=t[i][s];if(!(isNaN(l)||isNaN(u)||isNaN(c)||isNaN(p))){a|=l>=e?8:0,a|=u>=e?4:0,a|=c>=e?2:0;var h,d,f,g,m=!1;if(5===(a|=p>=e?1:0)||10===a){var y=(l+u+c+p)/4;5===a&&y<e?(a=10,m=!0):10===a&&y<e&&(a=5,m=!0)}0!==a&&15!==a&&(h=d=f=g=.5,1===a?(f=1-gt(e,l,p),d=1-gt(e,c,p)):2===a?(d=gt(e,p,c),g=1-gt(e,u,c)):3===a?(f=1-gt(e,l,p),g=1-gt(e,u,c)):4===a?(h=gt(e,l,u),g=gt(e,c,u)):5===a?(h=gt(e,l,u),g=gt(e,c,u),d=1-gt(e,c,p),f=1-gt(e,l,p)):6===a?(d=gt(e,p,c),h=gt(e,l,u)):7===a?(f=1-gt(e,l,p),h=gt(e,l,u)):8===a?(f=gt(e,p,l),h=1-gt(e,u,l)):9===a?(d=1-gt(e,c,p),h=1-gt(e,u,l)):10===a?(h=1-gt(e,u,l),g=1-gt(e,u,c),d=gt(e,p,c),f=gt(e,p,l)):11===a?(h=1-gt(e,u,l),g=1-gt(e,u,c)):12===a?(f=gt(e,p,l),g=gt(e,c,u)):13===a?(d=1-gt(e,c,p),g=gt(e,c,u)):14===a?(f=gt(e,p,l),d=gt(e,p,c)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+a),o.cells[i][s]={cval:a,flipped:m,top:h,right:g,bottom:d,left:f})}}}return o}(t,e));return"function"==typeof dt.successCallback&&dt.successCallback(a),a}function gt(t,e,n){return(t-e)/(n-e)}function mt(t){return 0===t.cval||15===t.cval}function yt(t){mt(t)||5===t.cval||10===t.cval||(t.cval=15)}function vt(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}var _t=Ct,wt=Ct;function Ct(t,e,n,r,o){!function t(e,n,r,o,i){for(;o>r;){if(o-r>600){var s=o-r+1,a=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-a*u/s+c)),Math.min(o,Math.floor(n+(s-a)*u/s+c)),i)}var p=e[n],h=r,d=o;for(bt(e,r,n),i(e[o],p)>0&&bt(e,r,o);h<d;){for(bt(e,h,d),h++,d--;i(e[h],p)<0;)h++;for(;i(e[d],p)>0;)d--}0===i(e[r],p)?bt(e,r,d):bt(e,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(t,e,n||0,r||t.length-1,o||xt)}function bt(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function xt(t,e){return t<e?-1:t>e?1:0}_t.default=wt;var Et=Tt,St=Tt;function Tt(t,e){if(!(this instanceof Tt))return new Tt(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Rt(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function Pt(t,e){Ot(t,0,t.children.length,e,t)}function Ot(t,e,n,r,o){o||(o=kt(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i,s=e;s<n;s++)i=t.children[s],It(o,t.leaf?r(i):i);return o}function It(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function At(t,e){return t.minX-e.minX}function Dt(t,e){return t.minY-e.minY}function Mt(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Lt(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Nt(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ft(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function kt(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Gt(t,e,n,r,o){for(var i,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=r||(i=e+Math.ceil((n-e)/r/2)*r,_t(t,i,e,n,o),s.push(e,i,i,n))}function Bt(t){var e={exports:{}};return t(e,e.exports),e.exports}Tt.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!Ft(t,e))return n;for(var o,i,s,a,l=[];e;){for(o=0,i=e.children.length;o<i;o++)s=e.children[o],Ft(t,a=e.leaf?r(s):s)&&(e.leaf?n.push(s):Nt(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Ft(t,e))return!1;for(var r,o,i,s,a=[];e;){for(r=0,o=e.children.length;r<o;r++)if(i=e.children[r],Ft(t,s=e.leaf?n(i):i)){if(e.leaf||Nt(t,s))return!0;a.push(i)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=kt([]),this},remove:function(t,e){if(!t)return this;for(var n,r,o,i,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),r=l[l.length-1],n=u.pop(),i=!0),s.leaf&&-1!==(o=Rt(t,s.children,e)))return s.children.splice(o,1),l.push(s),this._condense(l),this;i||s.leaf||!Nt(s,a)?r?(n++,s=r.children[n],i=!1):s=null:(l.push(s),u.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:At,compareMinY:Dt,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var o,i=n-e+1,s=this._maxEntries;if(i<=s)return Pt(o=kt(t.slice(e,n+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/Math.pow(s,r-1))),(o=kt([])).leaf=!1,o.height=r;var a,l,u,c,p=Math.ceil(i/s),h=p*Math.ceil(Math.sqrt(s));for(Gt(t,e,n,h,this.compareMinX),a=e;a<=n;a+=h)for(Gt(t,a,u=Math.min(a+h-1,n),p,this.compareMinY),l=a;l<=u;l+=p)c=Math.min(l+p-1,u),o.children.push(this._build(t,l,c,r-1));return Pt(o,this.toBBox),o},_chooseSubtree:function(t,e,n,r){for(var o,i,s,a,l,u,c,p,h,d;r.push(e),!e.leaf&&r.length-1!==n;){for(c=p=1/0,o=0,i=e.children.length;o<i;o++)l=Mt(s=e.children[o]),h=t,d=s,(u=(Math.max(d.maxX,h.maxX)-Math.min(d.minX,h.minX))*(Math.max(d.maxY,h.maxY)-Math.min(d.minY,h.minY))-l)<p?(p=u,c=l<c?l:c,a=s):u===p&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,o=n?t:r(t),i=[],s=this._chooseSubtree(o,this.data,e,i);for(s.children.push(t),It(s,o);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(o,i,e)},_split:function(t,e){var n=t[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var i=this._chooseSplitIndex(n,o,r),s=kt(n.children.splice(i,n.children.length-i));s.height=n.height,s.leaf=n.leaf,Pt(n,this.toBBox),Pt(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=kt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Pt(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,o,i,s,a,l,u,c,p,h,d,f,g,m;for(l=u=1/0,r=e;r<=n-e;r++)p=o=Ot(t,0,r,this.toBBox),h=i=Ot(t,r,n,this.toBBox),d=Math.max(p.minX,h.minX),f=Math.max(p.minY,h.minY),g=Math.min(p.maxX,h.maxX),m=Math.min(p.maxY,h.maxY),s=Math.max(0,g-d)*Math.max(0,m-f),a=Mt(o)+Mt(i),s<l?(l=s,c=r,u=a<u?a:u):s===l&&a<u&&(u=a,c=r);return c},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:At,o=t.leaf?this.compareMinY:Dt;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,o)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var o,i,s=this.toBBox,a=Ot(t,0,e,s),l=Ot(t,n-e,n,s),u=Lt(a)+Lt(l);for(o=e;o<n-e;o++)i=t.children[o],It(a,t.leaf?s(i):i),u+=Lt(a);for(o=n-e-1;o>=e;o--)i=t.children[o],It(l,t.leaf?s(i):i),u+=Lt(l);return u},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)It(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Pt(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},Et.default=St;var Vt=function(t,e,n){var r=t*e,o=zt*t,i=o-(o-t),s=t-i,a=zt*e,l=a-(a-e),u=e-l,c=s*u-(r-i*l-s*l-i*u);return n?(n[0]=c,n[1]=r,n):[c,r]},zt=+(Math.pow(2,27)+1),jt=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,o=t-(n-r)+(e-r);return o?[o,n]:[n]}(t[0],e[0]);var o,i,s=new Array(n+r),a=0,l=0,u=0,c=Math.abs,p=t[l],h=c(p),d=e[u],f=c(d);h<f?(i=p,(l+=1)<n&&(h=c(p=t[l]))):(i=d,(u+=1)<r&&(f=c(d=e[u]))),l<n&&h<f||u>=r?(o=p,(l+=1)<n&&(h=c(p=t[l]))):(o=d,(u+=1)<r&&(f=c(d=e[u])));for(var g,m,y=o+i,v=y-o,_=i-v,w=_,C=y;l<n&&u<r;)h<f?(o=p,(l+=1)<n&&(h=c(p=t[l]))):(o=d,(u+=1)<r&&(f=c(d=e[u]))),(_=(i=w)-(v=(y=o+i)-o))&&(s[a++]=_),w=C-((g=C+y)-(m=g-C))+(y-m),C=g;for(;l<n;)(_=(i=w)-(v=(y=(o=p)+i)-o))&&(s[a++]=_),w=C-((g=C+y)-(m=g-C))+(y-m),C=g,(l+=1)<n&&(p=t[l]);for(;u<r;)(_=(i=w)-(v=(y=(o=d)+i)-o))&&(s[a++]=_),w=C-((g=C+y)-(m=g-C))+(y-m),C=g,(u+=1)<r&&(d=e[u]);return w&&(s[a++]=w),C&&(s[a++]=C),a||(s[a++]=0),s.length=a,s},Ht=function(t,e,n){var r=t+e,o=r-t,i=e-o,s=t-(r-o);return n?(n[0]=s+i,n[1]=r,n):[s+i,r]},Ut=function(t,e){var n=t.length;if(1===n){var r=Vt(t[0],e);return r[0]?r:[r[1]]}var o=new Array(2*n),i=[.1,.1],s=[.1,.1],a=0;Vt(t[0],e,i),i[0]&&(o[a++]=i[0]);for(var l=1;l<n;++l){Vt(t[l],e,s);var u=i[1];Ht(u,s[0],i),i[0]&&(o[a++]=i[0]);var c=s[1],p=i[1],h=c+p,d=p-(h-c);i[1]=h,d&&(o[a++]=d)}return i[1]&&(o[a++]=i[1]),0===a&&(o[a++]=0),o.length=a,o},Wt=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,o=t-(n-r)+(e-r);return o?[o,n]:[n]}(t[0],-e[0]);var o,i,s=new Array(n+r),a=0,l=0,u=0,c=Math.abs,p=t[l],h=c(p),d=-e[u],f=c(d);h<f?(i=p,(l+=1)<n&&(h=c(p=t[l]))):(i=d,(u+=1)<r&&(f=c(d=-e[u]))),l<n&&h<f||u>=r?(o=p,(l+=1)<n&&(h=c(p=t[l]))):(o=d,(u+=1)<r&&(f=c(d=-e[u])));for(var g,m,y=o+i,v=y-o,_=i-v,w=_,C=y;l<n&&u<r;)h<f?(o=p,(l+=1)<n&&(h=c(p=t[l]))):(o=d,(u+=1)<r&&(f=c(d=-e[u]))),(_=(i=w)-(v=(y=o+i)-o))&&(s[a++]=_),w=C-((g=C+y)-(m=g-C))+(y-m),C=g;for(;l<n;)(_=(i=w)-(v=(y=(o=p)+i)-o))&&(s[a++]=_),w=C-((g=C+y)-(m=g-C))+(y-m),C=g,(l+=1)<n&&(p=t[l]);for(;u<r;)(_=(i=w)-(v=(y=(o=d)+i)-o))&&(s[a++]=_),w=C-((g=C+y)-(m=g-C))+(y-m),C=g,(u+=1)<r&&(d=-e[u]);return w&&(s[a++]=w),C&&(s[a++]=C),a||(s[a++]=0),s.length=a,s},qt=Bt((function(t){function e(t,e){for(var n=new Array(t.length-1),r=1;r<t.length;++r)for(var o=n[r-1]=new Array(t.length-1),i=0,s=0;i<t.length;++i)i!==e&&(o[s++]=t[r][i]);return n}function n(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",n(t.slice(0,e)),",",n(t.slice(e)),")"].join("")}function r(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var o=[],i=0;i<t.length;++i)o.push(["scale(",n(r(e(t,i))),",",(s=i,1&s?"-":""),t[0][i],")"].join(""));return o;var s}function o(t){for(var o=[],i=[],s=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var r=0;r<t;++r)e[n][r]=["m",r,"[",t-n-1,"]"].join("")}return e}(t),a=[],l=0;l<t;++l)0==(1&l)?o.push.apply(o,r(e(s,l))):i.push.apply(i,r(e(s,l))),a.push("m"+l);var u=n(o),c=n(i),p="orientation"+t+"Exact",h=["function ",p,"(",a.join(),"){var p=",u,",n=",c,",d=sub(p,n);return d[d.length-1];};return ",p].join("");return new Function("sum","prod","scale","sub",h)(jt,Vt,Ut,Wt)}var i=o(3),s=o(4),a=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var r,o=(t[1]-n[1])*(e[0]-n[0]),s=(t[0]-n[0])*(e[1]-n[1]),a=o-s;if(o>0){if(s<=0)return a;r=o+s}else{if(!(o<0))return a;if(s>=0)return a;r=-(o+s)}var l=33306690738754716e-32*r;return a>=l||a<=-l?a:i(t,e,n)},function(t,e,n,r){var o=t[0]-r[0],i=e[0]-r[0],a=n[0]-r[0],l=t[1]-r[1],u=e[1]-r[1],c=n[1]-r[1],p=t[2]-r[2],h=e[2]-r[2],d=n[2]-r[2],f=i*c,g=a*u,m=a*l,y=o*c,v=o*u,_=i*l,w=p*(f-g)+h*(m-y)+d*(v-_),C=7771561172376103e-31*((Math.abs(f)+Math.abs(g))*Math.abs(p)+(Math.abs(m)+Math.abs(y))*Math.abs(h)+(Math.abs(v)+Math.abs(_))*Math.abs(d));return w>C||-w>C?w:s(t,e,n,r)}];function l(t){var e=a[t.length];return e||(e=a[t.length]=o(t.length)),e.apply(void 0,t)}!function(){for(;a.length<=5;)a.push(o(a.length));for(var e=[],n=["slow"],r=0;r<=5;++r)e.push("a"+r),n.push("o"+r);var i=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;r<=5;++r)i.push("case ",r,":return o",r,"(",e.slice(0,r).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(i.join(""));var s=Function.apply(void 0,n);for(t.exports=s.apply(void 0,[l].concat(a)),r=0;r<=5;++r)t.exports[r]=a[r]}()})),Xt=qt[3],Kt=Zt,Yt=Zt;function Zt(t,e){if(!(this instanceof Zt))return new Zt(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||Qt,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function Qt(t,e){return t<e?-1:t>e?1:0}Zt.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var o=t-1>>1,i=e[o];if(n(r,i)>=0)break;e[t]=i,t=o}e[t]=r},_down:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,o=e[t];t<r;){var i=1+(t<<1),s=i+1,a=e[i];if(s<this.length&&n(e[s],a)<0&&(i=s,a=e[s]),n(a,o)>=0)break;e[t]=a,t=i}e[t]=o}},Kt.default=Yt;var Jt=function(t,e){for(var n=t[0],r=t[1],o=!1,i=0,s=e.length-1;i<e.length;s=i++){var a=e[i][0],l=e[i][1],u=e[s][0],c=e[s][1];l>r!=c>r&&n<(u-a)*(r-l)/(c-l)+a&&(o=!o)}return o},$t=qt[3],te=ne,ee=ne;function ne(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;for(var r,o=function(t){for(var e=t[0],n=t[0],r=t[0],o=t[0],i=0;i<t.length;i++){var s=t[i];s[0]<e[0]&&(e=s),s[0]>r[0]&&(r=s),s[1]<n[1]&&(n=s),s[1]>o[1]&&(o=s)}var a=[e,n,r,o],l=a.slice();for(i=0;i<t.length;i++)Jt(t[i],a)||l.push(t[i]);var u=function(t){var e=t.length;if(e<3){for(var n=new Array(e),r=0;r<e;++r)n[r]=r;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var o=new Array(e);for(r=0;r<e;++r)o[r]=r;o.sort((function(e,n){return t[e][0]-t[n][0]||t[e][1]-t[n][1]}));var i=[o[0],o[1]],s=[o[0],o[1]];for(r=2;r<e;++r){for(var a=o[r],l=t[a],u=i.length;u>1&&Xt(t[i[u-2]],t[i[u-1]],l)<=0;)u-=1,i.pop();for(i.push(a),u=s.length;u>1&&Xt(t[s[u-2]],t[s[u-1]],l)>=0;)u-=1,s.pop();s.push(a)}n=new Array(s.length+i.length-2);for(var c=0,p=(r=0,i.length);r<p;++r)n[c++]=i[r];for(var h=s.length-2;h>0;--h)n[c++]=s[h];return n}(l),c=[];for(i=0;i<u.length;i++)c.push(l[u[i]]);return c}(t),i=Et(16,["[0]","[1]","[0]","[1]"]).load(t),s=[],a=0;a<o.length;a++){var l=o[a];i.remove(l),r=ue(l,r),s.push(r)}var u=Et(16);for(a=0;a<s.length;a++)u.insert(le(s[a]));for(var c=e*e,p=n*n;s.length;){var h=s.shift(),d=h.p,f=h.next.p,g=ce(d,f);if(!(g<p)){var m=g/c;(l=re(i,h.prev.p,d,f,h.next.next.p,m,u))&&Math.min(ce(l,d),ce(l,f))<=m&&(s.push(h),s.push(ue(l,h)),i.remove(l),u.remove(h),u.insert(le(h)),u.insert(le(h.next)))}}h=r;var y=[];do{y.push(h.p),h=h.next}while(h!==r);return y.push(h.p),y}function re(t,e,n,r,o,i,s){for(var a=new Kt(null,oe),l=t.data;l;){for(var u=0;u<l.children.length;u++){var c=l.children[u],p=l.leaf?pe(c,n,r):ie(n,r,c);p>i||a.push({node:c,dist:p})}for(;a.length&&!a.peek().node.children;){var h=a.pop(),d=h.node,f=pe(d,e,n),g=pe(d,r,o);if(h.dist<f&&h.dist<g&&ae(n,d,s)&&ae(r,d,s))return d}(l=a.pop())&&(l=l.node)}return null}function oe(t,e){return t.dist-e.dist}function ie(t,e,n){if(se(t,n)||se(e,n))return 0;var r=he(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var o=he(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===o)return 0;var i=he(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===i)return 0;var s=he(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(r,o,i,s)}function se(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function ae(t,e,n){for(var r,o,i,s,a=Math.min(t[0],e[0]),l=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),p=n.search({minX:a,minY:l,maxX:u,maxY:c}),h=0;h<p.length;h++)if(r=p[h].p,o=p[h].next.p,i=t,r!==(s=e)&&o!==i&&$t(r,o,i)>0!=$t(r,o,s)>0&&$t(i,s,r)>0!=$t(i,s,o)>0)return!1;return!0}function le(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function ue(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function ce(t,e){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function pe(t,e,n){var r=e[0],o=e[1],i=n[0]-r,s=n[1]-o;if(0!==i||0!==s){var a=((t[0]-r)*i+(t[1]-o)*s)/(i*i+s*s);a>1?(r=n[0],o=n[1]):a>0&&(r+=i*a,o+=s*a)}return(i=t[0]-r)*i+(s=t[1]-o)*s}function he(t,e,n,r,o,i,s,a){var l,u,c,p,h=n-t,d=r-e,f=s-o,g=a-i,m=t-o,y=e-i,v=h*h+d*d,_=h*f+d*g,w=f*f+g*g,C=h*m+d*y,b=f*m+g*y,x=v*w-_*_,E=x,S=x;0===x?(u=0,E=1,p=b,S=w):(p=v*b-_*C,(u=_*b-w*C)<0?(u=0,p=b,S=w):u>E&&(u=E,p=b+_,S=w)),p<0?(p=0,-C<0?u=0:-C>v?u=E:(u=-C,E=v)):p>S&&(p=S,-C+_<0?u=0:-C+_>v?u=E:(u=-C+_,E=v));var T=(1-(c=0===p?0:p/S))*o+c*s-((1-(l=0===u?0:u/E))*t+l*n),R=(1-c)*i+c*a-((1-l)*e+l*r);return T*T+R*R}function de(t,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var n=[];if(M(t,(function(t){n.push([t[0],t[1]])})),!n.length)return null;var r=te(n,e.concavity);return r.length>3?c([r]):null}function fe(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=J(t),o=ot(e),i=o.type,s=e.bbox,a=o.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,s))return!1;"Polygon"===i&&(a=[a]);for(var l=!1,u=0;u<a.length&&!l;u++)if(ge(r,a[u][0],n.ignoreBoundary)){for(var c=!1,p=1;p<a[u].length&&!c;)ge(r,a[u][p],!n.ignoreBoundary)&&(c=!0),p++;c||(l=!0)}return l}function ge(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,i=e.length-1;o<e.length;i=o++){var s=e[o][0],a=e[o][1],l=e[i][0],u=e[i][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(r=!r)}return r}function me(t,e){var n=[];return k(t,(function(t){var r=!1;if("Point"===t.geometry.type)V(e,(function(e){fe(t,e)&&(r=!0)})),r&&n.push(t);else{if("MultiPoint"!==t.geometry.type)throw new Error("Input geometry must be a Point or MultiPoint");var o=[];V(e,(function(e){M(t,(function(t){fe(t,e)&&(r=!0,o.push(t))}))})),r&&n.push(m(o))}})),f(n)}function ye(t,e,n){void 0===n&&(n={});var r=J(t),o=J(e),i=S(o[1]-r[1]),s=S(o[0]-r[0]),a=S(r[1]),l=S(o[1]),u=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return w(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),n.units)}function ve(t,e){var n=!1;return f(function(t){if(t.length<3)return[];t.sort(we);for(var e,n,r,o,i,s,a=t.length-1,l=t[a].x,u=t[0].x,c=t[a].y,p=c;a--;)t[a].y<c&&(c=t[a].y),t[a].y>p&&(p=t[a].y);var h,d=u-l,f=p-c,g=d>f?d:f,m=.5*(u+l),y=.5*(p+c),v=[new _e({__sentinel:!0,x:m-20*g,y:y-g},{__sentinel:!0,x:m,y:y+20*g},{__sentinel:!0,x:m+20*g,y:y-g})],_=[],w=[];for(a=t.length;a--;){for(w.length=0,h=v.length;h--;)(d=t[a].x-v[h].x)>0&&d*d>v[h].r?(_.push(v[h]),v.splice(h,1)):d*d+(f=t[a].y-v[h].y)*f>v[h].r||(w.push(v[h].a,v[h].b,v[h].b,v[h].c,v[h].c,v[h].a),v.splice(h,1));for(Ce(w),h=w.length;h;)n=w[--h],e=w[--h],r=t[a],o=n.x-e.x,i=n.y-e.y,s=2*(o*(r.y-n.y)-i*(r.x-n.x)),Math.abs(s)>1e-12&&v.push(new _e(e,n,r))}for(Array.prototype.push.apply(_,v),a=_.length;a--;)(_[a].a.__sentinel||_[a].b.__sentinel||_[a].c.__sentinel)&&_.splice(a,1);return _}(t.features.map((function(t){var r={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?r.z=t.properties[e]:3===t.geometry.coordinates.length&&(n=!0,r.z=t.geometry.coordinates[2]),r}))).map((function(t){var e=[t.a.x,t.a.y],r=[t.b.x,t.b.y],o=[t.c.x,t.c.y],i={};return n?(e.push(t.a.z),r.push(t.b.z),o.push(t.c.z)):i={a:t.a.z,b:t.b.z,c:t.c.z},c([[e,r,o,e]],i)})))}te.default=ee;var _e=function(t,e,n){this.a=t,this.b=e,this.c=n;var r,o,i=e.x-t.x,s=e.y-t.y,a=n.x-t.x,l=n.y-t.y,u=i*(t.x+e.x)+s*(t.y+e.y),c=a*(t.x+n.x)+l*(t.y+n.y),p=2*(i*(n.y-e.y)-s*(n.x-e.x));this.x=(l*u-s*c)/p,this.y=(i*c-a*u)/p,r=this.x-t.x,o=this.y-t.y,this.r=r*r+o*o};function we(t,e){return e.x-t.x}function Ce(t){var e,n,r,o,i,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],r=s;r;)if(i=t[--r],e===(o=t[--r])&&n===i||e===i&&n===o){t.splice(s,2),t.splice(r,2),s-=2;continue t}}function be(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return xe(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return xe(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Ee(t);default:throw new Error("unknown GeoJSON type")}}function xe(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=function t(e){var n={};return e?(Object.keys(e).forEach((function(r){var o=e[r];"object"==typeof o?null===o?n[r]=null:Array.isArray(o)?n[r]=o.map((function(t){return t})):n[r]=t(o):n[r]=o})),n):n}(t.properties),e.geometry=Ee(t.geometry),e}function Ee(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Ee(t)})),e):(e.coordinates=function t(e){var n=e;return"object"!=typeof n[0]?n.slice():n.map((function(e){return t(e)}))}(t.coordinates),e)}function Se(t){return t[0].toString()+","+t[1].toString()}function Te(t){return t}function Re(t,e){var n=function(t){if(null==t)return Te;var e,n,r=t.scale[0],o=t.scale[1],i=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+i,c[1]=(n+=t[1])*o+s;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function o(t,e){e.length&&e.pop();for(var o=r[t<0?~t:t],i=0,s=o.length;i<s;++i)e.push(n(o[i],i));t<0&&function(t,e){for(var n,r=t.length,o=r-e;o<--r;)n=t[o],t[o++]=t[r],t[r]=n}(e,s)}function i(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)o(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(a)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=i(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(i);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function Pe(t,e){var n={},r=[],o=[];function i(t){t.forEach((function(e){e.forEach((function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)}))})),r.push(t)}function s(e){return function(t){for(var e,n=-1,r=t.length,o=t[r-1],i=0;++n<r;)e=o,o=t[n],i+=e[0]*o[1]-e[1]*o[0];return Math.abs(i)}(Re(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":i(e.arcs);break;case"MultiPolygon":e.arcs.forEach(i)}})),r.forEach((function(t){if(!t._){var e=[],r=[t];for(t._=1,o.push(e);t=r.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].forEach((function(t){t._||(t._=1,r.push(t))}))}))}))}})),r.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:o.map((function(e){var r,o=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].length<2&&o.push(t)}))}))})),(r=(o=function(t,e){var n={},r={},o={},i=[],s=-1;function a(t,e){for(var r in t){var o=t[r];delete e[o.start],delete o.start,delete o.end,o.forEach((function(t){n[t<0?~t:t]=1})),i.push(o)}}return e.forEach((function(n,r){var o,i=t.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(o=e[++s],e[s]=n,e[r]=o)})),e.forEach((function(e){var n,i,s=function(e){var n,r=t.arcs[e<0?~e:e],o=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,o]:[o,n]}(e),a=s[0],l=s[1];if(n=o[a])if(delete o[n.end],n.push(e),n.end=l,i=r[l]){delete r[i.start];var u=i===n?n:n.concat(i);r[u.start=n.start]=o[u.end=i.end]=u}else r[n.start]=o[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=a,i=o[a]){delete o[i.end];var c=i===n?n:i.concat(n);r[c.start=i.start]=o[c.end=n.end]=c}else r[n.start]=o[n.end]=n;else r[(n=[e]).start=a]=o[n.end=l]=n})),a(o,r),a(r,o),e.forEach((function(t){n[t<0?~t:t]||i.push([t])})),i}(t,o)).length)>1)for(var i,a,l=1,u=s(o[0]);l<r;++l)(i=s(o[l]))>u&&(a=o[0],o[0]=o[l],o[l]=a,u=i);return o})).filter((function(t){return t.length>0}))}}var Oe=Object.prototype.hasOwnProperty;function Ie(t,e,n,r,o,i){3===arguments.length&&(r=i=Array,o=null);for(var s=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=new i(t),l=t-1,u=0;u<t;++u)s[u]=o;function c(r,i){for(var u=e(r)&l,c=s[u],p=0;c!=o;){if(n(c,r))return a[u]=i;if(++p>=t)throw new Error("full hashmap");c=s[u=u+1&l]}return s[u]=r,a[u]=i,i}function p(r,i){for(var u=e(r)&l,c=s[u],p=0;c!=o;){if(n(c,r))return a[u];if(++p>=t)throw new Error("full hashmap");c=s[u=u+1&l]}return s[u]=r,a[u]=i,i}function h(r,i){for(var u=e(r)&l,c=s[u],p=0;c!=o;){if(n(c,r))return a[u];if(++p>=t)break;c=s[u=u+1&l]}return i}function d(){for(var t=[],e=0,n=s.length;e<n;++e){var r=s[e];r!=o&&t.push(r)}return t}return{set:c,maybeSet:p,get:h,keys:d}}function Ae(t,e){return t[0]===e[0]&&t[1]===e[1]}var De=new ArrayBuffer(16),Me=new Float64Array(De),Le=new Uint32Array(De);function Ne(t){Me[0]=t[0],Me[1]=t[1];var e=Le[0]^Le[1];return 2147483647&(e<<5^e>>7^Le[2]^Le[3])}function Fe(t,e,n,r){ke(t,e,n),ke(t,e,e+r),ke(t,e+r,n)}function ke(t,e,n){for(var r,o=e+(n---e>>1);e<o;++e,--n)r=t[e],t[e]=t[n],t[n]=r}function Ge(t){var e={type:"GeometryCollection",geometries:t.features.map(Be)};return null!=t.bbox&&(e.bbox=t.bbox),e}function Be(t){var e,n=Ve(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function Ve(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Ve)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function ze(t,e){var n=function(t){var e=1/0,n=1/0,r=-1/0,o=-1/0;function i(t){null!=t&&Oe.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(i)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){l(t.arcs)},MultiLineString:function(t){t.arcs.forEach(l)},Polygon:function(t){t.arcs.forEach(l)},MultiPolygon:function(t){t.arcs.forEach(u)}};function a(t){var i=t[0],s=t[1];i<e&&(e=i),i>r&&(r=i),s<n&&(n=s),s>o&&(o=s)}function l(t){t.forEach(a)}function u(t){t.forEach(l)}for(var c in t)i(t[c]);return r>=e&&o>=n?[e,n,r,o]:void 0}(t=function(t){var e,n,r={};for(e in t)r[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?Ge:"Feature"===n.type?Be:Ve)(n);return r}(t)),r=e>0&&n&&function(t,e,n){var r=e[0],o=e[1],i=e[2],s=e[3],a=i-r?(n-1)/(i-r):1,l=s-o?(n-1)/(s-o):1;function u(t){return[Math.round((t[0]-r)*a),Math.round((t[1]-o)*l)]}function c(t,e){for(var n,i,s,u,c,p=-1,h=0,d=t.length,f=new Array(d);++p<d;)n=t[p],u=Math.round((n[0]-r)*a),c=Math.round((n[1]-o)*l),u===i&&c===s||(f[h++]=[i=u,s=c]);for(f.length=h;h<e;)h=f.push([f[0][0],f[0][1]]);return f}function p(t){return c(t,2)}function h(t){return c(t,4)}function d(t){return t.map(h)}function f(t){null!=t&&Oe.call(g,t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(f)},Point:function(t){t.coordinates=u(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(u)},LineString:function(t){t.arcs=p(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(p)},Polygon:function(t){t.arcs=d(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(d)}};for(var m in t)f(t[m]);return{scale:[1/a,1/l],translate:[r,o]}}(t,n,e),o=function(t){var e,n,r,o,i=t.coordinates,s=t.lines,a=t.rings,l=s.length+a.length;for(delete t.lines,delete t.rings,r=0,o=s.length;r<o;++r)for(e=s[r];e=e.next;)++l;for(r=0,o=a.length;r<o;++r)for(n=a[r];n=n.next;)++l;var u=Ie(2*l*1.4,Ne,Ae),c=t.arcs=[];for(r=0,o=s.length;r<o;++r){e=s[r];do{p(e)}while(e=e.next)}for(r=0,o=a.length;r<o;++r)if((n=a[r]).next)do{p(n)}while(n=n.next);else h(n);function p(t){var e,n,r,o,s,a,l,p;if(r=u.get(e=i[t[0]]))for(l=0,p=r.length;l<p;++l)if(d(o=r[l],t))return t[0]=o[0],void(t[1]=o[1]);if(s=u.get(n=i[t[1]]))for(l=0,p=s.length;l<p;++l)if(f(a=s[l],t))return t[1]=a[0],void(t[0]=a[1]);r?r.push(t):u.set(e,[t]),s?s.push(t):u.set(n,[t]),c.push(t)}function h(t){var e,n,r,o,s;if(n=u.get(i[t[0]]))for(o=0,s=n.length;o<s;++o){if(g(r=n[o],t))return t[0]=r[0],void(t[1]=r[1]);if(m(r,t))return t[0]=r[1],void(t[1]=r[0])}if(n=u.get(e=i[t[0]+y(t)]))for(o=0,s=n.length;o<s;++o){if(g(r=n[o],t))return t[0]=r[0],void(t[1]=r[1]);if(m(r,t))return t[0]=r[1],void(t[1]=r[0])}n?n.push(t):u.set(e,[t]),c.push(t)}function d(t,e){var n=t[0],r=e[0],o=t[1];if(n-o!=r-e[1])return!1;for(;n<=o;++n,++r)if(!Ae(i[n],i[r]))return!1;return!0}function f(t,e){var n=t[0],r=e[0],o=t[1],s=e[1];if(n-o!=r-s)return!1;for(;n<=o;++n,--s)if(!Ae(i[n],i[s]))return!1;return!0}function g(t,e){var n=t[0],r=e[0],o=t[1]-n;if(o!==e[1]-r)return!1;for(var s=y(t),a=y(e),l=0;l<o;++l)if(!Ae(i[n+(l+s)%o],i[r+(l+a)%o]))return!1;return!0}function m(t,e){var n=t[0],r=e[0],o=t[1],s=e[1],a=o-n;if(a!==s-r)return!1;for(var l=y(t),u=a-y(e),c=0;c<a;++c)if(!Ae(i[n+(c+l)%a],i[s-(c+u)%a]))return!1;return!0}function y(t){for(var e=t[0],n=t[1],r=e,o=r,s=i[r];++r<n;){var a=i[r];(a[0]<s[0]||a[0]===s[0]&&a[1]<s[1])&&(o=r,s=a)}return o-e}return t}(function(t){var e,n,r,o=function(t){var e,n,r,o,i=t.coordinates,s=t.lines,a=t.rings,l=function(){for(var t=Ie(1.4*i.length,C,b,Int32Array,-1,Int32Array),e=new Int32Array(i.length),n=0,r=i.length;n<r;++n)e[n]=t.maybeSet(n,n);return e}(),u=new Int32Array(i.length),c=new Int32Array(i.length),p=new Int32Array(i.length),h=new Int8Array(i.length),d=0;for(e=0,n=i.length;e<n;++e)u[e]=c[e]=p[e]=-1;for(e=0,n=s.length;e<n;++e){var f=s[e],g=f[0],m=f[1];for(r=l[g],o=l[++g],++d,h[r]=1;++g<=m;)w(e,r,r=o,o=l[g]);++d,h[o]=1}for(e=0,n=i.length;e<n;++e)u[e]=-1;for(e=0,n=a.length;e<n;++e){var y=a[e],v=y[0]+1,_=y[1];for(w(e,l[_-1],r=l[v-1],o=l[v]);++v<=_;)w(e,r,r=o,o=l[v])}function w(t,e,n,r){if(u[n]!==t){u[n]=t;var o=c[n];if(o>=0){var i=p[n];o===e&&i===r||o===r&&i===e||(++d,h[n]=1)}else c[n]=e,p[n]=r}}function C(t){return Ne(i[t])}function b(t,e){return Ae(i[t],i[e])}u=c=p=null;var x,E=function(t,e,n,r,o){3===arguments.length&&(r=Array,o=null);for(var i=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=t-1,a=0;a<t;++a)i[a]=o;function l(r){for(var a=e(r)&s,l=i[a],u=0;l!=o;){if(n(l,r))return!0;if(++u>=t)throw new Error("full hashset");l=i[a=a+1&s]}return i[a]=r,!0}function u(r){for(var a=e(r)&s,l=i[a],u=0;l!=o;){if(n(l,r))return!0;if(++u>=t)break;l=i[a=a+1&s]}return!1}function c(){for(var t=[],e=0,n=i.length;e<n;++e){var r=i[e];r!=o&&t.push(r)}return t}return{add:l,has:u,values:c}}(1.4*d,Ne,Ae);for(e=0,n=i.length;e<n;++e)h[x=l[e]]&&E.add(i[x]);return E}(t),i=t.coordinates,s=t.lines,a=t.rings;for(n=0,r=s.length;n<r;++n)for(var l=s[n],u=l[0],c=l[1];++u<c;)o.has(i[u])&&(e={0:u,1:l[1]},l[1]=u,l=l.next=e);for(n=0,r=a.length;n<r;++n)for(var p=a[n],h=p[0],d=h,f=p[1],g=o.has(i[h]);++d<f;)o.has(i[d])&&(g?(e={0:d,1:p[1]},p[1]=d,p=p.next=e):(Fe(i,h,f,f-d),i[f]=i[h],g=!0,d=h));return t}(function(t){var e=-1,n=[],r=[],o=[];function i(t){t&&Oe.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(i)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(u)}};function a(t){for(var r=0,i=t.length;r<i;++r)o[++e]=t[r];var s={0:e-i+1,1:e};return n.push(s),s}function l(t){for(var n=0,i=t.length;n<i;++n)o[++e]=t[n];var s={0:e-i+1,1:e};return r.push(s),s}function u(t){return t.map(l)}for(var c in t)i(t[c]);return{type:"Topology",coordinates:o,lines:n,rings:r,objects:t}}(t))),i=o.coordinates,s=Ie(1.4*o.arcs.length,je,He);function a(t){t&&Oe.call(l,t.type)&&l[t.type](t)}t=o.objects,o.bbox=n,o.arcs=o.arcs.map((function(t,e){return s.set(t,e),i.slice(t[0],t[1]+1)})),delete o.coordinates,i=null;var l={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=u(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(u)},Polygon:function(t){t.arcs=t.arcs.map(u)},MultiPolygon:function(t){t.arcs=t.arcs.map(c)}};function u(t){var e=[];do{var n=s.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function c(t){return t.map(u)}for(var p in t)a(t[p]);return r&&(o.transform=r,o.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var r,o,i=t[e],s=0,a=1,l=i.length,u=i[0],c=u[0],p=u[1];++s<l;)r=(u=i[s])[0],o=u[1],r===c&&o===p||(i[a++]=[r-c,o-p],c=r,p=o);1===a&&(i[a++]=[0,0]),i.length=a}return t}(o.arcs)),o}function je(t){var e,n=t[0],r=t[1];return r<n&&(e=n,n=r,r=e),n+31*r}function He(t,e){var n,r=t[0],o=t[1],i=e[0],s=e[1];return o<r&&(n=r,r=o,o=n),s<i&&(n=i,i=s,s=n),r===i&&o===s}function Ue(t,e){if(void 0===e&&(e={}),!O(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==it(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=be(t));var r=function(t){var e={};j(t,(function(t){e[t.geometry.type]=!0}));var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!r)throw new Error("geojson must be homogenous");var o=t;switch(r){case"LineString":return function(t,e){if(void 0===e&&(e={}),!O(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==it(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=be(t));var r=[],o=X(t,(function(t,e){return function(t,e){var n,r=t.geometry.coordinates,o=e.geometry.coordinates,i=Se(r[0]),s=Se(r[r.length-1]),a=Se(o[0]),l=Se(o[o.length-1]);if(i===l)n=o.concat(r.slice(1));else if(a===s)n=r.concat(o.slice(1));else if(i===a)n=r.slice(1).reverse().concat(o);else{if(s!==l)return null;n=r.concat(o.reverse().slice(1))}return h(n)}(t,e)||(r.push(t),e)}));return o&&r.push(o),r.length?1===r.length?r[0]:g(r.map((function(t){return t.coordinates}))):null}(o,e);case"Polygon":return function(t,e){if(void 0===e&&(e={}),"FeatureCollection"!==it(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==e.mutate&&void 0!==e.mutate||(t=be(t));var n=[];j(t,(function(t){n.push(t.geometry)}));var r=ze({geoms:v(n).geometry});return function(t){return Re(t,Pe.apply(this,arguments))}(r,r.objects.geoms.geometries)}(o,e);default:throw new Error(r+" is not supported")}}function We(t,e){void 0===e&&(e={});var n="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var r=it(t),o=[];switch(r){case"LineString":o=qe(t);break;case"MultiLineString":case"Polygon":$(t).forEach((function(t){o.push(qe(t))}));break;case"MultiPolygon":$(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(qe(t))})),o.push(e)}));break;case"Point":return t;case"MultiPoint":var i={};$(t).forEach((function(t){var e=t.join("-");Object.prototype.hasOwnProperty.call(i,e)||(o.push(t),i[e]=!0)}));break;default:throw new Error(r+" geometry not supported")}return t.coordinates?!0===n?(t.coordinates=o,t):{type:r,coordinates:o}:!0===n?(t.geometry.coordinates=o,t):s({type:r,coordinates:o},t.properties,{bbox:t.bbox,id:t.id})}function qe(t){var e=$(t);if(2===e.length&&!Xe(e[0],e[1]))return e;var n=[],r=e.length-1,o=n.length;n.push(e[0]);for(var i=1;i<r;i++){var s=n[n.length-1];e[i][0]===s[0]&&e[i][1]===s[1]||(n.push(e[i]),(o=n.length)>2&&Ke(n[o-3],n[o-1],n[o-2])&&n.splice(n.length-2,1))}if(n.push(e[e.length-1]),o=n.length,Xe(e[0],e[e.length-1])&&o<4)throw new Error("invalid polygon");return Ke(n[o-3],n[o-1],n[o-2])&&n.splice(n.length-2,1),n}function Xe(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ke(t,e,n){var r=n[0],o=n[1],i=t[0],s=t[1],a=e[0],l=e[1],u=a-i,c=l-s;return 0===(r-i)*c-(o-s)*u&&(Math.abs(u)>=Math.abs(c)?u>0?i<=r&&r<=a:a<=r&&r<=i:c>0?s<=o&&o<=l:l<=o&&o<=s)}function Ye(t,e,n){var r=e.x,o=e.y,i=n.x-r,s=n.y-o;if(0!==i||0!==s){var a=((t.x-r)*i+(t.y-o)*s)/(i*i+s*s);a>1?(r=n.x,o=n.y):a>0&&(r+=i*a,o+=s*a)}return(i=t.x-r)*i+(s=t.y-o)*s}function Ze(t,e){var n=t.length-1,r=[t[0]];return function t(e,n,r,o,i){for(var s,a=o,l=n+1;l<r;l++){var u=Ye(e[l],e[n],e[r]);u>a&&(s=l,a=u)}a>o&&(s-n>1&&t(e,n,s,o,i),i.push(e[s]),r-s>1&&t(e,s,r,o,i))}(t,0,n,e,r),r.push(t[n]),r}function Qe(t,e,n){if(t.length<=2)return t;var r=void 0!==e?e*e:1;return Ze(t=n?t:function(t,e){for(var n,r,o,i,s,a=t[0],l=[a],u=1,c=t.length;u<c;u++)o=a,(i=(r=n=t[u]).x-o.x)*i+(s=r.y-o.y)*s>e&&(l.push(n),a=n);return a!==n&&l.push(n),l}(t,r),r)}function Je(t,e,n){return Qe(t.map((function(t){return{x:t[0],y:t[1],z:t[2]}})),e,n).map((function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]}))}function $e(t,e,n){return t.map((function(t){var r=t.map((function(t){return{x:t[0],y:t[1]}}));if(r.length<4)throw new Error("invalid polygon");for(var o=Qe(r,e,n).map((function(t){return[t.x,t.y]}));!tn(o);)o=Qe(r,e-=.01*e,n).map((function(t){return[t.x,t.y]}));return o[o.length-1][0]===o[0][0]&&o[o.length-1][1]===o[0][1]||o.push(o[0]),o}))}function tn(t){return!(t.length<3)&&!(3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}var en=function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],r=this.points[e+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){var o=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,i=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+o),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+i),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+o),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+i),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return t.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var r=0;r<this.duration;r+=10){var o=this.pos(r);Math.sqrt((o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)+(o.z-n.z)*(o.z-n.z))>t&&(e.push(r),n=o)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*n);return function(t,e,n,r,o){var i=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:o.x*i[0]+r.x*i[1]+n.x*i[2]+e.x*i[3],y:o.y*i[0]+r.y*i[1]+n.y*i[2]+e.y*i[3],z:o.z*i[0]+r.z*i[1]+n.z*i[2]+e.z*i[3]}}((this.length-1)*n-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])},t}();function nn(t,e){void 0===e&&(e={});for(var n=e.resolution||1e4,r=e.sharpness||.85,o=[],i=ot(t).coordinates.map((function(t){return{x:t[0],y:t[1]}})),s=new en({duration:n,points:i,sharpness:r}),a=function(t){var e=s.pos(t);Math.floor(t/100)%2==0&&o.push([e.x,e.y])},l=0;l<s.duration;l+=10)a(l);return a(s.duration),h(o,e.properties)}function rn(t,e){void 0===e&&(e={});var n=Number(t[0]),r=Number(t[1]),o=Number(t[2]),i=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[n,r];return c([[s,[o,r],[o,i],[n,i],s]],e.properties,{bbox:t,id:e.id})}function on(t){return rn(Q(t))}function sn(t){var e=t[0],n=t[1],r=t[2],o=t[3];if(ye(t.slice(0,2),[r,n])>=ye(t.slice(0,2),[e,o])){var i=(n+o)/2;return[e,i-(r-e)/2,r,i+(r-e)/2]}var s=(e+r)/2;return[s-(o-n)/2,n,s+(o-n)/2,o]}function an(t,e,n,r){void 0===r&&(r={});var o=J(t),i=S(o[0]),s=S(o[1]),a=S(n),u=C(e,r.units),c=Math.asin(Math.sin(s)*Math.cos(u)+Math.cos(s)*Math.sin(u)*Math.cos(a));return l([E(i+Math.atan2(Math.sin(a)*Math.sin(u)*Math.cos(s),Math.cos(u)-Math.sin(s)*Math.sin(c))),E(c)],r.properties)}function ln(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,o=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},i=[],s=0;s<r;s++)i.push(an(t,e,-360*s/r,n).geometry.coordinates);return i.push(i[0]),c([i],o)}function un(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=un(e,t);return(n+180)%360}(t,e);var r=J(t),o=J(e),i=S(r[0]),s=S(o[0]),a=S(r[1]),l=S(o[1]),u=Math.sin(s-i)*Math.cos(l),c=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-i);return E(Math.atan2(u,c))}function cn(t,e){void 0===e&&(e={});var n=Q(t);return l([(n[0]+n[2])/2,(n[1]+n[3])/2],e.properties,e)}function pn(t,e){void 0===e&&(e={});var n=0,r=0,o=0;return M(t,(function(t){n+=t[0],r+=t[1],o++}),!0),l([n/o,r/o],e.properties)}function hn(t){var e=[];return"FeatureCollection"===t.type?k(t,(function(t){M(t,(function(n){e.push(l(n,t.properties))}))})):M(t,(function(n){e.push(l(n,t.properties))})),f(e)}var dn=gn,fn=gn;function gn(t,e,n){n=n||2;var r,o,i,s,a,l,u,c=e&&e.length,p=c?e[0]*n:t.length,h=mn(t,0,p,n,!0),d=[];if(!h)return d;if(c&&(h=function(t,e,n,r){var o,i,s,a=[];for(o=0,i=e.length;o<i;o++)(s=mn(t,e[o]*r,o<i-1?e[o+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),a.push(Tn(s));for(a.sort(xn),o=0;o<a.length;o++)En(a[o],n),n=yn(n,n.next);return n}(t,e,h,n)),t.length>80*n){r=i=t[0],o=s=t[1];for(var f=n;f<p;f+=n)(a=t[f])<r&&(r=a),(l=t[f+1])<o&&(o=l),a>i&&(i=a),l>s&&(s=l);u=0!==(u=Math.max(i-r,s-o))?1/u:0}return vn(h,d,n,r,o,u),d}function mn(t,e,n,r,o){var i,s;if(o===kn(t,e,n,r)>0)for(i=e;i<n;i+=r)s=Ln(i,t[i],t[i+1],s);else for(i=n-r;i>=e;i-=r)s=Ln(i,t[i],t[i+1],s);return s&&In(s,s.next)&&(Nn(s),s=s.next),s}function yn(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!In(r,r.next)&&0!==On(r.prev,r,r.next))r=r.next;else{if(Nn(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function vn(t,e,n,r,o,i,s){if(t){!s&&i&&function(t,e,n,r){var o=t;do{null===o.z&&(o.z=Sn(o.x,o.y,e,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,r,o,i,s,a,l,u=1;do{for(n=t,t=null,i=null,s=0;n;){for(s++,r=n,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(o=n,n=n.nextZ,a--):(o=r,r=r.nextZ,l--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;n=r}i.nextZ=null,u*=2}while(s>1)}(o)}(t,r,o,i);for(var a,l,u=t;t.prev!==t.next;)if(a=t.prev,l=t.next,i?wn(t,r,o,i):_n(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),Nn(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?vn(t=Cn(t,e,n),e,n,r,o,i,2):2===s&&bn(t,e,n,r,o,i):vn(yn(t),e,n,r,o,i,1);break}}}function _n(t){var e=t.prev,n=t,r=t.next;if(On(e,n,r)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(Rn(e.x,e.y,n.x,n.y,r.x,r.y,o.x,o.y)&&On(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function wn(t,e,n,r){var o=t.prev,i=t,s=t.next;if(On(o,i,s)>=0)return!1;for(var a=o.x<i.x?o.x<s.x?o.x:s.x:i.x<s.x?i.x:s.x,l=o.y<i.y?o.y<s.y?o.y:s.y:i.y<s.y?i.y:s.y,u=o.x>i.x?o.x>s.x?o.x:s.x:i.x>s.x?i.x:s.x,c=o.y>i.y?o.y>s.y?o.y:s.y:i.y>s.y?i.y:s.y,p=Sn(a,l,e,n,r),h=Sn(u,c,e,n,r),d=t.prevZ,f=t.nextZ;d&&d.z>=p&&f&&f.z<=h;){if(d!==t.prev&&d!==t.next&&Rn(o.x,o.y,i.x,i.y,s.x,s.y,d.x,d.y)&&On(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,f!==t.prev&&f!==t.next&&Rn(o.x,o.y,i.x,i.y,s.x,s.y,f.x,f.y)&&On(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;d&&d.z>=p;){if(d!==t.prev&&d!==t.next&&Rn(o.x,o.y,i.x,i.y,s.x,s.y,d.x,d.y)&&On(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;f&&f.z<=h;){if(f!==t.prev&&f!==t.next&&Rn(o.x,o.y,i.x,i.y,s.x,s.y,f.x,f.y)&&On(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Cn(t,e,n){var r=t;do{var o=r.prev,i=r.next.next;!In(o,i)&&An(o,r,r.next,i)&&Dn(o,i)&&Dn(i,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(i.i/n),Nn(r),Nn(r.next),r=t=i),r=r.next}while(r!==t);return r}function bn(t,e,n,r,o,i){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&Pn(s,a)){var l=Mn(s,a);return s=yn(s,s.next),l=yn(l,l.next),vn(s,e,n,r,o,i),void vn(l,e,n,r,o,i)}a=a.next}s=s.next}while(s!==t)}function xn(t,e){return t.x-e.x}function En(t,e){if(e=function(t,e){var n,r=e,o=t.x,i=t.y,s=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>s){if(s=a,a===o){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(o===s)return n.prev;var l,u=n,c=n.x,p=n.y,h=1/0;for(r=n.next;r!==u;)o>=r.x&&r.x>=c&&o!==r.x&&Rn(i<p?o:s,i,c,p,i<p?s:o,i,r.x,r.y)&&((l=Math.abs(i-r.y)/(o-r.x))<h||l===h&&r.x>n.x)&&Dn(r,t)&&(n=r,h=l),r=r.next;return n}(t,e)){var n=Mn(e,t);yn(n,n.next)}}function Sn(t,e,n,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Tn(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Rn(t,e,n,r,o,i,s,a){return(o-s)*(e-a)-(t-s)*(i-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(i-a)-(o-s)*(r-a)>=0}function Pn(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&An(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Dn(t,e)&&Dn(e,t)&&function(t,e){var n=t,r=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function On(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function In(t,e){return t.x===e.x&&t.y===e.y}function An(t,e,n,r){return!!(In(t,e)&&In(n,r)||In(t,r)&&In(n,e))||On(t,e,n)>0!=On(t,e,r)>0&&On(n,r,t)>0!=On(n,r,e)>0}function Dn(t,e){return On(t.prev,t,t.next)<0?On(t,e,t.next)>=0&&On(t,t.prev,e)>=0:On(t,e,t.prev)<0||On(t,t.next,e)<0}function Mn(t,e){var n=new Fn(t.i,t.x,t.y),r=new Fn(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Ln(t,e,n,r){var o=new Fn(t,e,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Nn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Fn(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function kn(t,e,n,r){for(var o=0,i=e,s=n-r;i<n;i+=r)o+=(t[s]-t[i])*(t[i+1]+t[s+1]),s=i;return o}function Gn(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var s=0;s<e;s++)n.vertices.push(t[o][i][s]);o>0&&(r+=t[o-1].length,n.holes.push(r))}return n}(t),n=dn(e.vertices,e.holes,2),r=[],o=[];n.forEach((function(t,r){var i=n[r];o.push([e.vertices[2*i],e.vertices[2*i+1]])}));for(var i=0;i<o.length;i+=3){var s=o.slice(i,i+3);s.push(o[i]),r.push(c([s]))}return r}function Bn(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var n,r=1/0,o=0;return k(e,(function(e,n){var i=ye(t,e);i<r&&(o=n,r=i)})),(n=be(e.features[o])).properties.featureIndex=o,n.properties.distanceToPoint=r,n}function Vn(t){if(!t)throw new Error("geojson is required");var e=[];return j(t,(function(t){!function(t,e){var n=[],r=t.geometry;if(null!==r){switch(r.type){case"Polygon":n=$(r);break;case"LineString":n=[$(r)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,r){var o=h([t,r],e);return o.bbox=function(t,e){var n=t[0],r=t[1],o=e[0],i=e[1];return[n<o?n:o,r<i?r:i,n>o?n:o,r>i?r:i]}(t,r),n.push(o),r})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),f(e)}gn.deviation=function(t,e,n,r){var o=e&&e.length,i=o?e[0]*n:t.length,s=Math.abs(kn(t,0,i,n));if(o)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(kn(t,u,c,n))}var p=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,f=r[a+2]*n;p+=Math.abs((t[h]-t[f])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[f+1]-t[h+1]))}return 0===s&&0===p?0:Math.abs((p-s)/s)},gn.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var s=0;s<e;s++)n.vertices.push(t[o][i][s]);o>0&&(r+=t[o-1].length,n.holes.push(r))}return n},dn.default=fn;var zn=Bt((function(t,e){function n(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function r(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r)}function o(t,e,r){void 0===r&&(r={});for(var o=0,i=t;o<i.length;o++){var s=i[o];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function i(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function l(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function u(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function c(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function p(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function h(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(t){case"Point":return r(e).geometry;case"LineString":return i(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=r,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.polygon=o,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.lineString=i,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=p,e.lengthToDegrees=function(t,e){return h(p(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=h,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(p(t,e),n)},e.convertArea=function(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[n];if(!o)throw new Error("invalid original units");var i=e.areaFactors[r];if(!i)throw new Error("invalid final units");return t/o*i},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}}));function jn(t,e,n){if(null!==t)for(var r,o,i,s,a,l,u,c,p=0,h=0,d=t.type,f="FeatureCollection"===d,g="Feature"===d,m=f?t.features.length:1,y=0;y<m;y++){a=(c=!!(u=f?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var _=0,w=0;if(null!==(s=c?u.geometries[v]:u)){l=s.coordinates;var C=s.type;switch(p=!n||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===e(l,h,y,_,w))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===e(l[r],h,y,_,w))return!1;h++,"MultiPoint"===C&&_++}"LineString"===C&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-p;o++){if(!1===e(l[r][o],h,y,_,w))return!1;h++}"MultiLineString"===C&&_++,"Polygon"===C&&w++}"Polygon"===C&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(w=0,o=0;o<l[r].length;o++){for(i=0;i<l[r][o].length-p;i++){if(!1===e(l[r][o][i],h,y,_,w))return!1;h++}w++}_++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===jn(s.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Hn(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function Un(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function Wn(t,e){var n,r,o,i,s,a,l,u,c,p,h=0,d="FeatureCollection"===t.type,f="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:f?t.geometry:t,u=d?t.features[n].properties:f?t.properties:{},c=d?t.features[n].bbox:f?t.bbox:void 0,p=d?t.features[n].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,o=0;o<s;o++)if(null!==(i=l?a.geometries[o]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,u,c,p))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===e(i.geometries[r],h,u,c,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,u,c,p))return!1;h++}}function qn(t,e){Wn(t,(function(t,n,r,o,i){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(zn.feature(t,r,{bbox:o,id:i}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u={type:s,coordinates:t.coordinates[l]};if(!1===e(zn.feature(u,r),n,l))return!1}}))}function Xn(t,e){qn(t,(function(t,n,r){var o=0;if(t.geometry){var i=t.geometry.type;if("Point"!==i&&"MultiPoint"!==i){var s,a=0,l=0,u=0;return!1!==jn(t,(function(i,c,p,h,d){if(void 0===s||n>a||h>l||d>u)return s=i,a=n,l=h,u=d,void(o=0);var f=zn.lineString([s,i],t.properties);if(!1===e(f,n,r,d,o))return!1;o++,s=i}))&&void 0}}}))}function Kn(t,e){if(!t)throw new Error("geojson is required");qn(t,(function(t,n,r){if(null!==t.geometry){var o=t.geometry.type,i=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var s=0;s<i.length;s++)if(!1===e(zn.lineString(i[s],t.properties),n,r,s))return!1}}}))}var Yn=jn,Zn=Un,Qn=qn,Jn=Wn,$n=Kn,tr=Hn,er=Xn,nr=Object.defineProperty({coordAll:function(t){var e=[];return jn(t,(function(t){e.push(t)})),e},coordEach:Yn,coordReduce:function(t,e,n,r){var o=n;return jn(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o},featureEach:Zn,featureReduce:function(t,e,n){var r=n;return Un(t,(function(t,o){r=0===o&&void 0===n?t:e(r,t,o)})),r},findPoint:function(t,e){if(e=e||{},!zn.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,i=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var l=n.coordinates;switch(n.type){case"Point":return zn.point(l,a,e);case"MultiPoint":return o<0&&(o=l.length+o),zn.point(l[o],a,e);case"LineString":return s<0&&(s=l.length+s),zn.point(l[s],a,e);case"Polygon":return i<0&&(i=l.length+i),s<0&&(s=l[i].length+s),zn.point(l[i][s],a,e);case"MultiLineString":return o<0&&(o=l.length+o),s<0&&(s=l[o].length+s),zn.point(l[o][s],a,e);case"MultiPolygon":return o<0&&(o=l.length+o),i<0&&(i=l[o].length+i),s<0&&(s=l[o][i].length-s),zn.point(l[o][i][s],a,e)}throw new Error("geojson is invalid")},findSegment:function(t,e){if(e=e||{},!zn.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,i=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var l=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=l.length+s-1),zn.lineString([l[s],l[s+1]],a,e);case"Polygon":return i<0&&(i=l.length+i),s<0&&(s=l[i].length+s-1),zn.lineString([l[i][s],l[i][s+1]],a,e);case"MultiLineString":return o<0&&(o=l.length+o),s<0&&(s=l[o].length+s-1),zn.lineString([l[o][s],l[o][s+1]],a,e);case"MultiPolygon":return o<0&&(o=l.length+o),i<0&&(i=l[o].length+i),s<0&&(s=l[o][i].length-s-1),zn.lineString([l[o][i][s],l[o][i][s+1]],a,e)}throw new Error("geojson is invalid")},flattenEach:Qn,flattenReduce:function(t,e,n){var r=n;return qn(t,(function(t,o,i){r=0===o&&0===i&&void 0===n?t:e(r,t,o,i)})),r},geomEach:Jn,geomReduce:function(t,e,n){var r=n;return Wn(t,(function(t,o,i,s,a){r=0===o&&void 0===n?t:e(r,t,o,i,s,a)})),r},lineEach:$n,lineReduce:function(t,e,n){var r=n;return Kn(t,(function(t,o,i,s){r=0===o&&void 0===n?t:e(r,t,o,i,s)})),r},propEach:tr,propReduce:function(t,e,n){var r=n;return Hn(t,(function(t,o){r=0===o&&void 0===n?t:e(r,t,o)})),r},segmentEach:er,segmentReduce:function(t,e,n){var r=n,o=!1;return Xn(t,(function(t,i,s,a,l){r=!1===o&&void 0===n?t:e(r,t,i,s,a,l),o=!0})),r}},"__esModule",{value:!0});function rr(t){var e=[1/0,1/0,-1/0,-1/0];return nr.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}rr.default=rr;var or=rr,ir=Object.defineProperty({default:or},"__esModule",{value:!0}).default,sr=nr.featureEach,ar=(nr.coordEach,zn.polygon,zn.featureCollection);function lr(t){var e=Et(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:ir(t),Et.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:ir(t),e.push(t)})):sr(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:ir(t),e.push(t)})),Et.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:ir(t),Et.prototype.remove.call(this,t,e)},e.clear=function(){return Et.prototype.clear.call(this)},e.search=function(t){var e=Et.prototype.search.call(this,this.toBBox(t));return ar(e)},e.collides=function(t){return Et.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=Et.prototype.all.call(this);return ar(t)},e.toJSON=function(){return Et.prototype.toJSON.call(this)},e.fromJSON=function(t){return Et.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=ir(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=ir(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}var ur=lr,cr=lr;function pr(t,e){var n={},r=[];if("LineString"===t.type&&(t=s(t)),"LineString"===e.type&&(e=s(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var o=hr(t,e);return o&&r.push(o),f(r)}var i=ur();return i.load(Vn(e)),k(Vn(t),(function(t){k(i.search(t),(function(e){var o=hr(t,e);if(o){var i=$(o).join(",");n[i]||(n[i]=!0,r.push(o))}}))})),f(r)}function hr(t,e){var n=$(t),r=$(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],i=n[0][1],s=n[1][0],a=n[1][1],u=r[0][0],c=r[0][1],p=r[1][0],h=r[1][1],d=(h-c)*(s-o)-(p-u)*(a-i);if(0===d)return null;var f=((p-u)*(i-c)-(h-c)*(o-u))/d,g=((s-o)*(i-c)-(a-i)*(o-u))/d;return f>=0&&f<=1&&g>=0&&g<=1?l([o+f*(s-o),i+f*(a-i)]):null}function dr(t,e,n){void 0===n&&(n={});var r=l([1/0,1/0],{dist:1/0}),o=0;return j(t,(function(t){for(var i=$(t),s=0;s<i.length-1;s++){var a=l(i[s]);a.properties.dist=ye(e,a,n);var u=l(i[s+1]);u.properties.dist=ye(e,u,n);var c=ye(a,u,n),p=Math.max(a.properties.dist,u.properties.dist),d=un(a,u),f=an(e,p,d+90,n),g=an(e,p,d-90,n),m=pr(h([f.geometry.coordinates,g.geometry.coordinates]),h([a.geometry.coordinates,u.geometry.coordinates])),y=null;m.features.length>0&&((y=m.features[0]).properties.dist=ye(e,y,n),y.properties.location=o+ye(a,y,n)),a.properties.dist<r.properties.dist&&((r=a).properties.index=s,r.properties.location=o),u.properties.dist<r.properties.dist&&((r=u).properties.index=s+1,r.properties.location=o+c),y&&y.properties.dist<r.properties.dist&&((r=y).properties.index=s),o+=c}})),r}function fr(t,e,r){void 0===r&&(r={});var o=J(t),i=J(e);return i[0]+=i[0]-o[0]>180?-360:o[0]-i[0]>180?360:0,T(function(t,e,r){var o=r=void 0===r?n:Number(r),i=t[1]*Math.PI/180,s=e[1]*Math.PI/180,a=s-i,l=Math.abs(e[0]-t[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);var u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),c=Math.abs(u)>1e-11?a/u:Math.cos(i);return Math.sqrt(a*a+c*c*l*l)*o}(o,i),"meters",r.units)}function gr(t,e,n){if(void 0===n&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=l(t):"Point"===t.type?t=s(t):nt(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=h(e):"LineString"===e.type?e=s(e):nt(e,"LineString","line");var r=1/0,o=t.geometry.coordinates;return U(e,(function(t){var e=t.geometry.coordinates[0],i=t.geometry.coordinates[1],s=function(t,e,n,r){var o=[n[0]-e[0],n[1]-e[1]],i=mr([t[0]-e[0],t[1]-e[1]],o);if(i<=0)return yr(t,e,{method:r.method,units:"degrees"});var s=mr(o,o);if(s<=i)return yr(t,n,{method:r.method,units:"degrees"});var a=i/s;return yr(t,[e[0]+a*o[0],e[1]+a*o[1]],{method:r.method,units:"degrees"})}(o,e,i,n);s<r&&(r=s)})),T(r,"degrees",n.units)}function mr(t,e){return t[0]*e[0]+t[1]*e[1]}function yr(t,e,n){return"planar"===n.method?fr(t,e,n):ye(t,e,n)}function vr(t,e,n,r,o,i,s,a){var l,u,c,p,h={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(l=(a-i)*(n-t)-(s-o)*(r-e))?null!==h.x&&null!==h.y&&h:(p=(n-t)*(u=e-i)-(r-e)*(c=t-o),u=((s-o)*u-(a-i)*c)/l,c=p/l,h.x=t+u*(n-t),h.y=e+u*(r-e),u>=0&&u<=1&&(h.onLine1=!0),c>=0&&c<=1&&(h.onLine2=!0),!(!h.onLine1||!h.onLine2)&&[h.x,h.y])}function _r(t){for(var e=function(t){return"FeatureCollection"!==t.type?"Feature"!==t.type?f([s(t)]):f([t]):t}(t),n=cn(e),r=!1,o=0;!r&&o<e.features.length;){var i,a=e.features[o].geometry,u=!1;if("Point"===a.type)n.geometry.coordinates[0]===a.coordinates[0]&&n.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if("MultiPoint"===a.type){var c=!1;for(i=0;!c&&i<a.coordinates.length;)n.geometry.coordinates[0]===a.coordinates[i][0]&&n.geometry.coordinates[1]===a.coordinates[i][1]&&(r=!0,c=!0),i++}else if("LineString"===a.type)for(i=0;!u&&i<a.coordinates.length-1;)wr(n.geometry.coordinates[0],n.geometry.coordinates[1],a.coordinates[i][0],a.coordinates[i][1],a.coordinates[i+1][0],a.coordinates[i+1][1])&&(u=!0,r=!0),i++;else if("MultiLineString"===a.type)for(var p=0;p<a.coordinates.length;){u=!1,i=0;for(var h=a.coordinates[p];!u&&i<h.length-1;)wr(n.geometry.coordinates[0],n.geometry.coordinates[1],h[i][0],h[i][1],h[i+1][0],h[i+1][1])&&(u=!0,r=!0),i++;p++}else"Polygon"!==a.type&&"MultiPolygon"!==a.type||fe(n,a)&&(r=!0);o++}if(r)return n;var d=f([]);for(o=0;o<e.features.length;o++)d.features=d.features.concat(hn(e.features[o]).features);return l(Bn(n,d).geometry.coordinates)}function wr(t,e,n,r,o,i){return Math.sqrt((o-n)*(o-n)+(i-r)*(i-r))===Math.sqrt((t-n)*(t-n)+(e-r)*(e-r))+Math.sqrt((o-t)*(o-t)+(i-e)*(i-e))}function Cr(t){return z(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return br(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=br(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function br(t){var e=0;if(t&&t.length>0){e+=Math.abs(xr(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(xr(t[n]))}return e}function xr(t){var e,n,r,o,i,s,a=0,l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(r=l-2,o=l-1,i=0):s===l-1?(r=l-1,o=0,i=1):(r=s,o=s+1,i=s+2),e=t[r],n=t[o],a+=(Er(t[i][0])-Er(e[0]))*Math.sin(Er(n[1]));a=6378137*a*6378137/2}return a}function Er(t){return t*Math.PI/180}function Sr(t,e){return void 0===e&&(e={}),W(t,(function(t,n){var r=n.geometry.coordinates;return t+ye(r[0],r[1],e)}),0)}function Tr(t,e,n,r){if(!O(r=r||{}))throw new Error("options is invalid");var o,i=[];if("Feature"===t.type)o=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");o=t.coordinates}for(var s,a,l,u=o.length,c=0,p=0;p<o.length&&!(e>=c&&p===o.length-1);p++){if(c>e&&0===i.length){if(!(s=e-c))return i.push(o[p]),h(i);a=un(o[p],o[p-1])-180,l=an(o[p],s,a,r),i.push(l.geometry.coordinates)}if(c>=n)return(s=n-c)?(a=un(o[p],o[p-1])-180,l=an(o[p],s,a,r),i.push(l.geometry.coordinates),h(i)):(i.push(o[p]),h(i));if(c>=e&&i.push(o[p]),p===o.length-1)return h(i);c+=ye(o[p],o[p+1],r)}if(c<e&&o.length===u)throw new Error("Start position is beyond line");var d=o[o.length-1];return h([d,d])}function Rr(t,e,n){void 0===n&&(n={});for(var r=J(t),o=$(e),i=0;i<o.length-1;i++){var s=!1;if(n.ignoreEndVertices&&(0===i&&(s="start"),i===o.length-2&&(s="end"),0===i&&i+1===o.length-1&&(s="both")),Pr(o[i],o[i+1],r,s,void 0===n.epsilon?null:n.epsilon))return!0}return!1}function Pr(t,e,n,r,o){var i=n[0],s=n[1],a=t[0],l=t[1],u=e[0],c=e[1],p=u-a,h=c-l,d=(n[0]-a)*h-(n[1]-l)*p;if(null!==o){if(Math.abs(d)>o)return!1}else if(0!==d)return!1;return r?"start"===r?Math.abs(p)>=Math.abs(h)?p>0?a<i&&i<=u:u<=i&&i<a:h>0?l<s&&s<=c:c<=s&&s<l:"end"===r?Math.abs(p)>=Math.abs(h)?p>0?a<=i&&i<u:u<i&&i<=a:h>0?l<=s&&s<c:c<s&&s<=l:"both"===r&&(Math.abs(p)>=Math.abs(h)?p>0?a<i&&i<u:u<i&&i<a:h>0?l<s&&s<c:c<s&&s<l):Math.abs(p)>=Math.abs(h)?p>0?a<=i&&i<=u:u<=i&&i<=a:h>0?l<=s&&s<=c:c<=s&&s<=l}function Or(t,e){var n=ot(t),r=ot(e),o=n.type,i=r.type;switch(o){case"Point":switch(i){case"MultiPoint":return function(t,e){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(Ar(e.coordinates[n],t.coordinates)){r=!0;break}return r}(n,r);case"LineString":return Rr(n,r,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return fe(n,r,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,o=0;o<e.coordinates.length;o++)Ar(t.coordinates[n],e.coordinates[o])&&(r=!0);if(!r)return!1}return!0}(n,r);case"LineString":return function(t,e){for(var n=!1,r=0;r<t.coordinates.length;r++){if(!Rr(t.coordinates[r],e))return!1;n||(n=Rr(t.coordinates[r],e,{ignoreEndVertices:!0}))}return n}(n,r);case"Polygon":case"MultiPolygon":return function(t,e){for(var n=!0,r=!1,o=0;o<t.coordinates.length;o++){if(!(r=fe(t.coordinates[1],e))){n=!1;break}r=fe(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&r}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!Rr(t.coordinates[n],e))return!1;return!0}(n,r);case"Polygon":case"MultiPolygon":return function(t,e){if(!Ir(Q(e),Q(t)))return!1;for(var n=!1,r=0;r<t.coordinates.length-1;r++){if(!fe(t.coordinates[r],e))return!1;n||(n=fe(t.coordinates[r],e,{ignoreBoundary:!0})),n||(n=fe(Dr(t.coordinates[r],t.coordinates[r+1]),e,{ignoreBoundary:!0}))}return n}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":case"MultiPolygon":return function(t,e){var n=Q(t);if(!Ir(Q(e),n))return!1;for(var r=0;r<t.coordinates[0].length;r++)if(!fe(t.coordinates[0][r],e))return!1;return!0}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+o+" geometry not supported")}}function Ir(t,e){return!(t[0]>e[0])&&!(t[2]<e[2])&&!(t[1]>e[1])&&!(t[3]<e[3])}function Ar(t,e){return t[0]===e[0]&&t[1]===e[1]}function Dr(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function Mr(t,e,n){void 0===n&&(n={}),n.mask&&!n.units&&(n.units="kilometers");for(var r=[],o=t[0],i=t[1],s=t[2],a=t[3],u=e/ye([o,i],[s,i],n)*(s-o),c=e/ye([o,i],[o,a],n)*(a-i),p=s-o,h=a-i,d=Math.floor(p/u),g=(h-Math.floor(h/c)*c)/2,m=o+(p-d*u)/2;m<=s;){for(var y=i+g;y<=a;){var v=l([m,y],n.properties);n.mask?Or(v,n.mask)&&r.push(v):r.push(v),y+=c}m+=u}return f(r)}function Lr(t,e){void 0===e&&(e={});var n=e.precision,r=e.coordinates,o=e.mutate;if(n=null==n||isNaN(n)?6:n,r=null==r||isNaN(r)?3:r,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof r)throw new Error("<coordinates> must be a number");!1!==o&&void 0!==o||(t=JSON.parse(JSON.stringify(t)));var i=Math.pow(10,n);return M(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var r=0;r<t.length;r++)t[r]=Math.round(t[r]*e)/e}(t,i,r)})),t}function Nr(t){if(!t)throw new Error("geojson is required");var e=[];return j(t,(function(t){e.push(t)})),f(e)}function Fr(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Fr(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function kr(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],r=0;r<e;r++){var o=t.geometry.coordinates[r];jr(o[0],o[o.length-1])||o.push(o[0]),n.push.apply(n,o.slice(0,o.length-1))}if(!function(t){for(var e={},n=1,r=0,o=t.length;r<o;++r){if(Object.prototype.hasOwnProperty.call(e,t[r])){n=0;break}e[t[r]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var i=n.length,s=function(t,e,n){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var r=t.geometry.coordinates,o=[],i={};if(n){for(var s=[],a=0;a<r.length;a++)for(var l=0;l<r[a].length-1;l++)s.push(g(a,l));var u=Et();u.load(s)}for(var c=0;c<r.length;c++)for(var p=0;p<r[c].length-1;p++)if(n)u.search(g(c,p)).forEach((function(t){var e=t.ring,n=t.edge;f(c,p,e,n)}));else for(var h=0;h<r.length;h++)for(var d=0;d<r[h].length-1;d++)f(c,p,h,d);return e||(o={type:"Feature",geometry:{type:"MultiPoint",coordinates:o}}),o;function f(t,n,s,a){var l,u,c=r[t][n],p=r[t][n+1],h=r[s][a],d=r[s][a+1],f=function(t,e,n,r){if(Fr(t,n)||Fr(t,r)||Fr(e,n)||Fr(r,n))return null;var o=t[0],i=t[1],s=e[0],a=e[1],l=n[0],u=n[1],c=r[0],p=r[1],h=(o-s)*(u-p)-(i-a)*(l-c);return 0===h?null:[((o*a-i*s)*(l-c)-(o-s)*(l*p-u*c))/h,((o*a-i*s)*(u-p)-(i-a)*(l*p-u*c))/h]}(c,p,h,d);if(null!==f&&(l=p[0]!==c[0]?(f[0]-c[0])/(p[0]-c[0]):(f[1]-c[1])/(p[1]-c[1]),u=d[0]!==h[0]?(f[0]-h[0])/(d[0]-h[0]):(f[1]-h[1])/(d[1]-h[1]),!(l>=1||l<=0||u>=1||u<=0))){var g=f,m=!i[g];m&&(i[g]=!0),e?o.push(e(f,t,n,c,p,l,s,a,h,d,u,m)):o.push(f)}}function g(t,e){var n,o,i,s,a=r[t][e],l=r[t][e+1];return a[0]<l[0]?(n=a[0],o=l[0]):(n=l[0],o=a[0]),a[1]<l[1]?(i=a[1],s=l[1]):(i=l[1],s=a[1]),{minX:n,minY:i,maxX:o,maxY:s,ring:t,edge:e}}}(t,(function(t,e,n,r,o,i,s,a,l,u,c,p){return[t,e,n,r,o,i,s,a,l,u,c,p]})),a=s.length;if(0==a){var l=[];for(r=0;r<e;r++)l.push(c([t.geometry.coordinates[r]],{parent:-1,winding:zr(t.geometry.coordinates[r])}));var u=f(l);return G(),B(),u}var p=[],h=[];for(r=0;r<e;r++){p.push([]);for(var d=0;d<t.geometry.coordinates[r].length-1;d++)p[r].push([new Gr(t.geometry.coordinates[r][Hr(d+1,t.geometry.coordinates[r].length-1)],1,[r,d],[r,Hr(d+1,t.geometry.coordinates[r].length-1)],void 0)]),h.push(new Br(t.geometry.coordinates[r][d],[r,Hr(d-1,t.geometry.coordinates[r].length-1)],[r,d],void 0,void 0,!1,!0))}for(r=0;r<a;r++)p[s[r][1]][s[r][2]].push(new Gr(s[r][0],s[r][5],[s[r][1],s[r][2]],[s[r][6],s[r][7]],void 0)),s[r][11]&&h.push(new Br(s[r][0],[s[r][1],s[r][2]],[s[r][6],s[r][7]],void 0,void 0,!0,!0));var g=h.length;for(r=0;r<p.length;r++)for(d=0;d<p[r].length;d++)p[r][d].sort((function(t,e){return t.param<e.param?-1:1}));var m=[];for(r=0;r<g;r++)m.push({minX:h[r].coord[0],minY:h[r].coord[1],maxX:h[r].coord[0],maxY:h[r].coord[1],index:r});var y=Et();for(y.load(m),r=0;r<p.length;r++)for(d=0;d<p[r].length;d++)for(var v=0;v<p[r][d].length;v++){w=v==p[r][d].length-1?p[r][Hr(d+1,t.geometry.coordinates[r].length-1)][0].coord:p[r][d][v+1].coord;var _=y.search({minX:w[0],minY:w[1],maxX:w[0],maxY:w[1]})[0];p[r][d][v].nxtIsectAlongEdgeIn=_.index}for(r=0;r<p.length;r++)for(d=0;d<p[r].length;d++)for(v=0;v<p[r][d].length;v++){var w=p[r][d][v].coord,C=(_=y.search({minX:w[0],minY:w[1],maxX:w[0],maxY:w[1]})[0]).index;C<i?h[C].nxtIsectAlongRingAndEdge2=p[r][d][v].nxtIsectAlongEdgeIn:jr(h[C].ringAndEdge1,p[r][d][v].ringAndEdgeIn)?h[C].nxtIsectAlongRingAndEdge1=p[r][d][v].nxtIsectAlongEdgeIn:h[C].nxtIsectAlongRingAndEdge2=p[r][d][v].nxtIsectAlongEdgeIn}var b=[];for(r=0,d=0;d<e;d++){var x=r;for(v=0;v<t.geometry.coordinates[d].length-1;v++)h[r].coord[0]<h[x].coord[0]&&(x=r),r++;var E=h[x].nxtIsectAlongRingAndEdge2;for(v=0;v<h.length;v++)if(h[v].nxtIsectAlongRingAndEdge1==x||h[v].nxtIsectAlongRingAndEdge2==x){var S=v;break}var T=Vr([h[S].coord,h[x].coord,h[E].coord],!0)?1:-1;b.push({isect:x,parent:-1,winding:T})}for(b.sort((function(t,e){return h[t.isect].coord>h[e.isect].coord?-1:1})),l=[];b.length>0;){var R=b.pop(),P=R.isect,O=R.parent,I=R.winding,A=l.length,D=[h[P].coord],M=P;if(h[P].ringAndEdge1Walkable)var L=h[P].ringAndEdge1,N=h[P].nxtIsectAlongRingAndEdge1;else L=h[P].ringAndEdge2,N=h[P].nxtIsectAlongRingAndEdge2;for(;!jr(h[P].coord,h[N].coord);){D.push(h[N].coord);var F=void 0;for(r=0;r<b.length;r++)if(b[r].isect==N){F=r;break}if(null!=F&&b.splice(F,1),jr(L,h[N].ringAndEdge1)){if(L=h[N].ringAndEdge2,h[N].ringAndEdge2Walkable=!1,h[N].ringAndEdge1Walkable){var k={isect:N};Vr([h[M].coord,h[N].coord,h[h[N].nxtIsectAlongRingAndEdge2].coord],1==I)?(k.parent=O,k.winding=-I):(k.parent=A,k.winding=I),b.push(k)}M=N,N=h[N].nxtIsectAlongRingAndEdge2}else L=h[N].ringAndEdge1,h[N].ringAndEdge1Walkable=!1,h[N].ringAndEdge2Walkable&&(k={isect:N},Vr([h[M].coord,h[N].coord,h[h[N].nxtIsectAlongRingAndEdge1].coord],1==I)?(k.parent=O,k.winding=-I):(k.parent=A,k.winding=I),b.push(k)),M=N,N=h[N].nxtIsectAlongRingAndEdge1}D.push(h[N].coord),l.push(c([D],{index:A,parent:O,winding:I,netWinding:void 0}))}function G(){for(var t=[],e=0;e<u.features.length;e++)-1==u.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,r=0;r<u.features.length;r++)t[e]!=r&&fe(u.features[t[e]].geometry.coordinates[0][0],u.features[r],{ignoreBoundary:!0})&&Cr(u.features[r])<1/0&&(n=r);u.features[t[e]].properties.parent=n}}function B(){for(var t=0;t<u.features.length;t++)if(-1==u.features[t].properties.parent){var e=u.features[t].properties.winding;u.features[t].properties.netWinding=e,V(t,e)}}function V(t,e){for(var n=0;n<u.features.length;n++)if(u.features[n].properties.parent==t){var r=e+u.features[n].properties.winding;u.features[n].properties.netWinding=r,V(n,r)}}return u=f(l),G(),B(),u}ur.default=cr;var Gr=function(t,e,n,r,o){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=o},Br=function(t,e,n,r,o,i,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=o,this.ringAndEdge1Walkable=i,this.ringAndEdge2Walkable=s};function Vr(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function zr(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(Vr([t[Hr(e-1,t.length-1)],t[e],t[Hr(e+1,t.length-1)]],!0))var r=1;else r=-1;return r}function jr(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!jr(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function Hr(t,e){return(t%e+e)%e}var Ur=Math.PI/180,Wr=180/Math.PI,qr=function(t,e){this.lon=t,this.lat=e,this.x=Ur*t,this.y=Ur*e};qr.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},qr.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new qr(e,t)};var Xr=function(){this.coords=[],this.length=0};Xr.prototype.move_to=function(t){this.length++,this.coords.push(t)};var Kr=function(t){this.properties=t||{},this.geometries=[]};Kr.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},Kr.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var Yr=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new qr(t.x,t.y),this.end=new qr(e.x,e.y),this.properties=n||{};var r=this.start.x-this.end.x,o=this.start.y-this.end.y,i=Math.pow(Math.sin(o/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(i)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};function Zr(t,e){var n=[],r=ur();return j(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var o=r.search(e);if(o.features.length){var i=Jr(e,o);n=n.filter((function(t){return t.id!==i.id})),r.remove(i),k(Qr(i,e),(function(t){n.push(t),r.insert(t)}))}}else(n=Qr(t,e).features).forEach((function(t){t.bbox||(t.bbox=sn(Q(t)))})),r.load(f(n))})),f(n)}function Qr(t,e){var n=[],r=$(t)[0],o=$(t)[t.geometry.coordinates.length-1];if($r(r,J(e))||$r(o,J(e)))return f([t]);var i=ur(),s=Vn(t);i.load(s);var a=i.search(e);if(!a.features.length)return f([t]);var l=Jr(e,a),u=G(s,(function(t,r,o){var i=$(r)[1],s=J(e);return o===l.id?(t.push(s),n.push(h(t)),$r(s,i)?[s]:[s,i]):(t.push(i),t)}),[r]);return u.length>1&&n.push(h(u)),f(n)}function Jr(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,r=1/0;return k(e,(function(e){var o=dr(e,t).properties.dist;o<r&&(n=e,r=o)})),n}function $r(t,e){return t[0]===e[0]&&t[1]===e[1]}function to(t,e,n,r,o){void 0===o&&(o={});var i=o.steps||64,s=eo(n),a=eo(r),l=Array.isArray(t)||"Feature"!==t.type?{}:t.properties;if(s===a)return h(ln(t,e,o).geometry.coordinates[0],l);for(var u=s,c=s<a?a:a+360,p=u,d=[],f=0;p<c;)d.push(an(t,e,p,o).geometry.coordinates),p=u+360*++f/i;return p>c&&d.push(an(t,e,c,o).geometry.coordinates),h(d,l)}function eo(t){var e=t%360;return e<0&&(e+=360),e}function no(t,e){void 0===e&&(e={});var n=ot(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return ro(n,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var n=ot(t).coordinates,r=e.properties?e.properties:"Feature"===t.type?t.properties:{},o=[];return n.forEach((function(t){o.push(oo(t,r))})),f(o)}(n,e);default:throw new Error("invalid poly")}}function ro(t,e){return void 0===e&&(e={}),oo(ot(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function oo(t,e){return t.length>1?g(t,e):h(t[0],e)}function io(t,e){var n,r,o;void 0===e&&(e={});var i=e.properties,s=null===(n=e.autoComplete)||void 0===n||n,a=null===(r=e.orderCoords)||void 0===r||r;switch(null!==(o=e.mutate)&&void 0!==o&&o||(t=be(t)),t.type){case"FeatureCollection":var l=[];return t.features.forEach((function(t){l.push($(so(t,{},s,a)))})),y(l,i);default:return so(t,i,s,a)}}function so(t,e,n,r){e=e||("Feature"===t.type?t.properties:{});var o=ot(t),i=o.coordinates,s=o.type;if(!i.length)throw new Error("line must contain coordinates");switch(s){case"LineString":return n&&(i=ao(i)),c([i],e);case"MultiLineString":var a=[],l=0;return i.forEach((function(t){if(n&&(t=ao(t)),r){var e=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return Math.abs(e-r)*Math.abs(n-o)}(Q(h(t)));e>l?(a.unshift(t),l=e):a.push(t)}else a.push(t)})),c(a,e);default:throw new Error("geometry type "+s+" is not supported")}}function ao(t){var e=t[0],n=e[0],r=e[1],o=t[t.length-1],i=o[0],s=o[1];return n===i&&r===s||t.push(e),t}function lo(t,e){var n,r,o,i,s,a,l;for(r=1;r<=8;r*=2){for(n=[],i=!(co(o=t[t.length-1],e)&r),s=0;s<t.length;s++)(l=!(co(a=t[s],e)&r))!==i&&n.push(uo(o,a,r,e)),l&&n.push(a),o=a,i=l;if(!(t=n).length)break}return n}function uo(t,e,n,r){return 8&n?[t[0]+(e[0]-t[0])*(r[3]-t[1])/(e[1]-t[1]),r[3]]:4&n?[t[0]+(e[0]-t[0])*(r[1]-t[1])/(e[1]-t[1]),r[1]]:2&n?[r[2],t[1]+(e[1]-t[1])*(r[2]-t[0])/(e[0]-t[0])]:1&n?[r[0],t[1]+(e[1]-t[1])*(r[0]-t[0])/(e[0]-t[0])]:null}function co(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function po(t,e){for(var n=[],r=0,o=t;r<o.length;r++){var i=lo(o[r],e);i.length>0&&(i[0][0]===i[i.length-1][0]&&i[0][1]===i[i.length-1][1]||i.push(i[0]),i.length>=4&&n.push(i))}return n}Yr.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),o=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),i=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=Wr*Math.atan2(i,Math.sqrt(Math.pow(r,2)+Math.pow(o,2)));return[Wr*Math.atan2(o,r),s]},Yr.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(t-1),o=0;o<t;++o){var i=r*o,s=this.interpolate(i);n.push(s)}for(var a=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,p=-180+u,h=360-u,d=1;d<n.length;++d){var f=n[d-1][0],g=n[d][0],m=Math.abs(g-f);m>h&&(g>c&&f<p||f>c&&g<p)?a=!0:m>l&&(l=m)}var y=[];if(a&&l<u){var v=[];y.push(v);for(var _=0;_<n.length;++_){var w=parseFloat(n[_][0]);if(_>0&&Math.abs(w-n[_-1][0])>h){var C=parseFloat(n[_-1][0]),b=parseFloat(n[_-1][1]),x=parseFloat(n[_][0]),E=parseFloat(n[_][1]);if(C>-180&&C<p&&180===x&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<p){v.push([-180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(C>c&&C<180&&-180===x&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){v.push([180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(C<p&&x>c){var S=C;C=x,x=S;var T=b;b=E,E=T}if(C>c&&x<p&&(x+=360),C<=180&&x>=180&&C<x){var R=(180-C)/(x-C),P=R*E+(1-R)*b;v.push([n[_-1][0]>c?180:-180,P]),(v=[]).push([n[_-1][0]>c?-180:180,P]),y.push(v)}else v=[],y.push(v);v.push([w,n[_][1]])}else v.push([n[_][0],n[_][1]])}}else{var O=[];y.push(O);for(var I=0;I<n.length;++I)O.push([n[I][0],n[I][1]])}for(var A=new Kr(this.properties),D=0;D<y.length;++D){var M=new Xr;A.geometries.push(M);for(var L=y[D],N=0;N<L.length;++N)M.move_to(L[N])}return A};var ho=Bt((function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n})),fo=Bt((function(t,e){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=n?r:o).supported=r,e.unsupported=o})),go=Bt((function(t){var e=Array.prototype.slice,n=t.exports=function(t,i,s){return s||(s={}),t===i||(t instanceof Date&&i instanceof Date?t.getTime()===i.getTime():!t||!i||"object"!=typeof t&&"object"!=typeof i?s.strict?t===i:t==i:function(t,i,s){var a,l;if(r(t)||r(i))return!1;if(t.prototype!==i.prototype)return!1;if(fo(t))return!!fo(i)&&(t=e.call(t),i=e.call(i),n(t,i,s));if(o(t)){if(!o(i))return!1;if(t.length!==i.length)return!1;for(a=0;a<t.length;a++)if(t[a]!==i[a])return!1;return!0}try{var u=ho(t),c=ho(i)}catch(t){return!1}if(u.length!=c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!=c[a])return!1;for(a=u.length-1;a>=0;a--)if(l=u[a],!n(t[l],i[l],s))return!1;return typeof t==typeof i}(t,i,s))};function r(t){return null==t}function o(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&"function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0])}}));function mo(t,e,n){if(void 0===n&&(n={}),!O(n=n||{}))throw new Error("options is invalid");var r,o=n.tolerance||0,i=[],s=ur(),a=Vn(t);return s.load(a),U(e,(function(t){var e=!1;t&&(k(s.search(t),(function(n){if(!1===e){var i=$(t).sort(),s=$(n).sort();go(i,s)||(0===o?Rr(i[0],n)&&Rr(i[1],n):dr(n,i[0]).properties.dist<=o&&dr(n,i[1]).properties.dist<=o)?(e=!0,r=r?yo(r,t):t):(0===o?Rr(s[0],t)&&Rr(s[1],t):dr(t,s[0]).properties.dist<=o&&dr(t,s[1]).properties.dist<=o)&&(r=r?yo(r,n):n)}})),!1===e&&r&&(i.push(r),r=void 0))})),r&&i.push(r),f(i)}function yo(t,e){var n=$(e),r=$(t),o=r[0],i=r[r.length-1],s=t.geometry.coordinates;return go(n[0],o)?s.unshift(n[1]):go(n[0],i)?s.push(n[1]):go(n[1],o)?s.unshift(n[0]):go(n[1],i)&&s.push(n[0]),t}function vo(t){var e=t%360;return e<0&&(e+=360),e}function _o(t,e,n){var r;return void 0===n&&(n={}),(r=n.final?wo(J(e),J(t)):wo(J(t),J(e)))>180?-(360-r):r}function wo(t,e){var n=S(t[1]),r=S(e[1]),o=S(e[0]-t[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var i=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(E(Math.atan2(o,i))+360)%360}function Co(t,e,r,o){void 0===o&&(o={});var i=e<0,s=T(Math.abs(e),o.units,"meters");i&&(s=-Math.abs(s));var a=J(t),u=function(t,e,r,o){var i=e/(o=void 0===o?n:Number(o)),s=t[0]*Math.PI/180,a=S(t[1]),l=S(r),u=i*Math.cos(l),c=a+u;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var p=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),h=Math.abs(p)>1e-11?u/p:Math.cos(a);return[(180*(s+i*Math.sin(l)/h)/Math.PI+540)%360-180,180*c/Math.PI]}(a,s,r);return u[0]+=u[0]-a[0]>180?-360:a[0]-u[0]>180?360:0,l(u,o.properties)}function bo(t,e,n,r,o,i){for(var s=0;s<t.length;s++){var a=t[s],l=t[s+1];s===t.length-1&&(l=t[0]),r=Eo(a,l,e),n<=0&&r>0?Eo(e,a,o)<0||(o=a):n>0&&r<=0&&(xo(e,a,i)||(i=a)),n=r}return[o,i]}function xo(t,e,n){return Eo(t,e,n)>0}function Eo(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function So(t){for(var e,n,r=$(t),o=0,i=1;i<r.length;)e=n||r[0],o+=((n=r[i])[0]-e[0])*(n[1]+e[1]),i++;return o>0}function To(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return V(t,(function(t){To(t,e)})),t;case"LineString":return Ro($(t),e),t;case"Polygon":return Po($(t),e),t;case"MultiLineString":return $(t).forEach((function(t){Ro(t,e)})),t;case"MultiPolygon":return $(t).forEach((function(t){Po(t,e)})),t;case"Point":case"MultiPoint":return t}}function Ro(t,e){So(t)===e&&t.reverse()}function Po(t,e){So(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)So(t[n])===e&&t[n].reverse()}var Oo={successCallback:null,verbose:!1,polygons:!1},Io={};function Ao(t,e,n,r){r=r||{};for(var o=Object.keys(Oo),i=0;i<o.length;i++){var s=o[i],a=r[s];a=null!=a?a:Oo[s],Io[s]=a}Io.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var l,u=function(t,e,n){for(var r=t.length-1,o=t[0].length-1,i={rows:r,cols:o,cells:[]},s=e+Math.abs(n),a=0;a<r;++a){i.cells[a]=[];for(var l=0;l<o;++l){var u=0,c=t[a+1][l],p=t[a+1][l+1],h=t[a][l+1],d=t[a][l];if(!(isNaN(c)||isNaN(p)||isNaN(h)||isNaN(d))){u|=c<e?0:c>s?128:64,u|=p<e?0:p>s?32:16,u|=h<e?0:h>s?8:4;var f=+(u|=d<e?0:d>s?2:1),g=0;if(17===u||18===u||33===u||34===u||38===u||68===u||72===u||98===u||102===u||132===u||136===u||137===u||152===u||153===u){var m=(c+p+h+d)/4;g=m>s?2:m<e?0:1,34===u?1===g?u=35:0===g&&(u=136):136===u?1===g?(u=35,g=4):0===g&&(u=34):17===u?1===g?(u=155,g=4):0===g&&(u=153):68===u?1===g?(u=103,g=4):0===g&&(u=102):153===u?1===g&&(u=155):102===u?1===g&&(u=103):152===u?g<2&&(u=156,g=1):137===u?g<2&&(u=139,g=1):98===u?g<2&&(u=99,g=1):38===u?g<2&&(u=39,g=1):18===u?g>0?(u=156,g=4):u=152:33===u?g>0?(u=139,g=4):u=137:72===u?g>0?(u=99,g=4):u=98:132===u&&(g>0?(u=39,g=4):u=38)}if(0!=u&&170!=u){var y,v,_,w,C,b,x,E;y=v=_=w=C=b=x=E=.5;var S=[];1===u?(_=1-_i(e,h,d),E=1-_i(e,c,d),S.push(di[u])):169===u?(_=_i(s,d,h),E=_i(s,d,c),S.push(di[u])):4===u?(b=1-_i(e,p,h),w=_i(e,d,h),S.push(pi[u])):166===u?(b=_i(s,h,p),w=1-_i(s,h,d),S.push(pi[u])):16===u?(C=_i(e,h,p),v=_i(e,c,p),S.push(ci[u])):154===u?(C=1-_i(s,p,h),v=1-_i(s,p,c),S.push(ci[u])):64===u?(x=_i(e,d,c),y=1-_i(e,p,c),S.push(gi[u])):106===u?(x=1-_i(s,c,d),y=_i(s,c,p),S.push(gi[u])):168===u?(w=_i(s,d,h),_=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),S.push(hi[u]),S.push(di[u])):2===u?(w=1-_i(e,h,d),_=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),S.push(hi[u]),S.push(di[u])):162===u?(C=_i(s,h,p),b=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),S.push(hi[u]),S.push(di[u])):8===u?(C=1-_i(e,p,h),b=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),S.push(ci[u]),S.push(pi[u])):138===u?(C=1-_i(e,p,h),b=1-_i(s,p,h),y=1-_i(s,p,c),v=1-_i(e,p,c),S.push(ci[u]),S.push(pi[u])):32===u?(C=_i(s,h,p),b=_i(e,h,p),y=_i(e,c,p),v=_i(s,c,p),S.push(ci[u]),S.push(pi[u])):42===u?(E=1-_i(s,c,d),x=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p),S.push(fi[u]),S.push(gi[u])):128===u&&(E=_i(e,d,c),x=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c),S.push(fi[u]),S.push(gi[u])),5===u?(b=1-_i(e,p,h),E=1-_i(e,c,d),S.push(pi[u])):165===u?(b=_i(s,h,p),E=_i(s,d,c),S.push(pi[u])):20===u?(w=_i(e,d,h),v=_i(e,c,p),S.push(hi[u])):150===u?(w=1-_i(s,h,d),v=1-_i(s,p,c),S.push(hi[u])):80===u?(C=_i(e,h,p),x=_i(e,d,c),S.push(ci[u])):90===u?(C=1-_i(s,p,h),x=1-_i(s,c,d),S.push(ci[u])):65===u?(_=1-_i(e,h,d),y=1-_i(e,p,c),S.push(di[u])):105===u?(_=_i(s,d,h),y=_i(s,c,p),S.push(di[u])):160===u?(C=_i(s,h,p),b=_i(e,h,p),E=_i(e,d,c),x=_i(s,d,c),S.push(ci[u]),S.push(pi[u])):10===u?(C=1-_i(e,p,h),b=1-_i(s,p,h),E=1-_i(s,c,d),x=1-_i(e,c,d),S.push(ci[u]),S.push(pi[u])):130===u?(w=1-_i(e,h,d),_=1-_i(s,h,d),y=1-_i(s,p,c),v=1-_i(e,p,c),S.push(hi[u]),S.push(di[u])):40===u?(w=_i(s,d,h),_=_i(e,d,h),y=_i(e,c,p),v=_i(s,c,p),S.push(hi[u]),S.push(di[u])):101===u?(b=_i(s,h,p),y=_i(s,c,p),S.push(pi[u])):69===u?(b=1-_i(e,p,h),y=1-_i(e,p,c),S.push(pi[u])):149===u?(E=_i(s,d,c),v=1-_i(s,p,c),S.push(fi[u])):21===u?(E=1-_i(e,c,d),v=_i(e,c,p),S.push(fi[u])):86===u?(w=1-_i(s,h,d),x=1-_i(s,c,d),S.push(hi[u])):84===u?(w=_i(e,d,h),x=_i(e,d,c),S.push(hi[u])):89===u?(C=1-_i(s,p,h),_=_i(s,d,h),S.push(di[u])):81===u?(C=_i(e,h,p),_=1-_i(e,h,d),S.push(di[u])):96===u?(C=_i(s,h,p),b=_i(e,h,p),x=_i(e,d,c),y=_i(s,c,p),S.push(ci[u]),S.push(pi[u])):74===u?(C=1-_i(e,p,h),b=1-_i(s,p,h),x=1-_i(s,c,d),y=1-_i(e,p,c),S.push(ci[u]),S.push(pi[u])):24===u?(C=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),v=_i(e,c,p),S.push(ci[u]),S.push(di[u])):146===u?(C=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),v=1-_i(s,p,c),S.push(ci[u]),S.push(di[u])):6===u?(b=1-_i(e,p,h),w=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),S.push(pi[u]),S.push(hi[u])):164===u?(b=_i(s,h,p),w=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),S.push(pi[u]),S.push(hi[u])):129===u?(_=1-_i(e,h,d),E=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c),S.push(di[u]),S.push(fi[u])):41===u?(_=_i(s,d,h),E=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p),S.push(di[u]),S.push(fi[u])):66===u?(w=1-_i(e,h,d),_=1-_i(s,h,d),x=1-_i(s,c,d),y=1-_i(e,p,c),S.push(hi[u]),S.push(di[u])):104===u?(w=_i(s,d,h),_=_i(e,d,h),x=_i(e,d,c),y=_i(s,c,p),S.push(di[u]),S.push(mi[u])):144===u?(C=_i(e,h,p),E=_i(e,d,c),x=_i(s,d,c),v=1-_i(s,p,c),S.push(ci[u]),S.push(gi[u])):26===u?(C=1-_i(s,p,h),E=1-_i(s,c,d),x=1-_i(e,c,d),v=_i(e,c,p),S.push(ci[u]),S.push(gi[u])):36===u?(b=_i(s,h,p),w=_i(e,d,h),y=_i(e,c,p),v=_i(s,c,p),S.push(pi[u]),S.push(hi[u])):134===u?(b=1-_i(e,p,h),w=1-_i(s,h,d),y=1-_i(s,p,c),v=1-_i(e,p,c),S.push(pi[u]),S.push(hi[u])):9===u?(C=1-_i(e,p,h),b=1-_i(s,p,h),_=_i(s,d,h),E=1-_i(e,c,d),S.push(ci[u]),S.push(pi[u])):161===u?(C=_i(s,h,p),b=_i(e,h,p),_=1-_i(e,h,d),E=_i(s,d,c),S.push(ci[u]),S.push(pi[u])):37===u?(b=_i(s,h,p),E=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p),S.push(pi[u]),S.push(fi[u])):133===u?(b=1-_i(e,p,h),E=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c),S.push(pi[u]),S.push(fi[u])):148===u?(w=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),v=1-_i(s,p,c),S.push(hi[u]),S.push(gi[u])):22===u?(w=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),v=_i(e,c,p),S.push(hi[u]),S.push(gi[u])):82===u?(C=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),x=1-_i(s,c,d),S.push(ci[u]),S.push(di[u])):88===u?(C=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),x=_i(e,d,c),S.push(ci[u]),S.push(di[u])):73===u?(C=1-_i(e,p,h),b=1-_i(s,p,h),_=_i(s,d,h),y=1-_i(e,p,c),S.push(ci[u]),S.push(pi[u])):97===u?(C=_i(s,h,p),b=_i(e,h,p),_=1-_i(e,h,d),y=_i(s,c,p),S.push(ci[u]),S.push(pi[u])):145===u?(C=_i(e,h,p),_=1-_i(e,h,d),E=_i(s,d,c),v=1-_i(s,p,c),S.push(ci[u]),S.push(fi[u])):25===u?(C=1-_i(s,p,h),_=_i(s,d,h),E=1-_i(e,c,d),v=_i(e,c,p),S.push(ci[u]),S.push(fi[u])):70===u?(b=1-_i(e,p,h),w=1-_i(s,h,d),x=1-_i(s,c,d),y=1-_i(e,p,c),S.push(pi[u]),S.push(hi[u])):100===u?(b=_i(s,h,p),w=_i(e,d,h),x=_i(e,d,c),y=_i(s,c,p),S.push(pi[u]),S.push(hi[u])):34===u?(0===g?(C=1-_i(e,p,h),b=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)):(C=_i(s,h,p),b=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)),S.push(ci[u]),S.push(pi[u]),S.push(fi[u]),S.push(gi[u])):35===u?(4===g?(C=1-_i(e,p,h),b=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)):(C=_i(s,h,p),b=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)),S.push(ci[u]),S.push(pi[u]),S.push(di[u]),S.push(gi[u])):136===u?(0===g?(C=_i(s,h,p),b=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)):(C=1-_i(e,p,h),b=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)),S.push(ci[u]),S.push(pi[u]),S.push(fi[u]),S.push(gi[u])):153===u?(0===g?(C=_i(e,h,p),_=1-_i(e,h,d),E=1-_i(e,c,d),v=_i(e,c,p)):(C=1-_i(s,p,h),_=_i(s,d,h),E=_i(s,d,c),v=1-_i(s,p,c)),S.push(ci[u]),S.push(di[u])):102===u?(0===g?(b=1-_i(e,p,h),w=_i(e,d,h),x=_i(e,d,c),y=1-_i(e,p,c)):(b=_i(s,h,p),w=1-_i(s,h,d),x=1-_i(s,c,d),y=_i(s,c,p)),S.push(pi[u]),S.push(gi[u])):155===u?(4===g?(C=_i(e,h,p),_=1-_i(e,h,d),E=1-_i(e,c,d),v=_i(e,c,p)):(C=1-_i(s,p,h),_=_i(s,d,h),E=_i(s,d,c),v=1-_i(s,p,c)),S.push(ci[u]),S.push(fi[u])):103===u?(4===g?(b=1-_i(e,p,h),w=_i(e,d,h),x=_i(e,d,c),y=1-_i(e,p,c)):(b=_i(s,h,p),w=1-_i(s,h,d),x=1-_i(s,c,d),y=_i(s,c,p)),S.push(pi[u]),S.push(hi[u])):152===u?(0===g?(C=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),v=_i(e,c,p)):(C=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),v=1-_i(s,p,c)),S.push(ci[u]),S.push(hi[u]),S.push(di[u])):156===u?(4===g?(C=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),v=_i(e,c,p)):(C=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),v=1-_i(s,p,c)),S.push(ci[u]),S.push(di[u]),S.push(gi[u])):137===u?(0===g?(C=_i(s,h,p),b=_i(e,h,p),_=1-_i(e,h,d),E=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)):(C=1-_i(e,p,h),b=1-_i(s,p,h),_=_i(s,d,h),E=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)),S.push(ci[u]),S.push(pi[u]),S.push(di[u])):139===u?(4===g?(C=_i(s,h,p),b=_i(e,h,p),_=1-_i(e,h,d),E=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)):(C=1-_i(e,p,h),b=1-_i(s,p,h),_=_i(s,d,h),E=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)),S.push(ci[u]),S.push(pi[u]),S.push(fi[u])):98===u?(0===g?(C=1-_i(e,p,h),b=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),x=_i(e,d,c),y=1-_i(e,p,c)):(C=_i(s,h,p),b=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),x=1-_i(s,c,d),y=_i(s,c,p)),S.push(ci[u]),S.push(pi[u]),S.push(gi[u])):99===u?(4===g?(C=1-_i(e,p,h),b=1-_i(s,p,h),w=_i(s,d,h),_=_i(e,d,h),x=_i(e,d,c),y=1-_i(e,p,c)):(C=_i(s,h,p),b=_i(e,h,p),w=1-_i(e,h,d),_=1-_i(s,h,d),x=1-_i(s,c,d),y=_i(s,c,p)),S.push(ci[u]),S.push(pi[u]),S.push(di[u])):38===u?(0===g?(b=1-_i(e,p,h),w=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)):(b=_i(s,h,p),w=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)),S.push(pi[u]),S.push(fi[u]),S.push(gi[u])):39===u?(4===g?(b=1-_i(e,p,h),w=_i(e,d,h),E=_i(e,d,c),x=_i(s,d,c),y=1-_i(s,p,c),v=1-_i(e,p,c)):(b=_i(s,h,p),w=1-_i(s,h,d),E=1-_i(s,c,d),x=1-_i(e,c,d),y=_i(e,c,p),v=_i(s,c,p)),S.push(pi[u]),S.push(hi[u]),S.push(gi[u])):85===u&&(C=1,b=0,w=1,_=0,E=0,x=1,y=0,v=1),(y<0||y>1||v<0||v>1||C<0||C>1||w<0||w>1||E<0||E>1||x<0||x>1)&&console.log("MarchingSquaresJS-isoBands: "+u+" "+f+" "+c+","+p+","+h+","+d+" "+g+" "+y+" "+v+" "+C+" "+b+" "+w+" "+_+" "+E+" "+x),i.cells[a][l]={cval:u,cval_real:f,flipped:g,topleft:y,topright:v,righttop:C,rightbottom:b,bottomright:w,bottomleft:_,leftbottom:E,lefttop:x,edges:S}}}}}return i}(t,e,n);return Io.polygons?(Io.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=function(t){var e=[],n=0;return t.cells.forEach((function(t,r){t.forEach((function(t,o){if(void 0!==t){var i=vi[t.cval](t);"object"==typeof i&&wi(i)?"object"==typeof i[0]&&wi(i[0])?"object"==typeof i[0][0]&&wi(i[0][0])?i.forEach((function(t){t.forEach((function(t){t[0]+=o,t[1]+=r})),e[n++]=t})):(i.forEach((function(t){t[0]+=o,t[1]+=r})),e[n++]=i):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}}))})),e}(u)):(Io.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),l=function(t){for(var e=[],n=t.rows,r=t.cols,o=[],i=0;i<n;i++)for(var s=0;s<r;s++)if(void 0!==t.cells[i][s]&&t.cells[i][s].edges.length>0){var a=bi(t.cells[i][s]),l=null,u=s,c=i;null!==a&&o.push([a.p[0]+u,a.p[1]+c]);do{if(null===(l=xi(t.cells[c][u],a.x,a.y,a.o)))break;if(o.push([l.p[0]+u,l.p[1]+c]),u+=l.x,a=l,(c+=l.y)<0||c>=n||u<0||u>=r||void 0===t.cells[c][u]){var p=Ci(t,u-=l.x,c-=l.y,l.x,l.y,l.o);if(null===p)break;p.path.forEach((function(t){o.push(t)})),u=p.i,c=p.j,a=p}}while(void 0!==t.cells[c][u]&&t.cells[c][u].edges.length>0);e.push(o),o=[],t.cells[i][s].edges.length>0&&s--}return e}(u)),"function"==typeof Io.successCallback&&Io.successCallback(l),l}var Do=[],Mo=[],Lo=[],No=[],Fo=[],ko=[],Go=[],Bo=[],Vo=[],zo=[],jo=[],Ho=[],Uo=[],Wo=[],qo=[],Xo=[],Ko=[],Yo=[],Zo=[],Qo=[],Jo=[],$o=[],ti=[],ei=[];Go[85]=zo[85]=-1,Bo[85]=jo[85]=0,Vo[85]=Ho[85]=1,Zo[85]=$o[85]=1,Qo[85]=ti[85]=0,Jo[85]=ei[85]=1,Do[85]=No[85]=0,Mo[85]=Fo[85]=-1,Lo[85]=qo[85]=0,Xo[85]=Uo[85]=0,Ko[85]=Wo[85]=1,ko[85]=Yo[85]=1,$o[1]=$o[169]=0,ti[1]=ti[169]=-1,ei[1]=ei[169]=0,Uo[1]=Uo[169]=-1,Wo[1]=Wo[169]=0,qo[1]=qo[169]=0,zo[4]=zo[166]=0,jo[4]=jo[166]=-1,Ho[4]=Ho[166]=1,Xo[4]=Xo[166]=1,Ko[4]=Ko[166]=0,Yo[4]=Yo[166]=0,Go[16]=Go[154]=0,Bo[16]=Bo[154]=1,Vo[16]=Vo[154]=1,No[16]=No[154]=1,Fo[16]=Fo[154]=0,ko[16]=ko[154]=1,Zo[64]=Zo[106]=0,Qo[64]=Qo[106]=1,Jo[64]=Jo[106]=0,Do[64]=Do[106]=-1,Mo[64]=Mo[106]=0,Lo[64]=Lo[106]=1,Zo[2]=Zo[168]=0,Qo[2]=Qo[168]=-1,Jo[2]=Jo[168]=1,$o[2]=$o[168]=0,ti[2]=ti[168]=-1,ei[2]=ei[168]=0,Uo[2]=Uo[168]=-1,Wo[2]=Wo[168]=0,qo[2]=qo[168]=0,Xo[2]=Xo[168]=-1,Ko[2]=Ko[168]=0,Yo[2]=Yo[168]=1,Go[8]=Go[162]=0,Bo[8]=Bo[162]=-1,Vo[8]=Vo[162]=0,zo[8]=zo[162]=0,jo[8]=jo[162]=-1,Ho[8]=Ho[162]=1,Uo[8]=Uo[162]=1,Wo[8]=Wo[162]=0,qo[8]=qo[162]=1,Xo[8]=Xo[162]=1,Ko[8]=Ko[162]=0,Yo[8]=Yo[162]=0,Go[32]=Go[138]=0,Bo[32]=Bo[138]=1,Vo[32]=Vo[138]=1,zo[32]=zo[138]=0,jo[32]=jo[138]=1,Ho[32]=Ho[138]=0,Do[32]=Do[138]=1,Mo[32]=Mo[138]=0,Lo[32]=Lo[138]=0,No[32]=No[138]=1,Fo[32]=Fo[138]=0,ko[32]=ko[138]=1,$o[128]=$o[42]=0,ti[128]=ti[42]=1,ei[128]=ei[42]=1,Zo[128]=Zo[42]=0,Qo[128]=Qo[42]=1,Jo[128]=Jo[42]=0,Do[128]=Do[42]=-1,Mo[128]=Mo[42]=0,Lo[128]=Lo[42]=1,No[128]=No[42]=-1,Fo[128]=Fo[42]=0,ko[128]=ko[42]=0,zo[5]=zo[165]=-1,jo[5]=jo[165]=0,Ho[5]=Ho[165]=0,$o[5]=$o[165]=1,ti[5]=ti[165]=0,ei[5]=ei[165]=0,Xo[20]=Xo[150]=0,Ko[20]=Ko[150]=1,Yo[20]=Yo[150]=1,No[20]=No[150]=0,Fo[20]=Fo[150]=-1,ko[20]=ko[150]=1,Go[80]=Go[90]=-1,Bo[80]=Bo[90]=0,Vo[80]=Vo[90]=1,Zo[80]=Zo[90]=1,Qo[80]=Qo[90]=0,Jo[80]=Jo[90]=1,Uo[65]=Uo[105]=0,Wo[65]=Wo[105]=1,qo[65]=qo[105]=0,Do[65]=Do[105]=0,Mo[65]=Mo[105]=-1,Lo[65]=Lo[105]=0,Go[160]=Go[10]=-1,Bo[160]=Bo[10]=0,Vo[160]=Vo[10]=1,zo[160]=zo[10]=-1,jo[160]=jo[10]=0,Ho[160]=Ho[10]=0,$o[160]=$o[10]=1,ti[160]=ti[10]=0,ei[160]=ei[10]=0,Zo[160]=Zo[10]=1,Qo[160]=Qo[10]=0,Jo[160]=Jo[10]=1,Xo[130]=Xo[40]=0,Ko[130]=Ko[40]=1,Yo[130]=Yo[40]=1,Uo[130]=Uo[40]=0,Wo[130]=Wo[40]=1,qo[130]=qo[40]=0,Do[130]=Do[40]=0,Mo[130]=Mo[40]=-1,Lo[130]=Lo[40]=0,No[130]=No[40]=0,Fo[130]=Fo[40]=-1,ko[130]=ko[40]=1,zo[37]=zo[133]=0,jo[37]=jo[133]=1,Ho[37]=Ho[133]=1,$o[37]=$o[133]=0,ti[37]=ti[133]=1,ei[37]=ei[133]=0,Do[37]=Do[133]=-1,Mo[37]=Mo[133]=0,Lo[37]=Lo[133]=0,No[37]=No[133]=1,Fo[37]=Fo[133]=0,ko[37]=ko[133]=0,Xo[148]=Xo[22]=-1,Ko[148]=Ko[22]=0,Yo[148]=Yo[22]=0,$o[148]=$o[22]=0,ti[148]=ti[22]=-1,ei[148]=ei[22]=1,Zo[148]=Zo[22]=0,Qo[148]=Qo[22]=1,Jo[148]=Jo[22]=1,No[148]=No[22]=-1,Fo[148]=Fo[22]=0,ko[148]=ko[22]=1,Go[82]=Go[88]=0,Bo[82]=Bo[88]=-1,Vo[82]=Vo[88]=1,Xo[82]=Xo[88]=1,Ko[82]=Ko[88]=0,Yo[82]=Yo[88]=1,Uo[82]=Uo[88]=-1,Wo[82]=Wo[88]=0,qo[82]=qo[88]=1,Zo[82]=Zo[88]=0,Qo[82]=Qo[88]=-1,Jo[82]=Jo[88]=0,Go[73]=Go[97]=0,Bo[73]=Bo[97]=1,Vo[73]=Vo[97]=0,zo[73]=zo[97]=0,jo[73]=jo[97]=-1,Ho[73]=Ho[97]=0,Uo[73]=Uo[97]=1,Wo[73]=Wo[97]=0,qo[73]=qo[97]=0,Do[73]=Do[97]=1,Mo[73]=Mo[97]=0,Lo[73]=Lo[97]=1,Go[145]=Go[25]=0,Bo[145]=Bo[25]=-1,Vo[145]=Vo[25]=0,Uo[145]=Uo[25]=1,Wo[145]=Wo[25]=0,qo[145]=qo[25]=1,$o[145]=$o[25]=0,ti[145]=ti[25]=1,ei[145]=ei[25]=1,No[145]=No[25]=-1,Fo[145]=Fo[25]=0,ko[145]=ko[25]=0,zo[70]=zo[100]=0,jo[70]=jo[100]=1,Ho[70]=Ho[100]=0,Xo[70]=Xo[100]=-1,Ko[70]=Ko[100]=0,Yo[70]=Yo[100]=1,Zo[70]=Zo[100]=0,Qo[70]=Qo[100]=-1,Jo[70]=Jo[100]=1,Do[70]=Do[100]=1,Mo[70]=Mo[100]=0,Lo[70]=Lo[100]=0,zo[101]=zo[69]=0,jo[101]=jo[69]=1,Ho[101]=Ho[69]=0,Do[101]=Do[69]=1,Mo[101]=Mo[69]=0,Lo[101]=Lo[69]=0,$o[149]=$o[21]=0,ti[149]=ti[21]=1,ei[149]=ei[21]=1,No[149]=No[21]=-1,Fo[149]=Fo[21]=0,ko[149]=ko[21]=0,Xo[86]=Xo[84]=-1,Ko[86]=Ko[84]=0,Yo[86]=Yo[84]=1,Zo[86]=Zo[84]=0,Qo[86]=Qo[84]=-1,Jo[86]=Jo[84]=1,Go[89]=Go[81]=0,Bo[89]=Bo[81]=-1,Vo[89]=Vo[81]=0,Uo[89]=Uo[81]=1,Wo[89]=Wo[81]=0,qo[89]=qo[81]=1,Go[96]=Go[74]=0,Bo[96]=Bo[74]=1,Vo[96]=Vo[74]=0,zo[96]=zo[74]=-1,jo[96]=jo[74]=0,Ho[96]=Ho[74]=1,Zo[96]=Zo[74]=1,Qo[96]=Qo[74]=0,Jo[96]=Jo[74]=0,Do[96]=Do[74]=1,Mo[96]=Mo[74]=0,Lo[96]=Lo[74]=1,Go[24]=Go[146]=0,Bo[24]=Bo[146]=-1,Vo[24]=Vo[146]=1,Xo[24]=Xo[146]=1,Ko[24]=Ko[146]=0,Yo[24]=Yo[146]=1,Uo[24]=Uo[146]=0,Wo[24]=Wo[146]=1,qo[24]=qo[146]=1,No[24]=No[146]=0,Fo[24]=Fo[146]=-1,ko[24]=ko[146]=0,zo[6]=zo[164]=-1,jo[6]=jo[164]=0,Ho[6]=Ho[164]=1,Xo[6]=Xo[164]=-1,Ko[6]=Ko[164]=0,Yo[6]=Yo[164]=0,$o[6]=$o[164]=0,ti[6]=ti[164]=-1,ei[6]=ei[164]=1,Zo[6]=Zo[164]=1,Qo[6]=Qo[164]=0,Jo[6]=Jo[164]=0,Uo[129]=Uo[41]=0,Wo[129]=Wo[41]=1,qo[129]=qo[41]=1,$o[129]=$o[41]=0,ti[129]=ti[41]=1,ei[129]=ei[41]=0,Do[129]=Do[41]=-1,Mo[129]=Mo[41]=0,Lo[129]=Lo[41]=0,No[129]=No[41]=0,Fo[129]=Fo[41]=-1,ko[129]=ko[41]=0,Xo[66]=Xo[104]=0,Ko[66]=Ko[104]=1,Yo[66]=Yo[104]=0,Uo[66]=Uo[104]=-1,Wo[66]=Wo[104]=0,qo[66]=qo[104]=1,Zo[66]=Zo[104]=0,Qo[66]=Qo[104]=-1,Jo[66]=Jo[104]=0,Do[66]=Do[104]=0,Mo[66]=Mo[104]=-1,Lo[66]=Lo[104]=1,Go[144]=Go[26]=-1,Bo[144]=Bo[26]=0,Vo[144]=Vo[26]=0,$o[144]=$o[26]=1,ti[144]=ti[26]=0,ei[144]=ei[26]=1,Zo[144]=Zo[26]=0,Qo[144]=Qo[26]=1,Jo[144]=Jo[26]=1,No[144]=No[26]=-1,Fo[144]=Fo[26]=0,ko[144]=ko[26]=1,zo[36]=zo[134]=0,jo[36]=jo[134]=1,Ho[36]=Ho[134]=1,Xo[36]=Xo[134]=0,Ko[36]=Ko[134]=1,Yo[36]=Yo[134]=0,Do[36]=Do[134]=0,Mo[36]=Mo[134]=-1,Lo[36]=Lo[134]=1,No[36]=No[134]=1,Fo[36]=Fo[134]=0,ko[36]=ko[134]=0,Go[9]=Go[161]=-1,Bo[9]=Bo[161]=0,Vo[9]=Vo[161]=0,zo[9]=zo[161]=0,jo[9]=jo[161]=-1,Ho[9]=Ho[161]=0,Uo[9]=Uo[161]=1,Wo[9]=Wo[161]=0,qo[9]=qo[161]=0,$o[9]=$o[161]=1,ti[9]=ti[161]=0,ei[9]=ei[161]=1,Go[136]=0,Bo[136]=1,Vo[136]=1,zo[136]=0,jo[136]=1,Ho[136]=0,Xo[136]=-1,Ko[136]=0,Yo[136]=1,Uo[136]=-1,Wo[136]=0,qo[136]=0,$o[136]=0,ti[136]=-1,ei[136]=0,Zo[136]=0,Qo[136]=-1,Jo[136]=1,Do[136]=1,Mo[136]=0,Lo[136]=0,No[136]=1,Fo[136]=0,ko[136]=1,Go[34]=0,Bo[34]=-1,Vo[34]=0,zo[34]=0,jo[34]=-1,Ho[34]=1,Xo[34]=1,Ko[34]=0,Yo[34]=0,Uo[34]=1,Wo[34]=0,qo[34]=1,$o[34]=0,ti[34]=1,ei[34]=1,Zo[34]=0,Qo[34]=1,Jo[34]=0,Do[34]=-1,Mo[34]=0,Lo[34]=1,No[34]=-1,Fo[34]=0,ko[34]=0,Go[35]=0,Bo[35]=1,Vo[35]=1,zo[35]=0,jo[35]=-1,Ho[35]=1,Xo[35]=1,Ko[35]=0,Yo[35]=0,Uo[35]=-1,Wo[35]=0,qo[35]=0,$o[35]=0,ti[35]=-1,ei[35]=0,Zo[35]=0,Qo[35]=1,Jo[35]=0,Do[35]=-1,Mo[35]=0,Lo[35]=1,No[35]=1,Fo[35]=0,ko[35]=1,Go[153]=0,Bo[153]=1,Vo[153]=1,Uo[153]=-1,Wo[153]=0,qo[153]=0,$o[153]=0,ti[153]=-1,ei[153]=0,No[153]=1,Fo[153]=0,ko[153]=1,zo[102]=0,jo[102]=-1,Ho[102]=1,Xo[102]=1,Ko[102]=0,Yo[102]=0,Zo[102]=0,Qo[102]=1,Jo[102]=0,Do[102]=-1,Mo[102]=0,Lo[102]=1,Go[155]=0,Bo[155]=-1,Vo[155]=0,Uo[155]=1,Wo[155]=0,qo[155]=1,$o[155]=0,ti[155]=1,ei[155]=1,No[155]=-1,Fo[155]=0,ko[155]=0,zo[103]=0,jo[103]=1,Ho[103]=0,Xo[103]=-1,Ko[103]=0,Yo[103]=1,Zo[103]=0,Qo[103]=-1,Jo[103]=1,Do[103]=1,Mo[103]=0,Lo[103]=0,Go[152]=0,Bo[152]=1,Vo[152]=1,Xo[152]=-1,Ko[152]=0,Yo[152]=1,Uo[152]=-1,Wo[152]=0,qo[152]=0,$o[152]=0,ti[152]=-1,ei[152]=0,Zo[152]=0,Qo[152]=-1,Jo[152]=1,No[152]=1,Fo[152]=0,ko[152]=1,Go[156]=0,Bo[156]=-1,Vo[156]=1,Xo[156]=1,Ko[156]=0,Yo[156]=1,Uo[156]=-1,Wo[156]=0,qo[156]=0,$o[156]=0,ti[156]=-1,ei[156]=0,Zo[156]=0,Qo[156]=1,Jo[156]=1,No[156]=-1,Fo[156]=0,ko[156]=1,Go[137]=0,Bo[137]=1,Vo[137]=1,zo[137]=0,jo[137]=1,Ho[137]=0,Uo[137]=-1,Wo[137]=0,qo[137]=0,$o[137]=0,ti[137]=-1,ei[137]=0,Do[137]=1,Mo[137]=0,Lo[137]=0,No[137]=1,Fo[137]=0,ko[137]=1,Go[139]=0,Bo[139]=1,Vo[139]=1,zo[139]=0,jo[139]=-1,Ho[139]=0,Uo[139]=1,Wo[139]=0,qo[139]=0,$o[139]=0,ti[139]=1,ei[139]=0,Do[139]=-1,Mo[139]=0,Lo[139]=0,No[139]=1,Fo[139]=0,ko[139]=1,Go[98]=0,Bo[98]=-1,Vo[98]=0,zo[98]=0,jo[98]=-1,Ho[98]=1,Xo[98]=1,Ko[98]=0,Yo[98]=0,Uo[98]=1,Wo[98]=0,qo[98]=1,Zo[98]=0,Qo[98]=1,Jo[98]=0,Do[98]=-1,Mo[98]=0,Lo[98]=1,Go[99]=0,Bo[99]=1,Vo[99]=0,zo[99]=0,jo[99]=-1,Ho[99]=1,Xo[99]=1,Ko[99]=0,Yo[99]=0,Uo[99]=-1,Wo[99]=0,qo[99]=1,Zo[99]=0,Qo[99]=-1,Jo[99]=0,Do[99]=1,Mo[99]=0,Lo[99]=1,zo[38]=0,jo[38]=-1,Ho[38]=1,Xo[38]=1,Ko[38]=0,Yo[38]=0,$o[38]=0,ti[38]=1,ei[38]=1,Zo[38]=0,Qo[38]=1,Jo[38]=0,Do[38]=-1,Mo[38]=0,Lo[38]=1,No[38]=-1,Fo[38]=0,ko[38]=0,zo[39]=0,jo[39]=1,Ho[39]=1,Xo[39]=-1,Ko[39]=0,Yo[39]=0,$o[39]=0,ti[39]=-1,ei[39]=1,Zo[39]=0,Qo[39]=1,Jo[39]=0,Do[39]=-1,Mo[39]=0,Lo[39]=1,No[39]=1,Fo[39]=0,ko[39]=0;var ni=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},ri=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},oi=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},ii=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},si=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},ai=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},li=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},ui=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},ci=[],pi=[],hi=[],di=[],fi=[],gi=[],mi=[],yi=[];di[1]=fi[1]=18,di[169]=fi[169]=18,hi[4]=pi[4]=12,hi[166]=pi[166]=12,ci[16]=yi[16]=4,ci[154]=yi[154]=4,gi[64]=mi[64]=22,gi[106]=mi[106]=22,hi[2]=gi[2]=17,di[2]=fi[2]=18,hi[168]=gi[168]=17,di[168]=fi[168]=18,ci[8]=di[8]=9,pi[8]=hi[8]=12,ci[162]=di[162]=9,pi[162]=hi[162]=12,ci[32]=yi[32]=4,pi[32]=mi[32]=1,ci[138]=yi[138]=4,pi[138]=mi[138]=1,fi[128]=yi[128]=21,gi[128]=mi[128]=22,fi[42]=yi[42]=21,gi[42]=mi[42]=22,pi[5]=fi[5]=14,pi[165]=fi[165]=14,hi[20]=yi[20]=6,hi[150]=yi[150]=6,ci[80]=gi[80]=11,ci[90]=gi[90]=11,di[65]=mi[65]=3,di[105]=mi[105]=3,ci[160]=gi[160]=11,pi[160]=fi[160]=14,ci[10]=gi[10]=11,pi[10]=fi[10]=14,hi[130]=yi[130]=6,di[130]=mi[130]=3,hi[40]=yi[40]=6,di[40]=mi[40]=3,pi[101]=mi[101]=1,pi[69]=mi[69]=1,fi[149]=yi[149]=21,fi[21]=yi[21]=21,hi[86]=gi[86]=17,hi[84]=gi[84]=17,ci[89]=di[89]=9,ci[81]=di[81]=9,ci[96]=mi[96]=0,pi[96]=gi[96]=15,ci[74]=mi[74]=0,pi[74]=gi[74]=15,ci[24]=hi[24]=8,di[24]=yi[24]=7,ci[146]=hi[146]=8,di[146]=yi[146]=7,pi[6]=gi[6]=15,hi[6]=fi[6]=16,pi[164]=gi[164]=15,hi[164]=fi[164]=16,di[129]=yi[129]=7,fi[129]=mi[129]=20,di[41]=yi[41]=7,fi[41]=mi[41]=20,hi[66]=mi[66]=2,di[66]=gi[66]=19,hi[104]=mi[104]=2,di[104]=gi[104]=19,ci[144]=fi[144]=10,gi[144]=yi[144]=23,ci[26]=fi[26]=10,gi[26]=yi[26]=23,pi[36]=yi[36]=5,hi[36]=mi[36]=2,pi[134]=yi[134]=5,hi[134]=mi[134]=2,ci[9]=fi[9]=10,pi[9]=di[9]=13,ci[161]=fi[161]=10,pi[161]=di[161]=13,pi[37]=yi[37]=5,fi[37]=mi[37]=20,pi[133]=yi[133]=5,fi[133]=mi[133]=20,hi[148]=fi[148]=16,gi[148]=yi[148]=23,hi[22]=fi[22]=16,gi[22]=yi[22]=23,ci[82]=hi[82]=8,di[82]=gi[82]=19,ci[88]=hi[88]=8,di[88]=gi[88]=19,ci[73]=mi[73]=0,pi[73]=di[73]=13,ci[97]=mi[97]=0,pi[97]=di[97]=13,ci[145]=di[145]=9,fi[145]=yi[145]=21,ci[25]=di[25]=9,fi[25]=yi[25]=21,pi[70]=mi[70]=1,hi[70]=gi[70]=17,pi[100]=mi[100]=1,hi[100]=gi[100]=17,ci[34]=di[34]=9,pi[34]=hi[34]=12,fi[34]=yi[34]=21,gi[34]=mi[34]=22,ci[136]=yi[136]=4,pi[136]=mi[136]=1,hi[136]=gi[136]=17,di[136]=fi[136]=18,ci[35]=yi[35]=4,pi[35]=hi[35]=12,di[35]=fi[35]=18,gi[35]=mi[35]=22,ci[153]=yi[153]=4,di[153]=fi[153]=18,pi[102]=hi[102]=12,gi[102]=mi[102]=22,ci[155]=di[155]=9,fi[155]=yi[155]=23,pi[103]=mi[103]=1,hi[103]=gi[103]=17,ci[152]=yi[152]=4,hi[152]=gi[152]=17,di[152]=fi[152]=18,ci[156]=hi[156]=8,di[156]=fi[156]=18,gi[156]=yi[156]=23,ci[137]=yi[137]=4,pi[137]=mi[137]=1,di[137]=fi[137]=18,ci[139]=yi[139]=4,pi[139]=di[139]=13,fi[139]=mi[139]=20,ci[98]=di[98]=9,pi[98]=hi[98]=12,gi[98]=mi[98]=22,ci[99]=mi[99]=0,pi[99]=hi[99]=12,di[99]=gi[99]=19,pi[38]=hi[38]=12,fi[38]=yi[38]=21,gi[38]=mi[38]=22,pi[39]=yi[39]=5,hi[39]=fi[39]=16,gi[39]=mi[39]=22;var vi=[];function _i(t,e,n){return(t-e)/(n-e)}function wi(t){return t.constructor.toString().indexOf("Array")>-1}function Ci(t,e,n,r,o,i){for(var s=t.cells[n][e],a=s.cval_real,l=e+r,u=n+o,c=[],p=!1;!p;){if(void 0===t.cells[u]||void 0===t.cells[u][l])if(u-=o,l-=r,a=(s=t.cells[u][l]).cval_real,-1===o)if(0===i)if(1&a)c.push([l,u]),r=-1,o=0,i=0;else{if(!(4&a)){c.push([l+s.bottomright,u]),r=0,o=1,i=1,p=!0;break}c.push([l+1,u]),r=1,o=0,i=0}else{if(!(1&a)){if(4&a){c.push([l+s.bottomright,u]),r=0,o=1,i=1,p=!0;break}c.push([l+s.bottomleft,u]),r=0,o=1,i=0,p=!0;break}c.push([l,u]),r=-1,o=0,i=0}else if(1===o)if(0===i){if(!(16&a)){if(64&a){c.push([l+s.topleft,u+1]),r=0,o=-1,i=0,p=!0;break}c.push([l+s.topright,u+1]),r=0,o=-1,i=1,p=!0;break}c.push([l+1,u+1]),r=1,o=0,i=1}else c.push([l+1,u+1]),r=1,o=0,i=1;else if(-1===r)if(0===i){if(!(64&a)){if(1&a){c.push([l,u+s.leftbottom]),r=1,o=0,i=0,p=!0;break}c.push([l,u+s.lefttop]),r=1,o=0,i=1,p=!0;break}c.push([l,u+1]),r=0,o=1,i=0}else{if(!(64&a)){console.log("MarchingSquaresJS-isoBands: wtf");break}c.push([l,u+1]),r=0,o=1,i=0}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===i){if(!(4&a)){c.push([l+1,u+s.rightbottom]),r=-1,o=0,i=0,p=!0;break}c.push([l+1,u]),r=0,o=-1,i=1}else{if(!(4&a)){if(16&a){c.push([l+1,u+s.righttop]),r=-1,o=0,i=1;break}c.push([l+1,u+s.rightbottom]),r=-1,o=0,i=0,p=!0;break}c.push([l+1,u]),r=0,o=-1,i=1}}else if(a=(s=t.cells[u][l]).cval_real,-1===r)if(0===i)if(void 0!==t.cells[u-1]&&void 0!==t.cells[u-1][l])r=0,o=-1,i=1;else{if(!(1&a)){c.push([l+s.bottomright,u]),r=0,o=1,i=1,p=!0;break}c.push([l,u])}else{if(!(64&a)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+u);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===r){if(0===i){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u+1]&&void 0!==t.cells[u+1][l])r=0,o=1,i=0;else{if(!(16&a)){c.push([l+s.topleft,u+1]),r=0,o=-1,i=0,p=!0;break}c.push([l+1,u+1]),r=1,o=0,i=1}}else if(-1===o){if(1!==i){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l+1])r=1,o=0,i=1;else{if(!(4&a)){c.push([l+1,u+s.righttop]),r=-1,o=0,i=1,p=!0;break}c.push([l+1,u]),r=0,o=-1,i=1}}else{if(1!==o){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==i){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l-1])r=-1,o=0,i=0;else{if(!(64&a)){c.push([l,u+s.leftbottom]),r=1,o=0,i=0,p=!0;break}c.push([l,u+1]),r=0,o=1,i=0}}if(u+=o,(l+=r)===e&&u===n)break}return{path:c,i:l,j:u,x:r,y:o,o:i}}function bi(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return 16&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return 4&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return 1&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return 16&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return 4&n?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return 1&n?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return 1&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return 64&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return 1&n?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return 64&n?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return 64&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return 64&n?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return 64&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return 16&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return 64&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return 16&n?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}function xi(t,e,n,r){var o,i,s,a,l,u=t.cval;switch(e){case-1:switch(r){case 0:o=pi[u],s=zo[u],a=jo[u],l=Ho[u];break;default:o=ci[u],s=Go[u],a=Bo[u],l=Vo[u]}break;case 1:switch(r){case 0:o=fi[u],s=$o[u],a=ti[u],l=ei[u];break;default:o=gi[u],s=Zo[u],a=Qo[u],l=Jo[u]}break;default:switch(n){case-1:switch(r){case 0:o=mi[u],s=Do[u],a=Mo[u],l=Lo[u];break;default:o=yi[u],s=No[u],a=Fo[u],l=ko[u]}break;case 1:switch(r){case 0:o=di[u],s=Uo[u],a=Wo[u],l=qo[u];break;default:o=hi[u],s=Xo[u],a=Ko[u],l=Yo[u]}}}if(i=t.edges.indexOf(o),void 0===t.edges[i])return null;switch(function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,i),u=t.cval_real,o){case 0:16&u?(e=t.topleft,n=1):(e=1,n=t.righttop);break;case 1:4&u?(e=1,n=t.rightbottom):(e=t.topleft,n=1);break;case 2:4&u?(e=t.topleft,n=1):(e=t.bottomright,n=0);break;case 3:1&u?(e=t.bottomleft,n=0):(e=t.topleft,n=1);break;case 4:16&u?(e=t.topright,n=1):(e=1,n=t.righttop);break;case 5:4&u?(e=1,n=t.rightbottom):(e=t.topright,n=1);break;case 6:4&u?(e=t.topright,n=1):(e=t.bottomright,n=0);break;case 7:1&u?(e=t.bottomleft,n=0):(e=t.topright,n=1);break;case 8:4&u?(e=1,n=t.righttop):(e=t.bottomright,n=0);break;case 9:1&u?(e=t.bottomleft,n=0):(e=1,n=t.righttop);break;case 10:1&u?(e=1,n=t.righttop):(e=0,n=t.leftbottom);break;case 11:64&u?(e=0,n=t.lefttop):(e=1,n=t.righttop);break;case 12:4&u?(e=1,n=t.rightbottom):(e=t.bottomright,n=0);break;case 13:1&u?(e=t.bottomleft,n=0):(e=1,n=t.rightbottom);break;case 14:1&u?(e=1,n=t.rightbottom):(e=0,n=t.leftbottom);break;case 15:64&u?(e=0,n=t.lefttop):(e=1,n=t.rightbottom);break;case 16:4&u?(e=0,n=t.leftbottom):(e=t.bottomright,n=0);break;case 17:64&u?(e=0,n=t.lefttop):(e=t.bottomright,n=0);break;case 18:1&u?(e=t.bottomleft,n=0):(e=0,n=t.leftbottom);break;case 19:64&u?(e=0,n=t.lefttop):(e=t.bottomleft,n=0);break;case 20:64&u?(e=0,n=t.leftbottom):(e=t.topleft,n=1);break;case 21:16&u?(e=t.topright,n=1):(e=0,n=t.leftbottom);break;case 22:64&u?(e=0,n=t.lefttop):(e=t.topleft,n=1);break;case 23:16&u?(e=t.topright,n=1):(e=0,n=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==s&&void 0!==a&&void 0!==l||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+s+" "+a+" "+l)),{p:[e,n],x:s,y:a,o:l}}function Ei(t){var e=[],n=[];t.forEach((function(t){var r=Cr(c([t]));n.push(r),e.push({ring:t,area:r})})),n.sort((function(t,e){return e-t}));var r=[];return n.forEach((function(t){for(var n=0;n<e.length;n++)if(e[n].area===t){r.push(e[n].ring),e.splice(n,1);break}})),r}function Si(t){for(var e=t.map((function(t){return{lrCoordinates:t,grouped:!1}})),n=[];!Ri(e);)for(var r=0;r<e.length;r++)if(!e[r].grouped){var o=[];o.push(e[r].lrCoordinates),e[r].grouped=!0;for(var i=c([e[r].lrCoordinates]),s=r+1;s<e.length;s++)e[s].grouped||Ti(c([e[s].lrCoordinates]),i)&&(o.push(e[s].lrCoordinates),e[s].grouped=!0);n.push(o)}return n}function Ti(t,e){for(var n=hn(t),r=0;r<n.features.length;r++)if(!fe(n.features[r],e))return!1;return!0}function Ri(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}function Pi(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.pivot,o=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(r||(r=pn(t)),!1!==o&&void 0!==o||(t=be(t)),M(t,(function(t){var n=_o(r,t)+e,o=fr(r,t),i=$(Co(r,o,n));t[0]=i[0],t[1]=i[1]}))),t}function Oi(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.origin,o=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var i=Array.isArray(r)||"object"==typeof r;return!0!==o&&(t=be(t)),"FeatureCollection"!==t.type||i?Ii(t,e,r):(k(t,(function(n,o){t.features[o]=Ii(n,e,r)})),t)}function Ii(t,e,n){var r="Point"===it(t);return n=function(t,e){if(null==e&&(e="centroid"),Array.isArray(e)||"object"==typeof e)return J(e);var n=t.bbox?t.bbox:Q(t),r=n[0],o=n[1],i=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return l([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return l([i,o]);case"nw":case"northwest":case"westnorth":case"topleft":return l([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return l([i,s]);case"center":return cn(t);case void 0:case null:case"centroid":return pn(t);default:throw new Error("invalid origin")}}(t,n),1===e||r||M(t,(function(t){var r=fr(n,t),o=_o(n,t),i=$(Co(n,r*e,o));t[0]=i[0],t[1]=i[1],3===t.length&&(t[2]*=e)})),t}function Ai(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function Di(t,e){return t[0]*e[1]-e[0]*t[1]}function Mi(t,e,n){var r=[],o=b(e,n),i=$(t),s=[];return i.forEach((function(t,e){if(e!==i.length-1){var n=(u=t,c=i[e+1],p=o,h=Math.sqrt((u[0]-c[0])*(u[0]-c[0])+(u[1]-c[1])*(u[1]-c[1])),d=u[0]+p*(c[1]-u[1])/h,f=c[0]+p*(c[1]-u[1])/h,[[d,u[1]+p*(u[0]-c[0])/h],[f,c[1]+p*(u[0]-c[0])/h]]);if(r.push(n),e>0){var a=r[e-1],l=function(t,e){return!function(t,e){return 0===Di(Ai(t),Ai(e))}(t,e)&&function(t,e){var n,r,o=t[0],i=Ai(t),s=e[0],a=Ai(e),l=Di(i,a);return function(t,e){return[t[0]+e[0],t[1]+e[1]]}(o,function(t,e){return[t*e[0],t*e[1]]}(Di((r=o,[(n=s)[0]-r[0],n[1]-r[1]]),a)/l,i))}(t,e)}(n,a);!1!==l&&(a[1]=l,n[0]=l),s.push(a[0]),e===i.length-2&&(s.push(n[0]),s.push(n[1]))}2===i.length&&(s.push(n[0]),s.push(n[1]))}var u,c,p,h,d,f})),h(s,t.properties)}function Li(t,e,n){var r=e[0]-t[0],o=e[1]-t[1],i=n[0]-e[0];return function(t){return(t>0)-(t<0)||+t}(r*(n[1]-e[1])-i*o)}function Ni(t,e){return e.geometry.coordinates[0].every((function(e){return fe(l(e),t)}))}vi[1]=vi[169]=ni,vi[4]=vi[166]=ri,vi[16]=vi[154]=oi,vi[64]=vi[106]=ii,vi[168]=vi[2]=si,vi[162]=vi[8]=ai,vi[138]=vi[32]=li,vi[42]=vi[128]=ui,vi[5]=vi[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},vi[20]=vi[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},vi[80]=vi[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},vi[65]=vi[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},vi[160]=vi[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},vi[130]=vi[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},vi[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},vi[101]=vi[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},vi[149]=vi[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},vi[86]=vi[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},vi[89]=vi[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},vi[96]=vi[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},vi[24]=vi[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},vi[6]=vi[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},vi[129]=vi[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},vi[66]=vi[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},vi[144]=vi[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},vi[36]=vi[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},vi[9]=vi[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},vi[37]=vi[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},vi[148]=vi[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},vi[82]=vi[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},vi[73]=vi[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},vi[145]=vi[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},vi[70]=vi[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},vi[34]=function(t){return[ui(t),ai(t)]},vi[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},vi[136]=function(t){return[li(t),si(t)]},vi[153]=function(t){return[oi(t),ni(t)]},vi[102]=function(t){return[ri(t),ii(t)]},vi[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},vi[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},vi[152]=function(t){return[oi(t),si(t)]},vi[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},vi[137]=function(t){return[li(t),ni(t)]},vi[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},vi[98]=function(t){return[ai(t),ii(t)]},vi[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},vi[38]=function(t){return[ri(t),ui(t)]},vi[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};var Fi=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var r=e.to,o=n.to;if(r.coordinates[0]-t.coordinates[0]>=0&&o.coordinates[0]-t.coordinates[0]<0)return 1;if(r.coordinates[0]-t.coordinates[0]<0&&o.coordinates[0]-t.coordinates[0]>=0)return-1;if(r.coordinates[0]-t.coordinates[0]==0&&o.coordinates[0]-t.coordinates[0]==0)return r.coordinates[1]-t.coordinates[1]>=0||o.coordinates[1]-t.coordinates[1]>=0?r.coordinates[1]-o.coordinates[1]:o.coordinates[1]-r.coordinates[1];var i=Li(t.coordinates,r.coordinates,o.coordinates);return i<0?1:i>0?-1:Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2)-(Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}(),ki=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return h([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return Li(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}(),Gi=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,r){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=r),e}),0),n=(0===e?this.length:e)-1,r=(e+1)%this.length,o=Li(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[r].from.coordinates);return 0===o?this.edges[n].from.coordinates[0]>this.edges[r].from.coordinates[0]:o>0},t.prototype.toMultiPoint=function(){return m(this.edges.map((function(t){return t.from.coordinates})))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=c([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=on(this.toPolygon())},t.findEdgeRingContaining=function(t,e){var n,r,o=t.getEnvelope();return e.forEach((function(e){var i,s,a,u,c,p,h=e.getEnvelope();if(r&&(n=r.getEnvelope()),s=o,a=(i=h).geometry.coordinates[0].map((function(t){return t[0]})),u=i.geometry.coordinates[0].map((function(t){return t[1]})),c=s.geometry.coordinates[0].map((function(t){return t[0]})),p=s.geometry.coordinates[0].map((function(t){return t[1]})),(Math.max.apply(null,a)!==Math.max.apply(null,c)||Math.max.apply(null,u)!==Math.max.apply(null,p)||Math.min.apply(null,a)!==Math.min.apply(null,c)||Math.min.apply(null,u)!==Math.min.apply(null,p))&&Ni(h,o)){for(var d=t.map((function(t){return t.from.coordinates})),f=void 0,g=function(t){e.some((function(e){return n=t,r=e.from.coordinates,n[0]===r[0]&&n[1]===r[1];var n,r}))||(f=t)},m=0,y=d;m<y.length;m++)g(y[m]);f&&e.inside(l(f))&&(r&&!Ni(n,h)||(r=e))}})),r},t.prototype.inside=function(t){return fe(t,this.toPolygon())},t}(),Bi=function(){function t(){this.edges=[],this.nodes={}}return t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var n=new t;return j(e,(function(t){nt(t,"LineString","Graph::fromGeoJson"),L(t,(function(t,e){if(t){var r=n.getNode(t),o=n.getNode(e);n.addEdge(r,o)}return e}))})),n},t.prototype.getNode=function(t){var e=Fi.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new Fi(t)),n},t.prototype.addEdge=function(t,e){var n=new ki(t,e),r=n.getSymetric();this.edges.push(n),this.edges.push(r)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var n,r,o=t.getOuterEdges(),i=o.length-1;i>=0;--i){var s=o[i],a=s.symetric,l=void 0,u=void 0;s.label===e&&(l=s),a.label===e&&(u=a),l&&u&&(u&&(r=u),l&&(r&&(r.next=l,r=void 0),n||(n=l)))}r&&(r.next=n)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var r=n;do{r.label=e,r=r.next}while(!n.isEqual(r));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],n=t,r=function(){var r=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++r})),r>1&&e.push(n.from),n=n.next};do{r()}while(!t.isEqual(n));return e},t.prototype._findEdgeRing=function(t){var e=t,n=new Gi;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()},t}();function Vi(t,e){var n=!0;return j(t,(function(t){j(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return n=t.coordinates,r=e.coordinates,!(n[0]===r[0]&&n[1]===r[1]);case"LineString":return!zi(e,t);case"Polygon":return!fe(t,e)}break;case"LineString":switch(e.type){case"Point":return!zi(t,e);case"LineString":return!function(t,e){return pr(t,e).features.length>0}(t,e);case"Polygon":return!ji(e,t)}break;case"Polygon":switch(e.type){case"Point":return!fe(e,t);case"LineString":return!ji(t,e);case"Polygon":return!function(t,e){for(var n=0,r=t.coordinates[0];n<r.length;n++)if(fe(r[n],e))return!0;for(var o=0,i=e.coordinates[0];o<i.length;o++)if(fe(i[o],t))return!0;return pr(no(t),no(e)).features.length>0}(e,t)}}var n,r;return!1}(t.geometry,e.geometry)}))})),n}function zi(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(Hi(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function ji(t,e){for(var n=0,r=e.coordinates;n<r.length;n++)if(fe(r[n],t))return!0;return pr(e,no(t)).features.length>0}function Hi(t,e,n){var r=n[0]-t[0],o=n[1]-t[1],i=e[0]-t[0],s=e[1]-t[1];return 0==r*s-o*i&&(Math.abs(i)>=Math.abs(s)?i>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}function Ui(t,e){return!(t[0]>e[0])&&!(t[2]<e[2])&&!(t[1]>e[1])&&!(t[3]<e[3])}function Wi(t,e){return t[0]===e[0]&&t[1]===e[1]}function qi(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function Xi(t,e){for(var n=!1,r=!1,o=t.coordinates.length,i=0;i<o&&!n&&!r;){for(var s=0;s<e.coordinates.length-1;s++){var a=!0;0!==s&&s!==e.coordinates.length-2||(a=!1),Zi(e.coordinates[s],e.coordinates[s+1],t.coordinates[i],a)?n=!0:r=!0}i++}return n&&r}function Ki(t,e){return pr(t,ro(e)).features.length>0}function Yi(t,e){for(var n=!1,r=!1,o=t.coordinates.length,i=0;i<o&&(!n||!r);i++)fe(l(t.coordinates[i]),e)?n=!0:r=!0;return r&&n}function Zi(t,e,n,r){var o=n[0]-t[0],i=n[1]-t[1],s=e[0]-t[0],a=e[1]-t[1];return 0==o*a-i*s&&(r?Math.abs(s)>=Math.abs(a)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(s)>=Math.abs(a)?s>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:a>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}var Qi=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:ts};function Ji(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function $i(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function ts(t,e){return go(t,e,{strict:!0})}Qi.prototype.compare=function(t,e){if(t.type!==e.type||!$i(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,r=Ji(t),o=Ji(e);return r.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),o)}}return!1},Qi.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},Qi.prototype.compareLine=function(t,e,n,r){if(!$i(t,e))return!1;var o=this.pseudoNode?t:this.removePseudo(t),i=this.pseudoNode?e:this.removePseudo(e);if(!r||this.compareCoord(o[0],i[0])||(i=this.fixStartIndex(i,o))){var s=this.compareCoord(o[n],i[n]);return this.direction||s?this.comparePath(o,i):!!this.compareCoord(o[n],i[i.length-(1+n)])&&this.comparePath(o.slice().reverse(),i)}},Qi.prototype.fixStartIndex=function(t,e){for(var n,r=-1,o=0;o<t.length;o++)if(this.compareCoord(t[o],e[0])){r=o;break}return r>=0&&(n=[].concat(t.slice(r,t.length),t.slice(1,r+1))),n},Qi.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},Qi.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),r=e.coordinates.slice(1,e.coordinates.length),o=this;return n.every((function(t){return this.some((function(e){return o.compareLine(t,e,1,!0)}))}),r)}return!1},Qi.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},Qi.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},Qi.prototype.removePseudo=function(t){return t};var es=Qi;function ns(t,e){var n=!1;return j(t,(function(t){j(e,(function(e){if(!0===n)return!0;n=!Vi(t.geometry,e.geometry)}))})),n}var rs=Bt((function(t){function e(t,e,n,r){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,r)}e.prototype.run=function(t,e,n,r){this._init(t,e,n,r);for(var o=0;o<this._datasetLength;o++)if(1!==this._visited[o]){this._visited[o]=1;var i=this._regionQuery(o);if(i.length<this.minPts)this.noise.push(o);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(o,s),this._expandCluster(s,i)}}return this.clusters},e.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);o.length>=this.minPts&&(e=this._mergeArrays(e,o))}1!==this._assigned[r]&&this._addToCluster(r,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n);return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,r=0;r<n;r++){var o=e[r];t.indexOf(o)<0&&t.push(o)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=e)})),os=Bt((function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,r=0;r<this.k;r++)this.centroids[r]=this.randomCentroid();for(var o=!0;o;){o=this.assign();for(var i=0;i<this.k;i++){for(var s=new Array(c),a=0,l=0;l<c;l++)s[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(i===this.assignments[u]){for(l=0;l<c;l++)s[l]+=this.dataset[u][l];a++}}if(a>0){for(l=0;l<c;l++)s[l]/=a;this.centroids[i]=s}else this.centroids[i]=this.randomCentroid(),o=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,r=0;r<n;r++)(t=this.argmin(this.dataset[r],this.centroids,this.distance))!=this.assignments[r]&&(this.assignments[r]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var r,o=Number.MAX_VALUE,i=0,s=e.length,a=0;a<s;a++)(r=n(t,e[a]))<o&&(o=r,i=a);return i},e.prototype.distance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;){var o=t[r]-e[r];n+=o*o}return Math.sqrt(n)},t.exports&&(t.exports=e)})),is=Bt((function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,r=n;r--;){var o=this._priorities[r];"desc"===this._sorting?e>o&&(n=r):e<o&&(n=r)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var r=0;r<t.length;r++)this.insert(t[r],e[r])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)})),ss=Bt((function(t){if(t.exports)var e=is;function n(t,e,n,r){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,r)}n.prototype.run=function(t,n,r,o){this._init(t,n,r,o);for(var i=0,s=this.dataset.length;i<s;i++)if(1!==this._processed[i]){this._processed[i]=1,this.clusters.push([i]);var a=this.clusters.length-1;this._orderedList.push(i);var l=new e(null,null,"asc"),u=this._regionQuery(i);void 0!==this._distanceToCore(i)&&(this._updateQueue(i,u,l),this._expandCluster(a,l))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var r=this._orderedList[e],o=this._reachability[r];t.push([r,o])}return t},n.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},n.prototype._updateQueue=function(t,e,n){var r=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===r._processed[e]){var o=r.distance(r.dataset[t],r.dataset[e]),i=Math.max(r._coreDistance,o);void 0===r._reachability[e]?(r._reachability[e]=i,n.insert(e,i)):i<r._reachability[e]&&(r._reachability[e]=i,n.remove(e),n.insert(e,i))}}))},n.prototype._expandCluster=function(t,e){for(var n=e.getElements(),r=0,o=n.length;r<o;r++){var i=n[r];if(void 0===this._processed[i]){var s=this._regionQuery(i);this._processed[i]=1,this.clusters[t].push(i),this._orderedList.push(i),void 0!==this._distanceToCore(i)&&(this._updateQueue(i,s,e),this._expandCluster(t,e))}}},n.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++)if(this._regionQuery(t,n).length>=this.minPts)return n},n.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],r=0,o=this.dataset.length;r<o;r++)this.distance(this.dataset[t],this.dataset[r])<e&&n.push(r);return n},n.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=n)})),as=Bt((function(t){t.exports&&(t.exports={DBSCAN:rs,KMEANS:os,OPTICS:ss,PriorityQueue:is})})),ls=function(t,e,n){for(var r=t.length,o=0,i=0;i<r;i++){var s=(t[i]||0)-(e[i]||0);o+=s*s}return n?Math.sqrt(o):o},us=ls,cs=function(t,e,n){var r=Math.abs(t-e);return n?r:r*r},ps=ls;function hs(t,e,n){n=n||[];for(var r=0;r<t;r++)n[r]=e;return n}var ds=function(t,e,n,r){var o=[],i=[],s=[],a=[],l=!1,u=r||1e4,c=t.length,p=t[0].length,h=p>0,d=[];if(n)o="kmrand"==n?function(t,e){for(var n={},r=[],o=e<<2,i=t.length,s=t[0].length>0;r.length<e&&o-- >0;){var a=t[Math.floor(Math.random()*i)],l=s?a.join("_"):""+a;n[l]||(n[l]=!0,r.push(a))}if(r.length<e)throw new Error("Error initializating clusters");return r}(t,e):"kmpp"==n?function(t,e){var n=t[0].length?us:cs,r=[],o=t.length,i=t[0].length>0,s=t[Math.floor(Math.random()*o)];for(i&&s.join("_"),r.push(s);r.length<e;){for(var a=[],l=r.length,u=0,c=[],p=0;p<o;p++){for(var h=1/0,d=0;d<l;d++){var f=n(t[p],r[d]);f<=h&&(h=f)}a[p]=h}for(var g=0;g<o;g++)u+=a[g];for(var m=0;m<o;m++)c[m]={i:m,v:t[m],pr:a[m]/u,cs:0};c.sort((function(t,e){return t.pr-e.pr})),c[0].cs=c[0].pr;for(var y=1;y<o;y++)c[y].cs=c[y-1].cs+c[y].pr;for(var v=Math.random(),_=0;_<o-1&&c[_++].cs<v;);r.push(c[_-1].v)}return r}(t,e):n;else for(var f={};o.length<e;){var g=Math.floor(Math.random()*c);f[g]||(f[g]=!0,o.push(t[g]))}do{hs(e,0,d);for(var m=0;m<c;m++){for(var y=1/0,v=0,_=0;_<e;_++)(a=h?ps(t[m],o[_]):Math.abs(t[m]-o[_]))<=y&&(y=a,v=_);s[m]=v,d[v]++}for(var w=[],C=(i=[],0);C<e;C++)w[C]=h?hs(p,0,w[C]):0,i[C]=o[C];if(h){for(var b=0;b<e;b++)o[b]=[];for(var x=0;x<c;x++)for(var E=w[s[x]],S=t[x],T=0;T<p;T++)E[T]+=S[T];l=!0;for(var R=0;R<e;R++){for(var P=o[R],O=w[R],I=i[R],A=d[R],D=0;D<p;D++)P[D]=O[D]/A||0;if(l)for(var M=0;M<p;M++)if(I[M]!=P[M]){l=!1;break}}}else{for(var L=0;L<c;L++)w[s[L]]+=t[L];for(var N=0;N<e;N++)o[N]=w[N]/d[N]||0;l=!0;for(var F=0;F<e;F++)if(i[F]!=o[F]){l=!1;break}}l=l||--u<=0}while(!l);return{it:1e4-u,k:e,idxs:s,centroids:o}};function fs(t,e){return x(_o(t[0],t[1]))===x(_o(e[0],e[1]))}function gs(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function ms(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var ys={search:function(t,e,n,r){t.cleanDirty();var o=(r=r||{}).heuristic||ys.heuristics.manhattan,i=r.closest||!1,s=new ws((function(t){return t.f})),a=e;for(e.h=o(e,n),s.push(e);s.size()>0;){var l=s.pop();if(l===n)return ms(l);l.closed=!0;for(var u=t.neighbors(l),c=0,p=u.length;c<p;++c){var h=u[c];if(!h.closed&&!h.isWall()){var d=l.g+h.getCost(l),f=h.visited;(!f||d<h.g)&&(h.visited=!0,h.parent=l,h.h=h.h||o(h,n),h.g=d,h.f=h.g+h.h,t.markDirty(h),i&&(h.h<a.h||h.h===a.h&&h.g<a.g)&&(a=h),f?s.rescoreElement(h):s.push(h))}}}return i?ms(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);return 1*(r+o)+(n-2)*Math.min(r,o)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function vs(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var r=0,o=t[n];r<o.length;r++){var i=new _s(n,r,o[r]);this.grid[n][r]=i,this.nodes.push(i)}}this.init()}function _s(t,e,n){this.x=t,this.y=e,this.weight=n}function ws(t){this.content=[],this.scoreFunction=t}function Cs(t,e){for(var n=0;n<e.features.length;n++)if(fe(t,e.features[n]))return!0;return!1}function bs(t){return function(){return t}}function xs(t){return t[0]}function Es(t){return t[1]}function Ss(){this._=null}function Ts(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Rs(t,e){var n=e,r=e.R,o=n.U;o?o.L===n?o.L=r:o.R=r:t._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Ps(t,e){var n=e,r=e.L,o=n.U;o?o.L===n?o.L=r:o.R=r:t._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Os(t){for(;t.L;)t=t.L;return t}function Is(t,e,n,r){var o=[null,null],i=ta.push(o)-1;return o.left=t,o.right=e,n&&Ds(o,t,e,n),r&&Ds(o,e,t,r),Js[t.index].halfedges.push(i),Js[e.index].halfedges.push(i),o}function As(t,e,n){var r=[e,n];return r.left=t,r}function Ds(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Ms(t,e,n,r,o){var i,s=t[0],a=t[1],l=s[0],u=s[1],c=0,p=1,h=a[0]-l,d=a[1]-u;if(i=e-l,h||!(i>0)){if(i/=h,h<0){if(i<c)return;i<p&&(p=i)}else if(h>0){if(i>p)return;i>c&&(c=i)}if(i=r-l,h||!(i<0)){if(i/=h,h<0){if(i>p)return;i>c&&(c=i)}else if(h>0){if(i<c)return;i<p&&(p=i)}if(i=n-u,d||!(i>0)){if(i/=d,d<0){if(i<c)return;i<p&&(p=i)}else if(d>0){if(i>p)return;i>c&&(c=i)}if(i=o-u,d||!(i<0)){if(i/=d,d<0){if(i>p)return;i>c&&(c=i)}else if(d>0){if(i<c)return;i<p&&(p=i)}return!(c>0||p<1)||(c>0&&(t[0]=[l+c*h,u+c*d]),p<1&&(t[1]=[l+p*h,u+p*d]),!0)}}}}}function Ls(t,e,n,r,o){var i=t[1];if(i)return!0;var s,a,l=t[0],u=t.left,c=t.right,p=u[0],h=u[1],d=c[0],f=c[1],g=(p+d)/2,m=(h+f)/2;if(f===h){if(g<e||g>=r)return;if(p>d){if(l){if(l[1]>=o)return}else l=[g,n];i=[g,o]}else{if(l){if(l[1]<n)return}else l=[g,o];i=[g,n]}}else if(a=m-(s=(p-d)/(f-h))*g,s<-1||s>1)if(p>d){if(l){if(l[1]>=o)return}else l=[(n-a)/s,n];i=[(o-a)/s,o]}else{if(l){if(l[1]<n)return}else l=[(o-a)/s,o];i=[(n-a)/s,n]}else if(h<f){if(l){if(l[0]>=r)return}else l=[e,s*e+a];i=[r,s*r+a]}else{if(l){if(l[0]<e)return}else l=[r,s*r+a];i=[e,s*e+a]}return t[0]=l,t[1]=i,!0}function Ns(t,e){var n=t.site,r=e.left,o=e.right;return n===o&&(o=r,r=n),o?Math.atan2(o[1]-r[1],o[0]-r[0]):(n===r?(r=e[1],o=e[0]):(r=e[0],o=e[1]),Math.atan2(r[0]-o[0],o[1]-r[1]))}function Fs(t,e){return e[+(e.left!==t.site)]}function ks(t,e){return e[+(e.left===t.site)]}vs.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)ys.cleanNode(this.nodes[t])},vs.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)ys.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},vs.prototype.markDirty=function(t){this.dirtyNodes.push(t)},vs.prototype.neighbors=function(t){var e=[],n=t.x,r=t.y,o=this.grid;return o[n-1]&&o[n-1][r]&&e.push(o[n-1][r]),o[n+1]&&o[n+1][r]&&e.push(o[n+1][r]),o[n]&&o[n][r-1]&&e.push(o[n][r-1]),o[n]&&o[n][r+1]&&e.push(o[n][r+1]),this.diagonal&&(o[n-1]&&o[n-1][r-1]&&e.push(o[n-1][r-1]),o[n+1]&&o[n+1][r-1]&&e.push(o[n+1][r-1]),o[n-1]&&o[n-1][r+1]&&e.push(o[n-1][r+1]),o[n+1]&&o[n+1][r+1]&&e.push(o[n+1][r+1])),e},vs.prototype.toString=function(){for(var t,e,n,r,o=[],i=this.grid,s=0,a=i.length;s<a;s++){for(t=[],n=0,r=(e=i[s]).length;n<r;n++)t.push(e[n].weight);o.push(t.join(" "))}return o.join("\n")},_s.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},_s.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},_s.prototype.isWall=function(){return 0===this.weight},ws.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[n]=e,this.content[t]=r,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var o,i=t+1<<1,s=i-1,a=null;if(s<e){var l=this.content[s];(o=this.scoreFunction(l))<r&&(a=s)}if(i<e){var u=this.content[i];this.scoreFunction(u)<(null===a?r:o)&&(a=i)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}},Ss.prototype={constructor:Ss,insert:function(t,e){var n,r,o;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Os(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(o=r.R)&&o.C?(n.C=o.C=!1,r.C=!0,t=r):(t===n.R&&(Rs(this,n),n=(t=n).U),n.C=!1,r.C=!0,Ps(this,r)):(o=r.L)&&o.C?(n.C=o.C=!1,r.C=!0,t=r):(t===n.L&&(Ps(this,n),n=(t=n).U),n.C=!1,r.C=!0,Rs(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,o=t.U,i=t.L,s=t.R;if(n=i?s?Os(s):i:s,o?o.L===t?o.L=n:o.R=n:this._=n,i&&s?(r=n.C,n.C=t.C,n.L=i,i.U=n,n!==s?(o=n.U,n.U=t.U,t=n.R,o.L=t,n.R=s,s.U=n):(n.U=o,o=n,t=n.R)):(r=t.C,t=n),t&&(t.U=o),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===o.L){if((e=o.R).C&&(e.C=!1,o.C=!0,Rs(this,o),e=o.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Ps(this,e),e=o.R),e.C=o.C,o.C=e.R.C=!1,Rs(this,o),t=this._;break}}else if((e=o.L).C&&(e.C=!1,o.C=!0,Ps(this,o),e=o.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Rs(this,e),e=o.L),e.C=o.C,o.C=e.L.C=!1,Ps(this,o),t=this._;break}e.C=!0,t=o,o=o.U}while(!t.C);t&&(t.C=!1)}}};var Gs,Bs=[];function Vs(){Ts(this),this.x=this.y=this.arc=this.site=this.cy=null}function zs(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,o=t.site,i=n.site;if(r!==i){var s=o[0],a=o[1],l=r[0]-s,u=r[1]-a,c=i[0]-s,p=i[1]-a,h=2*(l*p-u*c);if(!(h>=-na)){var d=l*l+u*u,f=c*c+p*p,g=(p*d-u*f)/h,m=(l*f-c*d)/h,y=Bs.pop()||new Vs;y.arc=t,y.site=o,y.x=g+s,y.y=(y.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=y;for(var v=null,_=$s._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}$s.insert(v,y),v||(Gs=y)}}}}function js(t){var e=t.circle;e&&(e.P||(Gs=e.N),$s.remove(e),Bs.push(e),Ts(e),t.circle=null)}var Hs=[];function Us(){Ts(this),this.edge=this.site=this.circle=null}function Ws(t){var e=Hs.pop()||new Us;return e.site=t,e}function qs(t){js(t),Qs.remove(t),Hs.push(t),Ts(t)}function Xs(t){var e=t.circle,n=e.x,r=e.cy,o=[n,r],i=t.P,s=t.N,a=[t];qs(t);for(var l=i;l.circle&&Math.abs(n-l.circle.x)<ea&&Math.abs(r-l.circle.cy)<ea;)i=l.P,a.unshift(l),qs(l),l=i;a.unshift(l),js(l);for(var u=s;u.circle&&Math.abs(n-u.circle.x)<ea&&Math.abs(r-u.circle.cy)<ea;)s=u.N,a.push(u),qs(u),u=s;a.push(u),js(u);var c,p=a.length;for(c=1;c<p;++c)u=a[c],l=a[c-1],Ds(u.edge,l.site,u.site,o);l=a[0],(u=a[p-1]).edge=Is(l.site,u.site,null,o),zs(l),zs(u)}function Ks(t){for(var e,n,r,o,i=t[0],s=t[1],a=Qs._;a;)if((r=Ys(a,s)-i)>ea)a=a.L;else{if(!((o=i-Zs(a,s))>ea)){r>-ea?(e=a.P,n=a):o>-ea?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){Js[t.index]={site:t,halfedges:[]}}(t);var l=Ws(t);if(Qs.insert(e,l),e||n){if(e===n)return js(e),n=Ws(e.site),Qs.insert(l,n),l.edge=n.edge=Is(e.site,l.site),zs(e),void zs(n);if(n){js(e),js(n);var u=e.site,c=u[0],p=u[1],h=t[0]-c,d=t[1]-p,f=n.site,g=f[0]-c,m=f[1]-p,y=2*(h*m-d*g),v=h*h+d*d,_=g*g+m*m,w=[(m*v-d*_)/y+c,(h*_-g*v)/y+p];Ds(n.edge,u,f,w),l.edge=Is(u,t,null,w),n.edge=Is(t,f,null,w),zs(e),zs(n)}else l.edge=Is(e.site,l.site)}}function Ys(t,e){var n=t.site,r=n[0],o=n[1],i=o-e;if(!i)return r;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],u=l-e;if(!u)return a;var c=a-r,p=1/i-1/u,h=c/u;return p?(-h+Math.sqrt(h*h-2*p*(c*c/(-2*u)-l+u/2+o-i/2)))/p+r:(r+a)/2}function Zs(t,e){var n=t.N;if(n)return Ys(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var Qs,Js,$s,ta,ea=1e-6,na=1e-12;function ra(t,e){return e[1]-t[1]||e[0]-t[0]}function oa(t,e){var n,r,o,i=t.sort(ra).pop();for(ta=[],Js=new Array(t.length),Qs=new Ss,$s=new Ss;;)if(o=Gs,i&&(!o||i[1]<o.y||i[1]===o.y&&i[0]<o.x))i[0]===n&&i[1]===r||(Ks(i),n=i[0],r=i[1]),i=t.pop();else{if(!o)break;Xs(o.arc)}if(function(){for(var t,e,n,r,o=0,i=Js.length;o<i;++o)if((t=Js[o])&&(r=(e=t.halfedges).length)){var s=new Array(r),a=new Array(r);for(n=0;n<r;++n)s[n]=n,a[n]=Ns(t,ta[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<r;++n)a[n]=e[s[n]];for(n=0;n<r;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var o,i=ta.length;i--;)Ls(o=ta[i],t,e,n,r)&&Ms(o,t,e,n,r)&&(Math.abs(o[0][0]-o[1][0])>ea||Math.abs(o[0][1]-o[1][1])>ea)||delete ta[i]}(s,a,l,u),function(t,e,n,r){var o,i,s,a,l,u,c,p,h,d,f,g,m=Js.length,y=!0;for(o=0;o<m;++o)if(i=Js[o]){for(s=i.site,a=(l=i.halfedges).length;a--;)ta[l[a]]||l.splice(a,1);for(a=0,u=l.length;a<u;)f=(d=ks(i,ta[l[a]]))[0],g=d[1],p=(c=Fs(i,ta[l[++a%u]]))[0],h=c[1],(Math.abs(f-p)>ea||Math.abs(g-h)>ea)&&(l.splice(a,0,ta.push(As(s,d,Math.abs(f-t)<ea&&r-g>ea?[t,Math.abs(p-t)<ea?h:r]:Math.abs(g-r)<ea&&n-f>ea?[Math.abs(h-r)<ea?p:n,r]:Math.abs(f-n)<ea&&g-e>ea?[n,Math.abs(p-n)<ea?h:e]:Math.abs(g-e)<ea&&f-t>ea?[Math.abs(h-e)<ea?p:t,e]:null))-1),++u);u&&(y=!1)}if(y){var v,_,w,C=1/0;for(o=0,y=null;o<m;++o)(i=Js[o])&&(w=(v=(s=i.site)[0]-t)*v+(_=s[1]-e)*_)<C&&(C=w,y=i);if(y){var b=[t,e],x=[t,r],E=[n,r],S=[n,e];y.halfedges.push(ta.push(As(s=y.site,b,x))-1,ta.push(As(s,x,E))-1,ta.push(As(s,E,S))-1,ta.push(As(s,S,b))-1)}}for(o=0;o<m;++o)(i=Js[o])&&(i.halfedges.length||delete Js[o])}(s,a,l,u)}this.edges=ta,this.cells=Js,Qs=$s=ta=Js=null}function ia(t){return(t=t.slice()).push(t[0]),c([t])}function sa(t,e,n,r){var o=(r=r||{}).steps||64,i=r.units||"kilometers",s=r.angle||0,a=r.pivot||t,l=r.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!O(r))throw new Error("options must be an object");if(!P(o))throw new Error("steps must be a number");if(!P(s))throw new Error("angle must be a number");var u=J(t);if("degrees"===i)var p=S(s);else e=Co(t,e,90,{units:i}),n=Co(t,n,0,{units:i}),e=J(e)[0]-u[0],n=J(n)[1]-u[1];for(var h=[],d=0;d<o;d+=1){var f=-360*d/o,g=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(aa(f),2)),m=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(aa(f),2));if(f<-90&&f>=-270&&(g=-g),f<-180&&f>=-360&&(m=-m),"degrees"===i){var y=g*Math.cos(p)+m*Math.sin(p),v=m*Math.cos(p)-g*Math.sin(p);g=y,m=v}h.push([g+u[0],m+u[1]])}return h.push(h[0]),"degrees"===i?c([h],l):Pi(c([h],l),s,{pivot:a})}function aa(t){var e=t*Math.PI/180;return Math.tan(e)}function la(t,e){void 0===e&&(e={});var n=0,r=0,o=0;return V(t,(function(t,i,s){var a=e.weight?null==s?void 0:s[e.weight]:void 0;if(!P(a=null==a?1:a))throw new Error("weight value must be a number for feature index "+i);(a=Number(a))>0&&M(t,(function(t){n+=t[0]*a,r+=t[1]*a,o+=a}))})),l([n/o,r/o],e.properties,e)}function ua(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function ca(t,e){var n=0,r=0;M(t,(function(o,i,s,a,l){l>n&&(n=l,r=i,e.push([]));var u=i-r,c=t.coordinates[l][u+1],p=o[0],h=o[1],d=c[0],f=c[1];e[l].push([.75*p+.25*d,.75*h+.25*f]),e[l].push([.25*p+.75*d,.25*h+.75*f])}),!0),e.forEach((function(t){t.push(t[0])}))}function pa(t,e){var n=0,r=0,o=0;M(t,(function(i,s,a,l,u){l>o&&(o=l,r=s,e.push([[]])),u>n&&(n=u,r=s,e[l].push([]));var c=s-r,p=t.coordinates[l][u][c+1],h=i[0],d=i[1],f=p[0],g=p[1];e[l][u].push([.75*h+.25*f,.75*d+.25*g]),e[l][u].push([.25*h+.75*f,.25*d+.75*g])}),!0),e.forEach((function(t){t.forEach((function(t){t.push(t[0])}))}))}function ha(t,e,n){void 0===n&&(n=2);var r=J(t),o=J(e),i=r[0]-o[0],s=r[1]-o[1];return 1===n?Math.abs(i)+Math.abs(s):Math.pow(Math.pow(i,n)+Math.pow(s,n),1/n)}function da(t,e){var n=(e=e||{}).threshold||1e4,r=e.p||2,o=e.binary||!1,i=e.alpha||-1,s=e.standardization||!1,a=[];k(t,(function(t){a.push(pn(t))}));for(var l=[],u=0;u<a.length;u++)l[u]=[];for(u=0;u<a.length;u++)for(var c=u;c<a.length;c++){u===c&&(l[u][c]=0);var p=ha(a[u],a[c],r);l[u][c]=p,l[c][u]=p}for(u=0;u<a.length;u++)for(c=0;c<a.length;c++)0!==(p=l[u][c])&&(l[u][c]=o?p<=n?1:0:p<=n?Math.pow(p,i):0);if(s)for(u=0;u<a.length;u++){var h=l[u].reduce((function(t,e){return t+e}),0);for(c=0;c<a.length;c++)l[u][c]=l[u][c]/h}return l}function fa(t){for(var e=0,n=0,r=t;n<r.length;n++)e+=r[n];return e/t.length}function ga(t,e){return void 0===e&&(e={}),ya(t,"mercator",e)}function ma(t,e){return void 0===e&&(e={}),ya(t,"wgs84",e)}function ya(t,e,n){void 0===n&&(n={});var r=(n=n||{}).mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&P(t[0])?t="mercator"===e?va(t):_a(t):(!0!==r&&(t=be(t)),M(t,(function(t){var n="mercator"===e?va(t):_a(t);t[0]=n[0],t[1]=n[1]}))),t}function va(t){var e=Math.PI/180,n=6378137,r=20037508.342789244,o=[n*(Math.abs(t[0])<=180?t[0]:t[0]-360*function(t){return t<0?-1:t>0?1:0}(t[0]))*e,n*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return o[0]>r&&(o[0]=r),o[0]<-r&&(o[0]=-r),o[1]>r&&(o[1]=r),o[1]<-r&&(o[1]=-r),o}function _a(t){var e=180/Math.PI,n=6378137;return[t[0]*e/n,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/n)))*e]}oa.prototype={constructor:oa,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Fs(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(i=(o=n.halfedges).length)for(var o,i,s,a,l,u,c=n.site,p=-1,h=e[o[i-1]],d=h.left===c?h.right:h.left;++p<i;)s=d,d=(h=e[o[p]]).left===c?h.right:h.left,s&&d&&r<s.index&&r<d.index&&(l=s,u=d,((a=c)[0]-u[0])*(l[1]-a[1])-(a[0]-l[0])*(u[1]-a[1])<0)&&t.push([c.data,s.data,d.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,o,i=this,s=i._found||0,a=i.cells.length;!(o=i.cells[s]);)if(++s>=a)return null;var l=t-o.site[0],u=e-o.site[1],c=l*l+u*u;do{o=i.cells[r=s],s=null,o.halfedges.forEach((function(n){var r=i.edges[n],a=r.left;if(a!==o.site&&a||(a=r.right)){var l=t-a[0],u=e-a[1],p=l*l+u*u;p<c&&(c=p,s=a.index)}}))}while(null!==s);return i._found=r,null==n||c<=n*n?o.site:null}};var wa=Object.freeze({__proto__:null,toMercator:ga,toWgs84:ma});function Ca(t){return Array.isArray(t)?Ta(t):t&&t.bbox?Ta(t.bbox):[360*Sa(),180*Sa()]}function ba(t,e){void 0===e&&(e={}),null==t&&(t=1);for(var n=[],r=0;r<t;r++)n.push(l(Ca(e.bbox)));return f(n)}function xa(t,e){void 0===e&&(e={}),null==t&&(t=1),P(e.num_vertices)&&void 0!==e.num_vertices||(e.num_vertices=10),P(e.max_radial_length)&&void 0!==e.max_radial_length||(e.max_radial_length=10);for(var n=[],r=function(t){var r,o=[],i=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}(Array(e.num_vertices+1)).map(Math.random);i.forEach((function(t,e,n){n[e]=e>0?t+n[e-1]:t})),i.forEach((function(t){t=2*t*Math.PI/i[i.length-1];var n=Math.random();o.push([n*(e.max_radial_length||10)*Math.sin(t),n*(e.max_radial_length||10)*Math.cos(t)])})),o[o.length-1]=o[0],o=o.map((r=Ca(e.bbox),function(t){return[t[0]+r[0],t[1]+r[1]]})),n.push(c([o]))},o=0;o<t;o++)r();return f(n)}function Ea(t,e){if(void 0===e&&(e={}),!O(e=e||{}))throw new Error("options is invalid");var n=e.bbox,r=e.num_vertices,o=e.max_length,i=e.max_rotation;null==t&&(t=1),(!P(r)||void 0===r||r<2)&&(r=10),P(o)&&void 0!==o||(o=1e-4),P(i)&&void 0!==i||(i=Math.PI/8);for(var s=[],a=0;a<t;a++){for(var l=[Ca(n)],u=0;u<r-1;u++){var c=(0===u?2*Math.random()*Math.PI:Math.tan((l[u][1]-l[u-1][1])/(l[u][0]-l[u-1][0])))+(Math.random()-.5)*i*2,p=Math.random()*o;l.push([l[u][0]+p*Math.cos(c),l[u][1]+p*Math.sin(c)])}s.push(h(l))}return f(s)}function Sa(){return Math.random()-.5}function Ta(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}var Ra=Object.freeze({__proto__:null,randomPosition:Ca,randomPoint:ba,randomPolygon:xa,randomLineString:Ea});function Pa(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var n=[];return k(t,(function(t){Da(t.properties,e)&&n.push(t)})),f(n)}function Oa(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var r=Aa(t,e),o=Object.keys(r),i=0;i<o.length;i++){for(var s=o[i],a=r[s],l=[],u=0;u<a.length;u++)l.push(t.features[a[u]]);n(f(l),s,i)}}function Ia(t,e,n,r){var o=r;return Oa(t,e,(function(t,e,i){o=0===i&&void 0===r?t:n(o,t,e,i)})),o}function Aa(t,e){var n={};return k(t,(function(t,r){var o=t.properties||{};if(Object.prototype.hasOwnProperty.call(o,String(e))){var i=o[e];Object.prototype.hasOwnProperty.call(n,i)?n[i].push(r):n[i]=[r]}})),n}function Da(t,e){if(void 0===t)return!1;var n=typeof e;if("number"===n||"string"===n)return Object.prototype.hasOwnProperty.call(t,e);if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(!Da(t,e[r]))return!1;return!0}return Ma(t,e)}function Ma(t,e){for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r];if(t[o]!==e[o])return!1}return!0}function La(t,e){if(!e)return{};if(!e.length)return{};for(var n={},r=0;r<e.length;r++){var o=e[r];Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n}var Na=Object.freeze({__proto__:null,getCluster:Pa,clusterEach:Oa,clusterReduce:Ia,createBins:Aa,applyFilter:Da,propertiesContainsFilter:Ma,filterProperties:La}),Fa=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function ka(t,e){return t>e?1:t<e?-1:0}function Ga(t,e,n){for(var r=new Fa(null,null),o=r,i=r;;){var s=n(t,e.key);if(s<0){if(null===e.left)break;if(n(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,null===(e=a).left)break}i.left=e,i=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(a=e.right,e.right=a.left,a.left=e,null===(e=a).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,i.left=e.right,e.left=r.right,e.right=r.left,e}function Ba(t,e,n,r){var o=new Fa(t,e);if(null===n)return o.left=o.right=null,o;var i=r(t,(n=Ga(t,n,r)).key);return i<0?(o.left=n.left,o.right=n,n.left=null):i>=0&&(o.right=n.right,o.left=n,n.right=null),o}function Va(t,e,n){var r=null,o=null;if(e){var i=n((e=Ga(t,e,n)).key,t);0===i?(r=e.left,o=e.right):i<0?(o=e.right,e.right=null,r=e):(r=e.left,e.left=null,o=e)}return{left:r,right:o}}var za=function(){function t(t){void 0===t&&(t=ka),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=Ba(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new Fa(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,o=Ga(t,this._root,r),i=r(t,o.key);return 0===i?this._root=o:(i<0?(n.left=o.left,n.right=o,o.left=null):i>0&&(n.right=o.right,n.left=o,o.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=Ga(t,e,n)).key)?(null===e.left?r=e.right:(r=Ga(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=Ga(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=Ga(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],o=!1;!o;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):o=!0;return this},t.prototype.range=function(t,e,n,r){for(var o=[],i=this._comparator,s=this._root;0!==o.length||s;)if(s)o.push(s),s=s.left;else{if(i((s=o.pop()).key,e)>0)break;if(i(s.key,t)>=0&&n.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,o=[];!n;)if(e)o.push(e),e=e.left;else if(o.length>0){if(e=o.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var o=r(t.key,e.key);if(0===o)break;o<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var o=r(t.key,e.key);if(0===o)break;o<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,n=[],r=!1,o=new Fa(null,null),i=o;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=i=i.next=n.pop()).right:r=!0;return i.next=null,o.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var r=t.length,o=this._comparator;if(n&&function t(e,n,r,o,i){if(!(r>=o)){for(var s=e[r+o>>1],a=r-1,l=o+1;;){do{a++}while(i(e[a],s)<0);do{l--}while(i(e[l],s)>0);if(a>=l)break;var u=e[a];e[a]=e[l],e[l]=u,u=n[a],n[a]=n[l],n[l]=u}t(e,n,r,l,i),t(e,n,l+1,o,i)}}(t,e,0,r-1,o),null===this._root)this._root=function t(e,n,r,o){var i=o-r;if(i>0){var s=r+Math.floor(i/2),a=e[s],l=n[s],u=new Fa(a,l);return u.left=t(e,n,r,s),u.right=t(e,n,s+1,o),u}return null}(t,e,0,r),this._size=r;else{var i=function(t,e,n){for(var r=new Fa(null,null),o=r,i=t,s=e;null!==i&&null!==s;)n(i.key,s.key)<0?(o.next=i,i=i.next):(o.next=s,s=s.next),o=o.next;return null!==i?o.next=i:null!==s&&(o.next=s),r.next}(this.toList(),function(t,e){for(var n=new Fa(null,null),r=n,o=0;o<t.length;o++)r=r.next=new Fa(t[o],e[o]);return r.next=null,n.next}(t,e),o);r=this._size+r,this._root=function t(e,n,r){var o=r-n;if(o>0){var i=n+Math.floor(o/2),s=t(e,n,i),a=e.head;return a.left=s,e.head=e.head.next,a.right=t(e,i+1,r),a}return null}({head:i},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return function t(e,n,r,o,i){if(e){o(n+(r?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+i(e)+"\n");var s=n+(r?"    ":"\u2502   ");e.left&&t(e.left,s,!1,o,i),e.right&&t(e.right,s,!0,o,i)}}(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,o=Va(t,this._root,r),i=o.left,s=o.right;r(t,e)<0?s=Ba(e,n,s,r):i=Ba(e,n,i,r),this._root=function(t,e,n){return null===e?t:(null===t||((e=Ga(t.key,e,n)).left=t),e)}(i,s,r)},t.prototype.split=function(t){return Va(t,this._root,this._comparator)},t}();function ja(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ha(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ua(t,e,n){return e&&Ha(t.prototype,e),n&&Ha(t,n),t}var Wa=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},qa=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},Xa=Number.EPSILON;void 0===Xa&&(Xa=Math.pow(2,-52));var Ka=Xa*Xa,Ya=function(t,e){if(-Xa<t&&t<Xa&&-Xa<e&&e<Xa)return 0;var n=t-e;return n*n<Ka*t*e?0:t<e?-1:1},Za=function(){function t(){ja(this,t),this.reset()}return Ua(t,[{key:"reset",value:function(){this.xRounder=new Qa,this.yRounder=new Qa}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),Qa=function(){function t(){ja(this,t),this.tree=new za,this.round(0)}return Ua(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===Ya(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===Ya(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),t}(),Ja=new Za,$a=function(t,e){return t.x*e.y-t.y*e.x},tl=function(t,e){return t.x*e.x+t.y*e.y},el=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y},i=$a(r,o);return Ya(i,0)},nl=function(t){return Math.sqrt(tl(t,t))},rl=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},o={x:n.x-t.x,y:n.y-t.y};return tl(o,r)/nl(o)/nl(r)},ol=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},il=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},sl=function(){function t(e,n){ja(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return Ua(t,null,[{key:"compare",value:function(e,n){var r=t.comparePoints(e.point,n.point);return 0!==r?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:ll.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),Ua(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var o=e[n];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var o=this.point.events[r];void 0===o.consumedBy&&n.otherSE.point.events===o.otherSE.point.events&&n.segment.consume(o.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var o,i,s,a,l,u=r.otherSE;n.set(r,{sine:(o=e.point,i=t.point,s=u.point,a={x:i.x-o.x,y:i.y-o.y},l={x:s.x-o.x,y:s.y-o.y},$a(l,a)/nl(l)/nl(a)),cosine:rl(e.point,t.point,u.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var o=n.get(t),i=o.sine,s=o.cosine,a=n.get(e),l=a.sine,u=a.cosine;return i>=0&&l>=0?s<u?1:s>u?-1:0:i<0&&l<0?s<u?-1:s>u?1:0:l<i?-1:l>i?1:0}}}]),t}(),al=0,ll=function(){function t(e,n,r,o){ja(this,t),this.id=++al,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=o}return Ua(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,o=t.rightSE.point.x,i=e.rightSE.point.x;if(i<n)return 1;if(o<r)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<r){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var p=e.comparePoint(t.rightSE.point);return 0!==p?p:-1}if(n>r){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var h=e.comparePoint(t.leftSE.point);if(0!==h)return h;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(o<i){var f=e.comparePoint(t.rightSE.point);if(0!==f)return f}if(o>i){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(o!==i){var m=l-s,y=o-n,v=u-a,_=i-r;if(m>y&&v<_)return 1;if(m<y&&v>_)return-1}return o>i?1:o<i||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),Ua(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var o=(t.y-e.y)/r.y,i=e.x+o*r.x;if(t.x===i)return 0;var s=(t.x-e.x)/r.x,a=e.y+s*r.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=qa(e,n);if(null===r)return null;var o=this.leftSE.point,i=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=Wa(e,s)&&0===this.comparePoint(s),u=Wa(n,o)&&0===t.comparePoint(o),c=Wa(e,a)&&0===this.comparePoint(a),p=Wa(n,i)&&0===t.comparePoint(i);if(u&&l)return p&&!c?i:!p&&c?a:null;if(u)return c&&o.x===a.x&&o.y===a.y?null:o;if(l)return p&&i.x===s.x&&i.y===s.y?null:s;if(p&&c)return null;if(p)return i;if(c)return a;var h=function(t,e,n,r){if(0===e.x)return il(n,r,t.x);if(0===r.x)return il(t,e,n.x);if(0===e.y)return ol(n,r,t.y);if(0===r.y)return ol(t,e,n.y);var o=$a(e,r);if(0==o)return null;var i={x:n.x-t.x,y:n.y-t.y},s=$a(i,e)/o,a=$a(i,r)/o;return{x:(t.x+a*e.x+(n.x+s*r.x))/2,y:(t.y+a*e.y+(n.y+s*r.y))/2}}(o,this.vector(),s,t.vector());return null===h?null:Wa(r,h)?Ja.round(h.x,h.y):null}},{key:"split",value:function(e){var n=[],r=void 0!==e.events,o=new sl(e,!0),i=new sl(e,!1),s=this.rightSE;this.replaceRightSE(i),n.push(i),n.push(o);var a=new t(o,s,this.rings.slice(),this.windings.slice());return sl.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),sl.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(o.checkForConsuming(),i.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var n=this,r=e;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var o=t.compare(n,r);if(0!==o){if(o>0){var i=n;n=r,r=i}if(n.prev===r){var s=n;n=r,r=s}for(var a=0,l=r.rings.length;a<l;a++){var u=r.rings[a],c=r.windings[a],p=n.rings.indexOf(u);-1===p?(n.rings.push(u),n.windings.push(c)):n.windings[p]+=c}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,o=0,i=this.rings.length;o<i;o++){var s=this.rings[o],a=this.windings[o],l=e.indexOf(s);-1===l?(e.push(s),n.push(a)):n[l]+=a}for(var u=[],c=[],p=0,h=e.length;p<h;p++)if(0!==n[p]){var d=e[p],f=d.poly;if(-1===c.indexOf(f))if(d.isExterior)u.push(f);else{-1===c.indexOf(f)&&c.push(f);var g=u.indexOf(d.poly);-1!==g&&u.splice(g,1)}}for(var m=0,y=u.length;m<y;m++){var v=u[m].multiPoly;-1===r.indexOf(v)&&r.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(vl.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var o,i;t.length<e.length?(o=t.length,i=e.length):(o=e.length,i=t.length),this._isInResult=i===vl.numMultiPolys&&o<i;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(vl.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,r){var o,i,s,a=sl.comparePoints(e,n);if(a<0)o=e,i=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));o=n,i=e,s=-1}return new t(new sl(o,!0),new sl(i,!1),[r],[s])}}]),t}(),ul=function(){function t(e,n,r){if(ja(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=Ja.round(e[0][0],e[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var i=o,s=1,a=e.length;s<a;s++){if("number"!=typeof e[s][0]||"number"!=typeof e[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=Ja.round(e[s][0],e[s][1]);l.x===i.x&&l.y===i.y||(this.segments.push(ll.fromRing(i,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),i=l)}o.x===i.x&&o.y===i.y||this.segments.push(ll.fromRing(i,o,this))}return Ua(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),t}(),cl=function(){function t(e,n){if(ja(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ul(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,o=e.length;r<o;r++){var i=new ul(e[r],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=n}return Ua(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),o=0,i=r.length;o<i;o++)t.push(r[o]);return t}}]),t}(),pl=function(){function t(e,n){if(ja(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,o=e.length;r<o;r++){var i=new cl(e[r],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=n}return Ua(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),o=0,i=r.length;o<i;o++)t.push(r[o]);return t}}]),t}(),hl=function(){function t(e){ja(this,t),this.events=e;for(var n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}return Ua(t,null,[{key:"factory",value:function(e){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];if(i.isInResult()&&!i.ringOut){for(var s=null,a=i.leftSE,l=i.rightSE,u=[a],c=a.point,p=[];s=a,a=l,u.push(a),a.point!==c;)for(;;){var h=a.getAvailableLinkedEvents();if(0===h.length){var d=u[0].point,f=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(f.x,", ").concat(f.y,"]."))}if(1===h.length){l=h[0].otherSE;break}for(var g=null,m=0,y=p.length;m<y;m++)if(p[m].point===a.point){g=m;break}if(null===g){p.push({index:u.length,point:a.point});var v=a.getLeftmostComparator(s);l=h.sort(v)[0].otherSE;break}var _=p.splice(g)[0],w=u.splice(_.index);w.unshift(w[0].otherSE),n.push(new t(w.reverse()))}n.push(new t(u))}}return n}}]),Ua(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var o=this.events[n].point,i=this.events[n+1].point;0!==el(o,t,i)&&(e.push(o),t=o)}if(1===e.length)return null;var s=e[0],a=e[1];0===el(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,p=[],h=u;h!=c;h+=l)p.push([e[h].x,e[h].y]);return p}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];sl.compare(t,r)>0&&(t=r)}for(var o=t.segment.prevInResult(),i=o?o.prevInResult():null;;){if(!o)return null;if(!i)return o.ringOut;if(i.ringOut!==o.ringOut)return i.ringOut.enclosingRing()!==o.ringOut?o.ringOut:o.ringOut.enclosingRing();o=i.prevInResult(),i=o?o.prevInResult():null}}}]),t}(),dl=function(){function t(e){ja(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return Ua(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),t}(),fl=function(){function t(e){ja(this,t),this.rings=e,this.polys=this._composePolys(e)}return Ua(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];if(!o.poly)if(o.isExteriorRing())e.push(new dl(o));else{var i=o.enclosingRing();i.poly||e.push(new dl(i)),i.poly.addInterior(o)}}return e}}]),t}(),gl=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ll.compare;ja(this,t),this.queue=e,this.tree=new za(n),this.segments=[]}return Ua(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var o=r,i=r,s=void 0,a=void 0;void 0===s;)null===(o=this.tree.prev(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);for(;void 0===a;)null===(i=this.tree.next(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var c=this._splitSafely(s,u),p=0,h=c.length;p<h;p++)n.push(c[p])}var d=null;if(a){var f=a.getIntersection(e);if(null!==f&&(e.isAnEndpoint(f)||(d=f),!a.isAnEndpoint(f)))for(var g=this._splitSafely(a,f),m=0,y=g.length;m<y;m++)n.push(g[m])}if(null!==l||null!==d){var v=null;v=null===l?d:null===d||sl.comparePoints(l,d)<=0?l:d,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var _=e.split(v),w=0,C=_.length;w<C;w++)n.push(_[w])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var b=s.getIntersection(a);if(null!==b){if(!s.isAnEndpoint(b))for(var x=this._splitSafely(s,b),E=0,S=x.length;E<S;E++)n.push(x[E]);if(!a.isAnEndpoint(b))for(var T=this._splitSafely(a,b),R=0,P=T.length;R<P;R++)n.push(T[R])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),t}(),ml="undefined"!=typeof t&&Object({NODE_ENV:"production",PUBLIC_URL:"/food-security-project",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,yl="undefined"!=typeof t&&Object({NODE_ENV:"production",PUBLIC_URL:"/food-security-project",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,vl=new(function(){function t(){ja(this,t)}return Ua(t,[{key:"run",value:function(t,e,n){vl.type=t,Ja.reset();for(var r=[new pl(e,!0)],o=0,i=n.length;o<i;o++)r.push(new pl(n[o],!1));if(vl.numMultiPolys=r.length,"difference"===vl.type)for(var s=r[0],a=1;a<r.length;)null!==qa(r[a].bbox,s.bbox)?a++:r.splice(a,1);if("intersection"===vl.type)for(var l=0,u=r.length;l<u;l++)for(var c=r[l],p=l+1,h=r.length;p<h;p++)if(null===qa(c.bbox,r[p].bbox))return[];for(var d=new za(sl.compare),f=0,g=r.length;f<g;f++)for(var m=r[f].getSweepEvents(),y=0,v=m.length;y<v;y++)if(d.insert(m[y]),d.size>ml)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var _=new gl(d),w=d.size,C=d.pop();C;){var b=C.key;if(d.size===w){var x=b.segment;throw new Error("Unable to pop() ".concat(b.isLeft?"left":"right"," SweepEvent ")+"[".concat(b.point.x,", ").concat(b.point.y,"] from segment #").concat(x.id," ")+"[".concat(x.leftSE.point.x,", ").concat(x.leftSE.point.y,"] -> ")+"[".concat(x.rightSE.point.x,", ").concat(x.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>ml)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(_.segments.length>yl)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var E=_.process(b),S=0,T=E.length;S<T;S++){var R=E[S];void 0===R.consumedBy&&d.insert(R)}w=d.size,C=d.pop()}Ja.reset();var P=hl.factory(_.segments);return new fl(P).getGeom()}}]),t}()),_l={union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return vl.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return vl.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return vl.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return vl.run("difference",t,n)}};"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var o=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(o=o<0?Math.max(n+arguments[2],0):Math.min(o,n);r<o;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var wl=function(){};wl.prototype.interfaces_=function(){return[]},wl.prototype.getClass=function(){return wl},wl.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var Cl=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),bl=function(){},xl={MAX_VALUE:{configurable:!0}};bl.isNaN=function(t){return Number.isNaN(t)},bl.doubleToLongBits=function(t){return t},bl.longBitsToDouble=function(t){return t},bl.isInfinite=function(t){return!Number.isFinite(t)},xl.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(bl,xl);var El=function(){},Sl=function(){},Tl=function(){};function Rl(){}var Pl=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Ol={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Pl.prototype.setOrdinate=function(t,e){switch(t){case Pl.X:this.x=e;break;case Pl.Y:this.y=e;break;case Pl.Z:this.z=e;break;default:throw new Cl("Invalid ordinate index: "+t)}},Pl.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!wl.equalsWithTolerance(this.x,e.x,n)&&!!wl.equalsWithTolerance(this.y,e.y,n)}},Pl.prototype.getOrdinate=function(t){switch(t){case Pl.X:return this.x;case Pl.Y:return this.y;case Pl.Z:return this.z}throw new Cl("Invalid ordinate index: "+t)},Pl.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||bl.isNaN(this.z))&&bl.isNaN(t.z)},Pl.prototype.equals=function(t){return t instanceof Pl&&this.equals2D(t)},Pl.prototype.equalInZ=function(t,e){return wl.equalsWithTolerance(this.z,t.z,e)},Pl.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},Pl.prototype.clone=function(){},Pl.prototype.copy=function(){return new Pl(this)},Pl.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Pl.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)},Pl.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},Pl.prototype.hashCode=function(){var t=17;return 37*(t=37*t+Pl.hashCode(this.x))+Pl.hashCode(this.y)},Pl.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},Pl.prototype.interfaces_=function(){return[El,Sl,Rl]},Pl.prototype.getClass=function(){return Pl},Pl.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=bl.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},Ol.DimensionalComparator.get=function(){return Il},Ol.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},Ol.NULL_ORDINATE.get=function(){return bl.NaN},Ol.X.get=function(){return 0},Ol.Y.get=function(){return 1},Ol.Z.get=function(){return 2},Object.defineProperties(Pl,Ol);var Il=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new Cl("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};Il.prototype.compare=function(t,e){var n=t,r=e,o=Il.compare(n.x,r.x);if(0!==o)return o;var i=Il.compare(n.y,r.y);return 0!==i?i:this._dimensionsToTest<=2?0:Il.compare(n.z,r.z)},Il.prototype.interfaces_=function(){return[Tl]},Il.prototype.getClass=function(){return Il},Il.compare=function(t,e){return t<e?-1:t>e?1:bl.isNaN(t)?bl.isNaN(e)?0:-1:bl.isNaN(e)?1:0};var Al=function(){};Al.prototype.create=function(){},Al.prototype.interfaces_=function(){return[]},Al.prototype.getClass=function(){return Al};var Dl=function(){},Ml={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Dl.prototype.interfaces_=function(){return[]},Dl.prototype.getClass=function(){return Dl},Dl.toLocationSymbol=function(t){switch(t){case Dl.EXTERIOR:return"e";case Dl.BOUNDARY:return"b";case Dl.INTERIOR:return"i";case Dl.NONE:return"-"}throw new Cl("Unknown location value: "+t)},Ml.INTERIOR.get=function(){return 0},Ml.BOUNDARY.get=function(){return 1},Ml.EXTERIOR.get=function(){return 2},Ml.NONE.get=function(){return-1},Object.defineProperties(Dl,Ml);var Ll=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},Nl=function(){},Fl={LOG_10:{configurable:!0}};Nl.prototype.interfaces_=function(){return[]},Nl.prototype.getClass=function(){return Nl},Nl.log10=function(t){var e=Math.log(t);return bl.isInfinite(e)||bl.isNaN(e)?e:e/Nl.LOG_10},Nl.min=function(t,e,n,r){var o=t;return e<o&&(o=e),n<o&&(o=n),r<o&&(o=r),o},Nl.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1],i=arguments[2];return r<o?o:r>i?i:r}},Nl.wrap=function(t,e){return t<0?e- -t%e:t%e},Nl.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=t;return e>r&&(r=e),n>r&&(r=n),r}if(4===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3],l=o;return i>l&&(l=i),s>l&&(l=s),a>l&&(l=a),l}},Nl.average=function(t,e){return(t+e)/2},Fl.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Nl,Fl);var kl=function(t){this.str=t};kl.prototype.append=function(t){this.str+=t},kl.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},kl.prototype.toString=function(t){return this.str};var Gl=function(t){this.value=t};Gl.prototype.intValue=function(){return this.value},Gl.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},Gl.isNaN=function(t){return Number.isNaN(t)};var Bl=function(){};Bl.isWhitespace=function(t){return t<=32&&t>=0||127===t},Bl.toUpperCase=function(t){return t.toUpperCase()};var Vl=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var r=arguments[0];t.call(this,t.parse(r))}}else if(2===arguments.length){var o=arguments[0],i=arguments[1];this.init(o,i)}},zl={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Vl.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},Vl.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=Vl.magnitude(n._hi),o=Vl.TEN.pow(r);(n=n.divide(o)).gt(Vl.TEN)?(n=n.divide(Vl.TEN),r+=1):n.lt(Vl.ONE)&&(n=n.multiply(Vl.TEN),r-=1);for(var i=r+1,s=new kl,a=Vl.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===i&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,p=0;u>9?(c=!0,p="9"):p="0"+u,s.append(p),n=n.subtract(Vl.valueOf(u)).multiply(Vl.TEN),c&&n.selfAdd(Vl.TEN);var h=!0,d=Vl.magnitude(n._hi);if(d<0&&Math.abs(d)>=a-l&&(h=!1),!h)break}return e[0]=r,s.toString()},Vl.prototype.sqr=function(){return this.multiply(this)},Vl.prototype.doubleValue=function(){return this._hi+this._lo},Vl.prototype.subtract=function(){if(arguments[0]instanceof Vl){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},Vl.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},Vl.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Vl.prototype.selfSubtract=function(){if(arguments[0]instanceof Vl){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},Vl.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Vl.prototype.min=function(t){return this.le(t)?this:t},Vl.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Vl){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],o=null,i=null,s=null,a=null,l=null,u=null,c=null,p=null;return l=this._hi/n,p=(o=(u=Vl.SPLIT*l)-(o=u-l))*(s=(p=Vl.SPLIT*n)-(s=p-n))-(c=l*n)+o*(a=n-s)+(i=l-o)*s+i*a,p=l+(u=(this._hi-c-p+this._lo-l*r)/n),this._hi=p,this._lo=l-p+u,this}},Vl.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Vl.prototype.divide=function(){if(arguments[0]instanceof Vl){var t=arguments[0],e=null,n=null,r=null,o=null,i=null,s=null,a=null,l=null;n=(i=this._hi/t._hi)-(e=(s=Vl.SPLIT*i)-(e=s-i)),l=e*(r=(l=Vl.SPLIT*t._hi)-(r=l-t._hi))-(a=i*t._hi)+e*(o=t._hi-r)+n*r+n*o;var u=l=i+(s=(this._hi-a-l+this._lo-i*t._lo)/t._hi),c=i-l+s;return new Vl(u,c)}if("number"==typeof arguments[0]){var p=arguments[0];return bl.isNaN(p)?Vl.createNaN():Vl.copy(this).selfDivide(p,0)}},Vl.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},Vl.prototype.pow=function(t){if(0===t)return Vl.valueOf(1);var e=new Vl(this),n=Vl.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},Vl.prototype.ceil=function(){if(this.isNaN())return Vl.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Vl(t,e)},Vl.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},Vl.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Vl.prototype.setValue=function(){if(arguments[0]instanceof Vl){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},Vl.prototype.max=function(t){return this.ge(t)?this:t},Vl.prototype.sqrt=function(){if(this.isZero())return Vl.valueOf(0);if(this.isNegative())return Vl.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=Vl.valueOf(e),r=this.subtract(n.sqr())._hi*(.5*t);return n.add(r)},Vl.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Vl){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,r=null,o=null,i=null,s=null,a=null;return i=(o=this._hi+e)-(s=o-this._hi),r=(a=(i=e-s+(this._hi-i))+this._lo)+(o-(n=o+a)),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,p=null,h=null,d=null,f=null,g=null,m=null;d=this._hi+l,p=this._lo+u,f=d-(g=d-this._hi),h=p-(m=p-this._lo);var y=(c=d+(g=(f=l-g+(this._hi-f))+p))+(g=(h=u-m+(this._lo-h))+(g+(d-c))),v=g+(c-y);return this._hi=y,this._lo=v,this}},Vl.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Vl){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],o=null,i=null,s=null,a=null,l=null,u=null;o=(l=Vl.SPLIT*this._hi)-this._hi,u=Vl.SPLIT*n,o=l-o,i=this._hi-o,s=u-n;var c=(l=this._hi*n)+(u=o*(s=u-s)-l+o*(a=n-s)+i*s+i*a+(this._hi*r+this._lo*n)),p=u+(o=l-c);return this._hi=c,this._lo=p,this}},Vl.prototype.selfSqr=function(){return this.selfMultiply(this)},Vl.prototype.floor=function(){if(this.isNaN())return Vl.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Vl(t,e)},Vl.prototype.negate=function(){return this.isNaN()?this:new Vl(-this._hi,-this._lo)},Vl.prototype.clone=function(){},Vl.prototype.multiply=function(){if(arguments[0]instanceof Vl){var t=arguments[0];return t.isNaN()?Vl.createNaN():Vl.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return bl.isNaN(e)?Vl.createNaN():Vl.copy(this).selfMultiply(e,0)}},Vl.prototype.isNaN=function(){return bl.isNaN(this._hi)},Vl.prototype.intValue=function(){return Math.trunc(this._hi)},Vl.prototype.toString=function(){var t=Vl.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},Vl.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,o=n;if("."===n.charAt(0))o="0"+n;else if(r<0)o="0."+Vl.stringOfChar("0",-r)+n;else if(-1===n.indexOf(".")){var i=r-n.length;o=n+Vl.stringOfChar("0",i)+".0"}return this.isNegative()?"-"+o:o},Vl.prototype.reciprocal=function(){var t,e,n,r,o=null,i=null,s=null,a=null;t=(n=1/this._hi)-(o=(s=Vl.SPLIT*n)-(o=s-n)),i=(a=Vl.SPLIT*this._hi)-this._hi;var l=n+(s=(1-(r=n*this._hi)-(a=o*(i=a-i)-r+o*(e=this._hi-i)+t*i+t*e)-n*this._lo)/this._hi);return new Vl(l,n-l+s)},Vl.prototype.toSciNotation=function(){if(this.isZero())return Vl.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=Vl.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var o="";n.length>1&&(o=n.substring(1));var i=n.charAt(0)+"."+o;return this.isNegative()?"-"+i+r:i+r},Vl.prototype.abs=function(){return this.isNaN()?Vl.NaN:this.isNegative()?this.negate():new Vl(this)},Vl.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Vl.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},Vl.prototype.add=function(){if(arguments[0]instanceof Vl){var t=arguments[0];return Vl.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return Vl.copy(this).selfAdd(e)}},Vl.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Vl){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}},Vl.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},Vl.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Vl.prototype.trunc=function(){return this.isNaN()?Vl.NaN:this.isPositive()?this.floor():this.ceil()},Vl.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Vl.prototype.interfaces_=function(){return[Rl,El,Sl]},Vl.prototype.getClass=function(){return Vl},Vl.sqr=function(t){return Vl.valueOf(t).selfMultiply(t)},Vl.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return Vl.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new Vl(e)}},Vl.sqrt=function(t){return Vl.valueOf(t).sqrt()},Vl.parse=function(t){for(var e=0,n=t.length;Bl.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var o=t.charAt(e);"-"!==o&&"+"!==o||(e++,"-"===o&&(r=!0))}for(var i=new Vl,s=0,a=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,Bl.isDigit(u)){var c=u-"0";i.selfMultiply(Vl.TEN),i.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var p=t.substring(e);try{l=Gl.parseInt(p)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+p+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var h=i,d=s-a-l;if(0===d)h=i;else if(d>0){var f=Vl.TEN.pow(d);h=i.divide(f)}else if(d<0){var g=Vl.TEN.pow(-d);h=i.multiply(g)}return r?h.negate():h},Vl.createNaN=function(){return new Vl(bl.NaN,bl.NaN)},Vl.copy=function(t){return new Vl(t)},Vl.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r},Vl.stringOfChar=function(t,e){for(var n=new kl,r=0;r<e;r++)n.append(t);return n.toString()},zl.PI.get=function(){return new Vl(3.141592653589793,12246467991473532e-32)},zl.TWO_PI.get=function(){return new Vl(6.283185307179586,24492935982947064e-32)},zl.PI_2.get=function(){return new Vl(1.5707963267948966,6123233995736766e-32)},zl.E.get=function(){return new Vl(2.718281828459045,14456468917292502e-32)},zl.NaN.get=function(){return new Vl(bl.NaN,bl.NaN)},zl.EPS.get=function(){return 123259516440783e-46},zl.SPLIT.get=function(){return 134217729},zl.MAX_PRINT_DIGITS.get=function(){return 32},zl.TEN.get=function(){return Vl.valueOf(10)},zl.ONE.get=function(){return Vl.valueOf(1)},zl.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},zl.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Vl,zl);var jl=function(){},Hl={DP_SAFE_EPSILON:{configurable:!0}};jl.prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl},jl.orientationIndex=function(t,e,n){var r=jl.orientationIndexFilter(t,e,n);if(r<=1)return r;var o=Vl.valueOf(e.x).selfAdd(-t.x),i=Vl.valueOf(e.y).selfAdd(-t.y),s=Vl.valueOf(n.x).selfAdd(-e.x),a=Vl.valueOf(n.y).selfAdd(-e.y);return o.selfMultiply(a).selfSubtract(i.selfMultiply(s)).signum()},jl.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},jl.intersection=function(t,e,n,r){var o=Vl.valueOf(r.y).selfSubtract(n.y).selfMultiply(Vl.valueOf(e.x).selfSubtract(t.x)),i=Vl.valueOf(r.x).selfSubtract(n.x).selfMultiply(Vl.valueOf(e.y).selfSubtract(t.y)),s=o.subtract(i),a=Vl.valueOf(r.x).selfSubtract(n.x).selfMultiply(Vl.valueOf(t.y).selfSubtract(n.y)),l=Vl.valueOf(r.y).selfSubtract(n.y).selfMultiply(Vl.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=Vl.valueOf(t.x).selfAdd(Vl.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),p=Vl.valueOf(e.x).selfSubtract(t.x).selfMultiply(Vl.valueOf(t.y).selfSubtract(n.y)),h=Vl.valueOf(e.y).selfSubtract(t.y).selfMultiply(Vl.valueOf(t.x).selfSubtract(n.x)),d=p.subtract(h).selfDivide(s).doubleValue(),f=Vl.valueOf(n.y).selfAdd(Vl.valueOf(r.y).selfSubtract(n.y).selfMultiply(d)).doubleValue();return new Pl(c,f)},jl.orientationIndexFilter=function(t,e,n){var r=null,o=(t.x-n.x)*(e.y-n.y),i=(t.y-n.y)*(e.x-n.x),s=o-i;if(o>0){if(i<=0)return jl.signum(s);r=o+i}else{if(!(o<0))return jl.signum(s);if(i>=0)return jl.signum(s);r=-o-i}var a=jl.DP_SAFE_EPSILON*r;return s>=a||-s>=a?jl.signum(s):2},jl.signum=function(t){return t>0?1:t<0?-1:0},Hl.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(jl,Hl);var Ul=function(){},Wl={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Wl.X.get=function(){return 0},Wl.Y.get=function(){return 1},Wl.Z.get=function(){return 2},Wl.M.get=function(){return 3},Ul.prototype.setOrdinate=function(t,e,n){},Ul.prototype.size=function(){},Ul.prototype.getOrdinate=function(t,e){},Ul.prototype.getCoordinate=function(){},Ul.prototype.getCoordinateCopy=function(t){},Ul.prototype.getDimension=function(){},Ul.prototype.getX=function(t){},Ul.prototype.clone=function(){},Ul.prototype.expandEnvelope=function(t){},Ul.prototype.copy=function(){},Ul.prototype.getY=function(t){},Ul.prototype.toCoordinateArray=function(){},Ul.prototype.interfaces_=function(){return[Sl]},Ul.prototype.getClass=function(){return Ul},Object.defineProperties(Ul,Wl);var ql=function(){},Xl=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ql),Kl=function(){};Kl.arraycopy=function(t,e,n,r,o){for(var i=0,s=e;s<e+o;s++)n[r+i]=t[s],i++},Kl.getProperty=function(t){return{"line.separator":"\n"}[t]};var Yl=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var o=arguments[0],i=arguments[1];this.x=o.y*i.w-i.y*o.w,this.y=i.x*o.w-o.x*i.w,this.w=o.x*i.y-i.x*o.y}else if(arguments[0]instanceof Pl&&arguments[1]instanceof Pl){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var p=arguments[0],h=arguments[1],d=arguments[2],f=arguments[3],g=p.y-h.y,m=h.x-p.x,y=p.x*h.y-h.x*p.y,v=d.y-f.y,_=f.x-d.x,w=d.x*f.y-f.x*d.y;this.x=m*w-_*y,this.y=v*y-g*w,this.w=g*_-v*m}};Yl.prototype.getY=function(){var t=this.y/this.w;if(bl.isNaN(t)||bl.isInfinite(t))throw new Xl;return t},Yl.prototype.getX=function(){var t=this.x/this.w;if(bl.isNaN(t)||bl.isInfinite(t))throw new Xl;return t},Yl.prototype.getCoordinate=function(){var t=new Pl;return t.x=this.getX(),t.y=this.getY(),t},Yl.prototype.interfaces_=function(){return[]},Yl.prototype.getClass=function(){return Yl},Yl.intersection=function(t,e,n,r){var o=t.y-e.y,i=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-r.y,l=r.x-n.x,u=n.x*r.y-r.x*n.y,c=o*l-a*i,p=(i*u-l*s)/c,h=(a*s-o*u)/c;if(bl.isNaN(p)||bl.isInfinite(p)||bl.isNaN(h)||bl.isInfinite(h))throw new Xl;return new Pl(p,h)};var Zl=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof Pl){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(4===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(i,s,a,l)}},Ql={serialVersionUID:{configurable:!0}};Zl.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Zl.prototype.equals=function(t){if(!(t instanceof Zl))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Zl.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Zl;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,o=this._maxy<t._maxy?this._maxy:t._maxy;return new Zl(e,r,n,o)},Zl.prototype.isNull=function(){return this._maxx<this._minx},Zl.prototype.getMaxX=function(){return this._maxx},Zl.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof Pl){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Zl){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}},Zl.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Zl){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof Pl){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||r>this._maxy||r<this._miny)}},Zl.prototype.getMinY=function(){return this._miny},Zl.prototype.getMinX=function(){return this._minx},Zl.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof Pl){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Zl){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}},Zl.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Zl.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Zl.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Zl.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Zl.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Zl.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Zl.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Zl.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},Zl.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Zl.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Zl){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof Pl){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.covers(n,r)}},Zl.prototype.centre=function(){return this.isNull()?null:new Pl((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Zl.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof Pl){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Zl){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3];o<i?(this._minx=o,this._maxx=i):(this._minx=i,this._maxx=o),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},Zl.prototype.getMaxY=function(){return this._maxy},Zl.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},Zl.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+Pl.hashCode(this._minx))+Pl.hashCode(this._maxx))+Pl.hashCode(this._miny))+Pl.hashCode(this._maxy)},Zl.prototype.interfaces_=function(){return[El,Rl]},Zl.prototype.getClass=function(){return Zl},Zl.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2],s=arguments[3],a=Math.min(i.x,s.x),l=Math.max(i.x,s.x),u=Math.min(r.x,o.x),c=Math.max(r.x,o.x);return!(u>l)&&!(c<a)&&(a=Math.min(i.y,s.y),l=Math.max(i.y,s.y),u=Math.min(r.y,o.y),c=Math.max(r.y,o.y),!(u>l)&&!(c<a))}},Ql.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Zl,Ql);var Jl={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},$l=function(t){this.geometryFactory=t||new Gc};$l.prototype.read=function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var o=Jl.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((o=Jl.emptyTypeStr.exec(t))[2]=void 0),o&&(n=o[1].toLowerCase(),r=o[2],eu[n]&&(e=eu[n].apply(this,[r]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},$l.prototype.write=function(t){return this.extractGeometry(t)},$l.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!tu[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+tu[e].apply(this,[t])+")"};var tu={coordinate:function(t){return t.x+" "+t.y},point:function(t){return tu.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+tu.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(tu.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(tu.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+tu.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+tu.linestring.apply(this,[t._shell])+")");for(var n=0,r=t._holes.length;n<r;++n)e.push("("+tu.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+tu.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},eu={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Jl.spaces);return this.geometryFactory.createPoint(new Pl(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPoint();for(var n=t.trim().split(","),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(Jl.trimParens,"$1"),r.push(eu.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],o=0,i=n.length;o<i;++o)e=n[o].trim().split(Jl.spaces),r.push(new Pl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],o=0,i=n.length;o<i;++o)e=n[o].trim().split(Jl.spaces),r.push(new Pl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiLineString();for(var n=t.trim().split(Jl.parenComma),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(Jl.trimParens,"$1"),r.push(eu.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){var e,n,r;if(void 0===t)return this.geometryFactory.createPolygon();for(var o,i=t.trim().split(Jl.parenComma),s=[],a=0,l=i.length;a<l;++a)e=i[a].replace(Jl.trimParens,"$1"),n=eu.linestring.apply(this,[e]),r=this.geometryFactory.createLinearRing(n._points),0===a?o=r:s.push(r);return this.geometryFactory.createPolygon(o,s)},multipolygon:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var n=t.trim().split(Jl.doubleParenComma),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(Jl.trimParens,"$1"),r.push(eu.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,o=e.length;r<o;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}},nu=function(t){this.parser=new $l(t)};nu.prototype.write=function(t){return this.parser.write(t)},nu.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var ru=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),ou=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ru),iu=function(){};iu.prototype.interfaces_=function(){return[]},iu.prototype.getClass=function(){return iu},iu.shouldNeverReachHere=function(){if(0===arguments.length)iu.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new ou("Should never reach here"+(null!==t?": "+t:""))}},iu.isTrue=function(){var t;if(1===arguments.length)iu.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new ou:new ou(t)},iu.equals=function(){var t,e,n;if(2===arguments.length)iu.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new ou("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var su=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Pl,this._intPt[1]=new Pl,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},au={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};su.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},su.prototype.getTopologySummary=function(){var t=new kl;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},su.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)},su.prototype.getIntersectionNum=function(){return this._result},su.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},su.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},su.prototype.setPrecisionModel=function(t){this._precisionModel=t},su.prototype.isInteriorIntersection=function(){var t=this;if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],n=0;n<this._result;n++)if(!t._intPt[n].equals2D(t._inputLines[e][0])&&!t._intPt[n].equals2D(t._inputLines[e][1]))return!0;return!1}},su.prototype.getIntersection=function(t){return this._intPt[t]},su.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},su.prototype.hasIntersection=function(){return this._result!==su.NO_INTERSECTION},su.prototype.getEdgeDistance=function(t,e){return su.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},su.prototype.isCollinear=function(){return this._result===su.COLLINEAR_INTERSECTION},su.prototype.toString=function(){return nu.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+nu.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},su.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},su.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},su.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},su.prototype.interfaces_=function(){return[]},su.prototype.getClass=function(){return su},su.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),i=-1;if(t.equals(e))i=0;else if(t.equals(n))i=r>o?r:o;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(i=r>o?s:a)||t.equals(e)||(i=Math.max(s,a))}return iu.isTrue(!(0===i&&!t.equals(e)),"Bad distance calculation"),i},su.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,o=t.y-e.y,i=Math.sqrt(r*r+o*o);return iu.isTrue(!(0===i&&!t.equals(e)),"Invalid distance calculation"),i},au.DONT_INTERSECT.get=function(){return 0},au.DO_INTERSECT.get=function(){return 1},au.COLLINEAR.get=function(){return 2},au.NO_INTERSECTION.get=function(){return 0},au.POINT_INTERSECTION.get=function(){return 1},au.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(su,au);var lu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new Zl(this._inputLines[0][0],this._inputLines[0][1]),n=new Zl(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,Zl.intersects(n,r,e)&&0===pu.orientationIndex(n,r,e)&&0===pu.orientationIndex(r,n,e))return this._isProper=!0,(e.equals(n)||e.equals(r))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,r,o){o.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),o.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=o.x,t.y-=o.y,e.x-=o.x,e.y-=o.y,n.x-=o.x,n.y-=o.y,r.x-=o.x,r.y-=o.y},e.prototype.safeHCoordinateIntersection=function(t,n,r,o){var i=null;try{i=Yl.intersection(t,n,r,o)}catch(a){if(!(a instanceof Xl))throw a;i=e.nearestEndpoint(t,n,r,o)}return i},e.prototype.intersection=function(t,n,r,o){var i=this.intersectionWithNormalization(t,n,r,o);return this.isInSegmentEnvelopes(i)||(i=new Pl(e.nearestEndpoint(t,n,r,o))),null!==this._precisionModel&&this._precisionModel.makePrecise(i),i},e.prototype.smallestInAbsValue=function(t,e,n,r){var o=t,i=Math.abs(o);return Math.abs(e)<i&&(o=e,i=Math.abs(e)),Math.abs(n)<i&&(o=n,i=Math.abs(n)),Math.abs(r)<i&&(o=r),o},e.prototype.checkDD=function(t,e,n,r,o){var i=jl.intersection(t,e,n,r),s=this.isInSegmentEnvelopes(i);Kl.out.println("DD in env = "+s+"  --------------------- "+i),o.distance(i)>1e-4&&Kl.out.println("Distance = "+o.distance(i))},e.prototype.intersectionWithNormalization=function(t,e,n,r){var o=new Pl(t),i=new Pl(e),s=new Pl(n),a=new Pl(r),l=new Pl;this.normalizeToEnvCentre(o,i,s,a,l);var u=this.safeHCoordinateIntersection(o,i,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,r,o){var i=Zl.intersects(e,n,r),s=Zl.intersects(e,n,o),a=Zl.intersects(r,o,e),l=Zl.intersects(r,o,n);return i&&s?(this._intPt[0]=r,this._intPt[1]=o,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):i&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):i&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=o,this._intPt[1]=e,!o.equals(e)||i||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=o,this._intPt[1]=n,!o.equals(n)||i||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,r,o){var i=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<r.x?n.x:r.x,c=n.y<r.y?n.y:r.y,p=n.x>r.x?n.x:r.x,h=n.y>r.y?n.y:r.y,d=((i>u?i:u)+(a<p?a:p))/2,f=((s>c?s:c)+(l<h?l:h))/2;o.x=d,o.y=f,t.x-=o.x,t.y-=o.y,e.x-=o.x,e.y-=o.y,n.x-=o.x,n.y-=o.y,r.x-=o.x,r.y-=o.y},e.prototype.computeIntersect=function(e,n,r,o){if(this._isProper=!1,!Zl.intersects(e,n,r,o))return t.NO_INTERSECTION;var i=pu.orientationIndex(e,n,r),s=pu.orientationIndex(e,n,o);if(i>0&&s>0||i<0&&s<0)return t.NO_INTERSECTION;var a=pu.orientationIndex(r,o,e),l=pu.orientationIndex(r,o,n);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===i&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,n,r,o):(0===i||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(r)||e.equals2D(o)?this._intPt[0]=e:n.equals2D(r)||n.equals2D(o)?this._intPt[0]=n:0===i?this._intPt[0]=new Pl(r):0===s?this._intPt[0]=new Pl(o):0===a?this._intPt[0]=new Pl(e):0===l&&(this._intPt[0]=new Pl(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,r,o)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,r){var o=t,i=pu.distancePointLine(t,n,r),s=pu.distancePointLine(e,n,r);return s<i&&(i=s,o=e),(s=pu.distancePointLine(n,t,e))<i&&(i=s,o=n),(s=pu.distancePointLine(r,t,e))<i&&(i=s,o=r),o},e}(su),uu=function(){};uu.prototype.interfaces_=function(){return[]},uu.prototype.getClass=function(){return uu},uu.orientationIndex=function(t,e,n){var r=e.x-t.x,o=e.y-t.y,i=n.x-e.x,s=n.y-e.y;return uu.signOfDet2x2(r,o,i,s)},uu.signOfDet2x2=function(t,e,n,r){var o=null,i=null,s=null;if(o=1,0===t||0===r)return 0===e||0===n?0:e>0?n>0?-o:o:n>0?o:-o;if(0===e||0===n)return r>0?t>0?o:-o:t>0?-o:o;if(e>0?r>0?e<=r||(o=-o,i=t,t=n,n=i,i=e,e=r,r=i):e<=-r?(o=-o,n=-n,r=-r):(i=t,t=-n,n=i,i=e,e=-r,r=i):r>0?-e<=r?(o=-o,t=-t,e=-e):(i=-t,t=n,n=i,i=-e,e=r,r=i):e>=r?(t=-t,e=-e,n=-n,r=-r):(o=-o,i=-t,t=-n,n=i,i=-e,e=-r,r=i),t>0){if(!(n>0))return o;if(!(t<=n))return o}else{if(n>0)return-o;if(!(t>=n))return-o;o=-o,t=-t,n=-n}for(;;){if((r-=(s=Math.floor(n/t))*e)<0)return-o;if(r>e)return o;if(t>(n-=s*t)+n){if(e<r+r)return o}else{if(e>r+r)return-o;n=t-n,r=e-r,o=-o}if(0===r)return 0===n?0:-o;if(0===n)return o;if((e-=(s=Math.floor(t/n))*r)<0)return o;if(e>r)return-o;if(n>(t-=s*n)+t){if(r<e+e)return-o}else{if(r>e+e)return o;t=n-t,e=r-e,o=-o}if(0===e)return 0===t?0:o;if(0===t)return-o}};var cu=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};cu.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var o=t.x-this._p.x,i=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=uu.signOfDet2x2(o,i,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<i&&(l=-l),l>0&&this._crossingCount++}},cu.prototype.isPointInPolygon=function(){return this.getLocation()!==Dl.EXTERIOR},cu.prototype.getLocation=function(){return this._isPointOnSegment?Dl.BOUNDARY:this._crossingCount%2==1?Dl.INTERIOR:Dl.EXTERIOR},cu.prototype.isOnSegment=function(){return this._isPointOnSegment},cu.prototype.interfaces_=function(){return[]},cu.prototype.getClass=function(){return cu},cu.locatePointInRing=function(){if(arguments[0]instanceof Pl&&Ll(arguments[1],Ul)){for(var t=arguments[0],e=arguments[1],n=new cu(t),r=new Pl,o=new Pl,i=1;i<e.size();i++)if(e.getCoordinate(i,r),e.getCoordinate(i-1,o),n.countSegment(r,o),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof Pl&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],l=new cu(s),u=1;u<a.length;u++){var c=a[u],p=a[u-1];if(l.countSegment(c,p),l.isOnSegment())return l.getLocation()}return l.getLocation()}};var pu=function(){},hu={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};pu.prototype.interfaces_=function(){return[]},pu.prototype.getClass=function(){return pu},pu.orientationIndex=function(t,e,n){return jl.orientationIndex(t,e,n)},pu.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var o=t[r].x-n,i=t[r+1].y,s=t[r-1].y;e+=o*(s-i)}return e/2}if(Ll(arguments[0],Ul)){var a=arguments[0],l=a.size();if(l<3)return 0;var u=new Pl,c=new Pl,p=new Pl;a.getCoordinate(0,c),a.getCoordinate(1,p);var h=c.x;p.x-=h;for(var d=0,f=1;f<l-1;f++)u.y=c.y,c.x=p.x,c.y=p.y,a.getCoordinate(f+1,p),p.x-=h,d+=c.x*(u.y-p.y);return d/2}},pu.distanceLineLine=function(t,e,n,r){if(t.equals(e))return pu.distancePointLine(t,n,r);if(n.equals(r))return pu.distancePointLine(r,t,e);var o=!1;if(Zl.intersects(t,e,n,r)){var i=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(0===i)o=!0;else{var s=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/i,l=s/i;(l<0||l>1||a<0||a>1)&&(o=!0)}}else o=!0;return o?Nl.min(pu.distancePointLine(t,n,r),pu.distancePointLine(e,n,r),pu.distancePointLine(n,t,e),pu.distancePointLine(r,t,e)):0},pu.isPointInRing=function(t,e){return pu.locatePointInRing(t,e)!==Dl.EXTERIOR},pu.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new Pl;t.getCoordinate(0,r);for(var o=r.x,i=r.y,s=1;s<e;s++){t.getCoordinate(s,r);var a=r.x,l=r.y,u=a-o,c=l-i;n+=Math.sqrt(u*u+c*c),o=a,i=l}return n},pu.isCCW=function(t){var e=t.length-1;if(e<3)throw new Cl("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,o=1;o<=e;o++){var i=t[o];i.y>n.y&&(n=i,r=o)}var s=r;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==r);var a=r;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==r);var l=t[s],u=t[a];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=pu.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},pu.locatePointInRing=function(t,e){return cu.locatePointInRing(t,e)},pu.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),o=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(o)*Math.sqrt(r)},pu.computeOrientation=function(t,e,n){return pu.orientationIndex(t,e,n)},pu.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new Cl("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var o=pu.distancePointLine(t,e[r],e[r+1]);o<n&&(n=o)}return n}if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return i.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((i.x-s.x)*(a.x-s.x)+(i.y-s.y)*(a.y-s.y))/l;if(u<=0)return i.distance(s);if(u>=1)return i.distance(a);var c=((s.y-i.y)*(a.x-s.x)-(s.x-i.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},pu.isOnLine=function(t,e){for(var n=new lu,r=1;r<e.length;r++){var o=e[r-1],i=e[r];if(n.computeIntersection(t,o,i),n.hasIntersection())return!0}return!1},hu.CLOCKWISE.get=function(){return-1},hu.RIGHT.get=function(){return pu.CLOCKWISE},hu.COUNTERCLOCKWISE.get=function(){return 1},hu.LEFT.get=function(){return pu.COUNTERCLOCKWISE},hu.COLLINEAR.get=function(){return 0},hu.STRAIGHT.get=function(){return pu.COLLINEAR},Object.defineProperties(pu,hu);var du=function(){};du.prototype.filter=function(t){},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var fu=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},gu={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};fu.prototype.isGeometryCollection=function(){return this.getSortIndex()===fu.SORTINDEX_GEOMETRYCOLLECTION},fu.prototype.getFactory=function(){return this._factory},fu.prototype.getGeometryN=function(t){return this},fu.prototype.getArea=function(){return 0},fu.prototype.isRectangle=function(){return!1},fu.prototype.equals=function(){if(arguments[0]instanceof fu){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof fu))return!1;var n=e;return this.equalsExact(n)}},fu.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},fu.prototype.geometryChanged=function(){this.apply(fu.geometryChangedFilter)},fu.prototype.geometryChangedAction=function(){this._envelope=null},fu.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},fu.prototype.getLength=function(){return 0},fu.prototype.getNumGeometries=function(){return 1},fu.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,r)}},fu.prototype.getUserData=function(){return this._userData},fu.prototype.getSRID=function(){return this._SRID},fu.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},fu.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===fu.SORTINDEX_GEOMETRYCOLLECTION)throw new Cl("This method does not support GeometryCollection arguments")},fu.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},fu.prototype.norm=function(){var t=this.copy();return t.normalize(),t},fu.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},fu.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Zl(this._envelope)},fu.prototype.setSRID=function(t){this._SRID=t},fu.prototype.setUserData=function(t){this._userData=t},fu.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var o=n.next(),i=r.next(),s=o.compareTo(i);if(0!==s)return s}return n.hasNext()?1:r.hasNext()?-1:0},fu.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},fu.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===fu.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===fu.SORTINDEX_MULTIPOINT||this.getSortIndex()===fu.SORTINDEX_MULTILINESTRING||this.getSortIndex()===fu.SORTINDEX_MULTIPOLYGON},fu.prototype.interfaces_=function(){return[Sl,El,Rl]},fu.prototype.getClass=function(){return fu},fu.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},fu.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},gu.serialVersionUID.get=function(){return 0x799ea46522854c00},gu.SORTINDEX_POINT.get=function(){return 0},gu.SORTINDEX_MULTIPOINT.get=function(){return 1},gu.SORTINDEX_LINESTRING.get=function(){return 2},gu.SORTINDEX_LINEARRING.get=function(){return 3},gu.SORTINDEX_MULTILINESTRING.get=function(){return 4},gu.SORTINDEX_POLYGON.get=function(){return 5},gu.SORTINDEX_MULTIPOLYGON.get=function(){return 6},gu.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},gu.geometryChangedFilter.get=function(){return mu},Object.defineProperties(fu,gu);var mu=function(){};mu.interfaces_=function(){return[du]},mu.filter=function(t){t.geometryChangedAction()};var yu=function(){};yu.prototype.filter=function(t){},yu.prototype.interfaces_=function(){return[]},yu.prototype.getClass=function(){return yu};var vu=function(){},_u={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};vu.prototype.isInBoundary=function(t){},vu.prototype.interfaces_=function(){return[]},vu.prototype.getClass=function(){return vu},_u.Mod2BoundaryNodeRule.get=function(){return wu},_u.EndPointBoundaryNodeRule.get=function(){return Cu},_u.MultiValentEndPointBoundaryNodeRule.get=function(){return bu},_u.MonoValentEndPointBoundaryNodeRule.get=function(){return xu},_u.MOD2_BOUNDARY_RULE.get=function(){return new wu},_u.ENDPOINT_BOUNDARY_RULE.get=function(){return new Cu},_u.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new bu},_u.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new xu},_u.OGC_SFS_BOUNDARY_RULE.get=function(){return vu.MOD2_BOUNDARY_RULE},Object.defineProperties(vu,_u);var wu=function(){};wu.prototype.isInBoundary=function(t){return t%2==1},wu.prototype.interfaces_=function(){return[vu]},wu.prototype.getClass=function(){return wu};var Cu=function(){};Cu.prototype.isInBoundary=function(t){return t>0},Cu.prototype.interfaces_=function(){return[vu]},Cu.prototype.getClass=function(){return Cu};var bu=function(){};bu.prototype.isInBoundary=function(t){return t>1},bu.prototype.interfaces_=function(){return[vu]},bu.prototype.getClass=function(){return bu};var xu=function(){};xu.prototype.isInBoundary=function(t){return 1===t},xu.prototype.interfaces_=function(){return[vu]},xu.prototype.getClass=function(){return xu};var Eu=function(){};function Su(t){this.message=t||""}Eu.prototype.add=function(){},Eu.prototype.addAll=function(){},Eu.prototype.isEmpty=function(){},Eu.prototype.iterator=function(){},Eu.prototype.size=function(){},Eu.prototype.toArray=function(){},Eu.prototype.remove=function(){},Su.prototype=new Error,Su.prototype.name="IndexOutOfBoundsException";var Tu=function(){};Tu.prototype.hasNext=function(){},Tu.prototype.next=function(){},Tu.prototype.remove=function(){};var Ru=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Eu);function Pu(t){this.message=t||""}Pu.prototype=new Error,Pu.prototype.name="NoSuchElementException";var Ou=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Eu&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Eu]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Iu(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new Su;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(Ru),Iu=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Pu;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Tu),Au=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){var e=this;if(2===arguments.length){for(var n=arguments[0],r=arguments[1],o=!1,i=n.iterator();i.hasNext();)e.add(i.next(),r),o=!0;return o}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var e=this;if(1===arguments.length){var n=arguments[0];t.prototype.add.call(this,n)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1];return this.add(r,o,!0),!0}if(arguments[0]instanceof Pl&&"boolean"==typeof arguments[1]){var i=arguments[0],s=arguments[1];if(!s&&this.size()>=1){var a=this.get(this.size()-1);if(a.equals2D(i))return null}t.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var l=arguments[0],u=arguments[1];return this.add(l,u),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var c=arguments[0],p=arguments[1],h=arguments[2];if(h)for(var d=0;d<c.length;d++)e.add(c[d],p);else for(var f=c.length-1;f>=0;f--)e.add(c[f],p);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof Pl){var g=arguments[0],m=arguments[1],y=arguments[2];if(!y){var v=this.size();if(v>0){if(g>0){var _=this.get(g-1);if(_.equals2D(m))return null}if(g<v){var w=this.get(g);if(w.equals2D(m))return null}}}t.prototype.add.call(this,g,m)}}else if(4===arguments.length){var C=arguments[0],b=arguments[1],x=arguments[2],E=arguments[3],S=1;x>E&&(S=-1);for(var T=x;T!==E;T+=S)e.add(C[T],b);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new Pl(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(Ou),Du=function(){},Mu={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Mu.ForwardComparator.get=function(){return Lu},Mu.BidirectionalComparator.get=function(){return Nu},Mu.coordArrayType.get=function(){return new Array(0).fill(null)},Du.prototype.interfaces_=function(){return[]},Du.prototype.getClass=function(){return Du},Du.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Du.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(Du.indexOf(r,e)<0)return r}return null},Du.scroll=function(t,e){var n=Du.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);Kl.arraycopy(t,n,r,0,t.length-n),Kl.arraycopy(t,0,r,t.length-n,n),Kl.arraycopy(r,0,t,0,t.length)},Du.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2];if(r===o)return!0;if(null===r||null===o)return!1;if(r.length!==o.length)return!1;for(var s=0;s<r.length;s++)if(0!==i.compare(r[s],o[s]))return!1;return!0}},Du.intersection=function(t,e){for(var n=new Au,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},Du.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Du.removeRepeatedPoints=function(t){return Du.hasRepeatedPoints(t)?new Au(t,!1).toCoordinateArray():t},Du.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var o=t[r];t[r]=t[e-r],t[e-r]=o}},Du.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;for(var o=0,i=0;i<t.length;i++)null!==t[i]&&(r[o++]=t[i]);return r},Du.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new Pl(t[n]);return e}if(5===arguments.length)for(var r=arguments[0],o=arguments[1],i=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)i[s+l]=new Pl(r[o+l])},Du.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=e[t.length-n-1];if(0!==r.compareTo(o))return!1}return!0},Du.envelope=function(t){for(var e=new Zl,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Du.toCoordinateArray=function(t){return t.toArray(Du.coordArrayType)},Du.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Du.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Du.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1},Du.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},Du.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Du.extract=function(t,e,n){e=Nl.clamp(e,0,t.length);var r=(n=Nl.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var o=new Array(r).fill(null);if(0===r)return o;for(var i=0,s=e;s<=n;s++)o[i++]=t[s];return o},Object.defineProperties(Du,Mu);var Lu=function(){};Lu.prototype.compare=function(t,e){return Du.compare(t,e)},Lu.prototype.interfaces_=function(){return[Tl]},Lu.prototype.getClass=function(){return Lu};var Nu=function(){};Nu.prototype.compare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var o=Du.compare(n,r);return Du.isEqualReversed(n,r)?0:o},Nu.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var o=Du.increasingDirection(n),i=Du.increasingDirection(r),s=o>0?0:n.length-1,a=i>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(r[a]);if(0!==u)return u;s+=o,a+=i}return 0},Nu.prototype.interfaces_=function(){return[Tl]},Nu.prototype.getClass=function(){return Nu};var Fu=function(){};Fu.prototype.get=function(){},Fu.prototype.put=function(){},Fu.prototype.size=function(){},Fu.prototype.values=function(){},Fu.prototype.entrySet=function(){};var ku=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Fu);function Gu(t){this.message=t||""}function Bu(){}Gu.prototype=new Error,Gu.prototype.name="OperationNotSupported",Bu.prototype=new Eu,Bu.prototype.contains=function(){};var Vu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Eu&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new zu(this)},e}(Bu),zu=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Pu;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new Gu},e}(Tu);function ju(t){return null===t?0:t.color}function Hu(t){return null===t?null:t.parent}function Uu(t,e){null!==t&&(t.color=e)}function Wu(t){return null===t?null:t.left}function qu(t){return null===t?null:t.right}function Xu(){this.root_=null,this.size_=0}Xu.prototype=new ku,Xu.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},Xu.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,o=this.root_;do{if(n=o,(r=t.compareTo(o.key))<0)o=o.left;else{if(!(r>0)){var i=o.value;return o.value=e,i}o=o.right}}while(null!==o);var s={key:t,left:null,right:null,value:e,parent:n,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},Xu.prototype.fixAfterInsertion=function(t){var e=this;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(Hu(t)===Wu(Hu(Hu(t)))){var n=qu(Hu(Hu(t)));1===ju(n)?(Uu(Hu(t),0),Uu(n,0),Uu(Hu(Hu(t)),1),t=Hu(Hu(t))):(t===qu(Hu(t))&&(t=Hu(t),e.rotateLeft(t)),Uu(Hu(t),0),Uu(Hu(Hu(t)),1),e.rotateRight(Hu(Hu(t))))}else{var r=Wu(Hu(Hu(t)));1===ju(r)?(Uu(Hu(t),0),Uu(r,0),Uu(Hu(Hu(t)),1),t=Hu(Hu(t))):(t===Wu(Hu(t))&&(t=Hu(t),e.rotateRight(t)),Uu(Hu(t),0),Uu(Hu(Hu(t)),1),e.rotateLeft(Hu(Hu(t))))}this.root_.color=0},Xu.prototype.values=function(){var t=new Ou,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=Xu.successor(e));)t.add(e.value);return t},Xu.prototype.entrySet=function(){var t=new Vu,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=Xu.successor(e));)t.add(e);return t},Xu.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},Xu.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},Xu.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},Xu.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,r=t;null!==n&&r===n.right;)r=n,n=n.parent;return n},Xu.prototype.size=function(){return this.size_};var Ku=function(){};function Yu(){}function Zu(){this.array_=[],arguments[0]instanceof Eu&&this.addAll(arguments[0])}Ku.prototype.interfaces_=function(){return[]},Ku.prototype.getClass=function(){return Ku},Yu.prototype=new Bu,Zu.prototype=new Yu,Zu.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},Zu.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},Zu.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Zu.prototype.remove=function(t){throw new Gu},Zu.prototype.size=function(){return this.array_.length},Zu.prototype.isEmpty=function(){return 0===this.array_.length},Zu.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Zu.prototype.iterator=function(){return new Qu(this)};var Qu=function(t){this.treeSet_=t,this.position_=0};Qu.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Pu;return this.treeSet_.array_[this.position_++]},Qu.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Qu.prototype.remove=function(){throw new Gu};var Ju=function(){};Ju.sort=function(){var t,e,n,r,o=arguments[0];if(1===arguments.length)r=function(t,e){return t.compareTo(e)},o.sort(r);else if(2===arguments.length)n=arguments[1],r=function(t,e){return n.compare(t,e)},o.sort(r);else if(3===arguments.length){(e=o.slice(arguments[1],arguments[2])).sort();var i=o.slice(0,arguments[1]).concat(e,o.slice(arguments[2],o.length));for(o.splice(0,o.length),t=0;t<i.length;t++)o.push(i[t])}else if(4===arguments.length)for(e=o.slice(arguments[1],arguments[2]),n=arguments[3],r=function(t,e){return n.compare(t,e)},e.sort(r),i=o.slice(0,arguments[1]).concat(e,o.slice(arguments[2],o.length)),o.splice(0,o.length),t=0;t<i.length;t++)o.push(i[t])},Ju.asList=function(t){for(var e=new Ou,n=0,r=t.length;n<r;n++)e.add(t[n]);return e};var $u=function(){},tc={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};tc.P.get=function(){return 0},tc.L.get=function(){return 1},tc.A.get=function(){return 2},tc.FALSE.get=function(){return-1},tc.TRUE.get=function(){return-2},tc.DONTCARE.get=function(){return-3},tc.SYM_FALSE.get=function(){return"F"},tc.SYM_TRUE.get=function(){return"T"},tc.SYM_DONTCARE.get=function(){return"*"},tc.SYM_P.get=function(){return"0"},tc.SYM_L.get=function(){return"1"},tc.SYM_A.get=function(){return"2"},$u.prototype.interfaces_=function(){return[]},$u.prototype.getClass=function(){return $u},$u.toDimensionSymbol=function(t){switch(t){case $u.FALSE:return $u.SYM_FALSE;case $u.TRUE:return $u.SYM_TRUE;case $u.DONTCARE:return $u.SYM_DONTCARE;case $u.P:return $u.SYM_P;case $u.L:return $u.SYM_L;case $u.A:return $u.SYM_A}throw new Cl("Unknown dimension value: "+t)},$u.toDimensionValue=function(t){switch(Bl.toUpperCase(t)){case $u.SYM_FALSE:return $u.FALSE;case $u.SYM_TRUE:return $u.TRUE;case $u.SYM_DONTCARE:return $u.DONTCARE;case $u.SYM_P:return $u.P;case $u.SYM_L:return $u.L;case $u.SYM_A:return $u.A}throw new Cl("Unknown dimension symbol: "+t)},Object.defineProperties($u,tc);var ec=function(){};ec.prototype.filter=function(t){},ec.prototype.interfaces_=function(){return[]},ec.prototype.getClass=function(){return ec};var nc=function(){};nc.prototype.filter=function(t,e){},nc.prototype.isDone=function(){},nc.prototype.isGeometryChanged=function(){},nc.prototype.interfaces_=function(){return[]},nc.prototype.getClass=function(){return nc};var rc=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new Cl("geometries must not contain null elements")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new Zl,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),o=0;o<r.length;o++)t[++e]=r[o];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var n=arguments[0],r=arguments[1];if(!this.isEquivalentClass(n))return!1;var o=n;if(this._geometries.length!==o._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!e._geometries[i].equalsExact(o._geometries[i],r))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Ju.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=$u.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=$u.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){var e=arguments[0],n=new Zu(Ju.asList(this._geometries)),r=new Zu(Ju.asList(e._geometries));return this.compare(n,r)}if(2===arguments.length){for(var o=arguments[0],i=arguments[1],s=o,a=this.getNumGeometries(),l=s.getNumGeometries(),u=0;u<a&&u<l;){var c=t.getGeometryN(u),p=s.getGeometryN(u),h=c.compareToSameClass(p,i);if(0!==h)return h;u++}return u<a?1:u<l?-1:0}},e.prototype.apply=function(){var t=this;if(Ll(arguments[0],yu))for(var e=arguments[0],n=0;n<this._geometries.length;n++)t._geometries[n].apply(e);else if(Ll(arguments[0],nc)){var r=arguments[0];if(0===this._geometries.length)return null;for(var o=0;o<this._geometries.length&&(t._geometries[o].apply(r),!r.isDone());o++);r.isGeometryChanged()&&this.geometryChanged()}else if(Ll(arguments[0],ec)){var i=arguments[0];i.filter(this);for(var s=0;s<this._geometries.length;s++)t._geometries[s].apply(i)}else if(Ll(arguments[0],du)){var a=arguments[0];a.filter(this);for(var l=0;l<this._geometries.length;l++)t._geometries[l].apply(a)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),iu.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(fu),oc=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return fu.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?$u.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new ic(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Ku]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(rc),ic=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=vu.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=r}};ic.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},ic.prototype.getBoundary=function(){return this._geom instanceof mc?this.boundaryLineString(this._geom):this._geom instanceof oc?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},ic.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},ic.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},ic.prototype.computeBoundaryCoordinates=function(t){var e=this,n=new Ou;this._endpointMap=new Xu;for(var r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r);0!==o.getNumPoints()&&(e.addEndpoint(o.getCoordinateN(0)),e.addEndpoint(o.getCoordinateN(o.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var s=i.next(),a=s.getValue().count;e._bnRule.isInBoundary(a)&&n.add(s.getKey())}return Du.toCoordinateArray(n)},ic.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new sc,this._endpointMap.put(t,e)),e.count++},ic.prototype.interfaces_=function(){return[]},ic.prototype.getClass=function(){return ic},ic.getBoundary=function(){if(1===arguments.length){var t=arguments[0],e=new ic(t);return e.getBoundary()}if(2===arguments.length){var n=arguments[0],r=arguments[1],o=new ic(n,r);return o.getBoundary()}};var sc=function(){this.count=null};function ac(){}function lc(){}sc.prototype.interfaces_=function(){return[]},sc.prototype.getClass=function(){return sc};var uc=function(){};function cc(){}function pc(){}function hc(){}var dc=function(){},fc={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};dc.prototype.interfaces_=function(){return[]},dc.prototype.getClass=function(){return dc},dc.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)},dc.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new cc,n=new ac(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var r=arguments[0],o=arguments[1],i="",s=new lc(dc.getStackTrace(r)),a=new hc(s),l=0;l<o;l++)try{i+=a.readLine()+dc.NEWLINE}catch(t){if(!(t instanceof pc))throw t;iu.shouldNeverReachHere()}return i}},dc.split=function(t,e){for(var n=e.length,r=new Ou,o=""+t,i=o.indexOf(e);i>=0;){var s=o.substring(0,i);r.add(s),i=(o=o.substring(i+n)).indexOf(e)}o.length>0&&r.add(o);for(var a=new Array(r.size()).fill(null),l=0;l<a.length;l++)a[l]=r.get(l);return a},dc.toString=function(){if(1===arguments.length){var t=arguments[0];return dc.SIMPLE_ORDINATE_FORMAT.format(t)}},dc.spaces=function(t){return dc.chars(" ",t)},fc.NEWLINE.get=function(){return Kl.getProperty("line.separator")},fc.SIMPLE_ORDINATE_FORMAT.get=function(){return new uc("0.#")},Object.defineProperties(dc,fc);var gc=function(){};gc.prototype.interfaces_=function(){return[]},gc.prototype.getClass=function(){return gc},gc.copyCoord=function(t,e,n,r){for(var o=Math.min(t.getDimension(),n.getDimension()),i=0;i<o;i++)n.setOrdinate(r,i,t.getOrdinate(e,i))},gc.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,Ul.X)===t.getOrdinate(e-1,Ul.X)&&t.getOrdinate(0,Ul.Y)===t.getOrdinate(e-1,Ul.Y)},gc.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),o=0;o<n;o++)for(var i=0;i<r;i++){var s=t.getOrdinate(o,i),a=e.getOrdinate(o,i);if(t.getOrdinate(o,i)!==e.getOrdinate(o,i)&&(!bl.isNaN(s)||!bl.isNaN(a)))return!1}return!0},gc.extend=function(t,e,n){var r=t.create(n,e.getDimension()),o=e.size();if(gc.copy(e,0,r,0,o),o>0)for(var i=o;i<n;i++)gc.copy(e,o-1,r,i,1);return r},gc.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)gc.swap(t,r,e-r)},gc.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var o=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,o)}},gc.copy=function(t,e,n,r,o){for(var i=0;i<o;i++)gc.copyCoord(t,e+i,n,r+i)},gc.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new kl;r.append("(");for(var o=0;o<e;o++){o>0&&r.append(" ");for(var i=0;i<n;i++)i>0&&r.append(","),r.append(dc.toString(t.getOrdinate(o,i)))}return r.append(")"),r.toString()}},gc.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?gc.createClosedRing(t,e,4):e.getOrdinate(0,Ul.X)===e.getOrdinate(n-1,Ul.X)&&e.getOrdinate(0,Ul.Y)===e.getOrdinate(n-1,Ul.Y)?e:gc.createClosedRing(t,e,n+1)},gc.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),o=e.size();gc.copy(e,0,r,0,o);for(var i=o;i<n;i++)gc.copy(e,0,r,i,1);return r};var mc=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Zl:this._points.expandEnvelope(new Zl)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var n=arguments[0],r=arguments[1];if(!this.isEquivalentClass(n))return!1;var o=n;if(this._points.size()!==o._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!e.equal(e._points.getCoordinate(i),o._points.getCoordinate(i),r))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=this,e=0;e<Math.trunc(this._points.size()/2);e++){var n=t._points.size()-1-e;if(!t._points.getCoordinate(e).equals(t._points.getCoordinate(n)))return t._points.getCoordinate(e).compareTo(t._points.getCoordinate(n))>0&&gc.reverse(t._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?$u.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return pu.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return gc.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],n=e,r=0,o=0;r<this._points.size()&&o<n._points.size();){var i=t._points.getCoordinate(r).compareTo(n._points.getCoordinate(o));if(0!==i)return i;r++,o++}return r<this._points.size()?1:o<n._points.size()?-1:0}if(2===arguments.length){var s=arguments[0],a=arguments[1],l=s;return a.compare(this._points,l._points)}},e.prototype.apply=function(){var t=this;if(Ll(arguments[0],yu))for(var e=arguments[0],n=0;n<this._points.size();n++)e.filter(t._points.getCoordinate(n));else if(Ll(arguments[0],nc)){var r=arguments[0];if(0===this._points.size())return null;for(var o=0;o<this._points.size()&&(r.filter(t._points,o),!r.isDone());o++);r.isGeometryChanged()&&this.geometryChanged()}else if(Ll(arguments[0],ec)){var i=arguments[0];i.filter(this)}else if(Ll(arguments[0],du)){var s=arguments[0];s.filter(this)}},e.prototype.getBoundary=function(){return new ic(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new Cl("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Ku]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(fu),yc=function(){};yc.prototype.interfaces_=function(){return[]},yc.prototype.getClass=function(){return yc};var vc=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Zl;var t=new Zl;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return $u.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var n=arguments[0],r=arguments[1],o=n;return r.compare(this._coordinates,o._coordinates)}},e.prototype.apply=function(){if(Ll(arguments[0],yu)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(Ll(arguments[0],nc)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(Ll(arguments[0],ec)){var n=arguments[0];n.filter(this)}else if(Ll(arguments[0],du)){var r=arguments[0];r.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),iu.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[yc]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(fu),_c=function(){};_c.prototype.interfaces_=function(){return[]},_c.prototype.getClass=function(){return _c};var wc=function(t){function e(e,n,r){if(t.call(this,r),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new Cl("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new Cl("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var o=0;o<this._holes.length;o++)for(var i=this._holes[o].getCoordinates(),s=0;s<i.length;s++)t[++e]=i[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(pu.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(pu.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;var o=t.getY(n);if(o!==e.getMinY()&&o!==e.getMaxY())return!1}for(var i=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==i===(u!==s))return!1;i=l,s=u}return!0},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var n=arguments[0],r=arguments[1];if(!this.isEquivalentClass(n))return!1;var o=n,i=this._shell,s=o._shell;if(!i.equalsExact(s,r))return!1;if(this._holes.length!==o._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!e._holes[a].equalsExact(o._holes[a],r))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var t=this;if(0===arguments.length){this.normalize(this._shell,!0);for(var e=0;e<this._holes.length;e++)t.normalize(t._holes[e],!1);Ju.sort(this._holes)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];if(n.isEmpty())return null;var o=new Array(n.getCoordinates().length-1).fill(null);Kl.arraycopy(n.getCoordinates(),0,o,0,o.length);var i=Du.minCoordinate(n.getCoordinates());Du.scroll(o,i),Kl.arraycopy(o,0,n.getCoordinates(),0,o.length),n.getCoordinates()[o.length]=o[0],pu.isCCW(n.getCoordinates())===r&&Du.reverse(n.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){var e=arguments[0],n=this._shell,r=e._shell;return n.compareToSameClass(r)}if(2===arguments.length){var o=arguments[0],i=arguments[1],s=o,a=this._shell,l=s._shell,u=a.compareToSameClass(l,i);if(0!==u)return u;for(var c=this.getNumInteriorRing(),p=s.getNumInteriorRing(),h=0;h<c&&h<p;){var d=t.getInteriorRingN(h),f=s.getInteriorRingN(h),g=d.compareToSameClass(f,i);if(0!==g)return g;h++}return h<c?1:h<p?-1:0}},e.prototype.apply=function(t){var e=this;if(Ll(t,yu)){this._shell.apply(t);for(var n=0;n<this._holes.length;n++)e._holes[n].apply(t)}else if(Ll(t,nc)){if(this._shell.apply(t),!t.isDone())for(var r=0;r<this._holes.length&&(e._holes[r].apply(t),!t.isDone());r++);t.isGeometryChanged()&&this.geometryChanged()}else if(Ll(t,ec))t.filter(this);else if(Ll(t,du)){t.filter(this),this._shell.apply(t);for(var o=0;o<this._holes.length;o++)e._holes[o].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<n.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[_c]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(fu),Cc=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return fu.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return $u.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[yc]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(rc),bc=function(t){function e(e,n){e instanceof Pl&&n instanceof Gc&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return fu.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return $u.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return gc.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new Cl("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new Cl("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(mc),xc=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return fu.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Ou,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var o=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(o))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[_c]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(rc),Ec=function(t){this._factory=t||null,this._isUserDataCopied=!1},Sc={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Ec.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},Ec.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},Ec.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof rc?this.editGeometryCollection(t,e):t instanceof wc?this.editPolygon(t,e):t instanceof vc||t instanceof mc?e.edit(t,this._factory):(iu.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},Ec.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),r=new Ou,o=0;o<n.getNumGeometries();o++){var i=this.edit(n.getGeometryN(o),e);null===i||i.isEmpty()||r.add(i)}return n.getClass()===Cc?this._factory.createMultiPoint(r.toArray([])):n.getClass()===oc?this._factory.createMultiLineString(r.toArray([])):n.getClass()===xc?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))},Ec.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var r=this.edit(n.getExteriorRing(),e);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var o=new Ou,i=0;i<n.getNumInteriorRing();i++){var s=this.edit(n.getInteriorRingN(i),e);null===s||s.isEmpty()||o.add(s)}return this._factory.createPolygon(r,o.toArray([]))},Ec.prototype.interfaces_=function(){return[]},Ec.prototype.getClass=function(){return Ec},Ec.GeometryEditorOperation=function(){},Sc.NoOpGeometryOperation.get=function(){return Tc},Sc.CoordinateOperation.get=function(){return Rc},Sc.CoordinateSequenceOperation.get=function(){return Pc},Object.defineProperties(Ec,Sc);var Tc=function(){};Tc.prototype.edit=function(t,e){return t},Tc.prototype.interfaces_=function(){return[Ec.GeometryEditorOperation]},Tc.prototype.getClass=function(){return Tc};var Rc=function(){};Rc.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof bc?e.createLinearRing(n):t instanceof mc?e.createLineString(n):t instanceof vc?n.length>0?e.createPoint(n[0]):e.createPoint():t},Rc.prototype.interfaces_=function(){return[Ec.GeometryEditorOperation]},Rc.prototype.getClass=function(){return Rc};var Pc=function(){};Pc.prototype.edit=function(t,e){return t instanceof bc?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof mc?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof vc?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Pc.prototype.interfaces_=function(){return[Ec.GeometryEditorOperation]},Pc.prototype.getClass=function(){return Pc};var Oc=function(){var t=this;if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)t._coordinates[n]=new Pl}else if(Ll(arguments[0],Ul)){var r=arguments[0];if(null===r)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._coordinates=new Array(r.size()).fill(null);for(var o=0;o<this._coordinates.length;o++)t._coordinates[o]=r.getCoordinateCopy(o)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],s=arguments[1];this._coordinates=i,this._dimension=s,null===i&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],l=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=l;for(var u=0;u<a;u++)t._coordinates[u]=new Pl}},Ic={serialVersionUID:{configurable:!0}};Oc.prototype.setOrdinate=function(t,e,n){switch(e){case Ul.X:this._coordinates[t].x=n;break;case Ul.Y:this._coordinates[t].y=n;break;case Ul.Z:this._coordinates[t].z=n;break;default:throw new Cl("invalid ordinateIndex")}},Oc.prototype.size=function(){return this._coordinates.length},Oc.prototype.getOrdinate=function(t,e){switch(e){case Ul.X:return this._coordinates[t].x;case Ul.Y:return this._coordinates[t].y;case Ul.Z:return this._coordinates[t].z}return bl.NaN},Oc.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},Oc.prototype.getCoordinateCopy=function(t){return new Pl(this._coordinates[t])},Oc.prototype.getDimension=function(){return this._dimension},Oc.prototype.getX=function(t){return this._coordinates[t].x},Oc.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Oc(t,this._dimension)},Oc.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Oc.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Oc(t,this._dimension)},Oc.prototype.toString=function(){if(this._coordinates.length>0){var t=new kl(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Oc.prototype.getY=function(t){return this._coordinates[t].y},Oc.prototype.toCoordinateArray=function(){return this._coordinates},Oc.prototype.interfaces_=function(){return[Ul,Rl]},Oc.prototype.getClass=function(){return Oc},Ic.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Oc,Ic);var Ac=function(){},Dc={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Ac.prototype.readResolve=function(){return Ac.instance()},Ac.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Oc(t)}if(Ll(arguments[0],Ul)){var e=arguments[0];return new Oc(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return r>3&&(r=3),r<2?new Oc(n):new Oc(n,r)}},Ac.prototype.interfaces_=function(){return[Al,Rl]},Ac.prototype.getClass=function(){return Ac},Ac.instance=function(){return Ac.instanceObject},Dc.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Dc.instanceObject.get=function(){return new Ac},Object.defineProperties(Ac,Dc);var Mc=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Ou,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Vu;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(Fu),Lc=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Fc){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}},Nc={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Lc.prototype.equals=function(t){if(!(t instanceof Lc))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},Lc.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new Gl(n).compareTo(new Gl(r))},Lc.prototype.getScale=function(){return this._scale},Lc.prototype.isFloating=function(){return this._modelType===Lc.FLOATING||this._modelType===Lc.FLOATING_SINGLE},Lc.prototype.getType=function(){return this._modelType},Lc.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Lc.FLOATING?t="Floating":this._modelType===Lc.FLOATING_SINGLE?t="Floating-Single":this._modelType===Lc.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},Lc.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return bl.isNaN(t)||this._modelType===Lc.FLOATING_SINGLE?t:this._modelType===Lc.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof Pl){var e=arguments[0];if(this._modelType===Lc.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},Lc.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Lc.FLOATING?t=16:this._modelType===Lc.FLOATING_SINGLE?t=6:this._modelType===Lc.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},Lc.prototype.setScale=function(t){this._scale=Math.abs(t)},Lc.prototype.interfaces_=function(){return[Rl,El]},Lc.prototype.getClass=function(){return Lc},Lc.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},Nc.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Nc.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Lc,Nc);var Fc=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},kc={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Fc.prototype.readResolve=function(){return Fc.nameToTypeMap.get(this._name)},Fc.prototype.toString=function(){return this._name},Fc.prototype.interfaces_=function(){return[Rl]},Fc.prototype.getClass=function(){return Fc},kc.serialVersionUID.get=function(){return-552860263173159e4},kc.nameToTypeMap.get=function(){return new Mc},Object.defineProperties(Fc,kc),Lc.Type=Fc,Lc.FIXED=new Fc("FIXED"),Lc.FLOATING=new Fc("FLOATING"),Lc.FLOATING_SINGLE=new Fc("FLOATING SINGLE");var Gc=function t(){this._precisionModel=new Lc,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Ll(arguments[0],Al)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Lc&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Bc={serialVersionUID:{configurable:!0}};Gc.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Pl(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Pl(t.getMinX(),t.getMinY()),new Pl(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Pl(t.getMinX(),t.getMinY()),new Pl(t.getMinX(),t.getMaxY()),new Pl(t.getMaxX(),t.getMaxY()),new Pl(t.getMaxX(),t.getMinY()),new Pl(t.getMinX(),t.getMinY())]),null)},Gc.prototype.createLineString=function(t){return t?t instanceof Array?new mc(this.getCoordinateSequenceFactory().create(t),this):Ll(t,Ul)?new mc(t,this):void 0:new mc(this.getCoordinateSequenceFactory().create([]),this)},Gc.prototype.createMultiLineString=function(){if(0===arguments.length)return new oc(null,this);if(1===arguments.length){var t=arguments[0];return new oc(t,this)}},Gc.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,o=t.iterator();o.hasNext();){var i=o.next(),s=i.getClass();null===e&&(e=s),s!==e&&(n=!0),i.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(Gc.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof wc)return this.createMultiPolygon(Gc.toPolygonArray(t));if(a instanceof mc)return this.createMultiLineString(Gc.toLineStringArray(t));if(a instanceof vc)return this.createMultiPoint(Gc.toPointArray(t));iu.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},Gc.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},Gc.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Pl){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(Ll(arguments[0],Ul)){var e=arguments[0];return new vc(e,this)}}},Gc.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Gc.prototype.createPolygon=function(){if(0===arguments.length)return new wc(null,null,this);if(1===arguments.length){if(Ll(arguments[0],Ul)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof bc){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];return new wc(r,o,this)}},Gc.prototype.getSRID=function(){return this._SRID},Gc.prototype.createGeometryCollection=function(){if(0===arguments.length)return new rc(null,this);if(1===arguments.length){var t=arguments[0];return new rc(t,this)}},Gc.prototype.createGeometry=function(t){return new Ec(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},Gc.prototype.getPrecisionModel=function(){return this._precisionModel},Gc.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(Ll(arguments[0],Ul)){var e=arguments[0];return new bc(e,this)}}},Gc.prototype.createMultiPolygon=function(){if(0===arguments.length)return new xc(null,this);if(1===arguments.length){var t=arguments[0];return new xc(t,this)}},Gc.prototype.createMultiPoint=function(){var t=this;if(0===arguments.length)return new Cc(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return new Cc(e,this)}if(arguments[0]instanceof Array){var n=arguments[0];return this.createMultiPoint(null!==n?this.getCoordinateSequenceFactory().create(n):null)}if(Ll(arguments[0],Ul)){var r=arguments[0];if(null===r)return this.createMultiPoint(new Array(0).fill(null));for(var o=new Array(r.size()).fill(null),i=0;i<r.size();i++){var s=t.getCoordinateSequenceFactory().create(1,r.getDimension());gc.copy(r,i,s,0,1),o[i]=t.createPoint(s)}return this.createMultiPoint(o)}}},Gc.prototype.interfaces_=function(){return[Rl]},Gc.prototype.getClass=function(){return Gc},Gc.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.getDefaultCoordinateSequenceFactory=function(){return Ac.instance()},Gc.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Gc.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Bc.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Gc,Bc);var Vc=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],zc=function(t){this.geometryFactory=t||new Gc};zc.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!jc[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Vc.indexOf(n)?jc[n].apply(this,[e.coordinates]):"GeometryCollection"===n?jc[n].apply(this,[e.geometries]):jc[n].apply(this,[e])},zc.prototype.write=function(t){var e=t.getGeometryType();if(!Hc[e])throw new Error("Geometry is not supported");return Hc[e].apply(this,[t])};var jc={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!jc[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=jc.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new Pl(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new Pl(t[0],t[1]),new Pl(t[2],t[1]),new Pl(t[2],t[3]),new Pl(t[0],t[3]),new Pl(t[0],t[1])])},Point:function(t){var e=new Pl(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(jc.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=jc.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(jc.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=jc.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),r=[],o=1;o<t.length;++o){var i=t[o],s=jc.coordinates.apply(this,[i]),a=this.geometryFactory.createLinearRing(s);r.push(a)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(jc.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},Hc={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Hc.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],o=Hc.Point.apply(this,[r]);e.push(o.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var o=n[r];e.push(Hc.coordinate.apply(this,[o]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],o=Hc.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Hc.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var o=t._holes[r],i=Hc.LineString.apply(this,[o]);e.push(i.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],o=Hc.Polygon.apply(this,[r]);e.push(o.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],o=r.getGeometryType();e.push(Hc[o].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}},Uc=function(t){this.geometryFactory=t||new Gc,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new zc(this.geometryFactory)};Uc.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Lc.FIXED&&this.reducePrecision(e),e},Uc.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Wc=function(){this.parser=new zc(this.geometryFactory)};Wc.prototype.write=function(t){return this.parser.write(t)};var qc=function(){},Xc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};function Kc(t){this.message=t||""}function Yc(){this.array_=[]}qc.prototype.interfaces_=function(){return[]},qc.prototype.getClass=function(){return qc},qc.opposite=function(t){return t===qc.LEFT?qc.RIGHT:t===qc.RIGHT?qc.LEFT:t},Xc.ON.get=function(){return 0},Xc.LEFT.get=function(){return 1},Xc.RIGHT.get=function(){return 2},Object.defineProperties(qc,Xc),Kc.prototype=new Error,Kc.prototype.name="EmptyStackException",Yc.prototype=new Ru,Yc.prototype.add=function(t){return this.array_.push(t),!0},Yc.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Yc.prototype.push=function(t){return this.array_.push(t),t},Yc.prototype.pop=function(t){if(0===this.array_.length)throw new Kc;return this.array_.pop()},Yc.prototype.peek=function(){if(0===this.array_.length)throw new Kc;return this.array_[this.array_.length-1]},Yc.prototype.empty=function(){return 0===this.array_.length},Yc.prototype.isEmpty=function(){return this.empty()},Yc.prototype.search=function(t){return this.array_.indexOf(t)},Yc.prototype.size=function(){return this.array_.length},Yc.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Zc=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Zc.prototype.getCoordinate=function(){return this._minCoord},Zc.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Zc.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();iu.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=pu.computeOrientation(this._minCoord,n,e),o=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===pu.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===pu.CLOCKWISE)&&(o=!0),o&&(this._minIndex=this._minIndex-1)},Zc.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=qc.LEFT;return n[e].y<n[e+1].y&&(r=qc.RIGHT),r},Zc.prototype.getEdge=function(){return this._orientedDe},Zc.prototype.checkForRightmostCoordinate=function(t){for(var e=this,n=t.getEdge().getCoordinates(),r=0;r<n.length-1;r++)(null===e._minCoord||n[r].x>e._minCoord.x)&&(e._minDe=t,e._minIndex=r,e._minCoord=n[r])},Zc.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Zc.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}iu.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===qc.LEFT&&(this._orientedDe=this._minDe.getSym())},Zc.prototype.interfaces_=function(){return[]},Zc.prototype.getClass=function(){return Zc};var Qc=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new Pl(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(ru),Jc=function(){this.array_=[]};Jc.prototype.addLast=function(t){this.array_.push(t)},Jc.prototype.removeFirst=function(){return this.array_.shift()},Jc.prototype.isEmpty=function(){return 0===this.array_.length};var $c=function(){this._finder=null,this._dirEdgeList=new Ou,this._nodes=new Ou,this._rightMostCoord=null,this._env=null,this._finder=new Zc};$c.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},$c.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},$c.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new Qc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var o=t.getEdges().iterator();o.hasNext();){var i=o.next();i.setVisited(!0),this.copySymDepths(i)}},$c.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(qc.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},$c.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},$c.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(qc.RIGHT)>=1&&e.getDepth(qc.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},$c.prototype.computeDepths=function(t){var e=new Vu,n=new Jc,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var o=n.removeFirst();e.add(o),this.computeNodeDepth(o);for(var i=o.getEdges().iterator();i.hasNext();){var s=i.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},$c.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},$c.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Zl,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env},$c.prototype.addReachable=function(t){var e=new Yc;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},$c.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(qc.LEFT,t.getDepth(qc.RIGHT)),e.setDepth(qc.RIGHT,t.getDepth(qc.LEFT))},$c.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this._dirEdgeList.add(r);var o=r.getSym().getNode();o.isVisited()||e.push(o)}},$c.prototype.getNodes=function(){return this._nodes},$c.prototype.getDirectedEdges=function(){return this._dirEdgeList},$c.prototype.interfaces_=function(){return[El]},$c.prototype.getClass=function(){return $c};var tp=function t(){var e=this;if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[qc.ON]=r}else if(arguments[0]instanceof t){var o=arguments[0];if(this.init(o.location.length),null!==o)for(var i=0;i<this.location.length;i++)e.location[i]=o.location[i]}}else if(3===arguments.length){var s=arguments[0],a=arguments[1],l=arguments[2];this.init(3),this.location[qc.ON]=s,this.location[qc.LEFT]=a,this.location[qc.RIGHT]=l}};tp.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},tp.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==Dl.NONE)return!1;return!0},tp.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===Dl.NONE&&(this.location[e]=t)},tp.prototype.isLine=function(){return 1===this.location.length},tp.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[qc.ON]=this.location[qc.ON],e[qc.LEFT]=Dl.NONE,e[qc.RIGHT]=Dl.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===Dl.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},tp.prototype.getLocations=function(){return this.location},tp.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[qc.LEFT];this.location[qc.LEFT]=this.location[qc.RIGHT],this.location[qc.RIGHT]=t},tp.prototype.toString=function(){var t=new kl;return this.location.length>1&&t.append(Dl.toLocationSymbol(this.location[qc.LEFT])),t.append(Dl.toLocationSymbol(this.location[qc.ON])),this.location.length>1&&t.append(Dl.toLocationSymbol(this.location[qc.RIGHT])),t.toString()},tp.prototype.setLocations=function(t,e,n){this.location[qc.ON]=t,this.location[qc.LEFT]=e,this.location[qc.RIGHT]=n},tp.prototype.get=function(t){return t<this.location.length?this.location[t]:Dl.NONE},tp.prototype.isArea=function(){return this.location.length>1},tp.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===Dl.NONE)return!0;return!1},tp.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(qc.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},tp.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(Dl.NONE)},tp.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},tp.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},tp.prototype.interfaces_=function(){return[]},tp.prototype.getClass=function(){return tp};var ep=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new tp(e),this.elt[1]=new tp(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new tp(n.elt[0]),this.elt[1]=new tp(n.elt[1])}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.elt[0]=new tp(Dl.NONE),this.elt[1]=new tp(Dl.NONE),this.elt[r].setLocation(o)}else if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new tp(i,s,a),this.elt[1]=new tp(i,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],p=arguments[3];this.elt[0]=new tp(Dl.NONE,Dl.NONE,Dl.NONE),this.elt[1]=new tp(Dl.NONE,Dl.NONE,Dl.NONE),this.elt[l].setLocations(u,c,p)}};ep.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},ep.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},ep.prototype.isNull=function(t){return this.elt[t].isNull()},ep.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},ep.prototype.isLine=function(t){return this.elt[t].isLine()},ep.prototype.merge=function(t){for(var e=this,n=0;n<2;n++)null===e.elt[n]&&null!==t.elt[n]?e.elt[n]=new tp(t.elt[n]):e.elt[n].merge(t.elt[n])},ep.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},ep.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(qc.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},ep.prototype.toString=function(){var t=new kl;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},ep.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},ep.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},ep.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(qc.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this.elt[n].setLocation(r,o)}},ep.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},ep.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},ep.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new tp(this.elt[t].location[0]))},ep.prototype.interfaces_=function(){return[]},ep.prototype.getClass=function(){return ep},ep.toLineLabel=function(t){for(var e=new ep(Dl.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var np=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Ou,this._pts=new Ou,this._label=new ep(Dl.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Ou,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};np.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=pu.isCCW(this._ring.getCoordinates())},np.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},np.prototype.computePoints=function(t){var e=this;this._startDe=t;var n=t,r=!0;do{if(null===n)throw new Qc("Found null DirectedEdge");if(n.getEdgeRing()===e)throw new Qc("Directed Edge visited twice during ring-building at "+n.getCoordinate());e._edges.add(n);var o=n.getLabel();iu.isTrue(o.isArea()),e.mergeLabel(o),e.addPoints(n.getEdge(),n.isForward(),r),r=!1,e.setEdgeRing(n,e),n=e.getNext(n)}while(n!==this._startDe)},np.prototype.getLinearRing=function(){return this._ring},np.prototype.getCoordinate=function(t){return this._pts.get(t)},np.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var e=this._startDe;do{var n=e.getNode().getEdges().getOutgoingDegree(t);n>t._maxNodeDegree&&(t._maxNodeDegree=n),e=t.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2},np.prototype.addPoints=function(t,e,n){var r=t.getCoordinates();if(e){var o=1;n&&(o=0);for(var i=o;i<r.length;i++)this._pts.add(r[i])}else{var s=r.length-2;n&&(s=r.length-1);for(var a=s;a>=0;a--)this._pts.add(r[a])}},np.prototype.isHole=function(){return this._isHole},np.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},np.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!pu.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},np.prototype.addHole=function(t){this._holes.add(t)},np.prototype.isShell=function(){return null===this._shell},np.prototype.getLabel=function(){return this._label},np.prototype.getEdges=function(){return this._edges},np.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},np.prototype.getShell=function(){return this._shell},np.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=e.getLocation(n,qc.RIGHT);if(r===Dl.NONE)return null;if(this._label.getLocation(n)===Dl.NONE)return this._label.setLocation(n,r),null}},np.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},np.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},np.prototype.interfaces_=function(){return[]},np.prototype.getClass=function(){return np};var rp=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(np),op=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Ou,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new rp(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(np),ip=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};ip.prototype.setVisited=function(t){this._isVisited=t},ip.prototype.setInResult=function(t){this._isInResult=t},ip.prototype.isCovered=function(){return this._isCovered},ip.prototype.isCoveredSet=function(){return this._isCoveredSet},ip.prototype.setLabel=function(t){this._label=t},ip.prototype.getLabel=function(){return this._label},ip.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},ip.prototype.updateIM=function(t){iu.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},ip.prototype.isInResult=function(){return this._isInResult},ip.prototype.isVisited=function(){return this._isVisited},ip.prototype.interfaces_=function(){return[]},ip.prototype.getClass=function(){return ip};var sp=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new ep(0,Dl.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=Dl.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==Dl.BOUNDARY&&(n=r)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new ep(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var t=this;if(arguments[0]instanceof e){var n=arguments[0];this.mergeLabel(n._label)}else if(arguments[0]instanceof ep)for(var r=arguments[0],o=0;o<2;o++){var i=t.computeMergedLocation(r,o),s=t._label.getLocation(o);s===Dl.NONE&&t._label.setLocation(o,i)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=Dl.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case Dl.BOUNDARY:n=Dl.INTERIOR;break;case Dl.INTERIOR:default:n=Dl.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ip),ap=function(){this.nodeMap=new Xu,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};ap.prototype.find=function(t){return this.nodeMap.get(t)},ap.prototype.addNode=function(){if(arguments[0]instanceof Pl){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof sp){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return null===r?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}},ap.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},ap.prototype.iterator=function(){return this.nodeMap.values().iterator()},ap.prototype.values=function(){return this.nodeMap.values()},ap.prototype.getBoundaryNodes=function(t){for(var e=new Ou,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===Dl.BOUNDARY&&e.add(r)}return e},ap.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},ap.prototype.interfaces_=function(){return[]},ap.prototype.getClass=function(){return ap};var lp=function(){},up={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};lp.prototype.interfaces_=function(){return[]},lp.prototype.getClass=function(){return lp},lp.isNorthern=function(t){return t===lp.NE||t===lp.NW},lp.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},lp.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},lp.isInHalfPlane=function(t,e){return e===lp.SE?t===lp.SE||t===lp.SW:t===e||t===e+1},lp.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Cl("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?lp.NE:lp.SE:e>=0?lp.NW:lp.SW}if(arguments[0]instanceof Pl&&arguments[1]instanceof Pl){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new Cl("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?lp.NE:lp.SE:r.y>=n.y?lp.NW:lp.SW}},up.NE.get=function(){return 0},up.NW.get=function(){return 1},up.SW.get=function(){return 2},up.SE.get=function(){return 3},Object.defineProperties(lp,up);var cp=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],o=null;this._edge=e,this.init(n,r),this._label=o}else if(4===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this._edge=i,this.init(s,a),this._label=l}};cp.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:pu.computeOrientation(t._p0,t._p1,this._p1)},cp.prototype.getDy=function(){return this._dy},cp.prototype.getCoordinate=function(){return this._p0},cp.prototype.setNode=function(t){this._node=t},cp.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),o=n.substring(r+1);t.print("  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},cp.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},cp.prototype.getDirectedCoordinate=function(){return this._p1},cp.prototype.getDx=function(){return this._dx},cp.prototype.getLabel=function(){return this._label},cp.prototype.getEdge=function(){return this._edge},cp.prototype.getQuadrant=function(){return this._quadrant},cp.prototype.getNode=function(){return this._node},cp.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},cp.prototype.computeLabel=function(t){},cp.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=lp.quadrant(this._dx,this._dy),iu.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},cp.prototype.interfaces_=function(){return[El]},cp.prototype.getClass=function(){return cp};var pp=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var r=e.getNumPoints()-1;this.init(e.getCoordinate(r),e.getCoordinate(r-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new ep(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Qc("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=this,e=!0,n=0;n<2;n++)t._label.isArea(n)&&t._label.getLocation(n,qc.LEFT)===Dl.INTERIOR&&t._label.getLocation(n,qc.RIGHT)===Dl.INTERIOR||(e=!1);return e},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[qc.LEFT]+"/"+this._depth[qc.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,Dl.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,Dl.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===qc.LEFT&&(r=-1);var o=qc.opposite(t),i=e+n*r;this.setDepth(t,e),this.setDepth(o,i)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===Dl.EXTERIOR&&e===Dl.INTERIOR?1:t===Dl.INTERIOR&&e===Dl.EXTERIOR?-1:0},e}(cp),hp=function(){};hp.prototype.createNode=function(t){return new sp(t,null)},hp.prototype.interfaces_=function(){return[]},hp.prototype.getClass=function(){return hp};var dp=function(){if(this._edges=new Ou,this._nodes=null,this._edgeEndList=new Ou,0===arguments.length)this._nodes=new ap(new hp);else if(1===arguments.length){var t=arguments[0];this._nodes=new ap(t)}};dp.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},dp.prototype.find=function(t){return this._nodes.find(t)},dp.prototype.addNode=function(){if(arguments[0]instanceof sp){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof Pl){var e=arguments[0];return this._nodes.addNode(e)}},dp.prototype.getNodeIterator=function(){return this._nodes.iterator()},dp.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},dp.prototype.debugPrintln=function(t){Kl.out.println(t)},dp.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===Dl.BOUNDARY},dp.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},dp.prototype.matchInSameDirection=function(t,e,n,r){return!!t.equals(n)&&pu.computeOrientation(t,e,r)===pu.COLLINEAR&&lp.quadrant(t,e)===lp.quadrant(n,r)},dp.prototype.getEdgeEnds=function(){return this._edgeEndList},dp.prototype.debugPrint=function(t){Kl.out.print(t)},dp.prototype.getEdgeIterator=function(){return this._edges.iterator()},dp.prototype.findEdgeInSameDirection=function(t,e){for(var n=this,r=0;r<this._edges.size();r++){var o=n._edges.get(r),i=o.getCoordinates();if(n.matchInSameDirection(t,e,i[0],i[1]))return o;if(n.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return o}return null},dp.prototype.insertEdge=function(t){this._edges.add(t)},dp.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},dp.prototype.addEdges=function(t){for(var e=this,n=t.iterator();n.hasNext();){var r=n.next();e._edges.add(r);var o=new pp(r,!0),i=new pp(r,!1);o.setSym(i),i.setSym(o),e.add(o),e.add(i)}},dp.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},dp.prototype.getNodes=function(){return this._nodes.values()},dp.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),o=r.getCoordinates();if(t.equals(o[0])&&e.equals(o[1]))return r}return null},dp.prototype.interfaces_=function(){return[]},dp.prototype.getClass=function(){return dp},dp.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var fp=function(){this._geometryFactory=null,this._shellList=new Ou;var t=arguments[0];this._geometryFactory=t};fp.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var o=r.next();o.isHole()?n.add(o):e.add(o)}},fp.prototype.computePolygons=function(t){for(var e=new Ou,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e},fp.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var o=this.findEdgeRingContaining(r,t);if(null===o)throw new Qc("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(o)}}},fp.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=new Ou,o=t.iterator();o.hasNext();){var i=o.next();if(i.getMaxNodeDegree()>2){i.linkDirectedEdgesForMinimalEdgeRings();var s=i.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else r.add(i)}return r},fp.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},fp.prototype.buildMaximalEdgeRings=function(t){for(var e=new Ou,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var o=new op(r,this._geometryFactory);e.add(o),o.setInResult()}}return e},fp.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},fp.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},fp.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),o=n.getCoordinateN(0),i=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==i&&(s=i.getLinearRing().getEnvelopeInternal());var p=!1;c.contains(r)&&pu.isPointInRing(o,u.getCoordinates())&&(p=!0),p&&(null===i||s.contains(c))&&(i=l)}return i},fp.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var o=r.next();o.isHole()||(n=o,e++)}return iu.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},fp.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];dp.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),o=new Ou,i=this.buildMinimalEdgeRings(r,this._shellList,o);this.sortShellsAndHoles(i,this._shellList,o),this.placeFreeHoles(this._shellList,o)}},fp.prototype.interfaces_=function(){return[]},fp.prototype.getClass=function(){return fp};var gp=function(){};gp.prototype.getBounds=function(){},gp.prototype.interfaces_=function(){return[]},gp.prototype.getClass=function(){return gp};var mp=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};mp.prototype.getItem=function(){return this._item},mp.prototype.getBounds=function(){return this._bounds},mp.prototype.interfaces_=function(){return[gp,Rl]},mp.prototype.getClass=function(){return mp};var yp=function(){this._size=null,this._items=null,this._size=0,this._items=new Ou,this._items.add(null)};yp.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},yp.prototype.size=function(){return this._size},yp.prototype.reorder=function(t){for(var e=this,n=null,r=this._items.get(t);2*t<=this._size&&((n=2*t)!==e._size&&e._items.get(n+1).compareTo(e._items.get(n))<0&&n++,e._items.get(n).compareTo(r)<0);t=n)e._items.set(t,e._items.get(n));this._items.set(t,r)},yp.prototype.clear=function(){this._size=0,this._items.clear()},yp.prototype.isEmpty=function(){return 0===this._size},yp.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},yp.prototype.interfaces_=function(){return[]},yp.prototype.getClass=function(){return yp};var vp=function(){};vp.prototype.visitItem=function(t){},vp.prototype.interfaces_=function(){return[]},vp.prototype.getClass=function(){return vp};var _p=function(){};_p.prototype.insert=function(t,e){},_p.prototype.remove=function(t,e){},_p.prototype.query=function(){},_p.prototype.interfaces_=function(){return[]},_p.prototype.getClass=function(){return _p};var wp=function(){if(this._childBoundables=new Ou,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Cp={serialVersionUID:{configurable:!0}};wp.prototype.getLevel=function(){return this._level},wp.prototype.size=function(){return this._childBoundables.size()},wp.prototype.getChildBoundables=function(){return this._childBoundables},wp.prototype.addChildBoundable=function(t){iu.isTrue(null===this._bounds),this._childBoundables.add(t)},wp.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},wp.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},wp.prototype.interfaces_=function(){return[gp,Rl]},wp.prototype.getClass=function(){return wp},Cp.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(wp,Cp);var bp=function(){};bp.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},bp.min=function(t){return bp.sort(t),t.get(0)},bp.sort=function(t,e){var n=t.toArray();e?Ju.sort(n,e):Ju.sort(n);for(var r=t.iterator(),o=0,i=n.length;o<i;o++)r.next(),r.set(n[o])},bp.singletonList=function(t){var e=new Ou;return e.add(t),e};var xp=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};xp.prototype.expandToQueue=function(t,e){var n=xp.isComposite(this._boundable1),r=xp.isComposite(this._boundable2);if(n&&r)return xp.area(this._boundable1)>xp.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Cl("neither boundable is composite")},xp.prototype.isLeaves=function(){return!(xp.isComposite(this._boundable1)||xp.isComposite(this._boundable2))},xp.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},xp.prototype.expand=function(t,e,n,r){for(var o=t.getChildBoundables().iterator();o.hasNext();){var i=o.next(),s=new xp(i,e,this._itemDistance);s.getDistance()<r&&n.add(s)}},xp.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},xp.prototype.getDistance=function(){return this._distance},xp.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},xp.prototype.interfaces_=function(){return[El]},xp.prototype.getClass=function(){return xp},xp.area=function(t){return t.getBounds().getArea()},xp.isComposite=function(t){return t instanceof wp};var Ep=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Ou,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];iu.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},Sp={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ep.prototype.getNodeCapacity=function(){return this._nodeCapacity},Ep.prototype.lastNode=function(t){return t.get(t.size()-1)},Ep.prototype.size=function(){var t=this;if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=arguments[0],n=0,r=e.getChildBoundables().iterator();r.hasNext();){var o=r.next();o instanceof wp?n+=t.size(o):o instanceof mp&&(n+=1)}return n}},Ep.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next();o instanceof mp&&o.getItem()===e&&(n=o)}return null!==n&&(t.getChildBoundables().remove(n),!0)},Ep.prototype.itemsTree=function(){var t=this;if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new Ou:e}if(1===arguments.length){for(var n=arguments[0],r=new Ou,o=n.getChildBoundables().iterator();o.hasNext();){var i=o.next();if(i instanceof wp){var s=t.itemsTree(i);null!==s&&r.add(s)}else i instanceof mp?r.add(i.getItem()):iu.shouldNeverReachHere()}return r.size()<=0?null:r}},Ep.prototype.insert=function(t,e){iu.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new mp(t,e))},Ep.prototype.boundablesAtLevel=function(){var t=this;if(1===arguments.length){var e=arguments[0],n=new Ou;return this.boundablesAtLevel(e,this._root,n),n}if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2];if(iu.isTrue(r>-2),o.getLevel()===r)return i.add(o),null;for(var s=o.getChildBoundables().iterator();s.hasNext();){var a=s.next();a instanceof wp?t.boundablesAtLevel(r,a,i):(iu.isTrue(a instanceof mp),-1===r&&i.add(a))}return null}},Ep.prototype.query=function(){var t=this;if(1===arguments.length){var e=arguments[0];this.build();var n=new Ou;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,n),n}if(2===arguments.length){var r=arguments[0],o=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.query(r,this._root,o)}else if(3===arguments.length)if(Ll(arguments[2],vp)&&arguments[0]instanceof Object&&arguments[1]instanceof wp)for(var i=arguments[0],s=arguments[1],a=arguments[2],l=s.getChildBoundables(),u=0;u<l.size();u++){var c=l.get(u);t.getIntersectsOp().intersects(c.getBounds(),i)&&(c instanceof wp?t.query(i,c,a):c instanceof mp?a.visitItem(c.getItem()):iu.shouldNeverReachHere())}else if(Ll(arguments[2],Ru)&&arguments[0]instanceof Object&&arguments[1]instanceof wp)for(var p=arguments[0],h=arguments[1],d=arguments[2],f=h.getChildBoundables(),g=0;g<f.size();g++){var m=f.get(g);t.getIntersectsOp().intersects(m.getBounds(),p)&&(m instanceof wp?t.query(p,m,d):m instanceof mp?d.add(m.getItem()):iu.shouldNeverReachHere())}},Ep.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Ep.prototype.getRoot=function(){return this.build(),this._root},Ep.prototype.remove=function(){var t=this;if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,n)}if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2],s=this.removeItem(o,i);if(s)return!0;for(var a=null,l=o.getChildBoundables().iterator();l.hasNext();){var u=l.next();if(t.getIntersectsOp().intersects(u.getBounds(),r)&&u instanceof wp&&(s=t.remove(r,u,i))){a=u;break}}return null!==a&&a.getChildBoundables().isEmpty()&&o.getChildBoundables().remove(a),s}},Ep.prototype.createHigherLevels=function(t,e){iu.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},Ep.prototype.depth=function(){var t=this;if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=arguments[0],n=0,r=e.getChildBoundables().iterator();r.hasNext();){var o=r.next();if(o instanceof wp){var i=t.depth(o);i>n&&(n=i)}}return n+1}},Ep.prototype.createParentBoundables=function(t,e){var n=this;iu.isTrue(!t.isEmpty());var r=new Ou;r.add(this.createNode(e));var o=new Ou(t);bp.sort(o,this.getComparator());for(var i=o.iterator();i.hasNext();){var s=i.next();n.lastNode(r).getChildBoundables().size()===n.getNodeCapacity()&&r.add(n.createNode(e)),n.lastNode(r).addChildBoundable(s)}return r},Ep.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Ep.prototype.interfaces_=function(){return[Rl]},Ep.prototype.getClass=function(){return Ep},Ep.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},Sp.IntersectsOp.get=function(){return Tp},Sp.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Sp.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Ep,Sp);var Tp=function(){},Rp=function(){};Rp.prototype.distance=function(t,e){},Rp.prototype.interfaces_=function(){return[]},Rp.prototype.getClass=function(){return Rp};var Pp=function(t){function e(n){n=n||e.DEFAULT_NODE_CAPACITY,t.call(this,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(t,e){iu.isTrue(t.length>0);for(var n=new Ou,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},e.prototype.createNode=function(t){return new Op(t)},e.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),o=t.iterator(),i=0;i<e;i++){r[i]=new Ou;for(var s=0;o.hasNext()&&s<n;){var a=o.next();r[i].add(a),s++}}return r},e.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],r=arguments[1];t.prototype.query.call(this,n,r)}else if(3===arguments.length)if(Ll(arguments[2],vp)&&arguments[0]instanceof Object&&arguments[1]instanceof wp){var o=arguments[0],i=arguments[1],s=arguments[2];t.prototype.query.call(this,o,i,s)}else if(Ll(arguments[2],Ru)&&arguments[0]instanceof Object&&arguments[1]instanceof wp){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},e.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(t,n){iu.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),o=new Ou(t);bp.sort(o,e.xComparator);var i=this.verticalSlices(o,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(i,n)},e.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Ll(arguments[0],Rp)){var t=arguments[0],n=new xp(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof xp){var r=arguments[0];return this.nearestNeighbour(r,bl.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof e&&Ll(arguments[1],Rp)){var o=arguments[0],i=arguments[1],s=new xp(this.getRoot(),o.getRoot(),i);return this.nearestNeighbour(s)}if(arguments[0]instanceof xp&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=l,c=null,p=new yp;for(p.add(a);!p.isEmpty()&&u>0;){var h=p.poll(),d=h.getDistance();if(d>=u)break;h.isLeaves()?(u=d,c=h):h.expandToQueue(p,u)}return[c.getBoundable(0).getItem(),c.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[0],g=arguments[1],m=arguments[2],y=new mp(f,g),v=new xp(this.getRoot(),y,m);return this.nearestNeighbour(v)[0]}},e.prototype.interfaces_=function(){return[_p,Rl]},e.prototype.getClass=function(){return e},e.centreX=function(t){return e.avg(t.getMinX(),t.getMaxX())},e.avg=function(t,e){return(t+e)/2},e.centreY=function(t){return e.avg(t.getMinY(),t.getMaxY())},n.STRtreeNode.get=function(){return Op},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[Tl]},compare:function(n,r){return t.compareDoubles(e.centreX(n.getBounds()),e.centreX(r.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[Tl]},compare:function(n,r){return t.compareDoubles(e.centreY(n.getBounds()),e.centreY(r.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(Ep),Op=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new Zl(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(wp),Ip=function(){};Ip.prototype.interfaces_=function(){return[]},Ip.prototype.getClass=function(){return Ip},Ip.relativeSign=function(t,e){return t<e?-1:t>e?1:0},Ip.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=Ip.relativeSign(e.x,n.x),o=Ip.relativeSign(e.y,n.y);switch(t){case 0:return Ip.compareValue(r,o);case 1:return Ip.compareValue(o,r);case 2:return Ip.compareValue(o,-r);case 3:return Ip.compareValue(-r,o);case 4:return Ip.compareValue(-r,-o);case 5:return Ip.compareValue(-o,-r);case 6:return Ip.compareValue(-o,r);case 7:return Ip.compareValue(r,-o)}return iu.shouldNeverReachHere("invalid octant value"),0},Ip.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var Ap=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new Pl(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))};Ap.prototype.getCoordinate=function(){return this.coord},Ap.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Ap.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Ip.compare(this._segmentOctant,this.coord,e.coord)},Ap.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Ap.prototype.isInterior=function(){return this._isInterior},Ap.prototype.interfaces_=function(){return[El]},Ap.prototype.getClass=function(){return Ap};var Dp=function(){this._nodeMap=new Xu,this._edge=null;var t=arguments[0];this._edge=t};Dp.prototype.getSplitCoordinates=function(){var t=new Au;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},Dp.prototype.addCollapsedNodes=function(){var t=new Ou;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Dp.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Dp.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(new Gl(e+1))}},Dp.prototype.addEdgeCoordinates=function(t,e,n){var r=this._edge.getCoordinate(e.segmentIndex),o=e.isInterior()||!e.coord.equals2D(r);n.add(new Pl(t.coord),!1);for(var i=t.segmentIndex+1;i<=e.segmentIndex;i++)n.add(this._edge.getCoordinate(i));o&&n.add(new Pl(e.coord))},Dp.prototype.iterator=function(){return this._nodeMap.values().iterator()},Dp.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),o=this.createSplitEdge(n,r);t.add(o),n=r}},Dp.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)},Dp.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var o=n.next();this.findCollapseIndex(r,o,e)&&t.add(new Gl(e[0])),r=o}},Dp.prototype.getEdge=function(){return this._edge},Dp.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Dp.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),o=e.isInterior()||!e.coord.equals2D(r);o||n--;var i=new Array(n).fill(null),s=0;i[s++]=new Pl(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)i[s++]=this._edge.getCoordinate(a);return o&&(i[s]=new Pl(e.coord)),new Fp(i,this._edge.getData())},Dp.prototype.add=function(t,e){var n=new Ap(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return null!==r?(iu.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)},Dp.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new ru("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),o=r[r.length-1];if(!o.equals2D(e[e.length-1]))throw new ru("bad split edge end point at "+o)},Dp.prototype.interfaces_=function(){return[]},Dp.prototype.getClass=function(){return Dp};var Mp=function(){};Mp.prototype.interfaces_=function(){return[]},Mp.prototype.getClass=function(){return Mp},Mp.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Cl("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof Pl&&arguments[1]instanceof Pl){var o=arguments[0],i=arguments[1],s=i.x-o.x,a=i.y-o.y;if(0===s&&0===a)throw new Cl("Cannot compute the octant for two identical points "+o);return Mp.octant(s,a)}};var Lp=function(){};Lp.prototype.getCoordinates=function(){},Lp.prototype.size=function(){},Lp.prototype.getCoordinate=function(t){},Lp.prototype.isClosed=function(){},Lp.prototype.setData=function(t){},Lp.prototype.getData=function(){},Lp.prototype.interfaces_=function(){return[]},Lp.prototype.getClass=function(){return Lp};var Np=function(){};Np.prototype.addIntersection=function(t,e){},Np.prototype.interfaces_=function(){return[Lp]},Np.prototype.getClass=function(){return Np};var Fp=function(){this._nodeList=new Dp(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Fp.prototype.getCoordinates=function(){return this._pts},Fp.prototype.size=function(){return this._pts.length},Fp.prototype.getCoordinate=function(t){return this._pts[t]},Fp.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Fp.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Fp.prototype.setData=function(t){this._data=t},Fp.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Mp.octant(t,e)},Fp.prototype.getData=function(){return this._data},Fp.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[3],i=new Pl(n.getIntersection(o));this.addIntersection(i,r)}},Fp.prototype.toString=function(){return nu.toLineString(new Oc(this._pts))},Fp.prototype.getNodeList=function(){return this._nodeList},Fp.prototype.addIntersectionNode=function(t,e){var n=e,r=n+1;if(r<this._pts.length){var o=this._pts[r];t.equals2D(o)&&(n=r)}return this._nodeList.add(t,n)},Fp.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},Fp.prototype.interfaces_=function(){return[Np]},Fp.prototype.getClass=function(){return Fp},Fp.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Ou;return Fp.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],r=arguments[1],o=n.iterator();o.hasNext();){var i=o.next();i.getNodeList().addSplitEdges(r)}};var kp=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new Pl,this.p1=new Pl;else if(1===arguments.length){var t=arguments[0];this.p0=new Pl(t.p0),this.p1=new Pl(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this.p0=new Pl(e,n),this.p1=new Pl(r,o)}},Gp={serialVersionUID:{configurable:!0}};kp.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},kp.prototype.orientationIndex=function(){if(arguments[0]instanceof kp){var t=arguments[0],e=pu.orientationIndex(this.p0,this.p1,t.p0),n=pu.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof Pl){var r=arguments[0];return pu.orientationIndex(this.p0,this.p1,r)}},kp.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},kp.prototype.isVertical=function(){return this.p0.x===this.p1.x},kp.prototype.equals=function(t){if(!(t instanceof kp))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},kp.prototype.intersection=function(t){var e=new lu;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},kp.prototype.project=function(){if(arguments[0]instanceof Pl){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Pl(t);var e=this.projectionFactor(t),n=new Pl;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof kp){var r=arguments[0],o=this.projectionFactor(r.p0),i=this.projectionFactor(r.p1);if(o>=1&&i>=1)return null;if(o<=0&&i<=0)return null;var s=this.project(r.p0);o<0&&(s=this.p0),o>1&&(s=this.p1);var a=this.project(r.p1);return i<0&&(a=this.p0),i>1&&(a=this.p1),new kp(s,a)}},kp.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},kp.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},kp.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},kp.prototype.distancePerpendicular=function(t){return pu.distancePointLinePerpendicular(t,this.p0,this.p1)},kp.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},kp.prototype.midPoint=function(){return kp.midPoint(this.p0,this.p1)},kp.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?bl.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},kp.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=bl.MAX_VALUE,o=null,i=this.closestPoint(t.p0);r=i.distance(t.p0),n[0]=i,n[1]=t.p0;var s=this.closestPoint(t.p1);(o=s.distance(t.p1))<r&&(r=o,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(o=a.distance(this.p0))<r&&(r=o,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(o=l.distance(this.p1))<r&&(r=o,n[0]=this.p1,n[1]=l),n},kp.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},kp.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},kp.prototype.getLength=function(){return this.p0.distance(this.p1)},kp.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},kp.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},kp.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},kp.prototype.lineIntersection=function(t){try{return Yl.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof Xl))throw t}return null},kp.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},kp.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),o=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,s=Math.sqrt(o*o+i*i),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*o/s,l=e*i/s}return new Pl(n-l,r+a)},kp.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},kp.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||bl.isNaN(e))&&(e=1),e},kp.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},kp.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},kp.prototype.distance=function(){if(arguments[0]instanceof kp){var t=arguments[0];return pu.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof Pl){var e=arguments[0];return pu.distancePointLine(e,this.p0,this.p1)}},kp.prototype.pointAlong=function(t){var e=new Pl;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},kp.prototype.hashCode=function(){var t=bl.doubleToLongBits(this.p0.x);t^=31*bl.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=bl.doubleToLongBits(this.p1.x);return n^=31*bl.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},kp.prototype.interfaces_=function(){return[El,Rl]},kp.prototype.getClass=function(){return kp},kp.midPoint=function(t,e){return new Pl((t.x+e.x)/2,(t.y+e.y)/2)},Gp.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(kp,Gp);var Bp=function(){this.tempEnv1=new Zl,this.tempEnv2=new Zl,this._overlapSeg1=new kp,this._overlapSeg2=new kp};Bp.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Bp.prototype.interfaces_=function(){return[]},Bp.prototype.getClass=function(){return Bp};var Vp=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r};Vp.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Vp.prototype.computeSelect=function(t,e,n,r){var o=this._pts[e],i=this._pts[n];if(r.tempEnv1.init(o,i),n-e==1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,r),s<n&&this.computeSelect(t,s,n,r)},Vp.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},Vp.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Vp.prototype.setId=function(t){this._id=t},Vp.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Vp.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Zl(t,e)}return this._env},Vp.prototype.getEndIndex=function(){return this._end},Vp.prototype.getStartIndex=function(){return this._start},Vp.prototype.getContext=function(){return this._context},Vp.prototype.getId=function(){return this._id},Vp.prototype.computeOverlapsInternal=function(t,e,n,r,o,i){var s=this._pts[t],a=this._pts[e],l=n._pts[r],u=n._pts[o];if(e-t==1&&o-r==1)return i.overlap(this,t,n,r),null;if(i.tempEnv1.init(s,a),i.tempEnv2.init(l,u),!i.tempEnv1.intersects(i.tempEnv2))return null;var c=Math.trunc((t+e)/2),p=Math.trunc((r+o)/2);t<c&&(r<p&&this.computeOverlapsInternal(t,c,n,r,p,i),p<o&&this.computeOverlapsInternal(t,c,n,p,o,i)),c<e&&(r<p&&this.computeOverlapsInternal(c,e,n,r,p,i),p<o&&this.computeOverlapsInternal(c,e,n,p,o,i))},Vp.prototype.interfaces_=function(){return[]},Vp.prototype.getClass=function(){return Vp};var zp=function(){};zp.prototype.interfaces_=function(){return[]},zp.prototype.getClass=function(){return zp},zp.getChainStartIndices=function(t){var e=0,n=new Ou;n.add(new Gl(e));do{var r=zp.findChainEnd(t,e);n.add(new Gl(r)),e=r}while(e<t.length-1);return zp.toIntArray(n)},zp.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=lp.quadrant(t[n],t[n+1]),o=e+1;o<t.length&&(t[o-1].equals2D(t[o])||lp.quadrant(t[o-1],t[o])===r);)o++;return o-1},zp.getChains=function(){if(1===arguments.length){var t=arguments[0];return zp.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new Ou,o=zp.getChainStartIndices(e),i=0;i<o.length-1;i++){var s=new Vp(e,o[i],o[i+1],n);r.add(s)}return r}},zp.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var jp=function(){};jp.prototype.computeNodes=function(t){},jp.prototype.getNodedSubstrings=function(){},jp.prototype.interfaces_=function(){return[]},jp.prototype.getClass=function(){return jp};var Hp=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};Hp.prototype.setSegmentIntersector=function(t){this._segInt=t},Hp.prototype.interfaces_=function(){return[jp]},Hp.prototype.getClass=function(){return Hp};var Up=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Ou,this._index=new Pp,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Fp.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=this,n=zp.getChains(t.getCoordinates(),t).iterator();n.hasNext();){var r=n.next();r.setId(e._idCounter++),e._index.insert(r.getEnvelope(),r),e._monoChains.add(r)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=this,e=new Wp(this._segInt),n=this._monoChains.iterator();n.hasNext();)for(var r=n.next(),o=t._index.query(r.getEnvelope()).iterator();o.hasNext();){var i=o.next();if(i.getId()>r.getId()&&(r.computeOverlaps(i,e),t._nOverlaps++),t._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return Wp},Object.defineProperties(e,n),e}(Hp),Wp=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3],i=e.getContext(),s=r.getContext();this._si.processIntersections(i,n,s,o)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Bp),qp=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(4===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(i),this.setJoinStyle(s),this.setMitreLimit(a)}},Xp={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};qp.prototype.getEndCapStyle=function(){return this._endCapStyle},qp.prototype.isSingleSided=function(){return this._isSingleSided},qp.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=qp.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=qp.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==qp.JOIN_ROUND&&(this._quadrantSegments=qp.DEFAULT_QUADRANT_SEGMENTS)},qp.prototype.getJoinStyle=function(){return this._joinStyle},qp.prototype.setJoinStyle=function(t){this._joinStyle=t},qp.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},qp.prototype.getSimplifyFactor=function(){return this._simplifyFactor},qp.prototype.getQuadrantSegments=function(){return this._quadrantSegments},qp.prototype.setEndCapStyle=function(t){this._endCapStyle=t},qp.prototype.getMitreLimit=function(){return this._mitreLimit},qp.prototype.setMitreLimit=function(t){this._mitreLimit=t},qp.prototype.setSingleSided=function(t){this._isSingleSided=t},qp.prototype.interfaces_=function(){return[]},qp.prototype.getClass=function(){return qp},qp.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Xp.CAP_ROUND.get=function(){return 1},Xp.CAP_FLAT.get=function(){return 2},Xp.CAP_SQUARE.get=function(){return 3},Xp.JOIN_ROUND.get=function(){return 1},Xp.JOIN_MITRE.get=function(){return 2},Xp.JOIN_BEVEL.get=function(){return 3},Xp.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Xp.DEFAULT_MITRE_LIMIT.get=function(){return 5},Xp.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(qp,Xp);var Kp=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=pu.COUNTERCLOCKWISE,this._inputLine=t||null},Yp={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Kp.prototype.isDeletable=function(t,e,n,r){var o=this._inputLine[t],i=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(o,i,s)&&!!this.isShallow(o,i,s,r)&&this.isShallowSampled(o,i,t,n,r)},Kp.prototype.deleteShallowConcavities=function(){for(var t=this,e=1,n=this.findNextNonDeletedIndex(e),r=this.findNextNonDeletedIndex(n),o=!1;r<this._inputLine.length;){var i=!1;t.isDeletable(e,n,r,t._distanceTol)&&(t._isDeleted[n]=Kp.DELETE,i=!0,o=!0),e=i?r:n,n=t.findNextNonDeletedIndex(e),r=t.findNextNonDeletedIndex(n)}return o},Kp.prototype.isShallowConcavity=function(t,e,n,r){return pu.computeOrientation(t,e,n)===this._angleOrientation&&pu.distancePointLine(e,t,n)<r},Kp.prototype.isShallowSampled=function(t,e,n,r,o){var i=Math.trunc((r-n)/Kp.NUM_PTS_TO_CHECK);i<=0&&(i=1);for(var s=n;s<r;s+=i)if(!this.isShallow(t,e,this._inputLine[s],o))return!1;return!0},Kp.prototype.isConcave=function(t,e,n){return pu.computeOrientation(t,e,n)===this._angleOrientation},Kp.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=pu.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Kp.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Kp.DELETE;)e++;return e},Kp.prototype.isShallow=function(t,e,n,r){return pu.distancePointLine(e,t,n)<r},Kp.prototype.collapseLine=function(){for(var t=new Au,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Kp.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Kp.prototype.interfaces_=function(){return[]},Kp.prototype.getClass=function(){return Kp},Kp.simplify=function(t,e){return new Kp(t).simplify(e)},Yp.INIT.get=function(){return 0},Yp.DELETE.get=function(){return 1},Yp.KEEP.get=function(){return 1},Yp.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Kp,Yp);var Zp=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Ou},Qp={COORDINATE_ARRAY_TYPE:{configurable:!0}};Zp.prototype.getCoordinates=function(){return this._ptList.toArray(Zp.COORDINATE_ARRAY_TYPE)},Zp.prototype.setPrecisionModel=function(t){this._precisionModel=t},Zp.prototype.addPt=function(t){var e=new Pl(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Zp.prototype.revere=function(){},Zp.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;r>=0;r--)this.addPt(t[r])},Zp.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Zp.prototype.toString=function(){return(new Gc).createLineString(this.getCoordinates()).toString()},Zp.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new Pl(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Zp.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Zp.prototype.interfaces_=function(){return[]},Zp.prototype.getClass=function(){return Zp},Qp.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Zp,Qp);var Jp=function(){},$p={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Jp.prototype.interfaces_=function(){return[]},Jp.prototype.getClass=function(){return Jp},Jp.toDegrees=function(t){return 180*t/Math.PI},Jp.normalize=function(t){for(;t>Math.PI;)t-=Jp.PI_TIMES_2;for(;t<=-Math.PI;)t+=Jp.PI_TIMES_2;return t},Jp.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,o=n.y-e.y;return Math.atan2(o,r)}},Jp.isAcute=function(t,e,n){var r=t.x-e.x,o=t.y-e.y;return r*(n.x-e.x)+o*(n.y-e.y)>0},Jp.isObtuse=function(t,e,n){var r=t.x-e.x,o=t.y-e.y;return r*(n.x-e.x)+o*(n.y-e.y)<0},Jp.interiorAngle=function(t,e,n){var r=Jp.angle(e,t),o=Jp.angle(e,n);return Math.abs(o-r)},Jp.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Jp.PI_TIMES_2;t>=Jp.PI_TIMES_2&&(t=0)}else{for(;t>=Jp.PI_TIMES_2;)t-=Jp.PI_TIMES_2;t<0&&(t=0)}return t},Jp.angleBetween=function(t,e,n){var r=Jp.angle(e,t),o=Jp.angle(e,n);return Jp.diff(r,o)},Jp.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Jp.toRadians=function(t){return t*Math.PI/180},Jp.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Jp.COUNTERCLOCKWISE:n<0?Jp.CLOCKWISE:Jp.NONE},Jp.angleBetweenOriented=function(t,e,n){var r=Jp.angle(e,t),o=Jp.angle(e,n)-r;return o<=-Math.PI?o+Jp.PI_TIMES_2:o>Math.PI?o-Jp.PI_TIMES_2:o},$p.PI_TIMES_2.get=function(){return 2*Math.PI},$p.PI_OVER_2.get=function(){return Math.PI/2},$p.PI_OVER_4.get=function(){return Math.PI/4},$p.COUNTERCLOCKWISE.get=function(){return pu.COUNTERCLOCKWISE},$p.CLOCKWISE.get=function(){return pu.CLOCKWISE},$p.NONE.get=function(){return pu.COLLINEAR},Object.defineProperties(Jp,$p);var th=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new kp,this._seg1=new kp,this._offset0=new kp,this._offset1=new kp,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new lu,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===qp.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},eh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};th.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=pu.computeOrientation(this._s0,this._s1,this._s2),r=n===pu.CLOCKWISE&&this._side===qc.LEFT||n===pu.COUNTERCLOCKWISE&&this._side===qc.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},th.prototype.addLineEndCap=function(t,e){var n=new kp(t,e),r=new kp;this.computeOffsetSegment(n,qc.LEFT,this._distance,r);var o=new kp;this.computeOffsetSegment(n,qc.RIGHT,this._distance,o);var i=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,i);switch(this._bufParams.getEndCapStyle()){case qp.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,pu.CLOCKWISE,this._distance),this._segList.addPt(o.p1);break;case qp.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(o.p1);break;case qp.CAP_SQUARE:var l=new Pl;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new Pl(r.p1.x+l.x,r.p1.y+l.y),c=new Pl(o.p1.x+l.x,o.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},th.prototype.getCoordinates=function(){return this._segList.getCoordinates()},th.prototype.addMitreJoin=function(t,e,n,r){var o=!0,i=null;try{i=Yl.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:i.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(o=!1)}catch(t){if(!(t instanceof Xl))throw t;i=new Pl(0,0),o=!1}o?this._segList.addPt(i):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())},th.prototype.addFilletCorner=function(t,e,n,r,o){var i=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,i),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);r===pu.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,r,o),this._segList.addPt(n)},th.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*th.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===qp.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===qp.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},th.prototype.createSquare=function(t){this._segList.addPt(new Pl(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Pl(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Pl(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Pl(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},th.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},th.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},th.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},th.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},th.prototype.addLimitedMitreJoin=function(t,e,n,r){var o=this._seg0.p1,i=Jp.angle(o,this._seg0.p0),s=Jp.angleBetweenOriented(this._seg0.p0,o,this._seg1.p1)/2,a=Jp.normalize(i+s),l=Jp.normalize(a+Math.PI),u=r*n,c=n-u*Math.abs(Math.sin(s)),p=o.x+u*Math.cos(l),h=o.y+u*Math.sin(l),d=new Pl(p,h),f=new kp(o,d),g=f.pointAlongOffset(1,c),m=f.pointAlongOffset(1,-c);this._side===qc.LEFT?(this._segList.addPt(g),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(g))},th.prototype.computeOffsetSegment=function(t,e,n,r){var o=e===qc.LEFT?1:-1,i=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(i*i+s*s),l=o*n*i/a,u=o*n*s/a;r.p0.x=t.p0.x-u,r.p0.y=t.p0.y+l,r.p1.x=t.p1.x-u,r.p1.y=t.p1.y+l},th.prototype.addFilletArc=function(t,e,n,r,o){var i=r===pu.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new Pl;u<s;){var p=e+i*u;c.x=t.x+o*Math.cos(p),c.y=t.y+o*Math.sin(p),this._segList.addPt(c),u+=l}},th.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*th.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new Pl((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new Pl((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},th.prototype.createCircle=function(t){var e=new Pl(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},th.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},th.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Zp,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*th.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},th.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===qp.JOIN_BEVEL||this._bufParams.getJoinStyle()===qp.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,pu.CLOCKWISE,this._distance))},th.prototype.closeRing=function(){this._segList.closeRing()},th.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},th.prototype.interfaces_=function(){return[]},th.prototype.getClass=function(){return th},eh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},eh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},eh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},eh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(th,eh);var nh=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};nh.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,r=Math.abs(e),o=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],o):this.computeOffsetCurve(t,n,o);var i=o.getCoordinates();return n&&Du.reverse(i),i},nh.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var o=Kp.simplify(t,-r),i=o.length-1;n.initSideSegments(o[i],o[i-1],qc.LEFT),n.addFirstSegment();for(var s=i-2;s>=0;s--)n.addNextSegment(o[s],!0)}else{n.addSegments(t,!1);var a=Kp.simplify(t,r),l=a.length-1;n.initSideSegments(a[0],a[1],qc.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},nh.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);e===qc.RIGHT&&(r=-r);var o=Kp.simplify(t,r),i=o.length-1;n.initSideSegments(o[i-1],o[0],e);for(var s=1;s<=i;s++){var a=1!==s;n.addNextSegment(o[s],a)}n.closeRing()},nh.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=Kp.simplify(t,n),o=r.length-1;e.initSideSegments(r[0],r[1],qc.LEFT);for(var i=2;i<=o;i++)e.addNextSegment(r[i],!0);e.addLastSegment(),e.addLineEndCap(r[o-1],r[o]);var s=Kp.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],qc.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},nh.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case qp.CAP_ROUND:e.createCircle(t);break;case qp.CAP_SQUARE:e.createSquare(t)}},nh.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var o=e<0;this.computeSingleSidedBufferCurve(t,o,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()},nh.prototype.getBufferParameters=function(){return this._bufParams},nh.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},nh.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return nh.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()},nh.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var o=Kp.simplify(t,-r),i=o.length-1;n.initSideSegments(o[i],o[i-1],qc.LEFT),n.addFirstSegment();for(var s=i-2;s>=0;s--)n.addNextSegment(o[s],!0)}else{var a=Kp.simplify(t,r),l=a.length-1;n.initSideSegments(a[0],a[1],qc.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},nh.prototype.getSegGen=function(t){return new th(this._precisionModel,this._bufParams,t)},nh.prototype.interfaces_=function(){return[]},nh.prototype.getClass=function(){return nh},nh.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new Pl(t[n]);return e};var rh=function(){this._subgraphs=null,this._seg=new kp,this._cga=new pu;var t=arguments[0];this._subgraphs=t},oh={DepthSegment:{configurable:!0}};rh.prototype.findStabbedSegments=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],n=new Ou,r=this._subgraphs.iterator();r.hasNext();){var o=r.next(),i=o.getEnvelope();e.y<i.getMinY()||e.y>i.getMaxY()||t.findStabbedSegments(e,o.getDirectedEdges(),n)}return n}if(3===arguments.length)if(Ll(arguments[2],Ru)&&arguments[0]instanceof Pl&&arguments[1]instanceof pp)for(var s=arguments[0],a=arguments[1],l=arguments[2],u=a.getEdge().getCoordinates(),c=0;c<u.length-1;c++){t._seg.p0=u[c],t._seg.p1=u[c+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var p=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(p<s.x)&&!(t._seg.isHorizontal()||s.y<t._seg.p0.y||s.y>t._seg.p1.y||pu.computeOrientation(t._seg.p0,t._seg.p1,s)===pu.RIGHT)){var h=a.getDepth(qc.LEFT);t._seg.p0.equals(u[c])||(h=a.getDepth(qc.RIGHT));var d=new ih(t._seg,h);l.add(d)}}else if(Ll(arguments[2],Ru)&&arguments[0]instanceof Pl&&Ll(arguments[1],Ru))for(var f=arguments[0],g=arguments[1],m=arguments[2],y=g.iterator();y.hasNext();){var v=y.next();v.isForward()&&t.findStabbedSegments(f,v,m)}},rh.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:bp.min(e)._leftDepth},rh.prototype.interfaces_=function(){return[]},rh.prototype.getClass=function(){return rh},oh.DepthSegment.get=function(){return ih},Object.defineProperties(rh,oh);var ih=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new kp(t),this._leftDepth=e};ih.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!==(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},ih.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},ih.prototype.toString=function(){return this._upwardSeg.toString()},ih.prototype.interfaces_=function(){return[El]},ih.prototype.getClass=function(){return ih};var sh=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};sh.prototype.area=function(){return sh.area(this.p0,this.p1,this.p2)},sh.prototype.signedArea=function(){return sh.signedArea(this.p0,this.p1,this.p2)},sh.prototype.interpolateZ=function(t){if(null===t)throw new Cl("Supplied point is null.");return sh.interpolateZ(t,this.p0,this.p1,this.p2)},sh.prototype.longestSideLength=function(){return sh.longestSideLength(this.p0,this.p1,this.p2)},sh.prototype.isAcute=function(){return sh.isAcute(this.p0,this.p1,this.p2)},sh.prototype.circumcentre=function(){return sh.circumcentre(this.p0,this.p1,this.p2)},sh.prototype.area3D=function(){return sh.area3D(this.p0,this.p1,this.p2)},sh.prototype.centroid=function(){return sh.centroid(this.p0,this.p1,this.p2)},sh.prototype.inCentre=function(){return sh.inCentre(this.p0,this.p1,this.p2)},sh.prototype.interfaces_=function(){return[]},sh.prototype.getClass=function(){return sh},sh.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},sh.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},sh.det=function(t,e,n,r){return t*r-e*n},sh.interpolateZ=function(t,e,n,r){var o=e.x,i=e.y,s=n.x-o,a=r.x-o,l=n.y-i,u=r.y-i,c=s*u-a*l,p=t.x-o,h=t.y-i,d=(u*p-a*h)/c,f=(-l*p+s*h)/c;return e.z+d*(n.z-e.z)+f*(r.z-e.z)},sh.longestSideLength=function(t,e,n){var r=t.distance(e),o=e.distance(n),i=n.distance(t),s=r;return o>s&&(s=o),i>s&&(s=i),s},sh.isAcute=function(t,e,n){return!!Jp.isAcute(t,e,n)&&!!Jp.isAcute(e,n,t)&&!!Jp.isAcute(n,t,e)},sh.circumcentre=function(t,e,n){var r=n.x,o=n.y,i=t.x-r,s=t.y-o,a=e.x-r,l=e.y-o,u=2*sh.det(i,s,a,l),c=sh.det(s,i*i+s*s,l,a*a+l*l),p=sh.det(i,i*i+s*s,a,a*a+l*l);return new Pl(r-c/u,o+p/u)},sh.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,o=new Yl(t.x+n/2,t.y+r/2,1),i=new Yl(t.x-r+n/2,t.y+n+r/2,1);return new Yl(o,i)},sh.angleBisector=function(t,e,n){var r=e.distance(t),o=r/(r+e.distance(n)),i=n.x-t.x,s=n.y-t.y;return new Pl(t.x+o*i,t.y+o*s)},sh.area3D=function(t,e,n){var r=e.x-t.x,o=e.y-t.y,i=e.z-t.z,s=n.x-t.x,a=n.y-t.y,l=n.z-t.z,u=o*l-i*a,c=i*s-r*l,p=r*a-o*s,h=u*u+c*c+p*p;return Math.sqrt(h)/2},sh.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,o=(t.y+e.y+n.y)/3;return new Pl(r,o)},sh.inCentre=function(t,e,n){var r=e.distance(n),o=t.distance(n),i=t.distance(e),s=r+o+i,a=(r*t.x+o*e.x+i*n.x)/s,l=(r*t.y+o*e.y+i*n.y)/s;return new Pl(a,l)};var ah=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Ou;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};ah.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Dl.EXTERIOR,Dl.INTERIOR)},ah.prototype.addPolygon=function(t){var e=this,n=this._distance,r=qc.LEFT;this._distance<0&&(n=-this._distance,r=qc.RIGHT);var o=t.getExteriorRing(),i=Du.removeRepeatedPoints(o.getCoordinates());if(this._distance<0&&this.isErodedCompletely(o,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,n,r,Dl.EXTERIOR,Dl.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var a=t.getInteriorRingN(s),l=Du.removeRepeatedPoints(a.getCoordinates());e._distance>0&&e.isErodedCompletely(a,-e._distance)||e.addPolygonRing(l,n,qc.opposite(r),Dl.INTERIOR,Dl.EXTERIOR)}},ah.prototype.isTriangleErodedCompletely=function(t,e){var n=new sh(t[0],t[1],t[2]),r=n.inCentre();return pu.distancePointLine(r,n.p0,n.p1)<Math.abs(e)},ah.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Du.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Dl.EXTERIOR,Dl.INTERIOR)},ah.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var r=new Fp(t,new ep(0,Dl.BOUNDARY,e,n));this._curveList.add(r)},ah.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},ah.prototype.addPolygonRing=function(t,e,n,r,o){if(0===e&&t.length<bc.MINIMUM_VALID_SIZE)return null;var i=r,s=o;t.length>=bc.MINIMUM_VALID_SIZE&&pu.isCCW(t)&&(i=o,s=r,n=qc.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,i,s)},ah.prototype.add=function(t){if(t.isEmpty())return null;t instanceof wc?this.addPolygon(t):t instanceof mc?this.addLineString(t):t instanceof vc?this.addPoint(t):(t instanceof Cc||t instanceof oc||t instanceof xc||t instanceof rc)&&this.addCollection(t)},ah.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),o=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>o},ah.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},ah.prototype.interfaces_=function(){return[]},ah.prototype.getClass=function(){return ah};var lh=function(){};lh.prototype.locate=function(t){},lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh};var uh=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};uh.prototype.next=function(){if(this._atStart)return this._atStart=!1,uh.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Pu;var t=this._parent.getGeometryN(this._index++);return t instanceof rc?(this._subcollectionIterator=new uh(t),this._subcollectionIterator.next()):t},uh.prototype.remove=function(){throw new Error(this.getClass().getName())},uh.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},uh.prototype.interfaces_=function(){return[Tu]},uh.prototype.getClass=function(){return uh},uh.isAtomic=function(t){return!(t instanceof rc)};var ch=function(){this._geom=null;var t=arguments[0];this._geom=t};ch.prototype.locate=function(t){return ch.locate(t,this._geom)},ch.prototype.interfaces_=function(){return[lh]},ch.prototype.getClass=function(){return ch},ch.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&pu.isPointInRing(t,e.getCoordinates())},ch.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!ch.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r);if(ch.isPointInRing(t,o))return!1}return!0},ch.containsPoint=function(t,e){if(e instanceof wc)return ch.containsPointInPolygon(t,e);if(e instanceof rc)for(var n=new uh(e);n.hasNext();){var r=n.next();if(r!==e&&ch.containsPoint(t,r))return!0}return!1},ch.locate=function(t,e){return e.isEmpty()?Dl.EXTERIOR:ch.containsPoint(t,e)?Dl.INTERIOR:Dl.EXTERIOR};var ph=function(){this._edgeMap=new Xu,this._edgeList=null,this._ptInAreaLocation=[Dl.NONE,Dl.NONE]};ph.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},ph.prototype.propagateSideLabels=function(t){for(var e=Dl.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,qc.LEFT)!==Dl.NONE&&(e=r.getLocation(t,qc.LEFT))}if(e===Dl.NONE)return null;for(var o=e,i=this.iterator();i.hasNext();){var s=i.next(),a=s.getLabel();if(a.getLocation(t,qc.ON)===Dl.NONE&&a.setLocation(t,qc.ON,o),a.isArea(t)){var l=a.getLocation(t,qc.LEFT),u=a.getLocation(t,qc.RIGHT);if(u!==Dl.NONE){if(u!==o)throw new Qc("side location conflict",s.getCoordinate());l===Dl.NONE&&iu.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),o=l}else iu.isTrue(a.getLocation(t,qc.LEFT)===Dl.NONE,"found single null side"),a.setLocation(t,qc.RIGHT,o),a.setLocation(t,qc.LEFT,o)}}},ph.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},ph.prototype.print=function(t){Kl.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},ph.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},ph.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,qc.LEFT);iu.isTrue(r!==Dl.NONE,"Found unlabelled area edge");for(var o=r,i=this.iterator();i.hasNext();){var s=i.next().getLabel();iu.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,qc.LEFT),l=s.getLocation(t,qc.RIGHT);if(a===l)return!1;if(l!==o)return!1;o=a}return!0},ph.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},ph.prototype.iterator=function(){return this.getEdges().iterator()},ph.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Ou(this._edgeMap.values())),this._edgeList},ph.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===Dl.NONE&&(this._ptInAreaLocation[t]=ch.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},ph.prototype.toString=function(){var t=new kl;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},ph.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},ph.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),o=0;o<2;o++)r.isLine(o)&&r.getLocation(o)===Dl.BOUNDARY&&(e[o]=!0);for(var i=this.iterator();i.hasNext();)for(var s=i.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=Dl.NONE;if(e[l])u=Dl.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},ph.prototype.getDegree=function(){return this._edgeMap.size()},ph.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},ph.prototype.interfaces_=function(){return[]},ph.prototype.getClass=function(){return ph};var hh=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var t=this;this.getResultAreaEdges();for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,o=0;o<this._resultAreaEdgeList.size();o++){var i=t._resultAreaEdgeList.get(o),s=i.getSym();if(i.getLabel().isArea())switch(null===e&&i.isInResult()&&(e=i),r){case t._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;n=s,r=t._LINKING_TO_OUTGOING;break;case t._LINKING_TO_OUTGOING:if(!i.isInResult())continue;n.setNext(i),r=t._SCANNING_FOR_INCOMING}}if(r===this._LINKING_TO_OUTGOING){if(null===e)throw new Qc("no outgoing dirEdge found",this.getCoordinate());iu.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),n.setNext(e)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),o=n.getQuadrant(),i=r.getQuadrant();return lp.isNorthern(o)&&lp.isNorthern(i)?n:lp.isNorthern(o)||lp.isNorthern(i)?0!==n.getDy()?n:0!==r.getDy()?r:(iu.shouldNeverReachHere("found two horizontal edges incident on node"),null):r},e.prototype.print=function(t){Kl.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Ou;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var r=this._edgeList.get(n),o=r.getSym();null===e&&(e=o),null!==t&&o.setNext(t),t=r}e.setNext(t)},e.prototype.computeDepths=function(){var t=this;if(1===arguments.length){var e=arguments[0],n=this.findIndex(e),r=e.getDepth(qc.LEFT),o=e.getDepth(qc.RIGHT),i=this.computeDepths(n+1,this._edgeList.size(),r),s=this.computeDepths(0,n,i);if(s!==o)throw new Qc("depth mismatch at "+e.getCoordinate())}else if(3===arguments.length){for(var a=arguments[0],l=arguments[1],u=arguments[2],c=u,p=a;p<l;p++){var h=t._edgeList.get(p);h.setEdgeDepths(qc.RIGHT,c),c=h.getDepth(qc.LEFT)}return c}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=this,n=null,r=null,o=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var s=e._resultAreaEdgeList.get(i),a=s.getSym();switch(null===n&&s.getEdgeRing()===t&&(n=s),o){case e._SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;r=a,o=e._LINKING_TO_OUTGOING;break;case e._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;r.setNextMin(s),o=e._SCANNING_FOR_INCOMING}}o===this._LINKING_TO_OUTGOING&&(iu.isTrue(null!==n,"found null for first outgoing dirEdge"),iu.isTrue(n.getEdgeRing()===t,"unable to link last incoming dirEdge"),r.setNextMin(n))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();){var n=e.next();n.isInResult()&&t++}return t}if(1===arguments.length){for(var r=arguments[0],o=0,i=this.iterator();i.hasNext();){var s=i.next();s.getEdgeRing()===r&&o++}return o}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=Dl.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=Dl.INTERIOR;break}if(r.isInResult()){t=Dl.EXTERIOR;break}}}if(t===Dl.NONE)return null;for(var o=t,i=this.iterator();i.hasNext();){var s=i.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(o===Dl.INTERIOR):(s.isInResult()&&(o=Dl.EXTERIOR),a.isInResult()&&(o=Dl.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new ep(Dl.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),o=0;o<2;o++){var i=r.getLocation(o);i!==Dl.INTERIOR&&i!==Dl.BOUNDARY||this._label.setLocation(o,Dl.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ph),dh=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new sp(t,new hh)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hp),fh=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};fh.prototype.compareTo=function(t){var e=t;return fh.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},fh.prototype.interfaces_=function(){return[El]},fh.prototype.getClass=function(){return fh},fh.orientation=function(t){return 1===Du.increasingDirection(t)},fh.compareOriented=function(t,e,n,r){for(var o=e?1:-1,i=r?1:-1,s=e?t.length:-1,a=r?n.length:-1,l=e?0:t.length-1,u=r?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var p=(l+=o)===s,h=(u+=i)===a;if(p&&!h)return-1;if(!p&&h)return 1;if(p&&h)return 0}};var gh=function(){this._edges=new Ou,this._ocaMap=new Xu};gh.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),o=0;o<r.length;o++)o>0&&t.print(","),t.print(r[o].x+" "+r[o].y);t.println(")")}t.print(")  ")},gh.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},gh.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},gh.prototype.iterator=function(){return this._edges.iterator()},gh.prototype.getEdges=function(){return this._edges},gh.prototype.get=function(t){return this._edges.get(t)},gh.prototype.findEqualEdge=function(t){var e=new fh(t.getCoordinates());return this._ocaMap.get(e)},gh.prototype.add=function(t){this._edges.add(t);var e=new fh(t.getCoordinates());this._ocaMap.put(e,t)},gh.prototype.interfaces_=function(){return[]},gh.prototype.getClass=function(){return gh};var mh=function(){};mh.prototype.processIntersections=function(t,e,n,r){},mh.prototype.isDone=function(){},mh.prototype.interfaces_=function(){return[]},mh.prototype.getClass=function(){return mh};var yh=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};yh.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(yh.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var o=t.size()-1;if(0===e&&r===o||0===r&&e===o)return!0}}return!1},yh.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},yh.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},yh.prototype.getLineIntersector=function(){return this._li},yh.prototype.hasProperIntersection=function(){return this._hasProper},yh.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var o=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(o,i,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},yh.prototype.hasIntersection=function(){return this._hasIntersection},yh.prototype.isDone=function(){return!1},yh.prototype.hasInteriorIntersection=function(){return this._hasInterior},yh.prototype.interfaces_=function(){return[mh]},yh.prototype.getClass=function(){return yh},yh.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var vh=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new Pl(t),this.segmentIndex=e,this.dist=n};vh.prototype.getSegmentIndex=function(){return this.segmentIndex},vh.prototype.getCoordinate=function(){return this.coord},vh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},vh.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},vh.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},vh.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},vh.prototype.getDistance=function(){return this.dist},vh.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},vh.prototype.interfaces_=function(){return[El]},vh.prototype.getClass=function(){return vh};var _h=function(){this._nodeMap=new Xu,this.edge=null;var t=arguments[0];this.edge=t};_h.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},_h.prototype.iterator=function(){return this._nodeMap.values().iterator()},_h.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),o=this.createSplitEdge(n,r);t.add(o),n=r}},_h.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},_h.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],o=e.dist>0||!e.coord.equals2D(r);o||n--;var i=new Array(n).fill(null),s=0;i[s++]=new Pl(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)i[s++]=this.edge.pts[a];return o&&(i[s]=e.coord),new Eh(i,new ep(this.edge._label))},_h.prototype.add=function(t,e,n){var r=new vh(t,e,n),o=this._nodeMap.get(r);return null!==o?o:(this._nodeMap.put(r,r),r)},_h.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},_h.prototype.interfaces_=function(){return[]},_h.prototype.getClass=function(){return _h};var wh=function(){};wh.prototype.getChainStartIndices=function(t){var e=0,n=new Ou;n.add(new Gl(e));do{var r=this.findChainEnd(t,e);n.add(new Gl(r)),e=r}while(e<t.length-1);return wh.toIntArray(n)},wh.prototype.findChainEnd=function(t,e){for(var n=lp.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&lp.quadrant(t[r-1],t[r])===n;)r++;return r-1},wh.prototype.interfaces_=function(){return[]},wh.prototype.getClass=function(){return wh},wh.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Ch=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Zl,this.env2=new Zl;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new wh;this.startIndex=e.getChainStartIndices(this.pts)};Ch.prototype.getCoordinates=function(){return this.pts},Ch.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Ch.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Ch.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[o],p=this.pts[i],h=s.pts[a],d=s.pts[l];if(i-o==1&&l-a==1)return u.addIntersections(this.e,o,s.e,a),null;if(this.env1.init(c,p),this.env2.init(h,d),!this.env1.intersects(this.env2))return null;var f=Math.trunc((o+i)/2),g=Math.trunc((a+l)/2);o<f&&(a<g&&this.computeIntersectsForChain(o,f,s,a,g,u),g<l&&this.computeIntersectsForChain(o,f,s,g,l,u)),f<i&&(a<g&&this.computeIntersectsForChain(f,i,s,a,g,u),g<l&&this.computeIntersectsForChain(f,i,s,g,l,u))}},Ch.prototype.getStartIndexes=function(){return this.startIndex},Ch.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},Ch.prototype.interfaces_=function(){return[]},Ch.prototype.getClass=function(){return Ch};var bh=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},xh={NULL_VALUE:{configurable:!0}};bh.prototype.getDepth=function(t,e){return this._depth[t][e]},bh.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},bh.prototype.isNull=function(){var t=this;if(0===arguments.length){for(var e=0;e<2;e++)for(var n=0;n<3;n++)if(t._depth[e][n]!==bh.NULL_VALUE)return!1;return!0}if(1===arguments.length){var r=arguments[0];return this._depth[r][1]===bh.NULL_VALUE}if(2===arguments.length){var o=arguments[0],i=arguments[1];return this._depth[o][i]===bh.NULL_VALUE}},bh.prototype.normalize=function(){for(var t=this,e=0;e<2;e++)if(!t.isNull(e)){var n=t._depth[e][1];t._depth[e][2]<n&&(n=t._depth[e][2]),n<0&&(n=0);for(var r=1;r<3;r++){var o=0;t._depth[e][r]>n&&(o=1),t._depth[e][r]=o}}},bh.prototype.getDelta=function(t){return this._depth[t][qc.RIGHT]-this._depth[t][qc.LEFT]},bh.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?Dl.EXTERIOR:Dl.INTERIOR},bh.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},bh.prototype.add=function(){var t=this;if(1===arguments.length)for(var e=arguments[0],n=0;n<2;n++)for(var r=1;r<3;r++){var o=e.getLocation(n,r);o!==Dl.EXTERIOR&&o!==Dl.INTERIOR||(t.isNull(n,r)?t._depth[n][r]=bh.depthAtLocation(o):t._depth[n][r]+=bh.depthAtLocation(o))}else if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2];a===Dl.INTERIOR&&this._depth[i][s]++}},bh.prototype.interfaces_=function(){return[]},bh.prototype.getClass=function(){return bh},bh.depthAtLocation=function(t){return t===Dl.EXTERIOR?0:t===Dl.INTERIOR?1:bh.NULL_VALUE},xh.NULL_VALUE.get=function(){return-1},Object.defineProperties(bh,xh);var Eh=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new _h(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new bh,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.pts=r,this._label=o}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,ep.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,o=!0,i=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(r=!1),this.pts[s].equals2D(n.pts[--i])||(o=!1),!r&&!o)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Ch(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new Zl;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,r){var o=new Pl(t.getIntersection(r)),i=e,s=t.getEdgeDistance(n,r),a=i+1;if(a<this.pts.length){var l=this.pts[a];o.equals2D(l)&&(i=a,s=0)}this.eiList.add(o,i,s)},e.prototype.toString=function(){var t=new kl;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,qc.ON),e.getLocation(1,qc.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,qc.LEFT),e.getLocation(1,qc.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,qc.RIGHT),e.getLocation(1,qc.RIGHT),2))},e}(ip),Sh=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new gh,this._bufParams=t||null};Sh.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Sh.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new ep(t.getLabel())).flip(),n.merge(r);var o=Sh.depthDelta(r),i=e.getDepthDelta()+o;e.setDepthDelta(i)}else this._edgeList.add(t),t.setDepthDelta(Sh.depthDelta(t.getLabel()))},Sh.prototype.buildSubgraphs=function(t,e){for(var n=new Ou,r=t.iterator();r.hasNext();){var o=r.next(),i=o.getRightmostCoordinate(),s=new rh(n).getDepth(i);o.computeDepth(s),o.findResultEdges(),n.add(o),e.add(o.getDirectedEdges(),o.getNodes())}},Sh.prototype.createSubgraphs=function(t){for(var e=new Ou,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var o=new $c;o.create(r),e.add(o)}}return bp.sort(e,bp.reverseOrder()),e},Sh.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Sh.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new Up,n=new lu;return n.setPrecisionModel(t),e.setSegmentIntersector(new yh(n)),e},Sh.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new nh(n,this._bufParams),o=new ah(t,e,r).getCurves();if(o.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(o,n),this._graph=new dp(new dh),this._graph.addEdges(this._edgeList.getEdges());var i=this.createSubgraphs(this._graph),s=new fp(this._geomFact);this.buildSubgraphs(i,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},Sh.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var o=r.next(),i=o.getCoordinates();if(2!==i.length||!i[0].equals2D(i[1])){var s=o.getData(),a=new Eh(o.getCoordinates(),new ep(s));this.insertUniqueEdge(a)}}},Sh.prototype.setNoder=function(t){this._workingNoder=t},Sh.prototype.interfaces_=function(){return[]},Sh.prototype.getClass=function(){return Sh},Sh.depthDelta=function(t){var e=t.getLocation(0,qc.LEFT),n=t.getLocation(0,qc.RIGHT);return e===Dl.INTERIOR&&n===Dl.EXTERIOR?1:e===Dl.EXTERIOR&&n===Dl.INTERIOR?-1:0},Sh.convertSegStrings=function(t){for(var e=new Gc,n=new Ou;t.hasNext();){var r=t.next(),o=e.createLineString(r.getCoordinates());n.add(o)}return e.buildGeometry(n)};var Th=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],i=arguments[3];this._noder=n,this._scaleFactor=r,this._offsetX=o,this._offsetY=i,this._isScaled=!this.isIntegerPrecision()}};Th.prototype.rescale=function(){var t=this;if(Ll(arguments[0],Eu))for(var e=arguments[0],n=e.iterator();n.hasNext();){var r=n.next();t.rescale(r.getCoordinates())}else if(arguments[0]instanceof Array){for(var o=arguments[0],i=0;i<o.length;i++)o[i].x=o[i].x/t._scaleFactor+t._offsetX,o[i].y=o[i].y/t._scaleFactor+t._offsetY;2===o.length&&o[0].equals2D(o[1])&&Kl.out.println(o)}},Th.prototype.scale=function(){var t=this;if(Ll(arguments[0],Eu)){for(var e=arguments[0],n=new Ou,r=e.iterator();r.hasNext();){var o=r.next();n.add(new Fp(t.scale(o.getCoordinates()),o.getData()))}return n}if(arguments[0]instanceof Array){for(var i=arguments[0],s=new Array(i.length).fill(null),a=0;a<i.length;a++)s[a]=new Pl(Math.round((i[a].x-t._offsetX)*t._scaleFactor),Math.round((i[a].y-t._offsetY)*t._scaleFactor),i[a].z);var l=Du.removeRepeatedPoints(s);return l}},Th.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Th.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Th.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Th.prototype.interfaces_=function(){return[jp]},Th.prototype.getClass=function(){return Th};var Rh=function(){this._li=new lu,this._segStrings=null;var t=arguments[0];this._segStrings=t},Ph={fact:{configurable:!0}};Rh.prototype.checkEndPtVertexIntersections=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next(),r=n.getCoordinates();t.checkEndPtVertexIntersections(r[0],t._segStrings),t.checkEndPtVertexIntersections(r[r.length-1],t._segStrings)}else if(2===arguments.length)for(var o=arguments[0],i=arguments[1],s=i.iterator();s.hasNext();)for(var a=s.next(),l=a.getCoordinates(),u=1;u<l.length-1;u++)if(l[u].equals(o))throw new ru("found endpt/interior pt intersection at index "+u+" :pt "+o)},Rh.prototype.checkInteriorIntersections=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var n=e.next(),r=this._segStrings.iterator();r.hasNext();){var o=r.next();t.checkInteriorIntersections(n,o)}else if(2===arguments.length)for(var i=arguments[0],s=arguments[1],a=i.getCoordinates(),l=s.getCoordinates(),u=0;u<a.length-1;u++)for(var c=0;c<l.length-1;c++)t.checkInteriorIntersections(i,u,s,c);else if(4===arguments.length){var p=arguments[0],h=arguments[1],d=arguments[2],f=arguments[3];if(p===d&&h===f)return null;var g=p.getCoordinates()[h],m=p.getCoordinates()[h+1],y=d.getCoordinates()[f],v=d.getCoordinates()[f+1];if(this._li.computeIntersection(g,m,y,v),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,m)||this.hasInteriorIntersection(this._li,y,v)))throw new ru("found non-noded intersection at "+g+"-"+m+" and "+y+"-"+v)}},Rh.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Rh.prototype.checkCollapses=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next();t.checkCollapses(n)}else if(1===arguments.length)for(var r=arguments[0],o=r.getCoordinates(),i=0;i<o.length-2;i++)t.checkCollapse(o[i],o[i+1],o[i+2])},Rh.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var o=t.getIntersection(r);if(!o.equals(e)&&!o.equals(n))return!0}return!1},Rh.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new ru("found non-noded collapse at "+Rh.fact.createLineString([t,e,n]))},Rh.prototype.interfaces_=function(){return[]},Rh.prototype.getClass=function(){return Rh},Ph.fact.get=function(){return new Gc},Object.defineProperties(Rh,Ph);var Oh=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new Cl("Scale factor must be non-zero");1!==e&&(this._pt=new Pl(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new Pl,this._p1Scaled=new Pl),this.initCorners(this._pt)},Ih={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Oh.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),o=Math.min(t.y,e.y),i=Math.max(t.y,e.y),s=this._maxx<n||this._minx>r||this._maxy<o||this._miny>i;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return iu.isTrue(!(s&&a),"Found bad envelope test"),a},Oh.prototype.initCorners=function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new Pl(this._maxx,this._maxy),this._corner[1]=new Pl(this._minx,this._maxy),this._corner[2]=new Pl(this._minx,this._miny),this._corner[3]=new Pl(this._maxx,this._miny)},Oh.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Oh.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},Oh.prototype.getCoordinate=function(){return this._originalPt},Oh.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},Oh.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Oh.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Zl(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},Oh.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},Oh.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!r)||!!t.equals(this._pt)||!!e.equals(this._pt))))},Oh.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},Oh.prototype.interfaces_=function(){return[]},Oh.prototype.getClass=function(){return Oh},Ih.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Oh,Ih);var Ah=function(){this.tempEnv1=new Zl,this.selectedSegment=new kp};Ah.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},Ah.prototype.interfaces_=function(){return[]},Ah.prototype.getClass=function(){return Ah};var Dh=function(){this._index=null;var t=arguments[0];this._index=t},Mh={HotPixelSnapAction:{configurable:!0}};Dh.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],o=e.getSafeEnvelope(),i=new Lh(e,n,r);return this._index.query(o,{interfaces_:function(){return[vp]},visitItem:function(t){t.select(o,i)}}),i.isNodeAdded()}},Dh.prototype.interfaces_=function(){return[]},Dh.prototype.getClass=function(){return Dh},Mh.HotPixelSnapAction.get=function(){return Lh},Object.defineProperties(Dh,Mh);var Lh=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],n=arguments[1],r=e.getContext();if(null!==this._parentEdge&&r===this._parentEdge&&n===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(r,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ah),Nh=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Ou};Nh.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;var o=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];if(this._li.computeIntersection(o,i,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}},Nh.prototype.isDone=function(){return!1},Nh.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Nh.prototype.interfaces_=function(){return[mh]},Nh.prototype.getClass=function(){return Nh};var Fh=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new lu,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};Fh.prototype.checkCorrectness=function(t){var e=Fp.getNodedSubstrings(t),n=new Rh(e);try{n.checkValid()}catch(t){if(!(t instanceof ql))throw t;t.printStackTrace()}},Fh.prototype.getNodedSubstrings=function(){return Fp.getNodedSubstrings(this._nodedSegStrings)},Fh.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},Fh.prototype.findInteriorIntersections=function(t,e){var n=new Nh(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},Fh.prototype.computeVertexSnaps=function(){var t=this;if(Ll(arguments[0],Eu))for(var e=arguments[0],n=e.iterator();n.hasNext();){var r=n.next();t.computeVertexSnaps(r)}else if(arguments[0]instanceof Fp)for(var o=arguments[0],i=o.getCoordinates(),s=0;s<i.length;s++){var a=new Oh(i[s],t._scaleFactor,t._li),l=t._pointSnapper.snap(a,o,s);l&&o.addIntersection(i[s],s)}},Fh.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new Up,this._pointSnapper=new Dh(this._noder.getIndex()),this.snapRound(t,this._li)},Fh.prototype.computeIntersectionSnaps=function(t){for(var e=this,n=t.iterator();n.hasNext();){var r=n.next(),o=new Oh(r,e._scaleFactor,e._li);e._pointSnapper.snap(o)}},Fh.prototype.interfaces_=function(){return[jp]},Fh.prototype.getClass=function(){return Fh};var kh=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new qp,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},Gh={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};kh.prototype.bufferFixedPrecision=function(t){var e=new Th(new Fh(new Lc(1)),t.getScale()),n=new Sh(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},kh.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=kh.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Qc))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],r=kh.precisionScaleFactor(this._argGeom,this._distance,n),o=new Lc(r);this.bufferFixedPrecision(o)}},kh.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Lc.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},kh.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},kh.prototype.bufferOriginalPrecision=function(){try{var t=new Sh(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof ru))throw t;this._saveException=t}},kh.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},kh.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},kh.prototype.interfaces_=function(){return[]},kh.prototype.getClass=function(){return kh},kh.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new kh(t),r=n.getResultGeometry(e);return r}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof fu&&"number"==typeof arguments[1]){var o=arguments[0],i=arguments[1],s=arguments[2],a=new kh(o);a.setQuadrantSegments(s);var l=a.getResultGeometry(i);return l}if(arguments[2]instanceof qp&&arguments[0]instanceof fu&&"number"==typeof arguments[1]){var u=arguments[0],c=arguments[1],p=arguments[2],h=new kh(u,p),d=h.getResultGeometry(c);return d}}else if(4===arguments.length){var f=arguments[0],g=arguments[1],m=arguments[2],y=arguments[3],v=new kh(f);v.setQuadrantSegments(m),v.setEndCapStyle(y);var _=v.getResultGeometry(g);return _}},kh.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),o=Nl.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),i=n-Math.trunc(Math.log(o)/Math.log(10)+1);return Math.pow(10,i)},Gh.CAP_ROUND.get=function(){return qp.CAP_ROUND},Gh.CAP_BUTT.get=function(){return qp.CAP_FLAT},Gh.CAP_FLAT.get=function(){return qp.CAP_FLAT},Gh.CAP_SQUARE.get=function(){return qp.CAP_SQUARE},Gh.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(kh,Gh);var Bh=function(){this._pt=[new Pl,new Pl],this._distance=bl.NaN,this._isNull=!0};Bh.prototype.getCoordinates=function(){return this._pt},Bh.prototype.getCoordinate=function(t){return this._pt[t]},Bh.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},Bh.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=o,this._isNull=!1}},Bh.prototype.getDistance=function(){return this._distance},Bh.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},Bh.prototype.interfaces_=function(){return[]},Bh.prototype.getClass=function(){return Bh};var Vh=function(){};Vh.prototype.interfaces_=function(){return[]},Vh.prototype.getClass=function(){return Vh},Vh.computeDistance=function(){if(arguments[2]instanceof Bh&&arguments[0]instanceof mc&&arguments[1]instanceof Pl)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=t.getCoordinates(),o=new kp,i=0;i<r.length-1;i++){o.setCoordinates(r[i],r[i+1]);var s=o.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Bh&&arguments[0]instanceof wc&&arguments[1]instanceof Pl){var a=arguments[0],l=arguments[1],u=arguments[2];Vh.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Vh.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Bh&&arguments[0]instanceof fu&&arguments[1]instanceof Pl){var p=arguments[0],h=arguments[1],d=arguments[2];if(p instanceof mc)Vh.computeDistance(p,h,d);else if(p instanceof wc)Vh.computeDistance(p,h,d);else if(p instanceof rc)for(var f=p,g=0;g<f.getNumGeometries();g++){var m=f.getGeometryN(g);Vh.computeDistance(m,h,d)}else d.setMinimum(p.getCoordinate(),h)}else if(arguments[2]instanceof Bh&&arguments[0]instanceof kp&&arguments[1]instanceof Pl){var y=arguments[0],v=arguments[1],_=arguments[2],w=y.closestPoint(v);_.setMinimum(w,v)}};var zh=function(t){this._maxPtDist=new Bh,this._inputGeom=t||null},jh={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};zh.prototype.computeMaxMidpointDistance=function(t){var e=new Uh(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},zh.prototype.computeMaxVertexDistance=function(t){var e=new Hh(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},zh.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},zh.prototype.getDistancePoints=function(){return this._maxPtDist},zh.prototype.interfaces_=function(){return[]},zh.prototype.getClass=function(){return zh},jh.MaxPointDistanceFilter.get=function(){return Hh},jh.MaxMidpointDistanceFilter.get=function(){return Uh},Object.defineProperties(zh,jh);var Hh=function(t){this._maxPtDist=new Bh,this._minPtDist=new Bh,this._geom=t||null};Hh.prototype.filter=function(t){this._minPtDist.initialize(),Vh.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Hh.prototype.getMaxPointDistance=function(){return this._maxPtDist},Hh.prototype.interfaces_=function(){return[yu]},Hh.prototype.getClass=function(){return Hh};var Uh=function(t){this._maxPtDist=new Bh,this._minPtDist=new Bh,this._geom=t||null};Uh.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),r=t.getCoordinate(e),o=new Pl((n.x+r.x)/2,(n.y+r.y)/2);this._minPtDist.initialize(),Vh.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Uh.prototype.isDone=function(){return!1},Uh.prototype.isGeometryChanged=function(){return!1},Uh.prototype.getMaxPointDistance=function(){return this._maxPtDist},Uh.prototype.interfaces_=function(){return[nc]},Uh.prototype.getClass=function(){return Uh};var Wh=function(t){this._comps=t||null};Wh.prototype.filter=function(t){t instanceof wc&&this._comps.add(t)},Wh.prototype.interfaces_=function(){return[ec]},Wh.prototype.getClass=function(){return Wh},Wh.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Wh.getPolygons(t,new Ou)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof wc?n.add(e):e instanceof rc&&e.apply(new Wh(n)),n}};var qh=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};qh.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof bc){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof mc&&this._lines.add(t)},qh.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},qh.prototype.interfaces_=function(){return[du]},qh.prototype.getClass=function(){return qh},qh.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(qh.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(qh.getLines(e,n))}},qh.getLines=function(){if(1===arguments.length){var t=arguments[0];return qh.getLines(t,!1)}if(2===arguments.length){if(Ll(arguments[0],Eu)&&Ll(arguments[1],Eu)){for(var e=arguments[0],n=arguments[1],r=e.iterator();r.hasNext();){var o=r.next();qh.getLines(o,n)}return n}if(arguments[0]instanceof fu&&"boolean"==typeof arguments[1]){var i=arguments[0],s=arguments[1],a=new Ou;return i.apply(new qh(a,s)),a}if(arguments[0]instanceof fu&&Ll(arguments[1],Eu)){var l=arguments[0],u=arguments[1];return l instanceof mc?u.add(l):l.apply(new qh(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Ll(arguments[0],Eu)&&Ll(arguments[1],Eu)){for(var c=arguments[0],p=arguments[1],h=arguments[2],d=c.iterator();d.hasNext();){var f=d.next();qh.getLines(f,p,h)}return p}if("boolean"==typeof arguments[2]&&arguments[0]instanceof fu&&Ll(arguments[1],Eu)){var g=arguments[0],m=arguments[1],y=arguments[2];return g.apply(new qh(m,y)),m}}};var Xh=function(){if(this._boundaryRule=vu.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new Cl("Rule must be non-null");this._boundaryRule=t}};Xh.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof Pl&&arguments[1]instanceof wc){var e=arguments[0],n=arguments[1];if(n.isEmpty())return Dl.EXTERIOR;var r=n.getExteriorRing(),o=this.locateInPolygonRing(e,r);if(o===Dl.EXTERIOR)return Dl.EXTERIOR;if(o===Dl.BOUNDARY)return Dl.BOUNDARY;for(var i=0;i<n.getNumInteriorRing();i++){var s=n.getInteriorRingN(i),a=t.locateInPolygonRing(e,s);if(a===Dl.INTERIOR)return Dl.EXTERIOR;if(a===Dl.BOUNDARY)return Dl.BOUNDARY}return Dl.INTERIOR}if(arguments[0]instanceof Pl&&arguments[1]instanceof mc){var l=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(l))return Dl.EXTERIOR;var c=u.getCoordinates();return u.isClosed()||!l.equals(c[0])&&!l.equals(c[c.length-1])?pu.isOnLine(l,c)?Dl.INTERIOR:Dl.EXTERIOR:Dl.BOUNDARY}if(arguments[0]instanceof Pl&&arguments[1]instanceof vc){var p=arguments[0],h=arguments[1],d=h.getCoordinate();return d.equals2D(p)?Dl.INTERIOR:Dl.EXTERIOR}},Xh.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?pu.locatePointInRing(t,e.getCoordinates()):Dl.EXTERIOR},Xh.prototype.intersects=function(t,e){return this.locate(t,e)!==Dl.EXTERIOR},Xh.prototype.updateLocationInfo=function(t){t===Dl.INTERIOR&&(this._isIn=!0),t===Dl.BOUNDARY&&this._numBoundaries++},Xh.prototype.computeLocation=function(t,e){var n=this;if(e instanceof vc&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof mc)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof wc)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof oc)for(var r=e,o=0;o<r.getNumGeometries();o++){var i=r.getGeometryN(o);n.updateLocationInfo(n.locateInternal(t,i))}else if(e instanceof xc)for(var s=e,a=0;a<s.getNumGeometries();a++){var l=s.getGeometryN(a);n.updateLocationInfo(n.locateInternal(t,l))}else if(e instanceof rc)for(var u=new uh(e);u.hasNext();){var c=u.next();c!==e&&n.computeLocation(t,c)}},Xh.prototype.locate=function(t,e){return e.isEmpty()?Dl.EXTERIOR:e instanceof mc||e instanceof wc?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Dl.BOUNDARY:this._numBoundaries>0||this._isIn?Dl.INTERIOR:Dl.EXTERIOR)},Xh.prototype.interfaces_=function(){return[]},Xh.prototype.getClass=function(){return Xh};var Kh=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2];this._component=r,this._segIndex=o,this._pt=i}},Yh={INSIDE_AREA:{configurable:!0}};Kh.prototype.isInsideArea=function(){return this._segIndex===Kh.INSIDE_AREA},Kh.prototype.getCoordinate=function(){return this._pt},Kh.prototype.getGeometryComponent=function(){return this._component},Kh.prototype.getSegmentIndex=function(){return this._segIndex},Kh.prototype.interfaces_=function(){return[]},Kh.prototype.getClass=function(){return Kh},Yh.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Kh,Yh);var Zh=function(t){this._pts=t||null};Zh.prototype.filter=function(t){t instanceof vc&&this._pts.add(t)},Zh.prototype.interfaces_=function(){return[ec]},Zh.prototype.getClass=function(){return Zh},Zh.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof vc?bp.singletonList(t):Zh.getPoints(t,new Ou)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof vc?n.add(e):e instanceof rc&&e.apply(new Zh(n)),n}};var Qh=function(){this._locations=null;var t=arguments[0];this._locations=t};Qh.prototype.filter=function(t){(t instanceof vc||t instanceof mc||t instanceof wc)&&this._locations.add(new Kh(t,0,t.getCoordinate()))},Qh.prototype.interfaces_=function(){return[ec]},Qh.prototype.getClass=function(){return Qh},Qh.getLocations=function(t){var e=new Ou;return t.apply(new Qh(e)),e};var Jh=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Xh,this._minDistanceLocation=null,this._minDistance=bl.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=r,this._terminateDistance=o}};Jh.prototype.computeContainmentDistance=function(){var t=this;if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var n=arguments[0],r=arguments[1],o=1-n,i=Wh.getPolygons(this._geom[n]);if(i.size()>0){var s=Qh.getLocations(this._geom[o]);if(this.computeContainmentDistance(s,i,r),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[o]=r[0],this._minDistanceLocation[n]=r[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Ll(arguments[0],Ru)&&Ll(arguments[1],Ru)){for(var a=arguments[0],l=arguments[1],u=arguments[2],c=0;c<a.size();c++)for(var p=a.get(c),h=0;h<l.size();h++)if(t.computeContainmentDistance(p,l.get(h),u),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Kh&&arguments[1]instanceof wc){var d=arguments[0],f=arguments[1],g=arguments[2],m=d.getCoordinate();if(Dl.EXTERIOR!==this._ptLocator.locate(m,f))return this._minDistance=0,g[0]=d,g[1]=new Kh(f,m),null}},Jh.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=this,o=0;o<t.size();o++)for(var i=t.get(o),s=0;s<e.size();s++){var a=e.get(s);if(r.computeMinDistance(i,a,n),r._minDistance<=r._terminateDistance)return null}},Jh.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=qh.getLines(this._geom[0]),n=qh.getLines(this._geom[1]),r=Zh.getPoints(this._geom[0]),o=Zh.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,o,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,o,t),void this.updateMinDistance(t,!1))))},Jh.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Jh.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Jh.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Jh.prototype.computeMinDistance=function(){var t=this;if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof mc&&arguments[1]instanceof vc){var e=arguments[0],n=arguments[1],r=arguments[2];if(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this._minDistance)return null;for(var o=e.getCoordinates(),i=n.getCoordinate(),s=0;s<o.length-1;s++){var a=pu.distancePointLine(i,o[s],o[s+1]);if(a<t._minDistance){t._minDistance=a;var l=new kp(o[s],o[s+1]),u=l.closestPoint(i);r[0]=new Kh(e,s,u),r[1]=new Kh(n,0,i)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof mc&&arguments[1]instanceof mc){var c=arguments[0],p=arguments[1],h=arguments[2];if(c.getEnvelopeInternal().distance(p.getEnvelopeInternal())>this._minDistance)return null;for(var d=c.getCoordinates(),f=p.getCoordinates(),g=0;g<d.length-1;g++)for(var m=0;m<f.length-1;m++){var y=pu.distanceLineLine(d[g],d[g+1],f[m],f[m+1]);if(y<t._minDistance){t._minDistance=y;var v=new kp(d[g],d[g+1]),_=new kp(f[m],f[m+1]),w=v.closestPoints(_);h[0]=new Kh(c,g,w[0]),h[1]=new Kh(p,m,w[1])}if(t._minDistance<=t._terminateDistance)return null}}},Jh.prototype.computeMinDistancePoints=function(t,e,n){for(var r=this,o=0;o<t.size();o++)for(var i=t.get(o),s=0;s<e.size();s++){var a=e.get(s),l=i.getCoordinate().distance(a.getCoordinate());if(l<r._minDistance&&(r._minDistance=l,n[0]=new Kh(i,0,i.getCoordinate()),n[1]=new Kh(a,0,a.getCoordinate())),r._minDistance<=r._terminateDistance)return null}},Jh.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new Cl("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Jh.prototype.computeMinDistanceLines=function(t,e,n){for(var r=this,o=0;o<t.size();o++)for(var i=t.get(o),s=0;s<e.size();s++){var a=e.get(s);if(r.computeMinDistance(i,a,n),r._minDistance<=r._terminateDistance)return null}},Jh.prototype.interfaces_=function(){return[]},Jh.prototype.getClass=function(){return Jh},Jh.distance=function(t,e){return new Jh(t,e).distance()},Jh.isWithinDistance=function(t,e,n){return new Jh(t,e,n).distance()<=n},Jh.nearestPoints=function(t,e){return new Jh(t,e).nearestPoints()};var $h=function(){this._pt=[new Pl,new Pl],this._distance=bl.NaN,this._isNull=!0};$h.prototype.getCoordinates=function(){return this._pt},$h.prototype.getCoordinate=function(t){return this._pt[t]},$h.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},$h.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=o,this._isNull=!1}},$h.prototype.toString=function(){return nu.toLineString(this._pt[0],this._pt[1])},$h.prototype.getDistance=function(){return this._distance},$h.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},$h.prototype.interfaces_=function(){return[]},$h.prototype.getClass=function(){return $h};var td=function(){};td.prototype.interfaces_=function(){return[]},td.prototype.getClass=function(){return td},td.computeDistance=function(){if(arguments[2]instanceof $h&&arguments[0]instanceof mc&&arguments[1]instanceof Pl)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new kp,o=t.getCoordinates(),i=0;i<o.length-1;i++){r.setCoordinates(o[i],o[i+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof $h&&arguments[0]instanceof wc&&arguments[1]instanceof Pl){var a=arguments[0],l=arguments[1],u=arguments[2];td.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)td.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof $h&&arguments[0]instanceof fu&&arguments[1]instanceof Pl){var p=arguments[0],h=arguments[1],d=arguments[2];if(p instanceof mc)td.computeDistance(p,h,d);else if(p instanceof wc)td.computeDistance(p,h,d);else if(p instanceof rc)for(var f=p,g=0;g<f.getNumGeometries();g++){var m=f.getGeometryN(g);td.computeDistance(m,h,d)}else d.setMinimum(p.getCoordinate(),h)}else if(arguments[2]instanceof $h&&arguments[0]instanceof kp&&arguments[1]instanceof Pl){var y=arguments[0],v=arguments[1],_=arguments[2],w=y.closestPoint(v);_.setMinimum(w,v)}};var ed=function(){this._g0=null,this._g1=null,this._ptDist=new $h,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},nd={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};ed.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},ed.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Cl("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},ed.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},ed.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},ed.prototype.computeOrientedDistance=function(t,e,n){var r=new rd(e);if(t.apply(r),n.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var o=new od(e,this._densifyFrac);t.apply(o),n.setMaximum(o.getMaxPointDistance())}},ed.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},ed.prototype.interfaces_=function(){return[]},ed.prototype.getClass=function(){return ed},ed.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new ed(t,e);return n.distance()}if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2],s=new ed(r,o);return s.setDensifyFraction(i),s.distance()}},nd.MaxPointDistanceFilter.get=function(){return rd},nd.MaxDensifiedByFractionDistanceFilter.get=function(){return od},Object.defineProperties(ed,nd);var rd=function(){this._maxPtDist=new $h,this._minPtDist=new $h,this._euclideanDist=new td,this._geom=null;var t=arguments[0];this._geom=t};rd.prototype.filter=function(t){this._minPtDist.initialize(),td.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},rd.prototype.getMaxPointDistance=function(){return this._maxPtDist},rd.prototype.interfaces_=function(){return[yu]},rd.prototype.getClass=function(){return rd};var od=function(){this._maxPtDist=new $h,this._minPtDist=new $h,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};od.prototype.filter=function(t,e){var n=this;if(0===e)return null;for(var r=t.getCoordinate(e-1),o=t.getCoordinate(e),i=(o.x-r.x)/this._numSubSegs,s=(o.y-r.y)/this._numSubSegs,a=0;a<this._numSubSegs;a++){var l=r.x+a*i,u=r.y+a*s,c=new Pl(l,u);n._minPtDist.initialize(),td.computeDistance(n._geom,c,n._minPtDist),n._maxPtDist.setMaximum(n._minPtDist)}},od.prototype.isDone=function(){return!1},od.prototype.isGeometryChanged=function(){return!1},od.prototype.getMaxPointDistance=function(){return this._maxPtDist},od.prototype.interfaces_=function(){return[nc]},od.prototype.getClass=function(){return od};var id=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},sd={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};id.prototype.checkMaximumDistance=function(t,e,n){var r=new ed(e,t);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var o=r.getCoordinates();this._errorLocation=o[1],this._errorIndicator=t.getFactory().createLineString(o),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+nu.toLineString(o[0],o[1])+")"}},id.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=id.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),id.VERBOSE&&Kl.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},id.prototype.checkNegativeValid=function(){if(!(this._input instanceof wc||this._input instanceof xc||this._input instanceof rc))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},id.prototype.getErrorIndicator=function(){return this._errorIndicator},id.prototype.checkMinimumDistance=function(t,e,n){var r=new Jh(t,e,n);if(this._minDistanceFound=r.distance(),this._minDistanceFound<n){this._isValid=!1;var o=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(o),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+nu.toLineString(o[0],o[1])+" )"}},id.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},id.prototype.getErrorLocation=function(){return this._errorLocation},id.prototype.getPolygonLines=function(t){for(var e=new Ou,n=new qh(e),r=Wh.getPolygons(t).iterator();r.hasNext();)r.next().apply(n);return t.getFactory().buildGeometry(e)},id.prototype.getErrorMessage=function(){return this._errMsg},id.prototype.interfaces_=function(){return[]},id.prototype.getClass=function(){return id},sd.VERBOSE.get=function(){return!1},sd.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(id,sd);var ad=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},ld={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ad.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},ad.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*ad.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Zl(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new Zl(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},ad.prototype.checkDistance=function(){var t=new id(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},ad.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ad.prototype.checkPolygonal=function(){this._result instanceof wc||this._result instanceof xc||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ad.prototype.getErrorIndicator=function(){return this._errorIndicator},ad.prototype.getErrorLocation=function(){return this._errorLocation},ad.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ad.prototype.report=function(t){if(!ad.VERBOSE)return null;Kl.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},ad.prototype.getErrorMessage=function(){return this._errorMsg},ad.prototype.interfaces_=function(){return[]},ad.prototype.getClass=function(){return ad},ad.isValidMsg=function(t,e,n){var r=new ad(t,e,n);return r.isValid()?null:r.getErrorMessage()},ad.isValid=function(t,e,n){return!!new ad(t,e,n).isValid()},ld.VERBOSE.get=function(){return!1},ld.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ad,ld);var ud=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};ud.prototype.getCoordinates=function(){return this._pts},ud.prototype.size=function(){return this._pts.length},ud.prototype.getCoordinate=function(t){return this._pts[t]},ud.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ud.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Mp.octant(this.getCoordinate(t),this.getCoordinate(t+1))},ud.prototype.setData=function(t){this._data=t},ud.prototype.getData=function(){return this._data},ud.prototype.toString=function(){return nu.toLineString(new Oc(this._pts))},ud.prototype.interfaces_=function(){return[Lp]},ud.prototype.getClass=function(){return ud};var cd=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Ou,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};cd.prototype.getInteriorIntersection=function(){return this._interiorIntersection},cd.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},cd.prototype.getIntersectionSegments=function(){return this._intSegments},cd.prototype.count=function(){return this._intersectionCount},cd.prototype.getIntersections=function(){return this._intersections},cd.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},cd.prototype.setKeepIntersections=function(t){this._keepIntersections=t},cd.prototype.processIntersections=function(t,e,n,r){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===r)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,r))return null;var o=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(o,i,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=o,this._intSegments[1]=i,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},cd.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},cd.prototype.hasIntersection=function(){return null!==this._interiorIntersection},cd.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},cd.prototype.interfaces_=function(){return[mh]},cd.prototype.getClass=function(){return cd},cd.createAllIntersectionsFinder=function(t){var e=new cd(t);return e.setFindAllIntersections(!0),e},cd.createAnyIntersectionFinder=function(t){return new cd(t)},cd.createIntersectionCounter=function(t){var e=new cd(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var pd=function(){this._li=new lu,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};pd.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},pd.prototype.getIntersections=function(){return this._segInt.getIntersections()},pd.prototype.isValid=function(){return this.execute(),this._isValid},pd.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},pd.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new cd(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Up;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},pd.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Qc(this.getErrorMessage(),this._segInt.getInteriorIntersection())},pd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+nu.toLineString(t[0],t[1])+" and "+nu.toLineString(t[2],t[3])},pd.prototype.interfaces_=function(){return[]},pd.prototype.getClass=function(){return pd},pd.computeIntersections=function(t){var e=new pd(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var hd=function t(){this._nv=null;var e=arguments[0];this._nv=new pd(t.toSegmentStrings(e))};hd.prototype.checkValid=function(){this._nv.checkValid()},hd.prototype.interfaces_=function(){return[]},hd.prototype.getClass=function(){return hd},hd.toSegmentStrings=function(t){for(var e=new Ou,n=t.iterator();n.hasNext();){var r=n.next();e.add(new ud(r.getCoordinates(),r))}return e},hd.checkValid=function(t){new hd(t).checkValid()};var dd=function(t){this._mapOp=t};dd.prototype.map=function(t){for(var e=new Ou,n=0;n<t.getNumGeometries();n++){var r=this._mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(Gc.toGeometryArray(e))},dd.prototype.interfaces_=function(){return[]},dd.prototype.getClass=function(){return dd},dd.map=function(t,e){return new dd(e).map(t)};var fd=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Ou,this._resultLineList=new Ou;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};fd.prototype.collectLines=function(t){for(var e=this,n=this._op.getGraph().getEdgeEnds().iterator();n.hasNext();){var r=n.next();e.collectLineEdge(r,t,e._lineEdgesList),e.collectBoundaryTouchEdge(r,t,e._lineEdgesList)}},fd.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},fd.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},fd.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),o=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Kd.isResultOfOp(r,e)||o.isCovered()||(n.add(o),t.setVisitedEdge(!0)))},fd.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();if(n.isLineEdge()&&!r.isCoveredSet()){var o=this._op.isCoveredByA(n.getCoordinate());r.setCovered(o)}}},fd.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},fd.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(r),n.setInResult(!0)}},fd.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(iu.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Kd.isResultOfOp(r,e)&&e===Kd.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},fd.prototype.interfaces_=function(){return[]},fd.prototype.getClass=function(){return fd};var gd=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Ou;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};gd.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},gd.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!n.isInResult()&&!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===Kd.INTERSECTION)){var r=n.getLabel();Kd.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(n)}}},gd.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},gd.prototype.interfaces_=function(){return[]},gd.prototype.getClass=function(){return gd};var md=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};md.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},md.prototype.transformPolygon=function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof bc&&!r.isEmpty()||(n=!1);for(var o=new Ou,i=0;i<t.getNumInteriorRing();i++){var s=this.transformLinearRing(t.getInteriorRingN(i),t);null===s||s.isEmpty()||(s instanceof bc||(n=!1),o.add(s))}if(n)return this._factory.createPolygon(r,o.toArray([]));var a=new Ou;return null!==r&&a.add(r),a.addAll(o),this._factory.buildGeometry(a)},md.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},md.prototype.getInputGeometry=function(){return this._inputGeom},md.prototype.transformMultiLineString=function(t,e){for(var n=new Ou,r=0;r<t.getNumGeometries();r++){var o=this.transformLineString(t.getGeometryN(r),t);null!==o&&(o.isEmpty()||n.add(o))}return this._factory.buildGeometry(n)},md.prototype.transformCoordinates=function(t,e){return this.copy(t)},md.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},md.prototype.transformMultiPoint=function(t,e){for(var n=new Ou,r=0;r<t.getNumGeometries();r++){var o=this.transformPoint(t.getGeometryN(r),t);null!==o&&(o.isEmpty()||n.add(o))}return this._factory.buildGeometry(n)},md.prototype.transformMultiPolygon=function(t,e){for(var n=new Ou,r=0;r<t.getNumGeometries();r++){var o=this.transformPolygon(t.getGeometryN(r),t);null!==o&&(o.isEmpty()||n.add(o))}return this._factory.buildGeometry(n)},md.prototype.copy=function(t){return t.copy()},md.prototype.transformGeometryCollection=function(t,e){for(var n=new Ou,r=0;r<t.getNumGeometries();r++){var o=this.transform(t.getGeometryN(r));null!==o&&(this._pruneEmptyGeometry&&o.isEmpty()||n.add(o))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Gc.toGeometryArray(n)):this._factory.buildGeometry(n)},md.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof vc)return this.transformPoint(t,null);if(t instanceof Cc)return this.transformMultiPoint(t,null);if(t instanceof bc)return this.transformLinearRing(t,null);if(t instanceof mc)return this.transformLineString(t,null);if(t instanceof oc)return this.transformMultiLineString(t,null);if(t instanceof wc)return this.transformPolygon(t,null);if(t instanceof xc)return this.transformMultiPolygon(t,null);if(t instanceof rc)return this.transformGeometryCollection(t,null);throw new Cl("Unknown Geometry subtype: "+t.getClass().getName())},md.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},md.prototype.interfaces_=function(){return[]},md.prototype.getClass=function(){return md};var yd=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new kp,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof mc&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var r=arguments[0],o=arguments[1];this._srcPts=r,this._isClosed=t.isClosed(r),this._snapTolerance=o}};yd.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var o=t.get(r),i=this.findSnapForVertex(o,e);null!==i&&(t.set(r,new Pl(i)),0===r&&this._isClosed&&t.set(t.size()-1,new Pl(i)))}},yd.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},yd.prototype.snapTo=function(t){var e=new Au(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},yd.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var o=e[r],i=this.findSegmentIndexToSnap(o,t);i>=0&&t.add(i+1,new Pl(o),!1)}},yd.prototype.findSegmentIndexToSnap=function(t,e){for(var n=this,r=bl.MAX_VALUE,o=-1,i=0;i<e.size()-1;i++){if(n._seg.p0=e.get(i),n._seg.p1=e.get(i+1),n._seg.p0.equals2D(t)||n._seg.p1.equals2D(t)){if(n._allowSnappingToSourceVertices)continue;return-1}var s=n._seg.distance(t);s<n._snapTolerance&&s<r&&(r=s,o=i)}return o},yd.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},yd.prototype.interfaces_=function(){return[]},yd.prototype.getClass=function(){return yd},yd.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var vd=function(t){this._srcGeom=t||null},_d={SNAP_PRECISION_FACTOR:{configurable:!0}};vd.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new wd(e,n).transform(this._srcGeom)},vd.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),r=new wd(t,n,!0).transform(this._srcGeom),o=r;return e&&Ll(o,_c)&&(o=r.buffer(0)),o},vd.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},vd.prototype.extractTargetCoordinates=function(t){for(var e=new Zu,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},vd.prototype.computeMinimumSegmentLength=function(t){for(var e=bl.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},vd.prototype.interfaces_=function(){return[]},vd.prototype.getClass=function(){return vd},vd.snap=function(t,e,n){var r=new Array(2).fill(null),o=new vd(t);r[0]=o.snapTo(e,n);var i=new vd(e);return r[1]=i.snapTo(r[0],n),r},vd.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=vd.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Lc.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}if(2===arguments.length){var o=arguments[0],i=arguments[1];return Math.min(vd.computeOverlaySnapTolerance(o),vd.computeOverlaySnapTolerance(i))}},vd.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*vd.SNAP_PRECISION_FACTOR},vd.snapToSelf=function(t,e,n){return new vd(t).snapToSelf(e,n)},_d.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(vd,_d);var wd=function(t){function e(e,n,r){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new yd(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),r=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(md),Cd=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Cd.prototype.getCommon=function(){return bl.longBitsToDouble(this._commonBits)},Cd.prototype.add=function(t){var e=bl.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Cd.signExpBits(this._commonBits),this._isFirst=!1,null):Cd.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Cd.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Cd.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Cd.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=bl.longBitsToDouble(t),n=bl.toBinaryString(t),r="0000000000000000000000000000000000000000000000000000000000000000"+n,o=r.substring(r.length-64),i=o.substring(0,1)+"  "+o.substring(1,12)+"(exp) "+o.substring(12)+" [ "+e+" ]";return i}},Cd.prototype.interfaces_=function(){return[]},Cd.prototype.getClass=function(){return Cd},Cd.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Cd.signExpBits=function(t){return t>>52},Cd.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Cd.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if(Cd.getBit(t,r)!==Cd.getBit(e,r))return n;n++}return 52};var bd=function(){this._commonCoord=null,this._ccFilter=new Ed},xd={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};bd.prototype.addCommonBits=function(t){var e=new Sd(this._commonCoord);t.apply(e),t.geometryChanged()},bd.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new Pl(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new Sd(e);return t.apply(n),t.geometryChanged(),t},bd.prototype.getCommonCoordinate=function(){return this._commonCoord},bd.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},bd.prototype.interfaces_=function(){return[]},bd.prototype.getClass=function(){return bd},xd.CommonCoordinateFilter.get=function(){return Ed},xd.Translater.get=function(){return Sd},Object.defineProperties(bd,xd);var Ed=function(){this._commonBitsX=new Cd,this._commonBitsY=new Cd};Ed.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},Ed.prototype.getCommonCoordinate=function(){return new Pl(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Ed.prototype.interfaces_=function(){return[yu]},Ed.prototype.getClass=function(){return Ed};var Sd=function(){this.trans=null;var t=arguments[0];this.trans=t};Sd.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},Sd.prototype.isDone=function(){return!1},Sd.prototype.isGeometryChanged=function(){return!0},Sd.prototype.interfaces_=function(){return[nc]},Sd.prototype.getClass=function(){return Sd};var Td=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};Td.prototype.selfSnap=function(t){return new vd(t).snapTo(t,this._snapTolerance)},Td.prototype.removeCommonBits=function(t){this._cbr=new bd,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},Td.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},Td.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Kd.overlayOp(e[0],e[1],t);return this.prepareResult(n)},Td.prototype.checkValid=function(t){t.isValid()||Kl.out.println("Snapped geometry is invalid")},Td.prototype.computeSnapTolerance=function(){this._snapTolerance=vd.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Td.prototype.snap=function(t){var e=this.removeCommonBits(t);return vd.snap(e[0],e[1],this._snapTolerance)},Td.prototype.interfaces_=function(){return[]},Td.prototype.getClass=function(){return Td},Td.overlayOp=function(t,e,n){return new Td(t,e).getResultGeometry(n)},Td.union=function(t,e){return Td.overlayOp(t,e,Kd.UNION)},Td.intersection=function(t,e){return Td.overlayOp(t,e,Kd.INTERSECTION)},Td.symDifference=function(t,e){return Td.overlayOp(t,e,Kd.SYMDIFFERENCE)},Td.difference=function(t,e){return Td.overlayOp(t,e,Kd.DIFFERENCE)};var Rd=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};Rd.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=Kd.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof ru))throw t;r=t}if(!n)try{e=Td.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof ru?r:t}return e},Rd.prototype.interfaces_=function(){return[]},Rd.prototype.getClass=function(){return Rd},Rd.overlayOp=function(t,e,n){return new Rd(t,e).getResultGeometry(n)},Rd.union=function(t,e){return Rd.overlayOp(t,e,Kd.UNION)},Rd.intersection=function(t,e){return Rd.overlayOp(t,e,Kd.INTERSECTION)},Rd.symDifference=function(t,e){return Rd.overlayOp(t,e,Kd.SYMDIFFERENCE)},Rd.difference=function(t,e){return Rd.overlayOp(t,e,Kd.DIFFERENCE)};var Pd=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};Pd.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},Pd.prototype.interfaces_=function(){return[]},Pd.prototype.getClass=function(){return Pd};var Od=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=o,this._obj=i}},Id={INSERT:{configurable:!0},DELETE:{configurable:!0}};Od.prototype.isDelete=function(){return this._eventType===Od.DELETE},Od.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},Od.prototype.getObject=function(){return this._obj},Od.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},Od.prototype.getInsertEvent=function(){return this._insertEvent},Od.prototype.isInsert=function(){return this._eventType===Od.INSERT},Od.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},Od.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Od.prototype.interfaces_=function(){return[El]},Od.prototype.getClass=function(){return Od},Id.INSERT.get=function(){return 1},Id.DELETE.get=function(){return 2},Object.defineProperties(Od,Id);var Ad=function(){};Ad.prototype.interfaces_=function(){return[]},Ad.prototype.getClass=function(){return Ad};var Dd=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};Dd.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(Dd.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var o=t.getNumPoints()-1;if(0===e&&r===o||0===r&&e===o)return!0}}return!1},Dd.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Dd.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},Dd.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Dd.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},Dd.prototype.hasProperIntersection=function(){return this._hasProper},Dd.prototype.hasIntersection=function(){return this._hasIntersection},Dd.prototype.isDone=function(){return this._isDone},Dd.prototype.isBoundaryPoint=function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},Dd.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},Dd.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var o=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(o,i,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},Dd.prototype.interfaces_=function(){return[]},Dd.prototype.getClass=function(){return Dd},Dd.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Md=function(t){function e(){t.call(this),this.events=new Ou,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){bp.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){var t=this;if(1===arguments.length){var e=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var n=0;n<this.events.size();n++){var r=t.events.get(n);if(r.isInsert()&&t.processOverlaps(n,r.getDeleteEventIndex(),r,e),e.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Dd&&Ll(arguments[0],Ru)&&Ll(arguments[1],Ru)){var o=arguments[0],i=arguments[1],s=arguments[2];this.addEdges(o,o),this.addEdges(i,i),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&Ll(arguments[0],Ru)&&arguments[1]instanceof Dd){var a=arguments[0],l=arguments[1],u=arguments[2];u?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(l)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),o=0;o<r.length-1;o++){var i=new Pd(n,o),s=new Od(e,n.getMinX(o),i);this.events.add(s),this.events.add(new Od(n.getMaxX(o),s))}},e.prototype.processOverlaps=function(t,e,n,r){for(var o=n.getObject(),i=t;i<e;i++){var s=this.events.get(i);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(o.computeIntersections(a,r),this.nOverlaps++)}}},e.prototype.addEdges=function(){var t=this;if(1===arguments.length)for(var e=arguments[0],n=e.iterator();n.hasNext();){var r=n.next();t.addEdge(r,r)}else if(2===arguments.length)for(var o=arguments[0],i=arguments[1],s=o.iterator();s.hasNext();){var a=s.next();t.addEdge(a,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ad),Ld=function(){this._min=bl.POSITIVE_INFINITY,this._max=bl.NEGATIVE_INFINITY},Nd={NodeComparator:{configurable:!0}};Ld.prototype.getMin=function(){return this._min},Ld.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},Ld.prototype.getMax=function(){return this._max},Ld.prototype.toString=function(){return nu.toLineString(new Pl(this._min,0),new Pl(this._max,0))},Ld.prototype.interfaces_=function(){return[]},Ld.prototype.getClass=function(){return Ld},Nd.NodeComparator.get=function(){return Fd},Object.defineProperties(Ld,Nd);var Fd=function(){};Fd.prototype.compare=function(t,e){var n=t,r=e,o=(n._min+n._max)/2,i=(r._min+r._max)/2;return o<i?-1:o>i?1:0},Fd.prototype.interfaces_=function(){return[Tl]},Fd.prototype.getClass=function(){return Fd};var kd=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._min=e,this._max=n,this._item=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ld),Gd=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ld),Bd=function(){this._leaves=new Ou,this._root=null,this._level=0};Bd.prototype.buildTree=function(){bp.sort(this._leaves,new Ld.NodeComparator);for(var t=this._leaves,e=null,n=new Ou;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},Bd.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new kd(t,e,n))},Bd.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},Bd.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Bd.prototype.printNode=function(t){Kl.out.println(nu.toLineString(new Pl(t._min,this._level),new Pl(t._max,this._level)))},Bd.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Bd.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(r);else{var o=new Gd(t.get(n),t.get(n+1));e.add(o)}}},Bd.prototype.interfaces_=function(){return[]},Bd.prototype.getClass=function(){return Bd};var Vd=function(){this._items=new Ou};Vd.prototype.visitItem=function(t){this._items.add(t)},Vd.prototype.getItems=function(){return this._items},Vd.prototype.interfaces_=function(){return[vp]},Vd.prototype.getClass=function(){return Vd};var zd=function(){this._index=null;var t=arguments[0];if(!Ll(t,_c))throw new Cl("Argument must be Polygonal");this._index=new Ud(t)},jd={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};zd.prototype.locate=function(t){var e=new cu(t),n=new Hd(e);return this._index.query(t.y,t.y,n),e.getLocation()},zd.prototype.interfaces_=function(){return[lh]},zd.prototype.getClass=function(){return zd},jd.SegmentVisitor.get=function(){return Hd},jd.IntervalIndexedGeometry.get=function(){return Ud},Object.defineProperties(zd,jd);var Hd=function(){this._counter=null;var t=arguments[0];this._counter=t};Hd.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Hd.prototype.interfaces_=function(){return[vp]},Hd.prototype.getClass=function(){return Hd};var Ud=function(){this._index=new Bd;var t=arguments[0];this.init(t)};Ud.prototype.init=function(t){for(var e=qh.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},Ud.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new kp(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),o=Math.max(n.p0.y,n.p1.y);this._index.insert(r,o,n)}},Ud.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Vd;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2];this._index.query(r,o,i)}},Ud.prototype.interfaces_=function(){return[]},Ud.prototype.getClass=function(){return Ud};var Wd=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new Mc,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Xh,2===arguments.length){var e=arguments[0],n=arguments[1],r=vu.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=r,null!==n&&this.add(n)}else if(3===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2];this._argIndex=o,this._parentGeom=i,this._boundaryNodeRule=s,null!==i&&this.add(i)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var r=this._nodes.addNode(n).getLabel(),o=1;r.getLocation(t,qc.ON)===Dl.BOUNDARY&&o++;var i=e.determineBoundary(this._boundaryNodeRule,o);r.setLocation(t,i)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],i=new Dd(n,!0,!1);i.setIsDoneIfProperInt(o);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof bc||this._parentGeom instanceof wc||this._parentGeom instanceof xc,l=r||!a;return s.computeIntersections(this._edges,i,l),this.addSelfIntersectionNodes(this._argIndex),i}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var r=new Dd(e,n,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,r),r},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof vc){var t=arguments[0],e=t.getCoordinate();this.insertPoint(this._argIndex,e,Dl.INTERIOR)}else if(arguments[0]instanceof Pl){var n=arguments[0];this.insertPoint(this._argIndex,n,Dl.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),Dl.EXTERIOR,Dl.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,Dl.INTERIOR,Dl.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],Dl.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],Dl.BOUNDARY)},e.prototype.addLineString=function(t){var e=Du.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Eh(e,new ep(this._argIndex,Dl.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),iu.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var o=r.next();e[n++]=o.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===Dl.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var r=Du.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var o=e,i=n;pu.isCCW(r)&&(o=n,i=e);var s=new Eh(r,new ep(this._argIndex,Dl.BOUNDARY,o,i));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,r[0],Dl.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var r=this._nodes.addNode(e),o=r.getLabel();null===o?r._label=new ep(t,n):o.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new Md},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),o=n.eiList.iterator();o.hasNext();){var i=o.next();this.addSelfIntersectionNode(t,i.coord,r)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof xc&&(this._useBoundaryDeterminationRule=!1),e instanceof wc)this.addPolygon(e);else if(e instanceof mc)this.addLineString(e);else if(e instanceof vc)this.addPoint(e);else if(e instanceof Cc)this.addCollection(e);else if(e instanceof oc)this.addCollection(e);else if(e instanceof xc)this.addCollection(e);else{if(!(e instanceof rc))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return Ll(this._parentGeom,_c)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new zd(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?Dl.BOUNDARY:Dl.INTERIOR},e}(dp),qd=function(){if(this._li=new lu,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Wd(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=vu.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Wd(0,e,r),this._arg[1]=new Wd(1,n,r)}else if(3===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2];o.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(o.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Wd(0,o,s),this._arg[1]=new Wd(1,i,s)}};qd.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},qd.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},qd.prototype.interfaces_=function(){return[]},qd.prototype.getClass=function(){return qd};var Xd=function(){};Xd.prototype.interfaces_=function(){return[]},Xd.prototype.getClass=function(){return Xd},Xd.map=function(){if(arguments[0]instanceof fu&&Ll(arguments[1],Xd.MapOp)){for(var t=arguments[0],e=arguments[1],n=new Ou,r=0;r<t.getNumGeometries();r++){var o=e.map(t.getGeometryN(r));null!==o&&n.add(o)}return t.getFactory().buildGeometry(n)}if(Ll(arguments[0],Eu)&&Ll(arguments[1],Xd.MapOp)){for(var i=arguments[0],s=arguments[1],a=new Ou,l=i.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},Xd.MapOp=function(){};var Kd=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Xh,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new gh,this._resultPolyList=new Ou,this._resultLineList=new Ou,this._resultPointList=new Ou,this._graph=new dp(new dh),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new ep(t.getLabel())).flip();var o=e.getDepth();o.isNull()&&o.add(n),o.add(r),n.merge(r)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,r,o){var i=new Ou;return i.addAll(t),i.addAll(n),i.addAll(r),i.isEmpty()?e.createEmptyResult(o,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(i)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this._ptLocator.locate(t,r)!==Dl.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Ou,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Ou;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),hd.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new fp(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var r=new fd(this,this._geomFact,this._ptLocator);this._resultLineList=r.build(t);var o=new gd(this,this._geomFact,this._ptLocator);this._resultPointList=o.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var r=n.next(),o=r.getLabel();o.isArea()&&!r.isInteriorAreaEdge()&&e.isResultOfOp(o.getLocation(0,qc.RIGHT),o.getLocation(1,qc.RIGHT),t)&&r.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var o=0;o<2;o++)n.isNull(o)||!n.isArea()||r.isNull(o)||(0===r.getDelta(o)?n.toLine(o):(iu.isTrue(!r.isNull(o,qc.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(o,qc.LEFT,r.getLocation(o,qc.LEFT)),iu.isTrue(!r.isNull(o,qc.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(o,qc.RIGHT,r.getLocation(o,qc.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qd);Kd.overlayOp=function(t,e,n){return new Kd(t,e).getResultGeometry(n)},Kd.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Kd.createEmptyResult(Kd.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return dd.map(t,{interfaces_:function(){return[Xd.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Rd.overlayOp(t,e,Kd.INTERSECTION)},Kd.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Kd.createEmptyResult(Kd.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Rd.overlayOp(t,e,Kd.SYMDIFFERENCE)},Kd.resultDimension=function(t,e,n){var r=e.getDimension(),o=n.getDimension(),i=-1;switch(t){case Kd.INTERSECTION:i=Math.min(r,o);break;case Kd.UNION:i=Math.max(r,o);break;case Kd.DIFFERENCE:i=r;break;case Kd.SYMDIFFERENCE:i=Math.max(r,o)}return i},Kd.createEmptyResult=function(t,e,n,r){var o=null;switch(Kd.resultDimension(t,e,n)){case-1:o=r.createGeometryCollection(new Array(0).fill(null));break;case 0:o=r.createPoint();break;case 1:o=r.createLineString();break;case 2:o=r.createPolygon()}return o},Kd.difference=function(t,e){return t.isEmpty()?Kd.createEmptyResult(Kd.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Rd.overlayOp(t,e,Kd.DIFFERENCE))},Kd.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return Kd.isResultOfOp(n,r,e)}if(3===arguments.length){var o=arguments[0],i=arguments[1],s=arguments[2];switch(o===Dl.BOUNDARY&&(o=Dl.INTERIOR),i===Dl.BOUNDARY&&(i=Dl.INTERIOR),s){case Kd.INTERSECTION:return o===Dl.INTERIOR&&i===Dl.INTERIOR;case Kd.UNION:return o===Dl.INTERIOR||i===Dl.INTERIOR;case Kd.DIFFERENCE:return o===Dl.INTERIOR&&i!==Dl.INTERIOR;case Kd.SYMDIFFERENCE:return o===Dl.INTERIOR&&i!==Dl.INTERIOR||o!==Dl.INTERIOR&&i===Dl.INTERIOR}return!1}},Kd.INTERSECTION=1,Kd.UNION=2,Kd.DIFFERENCE=3,Kd.SYMDIFFERENCE=4;var Yd=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Xh,this._seg=new kp;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Yd.prototype.isWithinToleranceOfBoundary=function(t){for(var e=this,n=0;n<this._linework.getNumGeometries();n++)for(var r=e._linework.getGeometryN(n).getCoordinateSequence(),o=0;o<r.size()-1;o++)if(r.getCoordinate(o,e._seg.p0),r.getCoordinate(o+1,e._seg.p1),e._seg.distance(t)<=e._boundaryDistanceTolerance)return!0;return!1},Yd.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?Dl.BOUNDARY:this._ptLocator.locate(t,this._g)},Yd.prototype.extractLinework=function(t){var e=new Zd;t.apply(e);var n=e.getLinework(),r=Gc.toLineStringArray(n);return t.getFactory().createMultiLineString(r)},Yd.prototype.interfaces_=function(){return[]},Yd.prototype.getClass=function(){return Yd};var Zd=function(){this._linework=null,this._linework=new Ou};Zd.prototype.getLinework=function(){return this._linework},Zd.prototype.filter=function(t){if(t instanceof wc){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Zd.prototype.interfaces_=function(){return[ec]},Zd.prototype.getClass=function(){return Zd};var Qd=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Qd.prototype.extractPoints=function(t,e,n){for(var r=t.getCoordinates(),o=0;o<r.length-1;o++)this.computeOffsetPoints(r[o],r[o+1],e,n)},Qd.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Qd.prototype.getPoints=function(t){for(var e=new Ou,n=qh.getLines(this._g).iterator();n.hasNext();){var r=n.next();this.extractPoints(r,t,e)}return e},Qd.prototype.computeOffsetPoints=function(t,e,n,r){var o=e.x-t.x,i=e.y-t.y,s=Math.sqrt(o*o+i*i),a=n*o/s,l=n*i/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var p=new Pl(u-l,c+a);r.add(p)}if(this._doRight){var h=new Pl(u+l,c-a);r.add(h)}},Qd.prototype.interfaces_=function(){return[]},Qd.prototype.getClass=function(){return Qd};var Jd=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Ou;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new Yd(this._geom[0],this._boundaryDistanceTolerance),new Yd(this._geom[1],this._boundaryDistanceTolerance),new Yd(this._geom[2],this._boundaryDistanceTolerance)]},$d={TOLERANCE:{configurable:!0}};Jd.prototype.reportResult=function(t,e,n){Kl.out.println("Overlay result invalid - A:"+Dl.toLocationSymbol(e[0])+" B:"+Dl.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+Dl.toLocationSymbol(e[2]))},Jd.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Jd.prototype.checkValid=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],n=0;n<this._testCoords.size();n++){var r=t._testCoords.get(n);if(!t.checkValid(e,r))return t._invalidLocation=r,!1}return!0}if(2===arguments.length){var o=arguments[0],i=arguments[1];return this._location[0]=this._locFinder[0].getLocation(i),this._location[1]=this._locFinder[1].getLocation(i),this._location[2]=this._locFinder[2].getLocation(i),!!Jd.hasLocation(this._location,Dl.BOUNDARY)||this.isValidResult(o,this._location)}},Jd.prototype.addTestPts=function(t){var e=new Qd(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Jd.prototype.isValidResult=function(t,e){var n=Kd.isResultOfOp(e[0],e[1],t),r=!(n^e[2]===Dl.INTERIOR);return r||this.reportResult(t,e,n),r},Jd.prototype.getInvalidLocation=function(){return this._invalidLocation},Jd.prototype.interfaces_=function(){return[]},Jd.prototype.getClass=function(){return Jd},Jd.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Jd.computeBoundaryDistanceTolerance=function(t,e){return Math.min(vd.computeSizeBasedSnapTolerance(t),vd.computeSizeBasedSnapTolerance(e))},Jd.isValid=function(t,e,n,r){return new Jd(t,e,r).isValid(n)},$d.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Jd,$d);var tf=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};tf.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this._skipEmpty&&r.isEmpty()||e.add(r)}},tf.prototype.combine=function(){for(var t=new Ou,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},tf.prototype.interfaces_=function(){return[]},tf.prototype.getClass=function(){return tf},tf.combine=function(){if(1===arguments.length){var t=arguments[0],e=new tf(t);return e.combine()}if(2===arguments.length){var n=arguments[0],r=arguments[1],o=new tf(tf.createList(n,r));return o.combine()}if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2],l=new tf(tf.createList(i,s,a));return l.combine()}},tf.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},tf.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Ou;return n.add(t),n.add(e),n}if(3===arguments.length){var r=arguments[0],o=arguments[1],i=arguments[2],s=new Ou;return s.add(r),s.add(o),s.add(i),s}};var ef=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Ou)},nf={STRTREE_NODE_CAPACITY:{configurable:!0}};ef.prototype.reduceToGeometries=function(t){for(var e=new Ou,n=t.iterator();n.hasNext();){var r=n.next(),o=null;Ll(r,Ru)?o=this.unionTree(r):r instanceof fu&&(o=r),e.add(o)}return e},ef.prototype.extractByEnvelope=function(t,e,n){for(var r=new Ou,o=0;o<e.getNumGeometries();o++){var i=e.getGeometryN(o);i.getEnvelopeInternal().intersects(t)?r.add(i):n.add(i)}return this._geomFactory.buildGeometry(r)},ef.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r))return tf.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var o=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,o)},ef.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Pp(ef.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},ef.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var o=ef.getGeometry(e,n);return this.unionSafe(o,null)}if(r-n==2)return this.unionSafe(ef.getGeometry(e,n),ef.getGeometry(e,n+1));var i=Math.trunc((r+n)/2),s=this.binaryUnion(e,n,i),a=this.binaryUnion(e,i,r);return this.unionSafe(s,a)}},ef.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e=null===e?r.copy():e.union(r)}return e},ef.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},ef.prototype.unionActual=function(t,e){return ef.restrictToPolygons(t.union(e))},ef.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},ef.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new Ou,o=this.extractByEnvelope(n,t,r),i=this.extractByEnvelope(n,e,r),s=this.unionActual(o,i);return r.add(s),tf.combine(r)},ef.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0],e=t.get(0).getFactory(),n=e.buildGeometry(t),r=n.buffer(0);return r}if(2===arguments.length){var o=arguments[0],i=arguments[1],s=o.getFactory(),a=s.createGeometryCollection([o,i]),l=a.buffer(0);return l}},ef.prototype.interfaces_=function(){return[]},ef.prototype.getClass=function(){return ef},ef.restrictToPolygons=function(t){if(Ll(t,_c))return t;var e=Wh.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Gc.toPolygonArray(e))},ef.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},ef.union=function(t){return new ef(t).union()},nf.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(ef,nf);var rf=function(){};function of(){return new sf}function sf(){this.reset()}rf.prototype.interfaces_=function(){return[]},rf.prototype.getClass=function(){return rf},rf.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Kd.createEmptyResult(Kd.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Rd.overlayOp(t,e,Kd.UNION)},sf.prototype={constructor:sf,reset:function(){this.s=this.t=0},add:function(t){lf(af,t,this.t),lf(this,af.s,this.s),this.s?this.t+=af.t:this.s=af.t},valueOf:function(){return this.s}};var af=new sf;function lf(t,e,n){var r=t.s=e+n,o=r-e,i=r-o;t.t=e-i+(n-o)}var uf=1e-6,cf=Math.PI,pf=cf/2,hf=cf/4,df=2*cf,ff=180/cf,gf=cf/180,mf=Math.abs,yf=Math.atan,vf=Math.atan2,_f=Math.cos,wf=Math.sin,Cf=Math.sqrt;function bf(t){return t>1?0:t<-1?cf:Math.acos(t)}function xf(t){return t>1?pf:t<-1?-pf:Math.asin(t)}function Ef(){}function Sf(t,e){t&&Of.hasOwnProperty(t.type)&&Of[t.type](t,e)}var Tf,Rf,Pf={Feature:function(t,e){Sf(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,o=n.length;++r<o;)Sf(n[r].geometry,e)}},Of={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){If(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)If(n[r],e,0)},Polygon:function(t,e){Af(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)Af(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,o=n.length;++r<o;)Sf(n[r],e)}};function If(t,e,n){var r,o=-1,i=t.length-n;for(e.lineStart();++o<i;)r=t[o],e.point(r[0],r[1],r[2]);e.lineEnd()}function Af(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)If(t[n],e,1);e.polygonEnd()}function Df(t){return[vf(t[1],t[0]),xf(t[2])]}function Mf(t){var e=t[0],n=t[1],r=_f(n);return[r*_f(e),r*wf(e),wf(n)]}function Lf(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Nf(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ff(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function kf(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Gf(t){var e=Cf(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Bf(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Vf(t,e){return[t>cf?t-df:t<-cf?t+df:t,e]}function zf(t){return function(e,n){return[(e+=t)>cf?e-df:e<-cf?e+df:e,n]}}function jf(t){var e=zf(t);return e.invert=zf(-t),e}function Hf(t,e){var n=_f(t),r=wf(t),o=_f(e),i=wf(e);function s(t,e){var s=_f(e),a=_f(t)*s,l=wf(t)*s,u=wf(e),c=u*n+a*r;return[vf(l*o-c*i,a*n-u*r),xf(c*o+l*i)]}return s.invert=function(t,e){var s=_f(e),a=_f(t)*s,l=wf(t)*s,u=wf(e),c=u*o-l*i;return[vf(l*o+u*i,a*n+c*r),xf(c*n-a*r)]},s}function Uf(t,e){(e=Mf(e))[0]-=t,Gf(e);var n=bf(-e[1]);return((-e[2]<0?-n:n)+df-uf)%df}function Wf(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Ef,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function qf(t,e){return mf(t[0]-e[0])<uf&&mf(t[1]-e[1])<uf}function Xf(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Kf(t,e,n,r,o){var i,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(qf(r,s)){for(o.lineStart(),i=0;i<e;++i)o.point((r=t[i])[0],r[1]);o.lineEnd()}else a.push(n=new Xf(r,t,null,!0)),l.push(n.o=new Xf(r,null,n,!1)),a.push(n=new Xf(s,t,null,!1)),l.push(n.o=new Xf(s,null,n,!0))}})),a.length){for(l.sort(e),Yf(a),Yf(l),i=0,s=l.length;i<s;++i)l[i].e=n=!n;for(var u,c,p=a[0];;){for(var h=p,d=!0;h.v;)if((h=h.n)===p)return;u=h.z,o.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(i=0,s=u.length;i<s;++i)o.point((c=u[i])[0],c[1]);else r(h.x,h.n.x,1,o);h=h.n}else{if(d)for(u=h.p.z,i=u.length-1;i>=0;--i)o.point((c=u[i])[0],c[1]);else r(h.x,h.p.x,-1,o);h=h.p}u=(h=h.o).z,d=!d}while(!h.v);o.lineEnd()}}}function Yf(t){if(e=t.length){for(var e,n,r=0,o=t[0];++r<e;)o.n=n=t[r],n.p=o,o=n;o.n=n=t[0],n.p=o}}function Zf(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Qf(t){for(var e,n,r,o=t.length,i=-1,s=0;++i<o;)s+=t[i].length;for(n=new Array(s);--o>=0;)for(e=(r=t[o]).length;--e>=0;)n[--s]=r[e];return n}of(),of(),of(),Vf.invert=Vf,1===(Tf=Zf).length&&(Rf=Tf,Tf=function(t,e){return Zf(Rf(t),e)});var Jf=1e9,$f=-Jf;function tg(t,e,n,r){function o(o,i){return t<=o&&o<=n&&e<=i&&i<=r}function i(o,i,a,u){var c=0,p=0;if(null==o||(c=s(o,a))!==(p=s(i,a))||l(o,i)<0^a>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+a+4)%4)!==p);else u.point(i[0],i[1])}function s(r,o){return mf(r[0]-t)<uf?o>0?0:3:mf(r[0]-n)<uf?o>0?2:1:mf(r[1]-e)<uf?o>0?1:0:o>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var l,u,c,p,h,d,f,g,m,y,v,_=s,w=Wf(),C={point:b,lineStart:function(){C.point=x,u&&u.push(c=[]),y=!0,m=!1,f=g=NaN},lineEnd:function(){l&&(x(p,h),d&&m&&w.rejoin(),l.push(w.result())),C.point=b,m&&_.lineEnd()},polygonStart:function(){_=w,l=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,o=u.length;n<o;++n)for(var i,s,a=u[n],l=1,c=a.length,p=a[0],h=p[0],d=p[1];l<c;++l)i=h,s=d,h=(p=a[l])[0],d=p[1],s<=r?d>r&&(h-i)*(r-s)>(d-s)*(t-i)&&++e:d<=r&&(h-i)*(r-s)<(d-s)*(t-i)&&--e;return e}(),n=v&&e,o=(l=Qf(l)).length;(n||o)&&(s.polygonStart(),n&&(s.lineStart(),i(null,null,1,s),s.lineEnd()),o&&Kf(l,a,e,i,s),s.polygonEnd()),_=s,l=u=c=null}};function b(t,e){o(t,e)&&_.point(t,e)}function x(i,s){var a=o(i,s);if(u&&c.push([i,s]),y)p=i,h=s,d=a,y=!1,a&&(_.lineStart(),_.point(i,s));else if(a&&m)_.point(i,s);else{var l=[f=Math.max($f,Math.min(Jf,f)),g=Math.max($f,Math.min(Jf,g))],w=[i=Math.max($f,Math.min(Jf,i)),s=Math.max($f,Math.min(Jf,s))];!function(t,e,n,r,o,i){var s,a=t[0],l=t[1],u=0,c=1,p=e[0]-a,h=e[1]-l;if(s=n-a,p||!(s>0)){if(s/=p,p<0){if(s<u)return;s<c&&(c=s)}else if(p>0){if(s>c)return;s>u&&(u=s)}if(s=o-a,p||!(s<0)){if(s/=p,p<0){if(s>c)return;s>u&&(u=s)}else if(p>0){if(s<u)return;s<c&&(c=s)}if(s=r-l,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=i-l,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*p,t[1]=l+u*h),c<1&&(e[0]=a+c*p,e[1]=l+c*h),!0}}}}}(l,w,t,e,n,r)?a&&(_.lineStart(),_.point(i,s),v=!1):(m||(_.lineStart(),_.point(l[0],l[1])),_.point(w[0],w[1]),a||_.lineEnd(),v=!1)}f=i,g=s,m=a}return C}}var eg=of();function ng(t){return t}of(),of(),of();var rg=1/0,og=rg,ig=-rg,sg=ig,ag={point:function(t,e){t<rg&&(rg=t),t>ig&&(ig=t),e<og&&(og=e),e>sg&&(sg=e)},lineStart:Ef,lineEnd:Ef,polygonStart:Ef,polygonEnd:Ef,result:function(){var t=[[rg,og],[ig,sg]];return ig=sg=-(og=rg=1/0),t}};function lg(t,e,n,r){return function(o,i){var s,a,l,u=e(i),c=o.invert(r[0],r[1]),p=Wf(),h=e(p),d=!1,f={point:g,lineStart:y,lineEnd:v,polygonStart:function(){f.point=_,f.lineStart=w,f.lineEnd=C,a=[],s=[]},polygonEnd:function(){f.point=g,f.lineStart=y,f.lineEnd=v,a=Qf(a);var t=function(t,e){var n=e[0],r=e[1],o=[wf(n),-_f(n),0],i=0,s=0;eg.reset();for(var a=0,l=t.length;a<l;++a)if(c=(u=t[a]).length)for(var u,c,p=u[c-1],h=p[0],d=p[1]/2+hf,f=wf(d),g=_f(d),m=0;m<c;++m,h=v,f=w,g=C,p=y){var y=u[m],v=y[0],_=y[1]/2+hf,w=wf(_),C=_f(_),b=v-h,x=b>=0?1:-1,E=x*b,S=E>cf,T=f*w;if(eg.add(vf(T*x*wf(E),g*C+T*_f(E))),i+=S?b+x*df:b,S^h>=n^v>=n){var R=Nf(Mf(p),Mf(y));Gf(R);var P=Nf(o,R);Gf(P);var O=(S^b>=0?-1:1)*xf(P[2]);(r>O||r===O&&(R[0]||R[1]))&&(s+=S^b>=0?1:-1)}}return(i<-1e-6||i<uf&&eg<-1e-6)^1&s}(s,c);a.length?(d||(i.polygonStart(),d=!0),Kf(a,cg,t,n,i)):t&&(d||(i.polygonStart(),d=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),d&&(i.polygonEnd(),d=!1),a=s=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function g(e,n){var r=o(e,n);t(e=r[0],n=r[1])&&i.point(e,n)}function m(t,e){var n=o(t,e);u.point(n[0],n[1])}function y(){f.point=m,u.lineStart()}function v(){f.point=g,u.lineEnd()}function _(t,e){l.push([t,e]);var n=o(t,e);h.point(n[0],n[1])}function w(){h.lineStart(),l=[]}function C(){_(l[0][0],l[0][1]),h.lineEnd();var t,e,n,r,o=h.clean(),u=p.result(),c=u.length;if(l.pop(),s.push(l),l=null,c)if(1&o){if((e=(n=u[0]).length-1)>0){for(d||(i.polygonStart(),d=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else c>1&&2&o&&u.push(u.pop().concat(u.shift())),a.push(u.filter(ug))}return f}}function ug(t){return t.length>1}function cg(t,e){return((t=t.x)[0]<0?t[1]-pf-uf:pf-t[1])-((e=e.x)[0]<0?e[1]-pf-uf:pf-e[1])}of();var pg=lg((function(){return!0}),(function(t){var e,n=NaN,r=NaN,o=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(i,s){var a=i>0?cf:-cf,l=mf(i-n);mf(l-cf)<uf?(t.point(n,r=(r+s)/2>0?pf:-pf),t.point(o,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(i,r),e=0):o!==a&&l>=cf&&(mf(n-o)<uf&&(n-=o*uf),mf(i-a)<uf&&(i-=a*uf),r=function(t,e,n,r){var o,i,s=wf(t-n);return mf(s)>uf?yf((wf(e)*(i=_f(r))*wf(n)-wf(r)*(o=_f(e))*wf(t))/(o*i*s)):(e+r)/2}(n,r,i,s),t.point(o,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=i,r=s),o=a},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var o;if(null==t)o=n*pf,r.point(-cf,o),r.point(0,o),r.point(cf,o),r.point(cf,0),r.point(cf,-o),r.point(0,-o),r.point(-cf,-o),r.point(-cf,0),r.point(-cf,o);else if(mf(t[0]-e[0])>uf){var i=t[0]<e[0]?cf:-cf;o=n*i/2,r.point(-i,o),r.point(0,o),r.point(i,o)}else r.point(e[0],e[1])}),[-cf,-pf]);function hg(t,e){var n=_f(t),r=n>0,o=mf(n)>uf;function i(t,e){return _f(t)*_f(e)>n}function s(t,e,r){var o=[1,0,0],i=Nf(Mf(t),Mf(e)),s=Lf(i,i),a=i[0],l=s-a*a;if(!l)return!r&&t;var u=n*s/l,c=-n*a/l,p=Nf(o,i),h=kf(o,u);Ff(h,kf(i,c));var d=p,f=Lf(h,d),g=Lf(d,d),m=f*f-g*(Lf(h,h)-1);if(!(m<0)){var y=Cf(m),v=kf(d,(-f-y)/g);if(Ff(v,h),v=Df(v),!r)return v;var _,w=t[0],C=e[0],b=t[1],x=e[1];C<w&&(_=w,w=C,C=_);var E=C-w,S=mf(E-cf)<uf;if(!S&&x<b&&(_=b,b=x,x=_),S||E<uf?S?b+x>0^v[1]<(mf(v[0]-w)<uf?b:x):b<=v[1]&&v[1]<=x:E>cf^(w<=v[0]&&v[0]<=C)){var T=kf(d,(-f+y)/g);return Ff(T,h),[v,Df(T)]}}}function a(e,n){var o=r?t:cf-t,i=0;return e<-o?i|=1:e>o&&(i|=2),n<-o?i|=4:n>o&&(i|=8),i}return lg(i,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(p,h){var d,f=[p,h],g=i(p,h),m=r?g?0:a(p,h):g?a(p+(p<0?cf:-cf),h):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(!(d=s(e,f))||qf(e,d)||qf(f,d))&&(f[0]+=uf,f[1]+=uf,g=i(f[0],f[1])),g!==l)c=0,g?(t.lineStart(),d=s(f,e),t.point(d[0],d[1])):(d=s(e,f),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(o&&e&&r^g){var y;m&n||!(y=s(f,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||e&&qf(e,f)||t.point(f[0],f[1]),e=f,l=g,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(n,r,o,i){!function(t,e,n,r,o,i){if(n){var s=_f(e),a=wf(e),l=r*n;null==o?(o=e+r*df,i=e-l/2):(o=Uf(s,o),i=Uf(s,i),(r>0?o<i:o>i)&&(o+=r*df));for(var u,c=o;r>0?c>i:c<i;c-=l)u=Df([s,-a*_f(c),-a*wf(c)]),t.point(u[0],u[1])}}(i,t,e,o,n,r)}),r?[0,-t]:[-cf,t-cf])}function dg(t){return function(e){var n=new fg;for(var r in t)n[r]=t[r];return n.stream=e,n}}function fg(){}function gg(t,e,n){var r=e[1][0]-e[0][0],o=e[1][1]-e[0][1],i=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),function(t,e){t&&Pf.hasOwnProperty(t.type)?Pf[t.type](t,e):Sf(t,e)}(n,t.stream(ag));var s=ag.result(),a=Math.min(r/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),l=+e[0][0]+(r-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(o-a*(s[1][1]+s[0][1]))/2;return null!=i&&t.clipExtent(i),t.scale(150*a).translate([l,u])}fg.prototype={constructor:fg,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var mg=_f(30*gf);function yg(t,e){return+e?function(t,e){function n(r,o,i,s,a,l,u,c,p,h,d,f,g,m){var y=u-r,v=c-o,_=y*y+v*v;if(_>4*e&&g--){var w=s+h,C=a+d,b=l+f,x=Cf(w*w+C*C+b*b),E=xf(b/=x),S=mf(mf(b)-1)<uf||mf(i-p)<uf?(i+p)/2:vf(C,w),T=t(S,E),R=T[0],P=T[1],O=R-r,I=P-o,A=v*O-y*I;(A*A/_>e||mf((y*O+v*I)/_-.5)>.3||s*h+a*d+l*f<mg)&&(n(r,o,i,s,a,l,R,P,S,w/=x,C/=x,b,g,m),m.point(R,P),n(R,P,S,w,C,b,u,c,p,h,d,f,g,m))}}return function(e){var r,o,i,s,a,l,u,c,p,h,d,f,g={point:m,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),g.lineStart=w},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,g.point=v,e.lineStart()}function v(r,o){var i=Mf([r,o]),s=t(r,o);n(c,p,u,h,d,f,c=s[0],p=s[1],u=r,h=i[0],d=i[1],f=i[2],16,e),e.point(c,p)}function _(){g.point=m,e.lineEnd()}function w(){y(),g.point=C,g.lineEnd=b}function C(t,e){v(r=t,e),o=c,i=p,s=h,a=d,l=f,g.point=v}function b(){n(c,p,u,h,d,f,o,i,r,s,a,l,16,e),g.lineEnd=_,_()}return g}}(t,e):function(t){return dg({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var vg=dg({point:function(t,e){this.stream.point(t*gf,e*gf)}}),_g=function(t,e){var n=_f(t),r=_f(e),o=function(t){return(t=bf(t))&&t/wf(t)}(n*r);return[o*r*wf(t),o*wf(e)]};function wg(){return function(t){return function(t){var e,n,r,o,i,s,a,l,u,c,p=150,h=480,d=250,f=0,g=0,m=0,y=0,v=0,_=null,w=pg,C=null,b=ng,x=.5,E=yg(R,x);function S(t){return[(t=i(t[0]*gf,t[1]*gf))[0]*p+n,r-t[1]*p]}function T(t){return(t=i.invert((t[0]-n)/p,(r-t[1])/p))&&[t[0]*ff,t[1]*ff]}function R(t,o){return[(t=e(t,o))[0]*p+n,r-t[1]*p]}function P(){i=Bf(o=function(t,e,n){return(t%=df)?e||n?Bf(jf(t),Hf(e,n)):jf(t):e||n?Hf(e,n):Vf}(m,y,v),e);var t=e(f,g);return n=h-t[0]*p,r=d+t[1]*p,O()}function O(){return u=c=null,S}return S.stream=function(t){return u&&c===t?u:u=vg(w(o,E(b(c=t))))},S.clipAngle=function(t){return arguments.length?(w=+t?hg(_=t*gf,6*gf):(_=null,pg),O()):_*ff},S.clipExtent=function(t){return arguments.length?(b=null==t?(C=s=a=l=null,ng):tg(C=+t[0][0],s=+t[0][1],a=+t[1][0],l=+t[1][1]),O()):null==C?null:[[C,s],[a,l]]},S.scale=function(t){return arguments.length?(p=+t,P()):p},S.translate=function(t){return arguments.length?(h=+t[0],d=+t[1],P()):[h,d]},S.center=function(t){return arguments.length?(f=t[0]%360*gf,g=t[1]%360*gf,P()):[f*ff,g*ff]},S.rotate=function(t){return arguments.length?(m=t[0]%360*gf,y=t[1]%360*gf,v=t.length>2?t[2]%360*gf:0,P()):[m*ff,y*ff,v*ff]},S.precision=function(t){return arguments.length?(E=yg(R,x=t*t),O()):Cf(x)},S.fitExtent=function(t,e){return gg(S,t,e)},S.fitSize=function(t,e){return function(t,e,n){return gg(t,[[0,0],e],n)}(S,t,e)},function(){return e=t.apply(this,arguments),S.invert=e.invert&&T,P()}}((function(){return t}))()}(_g).scale(79.4188).clipAngle(179.999)}function Cg(t,e,r,o){var i=t.properties||{},a="Feature"===t.type?t.geometry:t;if("GeometryCollection"===a.type){var l=[];return V(t,(function(t){var n=Cg(t,e,r,o);n&&l.push(n)})),f(l)}var u=function(t){var e=cn(t).geometry.coordinates,r=[-e[0],-e[1]];return wg().rotate(r).scale(n)}(a),c={type:a.type,coordinates:bg(a.coordinates,u)},p=(new Uc).read(c),h=w(C(e,r),"meters"),d=kh.bufferOp(p,h,o);if(!function t(e){return Array.isArray(e[0])?t(e[0]):isNaN(e[0])}((d=(new Wc).write(d)).coordinates))return s({type:d.type,coordinates:xg(d.coordinates,u)},i)}function bg(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return bg(t,e)}))}function xg(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return xg(t,e)}))}function Eg(t,e,n){void 0===n&&(n={});var r=ot(t),o=ot(e),i=_l.intersection(r.coordinates,o.coordinates);return 0===i.length?null:1===i.length?c(i[0],n.properties):y(i,n.properties)}function Sg(t,e,n){void 0===n&&(n={});var r=JSON.stringify(n.properties||{}),o=t[0],i=t[1],s=t[2],a=t[3],l=(i+a)/2,u=(o+s)/2,c=2*e/ye([o,l],[s,l],n)*(s-o),p=2*e/ye([u,i],[u,a],n)*(a-i),h=c/2,d=2*h,g=Math.sqrt(3)/2*p,m=s-o,y=a-i,v=3/4*d,_=g,w=(m-d)/(d-h/2),C=Math.floor(w),b=(C*v-h/2-m)/2-h/2+v/2,x=Math.floor((y-g)/g),E=(y-x*g)/2,S=x*g-y>g/2;S&&(E-=g/4);for(var T=[],R=[],P=0;P<6;P++){var O=2*Math.PI/6*P;T.push(Math.cos(O)),R.push(Math.sin(O))}for(var I=[],A=0;A<=C;A++)for(var D=0;D<=x;D++){var M=A%2==1;if((0!==D||!M)&&(0!==D||!S)){var L=A*v+o-b,N=D*_+i+E;if(M&&(N-=g/2),!0===n.triangles)Rg([L,N],c/2,p/2,JSON.parse(r),T,R).forEach((function(t){n.mask?Eg(n.mask,t)&&I.push(t):I.push(t)}));else{var F=Tg([L,N],c/2,p/2,JSON.parse(r),T,R);n.mask?Eg(n.mask,F)&&I.push(F):I.push(F)}}}return f(I)}function Tg(t,e,n,r,o,i){for(var s=[],a=0;a<6;a++){var l=t[0]+e*o[a],u=t[1]+n*i[a];s.push([l,u])}return s.push(s[0].slice()),c([s],r)}function Rg(t,e,n,r,o,i){for(var s=[],a=0;a<6;a++){var l=[];l.push(t),l.push([t[0]+e*o[a],t[1]+n*i[a]]),l.push([t[0]+e*o[(a+1)%6],t[1]+n*i[(a+1)%6]]),l.push(t),s.push(c([l],r))}return s}function Pg(t){return y(t)}function Og(t,e,n){return void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});for(var o=[],i=t[0],s=t[1],a=t[2],l=t[3],u=e/ye([i,s],[a,s],r)*(a-i),p=n/ye([i,s],[i,l],r)*(l-s),h=a-i,d=l-s,g=Math.floor(h/u),m=Math.floor(d/p),y=(d-m*p)/2,v=i+(h-g*u)/2,_=0;_<g;_++){for(var w=s+y,C=0;C<m;C++){var b=c([[[v,w],[v,w+p],[v+u,w+p],[v+u,w],[v,w]]],r.properties);r.mask?ns(r.mask,b)&&o.push(b):o.push(b),w+=p}v+=u}return f(o)}(t,e,e,n)}function Ig(t,e,n){void 0===n&&(n={});for(var r=[],o=e/ye([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),i=e/ye([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),s=0,a=t[0];a<=t[2];){for(var l=0,u=t[1];u<=t[3];){var p=null,h=null;s%2==0&&l%2==0?(p=c([[[a,u],[a,u+i],[a+o,u],[a,u]]],n.properties),h=c([[[a,u+i],[a+o,u+i],[a+o,u],[a,u+i]]],n.properties)):s%2==0&&l%2==1?(p=c([[[a,u],[a+o,u+i],[a+o,u],[a,u]]],n.properties),h=c([[[a,u],[a,u+i],[a+o,u+i],[a,u]]],n.properties)):l%2==0&&s%2==1?(p=c([[[a,u],[a,u+i],[a+o,u+i],[a,u]]],n.properties),h=c([[[a,u],[a+o,u+i],[a+o,u],[a,u]]],n.properties)):l%2==1&&s%2==1&&(p=c([[[a,u],[a,u+i],[a+o,u],[a,u]]],n.properties),h=c([[[a,u+i],[a+o,u+i],[a+o,u],[a,u+i]]],n.properties)),n.mask?(Eg(n.mask,p)&&r.push(p),Eg(n.mask,h)&&r.push(h)):(r.push(p),r.push(h)),u+=i,l++}s++,a+=o}return f(r)}_g.invert=function(t,e){var n=Cf(t*t+e*e),r=n,o=wf(r),i=_f(r);return[vf(t*o,n*i),xf(n&&e*o/n)]},e.along=function(t,e,n){void 0===n&&(n={});for(var r=ot(t).coordinates,o=0,i=0;i<r.length&&!(e>=o&&i===r.length-1);i++){if(o>=e){var s=e-o;if(s){var a=un(r[i],r[i-1])-180;return an(r[i],s,a,n)}return l(r[i])}o+=ye(r[i],r[i+1],n)}return l(r[r.length-1])},e.angle=function(t,e,n,r){if(void 0===r&&(r={}),!O(r))throw new Error("options is invalid");if(!t)throw new Error("startPoint is required");if(!e)throw new Error("midPoint is required");if(!n)throw new Error("endPoint is required");var o=t,i=e,s=n,a=x(!0!==r.mercator?un(o,i):_o(o,i)),l=x(!0!==r.mercator?un(s,i):_o(s,i)),u=Math.abs(a-l);return!0===r.explementary?360-u:u},e.applyFilter=Da,e.area=Cr,e.areaFactors=i,e.bbox=Q,e.bboxClip=function(t,e){var n=ot(t),r=n.type,o="Feature"===t.type?t.properties:{},i=n.coordinates;switch(r){case"LineString":case"MultiLineString":var s=[];return"LineString"===r&&(i=[i]),i.forEach((function(t){!function(t,e,n){var r,o,i,s,a,l=t.length,u=co(t[0],e),c=[];for(n||(n=[]),r=1;r<l;r++){for(s=t[r-1],o=i=co(a=t[r],e);;){if(!(u|o)){c.push(s),o!==i?(c.push(a),r<l-1&&(n.push(c),c=[])):r===l-1&&c.push(a);break}if(u&o)break;u?u=co(s=uo(s,a,u,e),e):o=co(a=uo(s,a,o,e),e)}u=i}c.length&&n.push(c)}(t,e,s)})),1===s.length?h(s[0],o):g(s,o);case"Polygon":return c(po(i,e),o);case"MultiPolygon":return y(i.map((function(t){return po(t,e)})),o);default:throw new Error("geometry "+r+" not supported")}},e.bboxPolygon=rn,e.bearing=un,e.bearingToAngle=x,e.bearingToAzimuth=x,e.bezier=nn,e.bezierSpline=nn,e.booleanClockwise=So,e.booleanContains=function(t,e){var n=ot(t),r=ot(e),o=n.type,i=r.type,s=n.coordinates,a=r.coordinates;switch(o){case"Point":switch(i){case"Point":return Wi(s,a);default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"Point":return function(t,e){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(Wi(t.coordinates[n],e.coordinates)){r=!0;break}return r}(n,r);case"MultiPoint":return function(t,e){for(var n=0,r=e.coordinates;n<r.length;n++){for(var o=r[n],i=!1,s=0,a=t.coordinates;s<a.length;s++)if(Wi(o,a[s])){i=!0;break}if(!i)return!1}return!0}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"Point":return Rr(r,n,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,r=0,o=e.coordinates;r<o.length;r++){var i=o[r];if(Rr({type:"Point",coordinates:i},t,{ignoreEndVertices:!0})&&(n=!0),!Rr({type:"Point",coordinates:i},t,{ignoreEndVertices:!1}))return!1}return n}(n,r);case"MultiPoint":return function(t,e){for(var n=!1,r=0,o=e.coordinates;r<o.length;r++){var i=o[r];if(Rr(i,t,{ignoreEndVertices:!0})&&(n=!0),!Rr(i,t))return!1}return!!n}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Point":return fe(r,n,{ignoreBoundary:!0});case"LineString":return function(t,e){var n=!1,r=0;if(!Ui(Q(t),Q(e)))return!1;for(;r<e.coordinates.length-1;r++)if(fe({type:"Point",coordinates:qi(e.coordinates[r],e.coordinates[r+1])},t,{ignoreBoundary:!0})){n=!0;break}return n}(n,r);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!Ui(Q(t),Q(e)))return!1;for(var n=0,r=ot(e).coordinates;n<r.length;n++)for(var o=0,i=r[n];o<i.length;o++)if(!fe(i[o],t))return!1;return!0}(n,r);case"MultiPoint":return function(t,e){for(var n=0,r=e.coordinates;n<r.length;n++)if(!fe(r[n],t,{ignoreBoundary:!0}))return!1;return!0}(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+o+" geometry not supported")}},e.booleanCrosses=function(t,e){var n=ot(t),r=ot(e),o=n.type,i=r.type;switch(o){case"MultiPoint":switch(i){case"LineString":return Xi(n,r);case"Polygon":return Yi(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"MultiPoint":return Xi(r,n);case"LineString":return function(t,e){if(pr(t,e).features.length>0)for(var n=0;n<t.coordinates.length-1;n++)for(var r=0;r<e.coordinates.length-1;r++){var o=!0;if(0!==r&&r!==e.coordinates.length-2||(o=!1),Zi(t.coordinates[n],t.coordinates[n+1],e.coordinates[r],o))return!0}return!1}(n,r);case"Polygon":return Ki(n,r);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"MultiPoint":return Yi(r,n);case"LineString":return Ki(r,n);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+o+" geometry not supported")}},e.booleanDisjoint=Vi,e.booleanEqual=function(t,e){return ot(t).type===ot(e).type&&new es({precision:6}).compare(We(t),We(e))},e.booleanIntersects=ns,e.booleanOverlap=function(t,e){var n=ot(t),r=ot(e),o=n.type,i=r.type;if("MultiPoint"===o&&"MultiPoint"!==i||("LineString"===o||"MultiLineString"===o)&&"LineString"!==i&&"MultiLineString"!==i||("Polygon"===o||"MultiPolygon"===o)&&"Polygon"!==i&&"MultiPolygon"!==i)throw new Error("features must be of the same type");if("Point"===o)throw new Error("Point geometry not supported");if(new es({precision:6}).compare(t,e))return!1;var s=0;switch(o){case"MultiPoint":for(var a=0;a<n.coordinates.length;a++)for(var l=0;l<r.coordinates.length;l++){var u=n.coordinates[a],c=r.coordinates[l];if(u[0]===c[0]&&u[1]===c[1])return!0}return!1;case"LineString":case"MultiLineString":U(t,(function(t){U(e,(function(e){mo(t,e).features.length&&s++}))}));break;case"Polygon":case"MultiPolygon":U(t,(function(t){U(e,(function(e){pr(t,e).features.length&&s++}))}))}return s>0},e.booleanParallel=function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==gs(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==gs(e,"line2"))throw new Error("line2 must be a LineString");for(var n=Vn(We(t)).features,r=Vn(We(e)).features,o=0;o<n.length;o++){var i=n[o].geometry.coordinates;if(!r[o])break;if(!fs(i,r[o].geometry.coordinates))return!1}return!0},e.booleanPointInPolygon=fe,e.booleanPointOnLine=Rr,e.booleanWithin=Or,e.buffer=function(t,e,n){var r=(n=n||{}).units||"kilometers",o=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof o)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");var i=[];switch(t.type){case"GeometryCollection":return V(t,(function(t){var n=Cg(t,e,r,o);n&&i.push(n)})),f(i);case"FeatureCollection":return k(t,(function(t){var n=Cg(t,e,r,o);n&&k(n,(function(t){t&&i.push(t)}))})),f(i)}return Cg(t,e,r,o)},e.center=cn,e.centerMean=la,e.centerMedian=function(t,e){if(void 0===e&&(e={}),!O(e=e||{}))throw new Error("options is invalid");var n=e.counter||10;if(!P(n))throw new Error("counter must be a number");var r=e.weight,o=la(t,{weight:e.weight}),i=f([]);k(t,(function(t){var e;i.features.push(pn(t,{properties:{weight:null===(e=t.properties)||void 0===e?void 0:e[r]}}))}));var s={tolerance:e.tolerance,medianCandidates:[]};return function t(e,n,r,o,i){var s=o.tolerance||.001,a=0,u=0,c=0,p=0;if(k(r,(function(t){var n,r=null===(n=t.properties)||void 0===n?void 0:n.weight,o=null==r?1:r;if(!P(o=Number(o)))throw new Error("weight value must be a number");if(o>0){p+=1;var i=o*ye(t,e);0===i&&(i=1);var s=o/i;a+=t.geometry.coordinates[0]*s,u+=t.geometry.coordinates[1]*s,c+=s}})),p<1)throw new Error("no features to measure");var h=a/c,d=u/c;return 1===p||0===i||Math.abs(h-n[0])<s&&Math.abs(d-n[1])<s?l([h,d],{medianCandidates:o.medianCandidates}):(o.medianCandidates.push([h,d]),t([h,d],e,r,o,i-1))}(o.geometry.coordinates,[0,0],i,s,n)},e.centerOfMass=function t(e,n){switch(void 0===n&&(n={}),it(e)){case"Point":return l(J(e),n.properties);case"Polygon":var r=[];M(e,(function(t){r.push(t)}));var o,i,s,a,u,c,p,h,d=pn(e,{properties:n.properties}),f=d.geometry.coordinates,g=0,m=0,y=0,v=r.map((function(t){return[t[0]-f[0],t[1]-f[1]]}));for(o=0;o<r.length-1;o++)a=(i=v[o])[0],c=i[1],u=(s=v[o+1])[0],y+=h=a*(p=s[1])-u*c,g+=(a+u)*h,m+=(c+p)*h;if(0===y)return d;var _=1/(.5*y*6);return l([f[0]+_*g,f[1]+_*m],n.properties);default:var w=de(e);return w?t(w,{properties:n.properties}):pn(e,{properties:n.properties})}},e.centroid=pn,e.circle=ln,e.cleanCoords=We,e.clone=be,e.clusterEach=Oa,e.clusterReduce=Ia,e.clusters=Na,e.clustersDbscan=function(t,e,n){void 0===n&&(n={}),!0!==n.mutate&&(t=be(t)),n.minPoints=n.minPoints||3;var r=new as.DBSCAN,o=r.run(B(t),T(e,n.units),n.minPoints,ye),i=-1;return o.forEach((function(e){i++,e.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster=i,n.properties.dbscan="core"}))})),r.noise.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster?n.properties.dbscan="edge":n.properties.dbscan="noise"})),t},e.clustersKmeans=function(t,e){void 0===e&&(e={});var n=t.features.length;e.numberOfClusters=e.numberOfClusters||Math.round(Math.sqrt(n/2)),e.numberOfClusters>n&&(e.numberOfClusters=n),!0!==e.mutate&&(t=be(t));var r=B(t),o=r.slice(0,e.numberOfClusters),i=ds(r,e.numberOfClusters,o),s={};return i.centroids.forEach((function(t,e){s[e]=t})),k(t,(function(t,e){var n=i.idxs[e];t.properties.cluster=n,t.properties.centroid=s[n]})),t},e.collect=function(t,e,n,r){var o=Et(6),i=e.features.map((function(t){var e;return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:null===(e=t.properties)||void 0===e?void 0:e[n]}}));return o.load(i),t.features.forEach((function(t){t.properties||(t.properties={});var e=Q(t),n=o.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}),i=[];n.forEach((function(e){fe([e.minX,e.minY],t)&&i.push(e.property)})),t.properties[r]=i})),t},e.collectionOf=rt,e.combine=function(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return k(t,(function(t){var n,r,o,i;switch(null===(i=t.geometry)||void 0===i?void 0:i.type){case"Point":e.MultiPoint.coordinates.push(t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"MultiPoint":(n=e.MultiPoint.coordinates).push.apply(n,t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"LineString":e.MultiLineString.coordinates.push(t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"MultiLineString":(r=e.MultiLineString.coordinates).push.apply(r,t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"Polygon":e.MultiPolygon.coordinates.push(t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties);break;case"MultiPolygon":(o=e.MultiPolygon.coordinates).push.apply(o,t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties)}})),f(Object.keys(e).filter((function(t){return e[t].coordinates.length})).sort().map((function(t){return s({type:t,coordinates:e[t].coordinates},{collectedProperties:e[t].properties})})))},e.concave=function(t,e){void 0===e&&(e={});var n=e.maxEdge||1/0,r=ve(function(t){var e=[],n={};return k(t,(function(t){if(t.geometry){var r=t.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(n,r)||(e.push(t),n[r]=!0)}})),f(e)}(t));if(r.features=r.features.filter((function(t){var r=t.geometry.coordinates[0][0],o=t.geometry.coordinates[0][1],i=t.geometry.coordinates[0][2],s=ye(r,o,e),a=ye(o,i,e),l=ye(r,i,e);return s<=n&&a<=n&&l<=n})),r.features.length<1)return null;var o=Ue(r);return 1===o.coordinates.length&&(o.coordinates=o.coordinates[0],o.type="Polygon"),s(o)},e.containsNumber=tt,e.convertArea=R,e.convertDistance=T,e.convertLength=T,e.convex=de,e.coordAll=B,e.coordEach=M,e.coordReduce=L,e.createBins=Aa,e.degrees2radians=S,e.degreesToRadians=S,e.destination=an,e.difference=function(t,e){var n=ot(t),r=ot(e),o=t.properties||{},i=_l.difference(n.coordinates,r.coordinates);return 0===i.length?null:1===i.length?c(i[0],o):y(i,o)},e.dissolve=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.propertyName;rt(t,"Polygon","dissolve");var r=[];if(!e.propertyName)return Nr(y(_l.union.apply(null,t.features.map((function(t){return t.geometry.coordinates})))));var o={};k(t,(function(t){Object.prototype.hasOwnProperty.call(o,t.properties[n])||(o[t.properties[n]]=[]),o[t.properties[n]].push(t)}));for(var i=Object.keys(o),s=0;s<i.length;s++){var a=y(_l.union.apply(null,o[i[s]].map((function(t){return t.geometry.coordinates}))));a.properties[n]=i[s],r.push(a)}return Nr(f(r))},e.distance=ye,e.distanceToDegrees=b,e.distanceToRadians=C,e.distanceWeight=da,e.earthRadius=n,e.ellipse=sa,e.envelope=on,e.explode=hn,e.factors=r,e.feature=s,e.featureCollection=f,e.featureEach=k,e.featureOf=nt,e.featureReduce=G,e.filterProperties=La,e.findPoint=Y,e.findSegment=K,e.flatten=Nr,e.flattenEach=j,e.flattenReduce=H,e.flip=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=be(t)),M(t,(function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e})),t},e.geojsonType=et,e.geomEach=V,e.geomReduce=z,e.geometry=a,e.geometryCollection=v,e.getCluster=Pa,e.getCoord=J,e.getCoords=$,e.getGeom=ot,e.getType=it,e.greatCircle=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.properties,o=n.npoints,i=n.offset;return t=J(t),e=J(e),r=r||{},o=o||100,i=i||10,new Yr({x:t[0],y:t[1]},{x:e[0],y:e[1]},r).Arc(o,{offset:i}).json()},e.helpers=D,e.hexGrid=Sg,e.inside=fe,e.interpolate=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.gridType,o=n.property,i=n.weight;if(!t)throw new Error("points is required");if(rt(t,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(void 0!==i&&"number"!=typeof i)throw new Error("weight must be a number");o=o||"elevation",r=r||"square",i=i||1;var s,a=Q(t);switch(r){case"point":case"points":s=Mr(a,e,n);break;case"square":case"squares":s=Og(a,e,n);break;case"hex":case"hexes":s=Sg(a,e,n);break;case"triangle":case"triangles":s=Ig(a,e,n);break;default:throw new Error("invalid gridType")}var l=[];return k(s,(function(e){var s=0,a=0;k(t,(function(t){var l,u=ye("point"===r?e:pn(e),t,n);if(void 0!==o&&(l=t.properties[o]),void 0===l&&(l=t.geometry.coordinates[2]),void 0===l)throw new Error("zValue is missing");0===u&&(s=l);var c=1/Math.pow(u,i);a+=c,s+=c*l}));var u=be(e);u.properties[o]=s/a,l.push(u)})),f(l)},e.intersect=Eg,e.invariant=st,e.isNumber=P,e.isObject=O,e.isobands=function(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},i=n.breaksProperties||[];if(rt(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!O(o))throw new Error("commonProperties is not an Object");if(!Array.isArray(i))throw new Error("breaksProperties is not an Array");var s=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",r=e.flip,o=e.flags;rt(t,"Point","input must contain Points");for(var i=function(t,e){var n={};return k(t,(function(t){var e=$(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return $(t)[0]-$(e)[0]}))})).sort((function(t,n){return e?$(t[0])[1]-$(n[0])[1]:$(n[0])[1]-$(t[0])[1]}))}(t,r),s=[],a=0;a<i.length;a++){for(var l=i[a],u=[],c=0;c<l.length;c++){var p=l[c];p.properties[n]?u.push(p.properties[n]):u.push(0),!0===o&&(p.properties.matrixPosition=[a,c])}s.push(u)}return s}(t,{zProperty:r,flip:!0}),a=function(t,e,n){for(var r=[],o=1;o<e.length;o++){var i=+e[o-1],s=+e[o],a=Si(Ei(Ao(t,i,s-i))),l={};l.groupedRings=a,l[n]=i+"-"+s,r.push(l)}return r}(s,e,r);return f((a=function(t,e,n){var r=Q(n),o=r[2]-r[0],i=r[3]-r[1],s=r[0],a=r[1],l=e[0].length-1,u=e.length-1,c=o/l,p=i/u,h=function(t){t[0]=t[0]*c+s,t[1]=t[1]*p+a};return t.forEach((function(t){t.groupedRings.forEach((function(t){t.forEach((function(t){t.forEach(h)}))}))})),t}(a,s,t)).map((function(t,e){if(i[e]&&!O(i[e]))throw new Error("Each mappedProperty is required to be an Object");var n=pt({},o,i[e]);return n[r]=t[r],y(t.groupedRings,n)})))},e.isolines=function(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},i=n.breaksProperties||[];if(rt(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!O(o))throw new Error("commonProperties must be an Object");if(!Array.isArray(i))throw new Error("breaksProperties must be an Array");var s=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",r=e.flip,o=e.flags;rt(t,"Point","input must contain Points");for(var i=function(t,e){var n={};return k(t,(function(t){var e=$(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return $(t)[0]-$(e)[0]}))})).sort((function(t,n){return e?$(t[0])[1]-$(n[0])[1]:$(n[0])[1]-$(t[0])[1]}))}(t,r),s=[],a=0;a<i.length;a++){for(var l=i[a],u=[],c=0;c<l.length;c++){var p=l[c];p.properties[n]?u.push(p.properties[n]):u.push(0),!0===o&&(p.properties.matrixPosition=[a,c])}s.push(u)}return s}(t,{zProperty:r,flip:!0});return f(function(t,e,n){var r=Q(n),o=r[2]-r[0],i=r[3]-r[1],s=r[0],a=r[1],l=e[0].length-1,u=e.length-1,c=o/l,p=i/u,h=function(t){t[0]=t[0]*c+s,t[1]=t[1]*p+a};return t.forEach((function(t){M(t,h)})),t}(function(t,e,n,r,o){for(var i=[],s=1;s<e.length;s++){var a=+e[s],l=pt({},r,o[s]);l[n]=a;var u=g(ft(t,a),l);i.push(u)}return i}(s,e,r,o,i),s,t))},e.kinks=function(t){var e,n,r={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var o=n;o<e.length-1;o++){if(t===e){if(1===Math.abs(n-o))continue;if(0===n&&o===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var i=vr(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);i&&r.features.push(l([i[0],i[1]]))}}))})),r},e.length=Sr,e.lengthToDegrees=b,e.lengthToRadians=C,e.lineArc=to,e.lineChunk=function(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.units,o=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var i=[];return j(t,(function(t){o&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,r){var o=Sr(t,{units:n});if(o<=e)return r(t);var i=o/e;Number.isInteger(i)||(i=Math.floor(i)+1);for(var s=0;s<i;s++)r(Tr(t,e*s,e*(s+1),{units:n}))}(t,e,r,(function(t){i.push(t)}))})),f(i)},e.lineDistance=Sr,e.lineEach=q,e.lineIntersect=pr,e.lineOffset=function(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var o=it(t),i=t.properties;switch(o){case"LineString":return Mi(t,e,r);case"MultiLineString":var s=[];return j(t,(function(t){s.push(Mi(t,e,r).geometry.coordinates)})),g(s,i);default:throw new Error("geometry "+o+" is not supported")}},e.lineOverlap=mo,e.lineReduce=X,e.lineSegment=Vn,e.lineSlice=function(t,e,n){var r=$(n);if("LineString"!==it(n))throw new Error("line must be a LineString");for(var o,i=dr(n,t),s=dr(n,e),a=[(o=i.properties.index<=s.properties.index?[i,s]:[s,i])[0].geometry.coordinates],l=o[0].properties.index+1;l<o[1].properties.index+1;l++)a.push(r[l]);return a.push(o[1].geometry.coordinates),h(a,n.properties)},e.lineSliceAlong=Tr,e.lineSplit=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=it(t),r=it(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===r)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===r)throw new Error("splitter cannot be a GeometryCollection");var o=Lr(e,{precision:7});switch(r){case"Point":return Qr(t,o);case"MultiPoint":return Zr(t,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Zr(t,pr(t,o))}},e.lineString=h,e.lineStringToPolygon=io,e.lineStrings=d,e.lineToPolygon=io,e.mask=function(t,e){var n,r=function(t){return c(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}(e);return("FeatureCollection"===t.type?Pg(2===(n=t).features.length?_l.union(n.features[0].geometry.coordinates,n.features[1].geometry.coordinates):_l.union.apply(_l,n.features.map((function(t){return t.geometry.coordinates})))):Pg(_l.union(t.geometry.coordinates))).geometry.coordinates.forEach((function(t){r.geometry.coordinates.push(t[0])})),r},e.meta=Z,e.midpoint=function(t,e){return an(t,ye(t,e)/2,un(t,e))},e.moranIndex=function(t,e){var n=e.inputField,r=e.threshold||1e5,o=e.p||2,i=e.binary||!1,s=da(t,{alpha:e.alpha||-1,binary:i,p:o,standardization:e.standardization||!0,threshold:r}),a=[];k(t,(function(t){var e=t.properties||{};a.push(e[n])}));for(var l=fa(a),u=function(t){for(var e=fa(t),n=0,r=0,o=t;r<o.length;r++){var i=o[r];n+=Math.pow(i-e,2)}return n/t.length}(a),c=0,p=0,h=0,d=0,f=s.length,g=0;g<f;g++){for(var m=0,y=0;y<f;y++)c+=s[g][y]*(a[g]-l)*(a[y]-l),p+=s[g][y],h+=Math.pow(s[g][y]+s[y][g],2),m+=s[g][y]+s[y][g];d+=Math.pow(m,2)}var v=c/p/u,_=-1/(f-1),w=(f*f*(h*=.5)-f*d+p*p*3)/((f-1)*(f+1)*(p*p))-_*_,C=Math.sqrt(w);return{expectedMoranIndex:_,moranIndex:v,stdNorm:C,zNorm:(v-_)/C}},e.multiLineString=g,e.multiPoint=m,e.multiPolygon=y,e.nearest=Bn,e.nearestPoint=Bn,e.nearestPointOnLine=dr,e.nearestPointToLine=function(t,e,n){void 0===n&&(n={});var r=n.units,o=n.properties||{},i=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return V(t,(function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})})),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter((function(t){return"Point"===t.geometry.type})),t;default:throw new Error("points must be a Point Collection")}}(t);if(!i.features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if("LineString"!==it(e))throw new Error("line must be a LineString");var s=1/0,a=null;return k(i,(function(t){var n=gr(t,e,{units:r});n<s&&(s=n,a=t)})),a&&(a.properties=pt({dist:s},a.properties,o)),a},e.planepoint=function(t,e){var n=J(t),r=ot(e).coordinates[0];if(r.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var o=e.properties||{},i=o.a,s=o.b,a=o.c,l=n[0],u=n[1],c=r[0][0],p=r[0][1],h=void 0!==i?i:r[0][2],d=r[1][0],f=r[1][1],g=void 0!==s?s:r[1][2],m=r[2][0],y=r[2][1],v=void 0!==a?a:r[2][2];return(v*(l-c)*(u-f)+h*(l-d)*(u-y)+g*(l-m)*(u-p)-g*(l-c)*(u-y)-v*(l-d)*(u-p)-h*(l-m)*(u-f))/((l-c)*(u-f)+(l-d)*(u-y)+(l-m)*(u-p)-(l-c)*(u-y)-(l-d)*(u-p)-(l-m)*(u-f))},e.point=l,e.pointGrid=Mr,e.pointOnFeature=_r,e.pointOnLine=dr,e.pointOnSurface=_r,e.pointToLineDistance=gr,e.points=u,e.pointsWithinPolygon=me,e.polygon=c,e.polygonSmooth=function(t,e){var n=[],r=e.iterations||1;if(!t)throw new Error("inputPolys is required");return V(t,(function(t,e,o){var i,s,a;switch(t.type){case"Polygon":i=[[]];for(var l=0;l<r;l++)a=[[]],s=t,l>0&&(s=c(i).geometry),ca(s,a),i=a.slice(0);n.push(c(i,o));break;case"MultiPolygon":i=[[[]]];for(var u=0;u<r;u++)a=[[[]]],s=t,u>0&&(s=y(i).geometry),pa(s,a),i=a.slice(0);n.push(y(i,o));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}})),f(n)},e.polygonTangents=function(t,e){var n,r,o,i,s=$(t),a=$(e),u=Q(e),c=0,p=null;switch(s[0]>u[0]&&s[0]<u[2]&&s[1]>u[1]&&s[1]<u[3]&&(c=(p=Bn(t,hn(e))).properties.featureIndex),it(e)){case"Polygon":n=a[0][c],r=a[0][0],null!==p&&p.geometry.coordinates[1]<s[1]&&(r=a[0][c]),i=Eo(a[0][0],a[0][a[0].length-1],s);var h=bo(a[0],s,i,o,n,r);n=h[0],r=h[1];break;case"MultiPolygon":for(var d=0,g=0,m=0,y=0;y<a[0].length;y++){d=y;for(var v=!1,_=0;_<a[0][y].length;_++){if(g=_,m===c){v=!0;break}m++}if(v)break}n=a[0][d][g],r=a[0][d][g],i=Eo(a[0][0][0],a[0][0][a[0][0].length-1],s),a.forEach((function(t){var e=bo(t[0],s,i,o,n,r);n=e[0],r=e[1]}))}return f([l(n),l(r)])},e.polygonToLine=no,e.polygonToLineString=no,e.polygonize=function(t){var e=Bi.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],r=[];return e.getEdgeRings().filter((function(t){return t.isValid()})).forEach((function(t){t.isHole()?n.push(t):r.push(t)})),n.forEach((function(t){Gi.findEdgeRingContaining(t,r)&&r.push(t)})),f(r.map((function(t){return t.toPolygon()})))},e.polygons=p,e.projection=wa,e.propEach=N,e.propReduce=F,e.propertiesContainsFilter=Ma,e.radians2degrees=E,e.radiansToDegrees=E,e.radiansToDistance=w,e.radiansToLength=w,e.random=Ra,e.randomLineString=Ea,e.randomPoint=ba,e.randomPolygon=xa,e.randomPosition=Ca,e.rewind=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=be(t));var o=[];switch(t.type){case"GeometryCollection":return V(t,(function(t){To(t,n)})),t;case"FeatureCollection":return k(t,(function(t){k(To(t,n),(function(t){o.push(t)}))})),f(o)}return To(t,n)},e.rhumbBearing=_o,e.rhumbDestination=Co,e.rhumbDistance=fr,e.round=_,e.sample=function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return f(function(t,e){for(var n,r,o=t.slice(0),i=t.length,s=i-e;i-- >s;)n=o[r=Math.floor((i+1)*Math.random())],o[r]=o[i],o[i]=n;return o.slice(s)}(t.features,e))},e.sector=function(t,e,n,r,o){if(!O(o=o||{}))throw new Error("options is invalid");var i=o.properties;if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==r)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof o)throw new Error("options must be an object");if(vo(n)===vo(r))return ln(t,e,o);var s=$(t),a=to(t,e,n,r,o),l=[[s]];return M(a,(function(t){l[0].push(t)})),l[0].push(s),c(l,i)},e.segmentEach=U,e.segmentReduce=W,e.shortestPath=function(t,e,n){if(!O(n=n||{}))throw new Error("options is invalid");var r=n.resolution,o=n.minDistance,i=n.obstacles||f([]);if(!t)throw new Error("start is required");if(!e)throw new Error("end is required");if(r&&!P(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(o)throw new Error("options.minDistance is not yet implemented");var a=J(t),u=J(e);switch(t=l(a),e=l(u),it(i)){case"FeatureCollection":if(0===i.features.length)return h([a,u]);break;case"Polygon":i=f([s(ot(i))]);break;default:throw new Error("invalid obstacles")}var c=i;c.features.push(t),c.features.push(e);var p=Q(Oi(rn(Q(c)),1.15));r||(r=ye([p[0],p[1]],[p[2],p[1]],n)/100),c.features.pop(),c.features.pop();for(var d=p[0],g=p[1],m=p[2],y=p[3],v=r/ye([d,g],[m,g],n)*(m-d),_=r/ye([d,g],[d,y],n)*(y-g),w=m-d,C=y-g,b=Math.floor(w/v),x=Math.floor(C/_),E=(w-b*v)/2,S=[],T=[],R=[],I=[],A=1/0,D=1/0,M=y-(C-x*_)/2,L=0;M>=g;){for(var N=[],F=[],k=d+E,G=0;k<=m;){var B=l([k,M]),V=Cs(B,i);N.push(V?0:1),F.push(k+"|"+M);var z=ye(B,t);!V&&z<A&&(A=z,R={x:G,y:L});var j=ye(B,e);!V&&j<D&&(D=j,I={x:G,y:L}),k+=v,G++}T.push(N),S.push(F),M-=_,L++}var H=new vs(T,{diagonal:!0}),U=H.grid[R.y][R.x],W=H.grid[I.y][I.x],q=ys.search(H,U,W),X=[a];return q.forEach((function(t){var e=S[t.x][t.y].split("|");X.push([+e[0],+e[1]])})),X.push(u),We(h(X))},e.simplify=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,r=e.highQuality||!1,o=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==o&&(t=be(t)),V(t,(function(t){!function(t,e,n){var r=t.type;if("Point"===r||"MultiPoint"===r)return t;We(t,!0);var o=t.coordinates;switch(r){case"LineString":t.coordinates=Je(o,e,n);break;case"MultiLineString":t.coordinates=o.map((function(t){return Je(t,e,n)}));break;case"Polygon":t.coordinates=$e(o,e,n);break;case"MultiPolygon":t.coordinates=o.map((function(t){return $e(t,e,n)}))}}(t,n,r)})),t},e.square=sn,e.squareGrid=Og,e.standardDeviationalEllipse=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.steps||64,r=e.weight,o=e.properties||{};if(!P(n))throw new Error("steps must be a number");if(!O(o))throw new Error("properties must be a number");var i=B(t).length,s=la(t,{weight:r}),a=0,l=0,u=0;k(t,(function(t){var e=t.properties[r]||1,n=ua($(t),$(s));a+=Math.pow(n.x,2)*e,l+=Math.pow(n.y,2)*e,u+=n.x*n.y*e}));var c=a-l,p=Math.sqrt(Math.pow(c,2)+4*Math.pow(u,2)),h=2*u,d=Math.atan((c+p)/h),g=180*d/Math.PI,m=0,y=0,v=0;k(t,(function(t){var e=t.properties[r]||1,n=ua($(t),$(s));m+=Math.pow(n.x*Math.cos(d)-n.y*Math.sin(d),2)*e,y+=Math.pow(n.x*Math.sin(d)+n.y*Math.cos(d),2)*e,v+=e}));var _=Math.sqrt(2*m/v),w=Math.sqrt(2*y/v),C=sa(s,_,w,{units:"degrees",angle:g,steps:n,properties:o}),b=me(t,f([C])),x={meanCenterCoordinates:$(s),semiMajorAxis:_,semiMinorAxis:w,numberOfFeatures:i,angle:g,percentageWithinEllipse:100*B(b).length/i};return C.properties.standardDeviationalEllipse=x,C},e.tag=function(t,e,n,r){return t=be(t),e=be(e),k(t,(function(t){t.properties||(t.properties={}),k(e,(function(e){void 0===t.properties[r]&&fe(t,e)&&(t.properties[r]=e.properties[n])}))})),t},e.tesselate=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=Gn(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(Gn(t))})),e},e.tin=ve,e.toMercator=ga,e.toWgs84=ma,e.transformRotate=Pi,e.transformScale=Oi,e.transformTranslate=function(t,e,n,r){if(!O(r=r||{}))throw new Error("options is invalid");var o=r.units,i=r.zTranslation,s=r.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(i&&"number"!=typeof i&&isNaN(i))throw new Error("zTranslation is not a number");if(i=void 0!==i?i:0,0===e&&0===i)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n+=180),!1!==s&&void 0!==s||(t=be(t)),M(t,(function(t){var r=$(Co(t,e,n,{units:o}));t[0]=r[0],t[1]=r[1],i&&3===t.length&&(t[2]+=i)})),t},e.triangleGrid=Ig,e.truncate=Lr,e.union=function(t,e,n){void 0===n&&(n={});var r=ot(t),o=ot(e),i=_l.union(r.coordinates,o.coordinates);return 0===i.length?null:1===i.length?c(i[0],n.properties):y(i,n.properties)},e.unitsFactors=o,e.unkinkPolygon=function(t){var e=[];return j(t,(function(t){"Polygon"===t.geometry.type&&k(kr(t),(function(n){e.push(c(n.geometry.coordinates,t.properties))}))})),f(e)},e.validateBBox=I,e.validateId=A,e.voronoi=function(t,e){if(!O(e=e||{}))throw new Error("options is invalid");var n=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return rt(t,"Point","points"),f(function(){var t=xs,e=Es,n=null;function r(r){return new oa(r.map((function(n,o){var i=[Math.round(t(n,o,r)/ea)*ea,Math.round(e(n,o,r)/ea)*ea];return i.index=o,i.data=n,i})),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:bs(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}().x((function(t){return t.geometry.coordinates[0]})).y((function(t){return t.geometry.coordinates[1]})).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(t.features).map(ia))},e.within=me,Object.defineProperty(e,"__esModule",{value:!0})}(e)}).call(this,n(19))},function(t,e,n){},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e,n){"use strict";var r=n(3);function o(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var i;if(n)i=n(e);else if(r.isURLSearchParams(e))i=e.toString();else{var s=[];r.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),s.push(o(e)+"="+o(t))})))})),i=s.join("&")}if(i){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";(function(e){var r=n(3),o=n(48),i={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a={adapter:function(){var t;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof e&&"[object process]"===Object.prototype.toString.call(e))&&(t=n(20)),t}(),transformRequest:[function(t,e){return o(e,"Accept"),o(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(s(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"===typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(t){a.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){a.headers[t]=r.merge(i)})),t.exports=a}).call(this,n(19))},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var l,u=[],c=!1,p=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):p=-1,u.length&&d())}function d(){if(!c){var t=a(h);c=!0;for(var e=u.length;e;){for(l=u,u=[];++p<e;)l&&l[p].run();p=-1,e=u.length}l=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||c||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";var r=n(3),o=n(49),i=n(16),s=n(51),a=n(54),l=n(55),u=n(21);t.exports=function(t){return new Promise((function(e,c){var p=t.data,h=t.headers;r.isFormData(p)&&delete h["Content-Type"];var d=new XMLHttpRequest;if(t.auth){var f=t.auth.username||"",g=t.auth.password||"";h.Authorization="Basic "+btoa(f+":"+g)}var m=s(t.baseURL,t.url);if(d.open(t.method.toUpperCase(),i(m,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?a(d.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:n,config:t,request:d};o(e,c,r),d=null}},d.onabort=function(){d&&(c(u("Request aborted",t,"ECONNABORTED",d)),d=null)},d.onerror=function(){c(u("Network Error",t,null,d)),d=null},d.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),c(u(e,t,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var y=n(56),v=(t.withCredentials||l(m))&&t.xsrfCookieName?y.read(t.xsrfCookieName):void 0;v&&(h[t.xsrfHeaderName]=v)}if("setRequestHeader"in d&&r.forEach(h,(function(t,e){"undefined"===typeof p&&"content-type"===e.toLowerCase()?delete h[e]:d.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),t.responseType)try{d.responseType=t.responseType}catch(_){if("json"!==t.responseType)throw _}"function"===typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){d&&(d.abort(),c(t),d=null)})),void 0===p&&(p=null),d.send(p)}))}},function(t,e,n){"use strict";var r=n(50);t.exports=function(t,e,n,o,i){var s=new Error(t);return r(s,e,n,o,i)}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e){e=e||{};var n={},o=["url","method","params","data"],i=["headers","auth","proxy"],s=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(o,(function(t){"undefined"!==typeof e[t]&&(n[t]=e[t])})),r.forEach(i,(function(o){r.isObject(e[o])?n[o]=r.deepMerge(t[o],e[o]):"undefined"!==typeof e[o]?n[o]=e[o]:r.isObject(t[o])?n[o]=r.deepMerge(t[o]):"undefined"!==typeof t[o]&&(n[o]=t[o])})),r.forEach(s,(function(r){"undefined"!==typeof e[r]?n[r]=e[r]:"undefined"!==typeof t[r]&&(n[r]=t[r])}));var a=o.concat(i).concat(s),l=Object.keys(e).filter((function(t){return-1===a.indexOf(t)}));return r.forEach(l,(function(r){"undefined"!==typeof e[r]?n[r]=e[r]:"undefined"!==typeof t[r]&&(n[r]=t[r])})),n}},function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReactLegacy=void 0;var u=n(1),c=l(n(67)),p=a(n(0)),h=n(70),d=n(29),f=n(30),g=n(31),m=function(t){function e(e){var n=t.call(this,e)||this;return n.props=e,n.api=null,n.destroyed=!1,n.SYNCHRONOUS_CHANGE_PROPERTIES=["context"],n.portalManager=new f.LegacyPortalManager(n,e.componentWrappingElement,e.maxComponentCreationTimeMs),n}return r(e,t),e.prototype.render=function(){var t=this;return p.default.createElement("div",{style:this.createStyleForDiv(),className:this.props.className,ref:function(e){t.eGridDiv=e}},this.portalManager.getPortals())},e.prototype.createStyleForDiv=function(){return o({height:"100%"},this.props.containerStyle||{})},e.prototype.componentDidMount=function(){var t=this.props.modules||[],e={providedBeanInstances:{agGridReact:this,frameworkComponentWrapper:new v(this,this.portalManager)},modules:t,frameworkOverrides:new g.ReactFrameworkOverrides(!1)},n=this.props.gridOptions||{};this.gridOptions=u.ComponentUtil.copyAttributesToGridOptions(n,this.props),this.checkForDeprecations(this.props),new u.Grid(this.eGridDiv,this.gridOptions,e),this.api=this.gridOptions.api,this.columnApi=this.gridOptions.columnApi,this.props.setGridApi(this.api,this.columnApi)},e.prototype.checkForDeprecations=function(t){t.rowDataChangeDetectionStrategy&&u._.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")},e.prototype.shouldComponentUpdate=function(t){return this.processPropsChanges(this.props,t),!1},e.prototype.componentDidUpdate=function(t){this.processPropsChanges(t,this.props)},e.prototype.processPropsChanges=function(t,e){var n={};this.extractGridPropertyChanges(t,e,n),this.processSynchronousChanges(n),this.processAsynchronousChanges(n)},e.prototype.extractGridPropertyChanges=function(t,e,n){var r=!!e.debug;Object.keys(e).forEach((function(o){u.ComponentUtil.ALL_PROPERTIES_SET.has(o)&&t[o]!==e[o]&&(r&&console.log("agGridReact: ["+o+"] property changed"),n[o]={previousValue:t[o],currentValue:e[o]})})),u.ComponentUtil.EVENT_CALLBACKS.forEach((function(o){t[o]!==e[o]&&(r&&console.log("agGridReact: ["+o+"] event callback changed"),n[o]={previousValue:t[o],currentValue:e[o]})}))},e.prototype.componentWillUnmount=function(){this.api&&(this.api.destroy(),this.api=null),this.destroyed=!0,this.portalManager.destroy()},e.prototype.isDisableStaticMarkup=function(){return!0===this.props.disableStaticMarkup},e.prototype.isLegacyComponentRendering=function(){return!0===this.props.legacyComponentRendering},e.prototype.processSynchronousChanges=function(t){var e=o({},t);if(Object.keys(e).length>0){var n={};this.SYNCHRONOUS_CHANGE_PROPERTIES.forEach((function(t){e[t]&&(n[t]=e[t],delete e[t])})),Object.keys(n).length>0&&this.api&&u.ComponentUtil.processOnChange(n,this.api)}return e},e.prototype.processAsynchronousChanges=function(t){var e=this;Object.keys(t).length>0&&window.setTimeout((function(){e.api&&u.ComponentUtil.processOnChange(t,e.api)}))},e.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,e.defaultProps={legacyComponentRendering:!1,disableStaticMarkup:!1,maxComponentCreationTimeMs:e.MAX_COMPONENT_CREATION_TIME_IN_MS},e}(p.Component);function y(t,e){t.forEach((function(t){m[t]=e}))}e.AgGridReactLegacy=m,m.propTypes={gridOptions:c.default.object},y(u.ComponentUtil.EVENT_CALLBACKS,c.default.func),y(u.ComponentUtil.BOOLEAN_PROPERTIES,c.default.bool),y(u.ComponentUtil.STRING_PROPERTIES,c.default.string),y(u.ComponentUtil.OBJECT_PROPERTIES,c.default.object),y(u.ComponentUtil.ARRAY_PROPERTIES,c.default.array),y(u.ComponentUtil.NUMBER_PROPERTIES,c.default.number),y(u.ComponentUtil.FUNCTION_PROPERTIES,c.default.func);var v=function(t){function e(e,n){var r=t.call(this)||this;return r.agGridReact=e,r.portalManager=n,r}return r(e,t),e.prototype.createWrapper=function(t,e){return this.agGridReact.isLegacyComponentRendering()?new h.LegacyReactComponent(t,this.agGridReact,this.portalManager,e):new d.NewReactComponent(t,this.portalManager,e)},e}(u.BaseComponentWrapper)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ReactComponent=void 0;var o=function(t){function e(e,n,r){var o=t.call(this)||this;return o.portal=null,o.reactComponent=e,o.portalManager=n,o.componentType=r,o.statelessComponent=o.isStateless(o.reactComponent),o}return r(e,t),e.prototype.getGui=function(){return this.eParentElement},e.prototype.destroy=function(){return this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy(),this.portalManager.destroyPortal(this.portal)},e.prototype.createParentElement=function(t){var e=this.portalManager.getComponentWrappingElement(),n=document.createElement(e||"div");return n.classList.add("ag-react-container"),t.reactContainer=n,n},e.prototype.addParentContainerStyleAndClasses=function(){var t=this;this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle()),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses()&&this.componentInstance.getReactContainerClasses().forEach((function(e){return t.eParentElement.classList.add(e)})))},e.prototype.statelessComponentRendered=function(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0},e.prototype.getFrameworkComponentInstance=function(){return this.componentInstance},e.prototype.isStatelessComponent=function(){return this.statelessComponent},e.prototype.getReactComponentName=function(){return this.reactComponent.name},e.prototype.getMemoType=function(){return this.hasSymbol()?Symbol.for("react.memo"):60115},e.prototype.hasSymbol=function(){return"function"===typeof Symbol&&Symbol.for},e.prototype.isStateless=function(t){return"function"===typeof t&&!(t.prototype&&t.prototype.isReactComponent)||"object"===typeof t&&t.$$typeof===this.getMemoType()},e.prototype.hasMethod=function(t){var e=this.getFrameworkComponentInstance();return!!e&&null!==e[t]||this.fallbackMethodAvailable(t)},e.prototype.callMethod=function(t,e){var n=this,r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(t,e&&e[0]?e[0]:{});if(r){var o=r[t];return o?o.apply(r,e):this.fallbackMethodAvailable(t)?this.fallbackMethod(t,e&&e[0]?e[0]:{}):void 0}setTimeout((function(){return n.callMethod(t,e)}))},e.prototype.addMethod=function(t,e){this[t]=e},e}((function(){}));e.ReactComponent=o},function(t,e,n){"use strict";t.exports=n(71)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0;e.default=function(){return"agPortalKey_"+ ++r}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.NewReactComponent=void 0;var s=n(0),a=n(7),l=n(1),u=n(26),c=n(27),p=i(n(28)),h=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.oldPortal=null,o.key=p.default(),o.portalKey=p.default(),o}return r(e,t),e.prototype.init=function(t){var e=this;return this.eParentElement=this.createParentElement(t),this.params=t,this.createOrUpdatePortal(t),new l.AgPromise((function(t){return e.createReactComponent(t)}))},e.prototype.createOrUpdatePortal=function(t){var e=this;this.isStatelessComponent()||(t.ref=function(t){e.componentInstance=t,e.addParentContainerStyleAndClasses()}),this.reactElement=s.createElement(this.reactComponent,o(o({},t),{key:this.key})),this.portal=a.createPortal(this.reactElement,this.eParentElement,this.portalKey)},e.prototype.createReactComponent=function(t){this.portalManager.mountReactPortal(this.portal,this,(function(e){t(e)}))},e.prototype.isNullValue=function(){return this.valueRenderedIsNull(this.params)},e.prototype.rendered=function(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())},e.prototype.valueRenderedIsNull=function(t){if(!this.componentType.cellRenderer)return!1;var e=console.error;try{return console.error=function(){},""===c.renderToStaticMarkup(s.createElement(this.reactComponent,t))}catch(n){}finally{console.error=e}return!1},e.prototype.refreshComponent=function(t){this.oldPortal=this.portal,this.createOrUpdatePortal(t),this.portalManager.updateReactPortal(this.oldPortal,this.portal)},e.prototype.fallbackMethod=function(t,e){var n=this[t+"Component"];if(n)return n.bind(this)(e)},e.prototype.fallbackMethodAvailable=function(t){return!!this[t+"Component"]},e}(u.ReactComponent);e.NewReactComponent=h},function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.PortalManager=e.LegacyPortalManager=void 0;var o=function(){function t(e,n,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=n||"div",this.parent=e,this.maxComponentCreationTimeMs=r||t.MAX_COMPONENT_CREATION_TIME_IN_MS}return t.prototype.getPortals=function(){return this.portals},t.prototype.destroy=function(){this.destroyed=!0},t.prototype.destroyPortal=function(t){this.portals=this.portals.filter((function(e){return e!==t})),this.batchUpdate()},t.prototype.getComponentWrappingElement=function(){return this.wrappingElement},t.prototype.mountReactPortal=function(t,e,n){this.portals=r(r([],this.portals),[t]),this.waitForInstance(e,n),this.batchUpdate()},t.prototype.updateReactPortal=function(t,e){this.portals[this.portals.indexOf(t)]=e,this.batchUpdate()},t.prototype.batchUpdate=function(){var t=this;this.hasPendingPortalUpdate||(setTimeout((function(){t.destroyed||t.parent.forceUpdate((function(){t.hasPendingPortalUpdate=!1}))})),this.hasPendingPortalUpdate=!0)},t.prototype.waitForInstance=function(t,e,n){var r=this;if(void 0===n&&(n=Date.now()),this.destroyed)e(null);else if(t.rendered())e(t);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return t.isNullValue()?void e(t):void console.error("AG Grid: React Component '"+t.getReactComponentName()+"' not created within "+this.maxComponentCreationTimeMs+"ms");window.setTimeout((function(){r.waitForInstance(t,e,n)}))}},t.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,t}();e.LegacyPortalManager=o;var i=function(){function t(e,n,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=n||"div",this.refresher=e,this.maxComponentCreationTimeMs=r||t.MAX_COMPONENT_CREATION_TIME_IN_MS}return t.prototype.getPortals=function(){return this.portals},t.prototype.destroy=function(){this.destroyed=!0},t.prototype.destroyPortal=function(t){this.portals=this.portals.filter((function(e){return e!==t})),this.batchUpdate()},t.prototype.getComponentWrappingElement=function(){return this.wrappingElement},t.prototype.mountReactPortal=function(t,e,n){this.portals=r(r([],this.portals),[t]),this.waitForInstance(e,n),this.batchUpdate()},t.prototype.updateReactPortal=function(t,e){this.portals[this.portals.indexOf(t)]=e,this.batchUpdate()},t.prototype.batchUpdate=function(){var t=this;this.hasPendingPortalUpdate||(setTimeout((function(){t.destroyed||(t.refresher(),t.hasPendingPortalUpdate=!1)})),this.hasPendingPortalUpdate=!0)},t.prototype.waitForInstance=function(t,e,n){var r=this;if(void 0===n&&(n=Date.now()),this.destroyed)e(null);else if(t.rendered())e(t);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return t.isNullValue()?void e(t):void console.error("AG Grid: React Component '"+t.getReactComponentName()+"' not created within "+this.maxComponentCreationTimeMs+"ms");window.setTimeout((function(){r.waitForInstance(t,e,n)}))}},t.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,t}();e.PortalManager=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ReactFrameworkOverrides=void 0;var i=n(1),s=o(n(72)),a=o(n(73)),l=function(t){function e(e){var n=t.call(this)||this;return n.frameworkComponents={agGroupCellRenderer:s.default,agGroupRowRenderer:s.default,agDetailCellRenderer:a.default},n.reactUi=e,n.renderingEngine=e?"react":"vanilla",n}return r(e,t),e.prototype.frameworkComponent=function(t){if(this.reactUi)return this.frameworkComponents[t]},e.prototype.isFrameworkComponent=function(t){if(!t)return!1;var e=t.prototype;return!(e&&"getGui"in e)},e}(i.VanillaFrameworkOverrides);e.ReactFrameworkOverrides=l},function(t,e,n){},function(t,e,n){},,,,,function(t,e,n){"use strict";var r=n(10),o="function"===typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,s=o?Symbol.for("react.portal"):60106,a=o?Symbol.for("react.fragment"):60107,l=o?Symbol.for("react.strict_mode"):60108,u=o?Symbol.for("react.profiler"):60114,c=o?Symbol.for("react.provider"):60109,p=o?Symbol.for("react.context"):60110,h=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,f=o?Symbol.for("react.memo"):60115,g=o?Symbol.for("react.lazy"):60116,m="function"===typeof Symbol&&Symbol.iterator;function y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function w(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||v}function C(){}function b(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||v}w.prototype.isReactComponent={},w.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(y(85));this.updater.enqueueSetState(this,t,e,"setState")},w.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},C.prototype=w.prototype;var x=b.prototype=new C;x.constructor=b,r(x,w.prototype),x.isPureReactComponent=!0;var E={current:null},S=Object.prototype.hasOwnProperty,T={key:!0,ref:!0,__self:!0,__source:!0};function R(t,e,n){var r,o={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)S.call(e,r)&&!T.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:i,type:t,key:s,ref:a,props:o,_owner:E.current}}function P(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var O=/\/+/g,I=[];function A(t,e,n,r){if(I.length){var o=I.pop();return o.result=t,o.keyPrefix=e,o.func=n,o.context=r,o.count=0,o}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function D(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>I.length&&I.push(t)}function M(t,e,n){return null==t?0:function t(e,n,r,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case s:l=!0}}if(l)return r(o,e,""===n?"."+L(e,0):n),1;if(l=0,n=""===n?".":n+":",Array.isArray(e))for(var u=0;u<e.length;u++){var c=n+L(a=e[u],u);l+=t(a,c,r,o)}else if(null===e||"object"!==typeof e?c=null:c="function"===typeof(c=m&&e[m]||e["@@iterator"])?c:null,"function"===typeof c)for(e=c.call(e),u=0;!(a=e.next()).done;)l+=t(a=a.value,c=n+L(a,u++),r,o);else if("object"===a)throw r=""+e,Error(y(31,"[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return l}(t,"",e,n)}function L(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function N(t,e){t.func.call(t.context,e,t.count++)}function F(t,e,n){var r=t.result,o=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?k(t,r,n,(function(t){return t})):null!=t&&(P(t)&&(t=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,o+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(O,"$&/")+"/")+n)),r.push(t))}function k(t,e,n,r,o){var i="";null!=n&&(i=(""+n).replace(O,"$&/")+"/"),M(t,F,e=A(e,i,r,o)),D(e)}var G={current:null};function B(){var t=G.current;if(null===t)throw Error(y(321));return t}var V={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:function(t,e,n){if(null==t)return t;var r=[];return k(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;M(t,N,e=A(null,null,e,n)),D(e)},count:function(t){return M(t,(function(){return null}),null)},toArray:function(t){var e=[];return k(t,e,null,(function(t){return t})),e},only:function(t){if(!P(t))throw Error(y(143));return t}},e.Component=w,e.Fragment=a,e.Profiler=u,e.PureComponent=b,e.StrictMode=l,e.Suspense=d,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(y(267,t));var o=r({},t.props),s=t.key,a=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,l=E.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)S.call(e,c)&&!T.hasOwnProperty(c)&&(o[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){u=Array(c);for(var p=0;p<c;p++)u[p]=arguments[p+2];o.children=u}return{$$typeof:i,type:t.type,key:s,ref:a,props:o,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:p,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},e.createElement=R,e.createFactory=function(t){var e=R.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:h,render:t}},e.isValidElement=P,e.lazy=function(t){return{$$typeof:g,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:f,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return B().useCallback(t,e)},e.useContext=function(t,e){return B().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return B().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return B().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return B().useLayoutEffect(t,e)},e.useMemo=function(t,e){return B().useMemo(t,e)},e.useReducer=function(t,e,n){return B().useReducer(t,e,n)},e.useRef=function(t){return B().useRef(t)},e.useState=function(t){return B().useState(t)},e.version="16.14.0"},function(t,e,n){"use strict";var r=n(0),o=n(10),i=n(40);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));function a(t,e,n,r,o,i,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var l=!1,u=null,c=!1,p=null,h={onError:function(t){l=!0,u=t}};function d(t,e,n,r,o,i,s,c,p){l=!1,u=null,a.apply(h,arguments)}var f=null,g=null,m=null;function y(t,e,n){var r=t.type||"unknown-event";t.currentTarget=m(n),function(t,e,n,r,o,i,a,h,f){if(d.apply(this,arguments),l){if(!l)throw Error(s(198));var g=u;l=!1,u=null,c||(c=!0,p=g)}}(r,e,void 0,t),t.currentTarget=null}var v=null,_={};function w(){if(v)for(var t in _){var e=_[t],n=v.indexOf(t);if(!(-1<n))throw Error(s(96,t));if(!b[n]){if(!e.extractEvents)throw Error(s(97,t));for(var r in b[n]=e,n=e.eventTypes){var o=void 0,i=n[r],a=e,l=r;if(x.hasOwnProperty(l))throw Error(s(99,l));x[l]=i;var u=i.phasedRegistrationNames;if(u){for(o in u)u.hasOwnProperty(o)&&C(u[o],a,l);o=!0}else i.registrationName?(C(i.registrationName,a,l),o=!0):o=!1;if(!o)throw Error(s(98,r,t))}}}}function C(t,e,n){if(E[t])throw Error(s(100,t));E[t]=e,S[t]=e.eventTypes[n].dependencies}var b=[],x={},E={},S={};function T(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];if(!_.hasOwnProperty(e)||_[e]!==r){if(_[e])throw Error(s(102,e));_[e]=r,n=!0}}n&&w()}var R=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),P=null,O=null,I=null;function A(t){if(t=g(t)){if("function"!==typeof P)throw Error(s(280));var e=t.stateNode;e&&(e=f(e),P(t.stateNode,t.type,e))}}function D(t){O?I?I.push(t):I=[t]:O=t}function M(){if(O){var t=O,e=I;if(I=O=null,A(t),e)for(t=0;t<e.length;t++)A(e[t])}}function L(t,e){return t(e)}function N(t,e,n,r,o){return t(e,n,r,o)}function F(){}var k=L,G=!1,B=!1;function V(){null===O&&null===I||(F(),M())}function z(t,e,n){if(B)return t(e,n);B=!0;try{return k(t,e,n)}finally{B=!1,V()}}var j=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H=Object.prototype.hasOwnProperty,U={},W={};function q(t,e,n,r,o,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i}var X={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){X[t]=new q(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];X[e]=new q(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){X[t]=new q(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){X[t]=new q(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){X[t]=new q(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){X[t]=new q(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){X[t]=new q(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){X[t]=new q(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){X[t]=new q(t,5,!1,t.toLowerCase(),null,!1)}));var K=/[\-:]([a-z])/g;function Y(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(K,Y);X[e]=new q(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(K,Y);X[e]=new q(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(K,Y);X[e]=new q(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){X[t]=new q(t,1,!1,t.toLowerCase(),null,!1)})),X.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){X[t]=new q(t,1,!1,t.toLowerCase(),null,!0)}));var Z=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Q(t,e,n,r){var o=X.hasOwnProperty(e)?X[e]:null;(null!==o?0===o.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,o,r)&&(n=null),r||null===o?function(t){return!!H.call(W,t)||!H.call(U,t)&&(j.test(t)?W[t]=!0:(U[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=null===n?3!==o.type&&"":n:(e=o.attributeName,r=o.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}Z.hasOwnProperty("ReactCurrentDispatcher")||(Z.ReactCurrentDispatcher={current:null}),Z.hasOwnProperty("ReactCurrentBatchConfig")||(Z.ReactCurrentBatchConfig={suspense:null});var J=/^(.*)[\\\/]/,$="function"===typeof Symbol&&Symbol.for,tt=$?Symbol.for("react.element"):60103,et=$?Symbol.for("react.portal"):60106,nt=$?Symbol.for("react.fragment"):60107,rt=$?Symbol.for("react.strict_mode"):60108,ot=$?Symbol.for("react.profiler"):60114,it=$?Symbol.for("react.provider"):60109,st=$?Symbol.for("react.context"):60110,at=$?Symbol.for("react.concurrent_mode"):60111,lt=$?Symbol.for("react.forward_ref"):60112,ut=$?Symbol.for("react.suspense"):60113,ct=$?Symbol.for("react.suspense_list"):60120,pt=$?Symbol.for("react.memo"):60115,ht=$?Symbol.for("react.lazy"):60116,dt=$?Symbol.for("react.block"):60121,ft="function"===typeof Symbol&&Symbol.iterator;function gt(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=ft&&t[ft]||t["@@iterator"])?t:null}function mt(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case nt:return"Fragment";case et:return"Portal";case ot:return"Profiler";case rt:return"StrictMode";case ut:return"Suspense";case ct:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case st:return"Context.Consumer";case it:return"Context.Provider";case lt:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case pt:return mt(t.type);case dt:return mt(t.render);case ht:if(t=1===t._status?t._result:null)return mt(t)}return null}function yt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var r=t._debugOwner,o=t._debugSource,i=mt(t.type);n=null,r&&(n=mt(r.type)),r=i,i="",o?i=" (at "+o.fileName.replace(J,"")+":"+o.lineNumber+")":n&&(i=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+i}e+=n,t=t.return}while(t);return e}function vt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function _t(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function wt(t){t._valueTracker||(t._valueTracker=function(t){var e=_t(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(t){r=""+t,i.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Ct(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_t(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function bt(t,e){var n=e.checked;return o({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function xt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=vt(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Et(t,e){null!=(e=e.checked)&&Q(t,"checked",e,!1)}function St(t,e){Et(t,e);var n=vt(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?Rt(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rt(t,e.type,vt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Tt(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Rt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function Pt(t,e){return t=o({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Ot(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+vt(n),e=null,o=0;o<t.length;o++){if(t[o].value===n)return t[o].selected=!0,void(r&&(t[o].defaultSelected=!0));null!==e||t[o].disabled||(e=t[o])}null!==e&&(e.selected=!0)}}function It(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return o({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function At(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:vt(n)}}function Dt(t,e){var n=vt(e.value),r=vt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Mt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var Lt="http://www.w3.org/1999/xhtml",Nt="http://www.w3.org/2000/svg";function Ft(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Ft(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Gt,Bt=function(t){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction((function(){return t(e,n)}))}:t}((function(t,e){if(t.namespaceURI!==Nt||"innerHTML"in t)t.innerHTML=e;else{for((Gt=Gt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}));function Vt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function zt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var jt={animationend:zt("Animation","AnimationEnd"),animationiteration:zt("Animation","AnimationIteration"),animationstart:zt("Animation","AnimationStart"),transitionend:zt("Transition","TransitionEnd")},Ht={},Ut={};function Wt(t){if(Ht[t])return Ht[t];if(!jt[t])return t;var e,n=jt[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ut)return Ht[t]=n[e];return t}R&&(Ut=document.createElement("div").style,"AnimationEvent"in window||(delete jt.animationend.animation,delete jt.animationiteration.animation,delete jt.animationstart.animation),"TransitionEvent"in window||delete jt.transitionend.transition);var qt=Wt("animationend"),Xt=Wt("animationiteration"),Kt=Wt("animationstart"),Yt=Wt("transitionend"),Zt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qt=new("function"===typeof WeakMap?WeakMap:Map);function Jt(t){var e=Qt.get(t);return void 0===e&&(e=new Map,Qt.set(t,e)),e}function $t(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function te(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ee(t){if($t(t)!==t)throw Error(s(188))}function ne(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=$t(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return ee(o),t;if(i===r)return ee(o),e;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function re(t,e){if(null==e)throw Error(s(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function oe(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var ie=null;function se(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var r=0;r<e.length&&!t.isPropagationStopped();r++)y(t,e[r],n[r]);else e&&y(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function ae(t){if(null!==t&&(ie=re(ie,t)),t=ie,ie=null,t){if(oe(t,se),ie)throw Error(s(95));if(c)throw t=p,c=!1,p=null,t}}function le(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function ue(t){if(!R)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"===typeof e[t]),e}var ce=[];function pe(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>ce.length&&ce.push(t)}function he(t,e,n,r){if(ce.length){var o=ce.pop();return o.topLevelType=t,o.eventSystemFlags=r,o.nativeEvent=e,o.targetInst=n,o}return{topLevelType:t,eventSystemFlags:r,nativeEvent:e,targetInst:n,ancestors:[]}}function de(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=Rn(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var o=le(t.nativeEvent);r=t.topLevelType;var i=t.nativeEvent,s=t.eventSystemFlags;0===n&&(s|=64);for(var a=null,l=0;l<b.length;l++){var u=b[l];u&&(u=u.extractEvents(r,e,i,o,s))&&(a=re(a,u))}ae(a)}}function fe(t,e,n){if(!n.has(t)){switch(t){case"scroll":Ke(e,"scroll",!0);break;case"focus":case"blur":Ke(e,"focus",!0),Ke(e,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ue(t)&&Ke(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Zt.indexOf(t)&&Xe(t,e)}n.set(t,null)}}var ge,me,ye,ve=!1,_e=[],we=null,Ce=null,be=null,xe=new Map,Ee=new Map,Se=[],Te="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Re="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Pe(t,e,n,r,o){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:o,container:r}}function Oe(t,e){switch(t){case"focus":case"blur":we=null;break;case"dragenter":case"dragleave":Ce=null;break;case"mouseover":case"mouseout":be=null;break;case"pointerover":case"pointerout":xe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ee.delete(e.pointerId)}}function Ie(t,e,n,r,o,i){return null===t||t.nativeEvent!==i?(t=Pe(e,n,r,o,i),null!==e&&(null!==(e=Pn(e))&&me(e)),t):(t.eventSystemFlags|=r,t)}function Ae(t){var e=Rn(t.target);if(null!==e){var n=$t(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=te(n)))return t.blockedOn=e,void i.unstable_runWithPriority(t.priority,(function(){ye(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function De(t){if(null!==t.blockedOn)return!1;var e=Je(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(null!==e){var n=Pn(e);return null!==n&&me(n),t.blockedOn=e,!1}return!0}function Me(t,e,n){De(t)&&n.delete(e)}function Le(){for(ve=!1;0<_e.length;){var t=_e[0];if(null!==t.blockedOn){null!==(t=Pn(t.blockedOn))&&ge(t);break}var e=Je(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);null!==e?t.blockedOn=e:_e.shift()}null!==we&&De(we)&&(we=null),null!==Ce&&De(Ce)&&(Ce=null),null!==be&&De(be)&&(be=null),xe.forEach(Me),Ee.forEach(Me)}function Ne(t,e){t.blockedOn===e&&(t.blockedOn=null,ve||(ve=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Le)))}function Fe(t){function e(e){return Ne(e,t)}if(0<_e.length){Ne(_e[0],t);for(var n=1;n<_e.length;n++){var r=_e[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==we&&Ne(we,t),null!==Ce&&Ne(Ce,t),null!==be&&Ne(be,t),xe.forEach(e),Ee.forEach(e),n=0;n<Se.length;n++)(r=Se[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Se.length&&null===(n=Se[0]).blockedOn;)Ae(n),null===n.blockedOn&&Se.shift()}var ke={},Ge=new Map,Be=new Map,Ve=["abort","abort",qt,"animationEnd",Xt,"animationIteration",Kt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Yt,"transitionEnd","waiting","waiting"];function ze(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],o=t[n+1],i="on"+(o[0].toUpperCase()+o.slice(1));i={phasedRegistrationNames:{bubbled:i,captured:i+"Capture"},dependencies:[r],eventPriority:e},Be.set(r,e),Ge.set(r,i),ke[o]=i}}ze("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),ze("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),ze(Ve,2);for(var je="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),He=0;He<je.length;He++)Be.set(je[He],0);var Ue=i.unstable_UserBlockingPriority,We=i.unstable_runWithPriority,qe=!0;function Xe(t,e){Ke(e,t,!1)}function Ke(t,e,n){var r=Be.get(e);switch(void 0===r?2:r){case 0:r=Ye.bind(null,e,1,t);break;case 1:r=Ze.bind(null,e,1,t);break;default:r=Qe.bind(null,e,1,t)}n?t.addEventListener(e,r,!0):t.addEventListener(e,r,!1)}function Ye(t,e,n,r){G||F();var o=Qe,i=G;G=!0;try{N(o,t,e,n,r)}finally{(G=i)||V()}}function Ze(t,e,n,r){We(Ue,Qe.bind(null,t,e,n,r))}function Qe(t,e,n,r){if(qe)if(0<_e.length&&-1<Te.indexOf(t))t=Pe(null,t,e,n,r),_e.push(t);else{var o=Je(t,e,n,r);if(null===o)Oe(t,r);else if(-1<Te.indexOf(t))t=Pe(o,t,e,n,r),_e.push(t);else if(!function(t,e,n,r,o){switch(e){case"focus":return we=Ie(we,t,e,n,r,o),!0;case"dragenter":return Ce=Ie(Ce,t,e,n,r,o),!0;case"mouseover":return be=Ie(be,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return xe.set(i,Ie(xe.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ee.set(i,Ie(Ee.get(i)||null,t,e,n,r,o)),!0}return!1}(o,t,e,n,r)){Oe(t,r),t=he(t,r,null,e);try{z(de,t)}finally{pe(t)}}}}function Je(t,e,n,r){if(null!==(n=Rn(n=le(r)))){var o=$t(n);if(null===o)n=null;else{var i=o.tag;if(13===i){if(null!==(n=te(o)))return n;n=null}else if(3===i){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null)}}t=he(t,r,n,e);try{z(de,t)}finally{pe(t)}return null}var $e={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];function en(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||$e.hasOwnProperty(t)&&$e[t]?(""+e).trim():e+"px"}function nn(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=en(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}Object.keys($e).forEach((function(t){tn.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$e[e]=$e[t]}))}));var rn=o({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function on(t,e){if(e){if(rn[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62,""))}}function sn(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var an=Lt;function ln(t,e){var n=Jt(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=S[e];for(var r=0;r<e.length;r++)fe(e[r],t,n)}function un(){}function cn(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function pn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hn(t,e){var n,r=pn(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=pn(r)}}function dn(){for(var t=window,e=cn();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=cn((t=e.contentWindow).document)}return e}function fn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var gn=null,mn=null;function yn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function vn(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var _n="function"===typeof setTimeout?setTimeout:void 0,wn="function"===typeof clearTimeout?clearTimeout:void 0;function Cn(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function bn(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var xn=Math.random().toString(36).slice(2),En="__reactInternalInstance$"+xn,Sn="__reactEventHandlers$"+xn,Tn="__reactContainere$"+xn;function Rn(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Tn]||n[En]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=bn(t);null!==t;){if(n=t[En])return n;t=bn(t)}return e}n=(t=n).parentNode}return null}function Pn(t){return!(t=t[En]||t[Tn])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function On(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function In(t){return t[Sn]||null}function An(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function Dn(t,e){var n=t.stateNode;if(!n)return null;var r=f(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(s(231,e,typeof n));return n}function Mn(t,e,n){(e=Dn(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Ln(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=An(e);for(e=n.length;0<e--;)Mn(n[e],"captured",t);for(e=0;e<n.length;e++)Mn(n[e],"bubbled",t)}}function Nn(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=Dn(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Fn(t){t&&t.dispatchConfig.registrationName&&Nn(t._targetInst,null,t)}function kn(t){oe(t,Ln)}var Gn=null,Bn=null,Vn=null;function zn(){if(Vn)return Vn;var t,e,n=Bn,r=n.length,o="value"in Gn?Gn.value:Gn.textContent,i=o.length;for(t=0;t<r&&n[t]===o[t];t++);var s=r-t;for(e=1;e<=s&&n[r-e]===o[i-e];e++);return Vn=o.slice(t,1<e?1-e:void 0)}function jn(){return!0}function Hn(){return!1}function Un(t,e,n,r){for(var o in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(o)&&((e=t[o])?this[o]=e(n):"target"===o?this.target=r:this[o]=n[o]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?jn:Hn,this.isPropagationStopped=Hn,this}function Wn(t,e,n,r){if(this.eventPool.length){var o=this.eventPool.pop();return this.call(o,t,e,n,r),o}return new this(t,e,n,r)}function qn(t){if(!(t instanceof this))throw Error(s(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function Xn(t){t.eventPool=[],t.getPooled=Wn,t.release=qn}o(Un.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=jn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=jn)},persist:function(){this.isPersistent=jn},isPersistent:Hn,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Hn,this._dispatchInstances=this._dispatchListeners=null}}),Un.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Un.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var i=new e;return o(i,n.prototype),n.prototype=i,n.prototype.constructor=n,n.Interface=o({},r.Interface,t),n.extend=r.extend,Xn(n),n},Xn(Un);var Kn=Un.extend({data:null}),Yn=Un.extend({data:null}),Zn=[9,13,27,32],Qn=R&&"CompositionEvent"in window,Jn=null;R&&"documentMode"in document&&(Jn=document.documentMode);var $n=R&&"TextEvent"in window&&!Jn,tr=R&&(!Qn||Jn&&8<Jn&&11>=Jn),er=String.fromCharCode(32),nr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},rr=!1;function or(t,e){switch(t){case"keyup":return-1!==Zn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function ir(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var sr=!1;var ar={eventTypes:nr,extractEvents:function(t,e,n,r){var o;if(Qn)t:{switch(t){case"compositionstart":var i=nr.compositionStart;break t;case"compositionend":i=nr.compositionEnd;break t;case"compositionupdate":i=nr.compositionUpdate;break t}i=void 0}else sr?or(t,n)&&(i=nr.compositionEnd):"keydown"===t&&229===n.keyCode&&(i=nr.compositionStart);return i?(tr&&"ko"!==n.locale&&(sr||i!==nr.compositionStart?i===nr.compositionEnd&&sr&&(o=zn()):(Bn="value"in(Gn=r)?Gn.value:Gn.textContent,sr=!0)),i=Kn.getPooled(i,e,n,r),o?i.data=o:null!==(o=ir(n))&&(i.data=o),kn(i),o=i):o=null,(t=$n?function(t,e){switch(t){case"compositionend":return ir(e);case"keypress":return 32!==e.which?null:(rr=!0,er);case"textInput":return(t=e.data)===er&&rr?null:t;default:return null}}(t,n):function(t,e){if(sr)return"compositionend"===t||!Qn&&or(t,e)?(t=zn(),Vn=Bn=Gn=null,sr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tr&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=Yn.getPooled(nr.beforeInput,e,n,r)).data=t,kn(e)):e=null,null===o?e:null===e?o:[o,e]}},lr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ur(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!lr[t.type]:"textarea"===e}var cr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function pr(t,e,n){return(t=Un.getPooled(cr.change,t,e,n)).type="change",D(n),kn(t),t}var hr=null,dr=null;function fr(t){ae(t)}function gr(t){if(Ct(On(t)))return t}function mr(t,e){if("change"===t)return e}var yr=!1;function vr(){hr&&(hr.detachEvent("onpropertychange",_r),dr=hr=null)}function _r(t){if("value"===t.propertyName&&gr(dr))if(t=pr(dr,t,le(t)),G)ae(t);else{G=!0;try{L(fr,t)}finally{G=!1,V()}}}function wr(t,e,n){"focus"===t?(vr(),dr=n,(hr=e).attachEvent("onpropertychange",_r)):"blur"===t&&vr()}function Cr(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return gr(dr)}function br(t,e){if("click"===t)return gr(e)}function xr(t,e){if("input"===t||"change"===t)return gr(e)}R&&(yr=ue("input")&&(!document.documentMode||9<document.documentMode));var Er={eventTypes:cr,_isInputEventSupported:yr,extractEvents:function(t,e,n,r){var o=e?On(e):window,i=o.nodeName&&o.nodeName.toLowerCase();if("select"===i||"input"===i&&"file"===o.type)var s=mr;else if(ur(o))if(yr)s=xr;else{s=Cr;var a=wr}else(i=o.nodeName)&&"input"===i.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(s=br);if(s&&(s=s(t,e)))return pr(s,n,r);a&&a(t,o,e),"blur"===t&&(t=o._wrapperState)&&t.controlled&&"number"===o.type&&Rt(o,"number",o.value)}},Sr=Un.extend({view:null,detail:null}),Tr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rr(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Tr[t])&&!!e[t]}function Pr(){return Rr}var Or=0,Ir=0,Ar=!1,Dr=!1,Mr=Sr.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Pr,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Or;return Or=t.screenX,Ar?"mousemove"===t.type?t.screenX-e:0:(Ar=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=Ir;return Ir=t.screenY,Dr?"mousemove"===t.type?t.screenY-e:0:(Dr=!0,0)}}),Lr=Mr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Nr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Fr={eventTypes:Nr,extractEvents:function(t,e,n,r,o){var i="mouseover"===t||"pointerover"===t,s="mouseout"===t||"pointerout"===t;if(i&&0===(32&o)&&(n.relatedTarget||n.fromElement)||!s&&!i)return null;(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,s)?(s=e,null!==(e=(e=n.relatedTarget||n.toElement)?Rn(e):null)&&(e!==$t(e)||5!==e.tag&&6!==e.tag)&&(e=null)):s=null;if(s===e)return null;if("mouseout"===t||"mouseover"===t)var a=Mr,l=Nr.mouseLeave,u=Nr.mouseEnter,c="mouse";else"pointerout"!==t&&"pointerover"!==t||(a=Lr,l=Nr.pointerLeave,u=Nr.pointerEnter,c="pointer");if(t=null==s?i:On(s),i=null==e?i:On(e),(l=a.getPooled(l,s,n,r)).type=c+"leave",l.target=t,l.relatedTarget=i,(n=a.getPooled(u,e,n,r)).type=c+"enter",n.target=i,n.relatedTarget=t,c=e,(r=s)&&c)t:{for(u=c,s=0,t=a=r;t;t=An(t))s++;for(t=0,e=u;e;e=An(e))t++;for(;0<s-t;)a=An(a),s--;for(;0<t-s;)u=An(u),t--;for(;s--;){if(a===u||a===u.alternate)break t;a=An(a),u=An(u)}a=null}else a=null;for(u=a,a=[];r&&r!==u&&(null===(s=r.alternate)||s!==u);)a.push(r),r=An(r);for(r=[];c&&c!==u&&(null===(s=c.alternate)||s!==u);)r.push(c),c=An(c);for(c=0;c<a.length;c++)Nn(a[c],"bubbled",l);for(c=r.length;0<c--;)Nn(r[c],"captured",n);return 0===(64&o)?[l]:[l,n]}};var kr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},Gr=Object.prototype.hasOwnProperty;function Br(t,e){if(kr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Gr.call(e,n[r])||!kr(t[n[r]],e[n[r]]))return!1;return!0}var Vr=R&&"documentMode"in document&&11>=document.documentMode,zr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},jr=null,Hr=null,Ur=null,Wr=!1;function qr(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Wr||null==jr||jr!==cn(n)?null:("selectionStart"in(n=jr)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Ur&&Br(Ur,n)?null:(Ur=n,(t=Un.getPooled(zr.select,Hr,t,e)).type="select",t.target=jr,kn(t),t))}var Xr={eventTypes:zr,extractEvents:function(t,e,n,r,o,i){if(!(i=!(o=i||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){t:{o=Jt(o),i=S.onSelect;for(var s=0;s<i.length;s++)if(!o.has(i[s])){o=!1;break t}o=!0}i=!o}if(i)return null;switch(o=e?On(e):window,t){case"focus":(ur(o)||"true"===o.contentEditable)&&(jr=o,Hr=e,Ur=null);break;case"blur":Ur=Hr=jr=null;break;case"mousedown":Wr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Wr=!1,qr(n,r);case"selectionchange":if(Vr)break;case"keydown":case"keyup":return qr(n,r)}return null}},Kr=Un.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Yr=Un.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Zr=Sr.extend({relatedTarget:null});function Qr(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var Jr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},to=Sr.extend({key:function(t){if(t.key){var e=Jr[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=Qr(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?$r[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Pr,charCode:function(t){return"keypress"===t.type?Qr(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Qr(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),eo=Mr.extend({dataTransfer:null}),no=Sr.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Pr}),ro=Un.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),oo=Mr.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),io={eventTypes:ke,extractEvents:function(t,e,n,r){var o=Ge.get(t);if(!o)return null;switch(t){case"keypress":if(0===Qr(n))return null;case"keydown":case"keyup":t=to;break;case"blur":case"focus":t=Zr;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Mr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=eo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=no;break;case qt:case Xt:case Kt:t=Kr;break;case Yt:t=ro;break;case"scroll":t=Sr;break;case"wheel":t=oo;break;case"copy":case"cut":case"paste":t=Yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Lr;break;default:t=Un}return kn(e=t.getPooled(o,e,n,r)),e}};if(v)throw Error(s(101));v=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w(),f=In,g=Pn,m=On,T({SimpleEventPlugin:io,EnterLeaveEventPlugin:Fr,ChangeEventPlugin:Er,SelectEventPlugin:Xr,BeforeInputEventPlugin:ar});var so=[],ao=-1;function lo(t){0>ao||(t.current=so[ao],so[ao]=null,ao--)}function uo(t,e){ao++,so[ao]=t.current,t.current=e}var co={},po={current:co},ho={current:!1},fo=co;function go(t,e){var n=t.type.contextTypes;if(!n)return co;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=e[o];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function mo(t){return null!==(t=t.childContextTypes)&&void 0!==t}function yo(){lo(ho),lo(po)}function vo(t,e,n){if(po.current!==co)throw Error(s(168));uo(po,e),uo(ho,n)}function _o(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,mt(e)||"Unknown",i));return o({},n,{},r)}function wo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||co,fo=po.current,uo(po,t),uo(ho,ho.current),!0}function Co(t,e,n){var r=t.stateNode;if(!r)throw Error(s(169));n?(t=_o(t,e,fo),r.__reactInternalMemoizedMergedChildContext=t,lo(ho),lo(po),uo(po,t)):lo(ho),uo(ho,n)}var bo=i.unstable_runWithPriority,xo=i.unstable_scheduleCallback,Eo=i.unstable_cancelCallback,So=i.unstable_requestPaint,To=i.unstable_now,Ro=i.unstable_getCurrentPriorityLevel,Po=i.unstable_ImmediatePriority,Oo=i.unstable_UserBlockingPriority,Io=i.unstable_NormalPriority,Ao=i.unstable_LowPriority,Do=i.unstable_IdlePriority,Mo={},Lo=i.unstable_shouldYield,No=void 0!==So?So:function(){},Fo=null,ko=null,Go=!1,Bo=To(),Vo=1e4>Bo?To:function(){return To()-Bo};function zo(){switch(Ro()){case Po:return 99;case Oo:return 98;case Io:return 97;case Ao:return 96;case Do:return 95;default:throw Error(s(332))}}function jo(t){switch(t){case 99:return Po;case 98:return Oo;case 97:return Io;case 96:return Ao;case 95:return Do;default:throw Error(s(332))}}function Ho(t,e){return t=jo(t),bo(t,e)}function Uo(t,e,n){return t=jo(t),xo(t,e,n)}function Wo(t){return null===Fo?(Fo=[t],ko=xo(Po,Xo)):Fo.push(t),Mo}function qo(){if(null!==ko){var t=ko;ko=null,Eo(t)}Xo()}function Xo(){if(!Go&&null!==Fo){Go=!0;var t=0;try{var e=Fo;Ho(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Fo=null}catch(n){throw null!==Fo&&(Fo=Fo.slice(t+1)),xo(Po,qo),n}finally{Go=!1}}}function Ko(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function Yo(t,e){if(t&&t.defaultProps)for(var n in e=o({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var Zo={current:null},Qo=null,Jo=null,$o=null;function ti(){$o=Jo=Qo=null}function ei(t){var e=Zo.current;lo(Zo),t.type._context._currentValue=e}function ni(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function ri(t,e){Qo=t,$o=Jo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(Is=!0),t.firstContext=null)}function oi(t,e){if($o!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||($o=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Jo){if(null===Qo)throw Error(s(308));Jo=e,Qo.dependencies={expirationTime:0,firstContext:e,responders:null}}else Jo=Jo.next=e;return t._currentValue}var ii=!1;function si(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function ai(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function li(t,e){return(t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null}).next=t}function ui(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function ci(t,e){var n=t.alternate;null!==n&&ai(n,t),null===(n=(t=t.updateQueue).baseQueue)?(t.baseQueue=e.next=e,e.next=e):(e.next=n.next,n.next=e)}function pi(t,e,n,r){var i=t.updateQueue;ii=!1;var s=i.baseQueue,a=i.shared.pending;if(null!==a){if(null!==s){var l=s.next;s.next=a.next,a.next=l}s=a,i.shared.pending=null,null!==(l=t.alternate)&&(null!==(l=l.updateQueue)&&(l.baseQueue=a))}if(null!==s){l=s.next;var u=i.baseState,c=0,p=null,h=null,d=null;if(null!==l)for(var f=l;;){if((a=f.expirationTime)<r){var g={expirationTime:f.expirationTime,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null};null===d?(h=d=g,p=u):d=d.next=g,a>c&&(c=a)}else{null!==d&&(d=d.next={expirationTime:1073741823,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null}),il(a,f.suspenseConfig);t:{var m=t,y=f;switch(a=e,g=n,y.tag){case 1:if("function"===typeof(m=y.payload)){u=m.call(g,u,a);break t}u=m;break t;case 3:m.effectTag=-4097&m.effectTag|64;case 0:if(null===(a="function"===typeof(m=y.payload)?m.call(g,u,a):m)||void 0===a)break t;u=o({},u,a);break t;case 2:ii=!0}}null!==f.callback&&(t.effectTag|=32,null===(a=i.effects)?i.effects=[f]:a.push(f))}if(null===(f=f.next)||f===l){if(null===(a=i.shared.pending))break;f=s.next=a.next,a.next=l,i.baseQueue=s=a,i.shared.pending=null}}null===d?p=u:d.next=h,i.baseState=p,i.baseQueue=d,sl(c),t.expirationTime=c,t.memoizedState=u}}function hi(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(null!==o){if(r.callback=null,r=o,o=n,"function"!==typeof r)throw Error(s(191,r));r.call(o)}}}var di=Z.ReactCurrentBatchConfig,fi=(new r.Component).refs;function gi(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:o({},e,n),t.memoizedState=n,0===t.expirationTime&&(t.updateQueue.baseState=n)}var mi={isMounted:function(t){return!!(t=t._reactInternalFiber)&&$t(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=qa(),o=di.suspense;(o=li(r=Xa(r,t,o),o)).payload=e,void 0!==n&&null!==n&&(o.callback=n),ui(t,o),Ka(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=qa(),o=di.suspense;(o=li(r=Xa(r,t,o),o)).tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),ui(t,o),Ka(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=qa(),r=di.suspense;(r=li(n=Xa(n,t,r),r)).tag=2,void 0!==e&&null!==e&&(r.callback=e),ui(t,r),Ka(t,n)}};function yi(t,e,n,r,o,i,s){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,i,s):!e.prototype||!e.prototype.isPureReactComponent||(!Br(n,r)||!Br(o,i))}function vi(t,e,n){var r=!1,o=co,i=e.contextType;return"object"===typeof i&&null!==i?i=oi(i):(o=mo(e)?fo:po.current,i=(r=null!==(r=e.contextTypes)&&void 0!==r)?go(t,o):co),e=new e(n,i),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=mi,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function _i(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&mi.enqueueReplaceState(e,e.state,null)}function wi(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs=fi,si(t);var i=e.contextType;"object"===typeof i&&null!==i?o.context=oi(i):(i=mo(e)?fo:po.current,o.context=go(t,i)),pi(t,n,o,r),o.state=t.memoizedState,"function"===typeof(i=e.getDerivedStateFromProps)&&(gi(t,e,i,n),o.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(e=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),e!==o.state&&mi.enqueueReplaceState(o,o.state,null),pi(t,n,o,r),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.effectTag|=4)}var Ci=Array.isArray;function bi(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,t));var o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:((e=function(t){var e=r.refs;e===fi&&(e=r.refs={}),null===t?delete e[o]:e[o]=t})._stringRef=o,e)}if("string"!==typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function xi(t,e){if("textarea"!==t.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Ei(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(t,e){return(t=Tl(t,e)).index=0,t.sibling=null,t}function i(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function a(e){return t&&null===e.alternate&&(e.effectTag=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=Ol(n,t.mode,r)).return=t,e):((e=o(e,n)).return=t,e)}function u(t,e,n,r){return null!==e&&e.elementType===n.type?((r=o(e,n.props)).ref=bi(t,e,n),r.return=t,r):((r=Rl(n.type,n.key,n.props,null,t.mode,r)).ref=bi(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Il(n,t.mode,r)).return=t,e):((e=o(e,n.children||[])).return=t,e)}function p(t,e,n,r,i){return null===e||7!==e.tag?((e=Pl(n,t.mode,r,i)).return=t,e):((e=o(e,n)).return=t,e)}function h(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=Ol(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case tt:return(n=Rl(e.type,e.key,e.props,null,t.mode,n)).ref=bi(t,null,e),n.return=t,n;case et:return(e=Il(e,t.mode,n)).return=t,e}if(Ci(e)||gt(e))return(e=Pl(e,t.mode,n,null)).return=t,e;xi(t,e)}return null}function d(t,e,n,r){var o=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==o?null:l(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case tt:return n.key===o?n.type===nt?p(t,e,n.props.children,r,o):u(t,e,n,r):null;case et:return n.key===o?c(t,e,n,r):null}if(Ci(n)||gt(n))return null!==o?null:p(t,e,n,r,null);xi(t,n)}return null}function f(t,e,n,r,o){if("string"===typeof r||"number"===typeof r)return l(e,t=t.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case tt:return t=t.get(null===r.key?n:r.key)||null,r.type===nt?p(e,t,r.props.children,o,r.key):u(e,t,r,o);case et:return c(e,t=t.get(null===r.key?n:r.key)||null,r,o)}if(Ci(r)||gt(r))return p(e,t=t.get(n)||null,r,o,null);xi(e,r)}return null}function g(o,s,a,l){for(var u=null,c=null,p=s,g=s=0,m=null;null!==p&&g<a.length;g++){p.index>g?(m=p,p=null):m=p.sibling;var y=d(o,p,a[g],l);if(null===y){null===p&&(p=m);break}t&&p&&null===y.alternate&&e(o,p),s=i(y,s,g),null===c?u=y:c.sibling=y,c=y,p=m}if(g===a.length)return n(o,p),u;if(null===p){for(;g<a.length;g++)null!==(p=h(o,a[g],l))&&(s=i(p,s,g),null===c?u=p:c.sibling=p,c=p);return u}for(p=r(o,p);g<a.length;g++)null!==(m=f(p,o,g,a[g],l))&&(t&&null!==m.alternate&&p.delete(null===m.key?g:m.key),s=i(m,s,g),null===c?u=m:c.sibling=m,c=m);return t&&p.forEach((function(t){return e(o,t)})),u}function m(o,a,l,u){var c=gt(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var p=c=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var _=d(o,g,v.value,u);if(null===_){null===g&&(g=y);break}t&&g&&null===_.alternate&&e(o,g),a=i(_,a,m),null===p?c=_:p.sibling=_,p=_,g=y}if(v.done)return n(o,g),c;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(o,v.value,u))&&(a=i(v,a,m),null===p?c=v:p.sibling=v,p=v);return c}for(g=r(o,g);!v.done;m++,v=l.next())null!==(v=f(g,o,m,v.value,u))&&(t&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=i(v,a,m),null===p?c=v:p.sibling=v,p=v);return t&&g.forEach((function(t){return e(o,t)})),c}return function(t,r,i,l){var u="object"===typeof i&&null!==i&&i.type===nt&&null===i.key;u&&(i=i.props.children);var c="object"===typeof i&&null!==i;if(c)switch(i.$$typeof){case tt:t:{for(c=i.key,u=r;null!==u;){if(u.key===c){switch(u.tag){case 7:if(i.type===nt){n(t,u.sibling),(r=o(u,i.props.children)).return=t,t=r;break t}break;default:if(u.elementType===i.type){n(t,u.sibling),(r=o(u,i.props)).ref=bi(t,u,i),r.return=t,t=r;break t}}n(t,u);break}e(t,u),u=u.sibling}i.type===nt?((r=Pl(i.props.children,t.mode,l,i.key)).return=t,t=r):((l=Rl(i.type,i.key,i.props,null,t.mode,l)).ref=bi(t,r,i),l.return=t,t=l)}return a(t);case et:t:{for(u=i.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(t,r.sibling),(r=o(r,i.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Il(i,t.mode,l)).return=t,t=r}return a(t)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(t,r.sibling),(r=o(r,i)).return=t,t=r):(n(t,r),(r=Ol(i,t.mode,l)).return=t,t=r),a(t);if(Ci(i))return g(t,r,i,l);if(gt(i))return m(t,r,i,l);if(c&&xi(t,i),"undefined"===typeof i&&!u)switch(t.tag){case 1:case 0:throw t=t.type,Error(s(152,t.displayName||t.name||"Component"))}return n(t,r)}}var Si=Ei(!0),Ti=Ei(!1),Ri={},Pi={current:Ri},Oi={current:Ri},Ii={current:Ri};function Ai(t){if(t===Ri)throw Error(s(174));return t}function Di(t,e){switch(uo(Ii,e),uo(Oi,t),uo(Pi,Ri),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kt(null,"");break;default:e=kt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}lo(Pi),uo(Pi,e)}function Mi(){lo(Pi),lo(Oi),lo(Ii)}function Li(t){Ai(Ii.current);var e=Ai(Pi.current),n=kt(e,t.type);e!==n&&(uo(Oi,t),uo(Pi,n))}function Ni(t){Oi.current===t&&(lo(Pi),lo(Oi))}var Fi={current:0};function ki(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Gi(t,e){return{responder:t,props:e}}var Bi=Z.ReactCurrentDispatcher,Vi=Z.ReactCurrentBatchConfig,zi=0,ji=null,Hi=null,Ui=null,Wi=!1;function qi(){throw Error(s(321))}function Xi(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!kr(t[n],e[n]))return!1;return!0}function Ki(t,e,n,r,o,i){if(zi=i,ji=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,Bi.current=null===t||null===t.memoizedState?ys:vs,t=n(r,o),e.expirationTime===zi){i=0;do{if(e.expirationTime=0,!(25>i))throw Error(s(301));i+=1,Ui=Hi=null,e.updateQueue=null,Bi.current=_s,t=n(r,o)}while(e.expirationTime===zi)}if(Bi.current=ms,e=null!==Hi&&null!==Hi.next,zi=0,Ui=Hi=ji=null,Wi=!1,e)throw Error(s(300));return t}function Yi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ui?ji.memoizedState=Ui=t:Ui=Ui.next=t,Ui}function Zi(){if(null===Hi){var t=ji.alternate;t=null!==t?t.memoizedState:null}else t=Hi.next;var e=null===Ui?ji.memoizedState:Ui.next;if(null!==e)Ui=e,Hi=t;else{if(null===t)throw Error(s(310));t={memoizedState:(Hi=t).memoizedState,baseState:Hi.baseState,baseQueue:Hi.baseQueue,queue:Hi.queue,next:null},null===Ui?ji.memoizedState=Ui=t:Ui=Ui.next=t}return Ui}function Qi(t,e){return"function"===typeof e?e(t):e}function Ji(t){var e=Zi(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var r=Hi,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(null!==o){o=o.next,r=r.baseState;var l=a=i=null,u=o;do{var c=u.expirationTime;if(c<zi){var p={expirationTime:u.expirationTime,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(a=l=p,i=r):l=l.next=p,c>ji.expirationTime&&(ji.expirationTime=c,sl(c))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),il(c,u.suspenseConfig),r=u.eagerReducer===t?u.eagerState:t(r,u.action);u=u.next}while(null!==u&&u!==o);null===l?i=r:l.next=a,kr(r,e.memoizedState)||(Is=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function $i(t){var e=Zi(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{i=t(i,a.action),a=a.next}while(a!==o);kr(i,e.memoizedState)||(Is=!0),e.memoizedState=i,null===e.baseQueue&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ts(t){var e=Yi();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:t}).dispatch=gs.bind(null,ji,t),[e.memoizedState,t]}function es(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=ji.updateQueue)?(e={lastEffect:null},ji.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function ns(){return Zi().memoizedState}function rs(t,e,n,r){var o=Yi();ji.effectTag|=t,o.memoizedState=es(1|e,n,void 0,void 0===r?null:r)}function os(t,e,n,r){var o=Zi();r=void 0===r?null:r;var i=void 0;if(null!==Hi){var s=Hi.memoizedState;if(i=s.destroy,null!==r&&Xi(r,s.deps))return void es(e,n,i,r)}ji.effectTag|=t,o.memoizedState=es(1|e,n,i,r)}function is(t,e){return rs(516,4,t,e)}function ss(t,e){return os(516,4,t,e)}function as(t,e){return os(4,2,t,e)}function ls(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function us(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,os(4,2,ls.bind(null,e,t),n)}function cs(){}function ps(t,e){return Yi().memoizedState=[t,void 0===e?null:e],t}function hs(t,e){var n=Zi();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Xi(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ds(t,e){var n=Zi();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Xi(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function fs(t,e,n){var r=zo();Ho(98>r?98:r,(function(){t(!0)})),Ho(97<r?97:r,(function(){var r=Vi.suspense;Vi.suspense=void 0===e?null:e;try{t(!1),n()}finally{Vi.suspense=r}}))}function gs(t,e,n){var r=qa(),o=di.suspense;o={expirationTime:r=Xa(r,t,o),suspenseConfig:o,action:n,eagerReducer:null,eagerState:null,next:null};var i=e.pending;if(null===i?o.next=o:(o.next=i.next,i.next=o),e.pending=o,i=t.alternate,t===ji||null!==i&&i===ji)Wi=!0,o.expirationTime=zi,ji.expirationTime=zi;else{if(0===t.expirationTime&&(null===i||0===i.expirationTime)&&null!==(i=e.lastRenderedReducer))try{var s=e.lastRenderedState,a=i(s,n);if(o.eagerReducer=i,o.eagerState=a,kr(a,s))return}catch(l){}Ka(t,r)}}var ms={readContext:oi,useCallback:qi,useContext:qi,useEffect:qi,useImperativeHandle:qi,useLayoutEffect:qi,useMemo:qi,useReducer:qi,useRef:qi,useState:qi,useDebugValue:qi,useResponder:qi,useDeferredValue:qi,useTransition:qi},ys={readContext:oi,useCallback:ps,useContext:oi,useEffect:is,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,rs(4,2,ls.bind(null,e,t),n)},useLayoutEffect:function(t,e){return rs(4,2,t,e)},useMemo:function(t,e){var n=Yi();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Yi();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=gs.bind(null,ji,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Yi().memoizedState=t},useState:ts,useDebugValue:cs,useResponder:Gi,useDeferredValue:function(t,e){var n=ts(t),r=n[0],o=n[1];return is((function(){var n=Vi.suspense;Vi.suspense=void 0===e?null:e;try{o(t)}finally{Vi.suspense=n}}),[t,e]),r},useTransition:function(t){var e=ts(!1),n=e[0];return e=e[1],[ps(fs.bind(null,e,t),[e,t]),n]}},vs={readContext:oi,useCallback:hs,useContext:oi,useEffect:ss,useImperativeHandle:us,useLayoutEffect:as,useMemo:ds,useReducer:Ji,useRef:ns,useState:function(){return Ji(Qi)},useDebugValue:cs,useResponder:Gi,useDeferredValue:function(t,e){var n=Ji(Qi),r=n[0],o=n[1];return ss((function(){var n=Vi.suspense;Vi.suspense=void 0===e?null:e;try{o(t)}finally{Vi.suspense=n}}),[t,e]),r},useTransition:function(t){var e=Ji(Qi),n=e[0];return e=e[1],[hs(fs.bind(null,e,t),[e,t]),n]}},_s={readContext:oi,useCallback:hs,useContext:oi,useEffect:ss,useImperativeHandle:us,useLayoutEffect:as,useMemo:ds,useReducer:$i,useRef:ns,useState:function(){return $i(Qi)},useDebugValue:cs,useResponder:Gi,useDeferredValue:function(t,e){var n=$i(Qi),r=n[0],o=n[1];return ss((function(){var n=Vi.suspense;Vi.suspense=void 0===e?null:e;try{o(t)}finally{Vi.suspense=n}}),[t,e]),r},useTransition:function(t){var e=$i(Qi),n=e[0];return e=e[1],[hs(fs.bind(null,e,t),[e,t]),n]}},ws=null,Cs=null,bs=!1;function xs(t,e){var n=El(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Es(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function Ss(t){if(bs){var e=Cs;if(e){var n=e;if(!Es(t,e)){if(!(e=Cn(n.nextSibling))||!Es(t,e))return t.effectTag=-1025&t.effectTag|2,bs=!1,void(ws=t);xs(ws,n)}ws=t,Cs=Cn(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,bs=!1,ws=t}}function Ts(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;ws=t}function Rs(t){if(t!==ws)return!1;if(!bs)return Ts(t),bs=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!vn(e,t.memoizedProps))for(e=Cs;e;)xs(t,e),e=Cn(e.nextSibling);if(Ts(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){Cs=Cn(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}Cs=null}}else Cs=ws?Cn(t.stateNode.nextSibling):null;return!0}function Ps(){Cs=ws=null,bs=!1}var Os=Z.ReactCurrentOwner,Is=!1;function As(t,e,n,r){e.child=null===t?Ti(e,null,n,r):Si(e,t.child,n,r)}function Ds(t,e,n,r,o){n=n.render;var i=e.ref;return ri(e,o),r=Ki(t,e,n,r,i,o),null===t||Is?(e.effectTag|=1,As(t,e,r,o),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=o&&(t.expirationTime=0),Ks(t,e,o))}function Ms(t,e,n,r,o,i){if(null===t){var s=n.type;return"function"!==typeof s||Sl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Rl(n.type,null,r,null,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,Ls(t,e,s,r,o,i))}return s=t.child,o<i&&(o=s.memoizedProps,(n=null!==(n=n.compare)?n:Br)(o,r)&&t.ref===e.ref)?Ks(t,e,i):(e.effectTag|=1,(t=Tl(s,r)).ref=e.ref,t.return=e,e.child=t)}function Ls(t,e,n,r,o,i){return null!==t&&Br(t.memoizedProps,r)&&t.ref===e.ref&&(Is=!1,o<i)?(e.expirationTime=t.expirationTime,Ks(t,e,i)):Fs(t,e,n,r,i)}function Ns(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Fs(t,e,n,r,o){var i=mo(n)?fo:po.current;return i=go(e,i),ri(e,o),n=Ki(t,e,n,r,i,o),null===t||Is?(e.effectTag|=1,As(t,e,n,o),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=o&&(t.expirationTime=0),Ks(t,e,o))}function ks(t,e,n,r,o){if(mo(n)){var i=!0;wo(e)}else i=!1;if(ri(e,o),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),vi(e,n,r),wi(e,n,r,o),r=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;"object"===typeof u&&null!==u?u=oi(u):u=go(e,u=mo(n)?fo:po.current);var c=n.getDerivedStateFromProps,p="function"===typeof c||"function"===typeof s.getSnapshotBeforeUpdate;p||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||l!==u)&&_i(e,s,r,u),ii=!1;var h=e.memoizedState;s.state=h,pi(e,r,s,o),l=e.memoizedState,a!==r||h!==l||ho.current||ii?("function"===typeof c&&(gi(e,n,c,r),l=e.memoizedState),(a=ii||yi(e,n,a,r,h,l,u))?(p||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(e.effectTag|=4)):("function"===typeof s.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):("function"===typeof s.componentDidMount&&(e.effectTag|=4),r=!1)}else s=e.stateNode,ai(t,e),a=e.memoizedProps,s.props=e.type===e.elementType?a:Yo(e.type,a),l=s.context,"object"===typeof(u=n.contextType)&&null!==u?u=oi(u):u=go(e,u=mo(n)?fo:po.current),(p="function"===typeof(c=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||l!==u)&&_i(e,s,r,u),ii=!1,l=e.memoizedState,s.state=l,pi(e,r,s,o),h=e.memoizedState,a!==r||l!==h||ho.current||ii?("function"===typeof c&&(gi(e,n,c,r),h=e.memoizedState),(c=ii||yi(e,n,a,r,l,h,u))?(p||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,h,u),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,h,u)),"function"===typeof s.componentDidUpdate&&(e.effectTag|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=h),s.props=r,s.state=h,s.context=u,r=c):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),r=!1);return Gs(t,e,n,r,i,o)}function Gs(t,e,n,r,o,i){Ns(t,e);var s=0!==(64&e.effectTag);if(!r&&!s)return o&&Co(e,n,!1),Ks(t,e,i);r=e.stateNode,Os.current=e;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&s?(e.child=Si(e,t.child,null,i),e.child=Si(e,null,a,i)):As(t,e,a,i),e.memoizedState=r.state,o&&Co(e,n,!0),e.child}function Bs(t){var e=t.stateNode;e.pendingContext?vo(0,e.pendingContext,e.pendingContext!==e.context):e.context&&vo(0,e.context,!1),Di(t,e.containerInfo)}var Vs,zs,js,Hs={dehydrated:null,retryTime:0};function Us(t,e,n){var r,o=e.mode,i=e.pendingProps,s=Fi.current,a=!1;if((r=0!==(64&e.effectTag))||(r=0!==(2&s)&&(null===t||null!==t.memoizedState)),r?(a=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(s|=1),uo(Fi,1&s),null===t){if(void 0!==i.fallback&&Ss(e),a){if(a=i.fallback,(i=Pl(null,o,0,null)).return=e,0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,i.child=t;null!==t;)t.return=i,t=t.sibling;return(n=Pl(a,o,n,null)).return=e,i.sibling=n,e.memoizedState=Hs,e.child=i,n}return o=i.children,e.memoizedState=null,e.child=Ti(e,null,o,n)}if(null!==t.memoizedState){if(o=(t=t.child).sibling,a){if(i=i.fallback,(n=Tl(t,t.pendingProps)).return=e,0===(2&e.mode)&&(a=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=a;null!==a;)a.return=n,a=a.sibling;return(o=Tl(o,i)).return=e,n.sibling=o,n.childExpirationTime=0,e.memoizedState=Hs,e.child=n,o}return n=Si(e,t.child,i.children,n),e.memoizedState=null,e.child=n}if(t=t.child,a){if(a=i.fallback,(i=Pl(null,o,0,null)).return=e,i.child=t,null!==t&&(t.return=i),0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,i.child=t;null!==t;)t.return=i,t=t.sibling;return(n=Pl(a,o,n,null)).return=e,i.sibling=n,n.effectTag|=2,i.childExpirationTime=0,e.memoizedState=Hs,e.child=i,n}return e.memoizedState=null,e.child=Si(e,t,i.children,n)}function Ws(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),ni(t.return,e)}function qs(t,e,n,r,o,i){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:o,lastEffect:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailExpiration=0,s.tailMode=o,s.lastEffect=i)}function Xs(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(As(t,e,r.children,n),0!==(2&(r=Fi.current)))r=1&r|2,e.effectTag|=64;else{if(null!==t&&0!==(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Ws(t,n);else if(19===t.tag)Ws(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(uo(Fi,r),0===(2&e.mode))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;null!==n;)null!==(t=n.alternate)&&null===ki(t)&&(o=n),n=n.sibling;null===(n=o)?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),qs(e,!1,o,n,i,e.lastEffect);break;case"backwards":for(n=null,o=e.child,e.child=null;null!==o;){if(null!==(t=o.alternate)&&null===ki(t)){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}qs(e,!0,n,null,i,e.lastEffect);break;case"together":qs(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Ks(t,e,n){null!==t&&(e.dependencies=t.dependencies);var r=e.expirationTime;if(0!==r&&sl(r),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Tl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Tl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ys(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Zs(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return mo(e.type)&&yo(),null;case 3:return Mi(),lo(ho),lo(po),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||!Rs(e)||(e.effectTag|=4),null;case 5:Ni(e),n=Ai(Ii.current);var i=e.type;if(null!==t&&null!=e.stateNode)zs(t,e,i,r,n),t.ref!==e.ref&&(e.effectTag|=128);else{if(!r){if(null===e.stateNode)throw Error(s(166));return null}if(t=Ai(Pi.current),Rs(e)){r=e.stateNode,i=e.type;var a=e.memoizedProps;switch(r[En]=e,r[Sn]=a,i){case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(t=0;t<Zt.length;t++)Xe(Zt[t],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"form":Xe("reset",r),Xe("submit",r);break;case"details":Xe("toggle",r);break;case"input":xt(r,a),Xe("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Xe("invalid",r),ln(n,"onChange");break;case"textarea":At(r,a),Xe("invalid",r),ln(n,"onChange")}for(var l in on(i,a),t=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?r.textContent!==u&&(t=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(t=["children",""+u]):E.hasOwnProperty(l)&&null!=u&&ln(n,l)}switch(i){case"input":wt(r),Tt(r,a,!0);break;case"textarea":wt(r),Mt(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=un)}n=t,e.updateQueue=n,null!==n&&(e.effectTag|=4)}else{switch(l=9===n.nodeType?n:n.ownerDocument,t===an&&(t=Ft(i)),t===an?"script"===i?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=l.createElement(i,{is:r.is}):(t=l.createElement(i),"select"===i&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,i),t[En]=e,t[Sn]=r,Vs(t,e),e.stateNode=t,l=sn(i,r),i){case"iframe":case"object":case"embed":Xe("load",t),u=r;break;case"video":case"audio":for(u=0;u<Zt.length;u++)Xe(Zt[u],t);u=r;break;case"source":Xe("error",t),u=r;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),u=r;break;case"form":Xe("reset",t),Xe("submit",t),u=r;break;case"details":Xe("toggle",t),u=r;break;case"input":xt(t,r),u=bt(t,r),Xe("invalid",t),ln(n,"onChange");break;case"option":u=Pt(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},u=o({},r,{value:void 0}),Xe("invalid",t),ln(n,"onChange");break;case"textarea":At(t,r),u=It(t,r),Xe("invalid",t),ln(n,"onChange");break;default:u=r}on(i,u);var c=u;for(a in c)if(c.hasOwnProperty(a)){var p=c[a];"style"===a?nn(t,p):"dangerouslySetInnerHTML"===a?null!=(p=p?p.__html:void 0)&&Bt(t,p):"children"===a?"string"===typeof p?("textarea"!==i||""!==p)&&Vt(t,p):"number"===typeof p&&Vt(t,""+p):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(E.hasOwnProperty(a)?null!=p&&ln(n,a):null!=p&&Q(t,a,p,l))}switch(i){case"input":wt(t),Tt(t,r,!1);break;case"textarea":wt(t),Mt(t);break;case"option":null!=r.value&&t.setAttribute("value",""+vt(r.value));break;case"select":t.multiple=!!r.multiple,null!=(n=r.value)?Ot(t,!!r.multiple,n,!1):null!=r.defaultValue&&Ot(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof u.onClick&&(t.onclick=un)}yn(i,r)&&(e.effectTag|=4)}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)js(0,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(s(166));n=Ai(Ii.current),Ai(Pi.current),Rs(e)?(n=e.stateNode,r=e.memoizedProps,n[En]=e,n.nodeValue!==r&&(e.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[En]=e,e.stateNode=n)}return null;case 13:return lo(Fi),r=e.memoizedState,0!==(64&e.effectTag)?(e.expirationTime=n,e):(n=null!==r,r=!1,null===t?void 0!==e.memoizedProps.fallback&&Rs(e):(r=null!==(i=t.memoizedState),n||null===i||null!==(i=t.child.sibling)&&(null!==(a=e.firstEffect)?(e.firstEffect=i,i.nextEffect=a):(e.firstEffect=e.lastEffect=i,i.nextEffect=null),i.effectTag=8)),n&&!r&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Fi.current)?Ra===wa&&(Ra=Ca):(Ra!==wa&&Ra!==Ca||(Ra=ba),0!==Da&&null!==Ea&&(Ml(Ea,Ta),Ll(Ea,Da)))),(n||r)&&(e.effectTag|=4),null);case 4:return Mi(),null;case 10:return ei(e),null;case 17:return mo(e.type)&&yo(),null;case 19:if(lo(Fi),null===(r=e.memoizedState))return null;if(i=0!==(64&e.effectTag),null===(a=r.rendering)){if(i)Ys(r,!1);else if(Ra!==wa||null!==t&&0!==(64&t.effectTag))for(a=e.child;null!==a;){if(null!==(t=ki(a))){for(e.effectTag|=64,Ys(r,!1),null!==(i=t.updateQueue)&&(e.updateQueue=i,e.effectTag|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=e.child;null!==r;)a=n,(i=r).effectTag&=2,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,null===(t=i.alternate)?(i.childExpirationTime=0,i.expirationTime=a,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null):(i.childExpirationTime=t.childExpirationTime,i.expirationTime=t.expirationTime,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,a=t.dependencies,i.dependencies=null===a?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),r=r.sibling;return uo(Fi,1&Fi.current|2),e.child}a=a.sibling}}else{if(!i)if(null!==(t=ki(a))){if(e.effectTag|=64,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.effectTag|=4),Ys(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*Vo()-r.renderingStartTime>r.tailExpiration&&1<n&&(e.effectTag|=64,i=!0,Ys(r,!1),e.expirationTime=e.childExpirationTime=n-1);r.isBackwards?(a.sibling=e.child,e.child=a):(null!==(n=r.last)?n.sibling=a:e.child=a,r.last=a)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Vo()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=Vo(),n.sibling=null,e=Fi.current,uo(Fi,i?1&e|2:1&e),n):null}throw Error(s(156,e.tag))}function Qs(t){switch(t.tag){case 1:mo(t.type)&&yo();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(Mi(),lo(ho),lo(po),0!==(64&(e=t.effectTag)))throw Error(s(285));return t.effectTag=-4097&e|64,t;case 5:return Ni(t),null;case 13:return lo(Fi),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return lo(Fi),null;case 4:return Mi(),null;case 10:return ei(t),null;default:return null}}function Js(t,e){return{value:t,source:e,stack:yt(e)}}Vs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},zs=function(t,e,n,r,i){var s=t.memoizedProps;if(s!==r){var a,l,u=e.stateNode;switch(Ai(Pi.current),t=null,n){case"input":s=bt(u,s),r=bt(u,r),t=[];break;case"option":s=Pt(u,s),r=Pt(u,r),t=[];break;case"select":s=o({},s,{value:void 0}),r=o({},r,{value:void 0}),t=[];break;case"textarea":s=It(u,s),r=It(u,r),t=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(u.onclick=un)}for(a in on(n,r),n=null,s)if(!r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(l in u=s[a])u.hasOwnProperty(l)&&(n||(n={}),n[l]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(E.hasOwnProperty(a)?t||(t=[]):(t=t||[]).push(a,null));for(a in r){var c=r[a];if(u=null!=s?s[a]:void 0,r.hasOwnProperty(a)&&c!==u&&(null!=c||null!=u))if("style"===a)if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(t||(t=[]),t.push(a,n)),n=c;else"dangerouslySetInnerHTML"===a?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(t=t||[]).push(a,c)):"children"===a?u===c||"string"!==typeof c&&"number"!==typeof c||(t=t||[]).push(a,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(E.hasOwnProperty(a)?(null!=c&&ln(i,a),t||u===c||(t=[])):(t=t||[]).push(a,c))}n&&(t=t||[]).push("style",n),i=t,(e.updateQueue=i)&&(e.effectTag|=4)}},js=function(t,e,n,r){n!==r&&(e.effectTag|=4)};var $s="function"===typeof WeakSet?WeakSet:Set;function ta(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=yt(n)),null!==n&&mt(n.type),e=e.value,null!==t&&1===t.tag&&mt(t.type);try{console.error(e)}catch(o){setTimeout((function(){throw o}))}}function ea(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){vl(t,n)}else e.current=null}function na(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Yo(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(s(163))}function ra(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==e)}}function oa(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ia(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:return void oa(3,n);case 1:if(t=n.stateNode,4&n.effectTag)if(null===e)t.componentDidMount();else{var r=n.elementType===n.type?e.memoizedProps:Yo(n.type,e.memoizedProps);t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}return void(null!==(e=n.updateQueue)&&hi(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}hi(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.effectTag&&yn(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Fe(n)))));case 19:case 17:case 20:case 21:return}throw Error(s(163))}function sa(t,e,n){switch("function"===typeof bl&&bl(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t.next;Ho(97<n?97:n,(function(){var t=r;do{var n=t.destroy;if(void 0!==n){var o=e;try{n()}catch(i){vl(o,i)}}t=t.next}while(t!==r)}))}break;case 1:ea(e),"function"===typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(n){vl(t,n)}}(e,n);break;case 5:ea(e);break;case 4:ca(t,e,n)}}function aa(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,null!==e&&aa(e)}function la(t){return 5===t.tag||3===t.tag||4===t.tag}function ua(t){t:{for(var e=t.return;null!==e;){if(la(e)){var n=e;break t}e=e.return}throw Error(s(160))}switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.effectTag&&(Vt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||la(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}r?function t(e,n,r){var o=e.tag,i=5===o||6===o;if(i)e=i?e.stateNode:e.stateNode.instance,n?8===r.nodeType?r.parentNode.insertBefore(e,n):r.insertBefore(e,n):(8===r.nodeType?(n=r.parentNode).insertBefore(e,r):(n=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==n.onclick||(n.onclick=un));else if(4!==o&&null!==(e=e.child))for(t(e,n,r),e=e.sibling;null!==e;)t(e,n,r),e=e.sibling}(t,n,e):function t(e,n,r){var o=e.tag,i=5===o||6===o;if(i)e=i?e.stateNode:e.stateNode.instance,n?r.insertBefore(e,n):r.appendChild(e);else if(4!==o&&null!==(e=e.child))for(t(e,n,r),e=e.sibling;null!==e;)t(e,n,r),e=e.sibling}(t,n,e)}function ca(t,e,n){for(var r,o,i=e,a=!1;;){if(!a){a=i.return;t:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:o=!1;break t;case 3:case 4:r=r.containerInfo,o=!0;break t}a=a.return}a=!0}if(5===i.tag||6===i.tag){t:for(var l=t,u=i,c=n,p=u;;)if(sa(l,p,c),null!==p.child&&4!==p.tag)p.child.return=p,p=p.child;else{if(p===u)break t;for(;null===p.sibling;){if(null===p.return||p.return===u)break t;p=p.return}p.sibling.return=p.return,p=p.sibling}o?(l=r,u=i.stateNode,8===l.nodeType?l.parentNode.removeChild(u):l.removeChild(u)):r.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){r=i.stateNode.containerInfo,o=!0,i.child.return=i,i=i.child;continue}}else if(sa(t,i,n),null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function pa(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:return void ra(3,e);case 1:return;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps,o=null!==t?t.memoizedProps:r;t=e.type;var i=e.updateQueue;if(e.updateQueue=null,null!==i){for(n[Sn]=r,"input"===t&&"radio"===r.type&&null!=r.name&&Et(n,r),sn(t,o),e=sn(t,r),o=0;o<i.length;o+=2){var a=i[o],l=i[o+1];"style"===a?nn(n,l):"dangerouslySetInnerHTML"===a?Bt(n,l):"children"===a?Vt(n,l):Q(n,a,l,e)}switch(t){case"input":St(n,r);break;case"textarea":Dt(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(t=r.value)?Ot(n,!!r.multiple,t,!1):e!==!!r.multiple&&(null!=r.defaultValue?Ot(n,!!r.multiple,r.defaultValue,!0):Ot(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(s(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((e=e.stateNode).hydrate&&(e.hydrate=!1,Fe(e.containerInfo)));case 12:return;case 13:if(n=e,null===e.memoizedState?r=!1:(r=!0,n=e.child,La=Vo()),null!==n)t:for(t=n;;){if(5===t.tag)i=t.stateNode,r?"function"===typeof(i=i.style).setProperty?i.setProperty("display","none","important"):i.display="none":(i=t.stateNode,o=void 0!==(o=t.memoizedProps.style)&&null!==o&&o.hasOwnProperty("display")?o.display:null,i.style.display=en("display",o));else if(6===t.tag)t.stateNode.nodeValue=r?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(i=t.child.sibling).return=t,t=i;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}return void ha(e);case 19:return void ha(e);case 17:return}throw Error(s(163))}function ha(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new $s),e.forEach((function(e){var r=wl.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(t,e,n){(n=li(n,null)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Fa||(Fa=!0,ka=r),ta(t,e)},n}function ga(t,e,n){(n=li(n,null)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var o=e.value;n.payload=function(){return ta(t,e),r(o)}}var i=t.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Ga?Ga=new Set([this]):Ga.add(this),ta(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var ma,ya=Math.ceil,va=Z.ReactCurrentDispatcher,_a=Z.ReactCurrentOwner,wa=0,Ca=3,ba=4,xa=0,Ea=null,Sa=null,Ta=0,Ra=wa,Pa=null,Oa=1073741823,Ia=1073741823,Aa=null,Da=0,Ma=!1,La=0,Na=null,Fa=!1,ka=null,Ga=null,Ba=!1,Va=null,za=90,ja=null,Ha=0,Ua=null,Wa=0;function qa(){return 0!==(48&xa)?1073741821-(Vo()/10|0):0!==Wa?Wa:Wa=1073741821-(Vo()/10|0)}function Xa(t,e,n){if(0===(2&(e=e.mode)))return 1073741823;var r=zo();if(0===(4&e))return 99===r?1073741823:1073741822;if(0!==(16&xa))return Ta;if(null!==n)t=Ko(t,0|n.timeoutMs||5e3,250);else switch(r){case 99:t=1073741823;break;case 98:t=Ko(t,150,100);break;case 97:case 96:t=Ko(t,5e3,250);break;case 95:t=2;break;default:throw Error(s(326))}return null!==Ea&&t===Ta&&--t,t}function Ka(t,e){if(50<Ha)throw Ha=0,Ua=null,Error(s(185));if(null!==(t=Ya(t,e))){var n=zo();1073741823===e?0!==(8&xa)&&0===(48&xa)?$a(t):(Qa(t),0===xa&&qo()):Qa(t),0===(4&xa)||98!==n&&99!==n||(null===ja?ja=new Map([[t,e]]):(void 0===(n=ja.get(t))||n>e)&&ja.set(t,e))}}function Ya(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var r=t.return,o=null;if(null===r&&3===t.tag)o=t.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===r.return&&3===r.tag){o=r.stateNode;break}r=r.return}return null!==o&&(Ea===o&&(sl(e),Ra===ba&&Ml(o,Ta)),Ll(o,e)),o}function Za(t){var e=t.lastExpiredTime;if(0!==e)return e;if(!Dl(t,e=t.firstPendingTime))return e;var n=t.lastPingedTime;return 2>=(t=n>(t=t.nextKnownPendingLevel)?n:t)&&e!==t?0:t}function Qa(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Wo($a.bind(null,t));else{var e=Za(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var r=qa();if(1073741823===e?r=99:1===e||2===e?r=95:r=0>=(r=10*(1073741821-e)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var o=t.callbackPriority;if(t.callbackExpirationTime===e&&o>=r)return;n!==Mo&&Eo(n)}t.callbackExpirationTime=e,t.callbackPriority=r,e=1073741823===e?Wo($a.bind(null,t)):Uo(r,Ja.bind(null,t),{timeout:10*(1073741821-e)-Vo()}),t.callbackNode=e}}}function Ja(t,e){if(Wa=0,e)return Nl(t,e=qa()),Qa(t),null;var n=Za(t);if(0!==n){if(e=t.callbackNode,0!==(48&xa))throw Error(s(327));if(gl(),t===Ea&&n===Ta||nl(t,n),null!==Sa){var r=xa;xa|=16;for(var o=ol();;)try{ll();break}catch(l){rl(t,l)}if(ti(),xa=r,va.current=o,1===Ra)throw e=Pa,nl(t,n),Ml(t,n),Qa(t),e;if(null===Sa)switch(o=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,r=Ra,Ea=null,r){case wa:case 1:throw Error(s(345));case 2:Nl(t,2<n?2:n);break;case Ca:if(Ml(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=pl(o)),1073741823===Oa&&10<(o=La+500-Vo())){if(Ma){var i=t.lastPingedTime;if(0===i||i>=n){t.lastPingedTime=n,nl(t,n);break}}if(0!==(i=Za(t))&&i!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}t.timeoutHandle=_n(hl.bind(null,t),o);break}hl(t);break;case ba:if(Ml(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=pl(o)),Ma&&(0===(o=t.lastPingedTime)||o>=n)){t.lastPingedTime=n,nl(t,n);break}if(0!==(o=Za(t))&&o!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}if(1073741823!==Ia?r=10*(1073741821-Ia)-Vo():1073741823===Oa?r=0:(r=10*(1073741821-Oa)-5e3,0>(r=(o=Vo())-r)&&(r=0),(n=10*(1073741821-n)-o)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ya(r/1960))-r)&&(r=n)),10<r){t.timeoutHandle=_n(hl.bind(null,t),r);break}hl(t);break;case 5:if(1073741823!==Oa&&null!==Aa){i=Oa;var a=Aa;if(0>=(r=0|a.busyMinDurationMs)?r=0:(o=0|a.busyDelayMs,r=(i=Vo()-(10*(1073741821-i)-(0|a.timeoutMs||5e3)))<=o?0:o+r-i),10<r){Ml(t,n),t.timeoutHandle=_n(hl.bind(null,t),r);break}}hl(t);break;default:throw Error(s(329))}if(Qa(t),t.callbackNode===e)return Ja.bind(null,t)}}return null}function $a(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,0!==(48&xa))throw Error(s(327));if(gl(),t===Ea&&e===Ta||nl(t,e),null!==Sa){var n=xa;xa|=16;for(var r=ol();;)try{al();break}catch(o){rl(t,o)}if(ti(),xa=n,va.current=r,1===Ra)throw n=Pa,nl(t,e),Ml(t,e),Qa(t),n;if(null!==Sa)throw Error(s(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Ea=null,hl(t),Qa(t)}return null}function tl(t,e){var n=xa;xa|=1;try{return t(e)}finally{0===(xa=n)&&qo()}}function el(t,e){var n=xa;xa&=-2,xa|=8;try{return t(e)}finally{0===(xa=n)&&qo()}}function nl(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,wn(n)),null!==Sa)for(n=Sa.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&yo();break;case 3:Mi(),lo(ho),lo(po);break;case 5:Ni(r);break;case 4:Mi();break;case 13:case 19:lo(Fi);break;case 10:ei(r)}n=n.return}Ea=t,Sa=Tl(t.current,null),Ta=e,Ra=wa,Pa=null,Ia=Oa=1073741823,Aa=null,Da=0,Ma=!1}function rl(t,e){for(;;){try{if(ti(),Bi.current=ms,Wi)for(var n=ji.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(zi=0,Ui=Hi=ji=null,Wi=!1,null===Sa||null===Sa.return)return Ra=1,Pa=e,Sa=null;t:{var o=t,i=Sa.return,s=Sa,a=e;if(e=Ta,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"===typeof a&&"function"===typeof a.then){var l=a;if(0===(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.expirationTime=u.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var c=0!==(1&Fi.current),p=i;do{var h;if(h=13===p.tag){var d=p.memoizedState;if(null!==d)h=null!==d.dehydrated;else{var f=p.memoizedProps;h=void 0!==f.fallback&&(!0!==f.unstable_avoidThisFallback||!c)}}if(h){var g=p.updateQueue;if(null===g){var m=new Set;m.add(l),p.updateQueue=m}else g.add(l);if(0===(2&p.mode)){if(p.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=li(1073741823,null);y.tag=2,ui(s,y)}s.expirationTime=1073741823;break t}a=void 0,s=e;var v=o.pingCache;if(null===v?(v=o.pingCache=new da,a=new Set,v.set(l,a)):void 0===(a=v.get(l))&&(a=new Set,v.set(l,a)),!a.has(s)){a.add(s);var _=_l.bind(null,o,l,s);l.then(_,_)}p.effectTag|=4096,p.expirationTime=e;break t}p=p.return}while(null!==p);a=Error((mt(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+yt(s))}5!==Ra&&(Ra=2),a=Js(a,s),p=i;do{switch(p.tag){case 3:l=a,p.effectTag|=4096,p.expirationTime=e,ci(p,fa(p,l,e));break t;case 1:l=a;var w=p.type,C=p.stateNode;if(0===(64&p.effectTag)&&("function"===typeof w.getDerivedStateFromError||null!==C&&"function"===typeof C.componentDidCatch&&(null===Ga||!Ga.has(C)))){p.effectTag|=4096,p.expirationTime=e,ci(p,ga(p,l,e));break t}}p=p.return}while(null!==p)}Sa=cl(Sa)}catch(b){e=b;continue}break}}function ol(){var t=va.current;return va.current=ms,null===t?ms:t}function il(t,e){t<Oa&&2<t&&(Oa=t),null!==e&&t<Ia&&2<t&&(Ia=t,Aa=e)}function sl(t){t>Da&&(Da=t)}function al(){for(;null!==Sa;)Sa=ul(Sa)}function ll(){for(;null!==Sa&&!Lo();)Sa=ul(Sa)}function ul(t){var e=ma(t.alternate,t,Ta);return t.memoizedProps=t.pendingProps,null===e&&(e=cl(t)),_a.current=null,e}function cl(t){Sa=t;do{var e=Sa.alternate;if(t=Sa.return,0===(2048&Sa.effectTag)){if(e=Zs(e,Sa,Ta),1===Ta||1!==Sa.childExpirationTime){for(var n=0,r=Sa.child;null!==r;){var o=r.expirationTime,i=r.childExpirationTime;o>n&&(n=o),i>n&&(n=i),r=r.sibling}Sa.childExpirationTime=n}if(null!==e)return e;null!==t&&0===(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=Sa.firstEffect),null!==Sa.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=Sa.firstEffect),t.lastEffect=Sa.lastEffect),1<Sa.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=Sa:t.firstEffect=Sa,t.lastEffect=Sa))}else{if(null!==(e=Qs(Sa)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=Sa.sibling))return e;Sa=t}while(null!==Sa);return Ra===wa&&(Ra=5),null}function pl(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function hl(t){var e=zo();return Ho(99,dl.bind(null,t,e)),null}function dl(t,e){do{gl()}while(null!==Va);if(0!==(48&xa))throw Error(s(327));var n=t.finishedWork,r=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(s(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var o=pl(n);if(t.firstPendingTime=o,r<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:r<=t.firstSuspendedTime&&(t.firstSuspendedTime=r-1),r<=t.lastPingedTime&&(t.lastPingedTime=0),r<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Ea&&(Sa=Ea=null,Ta=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,o=n.firstEffect):o=n:o=n.firstEffect,null!==o){var i=xa;xa|=32,_a.current=null,gn=qe;var a=dn();if(fn(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else t:{var u=(l=(l=a.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(u&&0!==u.rangeCount){l=u.anchorNode;var c=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch(T){l=null;break t}var h=0,d=-1,f=-1,g=0,m=0,y=a,v=null;e:for(;;){for(var _;y!==l||0!==c&&3!==y.nodeType||(d=h+c),y!==p||0!==u&&3!==y.nodeType||(f=h+u),3===y.nodeType&&(h+=y.nodeValue.length),null!==(_=y.firstChild);)v=y,y=_;for(;;){if(y===a)break e;if(v===l&&++g===c&&(d=h),v===p&&++m===u&&(f=h),null!==(_=y.nextSibling))break;v=(y=v).parentNode}y=_}l=-1===d||-1===f?null:{start:d,end:f}}else l=null}l=l||{start:0,end:0}}else l=null;mn={activeElementDetached:null,focusedElem:a,selectionRange:l},qe=!1,Na=o;do{try{fl()}catch(T){if(null===Na)throw Error(s(330));vl(Na,T),Na=Na.nextEffect}}while(null!==Na);Na=o;do{try{for(a=t,l=e;null!==Na;){var w=Na.effectTag;if(16&w&&Vt(Na.stateNode,""),128&w){var C=Na.alternate;if(null!==C){var b=C.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&w){case 2:ua(Na),Na.effectTag&=-3;break;case 6:ua(Na),Na.effectTag&=-3,pa(Na.alternate,Na);break;case 1024:Na.effectTag&=-1025;break;case 1028:Na.effectTag&=-1025,pa(Na.alternate,Na);break;case 4:pa(Na.alternate,Na);break;case 8:ca(a,c=Na,l),aa(c)}Na=Na.nextEffect}}catch(T){if(null===Na)throw Error(s(330));vl(Na,T),Na=Na.nextEffect}}while(null!==Na);if(b=mn,C=dn(),w=b.focusedElem,l=b.selectionRange,C!==w&&w&&w.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(w.ownerDocument.documentElement,w)){null!==l&&fn(w)&&(C=l.start,void 0===(b=l.end)&&(b=C),"selectionStart"in w?(w.selectionStart=C,w.selectionEnd=Math.min(b,w.value.length)):(b=(C=w.ownerDocument||document)&&C.defaultView||window).getSelection&&(b=b.getSelection(),c=w.textContent.length,a=Math.min(l.start,c),l=void 0===l.end?a:Math.min(l.end,c),!b.extend&&a>l&&(c=l,l=a,a=c),c=hn(w,a),p=hn(w,l),c&&p&&(1!==b.rangeCount||b.anchorNode!==c.node||b.anchorOffset!==c.offset||b.focusNode!==p.node||b.focusOffset!==p.offset)&&((C=C.createRange()).setStart(c.node,c.offset),b.removeAllRanges(),a>l?(b.addRange(C),b.extend(p.node,p.offset)):(C.setEnd(p.node,p.offset),b.addRange(C))))),C=[];for(b=w;b=b.parentNode;)1===b.nodeType&&C.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof w.focus&&w.focus(),w=0;w<C.length;w++)(b=C[w]).element.scrollLeft=b.left,b.element.scrollTop=b.top}qe=!!gn,mn=gn=null,t.current=n,Na=o;do{try{for(w=t;null!==Na;){var x=Na.effectTag;if(36&x&&ia(w,Na.alternate,Na),128&x){C=void 0;var E=Na.ref;if(null!==E){var S=Na.stateNode;switch(Na.tag){case 5:C=S;break;default:C=S}"function"===typeof E?E(C):E.current=C}}Na=Na.nextEffect}}catch(T){if(null===Na)throw Error(s(330));vl(Na,T),Na=Na.nextEffect}}while(null!==Na);Na=null,No(),xa=i}else t.current=n;if(Ba)Ba=!1,Va=t,za=e;else for(Na=o;null!==Na;)e=Na.nextEffect,Na.nextEffect=null,Na=e;if(0===(e=t.firstPendingTime)&&(Ga=null),1073741823===e?t===Ua?Ha++:(Ha=0,Ua=t):Ha=0,"function"===typeof Cl&&Cl(n.stateNode,r),Qa(t),Fa)throw Fa=!1,t=ka,ka=null,t;return 0!==(8&xa)||qo(),null}function fl(){for(;null!==Na;){var t=Na.effectTag;0!==(256&t)&&na(Na.alternate,Na),0===(512&t)||Ba||(Ba=!0,Uo(97,(function(){return gl(),null}))),Na=Na.nextEffect}}function gl(){if(90!==za){var t=97<za?97:za;return za=90,Ho(t,ml)}}function ml(){if(null===Va)return!1;var t=Va;if(Va=null,0!==(48&xa))throw Error(s(331));var e=xa;for(xa|=32,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:ra(5,n),oa(5,n)}}catch(r){if(null===t)throw Error(s(330));vl(t,r)}n=t.nextEffect,t.nextEffect=null,t=n}return xa=e,qo(),!0}function yl(t,e,n){ui(t,e=fa(t,e=Js(n,e),1073741823)),null!==(t=Ya(t,1073741823))&&Qa(t)}function vl(t,e){if(3===t.tag)yl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){yl(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ga||!Ga.has(r))){ui(n,t=ga(n,t=Js(e,t),1073741823)),null!==(n=Ya(n,1073741823))&&Qa(n);break}}n=n.return}}function _l(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),Ea===t&&Ta===n?Ra===ba||Ra===Ca&&1073741823===Oa&&Vo()-La<500?nl(t,Ta):Ma=!0:Dl(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,Qa(t)))}function wl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=Xa(e=qa(),t,null)),null!==(t=Ya(t,e))&&Qa(t)}ma=function(t,e,n){var r=e.expirationTime;if(null!==t){var o=e.pendingProps;if(t.memoizedProps!==o||ho.current)Is=!0;else{if(r<n){switch(Is=!1,e.tag){case 3:Bs(e),Ps();break;case 5:if(Li(e),4&e.mode&&1!==n&&o.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:mo(e.type)&&wo(e);break;case 4:Di(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value,o=e.type._context,uo(Zo,o._currentValue),o._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=n?Us(t,e,n):(uo(Fi,1&Fi.current),null!==(e=Ks(t,e,n))?e.sibling:null);uo(Fi,1&Fi.current);break;case 19:if(r=e.childExpirationTime>=n,0!==(64&t.effectTag)){if(r)return Xs(t,e,n);e.effectTag|=64}if(null!==(o=e.memoizedState)&&(o.rendering=null,o.tail=null),uo(Fi,Fi.current),!r)return null}return Ks(t,e,n)}Is=!1}}else Is=!1;switch(e.expirationTime=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,o=go(e,po.current),ri(e,n),o=Ki(null,e,r,t,o,n),e.effectTag|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,mo(r)){var i=!0;wo(e)}else i=!1;e.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,si(e);var a=r.getDerivedStateFromProps;"function"===typeof a&&gi(e,r,a,t),o.updater=mi,e.stateNode=o,o._reactInternalFiber=e,wi(e,r,t,n),e=Gs(null,e,r,!0,i,n)}else e.tag=0,As(null,e,o,n),e=e.child;return e;case 16:t:{if(o=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(o),1!==o._status)throw o._result;switch(o=o._result,e.type=o,i=e.tag=function(t){if("function"===typeof t)return Sl(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===lt)return 11;if(t===pt)return 14}return 2}(o),t=Yo(o,t),i){case 0:e=Fs(null,e,o,t,n);break t;case 1:e=ks(null,e,o,t,n);break t;case 11:e=Ds(null,e,o,t,n);break t;case 14:e=Ms(null,e,o,Yo(o.type,t),r,n);break t}throw Error(s(306,o,""))}return e;case 0:return r=e.type,o=e.pendingProps,Fs(t,e,r,o=e.elementType===r?o:Yo(r,o),n);case 1:return r=e.type,o=e.pendingProps,ks(t,e,r,o=e.elementType===r?o:Yo(r,o),n);case 3:if(Bs(e),r=e.updateQueue,null===t||null===r)throw Error(s(282));if(r=e.pendingProps,o=null!==(o=e.memoizedState)?o.element:null,ai(t,e),pi(e,r,null,n),(r=e.memoizedState.element)===o)Ps(),e=Ks(t,e,n);else{if((o=e.stateNode.hydrate)&&(Cs=Cn(e.stateNode.containerInfo.firstChild),ws=e,o=bs=!0),o)for(n=Ti(e,null,r,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else As(t,e,r,n),Ps();e=e.child}return e;case 5:return Li(e),null===t&&Ss(e),r=e.type,o=e.pendingProps,i=null!==t?t.memoizedProps:null,a=o.children,vn(r,o)?a=null:null!==i&&vn(r,i)&&(e.effectTag|=16),Ns(t,e),4&e.mode&&1!==n&&o.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(As(t,e,a,n),e=e.child),e;case 6:return null===t&&Ss(e),null;case 13:return Us(t,e,n);case 4:return Di(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Si(e,null,r,n):As(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,Ds(t,e,r,o=e.elementType===r?o:Yo(r,o),n);case 7:return As(t,e,e.pendingProps,n),e.child;case 8:case 12:return As(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,o=e.pendingProps,a=e.memoizedProps,i=o.value;var l=e.type._context;if(uo(Zo,l._currentValue),l._currentValue=i,null!==a)if(l=a.value,0===(i=kr(l,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(l,i):1073741823))){if(a.children===o.children&&!ho.current){e=Ks(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){a=l.child;for(var c=u.firstContext;null!==c;){if(c.context===r&&0!==(c.observedBits&i)){1===l.tag&&((c=li(n,null)).tag=2,ui(l,c)),l.expirationTime<n&&(l.expirationTime=n),null!==(c=l.alternate)&&c.expirationTime<n&&(c.expirationTime=n),ni(l.return,n),u.expirationTime<n&&(u.expirationTime=n);break}c=c.next}}else a=10===l.tag&&l.type===e.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===e){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}As(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=(i=e.pendingProps).children,ri(e,n),r=r(o=oi(o,i.unstable_observedBits)),e.effectTag|=1,As(t,e,r,n),e.child;case 14:return i=Yo(o=e.type,e.pendingProps),Ms(t,e,o,i=Yo(o.type,i),r,n);case 15:return Ls(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Yo(r,o),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,mo(r)?(t=!0,wo(e)):t=!1,ri(e,n),vi(e,r,o),wi(e,r,o,n),Gs(null,e,r,!0,t,n);case 19:return Xs(t,e,n)}throw Error(s(156,e.tag))};var Cl=null,bl=null;function xl(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function El(t,e,n,r){return new xl(t,e,n,r)}function Sl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Tl(t,e){var n=t.alternate;return null===n?((n=El(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rl(t,e,n,r,o,i){var a=2;if(r=t,"function"===typeof t)Sl(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case nt:return Pl(n.children,o,i,e);case at:a=8,o|=7;break;case rt:a=8,o|=1;break;case ot:return(t=El(12,n,e,8|o)).elementType=ot,t.type=ot,t.expirationTime=i,t;case ut:return(t=El(13,n,e,o)).type=ut,t.elementType=ut,t.expirationTime=i,t;case ct:return(t=El(19,n,e,o)).elementType=ct,t.expirationTime=i,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case it:a=10;break t;case st:a=9;break t;case lt:a=11;break t;case pt:a=14;break t;case ht:a=16,r=null;break t;case dt:a=22;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=El(a,n,e,o)).elementType=t,e.type=r,e.expirationTime=i,e}function Pl(t,e,n,r){return(t=El(7,t,r,e)).expirationTime=n,t}function Ol(t,e,n){return(t=El(6,t,null,e)).expirationTime=n,t}function Il(t,e,n){return(e=El(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Al(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Dl(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function Ml(t,e){var n=t.firstSuspendedTime,r=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(r>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Ll(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function Nl(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function Fl(t,e,n,r){var o=e.current,i=qa(),a=di.suspense;i=Xa(i,o,a);t:if(n){e:{if($t(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(mo(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var u=n.type;if(mo(u)){n=_o(n,u,l);break t}}n=l}else n=co;return null===e.context?e.context=n:e.pendingContext=n,(e=li(i,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),ui(o,e),Ka(o,i),i}function kl(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Gl(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function Bl(t,e){Gl(t,e),(t=t.alternate)&&Gl(t,e)}function Vl(t,e,n){var r=new Al(t,e,n=null!=n&&!0===n.hydrate),o=El(3,null,null,2===e?7:1===e?3:0);r.current=o,o.stateNode=r,si(o),t[Tn]=r.current,n&&0!==e&&function(t,e){var n=Jt(e);Te.forEach((function(t){fe(t,e,n)})),Re.forEach((function(t){fe(t,e,n)}))}(0,9===t.nodeType?t:t.ownerDocument),this._internalRoot=r}function zl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function jl(t,e,n,r,o){var i=n._reactRootContainer;if(i){var s=i._internalRoot;if("function"===typeof o){var a=o;o=function(){var t=kl(s);a.call(t)}}Fl(e,s,t,o)}else{if(i=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new Vl(t,0,e?{hydrate:!0}:void 0)}(n,r),s=i._internalRoot,"function"===typeof o){var l=o;o=function(){var t=kl(s);l.call(t)}}el((function(){Fl(e,s,t,o)}))}return kl(s)}function Hl(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:et,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Ul(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!zl(e))throw Error(s(200));return Hl(t,e,null,n)}Vl.prototype.render=function(t){Fl(t,this._internalRoot,null,null)},Vl.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Fl(null,t,null,(function(){e[Tn]=null}))},ge=function(t){if(13===t.tag){var e=Ko(qa(),150,100);Ka(t,e),Bl(t,e)}},me=function(t){13===t.tag&&(Ka(t,3),Bl(t,3))},ye=function(t){if(13===t.tag){var e=qa();Ka(t,e=Xa(e,t,null)),Bl(t,e)}},P=function(t,e,n){switch(e){case"input":if(St(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=In(r);if(!o)throw Error(s(90));Ct(r),St(r,o)}}}break;case"textarea":Dt(t,n);break;case"select":null!=(e=n.value)&&Ot(t,!!n.multiple,e,!1)}},L=tl,N=function(t,e,n,r,o){var i=xa;xa|=4;try{return Ho(98,t.bind(null,e,n,r,o))}finally{0===(xa=i)&&qo()}},F=function(){0===(49&xa)&&(function(){if(null!==ja){var t=ja;ja=null,t.forEach((function(t,e){Nl(e,t),Qa(e)})),qo()}}(),gl())},k=function(t,e){var n=xa;xa|=2;try{return t(e)}finally{0===(xa=n)&&qo()}};var Wl={Events:[Pn,On,In,T,x,kn,function(t){oe(t,Fn)},D,M,Qe,ae,gl,{current:!1}]};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);Cl=function(t){try{e.onCommitFiberRoot(n,t,void 0,64===(64&t.current.effectTag))}catch(r){}},bl=function(t){try{e.onCommitFiberUnmount(n,t)}catch(r){}}}catch(r){}})(o({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Z.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=ne(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Rn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wl,e.createPortal=Ul,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw Error(s(268,Object.keys(t)))}return t=null===(t=ne(e))?null:t.stateNode},e.flushSync=function(t,e){if(0!==(48&xa))throw Error(s(187));var n=xa;xa|=1;try{return Ho(99,t.bind(null,e))}finally{xa=n,qo()}},e.hydrate=function(t,e,n){if(!zl(e))throw Error(s(200));return jl(null,t,e,!0,n)},e.render=function(t,e,n){if(!zl(e))throw Error(s(200));return jl(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!zl(t))throw Error(s(40));return!!t._reactRootContainer&&(el((function(){jl(null,null,t,!1,(function(){t._reactRootContainer=null,t[Tn]=null}))})),!0)},e.unstable_batchedUpdates=tl,e.unstable_createPortal=function(t,e){return Ul(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!zl(n))throw Error(s(200));if(null==t||void 0===t._reactInternalFiber)throw Error(s(38));return jl(t,e,n,!1,r)},e.version="16.14.0"},function(t,e,n){"use strict";t.exports=n(41)},function(t,e,n){"use strict";var r,o,i,s,a;if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,u=null,c=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(n){throw setTimeout(c,0),n}},p=Date.now();e.unstable_now=function(){return Date.now()-p},r=function(t){null!==l?setTimeout(r,0,t):(l=t,setTimeout(c,0))},o=function(t,e){u=setTimeout(t,e)},i=function(){clearTimeout(u)},s=function(){return!1},a=e.unstable_forceFrameRate=function(){}}else{var h=window.performance,d=window.Date,f=window.setTimeout,g=window.clearTimeout;if("undefined"!==typeof console){var m=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof h&&"function"===typeof h.now)e.unstable_now=function(){return h.now()};else{var y=d.now();e.unstable_now=function(){return d.now()-y}}var v=!1,_=null,w=-1,C=5,b=0;s=function(){return e.unstable_now()>=b},a=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):C=0<t?Math.floor(1e3/t):5};var x=new MessageChannel,E=x.port2;x.port1.onmessage=function(){if(null!==_){var t=e.unstable_now();b=t+C;try{_(!0,t)?E.postMessage(null):(v=!1,_=null)}catch(n){throw E.postMessage(null),n}}else v=!1},r=function(t){_=t,v||(v=!0,E.postMessage(null))},o=function(t,n){w=f((function(){t(e.unstable_now())}),n)},i=function(){g(w),w=-1}}function S(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,o=t[r];if(!(void 0!==o&&0<P(o,e)))break t;t[r]=e,t[n]=o,n=r}}function T(t){return void 0===(t=t[0])?null:t}function R(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,o=t.length;r<o;){var i=2*(r+1)-1,s=t[i],a=i+1,l=t[a];if(void 0!==s&&0>P(s,n))void 0!==l&&0>P(l,s)?(t[r]=l,t[a]=n,r=a):(t[r]=s,t[i]=n,r=i);else{if(!(void 0!==l&&0>P(l,n)))break t;t[r]=l,t[a]=n,r=a}}}return e}return null}function P(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var O=[],I=[],A=1,D=null,M=3,L=!1,N=!1,F=!1;function k(t){for(var e=T(I);null!==e;){if(null===e.callback)R(I);else{if(!(e.startTime<=t))break;R(I),e.sortIndex=e.expirationTime,S(O,e)}e=T(I)}}function G(t){if(F=!1,k(t),!N)if(null!==T(O))N=!0,r(B);else{var e=T(I);null!==e&&o(G,e.startTime-t)}}function B(t,n){N=!1,F&&(F=!1,i()),L=!0;var r=M;try{for(k(n),D=T(O);null!==D&&(!(D.expirationTime>n)||t&&!s());){var a=D.callback;if(null!==a){D.callback=null,M=D.priorityLevel;var l=a(D.expirationTime<=n);n=e.unstable_now(),"function"===typeof l?D.callback=l:D===T(O)&&R(O),k(n)}else R(O);D=T(O)}if(null!==D)var u=!0;else{var c=T(I);null!==c&&o(G,c.startTime-n),u=!1}return u}finally{D=null,M=r,L=!1}}function V(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var z=a;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){N||L||(N=!0,r(B))},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return T(O)},e.unstable_next=function(t){switch(M){case 1:case 2:case 3:var e=3;break;default:e=M}var n=M;M=e;try{return t()}finally{M=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=z,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=M;M=t;try{return e()}finally{M=n}},e.unstable_scheduleCallback=function(t,n,s){var a=e.unstable_now();if("object"===typeof s&&null!==s){var l=s.delay;l="number"===typeof l&&0<l?a+l:a,s="number"===typeof s.timeout?s.timeout:V(t)}else s=V(t),l=a;return t={id:A++,callback:n,priorityLevel:t,startTime:l,expirationTime:s=l+s,sortIndex:-1},l>a?(t.sortIndex=l,S(I,t),null===T(O)&&t===T(I)&&(F?i():F=!0,o(G,l-a))):(t.sortIndex=s,S(O,t),N||L||(N=!0,r(B))),t},e.unstable_shouldYield=function(){var t=e.unstable_now();k(t);var n=T(O);return n!==D&&null!==D&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<D.expirationTime||s()},e.unstable_wrapCallback=function(t){var e=M;return function(){var n=M;M=e;try{return t.apply(this,arguments)}finally{M=n}}}},,function(t,e,n){"use strict";var r=n(3),o=n(15),i=n(44),s=n(22);function a(t){var e=new i(t),n=o(i.prototype.request,e);return r.extend(n,i.prototype,e),r.extend(n,e),n}var l=a(n(18));l.Axios=i,l.create=function(t){return a(s(l.defaults,t))},l.Cancel=n(23),l.CancelToken=n(57),l.isCancel=n(17),l.all=function(t){return Promise.all(t)},l.spread=n(58),t.exports=l,t.exports.default=l},function(t,e,n){"use strict";var r=n(3),o=n(16),i=n(45),s=n(46),a=n(22);function l(t){this.defaults=t,this.interceptors={request:new i,response:new i}}l.prototype.request=function(t){"string"===typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[s,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},l.prototype.getUri=function(t){return t=a(this.defaults,t),o(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){l.prototype[t]=function(e,n){return this.request(r.merge(n||{},{method:t,url:e}))}})),r.forEach(["post","put","patch"],(function(t){l.prototype[t]=function(e,n,o){return this.request(r.merge(o||{},{method:t,url:e,data:n}))}})),t.exports=l},function(t,e,n){"use strict";var r=n(3);function o(){this.handlers=[]}o.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=o},function(t,e,n){"use strict";var r=n(3),o=n(47),i=n(17),s=n(18);function a(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return a(t),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return a(t),e.data=o(e.data,e.headers,t.transformResponse),e}),(function(e){return i(e)||(a(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},function(t,e,n){"use strict";var r=n(21);t.exports=function(t,e,n){var o=n.config.validateStatus;!o||o(n.status)?t(n):e(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,o){return t.config=e,n&&(t.code=n),t.request=r,t.response=o,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,n){"use strict";var r=n(52),o=n(53);t.exports=function(t,e){return t&&!r(e)?o(t,e):e}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var r=n(3),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,i,s={};return t?(r.forEach(t.split("\n"),(function(t){if(i=t.indexOf(":"),e=r.trim(t.substr(0,i)).toLowerCase(),n=r.trim(t.substr(i+1)),e){if(s[e]&&o.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},function(t,e,n){"use strict";var r=n(3);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=o(window.location.href),function(e){var n=r.isString(e)?o(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var r=n(3);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,o,i,s){var a=[];a.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";var r=n(23);function o(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t;return{token:new o((function(e){t=e})),cancel:t}},t.exports=o},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},,,,function(t,e,n){(function(t,r){var o;(function(){var i="Expected a function",s="__lodash_placeholder__",a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],l="[object Arguments]",u="[object Array]",c="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",f="[object GeneratorFunction]",g="[object Map]",m="[object Number]",y="[object Object]",v="[object RegExp]",_="[object Set]",w="[object String]",C="[object Symbol]",b="[object WeakMap]",x="[object ArrayBuffer]",E="[object DataView]",S="[object Float32Array]",T="[object Float64Array]",R="[object Int8Array]",P="[object Int16Array]",O="[object Int32Array]",I="[object Uint8Array]",A="[object Uint16Array]",D="[object Uint32Array]",M=/\b__p \+= '';/g,L=/\b(__p \+=) '' \+/g,N=/(__e\(.*?\)|\b__t\)) \+\n'';/g,F=/&(?:amp|lt|gt|quot|#39);/g,k=/[&<>"']/g,G=RegExp(F.source),B=RegExp(k.source),V=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,j=/<%=([\s\S]+?)%>/g,H=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,U=/^\w*$/,W=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q=/[\\^$.*+?()[\]{}|]/g,X=RegExp(q.source),K=/^\s+/,Y=/\s/,Z=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Q=/\{\n\/\* \[wrapped with (.+)\] \*/,J=/,? & /,$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tt=/[()=,{}\[\]\/\s]/,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,ot=/^[-+]0x[0-9a-f]+$/i,it=/^0b[01]+$/i,st=/^\[object .+?Constructor\]$/,at=/^0o[0-7]+$/i,lt=/^(?:0|[1-9]\d*)$/,ut=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ct=/($^)/,pt=/['\n\r\u2028\u2029\\]/g,ht="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",dt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ft="[\\ud800-\\udfff]",gt="["+dt+"]",mt="["+ht+"]",yt="\\d+",vt="[\\u2700-\\u27bf]",_t="[a-z\\xdf-\\xf6\\xf8-\\xff]",wt="[^\\ud800-\\udfff"+dt+yt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Ct="\\ud83c[\\udffb-\\udfff]",bt="[^\\ud800-\\udfff]",xt="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",St="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Tt="(?:"+_t+"|"+wt+")",Rt="(?:"+St+"|"+wt+")",Pt="(?:"+mt+"|"+Ct+")"+"?",Ot="[\\ufe0e\\ufe0f]?"+Pt+("(?:\\u200d(?:"+[bt,xt,Et].join("|")+")[\\ufe0e\\ufe0f]?"+Pt+")*"),It="(?:"+[vt,xt,Et].join("|")+")"+Ot,At="(?:"+[bt+mt+"?",mt,xt,Et,ft].join("|")+")",Dt=RegExp("['\u2019]","g"),Mt=RegExp(mt,"g"),Lt=RegExp(Ct+"(?="+Ct+")|"+At+Ot,"g"),Nt=RegExp([St+"?"+_t+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[gt,St,"$"].join("|")+")",Rt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[gt,St+Tt,"$"].join("|")+")",St+"?"+Tt+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",St+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",yt,It].join("|"),"g"),Ft=RegExp("[\\u200d\\ud800-\\udfff"+ht+"\\ufe0e\\ufe0f]"),kt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Bt=-1,Vt={};Vt[S]=Vt[T]=Vt[R]=Vt[P]=Vt[O]=Vt[I]=Vt["[object Uint8ClampedArray]"]=Vt[A]=Vt[D]=!0,Vt[l]=Vt[u]=Vt[x]=Vt[c]=Vt[E]=Vt[p]=Vt[h]=Vt[d]=Vt[g]=Vt[m]=Vt[y]=Vt[v]=Vt[_]=Vt[w]=Vt[b]=!1;var zt={};zt[l]=zt[u]=zt[x]=zt[E]=zt[c]=zt[p]=zt[S]=zt[T]=zt[R]=zt[P]=zt[O]=zt[g]=zt[m]=zt[y]=zt[v]=zt[_]=zt[w]=zt[C]=zt[I]=zt["[object Uint8ClampedArray]"]=zt[A]=zt[D]=!0,zt[h]=zt[d]=zt[b]=!1;var jt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ht=parseFloat,Ut=parseInt,Wt="object"==typeof t&&t&&t.Object===Object&&t,qt="object"==typeof self&&self&&self.Object===Object&&self,Xt=Wt||qt||Function("return this")(),Kt=e&&!e.nodeType&&e,Yt=Kt&&"object"==typeof r&&r&&!r.nodeType&&r,Zt=Yt&&Yt.exports===Kt,Qt=Zt&&Wt.process,Jt=function(){try{var t=Yt&&Yt.require&&Yt.require("util").types;return t||Qt&&Qt.binding&&Qt.binding("util")}catch(e){}}(),$t=Jt&&Jt.isArrayBuffer,te=Jt&&Jt.isDate,ee=Jt&&Jt.isMap,ne=Jt&&Jt.isRegExp,re=Jt&&Jt.isSet,oe=Jt&&Jt.isTypedArray;function ie(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function se(t,e,n,r){for(var o=-1,i=null==t?0:t.length;++o<i;){var s=t[o];e(r,s,n(s),t)}return r}function ae(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function le(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ue(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function ce(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}function pe(t,e){return!!(null==t?0:t.length)&&Ce(t,e,0)>-1}function he(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}function de(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}function fe(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function ge(t,e,n,r){var o=-1,i=null==t?0:t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function me(t,e,n,r){var o=null==t?0:t.length;for(r&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function ye(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var ve=Se("length");function _e(t,e,n){var r;return n(t,(function(t,n,o){if(e(t,n,o))return r=n,!1})),r}function we(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function Ce(t,e,n){return e===e?function(t,e,n){var r=n-1,o=t.length;for(;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):we(t,xe,n)}function be(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}function xe(t){return t!==t}function Ee(t,e){var n=null==t?0:t.length;return n?Pe(t,e)/n:NaN}function Se(t){return function(e){return null==e?void 0:e[t]}}function Te(t){return function(e){return null==t?void 0:t[e]}}function Re(t,e,n,r,o){return o(t,(function(t,o,i){n=r?(r=!1,t):e(n,t,o,i)})),n}function Pe(t,e){for(var n,r=-1,o=t.length;++r<o;){var i=e(t[r]);void 0!==i&&(n=void 0===n?i:n+i)}return n}function Oe(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ie(t){return t?t.slice(0,Ke(t)+1).replace(K,""):t}function Ae(t){return function(e){return t(e)}}function De(t,e){return de(e,(function(e){return t[e]}))}function Me(t,e){return t.has(e)}function Le(t,e){for(var n=-1,r=t.length;++n<r&&Ce(e,t[n],0)>-1;);return n}function Ne(t,e){for(var n=t.length;n--&&Ce(e,t[n],0)>-1;);return n}function Fe(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var ke=Te({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Ge=Te({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Be(t){return"\\"+jt[t]}function Ve(t){return Ft.test(t)}function ze(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function je(t,e){return function(n){return t(e(n))}}function He(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var a=t[n];a!==e&&a!==s||(t[n]=s,i[o++]=n)}return i}function Ue(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function We(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function qe(t){return Ve(t)?function(t){var e=Lt.lastIndex=0;for(;Lt.test(t);)++e;return e}(t):ve(t)}function Xe(t){return Ve(t)?function(t){return t.match(Lt)||[]}(t):function(t){return t.split("")}(t)}function Ke(t){for(var e=t.length;e--&&Y.test(t.charAt(e)););return e}var Ye=Te({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Ze=function t(e){var n=(e=null==e?Xt:Ze.defaults(Xt.Object(),e,Ze.pick(Xt,Gt))).Array,r=e.Date,o=e.Error,Y=e.Function,ht=e.Math,dt=e.Object,ft=e.RegExp,gt=e.String,mt=e.TypeError,yt=n.prototype,vt=Y.prototype,_t=dt.prototype,wt=e["__core-js_shared__"],Ct=vt.toString,bt=_t.hasOwnProperty,xt=0,Et=function(){var t=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),St=_t.toString,Tt=Ct.call(dt),Rt=Xt._,Pt=ft("^"+Ct.call(bt).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ot=Zt?e.Buffer:void 0,It=e.Symbol,At=e.Uint8Array,Lt=Ot?Ot.allocUnsafe:void 0,Ft=je(dt.getPrototypeOf,dt),jt=dt.create,Wt=_t.propertyIsEnumerable,qt=yt.splice,Kt=It?It.isConcatSpreadable:void 0,Yt=It?It.iterator:void 0,Qt=It?It.toStringTag:void 0,Jt=function(){try{var t=ti(dt,"defineProperty");return t({},"",{}),t}catch(e){}}(),ve=e.clearTimeout!==Xt.clearTimeout&&e.clearTimeout,Te=r&&r.now!==Xt.Date.now&&r.now,Qe=e.setTimeout!==Xt.setTimeout&&e.setTimeout,Je=ht.ceil,$e=ht.floor,tn=dt.getOwnPropertySymbols,en=Ot?Ot.isBuffer:void 0,nn=e.isFinite,rn=yt.join,on=je(dt.keys,dt),sn=ht.max,an=ht.min,ln=r.now,un=e.parseInt,cn=ht.random,pn=yt.reverse,hn=ti(e,"DataView"),dn=ti(e,"Map"),fn=ti(e,"Promise"),gn=ti(e,"Set"),mn=ti(e,"WeakMap"),yn=ti(dt,"create"),vn=mn&&new mn,_n={},wn=Ri(hn),Cn=Ri(dn),bn=Ri(fn),xn=Ri(gn),En=Ri(mn),Sn=It?It.prototype:void 0,Tn=Sn?Sn.valueOf:void 0,Rn=Sn?Sn.toString:void 0;function Pn(t){if(Us(t)&&!Ms(t)&&!(t instanceof Dn)){if(t instanceof An)return t;if(bt.call(t,"__wrapped__"))return Pi(t)}return new An(t)}var On=function(){function t(){}return function(e){if(!Hs(e))return{};if(jt)return jt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function In(){}function An(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Dn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Mn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ln(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Fn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Nn;++e<n;)this.add(t[e])}function kn(t){var e=this.__data__=new Ln(t);this.size=e.size}function Gn(t,e){var n=Ms(t),r=!n&&Ds(t),o=!n&&!r&&ks(t),i=!n&&!r&&!o&&Js(t),s=n||r||o||i,a=s?Oe(t.length,gt):[],l=a.length;for(var u in t)!e&&!bt.call(t,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ai(u,l))||a.push(u);return a}function Bn(t){var e=t.length;return e?t[Fr(0,e-1)]:void 0}function Vn(t,e){return Ei(vo(t),Yn(e,0,t.length))}function zn(t){return Ei(vo(t))}function jn(t,e,n){(void 0!==n&&!Os(t[e],n)||void 0===n&&!(e in t))&&Xn(t,e,n)}function Hn(t,e,n){var r=t[e];bt.call(t,e)&&Os(r,n)&&(void 0!==n||e in t)||Xn(t,e,n)}function Un(t,e){for(var n=t.length;n--;)if(Os(t[n][0],e))return n;return-1}function Wn(t,e,n,r){return tr(t,(function(t,o,i){e(r,t,n(t),i)})),r}function qn(t,e){return t&&_o(e,wa(e),t)}function Xn(t,e,n){"__proto__"==e&&Jt?Jt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Kn(t,e){for(var r=-1,o=e.length,i=n(o),s=null==t;++r<o;)i[r]=s?void 0:ga(t,e[r]);return i}function Yn(t,e,n){return t===t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Zn(t,e,n,r,o,i){var s,a=1&e,u=2&e,h=4&e;if(n&&(s=o?n(t,r,o,i):n(t)),void 0!==s)return s;if(!Hs(t))return t;var b=Ms(t);if(b){if(s=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&bt.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!a)return vo(t,s)}else{var M=ri(t),L=M==d||M==f;if(ks(t))return po(t,a);if(M==y||M==l||L&&!o){if(s=u||L?{}:ii(t),!a)return u?function(t,e){return _o(t,ni(t),e)}(t,function(t,e){return t&&_o(e,Ca(e),t)}(s,t)):function(t,e){return _o(t,ei(t),e)}(t,qn(s,t))}else{if(!zt[M])return o?t:{};s=function(t,e,n){var r=t.constructor;switch(e){case x:return ho(t);case c:case p:return new r(+t);case E:return function(t,e){var n=e?ho(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case S:case T:case R:case P:case O:case I:case"[object Uint8ClampedArray]":case A:case D:return fo(t,n);case g:return new r;case m:case w:return new r(t);case v:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case _:return new r;case C:return o=t,Tn?dt(Tn.call(o)):{}}var o}(t,M,a)}}i||(i=new kn);var N=i.get(t);if(N)return N;i.set(t,s),Ys(t)?t.forEach((function(r){s.add(Zn(r,e,n,r,t,i))})):Ws(t)&&t.forEach((function(r,o){s.set(o,Zn(r,e,n,o,t,i))}));var F=b?void 0:(h?u?Xo:qo:u?Ca:wa)(t);return ae(F||t,(function(r,o){F&&(r=t[o=r]),Hn(s,o,Zn(r,e,n,o,t,i))})),s}function Qn(t,e,n){var r=n.length;if(null==t)return!r;for(t=dt(t);r--;){var o=n[r],i=e[o],s=t[o];if(void 0===s&&!(o in t)||!i(s))return!1}return!0}function Jn(t,e,n){if("function"!=typeof t)throw new mt(i);return wi((function(){t.apply(void 0,n)}),e)}function $n(t,e,n,r){var o=-1,i=pe,s=!0,a=t.length,l=[],u=e.length;if(!a)return l;n&&(e=de(e,Ae(n))),r?(i=he,s=!1):e.length>=200&&(i=Me,s=!1,e=new Fn(e));t:for(;++o<a;){var c=t[o],p=null==n?c:n(c);if(c=r||0!==c?c:0,s&&p===p){for(var h=u;h--;)if(e[h]===p)continue t;l.push(c)}else i(e,p,r)||l.push(c)}return l}Pn.templateSettings={escape:V,evaluate:z,interpolate:j,variable:"",imports:{_:Pn}},Pn.prototype=In.prototype,Pn.prototype.constructor=Pn,An.prototype=On(In.prototype),An.prototype.constructor=An,Dn.prototype=On(In.prototype),Dn.prototype.constructor=Dn,Mn.prototype.clear=function(){this.__data__=yn?yn(null):{},this.size=0},Mn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Mn.prototype.get=function(t){var e=this.__data__;if(yn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return bt.call(e,t)?e[t]:void 0},Mn.prototype.has=function(t){var e=this.__data__;return yn?void 0!==e[t]:bt.call(e,t)},Mn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=yn&&void 0===e?"__lodash_hash_undefined__":e,this},Ln.prototype.clear=function(){this.__data__=[],this.size=0},Ln.prototype.delete=function(t){var e=this.__data__,n=Un(e,t);return!(n<0)&&(n==e.length-1?e.pop():qt.call(e,n,1),--this.size,!0)},Ln.prototype.get=function(t){var e=this.__data__,n=Un(e,t);return n<0?void 0:e[n][1]},Ln.prototype.has=function(t){return Un(this.__data__,t)>-1},Ln.prototype.set=function(t,e){var n=this.__data__,r=Un(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Nn.prototype.clear=function(){this.size=0,this.__data__={hash:new Mn,map:new(dn||Ln),string:new Mn}},Nn.prototype.delete=function(t){var e=Jo(this,t).delete(t);return this.size-=e?1:0,e},Nn.prototype.get=function(t){return Jo(this,t).get(t)},Nn.prototype.has=function(t){return Jo(this,t).has(t)},Nn.prototype.set=function(t,e){var n=Jo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Fn.prototype.add=Fn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Fn.prototype.has=function(t){return this.__data__.has(t)},kn.prototype.clear=function(){this.__data__=new Ln,this.size=0},kn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},kn.prototype.get=function(t){return this.__data__.get(t)},kn.prototype.has=function(t){return this.__data__.has(t)},kn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Ln){var r=n.__data__;if(!dn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Nn(r)}return n.set(t,e),this.size=n.size,this};var tr=bo(lr),er=bo(ur,!0);function nr(t,e){var n=!0;return tr(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function rr(t,e,n){for(var r=-1,o=t.length;++r<o;){var i=t[r],s=e(i);if(null!=s&&(void 0===a?s===s&&!Qs(s):n(s,a)))var a=s,l=i}return l}function or(t,e){var n=[];return tr(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}function ir(t,e,n,r,o){var i=-1,s=t.length;for(n||(n=si),o||(o=[]);++i<s;){var a=t[i];e>0&&n(a)?e>1?ir(a,e-1,n,r,o):fe(o,a):r||(o[o.length]=a)}return o}var sr=xo(),ar=xo(!0);function lr(t,e){return t&&sr(t,e,wa)}function ur(t,e){return t&&ar(t,e,wa)}function cr(t,e){return ce(e,(function(e){return Vs(t[e])}))}function pr(t,e){for(var n=0,r=(e=ao(e,t)).length;null!=t&&n<r;)t=t[Ti(e[n++])];return n&&n==r?t:void 0}function hr(t,e,n){var r=e(t);return Ms(t)?r:fe(r,n(t))}function dr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Qt&&Qt in dt(t)?function(t){var e=bt.call(t,Qt),n=t[Qt];try{t[Qt]=void 0;var r=!0}catch(i){}var o=St.call(t);r&&(e?t[Qt]=n:delete t[Qt]);return o}(t):function(t){return St.call(t)}(t)}function fr(t,e){return t>e}function gr(t,e){return null!=t&&bt.call(t,e)}function mr(t,e){return null!=t&&e in dt(t)}function yr(t,e,r){for(var o=r?he:pe,i=t[0].length,s=t.length,a=s,l=n(s),u=1/0,c=[];a--;){var p=t[a];a&&e&&(p=de(p,Ae(e))),u=an(p.length,u),l[a]=!r&&(e||i>=120&&p.length>=120)?new Fn(a&&p):void 0}p=t[0];var h=-1,d=l[0];t:for(;++h<i&&c.length<u;){var f=p[h],g=e?e(f):f;if(f=r||0!==f?f:0,!(d?Me(d,g):o(c,g,r))){for(a=s;--a;){var m=l[a];if(!(m?Me(m,g):o(t[a],g,r)))continue t}d&&d.push(g),c.push(f)}}return c}function vr(t,e,n){var r=null==(t=mi(t,e=ao(e,t)))?t:t[Ti(Bi(e))];return null==r?void 0:ie(r,t,n)}function _r(t){return Us(t)&&dr(t)==l}function wr(t,e,n,r,o){return t===e||(null==t||null==e||!Us(t)&&!Us(e)?t!==t&&e!==e:function(t,e,n,r,o,i){var s=Ms(t),a=Ms(e),d=s?u:ri(t),f=a?u:ri(e),b=(d=d==l?y:d)==y,S=(f=f==l?y:f)==y,T=d==f;if(T&&ks(t)){if(!ks(e))return!1;s=!0,b=!1}if(T&&!b)return i||(i=new kn),s||Js(t)?Uo(t,e,n,r,o,i):function(t,e,n,r,o,i,s){switch(n){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!i(new At(t),new At(e)));case c:case p:case m:return Os(+t,+e);case h:return t.name==e.name&&t.message==e.message;case v:case w:return t==e+"";case g:var a=ze;case _:var l=1&r;if(a||(a=Ue),t.size!=e.size&&!l)return!1;var u=s.get(t);if(u)return u==e;r|=2,s.set(t,e);var d=Uo(a(t),a(e),r,o,i,s);return s.delete(t),d;case C:if(Tn)return Tn.call(t)==Tn.call(e)}return!1}(t,e,d,n,r,o,i);if(!(1&n)){var R=b&&bt.call(t,"__wrapped__"),P=S&&bt.call(e,"__wrapped__");if(R||P){var O=R?t.value():t,I=P?e.value():e;return i||(i=new kn),o(O,I,n,r,i)}}if(!T)return!1;return i||(i=new kn),function(t,e,n,r,o,i){var s=1&n,a=qo(t),l=a.length,u=qo(e).length;if(l!=u&&!s)return!1;var c=l;for(;c--;){var p=a[c];if(!(s?p in e:bt.call(e,p)))return!1}var h=i.get(t),d=i.get(e);if(h&&d)return h==e&&d==t;var f=!0;i.set(t,e),i.set(e,t);var g=s;for(;++c<l;){p=a[c];var m=t[p],y=e[p];if(r)var v=s?r(y,m,p,e,t,i):r(m,y,p,t,e,i);if(!(void 0===v?m===y||o(m,y,n,r,i):v)){f=!1;break}g||(g="constructor"==p)}if(f&&!g){var _=t.constructor,w=e.constructor;_==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(f=!1)}return i.delete(t),i.delete(e),f}(t,e,n,r,o,i)}(t,e,n,r,wr,o))}function Cr(t,e,n,r){var o=n.length,i=o,s=!r;if(null==t)return!i;for(t=dt(t);o--;){var a=n[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var l=(a=n[o])[0],u=t[l],c=a[1];if(s&&a[2]){if(void 0===u&&!(l in t))return!1}else{var p=new kn;if(r)var h=r(u,c,l,t,e,p);if(!(void 0===h?wr(c,u,3,r,p):h))return!1}}return!0}function br(t){return!(!Hs(t)||(e=t,Et&&Et in e))&&(Vs(t)?Pt:st).test(Ri(t));var e}function xr(t){return"function"==typeof t?t:null==t?qa:"object"==typeof t?Ms(t)?Or(t[0],t[1]):Pr(t):el(t)}function Er(t){if(!hi(t))return on(t);var e=[];for(var n in dt(t))bt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Sr(t){if(!Hs(t))return function(t){var e=[];if(null!=t)for(var n in dt(t))e.push(n);return e}(t);var e=hi(t),n=[];for(var r in t)("constructor"!=r||!e&&bt.call(t,r))&&n.push(r);return n}function Tr(t,e){return t<e}function Rr(t,e){var r=-1,o=Ns(t)?n(t.length):[];return tr(t,(function(t,n,i){o[++r]=e(t,n,i)})),o}function Pr(t){var e=$o(t);return 1==e.length&&e[0][2]?fi(e[0][0],e[0][1]):function(n){return n===t||Cr(n,t,e)}}function Or(t,e){return ui(t)&&di(e)?fi(Ti(t),e):function(n){var r=ga(n,t);return void 0===r&&r===e?ma(n,t):wr(e,r,3)}}function Ir(t,e,n,r,o){t!==e&&sr(e,(function(i,s){if(o||(o=new kn),Hs(i))!function(t,e,n,r,o,i,s){var a=vi(t,n),l=vi(e,n),u=s.get(l);if(u)return void jn(t,n,u);var c=i?i(a,l,n+"",t,e,s):void 0,p=void 0===c;if(p){var h=Ms(l),d=!h&&ks(l),f=!h&&!d&&Js(l);c=l,h||d||f?Ms(a)?c=a:Fs(a)?c=vo(a):d?(p=!1,c=po(l,!0)):f?(p=!1,c=fo(l,!0)):c=[]:Xs(l)||Ds(l)?(c=a,Ds(a)?c=sa(a):Hs(a)&&!Vs(a)||(c=ii(l))):p=!1}p&&(s.set(l,c),o(c,l,r,i,s),s.delete(l));jn(t,n,c)}(t,e,s,n,Ir,r,o);else{var a=r?r(vi(t,s),i,s+"",t,e,o):void 0;void 0===a&&(a=i),jn(t,s,a)}}),Ca)}function Ar(t,e){var n=t.length;if(n)return ai(e+=e<0?n:0,n)?t[e]:void 0}function Dr(t,e,n){e=e.length?de(e,(function(t){return Ms(t)?function(e){return pr(e,1===t.length?t[0]:t)}:t})):[qa];var r=-1;return e=de(e,Ae(Qo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Rr(t,(function(t,n,o){return{criteria:de(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,o=t.criteria,i=e.criteria,s=o.length,a=n.length;for(;++r<s;){var l=go(o[r],i[r]);if(l){if(r>=a)return l;var u=n[r];return l*("desc"==u?-1:1)}}return t.index-e.index}(t,e,n)}))}function Mr(t,e,n){for(var r=-1,o=e.length,i={};++r<o;){var s=e[r],a=pr(t,s);n(a,s)&&zr(i,ao(s,t),a)}return i}function Lr(t,e,n,r){var o=r?be:Ce,i=-1,s=e.length,a=t;for(t===e&&(e=vo(e)),n&&(a=de(t,Ae(n)));++i<s;)for(var l=0,u=e[i],c=n?n(u):u;(l=o(a,c,l,r))>-1;)a!==t&&qt.call(a,l,1),qt.call(t,l,1);return t}function Nr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==i){var i=o;ai(o)?qt.call(t,o,1):$r(t,o)}}return t}function Fr(t,e){return t+$e(cn()*(e-t+1))}function kr(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=$e(e/2))&&(t+=t)}while(e);return n}function Gr(t,e){return Ci(gi(t,e,qa),t+"")}function Br(t){return Bn(Oa(t))}function Vr(t,e){var n=Oa(t);return Ei(n,Yn(e,0,n.length))}function zr(t,e,n,r){if(!Hs(t))return t;for(var o=-1,i=(e=ao(e,t)).length,s=i-1,a=t;null!=a&&++o<i;){var l=Ti(e[o]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(o!=s){var c=a[l];void 0===(u=r?r(c,l,a):void 0)&&(u=Hs(c)?c:ai(e[o+1])?[]:{})}Hn(a,l,u),a=a[l]}return t}var jr=vn?function(t,e){return vn.set(t,e),t}:qa,Hr=Jt?function(t,e){return Jt(t,"toString",{configurable:!0,enumerable:!1,value:Ha(e),writable:!0})}:qa;function Ur(t){return Ei(Oa(t))}function Wr(t,e,r){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=n(i);++o<i;)s[o]=t[o+e];return s}function qr(t,e){var n;return tr(t,(function(t,r,o){return!(n=e(t,r,o))})),!!n}function Xr(t,e,n){var r=0,o=null==t?r:t.length;if("number"==typeof e&&e===e&&o<=2147483647){for(;r<o;){var i=r+o>>>1,s=t[i];null!==s&&!Qs(s)&&(n?s<=e:s<e)?r=i+1:o=i}return o}return Kr(t,e,qa,n)}function Kr(t,e,n,r){var o=0,i=null==t?0:t.length;if(0===i)return 0;for(var s=(e=n(e))!==e,a=null===e,l=Qs(e),u=void 0===e;o<i;){var c=$e((o+i)/2),p=n(t[c]),h=void 0!==p,d=null===p,f=p===p,g=Qs(p);if(s)var m=r||f;else m=u?f&&(r||h):a?f&&h&&(r||!d):l?f&&h&&!d&&(r||!g):!d&&!g&&(r?p<=e:p<e);m?o=c+1:i=c}return an(i,4294967294)}function Yr(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!Os(a,l)){var l=a;i[o++]=0===s?0:s}}return i}function Zr(t){return"number"==typeof t?t:Qs(t)?NaN:+t}function Qr(t){if("string"==typeof t)return t;if(Ms(t))return de(t,Qr)+"";if(Qs(t))return Rn?Rn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Jr(t,e,n){var r=-1,o=pe,i=t.length,s=!0,a=[],l=a;if(n)s=!1,o=he;else if(i>=200){var u=e?null:Go(t);if(u)return Ue(u);s=!1,o=Me,l=new Fn}else l=e?[]:a;t:for(;++r<i;){var c=t[r],p=e?e(c):c;if(c=n||0!==c?c:0,s&&p===p){for(var h=l.length;h--;)if(l[h]===p)continue t;e&&l.push(p),a.push(c)}else o(l,p,n)||(l!==a&&l.push(p),a.push(c))}return a}function $r(t,e){return null==(t=mi(t,e=ao(e,t)))||delete t[Ti(Bi(e))]}function to(t,e,n,r){return zr(t,e,n(pr(t,e)),r)}function eo(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?Wr(t,r?0:i,r?i+1:o):Wr(t,r?i+1:0,r?o:i)}function no(t,e){var n=t;return n instanceof Dn&&(n=n.value()),ge(e,(function(t,e){return e.func.apply(e.thisArg,fe([t],e.args))}),n)}function ro(t,e,r){var o=t.length;if(o<2)return o?Jr(t[0]):[];for(var i=-1,s=n(o);++i<o;)for(var a=t[i],l=-1;++l<o;)l!=i&&(s[i]=$n(s[i]||a,t[l],e,r));return Jr(ir(s,1),e,r)}function oo(t,e,n){for(var r=-1,o=t.length,i=e.length,s={};++r<o;){var a=r<i?e[r]:void 0;n(s,t[r],a)}return s}function io(t){return Fs(t)?t:[]}function so(t){return"function"==typeof t?t:qa}function ao(t,e){return Ms(t)?t:ui(t,e)?[t]:Si(aa(t))}var lo=Gr;function uo(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:Wr(t,e,n)}var co=ve||function(t){return Xt.clearTimeout(t)};function po(t,e){if(e)return t.slice();var n=t.length,r=Lt?Lt(n):new t.constructor(n);return t.copy(r),r}function ho(t){var e=new t.constructor(t.byteLength);return new At(e).set(new At(t)),e}function fo(t,e){var n=e?ho(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function go(t,e){if(t!==e){var n=void 0!==t,r=null===t,o=t===t,i=Qs(t),s=void 0!==e,a=null===e,l=e===e,u=Qs(e);if(!a&&!u&&!i&&t>e||i&&s&&l&&!a&&!u||r&&s&&l||!n&&l||!o)return 1;if(!r&&!i&&!u&&t<e||u&&n&&o&&!r&&!i||a&&n&&o||!s&&o||!l)return-1}return 0}function mo(t,e,r,o){for(var i=-1,s=t.length,a=r.length,l=-1,u=e.length,c=sn(s-a,0),p=n(u+c),h=!o;++l<u;)p[l]=e[l];for(;++i<a;)(h||i<s)&&(p[r[i]]=t[i]);for(;c--;)p[l++]=t[i++];return p}function yo(t,e,r,o){for(var i=-1,s=t.length,a=-1,l=r.length,u=-1,c=e.length,p=sn(s-l,0),h=n(p+c),d=!o;++i<p;)h[i]=t[i];for(var f=i;++u<c;)h[f+u]=e[u];for(;++a<l;)(d||i<s)&&(h[f+r[a]]=t[i++]);return h}function vo(t,e){var r=-1,o=t.length;for(e||(e=n(o));++r<o;)e[r]=t[r];return e}function _o(t,e,n,r){var o=!n;n||(n={});for(var i=-1,s=e.length;++i<s;){var a=e[i],l=r?r(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),o?Xn(n,a,l):Hn(n,a,l)}return n}function wo(t,e){return function(n,r){var o=Ms(n)?se:Wn,i=e?e():{};return o(n,t,Qo(r,2),i)}}function Co(t){return Gr((function(e,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,s&&li(n[0],n[1],s)&&(i=o<3?void 0:i,o=1),e=dt(e);++r<o;){var a=n[r];a&&t(e,a,r,i)}return e}))}function bo(t,e){return function(n,r){if(null==n)return n;if(!Ns(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=dt(n);(e?i--:++i<o)&&!1!==r(s[i],i,s););return n}}function xo(t){return function(e,n,r){for(var o=-1,i=dt(e),s=r(e),a=s.length;a--;){var l=s[t?a:++o];if(!1===n(i[l],l,i))break}return e}}function Eo(t){return function(e){var n=Ve(e=aa(e))?Xe(e):void 0,r=n?n[0]:e.charAt(0),o=n?uo(n,1).join(""):e.slice(1);return r[t]()+o}}function So(t){return function(e){return ge(Va(Da(e).replace(Dt,"")),t,"")}}function To(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=On(t.prototype),r=t.apply(n,e);return Hs(r)?r:n}}function Ro(t){return function(e,n,r){var o=dt(e);if(!Ns(e)){var i=Qo(n,3);e=wa(e),n=function(t){return i(o[t],t,o)}}var s=t(e,n,r);return s>-1?o[i?e[s]:s]:void 0}}function Po(t){return Wo((function(e){var n=e.length,r=n,o=An.prototype.thru;for(t&&e.reverse();r--;){var s=e[r];if("function"!=typeof s)throw new mt(i);if(o&&!a&&"wrapper"==Yo(s))var a=new An([],!0)}for(r=a?r:n;++r<n;){var l=Yo(s=e[r]),u="wrapper"==l?Ko(s):void 0;a=u&&ci(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?a[Yo(u[0])].apply(a,u[3]):1==s.length&&ci(s)?a[l]():a.thru(s)}return function(){var t=arguments,r=t[0];if(a&&1==t.length&&Ms(r))return a.plant(r).value();for(var o=0,i=n?e[o].apply(this,t):r;++o<n;)i=e[o].call(this,i);return i}}))}function Oo(t,e,r,o,i,s,a,l,u,c){var p=128&e,h=1&e,d=2&e,f=24&e,g=512&e,m=d?void 0:To(t);return function y(){for(var v=arguments.length,_=n(v),w=v;w--;)_[w]=arguments[w];if(f)var C=Zo(y),b=Fe(_,C);if(o&&(_=mo(_,o,i,f)),s&&(_=yo(_,s,a,f)),v-=b,f&&v<c){var x=He(_,C);return Fo(t,e,Oo,y.placeholder,r,_,x,l,u,c-v)}var E=h?r:this,S=d?E[t]:t;return v=_.length,l?_=yi(_,l):g&&v>1&&_.reverse(),p&&u<v&&(_.length=u),this&&this!==Xt&&this instanceof y&&(S=m||To(S)),S.apply(E,_)}}function Io(t,e){return function(n,r){return function(t,e,n,r){return lr(t,(function(t,o,i){e(r,n(t),o,i)})),r}(n,t,e(r),{})}}function Ao(t,e){return function(n,r){var o;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(o=n),void 0!==r){if(void 0===o)return r;"string"==typeof n||"string"==typeof r?(n=Qr(n),r=Qr(r)):(n=Zr(n),r=Zr(r)),o=t(n,r)}return o}}function Do(t){return Wo((function(e){return e=de(e,Ae(Qo())),Gr((function(n){var r=this;return t(e,(function(t){return ie(t,r,n)}))}))}))}function Mo(t,e){var n=(e=void 0===e?" ":Qr(e)).length;if(n<2)return n?kr(e,t):e;var r=kr(e,Je(t/qe(e)));return Ve(e)?uo(Xe(r),0,t).join(""):r.slice(0,t)}function Lo(t){return function(e,r,o){return o&&"number"!=typeof o&&li(e,r,o)&&(r=o=void 0),e=na(e),void 0===r?(r=e,e=0):r=na(r),function(t,e,r,o){for(var i=-1,s=sn(Je((e-t)/(r||1)),0),a=n(s);s--;)a[o?s:++i]=t,t+=r;return a}(e,r,o=void 0===o?e<r?1:-1:na(o),t)}}function No(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ia(e),n=ia(n)),t(e,n)}}function Fo(t,e,n,r,o,i,s,a,l,u){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var p=[t,e,o,c?i:void 0,c?s:void 0,c?void 0:i,c?void 0:s,a,l,u],h=n.apply(void 0,p);return ci(t)&&_i(h,p),h.placeholder=r,bi(h,t,e)}function ko(t){var e=ht[t];return function(t,n){if(t=ia(t),(n=null==n?0:an(ra(n),292))&&nn(t)){var r=(aa(t)+"e").split("e");return+((r=(aa(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Go=gn&&1/Ue(new gn([,-0]))[1]==1/0?function(t){return new gn(t)}:Qa;function Bo(t){return function(e){var n=ri(e);return n==g?ze(e):n==_?We(e):function(t,e){return de(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Vo(t,e,r,o,a,l,u,c){var p=2&e;if(!p&&"function"!=typeof t)throw new mt(i);var h=o?o.length:0;if(h||(e&=-97,o=a=void 0),u=void 0===u?u:sn(ra(u),0),c=void 0===c?c:ra(c),h-=a?a.length:0,64&e){var d=o,f=a;o=a=void 0}var g=p?void 0:Ko(t),m=[t,e,r,o,a,d,f,l,u,c];if(g&&function(t,e){var n=t[1],r=e[1],o=n|r,i=o<131,a=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!i&&!a)return t;1&r&&(t[2]=e[2],o|=1&n?0:4);var l=e[3];if(l){var u=t[3];t[3]=u?mo(u,l,e[4]):l,t[4]=u?He(t[3],s):e[4]}(l=e[5])&&(u=t[5],t[5]=u?yo(u,l,e[6]):l,t[6]=u?He(t[5],s):e[6]);(l=e[7])&&(t[7]=l);128&r&&(t[8]=null==t[8]?e[8]:an(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=o}(m,g),t=m[0],e=m[1],r=m[2],o=m[3],a=m[4],!(c=m[9]=void 0===m[9]?p?0:t.length:sn(m[9]-h,0))&&24&e&&(e&=-25),e&&1!=e)y=8==e||16==e?function(t,e,r){var o=To(t);return function i(){for(var s=arguments.length,a=n(s),l=s,u=Zo(i);l--;)a[l]=arguments[l];var c=s<3&&a[0]!==u&&a[s-1]!==u?[]:He(a,u);if((s-=c.length)<r)return Fo(t,e,Oo,i.placeholder,void 0,a,c,void 0,void 0,r-s);var p=this&&this!==Xt&&this instanceof i?o:t;return ie(p,this,a)}}(t,e,c):32!=e&&33!=e||a.length?Oo.apply(void 0,m):function(t,e,r,o){var i=1&e,s=To(t);return function e(){for(var a=-1,l=arguments.length,u=-1,c=o.length,p=n(c+l),h=this&&this!==Xt&&this instanceof e?s:t;++u<c;)p[u]=o[u];for(;l--;)p[u++]=arguments[++a];return ie(h,i?r:this,p)}}(t,e,r,o);else var y=function(t,e,n){var r=1&e,o=To(t);return function e(){var i=this&&this!==Xt&&this instanceof e?o:t;return i.apply(r?n:this,arguments)}}(t,e,r);return bi((g?jr:_i)(y,m),t,e)}function zo(t,e,n,r){return void 0===t||Os(t,_t[n])&&!bt.call(r,n)?e:t}function jo(t,e,n,r,o,i){return Hs(t)&&Hs(e)&&(i.set(e,t),Ir(t,e,void 0,jo,i),i.delete(e)),t}function Ho(t){return Xs(t)?void 0:t}function Uo(t,e,n,r,o,i){var s=1&n,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var u=i.get(t),c=i.get(e);if(u&&c)return u==e&&c==t;var p=-1,h=!0,d=2&n?new Fn:void 0;for(i.set(t,e),i.set(e,t);++p<a;){var f=t[p],g=e[p];if(r)var m=s?r(g,f,p,e,t,i):r(f,g,p,t,e,i);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!ye(e,(function(t,e){if(!Me(d,e)&&(f===t||o(f,t,n,r,i)))return d.push(e)}))){h=!1;break}}else if(f!==g&&!o(f,g,n,r,i)){h=!1;break}}return i.delete(t),i.delete(e),h}function Wo(t){return Ci(gi(t,void 0,Li),t+"")}function qo(t){return hr(t,wa,ei)}function Xo(t){return hr(t,Ca,ni)}var Ko=vn?function(t){return vn.get(t)}:Qa;function Yo(t){for(var e=t.name+"",n=_n[e],r=bt.call(_n,e)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==t)return o.name}return e}function Zo(t){return(bt.call(Pn,"placeholder")?Pn:t).placeholder}function Qo(){var t=Pn.iteratee||Xa;return t=t===Xa?xr:t,arguments.length?t(arguments[0],arguments[1]):t}function Jo(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function $o(t){for(var e=wa(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,di(o)]}return e}function ti(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return br(n)?n:void 0}var ei=tn?function(t){return null==t?[]:(t=dt(t),ce(tn(t),(function(e){return Wt.call(t,e)})))}:ol,ni=tn?function(t){for(var e=[];t;)fe(e,ei(t)),t=Ft(t);return e}:ol,ri=dr;function oi(t,e,n){for(var r=-1,o=(e=ao(e,t)).length,i=!1;++r<o;){var s=Ti(e[r]);if(!(i=null!=t&&n(t,s)))break;t=t[s]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&js(o)&&ai(s,o)&&(Ms(t)||Ds(t))}function ii(t){return"function"!=typeof t.constructor||hi(t)?{}:On(Ft(t))}function si(t){return Ms(t)||Ds(t)||!!(Kt&&t&&t[Kt])}function ai(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&lt.test(t))&&t>-1&&t%1==0&&t<e}function li(t,e,n){if(!Hs(n))return!1;var r=typeof e;return!!("number"==r?Ns(n)&&ai(e,n.length):"string"==r&&e in n)&&Os(n[e],t)}function ui(t,e){if(Ms(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Qs(t))||(U.test(t)||!H.test(t)||null!=e&&t in dt(e))}function ci(t){var e=Yo(t),n=Pn[e];if("function"!=typeof n||!(e in Dn.prototype))return!1;if(t===n)return!0;var r=Ko(n);return!!r&&t===r[0]}(hn&&ri(new hn(new ArrayBuffer(1)))!=E||dn&&ri(new dn)!=g||fn&&"[object Promise]"!=ri(fn.resolve())||gn&&ri(new gn)!=_||mn&&ri(new mn)!=b)&&(ri=function(t){var e=dr(t),n=e==y?t.constructor:void 0,r=n?Ri(n):"";if(r)switch(r){case wn:return E;case Cn:return g;case bn:return"[object Promise]";case xn:return _;case En:return b}return e});var pi=wt?Vs:il;function hi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||_t)}function di(t){return t===t&&!Hs(t)}function fi(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in dt(n)))}}function gi(t,e,r){return e=sn(void 0===e?t.length-1:e,0),function(){for(var o=arguments,i=-1,s=sn(o.length-e,0),a=n(s);++i<s;)a[i]=o[e+i];i=-1;for(var l=n(e+1);++i<e;)l[i]=o[i];return l[e]=r(a),ie(t,this,l)}}function mi(t,e){return e.length<2?t:pr(t,Wr(e,0,-1))}function yi(t,e){for(var n=t.length,r=an(e.length,n),o=vo(t);r--;){var i=e[r];t[r]=ai(i,n)?o[i]:void 0}return t}function vi(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}var _i=xi(jr),wi=Qe||function(t,e){return Xt.setTimeout(t,e)},Ci=xi(Hr);function bi(t,e,n){var r=e+"";return Ci(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Z,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return ae(a,(function(n){var r="_."+n[0];e&n[1]&&!pe(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(Q);return e?e[1].split(J):[]}(r),n)))}function xi(t){var e=0,n=0;return function(){var r=ln(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Ei(t,e){var n=-1,r=t.length,o=r-1;for(e=void 0===e?r:e;++n<e;){var i=Fr(n,o),s=t[i];t[i]=t[n],t[n]=s}return t.length=e,t}var Si=function(t){var e=xs(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(W,(function(t,n,r,o){e.push(r?o.replace(et,"$1"):n||t)})),e}));function Ti(t){if("string"==typeof t||Qs(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ri(t){if(null!=t){try{return Ct.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Pi(t){if(t instanceof Dn)return t.clone();var e=new An(t.__wrapped__,t.__chain__);return e.__actions__=vo(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Oi=Gr((function(t,e){return Fs(t)?$n(t,ir(e,1,Fs,!0)):[]})),Ii=Gr((function(t,e){var n=Bi(e);return Fs(n)&&(n=void 0),Fs(t)?$n(t,ir(e,1,Fs,!0),Qo(n,2)):[]})),Ai=Gr((function(t,e){var n=Bi(e);return Fs(n)&&(n=void 0),Fs(t)?$n(t,ir(e,1,Fs,!0),void 0,n):[]}));function Di(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ra(n);return o<0&&(o=sn(r+o,0)),we(t,Qo(e,3),o)}function Mi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return void 0!==n&&(o=ra(n),o=n<0?sn(r+o,0):an(o,r-1)),we(t,Qo(e,3),o,!0)}function Li(t){return(null==t?0:t.length)?ir(t,1):[]}function Ni(t){return t&&t.length?t[0]:void 0}var Fi=Gr((function(t){var e=de(t,io);return e.length&&e[0]===t[0]?yr(e):[]})),ki=Gr((function(t){var e=Bi(t),n=de(t,io);return e===Bi(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?yr(n,Qo(e,2)):[]})),Gi=Gr((function(t){var e=Bi(t),n=de(t,io);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?yr(n,void 0,e):[]}));function Bi(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Vi=Gr(zi);function zi(t,e){return t&&t.length&&e&&e.length?Lr(t,e):t}var ji=Wo((function(t,e){var n=null==t?0:t.length,r=Kn(t,e);return Nr(t,de(e,(function(t){return ai(t,n)?+t:t})).sort(go)),r}));function Hi(t){return null==t?t:pn.call(t)}var Ui=Gr((function(t){return Jr(ir(t,1,Fs,!0))})),Wi=Gr((function(t){var e=Bi(t);return Fs(e)&&(e=void 0),Jr(ir(t,1,Fs,!0),Qo(e,2))})),qi=Gr((function(t){var e=Bi(t);return e="function"==typeof e?e:void 0,Jr(ir(t,1,Fs,!0),void 0,e)}));function Xi(t){if(!t||!t.length)return[];var e=0;return t=ce(t,(function(t){if(Fs(t))return e=sn(t.length,e),!0})),Oe(e,(function(e){return de(t,Se(e))}))}function Ki(t,e){if(!t||!t.length)return[];var n=Xi(t);return null==e?n:de(n,(function(t){return ie(e,void 0,t)}))}var Yi=Gr((function(t,e){return Fs(t)?$n(t,e):[]})),Zi=Gr((function(t){return ro(ce(t,Fs))})),Qi=Gr((function(t){var e=Bi(t);return Fs(e)&&(e=void 0),ro(ce(t,Fs),Qo(e,2))})),Ji=Gr((function(t){var e=Bi(t);return e="function"==typeof e?e:void 0,ro(ce(t,Fs),void 0,e)})),$i=Gr(Xi);var ts=Gr((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,Ki(t,n)}));function es(t){var e=Pn(t);return e.__chain__=!0,e}function ns(t,e){return e(t)}var rs=Wo((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return Kn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Dn&&ai(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:ns,args:[o],thisArg:void 0}),new An(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(o)}));var os=wo((function(t,e,n){bt.call(t,n)?++t[n]:Xn(t,n,1)}));var is=Ro(Di),ss=Ro(Mi);function as(t,e){return(Ms(t)?ae:tr)(t,Qo(e,3))}function ls(t,e){return(Ms(t)?le:er)(t,Qo(e,3))}var us=wo((function(t,e,n){bt.call(t,n)?t[n].push(e):Xn(t,n,[e])}));var cs=Gr((function(t,e,r){var o=-1,i="function"==typeof e,s=Ns(t)?n(t.length):[];return tr(t,(function(t){s[++o]=i?ie(e,t,r):vr(t,e,r)})),s})),ps=wo((function(t,e,n){Xn(t,n,e)}));function hs(t,e){return(Ms(t)?de:Rr)(t,Qo(e,3))}var ds=wo((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var fs=Gr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&li(t,e[0],e[1])?e=[]:n>2&&li(e[0],e[1],e[2])&&(e=[e[0]]),Dr(t,ir(e,1),[])})),gs=Te||function(){return Xt.Date.now()};function ms(t,e,n){return e=n?void 0:e,Vo(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function ys(t,e){var n;if("function"!=typeof e)throw new mt(i);return t=ra(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var vs=Gr((function(t,e,n){var r=1;if(n.length){var o=He(n,Zo(vs));r|=32}return Vo(t,r,e,n,o)})),_s=Gr((function(t,e,n){var r=3;if(n.length){var o=He(n,Zo(_s));r|=32}return Vo(e,r,t,n,o)}));function ws(t,e,n){var r,o,s,a,l,u,c=0,p=!1,h=!1,d=!0;if("function"!=typeof t)throw new mt(i);function f(e){var n=r,i=o;return r=o=void 0,c=e,a=t.apply(i,n)}function g(t){return c=t,l=wi(y,e),p?f(t):a}function m(t){var n=t-u;return void 0===u||n>=e||n<0||h&&t-c>=s}function y(){var t=gs();if(m(t))return v(t);l=wi(y,function(t){var n=e-(t-u);return h?an(n,s-(t-c)):n}(t))}function v(t){return l=void 0,d&&r?f(t):(r=o=void 0,a)}function _(){var t=gs(),n=m(t);if(r=arguments,o=this,u=t,n){if(void 0===l)return g(u);if(h)return co(l),l=wi(y,e),f(u)}return void 0===l&&(l=wi(y,e)),a}return e=ia(e)||0,Hs(n)&&(p=!!n.leading,s=(h="maxWait"in n)?sn(ia(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d),_.cancel=function(){void 0!==l&&co(l),c=0,r=u=o=l=void 0},_.flush=function(){return void 0===l?a:v(gs())},_}var Cs=Gr((function(t,e){return Jn(t,1,e)})),bs=Gr((function(t,e,n){return Jn(t,ia(e)||0,n)}));function xs(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new mt(i);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(xs.Cache||Nn),n}function Es(t){if("function"!=typeof t)throw new mt(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}xs.Cache=Nn;var Ss=lo((function(t,e){var n=(e=1==e.length&&Ms(e[0])?de(e[0],Ae(Qo())):de(ir(e,1),Ae(Qo()))).length;return Gr((function(r){for(var o=-1,i=an(r.length,n);++o<i;)r[o]=e[o].call(this,r[o]);return ie(t,this,r)}))})),Ts=Gr((function(t,e){return Vo(t,32,void 0,e,He(e,Zo(Ts)))})),Rs=Gr((function(t,e){return Vo(t,64,void 0,e,He(e,Zo(Rs)))})),Ps=Wo((function(t,e){return Vo(t,256,void 0,void 0,void 0,e)}));function Os(t,e){return t===e||t!==t&&e!==e}var Is=No(fr),As=No((function(t,e){return t>=e})),Ds=_r(function(){return arguments}())?_r:function(t){return Us(t)&&bt.call(t,"callee")&&!Wt.call(t,"callee")},Ms=n.isArray,Ls=$t?Ae($t):function(t){return Us(t)&&dr(t)==x};function Ns(t){return null!=t&&js(t.length)&&!Vs(t)}function Fs(t){return Us(t)&&Ns(t)}var ks=en||il,Gs=te?Ae(te):function(t){return Us(t)&&dr(t)==p};function Bs(t){if(!Us(t))return!1;var e=dr(t);return e==h||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Xs(t)}function Vs(t){if(!Hs(t))return!1;var e=dr(t);return e==d||e==f||"[object AsyncFunction]"==e||"[object Proxy]"==e}function zs(t){return"number"==typeof t&&t==ra(t)}function js(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Hs(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Us(t){return null!=t&&"object"==typeof t}var Ws=ee?Ae(ee):function(t){return Us(t)&&ri(t)==g};function qs(t){return"number"==typeof t||Us(t)&&dr(t)==m}function Xs(t){if(!Us(t)||dr(t)!=y)return!1;var e=Ft(t);if(null===e)return!0;var n=bt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ct.call(n)==Tt}var Ks=ne?Ae(ne):function(t){return Us(t)&&dr(t)==v};var Ys=re?Ae(re):function(t){return Us(t)&&ri(t)==_};function Zs(t){return"string"==typeof t||!Ms(t)&&Us(t)&&dr(t)==w}function Qs(t){return"symbol"==typeof t||Us(t)&&dr(t)==C}var Js=oe?Ae(oe):function(t){return Us(t)&&js(t.length)&&!!Vt[dr(t)]};var $s=No(Tr),ta=No((function(t,e){return t<=e}));function ea(t){if(!t)return[];if(Ns(t))return Zs(t)?Xe(t):vo(t);if(Yt&&t[Yt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Yt]());var e=ri(t);return(e==g?ze:e==_?Ue:Oa)(t)}function na(t){return t?(t=ia(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t===t?t:0:0===t?t:0}function ra(t){var e=na(t),n=e%1;return e===e?n?e-n:e:0}function oa(t){return t?Yn(ra(t),0,4294967295):0}function ia(t){if("number"==typeof t)return t;if(Qs(t))return NaN;if(Hs(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Hs(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ie(t);var n=it.test(t);return n||at.test(t)?Ut(t.slice(2),n?2:8):ot.test(t)?NaN:+t}function sa(t){return _o(t,Ca(t))}function aa(t){return null==t?"":Qr(t)}var la=Co((function(t,e){if(hi(e)||Ns(e))_o(e,wa(e),t);else for(var n in e)bt.call(e,n)&&Hn(t,n,e[n])})),ua=Co((function(t,e){_o(e,Ca(e),t)})),ca=Co((function(t,e,n,r){_o(e,Ca(e),t,r)})),pa=Co((function(t,e,n,r){_o(e,wa(e),t,r)})),ha=Wo(Kn);var da=Gr((function(t,e){t=dt(t);var n=-1,r=e.length,o=r>2?e[2]:void 0;for(o&&li(e[0],e[1],o)&&(r=1);++n<r;)for(var i=e[n],s=Ca(i),a=-1,l=s.length;++a<l;){var u=s[a],c=t[u];(void 0===c||Os(c,_t[u])&&!bt.call(t,u))&&(t[u]=i[u])}return t})),fa=Gr((function(t){return t.push(void 0,jo),ie(xa,void 0,t)}));function ga(t,e,n){var r=null==t?void 0:pr(t,e);return void 0===r?n:r}function ma(t,e){return null!=t&&oi(t,e,mr)}var ya=Io((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=St.call(e)),t[e]=n}),Ha(qa)),va=Io((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=St.call(e)),bt.call(t,e)?t[e].push(n):t[e]=[n]}),Qo),_a=Gr(vr);function wa(t){return Ns(t)?Gn(t):Er(t)}function Ca(t){return Ns(t)?Gn(t,!0):Sr(t)}var ba=Co((function(t,e,n){Ir(t,e,n)})),xa=Co((function(t,e,n,r){Ir(t,e,n,r)})),Ea=Wo((function(t,e){var n={};if(null==t)return n;var r=!1;e=de(e,(function(e){return e=ao(e,t),r||(r=e.length>1),e})),_o(t,Xo(t),n),r&&(n=Zn(n,7,Ho));for(var o=e.length;o--;)$r(n,e[o]);return n}));var Sa=Wo((function(t,e){return null==t?{}:function(t,e){return Mr(t,e,(function(e,n){return ma(t,n)}))}(t,e)}));function Ta(t,e){if(null==t)return{};var n=de(Xo(t),(function(t){return[t]}));return e=Qo(e),Mr(t,n,(function(t,n){return e(t,n[0])}))}var Ra=Bo(wa),Pa=Bo(Ca);function Oa(t){return null==t?[]:De(t,wa(t))}var Ia=So((function(t,e,n){return e=e.toLowerCase(),t+(n?Aa(e):e)}));function Aa(t){return Ba(aa(t).toLowerCase())}function Da(t){return(t=aa(t))&&t.replace(ut,ke).replace(Mt,"")}var Ma=So((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),La=So((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Na=Eo("toLowerCase");var Fa=So((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var ka=So((function(t,e,n){return t+(n?" ":"")+Ba(e)}));var Ga=So((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ba=Eo("toUpperCase");function Va(t,e,n){return t=aa(t),void 0===(e=n?void 0:e)?function(t){return kt.test(t)}(t)?function(t){return t.match(Nt)||[]}(t):function(t){return t.match($)||[]}(t):t.match(e)||[]}var za=Gr((function(t,e){try{return ie(t,void 0,e)}catch(n){return Bs(n)?n:new o(n)}})),ja=Wo((function(t,e){return ae(e,(function(e){e=Ti(e),Xn(t,e,vs(t[e],t))})),t}));function Ha(t){return function(){return t}}var Ua=Po(),Wa=Po(!0);function qa(t){return t}function Xa(t){return xr("function"==typeof t?t:Zn(t,1))}var Ka=Gr((function(t,e){return function(n){return vr(n,t,e)}})),Ya=Gr((function(t,e){return function(n){return vr(t,n,e)}}));function Za(t,e,n){var r=wa(e),o=cr(e,r);null!=n||Hs(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=cr(e,wa(e)));var i=!(Hs(n)&&"chain"in n)||!!n.chain,s=Vs(t);return ae(o,(function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),o=n.__actions__=vo(this.__actions__);return o.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,fe([this.value()],arguments))})})),t}function Qa(){}var Ja=Do(de),$a=Do(ue),tl=Do(ye);function el(t){return ui(t)?Se(Ti(t)):function(t){return function(e){return pr(e,t)}}(t)}var nl=Lo(),rl=Lo(!0);function ol(){return[]}function il(){return!1}var sl=Ao((function(t,e){return t+e}),0),al=ko("ceil"),ll=Ao((function(t,e){return t/e}),1),ul=ko("floor");var cl=Ao((function(t,e){return t*e}),1),pl=ko("round"),hl=Ao((function(t,e){return t-e}),0);return Pn.after=function(t,e){if("function"!=typeof e)throw new mt(i);return t=ra(t),function(){if(--t<1)return e.apply(this,arguments)}},Pn.ary=ms,Pn.assign=la,Pn.assignIn=ua,Pn.assignInWith=ca,Pn.assignWith=pa,Pn.at=ha,Pn.before=ys,Pn.bind=vs,Pn.bindAll=ja,Pn.bindKey=_s,Pn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ms(t)?t:[t]},Pn.chain=es,Pn.chunk=function(t,e,r){e=(r?li(t,e,r):void 0===e)?1:sn(ra(e),0);var o=null==t?0:t.length;if(!o||e<1)return[];for(var i=0,s=0,a=n(Je(o/e));i<o;)a[s++]=Wr(t,i,i+=e);return a},Pn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,o=[];++e<n;){var i=t[e];i&&(o[r++]=i)}return o},Pn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=n(t-1),r=arguments[0],o=t;o--;)e[o-1]=arguments[o];return fe(Ms(r)?vo(r):[r],ir(e,1))},Pn.cond=function(t){var e=null==t?0:t.length,n=Qo();return t=e?de(t,(function(t){if("function"!=typeof t[1])throw new mt(i);return[n(t[0]),t[1]]})):[],Gr((function(n){for(var r=-1;++r<e;){var o=t[r];if(ie(o[0],this,n))return ie(o[1],this,n)}}))},Pn.conforms=function(t){return function(t){var e=wa(t);return function(n){return Qn(n,t,e)}}(Zn(t,1))},Pn.constant=Ha,Pn.countBy=os,Pn.create=function(t,e){var n=On(t);return null==e?n:qn(n,e)},Pn.curry=function t(e,n,r){var o=Vo(e,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return o.placeholder=t.placeholder,o},Pn.curryRight=function t(e,n,r){var o=Vo(e,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return o.placeholder=t.placeholder,o},Pn.debounce=ws,Pn.defaults=da,Pn.defaultsDeep=fa,Pn.defer=Cs,Pn.delay=bs,Pn.difference=Oi,Pn.differenceBy=Ii,Pn.differenceWith=Ai,Pn.drop=function(t,e,n){var r=null==t?0:t.length;return r?Wr(t,(e=n||void 0===e?1:ra(e))<0?0:e,r):[]},Pn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?Wr(t,0,(e=r-(e=n||void 0===e?1:ra(e)))<0?0:e):[]},Pn.dropRightWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3),!0,!0):[]},Pn.dropWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3),!0):[]},Pn.fill=function(t,e,n,r){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&li(t,e,n)&&(n=0,r=o),function(t,e,n,r){var o=t.length;for((n=ra(n))<0&&(n=-n>o?0:o+n),(r=void 0===r||r>o?o:ra(r))<0&&(r+=o),r=n>r?0:oa(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Pn.filter=function(t,e){return(Ms(t)?ce:or)(t,Qo(e,3))},Pn.flatMap=function(t,e){return ir(hs(t,e),1)},Pn.flatMapDeep=function(t,e){return ir(hs(t,e),1/0)},Pn.flatMapDepth=function(t,e,n){return n=void 0===n?1:ra(n),ir(hs(t,e),n)},Pn.flatten=Li,Pn.flattenDeep=function(t){return(null==t?0:t.length)?ir(t,1/0):[]},Pn.flattenDepth=function(t,e){return(null==t?0:t.length)?ir(t,e=void 0===e?1:ra(e)):[]},Pn.flip=function(t){return Vo(t,512)},Pn.flow=Ua,Pn.flowRight=Wa,Pn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var o=t[e];r[o[0]]=o[1]}return r},Pn.functions=function(t){return null==t?[]:cr(t,wa(t))},Pn.functionsIn=function(t){return null==t?[]:cr(t,Ca(t))},Pn.groupBy=us,Pn.initial=function(t){return(null==t?0:t.length)?Wr(t,0,-1):[]},Pn.intersection=Fi,Pn.intersectionBy=ki,Pn.intersectionWith=Gi,Pn.invert=ya,Pn.invertBy=va,Pn.invokeMap=cs,Pn.iteratee=Xa,Pn.keyBy=ps,Pn.keys=wa,Pn.keysIn=Ca,Pn.map=hs,Pn.mapKeys=function(t,e){var n={};return e=Qo(e,3),lr(t,(function(t,r,o){Xn(n,e(t,r,o),t)})),n},Pn.mapValues=function(t,e){var n={};return e=Qo(e,3),lr(t,(function(t,r,o){Xn(n,r,e(t,r,o))})),n},Pn.matches=function(t){return Pr(Zn(t,1))},Pn.matchesProperty=function(t,e){return Or(t,Zn(e,1))},Pn.memoize=xs,Pn.merge=ba,Pn.mergeWith=xa,Pn.method=Ka,Pn.methodOf=Ya,Pn.mixin=Za,Pn.negate=Es,Pn.nthArg=function(t){return t=ra(t),Gr((function(e){return Ar(e,t)}))},Pn.omit=Ea,Pn.omitBy=function(t,e){return Ta(t,Es(Qo(e)))},Pn.once=function(t){return ys(2,t)},Pn.orderBy=function(t,e,n,r){return null==t?[]:(Ms(e)||(e=null==e?[]:[e]),Ms(n=r?void 0:n)||(n=null==n?[]:[n]),Dr(t,e,n))},Pn.over=Ja,Pn.overArgs=Ss,Pn.overEvery=$a,Pn.overSome=tl,Pn.partial=Ts,Pn.partialRight=Rs,Pn.partition=ds,Pn.pick=Sa,Pn.pickBy=Ta,Pn.property=el,Pn.propertyOf=function(t){return function(e){return null==t?void 0:pr(t,e)}},Pn.pull=Vi,Pn.pullAll=zi,Pn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Lr(t,e,Qo(n,2)):t},Pn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Lr(t,e,void 0,n):t},Pn.pullAt=ji,Pn.range=nl,Pn.rangeRight=rl,Pn.rearg=Ps,Pn.reject=function(t,e){return(Ms(t)?ce:or)(t,Es(Qo(e,3)))},Pn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],i=t.length;for(e=Qo(e,3);++r<i;){var s=t[r];e(s,r,t)&&(n.push(s),o.push(r))}return Nr(t,o),n},Pn.rest=function(t,e){if("function"!=typeof t)throw new mt(i);return Gr(t,e=void 0===e?e:ra(e))},Pn.reverse=Hi,Pn.sampleSize=function(t,e,n){return e=(n?li(t,e,n):void 0===e)?1:ra(e),(Ms(t)?Vn:Vr)(t,e)},Pn.set=function(t,e,n){return null==t?t:zr(t,e,n)},Pn.setWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:zr(t,e,n,r)},Pn.shuffle=function(t){return(Ms(t)?zn:Ur)(t)},Pn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&li(t,e,n)?(e=0,n=r):(e=null==e?0:ra(e),n=void 0===n?r:ra(n)),Wr(t,e,n)):[]},Pn.sortBy=fs,Pn.sortedUniq=function(t){return t&&t.length?Yr(t):[]},Pn.sortedUniqBy=function(t,e){return t&&t.length?Yr(t,Qo(e,2)):[]},Pn.split=function(t,e,n){return n&&"number"!=typeof n&&li(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=aa(t))&&("string"==typeof e||null!=e&&!Ks(e))&&!(e=Qr(e))&&Ve(t)?uo(Xe(t),0,n):t.split(e,n):[]},Pn.spread=function(t,e){if("function"!=typeof t)throw new mt(i);return e=null==e?0:sn(ra(e),0),Gr((function(n){var r=n[e],o=uo(n,0,e);return r&&fe(o,r),ie(t,this,o)}))},Pn.tail=function(t){var e=null==t?0:t.length;return e?Wr(t,1,e):[]},Pn.take=function(t,e,n){return t&&t.length?Wr(t,0,(e=n||void 0===e?1:ra(e))<0?0:e):[]},Pn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?Wr(t,(e=r-(e=n||void 0===e?1:ra(e)))<0?0:e,r):[]},Pn.takeRightWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3),!1,!0):[]},Pn.takeWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3)):[]},Pn.tap=function(t,e){return e(t),t},Pn.throttle=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new mt(i);return Hs(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ws(t,e,{leading:r,maxWait:e,trailing:o})},Pn.thru=ns,Pn.toArray=ea,Pn.toPairs=Ra,Pn.toPairsIn=Pa,Pn.toPath=function(t){return Ms(t)?de(t,Ti):Qs(t)?[t]:vo(Si(aa(t)))},Pn.toPlainObject=sa,Pn.transform=function(t,e,n){var r=Ms(t),o=r||ks(t)||Js(t);if(e=Qo(e,4),null==n){var i=t&&t.constructor;n=o?r?new i:[]:Hs(t)&&Vs(i)?On(Ft(t)):{}}return(o?ae:lr)(t,(function(t,r,o){return e(n,t,r,o)})),n},Pn.unary=function(t){return ms(t,1)},Pn.union=Ui,Pn.unionBy=Wi,Pn.unionWith=qi,Pn.uniq=function(t){return t&&t.length?Jr(t):[]},Pn.uniqBy=function(t,e){return t&&t.length?Jr(t,Qo(e,2)):[]},Pn.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Jr(t,void 0,e):[]},Pn.unset=function(t,e){return null==t||$r(t,e)},Pn.unzip=Xi,Pn.unzipWith=Ki,Pn.update=function(t,e,n){return null==t?t:to(t,e,so(n))},Pn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:to(t,e,so(n),r)},Pn.values=Oa,Pn.valuesIn=function(t){return null==t?[]:De(t,Ca(t))},Pn.without=Yi,Pn.words=Va,Pn.wrap=function(t,e){return Ts(so(e),t)},Pn.xor=Zi,Pn.xorBy=Qi,Pn.xorWith=Ji,Pn.zip=$i,Pn.zipObject=function(t,e){return oo(t||[],e||[],Hn)},Pn.zipObjectDeep=function(t,e){return oo(t||[],e||[],zr)},Pn.zipWith=ts,Pn.entries=Ra,Pn.entriesIn=Pa,Pn.extend=ua,Pn.extendWith=ca,Za(Pn,Pn),Pn.add=sl,Pn.attempt=za,Pn.camelCase=Ia,Pn.capitalize=Aa,Pn.ceil=al,Pn.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=ia(n))===n?n:0),void 0!==e&&(e=(e=ia(e))===e?e:0),Yn(ia(t),e,n)},Pn.clone=function(t){return Zn(t,4)},Pn.cloneDeep=function(t){return Zn(t,5)},Pn.cloneDeepWith=function(t,e){return Zn(t,5,e="function"==typeof e?e:void 0)},Pn.cloneWith=function(t,e){return Zn(t,4,e="function"==typeof e?e:void 0)},Pn.conformsTo=function(t,e){return null==e||Qn(t,e,wa(e))},Pn.deburr=Da,Pn.defaultTo=function(t,e){return null==t||t!==t?e:t},Pn.divide=ll,Pn.endsWith=function(t,e,n){t=aa(t),e=Qr(e);var r=t.length,o=n=void 0===n?r:Yn(ra(n),0,r);return(n-=e.length)>=0&&t.slice(n,o)==e},Pn.eq=Os,Pn.escape=function(t){return(t=aa(t))&&B.test(t)?t.replace(k,Ge):t},Pn.escapeRegExp=function(t){return(t=aa(t))&&X.test(t)?t.replace(q,"\\$&"):t},Pn.every=function(t,e,n){var r=Ms(t)?ue:nr;return n&&li(t,e,n)&&(e=void 0),r(t,Qo(e,3))},Pn.find=is,Pn.findIndex=Di,Pn.findKey=function(t,e){return _e(t,Qo(e,3),lr)},Pn.findLast=ss,Pn.findLastIndex=Mi,Pn.findLastKey=function(t,e){return _e(t,Qo(e,3),ur)},Pn.floor=ul,Pn.forEach=as,Pn.forEachRight=ls,Pn.forIn=function(t,e){return null==t?t:sr(t,Qo(e,3),Ca)},Pn.forInRight=function(t,e){return null==t?t:ar(t,Qo(e,3),Ca)},Pn.forOwn=function(t,e){return t&&lr(t,Qo(e,3))},Pn.forOwnRight=function(t,e){return t&&ur(t,Qo(e,3))},Pn.get=ga,Pn.gt=Is,Pn.gte=As,Pn.has=function(t,e){return null!=t&&oi(t,e,gr)},Pn.hasIn=ma,Pn.head=Ni,Pn.identity=qa,Pn.includes=function(t,e,n,r){t=Ns(t)?t:Oa(t),n=n&&!r?ra(n):0;var o=t.length;return n<0&&(n=sn(o+n,0)),Zs(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&Ce(t,e,n)>-1},Pn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ra(n);return o<0&&(o=sn(r+o,0)),Ce(t,e,o)},Pn.inRange=function(t,e,n){return e=na(e),void 0===n?(n=e,e=0):n=na(n),function(t,e,n){return t>=an(e,n)&&t<sn(e,n)}(t=ia(t),e,n)},Pn.invoke=_a,Pn.isArguments=Ds,Pn.isArray=Ms,Pn.isArrayBuffer=Ls,Pn.isArrayLike=Ns,Pn.isArrayLikeObject=Fs,Pn.isBoolean=function(t){return!0===t||!1===t||Us(t)&&dr(t)==c},Pn.isBuffer=ks,Pn.isDate=Gs,Pn.isElement=function(t){return Us(t)&&1===t.nodeType&&!Xs(t)},Pn.isEmpty=function(t){if(null==t)return!0;if(Ns(t)&&(Ms(t)||"string"==typeof t||"function"==typeof t.splice||ks(t)||Js(t)||Ds(t)))return!t.length;var e=ri(t);if(e==g||e==_)return!t.size;if(hi(t))return!Er(t).length;for(var n in t)if(bt.call(t,n))return!1;return!0},Pn.isEqual=function(t,e){return wr(t,e)},Pn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?wr(t,e,void 0,n):!!r},Pn.isError=Bs,Pn.isFinite=function(t){return"number"==typeof t&&nn(t)},Pn.isFunction=Vs,Pn.isInteger=zs,Pn.isLength=js,Pn.isMap=Ws,Pn.isMatch=function(t,e){return t===e||Cr(t,e,$o(e))},Pn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,Cr(t,e,$o(e),n)},Pn.isNaN=function(t){return qs(t)&&t!=+t},Pn.isNative=function(t){if(pi(t))throw new o("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return br(t)},Pn.isNil=function(t){return null==t},Pn.isNull=function(t){return null===t},Pn.isNumber=qs,Pn.isObject=Hs,Pn.isObjectLike=Us,Pn.isPlainObject=Xs,Pn.isRegExp=Ks,Pn.isSafeInteger=function(t){return zs(t)&&t>=-9007199254740991&&t<=9007199254740991},Pn.isSet=Ys,Pn.isString=Zs,Pn.isSymbol=Qs,Pn.isTypedArray=Js,Pn.isUndefined=function(t){return void 0===t},Pn.isWeakMap=function(t){return Us(t)&&ri(t)==b},Pn.isWeakSet=function(t){return Us(t)&&"[object WeakSet]"==dr(t)},Pn.join=function(t,e){return null==t?"":rn.call(t,e)},Pn.kebabCase=Ma,Pn.last=Bi,Pn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r;return void 0!==n&&(o=(o=ra(n))<0?sn(r+o,0):an(o,r-1)),e===e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):we(t,xe,o,!0)},Pn.lowerCase=La,Pn.lowerFirst=Na,Pn.lt=$s,Pn.lte=ta,Pn.max=function(t){return t&&t.length?rr(t,qa,fr):void 0},Pn.maxBy=function(t,e){return t&&t.length?rr(t,Qo(e,2),fr):void 0},Pn.mean=function(t){return Ee(t,qa)},Pn.meanBy=function(t,e){return Ee(t,Qo(e,2))},Pn.min=function(t){return t&&t.length?rr(t,qa,Tr):void 0},Pn.minBy=function(t,e){return t&&t.length?rr(t,Qo(e,2),Tr):void 0},Pn.stubArray=ol,Pn.stubFalse=il,Pn.stubObject=function(){return{}},Pn.stubString=function(){return""},Pn.stubTrue=function(){return!0},Pn.multiply=cl,Pn.nth=function(t,e){return t&&t.length?Ar(t,ra(e)):void 0},Pn.noConflict=function(){return Xt._===this&&(Xt._=Rt),this},Pn.noop=Qa,Pn.now=gs,Pn.pad=function(t,e,n){t=aa(t);var r=(e=ra(e))?qe(t):0;if(!e||r>=e)return t;var o=(e-r)/2;return Mo($e(o),n)+t+Mo(Je(o),n)},Pn.padEnd=function(t,e,n){t=aa(t);var r=(e=ra(e))?qe(t):0;return e&&r<e?t+Mo(e-r,n):t},Pn.padStart=function(t,e,n){t=aa(t);var r=(e=ra(e))?qe(t):0;return e&&r<e?Mo(e-r,n)+t:t},Pn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),un(aa(t).replace(K,""),e||0)},Pn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&li(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=na(t),void 0===e?(e=t,t=0):e=na(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var o=cn();return an(t+o*(e-t+Ht("1e-"+((o+"").length-1))),e)}return Fr(t,e)},Pn.reduce=function(t,e,n){var r=Ms(t)?ge:Re,o=arguments.length<3;return r(t,Qo(e,4),n,o,tr)},Pn.reduceRight=function(t,e,n){var r=Ms(t)?me:Re,o=arguments.length<3;return r(t,Qo(e,4),n,o,er)},Pn.repeat=function(t,e,n){return e=(n?li(t,e,n):void 0===e)?1:ra(e),kr(aa(t),e)},Pn.replace=function(){var t=arguments,e=aa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Pn.result=function(t,e,n){var r=-1,o=(e=ao(e,t)).length;for(o||(o=1,t=void 0);++r<o;){var i=null==t?void 0:t[Ti(e[r])];void 0===i&&(r=o,i=n),t=Vs(i)?i.call(t):i}return t},Pn.round=pl,Pn.runInContext=t,Pn.sample=function(t){return(Ms(t)?Bn:Br)(t)},Pn.size=function(t){if(null==t)return 0;if(Ns(t))return Zs(t)?qe(t):t.length;var e=ri(t);return e==g||e==_?t.size:Er(t).length},Pn.snakeCase=Fa,Pn.some=function(t,e,n){var r=Ms(t)?ye:qr;return n&&li(t,e,n)&&(e=void 0),r(t,Qo(e,3))},Pn.sortedIndex=function(t,e){return Xr(t,e)},Pn.sortedIndexBy=function(t,e,n){return Kr(t,e,Qo(n,2))},Pn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Xr(t,e);if(r<n&&Os(t[r],e))return r}return-1},Pn.sortedLastIndex=function(t,e){return Xr(t,e,!0)},Pn.sortedLastIndexBy=function(t,e,n){return Kr(t,e,Qo(n,2),!0)},Pn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Xr(t,e,!0)-1;if(Os(t[n],e))return n}return-1},Pn.startCase=ka,Pn.startsWith=function(t,e,n){return t=aa(t),n=null==n?0:Yn(ra(n),0,t.length),e=Qr(e),t.slice(n,n+e.length)==e},Pn.subtract=hl,Pn.sum=function(t){return t&&t.length?Pe(t,qa):0},Pn.sumBy=function(t,e){return t&&t.length?Pe(t,Qo(e,2)):0},Pn.template=function(t,e,n){var r=Pn.templateSettings;n&&li(t,e,n)&&(e=void 0),t=aa(t),e=ca({},e,r,zo);var i,s,a=ca({},e.imports,r.imports,zo),l=wa(a),u=De(a,l),c=0,p=e.interpolate||ct,h="__p += '",d=ft((e.escape||ct).source+"|"+p.source+"|"+(p===j?nt:ct).source+"|"+(e.evaluate||ct).source+"|$","g"),f="//# sourceURL="+(bt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Bt+"]")+"\n";t.replace(d,(function(e,n,r,o,a,l){return r||(r=o),h+=t.slice(c,l).replace(pt,Be),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),a&&(s=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+e.length,e})),h+="';\n";var g=bt.call(e,"variable")&&e.variable;if(g){if(tt.test(g))throw new o("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(M,""):h).replace(L,"$1").replace(N,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=za((function(){return Y(l,f+"return "+h).apply(void 0,u)}));if(m.source=h,Bs(m))throw m;return m},Pn.times=function(t,e){if((t=ra(t))<1||t>9007199254740991)return[];var n=4294967295,r=an(t,4294967295);t-=4294967295;for(var o=Oe(r,e=Qo(e));++n<t;)e(n);return o},Pn.toFinite=na,Pn.toInteger=ra,Pn.toLength=oa,Pn.toLower=function(t){return aa(t).toLowerCase()},Pn.toNumber=ia,Pn.toSafeInteger=function(t){return t?Yn(ra(t),-9007199254740991,9007199254740991):0===t?t:0},Pn.toString=aa,Pn.toUpper=function(t){return aa(t).toUpperCase()},Pn.trim=function(t,e,n){if((t=aa(t))&&(n||void 0===e))return Ie(t);if(!t||!(e=Qr(e)))return t;var r=Xe(t),o=Xe(e);return uo(r,Le(r,o),Ne(r,o)+1).join("")},Pn.trimEnd=function(t,e,n){if((t=aa(t))&&(n||void 0===e))return t.slice(0,Ke(t)+1);if(!t||!(e=Qr(e)))return t;var r=Xe(t);return uo(r,0,Ne(r,Xe(e))+1).join("")},Pn.trimStart=function(t,e,n){if((t=aa(t))&&(n||void 0===e))return t.replace(K,"");if(!t||!(e=Qr(e)))return t;var r=Xe(t);return uo(r,Le(r,Xe(e))).join("")},Pn.truncate=function(t,e){var n=30,r="...";if(Hs(e)){var o="separator"in e?e.separator:o;n="length"in e?ra(e.length):n,r="omission"in e?Qr(e.omission):r}var i=(t=aa(t)).length;if(Ve(t)){var s=Xe(t);i=s.length}if(n>=i)return t;var a=n-qe(r);if(a<1)return r;var l=s?uo(s,0,a).join(""):t.slice(0,a);if(void 0===o)return l+r;if(s&&(a+=l.length-a),Ks(o)){if(t.slice(a).search(o)){var u,c=l;for(o.global||(o=ft(o.source,aa(rt.exec(o))+"g")),o.lastIndex=0;u=o.exec(c);)var p=u.index;l=l.slice(0,void 0===p?a:p)}}else if(t.indexOf(Qr(o),a)!=a){var h=l.lastIndexOf(o);h>-1&&(l=l.slice(0,h))}return l+r},Pn.unescape=function(t){return(t=aa(t))&&G.test(t)?t.replace(F,Ye):t},Pn.uniqueId=function(t){var e=++xt;return aa(t)+e},Pn.upperCase=Ga,Pn.upperFirst=Ba,Pn.each=as,Pn.eachRight=ls,Pn.first=Ni,Za(Pn,function(){var t={};return lr(Pn,(function(e,n){bt.call(Pn.prototype,n)||(t[n]=e)})),t}(),{chain:!1}),Pn.VERSION="4.17.21",ae(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Pn[t].placeholder=Pn})),ae(["drop","take"],(function(t,e){Dn.prototype[t]=function(n){n=void 0===n?1:sn(ra(n),0);var r=this.__filtered__&&!e?new Dn(this):this.clone();return r.__filtered__?r.__takeCount__=an(n,r.__takeCount__):r.__views__.push({size:an(n,4294967295),type:t+(r.__dir__<0?"Right":"")}),r},Dn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ae(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Dn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Qo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),ae(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Dn.prototype[t]=function(){return this[n](1).value()[0]}})),ae(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Dn.prototype[t]=function(){return this.__filtered__?new Dn(this):this[n](1)}})),Dn.prototype.compact=function(){return this.filter(qa)},Dn.prototype.find=function(t){return this.filter(t).head()},Dn.prototype.findLast=function(t){return this.reverse().find(t)},Dn.prototype.invokeMap=Gr((function(t,e){return"function"==typeof t?new Dn(this):this.map((function(n){return vr(n,t,e)}))})),Dn.prototype.reject=function(t){return this.filter(Es(Qo(t)))},Dn.prototype.slice=function(t,e){t=ra(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Dn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=ra(e))<0?n.dropRight(-e):n.take(e-t)),n)},Dn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Dn.prototype.toArray=function(){return this.take(4294967295)},lr(Dn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),o=Pn[r?"take"+("last"==e?"Right":""):e],i=r||/^find/.test(e);o&&(Pn.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,a=e instanceof Dn,l=s[0],u=a||Ms(e),c=function(t){var e=o.apply(Pn,fe([t],s));return r&&p?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(a=u=!1);var p=this.__chain__,h=!!this.__actions__.length,d=i&&!p,f=a&&!h;if(!i&&u){e=f?e:new Dn(this);var g=t.apply(e,s);return g.__actions__.push({func:ns,args:[c],thisArg:void 0}),new An(g,p)}return d&&f?t.apply(this,s):(g=this.thru(c),d?r?g.value()[0]:g.value():g)})})),ae(["pop","push","shift","sort","splice","unshift"],(function(t){var e=yt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Pn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var o=this.value();return e.apply(Ms(o)?o:[],t)}return this[n]((function(n){return e.apply(Ms(n)?n:[],t)}))}})),lr(Dn.prototype,(function(t,e){var n=Pn[e];if(n){var r=n.name+"";bt.call(_n,r)||(_n[r]=[]),_n[r].push({name:e,func:n})}})),_n[Oo(void 0,2).name]=[{name:"wrapper",func:void 0}],Dn.prototype.clone=function(){var t=new Dn(this.__wrapped__);return t.__actions__=vo(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=vo(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=vo(this.__views__),t},Dn.prototype.reverse=function(){if(this.__filtered__){var t=new Dn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Dn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ms(t),r=e<0,o=n?t.length:0,i=function(t,e,n){var r=-1,o=n.length;for(;++r<o;){var i=n[r],s=i.size;switch(i.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=an(e,t+s);break;case"takeRight":t=sn(t,e-s)}}return{start:t,end:e}}(0,o,this.__views__),s=i.start,a=i.end,l=a-s,u=r?a:s-1,c=this.__iteratees__,p=c.length,h=0,d=an(l,this.__takeCount__);if(!n||!r&&o==l&&d==l)return no(t,this.__actions__);var f=[];t:for(;l--&&h<d;){for(var g=-1,m=t[u+=e];++g<p;){var y=c[g],v=y.iteratee,_=y.type,w=v(m);if(2==_)m=w;else if(!w){if(1==_)continue t;break t}}f[h++]=m}return f},Pn.prototype.at=rs,Pn.prototype.chain=function(){return es(this)},Pn.prototype.commit=function(){return new An(this.value(),this.__chain__)},Pn.prototype.next=function(){void 0===this.__values__&&(this.__values__=ea(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Pn.prototype.plant=function(t){for(var e,n=this;n instanceof In;){var r=Pi(n);r.__index__=0,r.__values__=void 0,e?o.__wrapped__=r:e=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,e},Pn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Dn){var e=t;return this.__actions__.length&&(e=new Dn(this)),(e=e.reverse()).__actions__.push({func:ns,args:[Hi],thisArg:void 0}),new An(e,this.__chain__)}return this.thru(Hi)},Pn.prototype.toJSON=Pn.prototype.valueOf=Pn.prototype.value=function(){return no(this.__wrapped__,this.__actions__)},Pn.prototype.first=Pn.prototype.head,Yt&&(Pn.prototype[Yt]=function(){return this}),Pn}();Xt._=Ze,void 0===(o=function(){return Ze}.call(e,n,e,r))||(r.exports=o)}).call(this)}).call(this,n(24),n(63)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},,,function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReact=void 0;var l=a(n(0)),u=n(25),c=n(11),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setGridApi=function(t,n){e.api=t,e.columnApi=n},e}return r(e,t),e.prototype.render=function(){return this.props.suppressReactUi?l.default.createElement(u.AgGridReactLegacy,o({},this.props,{setGridApi:this.setGridApi})):l.default.createElement(c.AgGridReactUi,o({},this.props,{setGridApi:this.setGridApi}))},e}(l.Component);e.AgGridReact=p},function(t,e,n){t.exports=n(68)()},function(t,e,n){"use strict";var r=n(69);function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function t(t,e,n,o,i,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LegacyReactComponent=void 0;var i=n(0),s=n(7),a=n(1),l=n(26),u=n(27),c=o(n(28)),p=function(t){function e(e,n,r,o){var i=t.call(this,e,r,o)||this;return i.staticMarkup=null,i.staticRenderTime=0,i.parentComponent=n,i}return r(e,t),e.prototype.init=function(t){var e=this;return this.eParentElement=this.createParentElement(t),this.renderStaticMarkup(t),new a.AgPromise((function(n){return e.createReactComponent(t,n)}))},e.prototype.createReactComponent=function(t,e){var n=this;this.isStatelessComponent()||(t.ref=function(t){n.componentInstance=t,n.addParentContainerStyleAndClasses(),n.removeStaticMarkup()});var r=i.createElement(this.reactComponent,t),o=s.createPortal(r,this.eParentElement,c.default());this.portal=o,this.portalManager.mountReactPortal(o,this,(function(t){e(t),n.isStatelessComponent()&&(n.isSlowRenderer()&&n.removeStaticMarkup(),setTimeout((function(){n.removeStaticMarkup()})))}))},e.prototype.fallbackMethodAvailable=function(t){return!1},e.prototype.fallbackMethod=function(t,e){},e.prototype.isSlowRenderer=function(){return this.staticRenderTime>=e.SLOW_RENDERING_THRESHOLD},e.prototype.isNullValue=function(){return""===this.staticMarkup},e.prototype.renderStaticMarkup=function(t){if(!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer){var e=console.error,n=i.createElement(this.reactComponent,t);try{console.error=function(){};var r=Date.now(),o=u.renderToStaticMarkup(n);this.staticRenderTime=Date.now()-r,console.error=e,""===o?this.staticMarkup=o:o&&(this.staticMarkup=document.createElement("span"),this.staticMarkup.innerHTML=o,this.eParentElement.appendChild(this.staticMarkup))}catch(s){}finally{console.error=e}}},e.prototype.removeStaticMarkup=function(){!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer&&this.staticMarkup&&(this.staticMarkup.remove?(this.staticMarkup.remove(),this.staticMarkup=null):this.eParentElement.removeChild&&(this.eParentElement.removeChild(this.staticMarkup),this.staticMarkup=null))},e.prototype.rendered=function(){return this.isNullValue()||!!this.staticMarkup||this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())},e.SLOW_RENDERING_THRESHOLD=3,e}(l.ReactComponent);e.LegacyReactComponent=p},function(t,e,n){"use strict";var r=n(10),o=n(0);function i(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s="function"===typeof Symbol&&Symbol.for,a=s?Symbol.for("react.portal"):60106,l=s?Symbol.for("react.fragment"):60107,u=s?Symbol.for("react.strict_mode"):60108,c=s?Symbol.for("react.profiler"):60114,p=s?Symbol.for("react.provider"):60109,h=s?Symbol.for("react.context"):60110,d=s?Symbol.for("react.concurrent_mode"):60111,f=s?Symbol.for("react.forward_ref"):60112,g=s?Symbol.for("react.suspense"):60113,m=s?Symbol.for("react.suspense_list"):60120,y=s?Symbol.for("react.memo"):60115,v=s?Symbol.for("react.lazy"):60116,_=s?Symbol.for("react.block"):60121,w=s?Symbol.for("react.fundamental"):60117,C=s?Symbol.for("react.scope"):60119;function b(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case l:return"Fragment";case a:return"Portal";case c:return"Profiler";case u:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case h:return"Context.Consumer";case p:return"Context.Provider";case f:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case y:return b(t.type);case _:return b(t.render);case v:if(t=1===t._status?t._result:null)return b(t)}return null}var x=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;x.hasOwnProperty("ReactCurrentDispatcher")||(x.ReactCurrentDispatcher={current:null}),x.hasOwnProperty("ReactCurrentBatchConfig")||(x.ReactCurrentBatchConfig={suspense:null});var E={};function S(t,e){for(var n=0|t._threadCount;n<=e;n++)t[n]=t._currentValue2,t._threadCount=n+1}for(var T=new Uint16Array(16),R=0;15>R;R++)T[R]=R+1;T[15]=0;var P=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,O=Object.prototype.hasOwnProperty,I={},A={};function D(t){return!!O.call(A,t)||!O.call(I,t)&&(P.test(t)?A[t]=!0:(I[t]=!0,!1))}function M(t,e,n,r,o,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){L[t]=new M(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];L[e]=new M(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){L[t]=new M(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){L[t]=new M(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){L[t]=new M(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){L[t]=new M(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){L[t]=new M(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){L[t]=new M(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){L[t]=new M(t,5,!1,t.toLowerCase(),null,!1)}));var N=/[\-:]([a-z])/g;function F(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(N,F);L[e]=new M(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(N,F);L[e]=new M(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(N,F);L[e]=new M(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){L[t]=new M(t,1,!1,t.toLowerCase(),null,!1)})),L.xlinkHref=new M("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){L[t]=new M(t,1,!1,t.toLowerCase(),null,!0)}));var k=/["'&<>]/;function G(t){if("boolean"===typeof t||"number"===typeof t)return""+t;t=""+t;var e=k.exec(t);if(e){var n,r="",o=0;for(n=e.index;n<t.length;n++){switch(t.charCodeAt(n)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}o!==n&&(r+=t.substring(o,n)),o=n+1,r+=e}t=o!==n?r+t.substring(o,n):r}return t}function B(t,e){var n,r=L.hasOwnProperty(t)?L[t]:null;return(n="style"!==t)&&(n=null!==r?0===r.type:2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])),n||function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(t,e,r,!1)?"":null!==r?(t=r.attributeName,3===(n=r.type)||4===n&&!0===e?t+'=""':(r.sanitizeURL&&(e=""+e),t+'="'+G(e)+'"')):D(t)?t+'="'+G(e)+'"':""}var V="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},z=null,j=null,H=null,U=!1,W=!1,q=null,X=0;function K(){if(null===z)throw Error(i(321));return z}function Y(){if(0<X)throw Error(i(312));return{memoizedState:null,queue:null,next:null}}function Z(){return null===H?null===j?(U=!1,j=H=Y()):(U=!0,H=j):null===H.next?(U=!1,H=H.next=Y()):(U=!0,H=H.next),H}function Q(t,e,n,r){for(;W;)W=!1,X+=1,H=null,n=t(e,r);return j=z=null,X=0,H=q=null,n}function J(t,e){return"function"===typeof e?e(t):e}function $(t,e,n){if(z=K(),H=Z(),U){var r=H.queue;if(e=r.dispatch,null!==q&&void 0!==(n=q.get(r))){q.delete(r),r=H.memoizedState;do{r=t(r,n.action),n=n.next}while(null!==n);return H.memoizedState=r,[r,e]}return[H.memoizedState,e]}return t=t===J?"function"===typeof e?e():e:void 0!==n?n(e):e,H.memoizedState=t,t=(t=H.queue={last:null,dispatch:null}).dispatch=tt.bind(null,z,t),[H.memoizedState,t]}function tt(t,e,n){if(!(25>X))throw Error(i(301));if(t===z)if(W=!0,t={action:n,next:null},null===q&&(q=new Map),void 0===(n=q.get(e)))q.set(e,t);else{for(e=n;null!==e.next;)e=e.next;e.next=t}}function et(){}var nt=0,rt={readContext:function(t){var e=nt;return S(t,e),t[e]},useContext:function(t){K();var e=nt;return S(t,e),t[e]},useMemo:function(t,e){if(z=K(),e=void 0===e?null:e,null!==(H=Z())){var n=H.memoizedState;if(null!==n&&null!==e){t:{var r=n[1];if(null===r)r=!1;else{for(var o=0;o<r.length&&o<e.length;o++)if(!V(e[o],r[o])){r=!1;break t}r=!0}}if(r)return n[0]}}return t=t(),H.memoizedState=[t,e],t},useReducer:$,useRef:function(t){z=K();var e=(H=Z()).memoizedState;return null===e?(t={current:t},H.memoizedState=t):e},useState:function(t){return $(J,t)},useLayoutEffect:function(){},useCallback:function(t){return t},useImperativeHandle:et,useEffect:et,useDebugValue:et,useResponder:function(t,e){return{props:e,responder:t}},useDeferredValue:function(t){return K(),t},useTransition:function(){return K(),[function(t){t()},!1]}},ot="http://www.w3.org/1999/xhtml";function it(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var st={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},at=r({menuitem:!0},st),lt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ut=["Webkit","ms","Moz","O"];Object.keys(lt).forEach((function(t){ut.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lt[e]=lt[t]}))}));var ct=/([A-Z])/g,pt=/^ms-/,ht=o.Children.toArray,dt=x.ReactCurrentDispatcher,ft={listing:!0,pre:!0,textarea:!0},gt=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,mt={},yt={};var vt=Object.prototype.hasOwnProperty,_t={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function wt(t,e){if(void 0===t)throw Error(i(152,b(e)||"Component"))}function Ct(t,e,n){function s(o,s){var a=s.prototype&&s.prototype.isReactComponent,l=function(t,e,n,r){if(r&&("object"===typeof(r=t.contextType)&&null!==r))return S(r,n),r[n];if(t=t.contextTypes){for(var o in n={},t)n[o]=e[o];e=n}else e=E;return e}(s,e,n,a),u=[],c=!1,p={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===u)return null},enqueueReplaceState:function(t,e){c=!0,u=[e]},enqueueSetState:function(t,e){if(null===u)return null;u.push(e)}};if(a){if(a=new s(o.props,l,p),"function"===typeof s.getDerivedStateFromProps){var h=s.getDerivedStateFromProps.call(null,o.props,a.state);null!=h&&(a.state=r({},a.state,h))}}else if(z={},a=s(o.props,l,p),null==(a=Q(s,o.props,a,l))||null==a.render)return void wt(t=a,s);if(a.props=o.props,a.context=l,a.updater=p,void 0===(p=a.state)&&(a.state=p=null),"function"===typeof a.UNSAFE_componentWillMount||"function"===typeof a.componentWillMount)if("function"===typeof a.componentWillMount&&"function"!==typeof s.getDerivedStateFromProps&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&"function"!==typeof s.getDerivedStateFromProps&&a.UNSAFE_componentWillMount(),u.length){p=u;var d=c;if(u=null,c=!1,d&&1===p.length)a.state=p[0];else{h=d?p[0]:a.state;var f=!0;for(d=d?1:0;d<p.length;d++){var g=p[d];null!=(g="function"===typeof g?g.call(a,h,o.props,l):g)&&(f?(f=!1,h=r({},h,g)):r(h,g))}a.state=h}}else u=null;if(wt(t=a.render(),s),"function"===typeof a.getChildContext&&"object"===typeof(o=s.childContextTypes)){var m=a.getChildContext();for(var y in m)if(!(y in o))throw Error(i(108,b(s)||"Unknown",y))}m&&(e=r({},e,m))}for(;o.isValidElement(t);){var a=t,l=a.type;if("function"!==typeof l)break;s(a,l)}return{child:t,context:e}}var bt=function(){function t(t,e){o.isValidElement(t)?t.type!==l?t=[t]:(t=t.props.children,t=o.isValidElement(t)?[t]:ht(t)):t=ht(t),t={type:null,domNamespace:ot,children:t,childIndex:0,context:E,footer:""};var n=T[0];if(0===n){var r=T,s=2*(n=r.length);if(!(65536>=s))throw Error(i(304));var a=new Uint16Array(s);for(a.set(r),(T=a)[0]=n+1,r=n;r<s-1;r++)T[r]=r+1;T[s-1]=0}else T[0]=T[n];this.threadID=n,this.stack=[t],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=e,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[]}var e=t.prototype;return e.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var t=this.threadID;T[t]=T[0],T[0]=t}},e.pushProvider=function(t){var e=++this.contextIndex,n=t.type._context,r=this.threadID;S(n,r);var o=n[r];this.contextStack[e]=n,this.contextValueStack[e]=o,n[r]=t.props.value},e.popProvider=function(){var t=this.contextIndex,e=this.contextStack[t],n=this.contextValueStack[t];this.contextStack[t]=null,this.contextValueStack[t]=null,this.contextIndex--,e[this.threadID]=n},e.clearProviders=function(){for(var t=this.contextIndex;0<=t;t--)this.contextStack[t][this.threadID]=this.contextValueStack[t]},e.read=function(t){if(this.exhausted)return null;var e=nt;nt=this.threadID;var n=dt.current;dt.current=rt;try{for(var r=[""],o=!1;r[0].length<t;){if(0===this.stack.length){this.exhausted=!0;var s=this.threadID;T[s]=T[0],T[0]=s;break}var a=this.stack[this.stack.length-1];if(o||a.childIndex>=a.children.length){var l=a.footer;if(""!==l&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===a.type)this.currentSelectValue=null;else if(null!=a.type&&null!=a.type.type&&a.type.type.$$typeof===p)this.popProvider(a.type);else if(a.type===g){this.suspenseDepth--;var u=r.pop();if(o){o=!1;var c=a.fallbackFrame;if(!c)throw Error(i(303));this.stack.push(c),r[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}r[this.suspenseDepth]+=u}r[this.suspenseDepth]+=l}else{var h=a.children[a.childIndex++],d="";try{d+=this.render(h,a.context,a.domNamespace)}catch(f){if(null!=f&&"function"===typeof f.then)throw Error(i(294));throw f}r.length<=this.suspenseDepth&&r.push(""),r[this.suspenseDepth]+=d}}return r[0]}finally{dt.current=n,nt=e}},e.render=function(t,e,n){if("string"===typeof t||"number"===typeof t)return""===(n=""+t)?"":this.makeStaticMarkup?G(n):this.previousWasTextNode?"\x3c!-- --\x3e"+G(n):(this.previousWasTextNode=!0,G(n));if(t=(e=Ct(t,e,this.threadID)).child,e=e.context,null===t||!1===t)return"";if(!o.isValidElement(t)){if(null!=t&&null!=t.$$typeof){if((n=t.$$typeof)===a)throw Error(i(257));throw Error(i(258,n.toString()))}return t=ht(t),this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),""}var s=t.type;if("string"===typeof s)return this.renderDOM(t,e,n);switch(s){case u:case d:case c:case m:case l:return t=ht(t.props.children),this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),"";case g:throw Error(i(294))}if("object"===typeof s&&null!==s)switch(s.$$typeof){case f:z={};var _=s.render(t.props,t.ref);return _=Q(s.render,t.props,_,t.ref),_=ht(_),this.stack.push({type:null,domNamespace:n,children:_,childIndex:0,context:e,footer:""}),"";case y:return t=[o.createElement(s.type,r({ref:t.ref},t.props))],this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),"";case p:return n={type:t,domNamespace:n,children:s=ht(t.props.children),childIndex:0,context:e,footer:""},this.pushProvider(t),this.stack.push(n),"";case h:s=t.type,_=t.props;var b=this.threadID;return S(s,b),s=ht(_.children(s[b])),this.stack.push({type:t,domNamespace:n,children:s,childIndex:0,context:e,footer:""}),"";case w:throw Error(i(338));case v:switch(function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(s=t.type),s._status){case 1:return t=[o.createElement(s._result,r({ref:t.ref},t.props))],this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),"";case 2:throw s._result;default:throw Error(i(295))}case C:throw Error(i(343))}throw Error(i(130,null==s?s:typeof s,""))},e.renderDOM=function(t,e,n){var s=t.type.toLowerCase();if(n===ot&&it(s),!mt.hasOwnProperty(s)){if(!gt.test(s))throw Error(i(65,s));mt[s]=!0}var a=t.props;if("input"===s)a=r({type:void 0},a,{defaultChecked:void 0,defaultValue:void 0,value:null!=a.value?a.value:a.defaultValue,checked:null!=a.checked?a.checked:a.defaultChecked});else if("textarea"===s){var l=a.value;if(null==l){l=a.defaultValue;var u=a.children;if(null!=u){if(null!=l)throw Error(i(92));if(Array.isArray(u)){if(!(1>=u.length))throw Error(i(93));u=u[0]}l=""+u}null==l&&(l="")}a=r({},a,{value:void 0,children:""+l})}else if("select"===s)this.currentSelectValue=null!=a.value?a.value:a.defaultValue,a=r({},a,{value:void 0});else if("option"===s){u=this.currentSelectValue;var c=function(t){if(void 0===t||null===t)return t;var e="";return o.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(a.children);if(null!=u){var p=null!=a.value?a.value+"":c;if(l=!1,Array.isArray(u)){for(var h=0;h<u.length;h++)if(""+u[h]===p){l=!0;break}}else l=""+u===p;a=r({selected:void 0,children:void 0},a,{selected:l,children:c})}}if(l=a){if(at[s]&&(null!=l.children||null!=l.dangerouslySetInnerHTML))throw Error(i(137,s,""));if(null!=l.dangerouslySetInnerHTML){if(null!=l.children)throw Error(i(60));if("object"!==typeof l.dangerouslySetInnerHTML||!("__html"in l.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=l.style&&"object"!==typeof l.style)throw Error(i(62,""))}for(w in l=a,u=this.makeStaticMarkup,c=1===this.stack.length,p="<"+t.type,l)if(vt.call(l,w)){var d=l[w];if(null!=d){if("style"===w){h=void 0;var f="",g="";for(h in d)if(d.hasOwnProperty(h)){var m=0===h.indexOf("--"),y=d[h];if(null!=y){if(m)var v=h;else if(v=h,yt.hasOwnProperty(v))v=yt[v];else{var _=v.replace(ct,"-$1").toLowerCase().replace(pt,"-ms-");v=yt[v]=_}f+=g+v+":",g=h,f+=m=null==y||"boolean"===typeof y||""===y?"":m||"number"!==typeof y||0===y||lt.hasOwnProperty(g)&&lt[g]?(""+y).trim():y+"px",g=";"}}d=f||null}h=null;t:if(m=s,y=l,-1===m.indexOf("-"))m="string"===typeof y.is;else switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":m=!1;break t;default:m=!0}m?_t.hasOwnProperty(w)||(h=D(h=w)&&null!=d?h+'="'+G(d)+'"':""):h=B(w,d),h&&(p+=" "+h)}}u||c&&(p+=' data-reactroot=""');var w=p;l="",st.hasOwnProperty(s)?w+="/>":(w+=">",l="</"+t.type+">");t:{if(null!=(u=a.dangerouslySetInnerHTML)){if(null!=u.__html){u=u.__html;break t}}else if("string"===typeof(u=a.children)||"number"===typeof u){u=G(u);break t}u=null}return null!=u?(a=[],ft.hasOwnProperty(s)&&"\n"===u.charAt(0)&&(w+="\n"),w+=u):a=ht(a.children),t=t.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?it(t):"http://www.w3.org/2000/svg"===n&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:s,children:a,childIndex:0,context:e,footer:l}),this.previousWasTextNode=!1,w},t}(),xt={renderToString:function(t){t=new bt(t,!1);try{return t.read(1/0)}finally{t.destroy()}},renderToStaticMarkup:function(t){t=new bt(t,!0);try{return t.read(1/0)}finally{t.destroy()}},renderToNodeStream:function(){throw Error(i(207))},renderToStaticNodeStream:function(){throw Error(i(208))},version:"16.14.0"};t.exports=xt.default||xt},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),l=s(n(0)),u=n(2),c=n(6),p=n(4),h=l.forwardRef((function(t,e){var n=l.useContext(u.BeansContext).context,o=l.useRef(null),i=l.useRef(null),s=l.useRef(null),d=l.useRef(null),f=l.useRef(null),g=l.useRef(),m=l.useState(),y=m[0],v=m[1],_=l.useState(),w=_[0],C=_[1],b=l.useState(),x=b[0],E=b[1],S=l.useState((function(){return new p.CssClasses})),T=S[0],R=S[1],P=l.useState((function(){return new p.CssClasses("ag-hidden")})),O=P[0],I=P[1],A=l.useState((function(){return new p.CssClasses("ag-hidden")})),D=A[0],M=A[1],L=l.useState((function(){return new p.CssClasses("ag-invisible")})),N=L[0],F=L[1];l.useImperativeHandle(e,(function(){return{refresh:function(){return!1}}})),l.useLayoutEffect((function(){return c.showJsComp(y,n,i.current)}),[y]);var k=l.useCallback((function(e){if(o.current=e,!o.current)return n.destroyBean(g.current),void(g.current=null);var r={setInnerRenderer:function(t,e){v(t),E(e)},setChildCount:function(t){return C(t)},addOrRemoveCssClass:function(t,e){return R((function(n){return n.setClass(t,e)}))},setContractedDisplayed:function(t){return M((function(e){return e.setClass("ag-hidden",!t)}))},setExpandedDisplayed:function(t){return I((function(e){return e.setClass("ag-hidden",!t)}))},setCheckboxVisible:function(t){return F((function(e){return e.setClass("ag-invisible",!t)}))}};g.current=n.createBean(new a.GroupCellRendererCtrl),g.current.init(r,o.current,s.current,d.current,f.current,h,t)}),[]),G=l.useMemo((function(){return"ag-cell-wrapper "+T.toString()}),[T]),B=l.useMemo((function(){return"ag-group-expanded "+O.toString()}),[O]),V=l.useMemo((function(){return"ag-group-contracted "+D.toString()}),[D]),z=l.useMemo((function(){return"ag-group-checkbox "+N.toString()}),[N]),j=y&&y.componentFromFramework,H=j?y.componentClass:void 0,U=null==y&&null!=x,W=a._.escapeString(x,!0);return l.default.createElement("span",r({className:G,ref:k},t.colDef?{}:{role:"gridcell"}),l.default.createElement("span",{className:B,ref:d}),l.default.createElement("span",{className:V,ref:f}),l.default.createElement("span",{className:z,ref:s}),l.default.createElement("span",{className:"ag-group-value",ref:i},U&&l.default.createElement(l.default.Fragment,null,W),j&&l.default.createElement(H,r({},y.params))),l.default.createElement("span",{className:"ag-group-child-count"},w))}));e.default=h},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(0)),l=n(4),u=n(1),c=n(2),p=n(11);e.default=a.forwardRef((function(t,e){var n=a.useContext(c.BeansContext),o=n.ctrlsFactory,i=n.context,s=n.gridOptionsService,h=n.resizeObserverService,d=n.clientSideRowModel,f=n.serverSideRowModel,g=a.useState((function(){return new l.CssClasses})),m=g[0],y=g[1],v=a.useState((function(){return new l.CssClasses})),_=v[0],w=v[1],C=a.useState(),b=C[0],x=C[1],E=a.useState(),S=E[0],T=E[1],R=a.useRef(),P=a.useRef(null),O=a.useRef(),I=a.useMemo((function(){return u.ModuleRegistry.__getGridRegisteredModules(t.api.getGridId())}),[t]),A=a.useMemo((function(){return m.toString()+" ag-details-row"}),[m]),D=a.useMemo((function(){return _.toString()+" ag-details-grid"}),[_]);e&&a.useImperativeHandle(e,(function(){return{refresh:function(){var t,e;return null!==(e=null===(t=R.current)||void 0===t?void 0:t.refresh())&&void 0!==e&&e}}})),t.template&&u._.doOnce((function(){return console.warn("AG Grid: detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/")}),"React_detailCellRenderer.template");var M=a.useCallback((function(e){if(P.current=e,!P.current)return i.destroyBean(R.current),void(O.current&&O.current());var n={addOrRemoveCssClass:function(t,e){return y((function(n){return n.setClass(t,e)}))},addOrRemoveDetailGridCssClass:function(t,e){return w((function(n){return n.setClass(t,e)}))},setDetailGrid:function(t){return x(t)},setRowData:function(t){return T(t)},getGui:function(){return P.current}},r=o.getInstance("detailCellRenderer");if(r&&(i.createBean(r),r.init(n,t),R.current=r,s.is("detailRowAutoHeight"))){var a=function(){if(null!=P.current){var e=P.current.clientHeight;if(null!=e&&e>0){setTimeout((function(){t.node.setRowHeight(e),d?d.onRowHeightChanged():f&&f.onRowHeightChanged()}),0)}}};O.current=h.observeResize(P.current,a),a()}}),[]),L=a.useCallback((function(t,e){var n;null===(n=R.current)||void 0===n||n.registerDetailWithMaster(t,e)}),[]);return a.default.createElement("div",{className:A,ref:M},b&&a.default.createElement(p.AgGridReactUi,r({className:D},b,{modules:I,rowData:S,setGridApi:L})))}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),l=i(n(0)),u=n(2),c=s(n(75)),p=s(n(12)),h=s(n(88)),d=n(4);e.default=l.memo((function(t){var e=t.context,n=l.useState(""),r=n[0],o=n[1],i=l.useState(""),s=i[0],f=i[1],g=l.useState(""),m=g[0],y=g[1],v=l.useState(null),_=v[0],w=v[1],C=l.useState(null),b=C[0],x=C[1],E=l.useState(!1),S=E[0],T=E[1],R=l.useState(),P=R[0],O=R[1],I=l.useRef(null),A=l.useRef(null),D=l.useRef(),M=l.useState(null),L=M[0],N=M[1],F=l.useRef((function(){})),k=l.useCallback((function(){}),[]),G=l.useMemo((function(){return e.isDestroyed()?null:e.getBean("beans")}),[e]);p.default(" AG Grid ",A);var B=l.useCallback((function(t){if(A.current=t,!A.current)return e.destroyBean(I.current),void(I.current=null);if(!e.isDestroyed()){I.current=e.createBean(new a.GridCtrl);var n=I.current;F.current=n.focusInnerElement.bind(n);var r={destroyGridUi:function(){},setRtlClass:o,addOrRemoveKeyboardFocusClass:function(t){return f(t?a.FocusService.AG_KEYBOARD_FOCUS:"")},forceFocusOutOfContainer:function(){var t;null===(t=D.current)||void 0===t||t.forceFocusOutOfContainer()},updateLayoutClasses:y,getFocusableContainers:function(){var t,e,n=[],r=null===(t=A.current)||void 0===t?void 0:t.querySelector(".ag-root"),o=null===(e=A.current)||void 0===e?void 0:e.querySelector(".ag-side-bar:not(.ag-hidden)");return r&&n.push(r),o&&n.push(o),n},setCursor:w,setUserSelect:x};n.setComp(r,A.current,A.current),T(!0)}}),[]);l.useEffect((function(){if(P&&G&&I.current&&L&&A.current){var t=I.current,n=[],r=G.agStackComponentsRegistry,o=r.getComponentClass("AG-GRID-HEADER-DROP-ZONES"),i=r.getComponentClass("AG-SIDE-BAR"),s=r.getComponentClass("AG-STATUS-BAR"),a=r.getComponentClass("AG-WATERMARK"),l=r.getComponentClass("AG-PAGINATION"),u=[],c=A.current;if(t.showDropZones()&&o){var p=e.createBean(new o),h=p.getGui();c.insertAdjacentElement("afterbegin",h),u.push(h),n.push(p)}if(t.showSideBar()&&i){var d=e.createBean(new i),f=(h=d.getGui(),L.querySelector(".ag-tab-guard-bottom"));f&&(f.insertAdjacentElement("beforebegin",h),u.push(h)),n.push(d)}if(t.showStatusBar()&&s){var g=e.createBean(new s);h=g.getGui();c.insertAdjacentElement("beforeend",h),u.push(h),n.push(g)}if(l){var m=e.createBean(new l);h=m.getGui();c.insertAdjacentElement("beforeend",h),u.push(h),n.push(m)}if(t.showWatermark()&&a){var y=e.createBean(new a);h=y.getGui();c.insertAdjacentElement("beforeend",h),u.push(h),n.push(y)}return function(){e.destroyBeans(n),u.forEach((function(t){t.parentElement&&t.parentElement.removeChild(t)}))}}}),[P,L,G]);var V=l.useMemo((function(){return d.classesList("ag-root-wrapper",r,s,m)}),[r,s,m]),z=l.useMemo((function(){return d.classesList("ag-root-wrapper-body","ag-focus-managed",m)}),[m]),j=l.useMemo((function(){return{userSelect:null!=b?b:"",WebkitUserSelect:null!=b?b:"",cursor:null!=_?_:""}}),[b,_]),H=l.useCallback((function(t){D.current=t,O(null!==t)}),[]);return l.default.createElement("div",{ref:B,className:V,style:j,role:"presentation"},l.default.createElement("div",{className:z,ref:N,role:"presentation"},S&&L&&G&&l.default.createElement(u.BeansContext.Provider,{value:G},l.default.createElement(h.default,{ref:H,eFocusableElement:L,onTabKeyDown:k,gridCtrl:I.current},l.default.createElement(c.default,null)))))}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),l=i(n(0)),u=n(2),c=s(n(76)),p=s(n(12)),h=s(n(82)),d=n(4);e.default=l.memo((function(){var t=l.useContext(u.BeansContext),e=t.context,n=t.agStackComponentsRegistry,r=t.resizeObserverService,o=l.useState(""),i=o[0],s=o[1],f=l.useState(0),g=f[0],m=f[1],y=l.useState(0),v=y[0],_=y[1],w=l.useState("0px"),C=w[0],b=w[1],x=l.useState("0px"),E=x[0],S=x[1],T=l.useState("100%"),R=T[0],P=T[1],O=l.useState(""),I=O[0],A=O[1],D=l.useState(""),M=D[0],L=D[1],N=l.useState(null),F=N[0],k=N[1],G=l.useState(""),B=G[0],V=G[1],z=l.useState(null),j=z[0],H=z[1],U=l.useState("ag-layout-normal"),W=U[0],q=U[1],X=l.useRef();X.current||(X.current=new a.CssClassManager((function(){return K.current})));var K=l.useRef(null),Y=l.useRef(null),Z=l.useRef(null),Q=l.useRef(null),J=l.useRef(null),$=l.useRef(null),tt=l.useRef([]),et=l.useRef([]);p.default(" AG Grid Body ",K),p.default(" AG Pinned Top ",Y),p.default(" AG Sticky Top ",Z),p.default(" AG Middle ",J),p.default(" AG Pinned Bottom ",$);var nt=l.useCallback((function(t){if(K.current=t,!K.current)return e.destroyBeans(tt.current),et.current.forEach((function(t){return t()})),tt.current=[],void(et.current=[]);if(e){var o=function(t){var r=n.getComponentClass(t),o=e.createBean(new r);return tt.current.push(o),o},i=function(t,e){t.appendChild(e),et.current.push((function(){return t.removeChild(e)}))};i(K.current,document.createComment(" AG Fake Horizontal Scroll ")),i(K.current,o("AG-FAKE-HORIZONTAL-SCROLL").getGui()),i(K.current,document.createComment(" AG Overlay Wrapper ")),i(K.current,o("AG-OVERLAY-WRAPPER").getGui()),Q.current&&(i(Q.current,document.createComment(" AG Fake Vertical Scroll ")),i(Q.current,o("AG-FAKE-VERTICAL-SCROLL").getGui()));var l={setRowAnimationCssOnBodyViewport:s,setColumnCount:function(t){K.current&&a._.setAriaColCount(K.current,t)},setRowCount:function(t){K.current&&a._.setAriaRowCount(K.current,t)},setTopHeight:m,setBottomHeight:_,setStickyTopHeight:b,setStickyTopTop:S,setStickyTopWidth:P,setTopDisplay:A,setBottomDisplay:L,setColumnMovingCss:function(t,e){return X.current.addOrRemoveCssClass(t,e)},updateLayoutClasses:q,setAlwaysVerticalScrollClass:k,setPinnedTopBottomOverflowY:V,setCellSelectableCss:function(t,e){return H(e?t:null)},setBodyViewportWidth:function(t){J.current&&(J.current.style.width=t)},registerBodyViewportResizeListener:function(t){if(J.current){var e=r.observeResize(J.current,t);et.current.push((function(){return e()}))}}},u=e.createBean(new a.GridBodyCtrl);tt.current.push(u),u.setComp(l,K.current,J.current,Y.current,$.current,Z.current)}}),[]),rt=l.useMemo((function(){return d.classesList("ag-root","ag-unselectable",W)}),[W]),ot=l.useMemo((function(){return d.classesList("ag-body-viewport",i,W,F,j)}),[i,W,F,j]),it=l.useMemo((function(){return d.classesList("ag-body",W)}),[W]),st=l.useMemo((function(){return d.classesList("ag-body-clipper",W)}),[W]),at=l.useMemo((function(){return d.classesList("ag-floating-top",j)}),[j]),lt=l.useMemo((function(){return d.classesList("ag-sticky-top",j)}),[j]),ut=l.useMemo((function(){return d.classesList("ag-floating-bottom",j)}),[j]),ct=l.useMemo((function(){return{height:g,minHeight:g,display:I,overflowY:B}}),[g,I,B]),pt=l.useMemo((function(){return{height:C,top:E,width:R}}),[C,E,R]),ht=l.useMemo((function(){return{height:v,minHeight:v,display:M,overflowY:B}}),[v,M,B]),dt=function(t){return l.default.createElement(h.default,{name:t,key:t+"-container"})},ft=function(t){var e=t.section,n=t.children,r=t.className,o=t.style;return l.default.createElement("div",{ref:e,className:r,role:"presentation",style:o},n.map(dt))};return l.default.createElement("div",{ref:nt,className:rt,role:"treegrid"},l.default.createElement(c.default,null),ft({section:Y,className:at,style:ct,children:[a.RowContainerName.TOP_LEFT,a.RowContainerName.TOP_CENTER,a.RowContainerName.TOP_RIGHT,a.RowContainerName.TOP_FULL_WIDTH]}),l.default.createElement("div",{className:it,ref:Q,role:"presentation"},l.default.createElement("div",{className:st,role:"presentation"},ft({section:J,className:ot,children:[a.RowContainerName.LEFT,a.RowContainerName.CENTER,a.RowContainerName.RIGHT,a.RowContainerName.FULL_WIDTH]}))),ft({section:Z,className:lt,style:pt,children:[a.RowContainerName.STICKY_TOP_LEFT,a.RowContainerName.STICKY_TOP_CENTER,a.RowContainerName.STICKY_TOP_RIGHT,a.RowContainerName.STICKY_TOP_FULL_WIDTH]}),ft({section:$,className:ut,style:ht,children:[a.RowContainerName.BOTTOM_LEFT,a.RowContainerName.BOTTOM_CENTER,a.RowContainerName.BOTTOM_RIGHT,a.RowContainerName.BOTTOM_FULL_WIDTH]}))}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(0)),l=n(2),u=n(1),c=n(4),p=s(n(77));e.default=a.memo((function(){var t=a.useState((function(){return new c.CssClasses})),e=t[0],n=t[1],r=a.useState(),o=r[0],i=r[1],s=a.useContext(l.BeansContext).context,h=a.useRef(null),d=a.useRef(null),f=a.useCallback((function(t){if(h.current=t,!t)return s.destroyBean(d.current),void(d.current=null);var e={addOrRemoveCssClass:function(t,e){return n((function(n){return n.setClass(t,e)}))},setHeightAndMinHeight:function(t){return i(t)}};d.current=s.createBean(new u.GridHeaderCtrl),d.current.setComp(e,h.current,h.current)}),[]),g=a.useMemo((function(){return"ag-header "+e.toString()}),[e]),m=a.useMemo((function(){return{height:o,minHeight:o}}),[o]);return a.default.createElement("div",{ref:f,className:g,style:m,role:"presentation"},a.default.createElement(p.default,{pinned:"left"}),a.default.createElement(p.default,{pinned:null}),a.default.createElement(p.default,{pinned:"right"}))}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(0)),l=n(2),u=n(1),c=n(4),p=s(n(78));e.default=a.memo((function(t){var e=a.useState((function(){return new c.CssClasses})),n=e[0],r=e[1],o=a.useState(!1),i=o[0],s=o[1],h=a.useState([]),d=h[0],f=h[1],g=a.useContext(l.BeansContext).context,m=a.useRef(null),y=a.useRef(null),v=a.useRef(null),_="left"===t.pinned,w="right"===t.pinned,C=!_&&!w,b=a.useCallback((function(e){if(m.current=e,!m.current)return g.destroyBean(v.current),void(v.current=null);var n={setDisplayed:function(t){r((function(e){return e.setClass("ag-hidden",!t)})),s(!t)},setCtrls:function(t){return f(t)},setCenterWidth:function(t){y.current&&(y.current.style.width=t)},setViewportScrollLeft:function(t){m.current&&(m.current.scrollLeft=t)},setPinnedContainerWidth:function(t){m.current&&(m.current.style.width=t,m.current.style.minWidth=t,m.current.style.maxWidth=t)}};v.current=g.createBean(new u.HeaderRowContainerCtrl(t.pinned)),v.current.setComp(n,m.current)}),[]),x=a.useMemo((function(){return n.toString()}),[n]),E=function(){return d.map((function(t){return a.default.createElement(p.default,{ctrl:t,key:t.getInstanceId()})}))};return a.default.createElement(a.default.Fragment,null,_&&a.default.createElement("div",{ref:b,className:"ag-pinned-left-header "+x,"aria-hidden":i,role:"presentation"},E()),w&&a.default.createElement("div",{ref:b,className:"ag-pinned-right-header "+x,"aria-hidden":i,role:"presentation"},E()),C&&a.default.createElement("div",{ref:b,className:"ag-header-viewport "+x,role:"presentation"},a.default.createElement("div",{ref:y,className:"ag-header-container",role:"rowgroup"},E())))}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),l=i(n(0)),u=s(n(79)),c=s(n(80)),p=s(n(81)),h=n(4);e.default=l.memo((function(t){var e=t.ctrl,n=l.useMemo((function(){return e.getTopAndHeight()}),[]),r=n.topOffset,o=n.rowHeight,i=e.getAriaRowIndex(),s=e.getHeaderRowClass(),d=l.useMemo((function(){return e.getTransform()}),[]),f=l.useState((function(){return o+"px"})),g=f[0],m=f[1],y=l.useState((function(){return r+"px"})),v=y[0],_=y[1],w=l.useState((function(){return e.getHeaderCtrls()})),C=w[0],b=w[1],x=l.useRef(null),E=l.useCallback((function(t){if(x.current=t,t){var n={setHeight:function(t){return m(t)},setTop:function(t){return _(t)},setHeaderCtrls:function(t,e){return b((function(n){return h.getNextValueIfDifferent(n,t,e)}))},setWidth:function(t){x.current&&(x.current.style.width=t)}};e.setComp(n,!1)}}),[]),S=l.useMemo((function(){return{transform:d,height:g,top:v}}),[d,g,v]),T=l.useCallback((function(t){switch(e.getType()){case a.HeaderRowType.COLUMN_GROUP:return l.default.createElement(c.default,{ctrl:t,key:t.getInstanceId()});case a.HeaderRowType.FLOATING_FILTER:return l.default.createElement(p.default,{ctrl:t,key:t.getInstanceId()});default:return l.default.createElement(u.default,{ctrl:t,key:t.getInstanceId()})}}),[]);return l.default.createElement("div",{ref:E,className:s,role:"row",style:S,"aria-rowindex":i},C.map(T))}))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(0)),l=n(2),u=n(1),c=n(4),p=n(6);e.default=a.memo((function(t){var e=t.ctrl,n=a.useContext(l.BeansContext).context,o=e.getColId(),i=a.useState(),s=i[0],h=i[1],d=a.useRef(null),f=a.useRef(null),g=a.useRef(null),m=a.useRef(),y=a.useRef();y.current||(y.current=new u.CssClassManager((function(){return d.current})));var v=a.useCallback((function(t){var n;if(d.current=t,d.current){var r={setWidth:function(t){d.current&&(d.current.style.width=t)},addOrRemoveCssClass:function(t,e){return y.current.addOrRemoveCssClass(t,e)},setAriaDescription:function(t){d.current&&u._.setAriaDescription(d.current,t)},setAriaSort:function(t){d.current&&(t?u._.setAriaSort(d.current,t):u._.removeAriaSort(d.current))},setUserCompDetails:function(t){return h(t)},getUserCompInstance:function(){return m.current||void 0}};e.setComp(r,d.current,f.current,g.current);var o=e.getSelectAllGui();null===(n=f.current)||void 0===n||n.insertAdjacentElement("afterend",o)}}),[]);a.useLayoutEffect((function(){return p.showJsComp(s,n,g.current,m)}),[s]),a.useEffect((function(){e.setDragSource(d.current)}),[s]);var _=a.useMemo((function(){return!!((null===s||void 0===s?void 0:s.componentFromFramework)&&c.isComponentStateless(s.componentClass))}),[s]),w=s&&s.componentFromFramework,C=s&&s.componentClass;return a.default.createElement("div",{ref:v,className:"ag-header-cell","col-id":o,role:"columnheader",tabIndex:-1},a.default.createElement("div",{ref:f,className:"ag-header-cell-resize",role:"presentation"}),a.default.createElement("div",{ref:g,className:"ag-header-cell-comp-wrapper",role:"presentation"},w&&_&&a.default.createElement(C,r({},s.params)),w&&!_&&a.default.createElement(C,r({},s.params,{ref:m}))))}))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(0)),l=n(2),u=n(6),c=n(4);e.default=a.memo((function(t){var e=a.useContext(l.BeansContext).context,n=t.ctrl,o=a.useState((function(){return new c.CssClasses})),i=o[0],s=o[1],p=a.useState((function(){return new c.CssClasses})),h=p[0],d=p[1],f=a.useState("false"),g=f[0],m=f[1],y=a.useState(),v=y[0],_=y[1],w=a.useState(),C=w[0],b=w[1],x=a.useMemo((function(){return n.getColId()}),[]),E=a.useRef(null),S=a.useRef(null),T=a.useCallback((function(t){if(E.current=t,E.current){var e={setWidth:function(t){E.current&&(E.current.style.width=t)},addOrRemoveCssClass:function(t,e){return s((function(n){return n.setClass(t,e)}))},setUserCompDetails:function(t){return b(t)},setResizableDisplayed:function(t){d((function(e){return e.setClass("ag-hidden",!t)})),m(t?"false":"true")},setAriaExpanded:function(t){return _(t)}};n.setComp(e,E.current,S.current)}}),[]);a.useLayoutEffect((function(){return u.showJsComp(C,e,E.current)}),[C]),a.useEffect((function(){E.current&&n.setDragSource(E.current)}),[C]);var R=a.useMemo((function(){return"ag-header-group-cell "+i.toString()}),[i]),P=a.useMemo((function(){return"ag-header-cell-resize "+h.toString()}),[h]),O=C&&C.componentFromFramework,I=C&&C.componentClass;return a.default.createElement("div",{ref:T,className:R,"col-id":x,role:"columnheader",tabIndex:-1,"aria-expanded":v},O&&a.default.createElement(I,r({},C.params)),a.default.createElement("div",{ref:S,"aria-hidden":g,className:P}))}))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(0)),l=n(2),u=n(1),c=n(4),p=n(6);e.default=a.memo((function(t){var e=a.useContext(l.BeansContext).context,n=a.useState((function(){return new c.CssClasses("ag-header-cell","ag-floating-filter")})),o=n[0],i=n[1],s=a.useState((function(){return new c.CssClasses})),h=s[0],d=s[1],f=a.useState((function(){return new c.CssClasses("ag-floating-filter-button","ag-hidden")})),g=f[0],m=f[1],y=a.useState("false"),v=y[0],_=y[1],w=a.useState(),C=w[0],b=w[1],x=a.useRef(null),E=a.useRef(null),S=a.useRef(null),T=a.useRef(null),R=a.useRef(),P=a.useRef(),O=function(t){null!=t&&R.current&&R.current(t)},I=t.ctrl,A=a.useCallback((function(t){if(x.current=t,x.current){P.current=new u.AgPromise((function(t){R.current=t}));var e={addOrRemoveCssClass:function(t,e){return i((function(n){return n.setClass(t,e)}))},addOrRemoveBodyCssClass:function(t,e){return d((function(n){return n.setClass(t,e)}))},setButtonWrapperDisplayed:function(t){m((function(e){return e.setClass("ag-hidden",!t)})),_(t?"false":"true")},setWidth:function(t){x.current&&(x.current.style.width=t)},setCompDetails:function(t){return b(t)},getFloatingFilterComp:function(){return P.current?P.current:null},setMenuIcon:function(t){var e;return null===(e=T.current)||void 0===e?void 0:e.appendChild(t)}};I.setComp(e,x.current,T.current,E.current)}}),[]);a.useLayoutEffect((function(){return p.showJsComp(C,e,E.current,O)}),[C]);var D=a.useMemo((function(){return o.toString()}),[o]),M=a.useMemo((function(){return h.toString()}),[h]),L=a.useMemo((function(){return g.toString()}),[g]),N=a.useMemo((function(){return!!(C&&C.componentFromFramework&&c.isComponentStateless(C.componentClass))}),[C]),F=C&&C.componentFromFramework,k=C&&C.componentClass;return a.default.createElement("div",{ref:A,className:D,role:"gridcell",tabIndex:-1},a.default.createElement("div",{ref:E,className:M,role:"presentation"},F&&N&&a.default.createElement(k,r({},C.params)),F&&!N&&a.default.createElement(k,r({},C.params,{ref:O}))),a.default.createElement("div",{ref:S,"aria-hidden":v,className:L,role:"presentation"},a.default.createElement("button",{ref:T,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),l=i(n(0)),u=n(4),c=s(n(12)),p=s(n(83)),h=n(2);e.default=l.memo((function(t){var e=l.useContext(h.BeansContext).context,n=t.name,r=l.useMemo((function(){return a.getRowContainerTypeForName(n)}),[n]),o=l.useRef(null),i=l.useRef(null),s=l.useRef(null),d=l.useRef([]),f=l.useState((function(){return[]})),g=f[0],m=f[1],y=l.useRef(!1),v=l.useRef(),_=l.useMemo((function(){return a.RowContainerCtrl.getRowContainerCssClasses(n)}),[n]),w=l.useMemo((function(){return u.classesList(_.wrapper)}),[_]),C=l.useMemo((function(){return u.classesList(_.viewport)}),[_]),b=l.useMemo((function(){return u.classesList(_.container)}),[_]),x=n===a.RowContainerName.CENTER,E=n===a.RowContainerName.TOP_CENTER||n===a.RowContainerName.BOTTOM_CENTER||n===a.RowContainerName.STICKY_TOP_CENTER,S=!x&&!E,T=x?o:E?i:s;c.default(" AG Row Container "+n+" ",T);var R=l.useCallback((function(){return x?null!=o.current&&null!=i.current&&null!=s.current:E?null!=i.current&&null!=s.current:S?null!=s.current:void 0}),[]),P=l.useCallback((function(){return x?null==o.current&&null==i.current&&null==s.current:E?null==i.current&&null==s.current:S?null==s.current:void 0}),[]),O=l.useCallback((function(){if(P()&&(e.destroyBean(v.current),v.current=null),R()){var t=function(t){u.agFlushSync(t,(function(){m((function(t){return u.getNextValueIfDifferent(t,d.current,y.current)}))}))},r={setViewportHeight:function(t){i.current&&(i.current.style.height=t)},setRowCtrls:function(e,n){var r=n&&d.current.length>0&&e.length>0;d.current=e,t(r)},setDomOrder:function(e){y.current!=e&&(y.current=e,t(!1))},setContainerWidth:function(t){s.current&&(s.current.style.width=t)}};v.current=e.createBean(new a.RowContainerCtrl(n)),v.current.setComp(r,s.current,i.current,o.current)}}),[R,P]),I=l.useCallback((function(t){s.current=t,O()}),[O]),A=l.useCallback((function(t){i.current=t,O()}),[O]),D=l.useCallback((function(t){o.current=t,O()}),[O]),M=function(){return l.default.createElement("div",{className:b,ref:I,role:g.length?"rowgroup":"presentation"},g.map((function(t){return l.default.createElement(p.default,{rowCtrl:t,containerType:r,key:t.getInstanceId()})})))};return l.default.createElement(l.default.Fragment,null,x&&l.default.createElement("div",{className:w,ref:D,role:"presentation"},l.default.createElement("div",{className:C,ref:A,role:"presentation"},M())),E&&l.default.createElement("div",{className:C,ref:A,role:"presentation"},M()),S&&M())}))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(0)),u=n(1),c=n(6),p=n(4),h=n(2),d=a(n(84));e.default=l.memo((function(t){var e=l.useContext(h.BeansContext).context,n=t.rowCtrl,o=t.containerType,i=n.getTabIndex(),s=l.useRef(n.getDomOrder()),a=n.isFullWidth(),f=l.useState((function(){return n.getRowIndex()})),g=f[0],m=f[1],y=l.useState((function(){return n.getRowId()})),v=y[0],_=y[1],w=l.useState((function(){return n.getBusinessKey()})),C=w[0],b=w[1],x=l.useState((function(){return n.getRowStyles()})),E=x[0],S=x[1],T=l.useState((function(){return null})),R=T[0],P=T[1],O=l.useState(),I=O[0],A=O[1],D=l.useState((function(){return n.getInitialRowTop(o)})),M=D[0],L=D[1],N=l.useState((function(){return n.getInitialTransform(o)})),F=N[0],k=N[1],G=l.useRef(null),B=l.useRef(),V=l.useRef(!1),z=l.useState(0),j=z[0],H=z[1];l.useEffect((function(){var t;if(!V.current&&I&&!(j>10)){var e=null===(t=G.current)||void 0===t?void 0:t.firstChild;e?(n.setupDetailRowAutoHeight(e),V.current=!0):H((function(t){return t+1}))}}),[I,j]);var U=l.useRef();U.current||(U.current=new u.CssClassManager((function(){return G.current})));var W=l.useCallback((function(t){if(G.current=t,n.isAlive())if(G.current){var e={setTop:L,setTransform:k,addOrRemoveCssClass:function(t,e){return U.current.addOrRemoveCssClass(t,e)},setDomOrder:function(t){return s.current=t},setRowIndex:m,setRowId:_,setRowBusinessKey:b,setUserStyles:S,setCellCtrls:function(t,e){p.agFlushSync(e,(function(){P((function(e){return p.getNextValueIfDifferent(e,t,s.current)}))}))},showFullWidth:function(t){return A(t)},getFullWidthCellRenderer:function(){return B.current}};n.setComp(e,G.current,o)}else n.unsetComp(o)}),[]);l.useLayoutEffect((function(){return c.showJsComp(I,e,G.current,B)}),[I]);var q=l.useMemo((function(){var t={top:M,transform:F};return Object.assign(t,E),t}),[M,F,E]),X=a&&I&&I.componentFromFramework,K=!a&&null!=R,Y=l.useMemo((function(){return!!((null===I||void 0===I?void 0:I.componentFromFramework)&&p.isComponentStateless(I.componentClass))}),[I]);return l.default.createElement("div",{ref:W,role:"row",style:q,"row-index":g,"row-id":v,"row-business-key":C,tabIndex:i},K&&(null===R||void 0===R?void 0:R.map((function(t){return l.default.createElement(d.default,{cellCtrl:t,editingRow:n.isEditing(),printLayout:n.isPrintLayout(),key:t.getInstanceId()})}))),X&&function(){var t=I.componentClass;return l.default.createElement(l.default.Fragment,null,Y&&l.default.createElement(t,r({},I.params)),!Y&&l.default.createElement(t,r({},I.params,{ref:B})))}())}))},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.CellCompState=void 0;var l=n(1),u=s(n(0)),c=n(4),p=a(n(85)),h=a(n(87)),d=n(2),f=n(6);!function(t){t[t.ShowValue=0]="ShowValue",t[t.EditValue=1]="EditValue"}(e.CellCompState||(e.CellCompState={}));e.default=u.memo((function(t){var e=u.useContext(d.BeansContext).context,n=t.cellCtrl,o=t.printLayout,i=t.editingRow,s=n.getTabIndex(),a=n.getColumnIdSanitised(),g=n.getInstanceId(),m=u.useState((function(){return n.getIsCellRenderer()?void 0:{compDetails:void 0,value:n.getValueToDisplay(),force:!1}})),y=m[0],v=m[1],_=u.useState(),w=_[0],C=_[1],b=u.useState(1),x=b[0],E=b[1],S=u.useState(),T=S[0],R=S[1],P=u.useState(!1),O=P[0],I=P[1],A=u.useState(!1),D=A[0],M=A[1],L=u.useState(!1),N=L[0],F=L[1],k=u.useState(),G=k[0],B=k[1],V=u.useMemo((function(){return n.isForceWrapper()}),[n]),z=u.useRef(null),j=u.useRef(null),H=u.useRef(),U=u.useRef(),W=u.useRef(),q=u.useRef([]),X=u.useRef(),K=u.useState(0),Y=K[0],Z=K[1],Q=u.useCallback((function(t){X.current=t,Z((function(t){return t+1}))}),[]),J=V||null!=y&&(O||N||D),$=u.useCallback((function(t,e){(U.current=e,e)&&(!function(t,e,n){var r=n.getColumn();if(!t&&e.isPopup&&e.isPopup()){var o="AG Grid: Found an issue in column "+r.getColId()+". If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.";l._.doOnce((function(){return console.warn(o)}),"jsEditorComp-isPopup-"+n.getColumn().getColId())}if(t&&e.getPopupPosition&&null!=e.getPopupPosition()){var i="AG Grid: Found an issue in column "+r.getColId()+". If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.";l._.doOnce((function(){return console.warn(i)}),"jsEditorComp-getPopupPosition-"+n.getColumn().getColId())}}(t,e,n),e.isCancelBeforeStart&&e.isCancelBeforeStart()&&setTimeout((function(){n.stopEditing(!0),n.focusCell(!0)})))}),[n]),tt=u.useCallback((function(t){return $(!0,t)}),[$]),et=u.useCallback((function(t){return $(!1,t)}),[$]),nt=u.useRef();nt.current||(nt.current=new l.CssClassManager((function(){return z.current}))),h.default(y,J,X.current,Y,H,z);var rt=u.useRef();u.useLayoutEffect((function(){var t=rt.current,e=y;if(rt.current=y,null!=t&&null!=t.compDetails&&null!=e&&null!=e.compDetails){var n=t.compDetails,r=e.compDetails;if(n.componentClass==r.componentClass)if(null!=j.current&&null!=j.current.refresh)1!=j.current.refresh(r.params)&&E((function(t){return t+1}))}}),[y]),u.useLayoutEffect((function(){if(w&&!w.compDetails.componentFromFramework){var t=w.compDetails,n=!0===w.popup,r=f.createSyncJsComp(t);if(r){var o=r.getGui();if($(n,r),!n){var i=(V?W:z).current;null===i||void 0===i||i.appendChild(o),r.afterGuiAttached&&r.afterGuiAttached()}return B(r),function(){e.destroyBean(r),$(n,void 0),B(void 0),o&&o.parentElement&&o.parentElement.removeChild(o)}}}}),[w]);var ot=u.useCallback((function(t){if(W.current=t,!W.current)return q.current.forEach((function(t){return t()})),void(q.current=[]);var r=function(t){var n;if(t){var r=t.getGui();null===(n=W.current)||void 0===n||n.insertAdjacentElement("afterbegin",r),q.current.push((function(){e.destroyBean(t),l._.removeFromParent(r)}))}return t};O&&r(n.createSelectionCheckbox());N&&r(n.createDndSource()),D&&r(n.createRowDragComp())}),[n,e,N,D,O]),it=u.useCallback((function(t){if(z.current=t,z.current&&n){var e={addOrRemoveCssClass:function(t,e){return nt.current.addOrRemoveCssClass(t,e)},setUserStyles:function(t){return R(t)},getFocusableElement:function(){return z.current},setIncludeSelection:function(t){return I(t)},setIncludeRowDrag:function(t){return M(t)},setIncludeDndSource:function(t){return F(t)},getCellEditor:function(){return U.current||null},getCellRenderer:function(){return j.current?j.current:H.current},getParentOfValue:function(){return X.current?X.current:W.current?W.current:z.current},setRenderDetails:function(t,e,n){v((function(r){return(null===r||void 0===r?void 0:r.compDetails)!==t||(null===r||void 0===r?void 0:r.value)!==e||(null===r||void 0===r?void 0:r.force)!==n?{value:e,compDetails:t,force:n}:r}))},setEditDetails:function(t,e,n){t?(C({compDetails:t,popup:e,popupPosition:n}),e||v(void 0)):C(void 0)}},r=W.current||void 0;n.setComp(e,z.current,r,o,i)}}),[]),st=u.useMemo((function(){return!!(y&&y.compDetails&&y.compDetails.componentFromFramework&&c.isComponentStateless(y.compDetails.componentClass))}),[y]);u.useLayoutEffect((function(){var t;z.current&&(nt.current.addOrRemoveCssClass("ag-cell-value",!J),nt.current.addOrRemoveCssClass("ag-cell-inline-editing",!!w&&!w.popup),nt.current.addOrRemoveCssClass("ag-cell-popup-editing",!!w&&!!w.popup),nt.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!w||!!w.popup),null===(t=n.getRowCtrl())||void 0===t||t.setInlineEditingCss(!!w),n.shouldRestoreFocus()&&!n.isEditing()&&z.current.focus({preventScroll:!0}))}));var at=function(){return u.default.createElement(u.default.Fragment,null,null!=y&&function(t,e,n,o,i,s,a){var l=t.compDetails,c=t.value,p=!l,h=l&&l.componentFromFramework,d=l&&l.componentClass,f=(null===c||void 0===c?void 0:c.toString)?c.toString():c,g=function(){return u.default.createElement(u.default.Fragment,null,p&&u.default.createElement(u.default.Fragment,null,f),h&&!s&&u.default.createElement(d,r({},l.params,{key:e,ref:o})),h&&s&&u.default.createElement(d,r({},l.params,{key:e})))};return u.default.createElement(u.default.Fragment,null,i?u.default.createElement("span",{role:"presentation",id:"cell-"+n,className:"ag-cell-value",ref:a},g()):g())}(y,x,g,j,J,st,Q),null!=w&&function(t,e,n,o,i,s){var a=t.compDetails,l=a.componentClass,c=a.componentFromFramework&&!t.popup,h=a.componentFromFramework&&t.popup,d=!a.componentFromFramework&&t.popup;return u.default.createElement(u.default.Fragment,null,c&&u.default.createElement(l,r({},t.compDetails.params,{ref:e})),h&&u.default.createElement(p.default,{editDetails:t,cellCtrl:i,eParentCell:o,wrappedContent:u.default.createElement(l,r({},t.compDetails.params,{ref:n}))}),d&&s&&u.default.createElement(p.default,{editDetails:t,cellCtrl:i,eParentCell:o,jsChildComp:s}))}(w,et,tt,z.current,n,G))};return u.default.createElement("div",{ref:it,style:T,tabIndex:s,role:"gridcell","col-id":a},J?u.default.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:ot},at()):at())}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),a=i(n(0)),l=n(7),u=n(2),c=n(86);e.default=a.memo((function(t){var e=a.useState(),n=e[0],r=e[1],o=a.useContext(u.BeansContext),i=o.context,p=o.popupService,h=o.localeService,d=o.gridOptionsService;return c.useEffectOnce((function(){var e=t.editDetails,n=t.cellCtrl,o=t.eParentCell,a=e.compDetails,l=d.is("stopEditingWhenCellsLoseFocus"),u=i.createBean(new s.PopupEditorWrapper(a.params)),c=u.getGui();if(t.jsChildComp){var f=t.jsChildComp.getGui();f&&c.appendChild(f)}var g={column:n.getColumn(),rowNode:n.getRowNode(),type:"popupCellEditor",eventSource:o,ePopup:c,position:e.popupPosition,keepWithinBounds:!0},m=p.positionPopupByComponent.bind(p,g),y=h.getLocaleTextFunc(),v=p.addPopup({modal:l,eChild:c,closeOnEsc:!0,closedCallback:function(){n.onPopupEditorClosed()},anchorToElement:o,positionCallback:m,ariaLabel:y("ariaLabelCellEditor","Cell Editor")}),_=v?v.hideFunc:void 0;return r(u),t.jsChildComp&&t.jsChildComp.afterGuiAttached&&t.jsChildComp.afterGuiAttached(),function(){null!=_&&_(),i.destroyBean(u)}})),a.default.createElement(a.default.Fragment,null,n&&t.wrappedContent&&l.createPortal(t.wrappedContent,n.getGui()))}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useEffectOnce=void 0;var r=n(0);e.useEffectOnce=function(t){var e=r.useRef(t),n=r.useRef(),o=r.useRef(!1),i=r.useRef(!1),s=r.useState(0)[1];o.current&&(i.current=!0),r.useEffect((function(){return o.current||(n.current=e.current(),o.current=!0),s((function(t){return t+1})),function(){i.current&&n.current&&n.current()}}),[])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(2);e.default=function(t,e,n,i,s,a){var l=r.useContext(o.BeansContext).context,u=r.useCallback((function(){var t=s.current;if(t){var e=t.getGui();e&&e.parentElement&&e.parentElement.removeChild(e),l.destroyBean(t),s.current=void 0}}),[]);r.useEffect((function(){var r=null!=t,o=t&&t.compDetails&&!t.compDetails.componentFromFramework;if(r&&o&&!(e&&null==n)){var i=t.compDetails;if(s.current){var l=s.current,c=!!(null!=l.refresh&&0==t.force)&&l.refresh(i.params);if(!0===c||void 0===c)return;u()}var p=i.newAgStackInstance();if(p){var h=p.resolveNow(null,(function(t){return t}));if(h){var d=h.getGui();if(d)(e?n:a.current).appendChild(d),s.current=h}}}else u()}),[t,e,i]),r.useEffect((function(){return u}),[])}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var s=i(n(0)),a=n(1),l=n(2),u=s.forwardRef((function(t,e){var n=t.children,r=t.eFocusableElement,o=t.onTabKeyDown,i=t.gridCtrl,u=s.useContext(l.BeansContext).context,c=s.useRef(null),p=s.useRef(null),h=s.useRef(),d=function(t){var e=null==t?void 0:parseInt(t,10).toString();[c,p].forEach((function(t){var n,r;void 0===e?null===(n=t.current)||void 0===n||n.removeAttribute("tabindex"):null===(r=t.current)||void 0===r||r.setAttribute("tabindex",e)}))};s.useImperativeHandle(e,(function(){return{forceFocusOutOfContainer:function(){var t;null===(t=h.current)||void 0===t||t.forceFocusOutOfContainer()}}}));var f=s.useCallback((function(){if(!c.current&&!p.current)return u.destroyBean(h.current),void(h.current=null);if(c.current&&p.current){var t={setTabIndex:d};h.current=u.createBean(new a.TabGuardCtrl({comp:t,eTopGuard:c.current,eBottomGuard:p.current,eFocusableElement:r,onTabKeyDown:o,focusInnerElement:function(t){return i.focusInnerElement(t)}}))}}),[]),g=s.useCallback((function(t){c.current=t,f()}),[f]),m=s.useCallback((function(t){p.current=t,f()}),[f]),y=function(t){var e="top"===t?a.TabGuardClassNames.TAB_GUARD_TOP:a.TabGuardClassNames.TAB_GUARD_BOTTOM;return s.default.createElement("div",{className:a.TabGuardClassNames.TAB_GUARD+" "+e,role:"presentation",ref:"top"===t?g:m})};return s.default.createElement(s.default.Fragment,null,y("top"),n,y("bottom"))}));e.default=s.memo(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeDetectionStrategyType=void 0,function(t){t.IdentityCheck="IdentityCheck",t.DeepValueCheck="DeepValueCheck",t.NoCheck="NoCheck"}(e.ChangeDetectionStrategyType||(e.ChangeDetectionStrategyType={}))}]]);
//# sourceMappingURL=2.e770374b.chunk.js.map