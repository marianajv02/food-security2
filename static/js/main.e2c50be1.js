/*! For license information please see main.e2c50be1.js.LICENSE.txt */
(()=>{var t={2127:(t,e,n)=>{"use strict";var o=n(2538);function r(t){var e=[1/0,1/0,-1/0,-1/0];return o.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r,e.Z=r},7872:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var o={type:"Feature"};return(0===n.id||n.id)&&(o.id=n.id),n.bbox&&(o.bbox=n.bbox),o.properties=e||{},o.geometry=t,o}function o(t,e,o){if(void 0===o&&(o={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,o)}function r(t,e,o){void 0===o&&(o={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,o)}function i(t,e,o){if(void 0===o&&(o={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,o)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,o){return void 0===o&&(o={}),n({type:"MultiLineString",coordinates:t},e,o)}function l(t,e,o){return void 0===o&&(o={}),n({type:"MultiPoint",coordinates:t},e,o)}function u(t,e,o){return void 0===o&&(o={}),n({type:"MultiPolygon",coordinates:t},e,o)}function c(t,n){void 0===n&&(n="kilometers");var o=e.factors[n];if(!o)throw new Error(n+" units is invalid");return t*o}function p(t,n){void 0===n&&(n="kilometers");var o=e.factors[n];if(!o)throw new Error(n+" units is invalid");return t/o}function h(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return o(e).geometry;case"LineString":return i(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=o,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.polygon=r,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.lineString=i,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,o){return void 0===o&&(o={}),n({type:"GeometryCollection",geometries:t},e,o)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=p,e.lengthToDegrees=function(t,e){return h(p(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=h,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(p(t,e),n)},e.convertArea=function(t,n,o){if(void 0===n&&(n="meters"),void 0===o&&(o="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[n];if(!r)throw new Error("invalid original units");var i=e.areaFactors[o];if(!i)throw new Error("invalid final units");return t/r*i},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},2538:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7872);function r(t,e,n){if(null!==t)for(var o,i,s,a,l,u,c,p,h=0,d=0,f=t.type,g="FeatureCollection"===f,m="Feature"===f,y=g?t.features.length:1,v=0;v<y;v++){l=(p=!!(c=g?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var C=0,w=0;if(null!==(a=p?c.geometries[_]:c)){u=a.coordinates;var b=a.type;switch(h=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(u,d,v,C,w))return!1;d++,C++;break;case"LineString":case"MultiPoint":for(o=0;o<u.length;o++){if(!1===e(u[o],d,v,C,w))return!1;d++,"MultiPoint"===b&&C++}"LineString"===b&&C++;break;case"Polygon":case"MultiLineString":for(o=0;o<u.length;o++){for(i=0;i<u[o].length-h;i++){if(!1===e(u[o][i],d,v,C,w))return!1;d++}"MultiLineString"===b&&C++,"Polygon"===b&&w++}"Polygon"===b&&C++;break;case"MultiPolygon":for(o=0;o<u.length;o++){for(w=0,i=0;i<u[o].length;i++){for(s=0;s<u[o][i].length-h;s++){if(!1===e(u[o][i][s],d,v,C,w))return!1;d++}w++}C++}break;case"GeometryCollection":for(o=0;o<a.geometries.length;o++)if(!1===r(a.geometries[o],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,o,r,i,s,a,l,u,c,p,h=0,d="FeatureCollection"===t.type,f="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:f?t.geometry:t,u=d?t.features[n].properties:f?t.properties:{},c=d?t.features[n].bbox:f?t.bbox:void 0,p=d?t.features[n].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(i=l?a.geometries[r]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,u,c,p))return!1;break;case"GeometryCollection":for(o=0;o<i.geometries.length;o++)if(!1===e(i.geometries[o],h,u,c,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,u,c,p))return!1;h++}}function l(t,e){a(t,(function(t,n,r,i,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(o.feature(t,r,{bbox:i,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:a,coordinates:t.coordinates[u]};if(!1===e(o.feature(c,r),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,i){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,c=0,p=0;return!1!==r(t,(function(r,a,h,d,f){if(void 0===l||n>u||d>c||f>p)return l=r,u=n,c=d,p=f,void(s=0);var g=o.lineString([l,r],t.properties);if(!1===e(g,n,i,f,s))return!1;s++,l=r}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,r){if(null!==t.geometry){var i=t.geometry.type,s=t.geometry.coordinates;switch(i){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(o.lineString(s[a],t.properties),n,r,a))return!1}}}))}e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.coordEach=r,e.coordReduce=function(t,e,n,o){var i=n;return r(t,(function(t,o,r,s,a){i=0===o&&void 0===n?t:e(i,t,o,r,s,a)}),o),i},e.featureEach=s,e.featureReduce=function(t,e,n){var o=n;return s(t,(function(t,r){o=0===r&&void 0===n?t:e(o,t,r)})),o},e.findPoint=function(t,e){if(e=e||{},!o.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return o.point(u,l,e);case"MultiPoint":return i<0&&(i=u.length+i),o.point(u[i],l,e);case"LineString":return a<0&&(a=u.length+a),o.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),o.point(u[s][a],l,e);case"MultiLineString":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a),o.point(u[i][a],l,e);case"MultiPolygon":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),a<0&&(a=u[i][s].length-a),o.point(u[i][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!o.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),o.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),o.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a-1),o.lineString([u[i][a],u[i][a+1]],l,e);case"MultiPolygon":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),a<0&&(a=u[i][s].length-a-1),o.lineString([u[i][s][a],u[i][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var o=n;return l(t,(function(t,r,i){o=0===r&&0===i&&void 0===n?t:e(o,t,r,i)})),o},e.geomEach=a,e.geomReduce=function(t,e,n){var o=n;return a(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)})),o},e.lineEach=c,e.lineReduce=function(t,e,n){var o=n;return c(t,(function(t,r,i,s){o=0===r&&void 0===n?t:e(o,t,r,i,s)})),o},e.propEach=i,e.propReduce=function(t,e,n){var o=n;return i(t,(function(t,r){o=0===r&&void 0===n?t:e(o,t,r)})),o},e.segmentEach=u,e.segmentReduce=function(t,e,n){var o=n,r=!1;return u(t,(function(t,i,s,a,l){o=!1===r&&void 0===n?t:e(o,t,i,s,a,l),r=!0})),o}},7520:(t,e,n)=>{"use strict";function o(t){return null==t||""===t?null:t}function r(t,e){return void 0===e&&(e=!1),null!=t&&(""!==t||e)}function i(t){return!r(t)}function s(t){return null==t||0===t.length}function a(t){return null!=t&&"function"===typeof t.toString?t.toString():null}function l(t){if(void 0!==t){if(null===t||""===t)return null;if("number"===typeof t)return isNaN(t)?void 0:t;var e=parseInt(t,10);return isNaN(e)?void 0:e}}function u(t){if(void 0!==t)return null!==t&&""!==t&&("boolean"===typeof t?t:/true/i.test(t))}function c(t){if(t instanceof Set||t instanceof Map){var e=[];return t.forEach((function(t){return e.push(t)})),e}return Object.values(t)}n.r(e),n.d(e,{AbstractHeaderCellCtrl:()=>Xc,AgAbstractField:()=>Qr,AgAbstractLabel:()=>Zr,AgAutocomplete:()=>of,AgCheckbox:()=>hi,AgDialog:()=>zd,AgGroupComponent:()=>Ed,AgInputDateField:()=>nd,AgInputNumberField:()=>Bi,AgInputRange:()=>rd,AgInputTextArea:()=>td,AgInputTextField:()=>ki,AgMenuItemComponent:()=>Ld,AgMenuList:()=>Od,AgMenuPanel:()=>Ad,AgPanel:()=>kd,AgPickerField:()=>ei,AgPromise:()=>mr,AgPromiseStatus:()=>ur,AgRadioButton:()=>fi,AgRichSelect:()=>vd,AgSelect:()=>ai,AgSlider:()=>wd,AgStackComponentsRegistry:()=>We,AgToggleButton:()=>Qh,AlignedGridsService:()=>mf,AllCommunityModules:()=>fv,AnimateShowChangeCellRenderer:()=>Ds,AnimateSlideCellRenderer:()=>Ns,AnimationFrameService:()=>fh,AutoScrollService:()=>Al,AutoWidthCalculator:()=>yh,Autowired:()=>$,BarColumnLabelPlacement:()=>Mm,BaseComponentWrapper:()=>oy,BaseCreator:()=>Jy,BaseGridSerializingSession:()=>Qy,Bean:()=>Q,BeanStub:()=>Ht,Beans:()=>tu,BodyDropPivotTarget:()=>Ec,BodyDropTarget:()=>Ic,CHART_TOOLBAR_ALLOW_LIST:()=>sy,CHART_TOOL_PANEL_ALLOW_LIST:()=>iy,CHART_TOOL_PANEL_MENU_OPTIONS:()=>ay,CellComp:()=>gc,CellCtrl:()=>pu,CellNavigationService:()=>hf,CellPositionUtils:()=>jg,CellRangeType:()=>zl,ChangedPath:()=>Gh,CheckboxCellEditor:()=>Ia,CheckboxCellRenderer:()=>Ra,CheckboxSelectionComponent:()=>zs,ClientSideRowModelModule:()=>By,ClientSideRowModelSteps:()=>rl,ColDefUtil:()=>ce,Column:()=>ht,ColumnApi:()=>xf,ColumnFactory:()=>Xt,ColumnGroup:()=>Kt,ColumnKeyCreator:()=>h,ColumnModel:()=>Fe,ColumnUtils:()=>Be,Component:()=>Tr,ComponentUtil:()=>ye,Context:()=>Y,CssClassApplier:()=>Mc,CssClassManager:()=>br,CsvCreator:()=>rv,CsvExportModule:()=>lv,CtrlsService:()=>pm,CustomTooltipFeature:()=>wr,DEFAULT_CHART_GROUPS:()=>ry,DataTypeService:()=>Ym,DateCellEditor:()=>Ca,DateFilter:()=>Ri,DateStringCellEditor:()=>Ea,DisplayedGroupCreator:()=>je,Downloader:()=>$y,DragAndDropService:()=>qs,DragService:()=>al,DragSourceType:()=>Hi,Environment:()=>xg,EventService:()=>st,Events:()=>Zt,ExcelFactoryMode:()=>Ws,ExpressionService:()=>If,FilterManager:()=>gl,FloatingFilterMapper:()=>$a,FocusService:()=>vp,GROUP_AUTO_COLUMN_ID:()=>te,Grid:()=>ty,GridApi:()=>pl,GridBodyComp:()=>tc,GridBodyCtrl:()=>Hl,GridComp:()=>Uf,GridCoreCreator:()=>ny,GridCtrl:()=>zf,GridHeaderComp:()=>Jp,GridHeaderCtrl:()=>Yp,GridOptionsService:()=>Lm,GridSerializer:()=>av,GroupCellRenderer:()=>ia,GroupCellRendererCtrl:()=>na,GroupInstanceIdCreator:()=>Jt,HeaderCellCtrl:()=>wp,HeaderFilterCellComp:()=>Cl,HeaderFilterCellCtrl:()=>np,HeaderGroupCellCtrl:()=>Ip,HeaderNavigationDirection:()=>pp,HeaderNavigationService:()=>Wp,HeaderPositionUtils:()=>em,HeaderRowComp:()=>Hc,HeaderRowContainerComp:()=>jp,HeaderRowContainerCtrl:()=>Bp,HeaderRowCtrl:()=>Lp,HeaderRowType:()=>wc,HorizontalDirection:()=>Wi,HorizontalResizeService:()=>th,InfiniteRowModelModule:()=>Zy,KeyCode:()=>Qo,LargeTextCellEditor:()=>Cs,LayoutCssClasses:()=>cl,LocaleService:()=>km,Logger:()=>Gf,LoggerFactory:()=>kf,ManagedFocusFeature:()=>Br,ModuleNames:()=>z,ModuleRegistry:()=>W,MouseEventService:()=>sc,MoveColumnFeature:()=>Rc,NavigationService:()=>cc,NumberCellEditor:()=>ya,NumberFilter:()=>qi,NumberSequence:()=>dr,Optional:()=>tt,PaginationProxy:()=>Xh,PinnedRowModel:()=>Fh,PopupComponent:()=>ys,PopupEditorWrapper:()=>dc,PopupService:()=>Kd,PositionableFeature:()=>Ur,PostConstruct:()=>Z,PreConstruct:()=>K,PreDestroy:()=>J,PropertyKeys:()=>de,ProvidedColumnGroup:()=>ft,ProvidedFilter:()=>Xr,Qualifier:()=>nt,QuerySelector:()=>Rr,RefSelector:()=>Or,ResizeObserverService:()=>ph,RowAnimationCssClasses:()=>Pl,RowContainerComp:()=>bc,RowContainerCtrl:()=>Zu,RowContainerName:()=>mu,RowContainerType:()=>yu,RowCtrl:()=>_u,RowHighlightPosition:()=>ol,RowNode:()=>ks,RowNodeBlock:()=>Vh,RowNodeBlockLoader:()=>Uh,RowNodeSorter:()=>lm,RowPositionUtils:()=>Bg,RowRenderer:()=>Ph,RowType:()=>vy,ScalarFilter:()=>wi,ScrollVisibleService:()=>oc,SelectCellEditor:()=>xs,SelectableService:()=>Ig,SelectionHandleType:()=>Vl,ServerSideTransactionResultStatus:()=>lh,SetLeftFeature:()=>Zc,SimpleFilter:()=>_i,SortController:()=>Kf,SortIndicatorComp:()=>us,StandardMenuFactory:()=>oh,StylingService:()=>Zh,TabGuardClassNames:()=>jc,TabGuardComp:()=>pd,TabGuardCtrl:()=>hp,TabbedLayout:()=>sh,TemplateService:()=>Mf,TextCellEditor:()=>Ps,TextFilter:()=>Zi,TextFloatingFilter:()=>is,Timer:()=>yr,TouchListener:()=>ss,UserComponentFactory:()=>nl,UserComponentRegistry:()=>Na,ValueCache:()=>ag,ValueFormatterService:()=>Mh,ValueParserService:()=>Jm,ValueService:()=>Tf,VanillaFrameworkOverrides:()=>af,VerticalDirection:()=>Ui,VirtualList:()=>fd,XmlFactory:()=>cv,ZipContainer:()=>dv,_:()=>hr,__FORCE_MODULE_DETECTION:()=>ly,getRowContainerTypeForName:()=>qu,simpleHttpRequest:()=>ah});var p=Object.freeze({__proto__:null,makeNull:o,exists:r,missing:i,missingOrEmpty:s,toStringOrNull:a,attrToNumber:l,attrToBoolean:u,attrToString:function(t){if(null!=t&&""!==t)return t},referenceCompare:function(t,e){return null==t&&null==e||(null!=t||null==e)&&((null==t||null!=e)&&t===e)},jsonEquals:function(t,e){return(t?JSON.stringify(t):null)===(e?JSON.stringify(e):null)},defaultComparator:function(t,e,n){void 0===n&&(n=!1);var o=null==t,r=null==e;if(t&&t.toNumber&&(t=t.toNumber()),e&&e.toNumber&&(e=e.toNumber()),o&&r)return 0;if(o)return-1;if(r)return 1;function i(t,e){return t>e?1:t<e?-1:0}if("string"!==typeof t)return i(t,e);if(!n)return i(t,e);try{return t.localeCompare(e)}catch(s){return i(t,e)}},values:c}),h=function(){function t(){this.existingKeys={}}return t.prototype.addExistingKeys=function(t){for(var e=0;e<t.length;e++)this.existingKeys[t[e]]=!0},t.prototype.getUniqueKey=function(t,e){t=a(t);for(var n=0;;){var o=void 0;if(t?(o=t,0!==n&&(o+="_"+n)):e?(o=e,0!==n&&(o+="_"+n)):o=n,!this.existingKeys[o])return this.existingKeys[o]=!0,String(o);n++}},t}(),d=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s};function g(t,e){var n,o;if(null!=t)if(Array.isArray(t))for(var r=0;r<t.length;r++)e(r.toString(),t[r]);else try{for(var i=d(Object.entries(t)),s=i.next();!s.done;s=i.next()){var a=f(s.value,2);e(a[0],a[1])}}catch(l){n={error:l}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}function m(t){for(var e={},n=Object.keys(t),o=0;o<n.length;o++){var r=n[o],i=t[r];e[r]=i}return e}function y(t,e){if(t){var n=t,o={};return Object.keys(n).forEach((function(t){if(!(e&&e.indexOf(t)>=0)){var r=n[t],i=T(r)&&r.constructor===Object;o[t]=i?y(r):r}})),o}}function v(t,e){return t[e]}function _(t,e,n){t[e]=n}function C(t,e,n,o){var r=v(t,n);void 0!==r&&_(e,n,o?o(r):r)}function w(t){var e={};return t.filter((function(t){return null!=t})).forEach((function(t){Object.keys(t).forEach((function(t){return e[t]=null}))})),Object.keys(e)}function b(t){if(!t)return[];var e=Object;if("function"===typeof e.values)return e.values(t);var n=[];for(var o in t)t.hasOwnProperty(o)&&t.propertyIsEnumerable(o)&&n.push(t[o]);return n}function x(t,e,n,o){void 0===n&&(n=!0),void 0===o&&(o=!1),r(e)&&g(e,(function(e,r){var i=t[e];if(i!==r){if(o)if(null==i&&null!=r)"object"===typeof r&&r.constructor===Object&&(i={},t[e]=i);T(r)&&T(i)&&!Array.isArray(i)?x(i,r,n,o):(n||void 0!==r)&&(t[e]=r)}}))}function E(t,e,n){if(e&&t){if(!n)return t[e];for(var o=e.split("."),r=t,i=0;i<o.length;i++){if(null==r)return;r=r[o[i]]}return r}}function S(t,e){Object.keys(t).forEach((function(e){"object"===typeof t[e]&&(t[e]=void 0)}));var n=Object.getPrototypeOf(t),o={};Object.keys(n).forEach((function(t){if("function"===typeof n[t]){o[t]={value:function(){console.warn("AG Grid: "+e+" function "+t+"() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.")},writable:!0}}})),Object.defineProperties(t,o)}function T(t){return"object"===typeof t&&null!==t}var R=Object.freeze({__proto__:null,iterateObject:g,cloneObject:m,deepCloneObject:function(t){return JSON.parse(JSON.stringify(t))},deepCloneDefinition:y,getProperty:v,setProperty:_,copyPropertiesIfPresent:function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];n.forEach((function(n){return C(t,e,n)}))},copyPropertyIfPresent:C,getAllKeysInObjects:w,getAllValuesInObject:b,mergeDeep:x,missingOrEmptyObject:function(t){return i(t)||0===Object.keys(t).length},get:function(t,e,n){if(null==t)return n;for(var o=e.split("."),r=t;o.length>1;)if(null==(r=r[o.shift()]))return n;var i=r[o[0]];return null!=i?i:n},set:function(t,e,n){if(null!=t){var o=e.split("."),r=t;o.forEach((function(t,e){r[t]||(r[t]={}),e<o.length-1&&(r=r[t])})),r[o[o.length-1]]=n}},getValueUsingField:E,removeAllReferences:S,isNonNullObject:T}),O={};function P(t,e){O[e]||(t(),O[e]=!0)}function I(t){if(t.name)return t.name;var e=/function\s+([^\(]+)/.exec(t.toString());return e&&2===e.length?e[1].trim():null}function A(t){return!!(t&&t.constructor&&t.call&&t.apply)}function D(t){F(t,400)}var M=[],L=!1;function N(t){M.push(t),L||(L=!0,window.setTimeout((function(){var t=M.slice();M.length=0,L=!1,t.forEach((function(t){return t()}))}),0))}function F(t,e){void 0===e&&(e=0),t.length>0&&window.setTimeout((function(){return t.forEach((function(t){return t()}))}),e)}function k(t,e){var n;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];var i=this;window.clearTimeout(n),n=window.setTimeout((function(){t.apply(i,o)}),e)}}function G(t,e){var n=0;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];var i=(new Date).getTime();i-n<e||(n=i,t.apply(this,o))}}function B(t,e,n,o){void 0===n&&(n=100);var r=(new Date).getTime(),i=null,s=!1,a=function(){var a=(new Date).getTime()-r>n;(t()||a)&&(e(),s=!0,null!=i&&(window.clearInterval(i),i=null),a&&o&&console.warn(o))};a(),s||(i=window.setInterval(a,10))}function V(t){t&&t()}var z,j=Object.freeze({__proto__:null,doOnce:P,getFunctionName:I,isFunction:A,executeInAWhile:D,executeNextVMTurn:N,executeAfter:F,debounce:k,throttle:G,waitUntil:B,compose:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return t.reduce((function(t,e){return e(t)}),e)}},callIfPresent:V,noop:function(){}});!function(t){t.CommunityCoreModule="@ag-grid-community/core",t.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",t.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",t.CsvExportModule="@ag-grid-community/csv-export",t.EnterpriseCoreModule="@ag-grid-enterprise/core",t.RowGroupingModule="@ag-grid-enterprise/row-grouping",t.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",t.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",t.MenuModule="@ag-grid-enterprise/menu",t.SetFilterModule="@ag-grid-enterprise/set-filter",t.MultiFilterModule="@ag-grid-enterprise/multi-filter",t.StatusBarModule="@ag-grid-enterprise/status-bar",t.SideBarModule="@ag-grid-enterprise/side-bar",t.RangeSelectionModule="@ag-grid-enterprise/range-selection",t.MasterDetailModule="@ag-grid-enterprise/master-detail",t.RichSelectModule="@ag-grid-enterprise/rich-select",t.GridChartsModule="@ag-grid-enterprise/charts",t.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",t.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",t.ExcelExportModule="@ag-grid-enterprise/excel-export",t.ClipboardModule="@ag-grid-enterprise/clipboard",t.SparklinesModule="@ag-grid-enterprise/sparklines",t.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",t.AngularModule="@ag-grid-community/angular",t.ReactModule="@ag-grid-community/react",t.VueModule="@ag-grid-community/vue"}(z||(z={}));var H=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},U=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},W=function(){function t(){}return t.register=function(e){t.__register(e,!0,void 0)},t.registerModules=function(e){t.__registerModules(e,!0,void 0)},t.__register=function(e,n,o){t.runVersionChecks(e),void 0!==o?(t.areGridScopedModules=!0,void 0===t.gridModulesMap[o]&&(t.gridModulesMap[o]={}),t.gridModulesMap[o][e.moduleName]=e):t.globalModulesMap[e.moduleName]=e,t.setModuleBased(n)},t.__unRegisterGridModules=function(e){delete t.gridModulesMap[e]},t.__registerModules=function(e,n,o){t.setModuleBased(n),e&&e.forEach((function(e){return t.__register(e,n,o)}))},t.isValidModuleVersion=function(e){var n=H(e.version.split(".")||[],2),o=n[0],r=n[1],i=H(t.currentModuleVersion.split(".")||[],2),s=i[0],a=i[1];return o===s&&r===a},t.runVersionChecks=function(e){if(t.currentModuleVersion||(t.currentModuleVersion=e.version),e.version?t.isValidModuleVersion(e)||console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+e.moduleName+"' is version "+e.version+" but the other modules are version "+this.currentModuleVersion+". Please update all modules to the same version."):console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+e.moduleName+"' is incompatible. Please update all modules to the same version."),e.validate){var n=e.validate();if(!n.isValid){var o=n;console.error("AG Grid: "+o.message)}}},t.setModuleBased=function(e){void 0===t.moduleBased?t.moduleBased=e:t.moduleBased!==e&&P((function(){console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")}),"ModulePackageCheck")},t.__setIsBundled=function(){t.isBundled=!0},t.__assertRegistered=function(e,n,o){var r;if(this.__isRegistered(e,o))return!0;var i,s=n+e;if(t.isBundled)i="AG Grid: unable to use "+n+" as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src=\"https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js\"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise";else if(t.moduleBased||void 0===t.moduleBased){var a=null===(r=Object.entries(z).find((function(t){var n=H(t,2);return n[0],n[1]===e})))||void 0===r?void 0:r[0];i="AG Grid: unable to use "+n+" as the "+a+" is not registered"+(t.areGridScopedModules?" for gridId: "+o:"")+". Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { "+a+" } from '"+e+"';\n    \n    ModuleRegistry.registerModules([ "+a+" ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/"}else i="AG Grid: unable to use "+n+" as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/";return P((function(){console.warn(i)}),s),!1},t.__isRegistered=function(e,n){var o;return!!t.globalModulesMap[e]||!!(null===(o=t.gridModulesMap[n])||void 0===o?void 0:o[e])},t.__getRegisteredModules=function(e){return U(U([],H(c(t.globalModulesMap))),H(c(t.gridModulesMap[e]||{})))},t.__getGridRegisteredModules=function(e){var n;return c(null!==(n=t.gridModulesMap[e])&&void 0!==n?n:{})||[]},t.__isPackageBased=function(){return!t.moduleBased},t.globalModulesMap={},t.gridModulesMap={},t.areGridScopedModules=!1,t}(),q=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},X=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Y=function(){function t(t,e){if(this.beanWrappers={},this.destroyed=!1,t&&t.beanClasses){this.contextParams=t,this.logger=e,this.logger.log(">> creating ag-Application Context"),this.createBeans();var n=this.getBeanInstances();this.wireBeans(n),this.logger.log(">> ag-Application Context ready - component is alive")}}return t.prototype.getBeanInstances=function(){return c(this.beanWrappers).map((function(t){return t.beanInstance}))},t.prototype.createBean=function(t,e){if(!t)throw Error("Can't wire to bean since it is null");return this.wireBeans([t],e),t},t.prototype.wireBeans=function(t,e){this.autoWireBeans(t),this.methodWireBeans(t),this.callLifeCycleMethods(t,"preConstructMethods"),r(e)&&t.forEach(e),this.callLifeCycleMethods(t,"postConstructMethods")},t.prototype.createBeans=function(){var t=this;this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),g(this.beanWrappers,(function(e,n){var o;n.bean.__agBeanMetaData&&n.bean.__agBeanMetaData.autowireMethods&&n.bean.__agBeanMetaData.autowireMethods.agConstructor&&(o=n.bean.__agBeanMetaData.autowireMethods.agConstructor);var r=t.getBeansForParameters(o,n.bean.name),i=new(n.bean.bind.apply(n.bean,X([null],q(r))));n.beanInstance=i}));var e=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+e)},t.prototype.createBeanWrapper=function(t){var e=t.__agBeanMetaData;if(!e){var n=void 0;return n=t.prototype.constructor?I(t.prototype.constructor):""+t,void console.error("Context item "+n+" is not a bean")}var o={bean:t,beanInstance:null,beanName:e.beanName};this.beanWrappers[e.beanName]=o},t.prototype.autoWireBeans=function(t){var e=this;t.forEach((function(t){e.forEachMetaDataInHierarchy(t,(function(n,o){var r=n.agClassAttributes;r&&r.forEach((function(n){var r=e.lookupBeanInstance(o,n.beanName,n.optional);t[n.attributeName]=r}))}))}))},t.prototype.methodWireBeans=function(t){var e=this;t.forEach((function(t){e.forEachMetaDataInHierarchy(t,(function(n,o){g(n.autowireMethods,(function(n,r){if("agConstructor"!==n){var i=e.getBeansForParameters(r,o);t[n].apply(t,i)}}))}))}))},t.prototype.forEachMetaDataInHierarchy=function(t,e){for(var n=Object.getPrototypeOf(t);null!=n;){var o=n.constructor;if(o.hasOwnProperty("__agBeanMetaData"))e(o.__agBeanMetaData,this.getBeanName(o));n=Object.getPrototypeOf(n)}},t.prototype.getBeanName=function(t){if(t.__agBeanMetaData&&t.__agBeanMetaData.beanName)return t.__agBeanMetaData.beanName;var e=t.toString();return e.substring(9,e.indexOf("("))},t.prototype.getBeansForParameters=function(t,e){var n=this,o=[];return t&&g(t,(function(t,r){var i=n.lookupBeanInstance(e,r);o[Number(t)]=i})),o},t.prototype.lookupBeanInstance=function(t,e,n){if(void 0===n&&(n=!1),this.destroyed)return this.logger.log("AG Grid: bean reference "+e+" is used after the grid is destroyed!"),null;if("context"===e)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(e))return this.contextParams.providedBeanInstances[e];var o=this.beanWrappers[e];return o?o.beanInstance:(n||console.error("AG Grid: unable to find bean reference "+e+" while initialising "+t),null)},t.prototype.callLifeCycleMethods=function(t,e){var n=this;t.forEach((function(t){return n.callLifeCycleMethodsOnBean(t,e)}))},t.prototype.callLifeCycleMethodsOnBean=function(t,e,n){var o={};this.forEachMetaDataInHierarchy(t,(function(t){var r=t[e];r&&r.forEach((function(t){t!=n&&(o[t]=!0)}))})),Object.keys(o).forEach((function(e){return t[e]()}))},t.prototype.getBean=function(t){return this.lookupBeanInstance("getBean",t,!0)},t.prototype.destroy=function(){if(!this.destroyed){this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");var t=this.getBeanInstances();this.destroyBeans(t),this.contextParams.providedBeanInstances=null,W.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}},t.prototype.destroyBean=function(t){t&&this.destroyBeans([t])},t.prototype.destroyBeans=function(t){var e=this;return t?(t.forEach((function(t){e.callLifeCycleMethodsOnBean(t,"preDestroyMethods","destroy");var n=t;"function"===typeof n.destroy&&n.destroy()})),[]):[]},t.prototype.isDestroyed=function(){return this.destroyed},t.prototype.getGridId=function(){return this.contextParams.gridId},t}();function K(t,e,n){var o=ot(t.constructor);o.preConstructMethods||(o.preConstructMethods=[]),o.preConstructMethods.push(e)}function Z(t,e,n){var o=ot(t.constructor);o.postConstructMethods||(o.postConstructMethods=[]),o.postConstructMethods.push(e)}function J(t,e,n){var o=ot(t.constructor);o.preDestroyMethods||(o.preDestroyMethods=[]),o.preDestroyMethods.push(e)}function Q(t){return function(e){ot(e).beanName=t}}function $(t){return function(e,n,o){et(e,t,!1,e,n,null)}}function tt(t){return function(e,n,o){et(e,t,!0,e,n,null)}}function et(t,e,n,o,r,i){if(null!==e)if("number"!==typeof i){var s=ot(t.constructor);s.agClassAttributes||(s.agClassAttributes=[]),s.agClassAttributes.push({attributeName:r,beanName:e,optional:n})}else console.error("AG Grid: Autowired should be on an attribute");else console.error("AG Grid: Autowired name should not be null")}function nt(t){return function(e,n,o){var r,i="function"==typeof e?e:e.constructor;if("number"===typeof o){var s=void 0;n?(r=ot(i),s=n):(r=ot(i),s="agConstructor"),r.autowireMethods||(r.autowireMethods={}),r.autowireMethods[s]||(r.autowireMethods[s]={}),r.autowireMethods[s][o]=t}}}function ot(t){return t.hasOwnProperty("__agBeanMetaData")||(t.__agBeanMetaData={}),t.__agBeanMetaData}var rt=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},it=function(t,e){return function(n,o){e(n,o,t)}},st=function(){function t(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}return t.prototype.setBeans=function(t,e,n,o){if(void 0===o&&(o=null),this.frameworkOverrides=n,this.gridOptionsService=e,o){var r=e.useAsyncEvents();this.addGlobalListener(o,r)}},t.prototype.getListeners=function(t,e,n){var o=e?this.allAsyncListeners:this.allSyncListeners,r=o.get(t);return!r&&n&&(r=new Set,o.set(t,r)),r},t.prototype.noRegisteredListenersExist=function(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size},t.prototype.addEventListener=function(t,e,n){void 0===n&&(n=!1),this.getListeners(t,n,!0).add(e)},t.prototype.removeEventListener=function(t,e,n){void 0===n&&(n=!1);var o=this.getListeners(t,n,!1);o&&(o.delete(e),0===o.size&&(n?this.allAsyncListeners:this.allSyncListeners).delete(t))},t.prototype.addGlobalListener=function(t,e){void 0===e&&(e=!1),(e?this.globalAsyncListeners:this.globalSyncListeners).add(t)},t.prototype.removeGlobalListener=function(t,e){void 0===e&&(e=!1),(e?this.globalAsyncListeners:this.globalSyncListeners).delete(t)},t.prototype.dispatchEvent=function(t){var e=t;if(this.gridOptionsService){var n=this.gridOptionsService,o=n.api,r=n.columnApi,i=n.context;e.api=o,e.columnApi=r,e.context=i}this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0},t.prototype.dispatchEventOnce=function(t){this.firedEvents[t.type]||this.dispatchEvent(t)},t.prototype.dispatchToListeners=function(t,e){var n=this,o=t.type;if(e&&"event"in t){var r=t.event;r instanceof Event&&(t.eventPath=r.composedPath())}var i=new Set(this.getListeners(o,e,!1));i&&function(o){o.forEach((function(o){e?n.dispatchAsync((function(){return o(t)})):o(t)}))}(i),new Set(e?this.globalAsyncListeners:this.globalSyncListeners).forEach((function(r){e?n.dispatchAsync((function(){return n.frameworkOverrides.dispatchEvent(o,(function(){return r(o,t)}),!0)})):n.frameworkOverrides.dispatchEvent(o,(function(){return r(o,t)}),!0)}))},t.prototype.dispatchAsync=function(t){this.asyncFunctionsQueue.push(t),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)},t.prototype.flushAsyncQueue=function(){this.scheduled=!1;var t=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],t.forEach((function(t){return t()}))},rt([it(0,nt("loggerFactory")),it(1,nt("gridOptionsService")),it(2,nt("frameworkOverrides")),it(3,nt("globalEventListener"))],t.prototype,"setBeans",null),t=rt([Q("eventService")],t)}(),at=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},lt=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},ut=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},ct=0;function pt(){return ct++}var ht=function(){function t(t,e,n,o){this.instanceId=pt(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new st,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=t,this.userProvidedColDef=e,this.colId=n,this.primary=o,this.setState(t)}return t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setState=function(t){void 0!==t.sort?"asc"!==t.sort&&"desc"!==t.sort||(this.sort=t.sort):"asc"!==t.initialSort&&"desc"!==t.initialSort||(this.sort=t.initialSort);var e=l(t.sortIndex),n=l(t.initialSortIndex);void 0!==e?null!==e&&(this.sortIndex=e):null!==n&&(this.sortIndex=n);var o=u(t.hide),r=u(t.initialHide);this.visible=void 0!==o?!o:!r,void 0!==t.pinned?this.setPinned(t.pinned):this.setPinned(t.initialPinned);var i=l(t.flex),s=l(t.initialFlex);void 0!==i?this.flex=i:void 0!==s&&(this.flex=s)},t.prototype.setColDef=function(t,e){this.colDef=t,this.userProvidedColDef=e,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))},t.prototype.getUserProvidedColDef=function(){return this.userProvidedColDef},t.prototype.setParent=function(t){this.parent=t},t.prototype.getParent=function(){return this.parent},t.prototype.setOriginalParent=function(t){this.originalParent=t},t.prototype.getOriginalParent=function(){return this.originalParent},t.prototype.initialise=function(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()},t.prototype.initDotNotation=function(){var t=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=r(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!t,this.tooltipFieldContainsDots=r(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!t},t.prototype.initMinAndMaxWidths=function(){var t=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(t),this.maxWidth=this.columnUtils.calculateColMaxWidth(t)},t.prototype.initTooltip=function(){this.tooltipEnabled=r(this.colDef.tooltipField)||r(this.colDef.tooltipValueGetter)||r(this.colDef.tooltipComponent)},t.prototype.resetActualWidth=function(t){void 0===t&&(t="api");var e=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(e,t,!0)},t.prototype.isEmptyGroup=function(){return!1},t.prototype.isRowGroupDisplayed=function(t){if(i(this.colDef)||i(this.colDef.showRowGroup))return!1;var e=!0===this.colDef.showRowGroup,n=this.colDef.showRowGroup===t;return e||n},t.prototype.isPrimary=function(){return this.primary},t.prototype.isFilterAllowed=function(){return!!this.colDef.filter},t.prototype.isFieldContainsDots=function(){return this.fieldContainsDots},t.prototype.isTooltipEnabled=function(){return this.tooltipEnabled},t.prototype.isTooltipFieldContainsDots=function(){return this.tooltipFieldContainsDots},t.prototype.validate=function(){var t=this.colDef;function e(t,e,n){P((function(){n?console.warn(t,n):P((function(){return console.warn(t)}),e)}),e)}if(this.gridOptionsService.isRowModelType("clientSide")&&!W.__isRegistered(z.RowGroupingModule,this.gridOptionsService.getGridId())){(n=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter((function(e){return r(t[e])}))).length>0&&W.__assertRegistered(z.RowGroupingModule,n.map((function(t){return"colDef."+t})).join(", "),this.gridOptionsService.getGridId())}if("agRichSelect"!==this.colDef.cellEditor&&"agRichSelectCellEditor"!==this.colDef.cellEditor||W.__assertRegistered(z.RichSelectModule,this.colDef.cellEditor,this.gridOptionsService.getGridId()),this.gridOptionsService.isTreeData()){(n=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter((function(e){return r(t[e])}))).length>0&&e("AG Grid: "+n.join()+" is not possible when doing tree data, your column definition should not have "+n.join(),"TreeDataCannotRowGroup")}if(r(t.menuTabs))if(Array.isArray(t.menuTabs)){var n,o=["filterMenuTab"],i=["columnsMenuTab","generalMenuTab"];(n=i.filter((function(e){return t.menuTabs.includes(e)}))).length>0&&W.__assertRegistered(z.MenuModule,"menuTab(s): "+n.map((function(t){return"'"+t+"'"})).join(),this.gridOptionsService.getGridId()),t.menuTabs.forEach((function(t){i.includes(t)||o.includes(t)||e("AG Grid: '"+t+"' is not valid for 'colDef.menuTabs'. Valid values are: "+ut(ut([],lt(o)),lt(i)).map((function(t){return"'"+t+"'"})).join()+".","wrongValue_menuTabs_"+t)}))}else e("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof t.menuTabs,"wrongType_menuTabs");r(t.columnsMenuParams)&&W.__assertRegistered(z.MenuModule,"columnsMenuParams",this.gridOptionsService.getGridId()),r(t.columnsMenuParams)&&W.__assertRegistered(z.ColumnsToolPanelModule,"columnsMenuParams",this.gridOptionsService.getGridId()),r(this.colDef.width)&&"number"!==typeof this.colDef.width&&e("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),r(t.columnGroupShow)&&"closed"!==t.columnGroupShow&&"open"!==t.columnGroupShow&&e("AG Grid: '"+t.columnGroupShow+"' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null","columnGroupShow_invalid")},t.prototype.addEventListener=function(t,e){this.eventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.eventService.removeEventListener(t,e)},t.prototype.createColumnFunctionCallbackParams=function(t){return{node:t,data:t.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}},t.prototype.isSuppressNavigable=function(t){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){var e=this.createColumnFunctionCallbackParams(t);return(0,this.colDef.suppressNavigable)(e)}return!1},t.prototype.isCellEditable=function(t){return!(t.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(t,this.colDef.editable)},t.prototype.isSuppressFillHandle=function(){return!!u(this.colDef.suppressFillHandle)},t.prototype.isAutoHeight=function(){return!!u(this.colDef.autoHeight)},t.prototype.isAutoHeaderHeight=function(){return!!u(this.colDef.autoHeaderHeight)},t.prototype.isRowDrag=function(t){return this.isColumnFunc(t,this.colDef.rowDrag)},t.prototype.isDndSource=function(t){return this.isColumnFunc(t,this.colDef.dndSource)},t.prototype.isCellCheckboxSelection=function(t){return this.isColumnFunc(t,this.colDef.checkboxSelection)},t.prototype.isSuppressPaste=function(t){return this.isColumnFunc(t,this.colDef?this.colDef.suppressPaste:null)},t.prototype.isResizable=function(){return!!u(this.colDef.resizable)},t.prototype.isColumnFunc=function(t,e){return"boolean"===typeof e?e:"function"===typeof e&&e(this.createColumnFunctionCallbackParams(t))},t.prototype.setMoving=function(t,e){void 0===e&&(e="api"),this.moving=t,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",e))},t.prototype.createColumnEvent=function(t,e){return{type:t,column:this,columns:[this],source:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},t.prototype.isMoving=function(){return this.moving},t.prototype.getSort=function(){return this.sort},t.prototype.setSort=function(t,e){void 0===e&&(e="api"),this.sort!==t&&(this.sort=t,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",e))),this.dispatchStateUpdatedEvent("sort")},t.prototype.setMenuVisible=function(t,e){void 0===e&&(e="api"),this.menuVisible!==t&&(this.menuVisible=t,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",e)))},t.prototype.isMenuVisible=function(){return this.menuVisible},t.prototype.isSortAscending=function(){return"asc"===this.sort},t.prototype.isSortDescending=function(){return"desc"===this.sort},t.prototype.isSortNone=function(){return i(this.sort)},t.prototype.isSorting=function(){return r(this.sort)},t.prototype.getSortIndex=function(){return this.sortIndex},t.prototype.setSortIndex=function(t){this.sortIndex=t,this.dispatchStateUpdatedEvent("sortIndex")},t.prototype.setAggFunc=function(t){this.aggFunc=t,this.dispatchStateUpdatedEvent("aggFunc")},t.prototype.getAggFunc=function(){return this.aggFunc},t.prototype.getLeft=function(){return this.left},t.prototype.getOldLeft=function(){return this.oldLeft},t.prototype.getRight=function(){return this.left+this.actualWidth},t.prototype.setLeft=function(t,e){void 0===e&&(e="api"),this.oldLeft=this.left,this.left!==t&&(this.left=t,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",e)))},t.prototype.isFilterActive=function(){return this.filterActive},t.prototype.setFilterActive=function(t,e,n){void 0===e&&(e="api"),this.filterActive!==t&&(this.filterActive=t,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",e)));var o=this.createColumnEvent("filterChanged",e);n&&x(o,n),this.eventService.dispatchEvent(o)},t.prototype.isHovered=function(){return this.columnHoverService.isHovered(this)},t.prototype.setPinned=function(t){this.pinned=!0===t||"left"===t?"left":"right"===t?"right":null,this.dispatchStateUpdatedEvent("pinned")},t.prototype.setFirstRightPinned=function(t,e){void 0===e&&(e="api"),this.firstRightPinned!==t&&(this.firstRightPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",e)))},t.prototype.setLastLeftPinned=function(t,e){void 0===e&&(e="api"),this.lastLeftPinned!==t&&(this.lastLeftPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",e)))},t.prototype.isFirstRightPinned=function(){return this.firstRightPinned},t.prototype.isLastLeftPinned=function(){return this.lastLeftPinned},t.prototype.isPinned=function(){return"left"===this.pinned||"right"===this.pinned},t.prototype.isPinnedLeft=function(){return"left"===this.pinned},t.prototype.isPinnedRight=function(){return"right"===this.pinned},t.prototype.getPinned=function(){return this.pinned},t.prototype.setVisible=function(t,e){void 0===e&&(e="api");var n=!0===t;this.visible!==n&&(this.visible=n,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",e))),this.dispatchStateUpdatedEvent("hide")},t.prototype.isVisible=function(){return this.visible},t.prototype.isSpanHeaderHeight=function(){var t=this.getColDef();return!t.suppressSpanHeaderHeight&&!t.autoHeaderHeight},t.prototype.getColDef=function(){return this.colDef},t.prototype.getColumnGroupShow=function(){return this.colDef.columnGroupShow},t.prototype.getColId=function(){return this.colId},t.prototype.getId=function(){return this.colId},t.prototype.getUniqueId=function(){return this.colId},t.prototype.getDefinition=function(){return this.colDef},t.prototype.getActualWidth=function(){return this.actualWidth},t.prototype.getAutoHeaderHeight=function(){return this.autoHeaderHeight},t.prototype.setAutoHeaderHeight=function(t){var e=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,e},t.prototype.createBaseColDefParams=function(t){return{node:t,data:t.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},t.prototype.getColSpan=function(t){if(i(this.colDef.colSpan))return 1;var e=this.createBaseColDefParams(t),n=this.colDef.colSpan(e);return Math.max(n,1)},t.prototype.getRowSpan=function(t){if(i(this.colDef.rowSpan))return 1;var e=this.createBaseColDefParams(t),n=this.colDef.rowSpan(e);return Math.max(n,1)},t.prototype.setActualWidth=function(t,e,n){void 0===e&&(e="api"),void 0===n&&(n=!1),null!=this.minWidth&&(t=Math.max(t,this.minWidth)),null!=this.maxWidth&&(t=Math.min(t,this.maxWidth)),this.actualWidth!==t&&(this.actualWidth=t,this.flex&&"flex"!==e&&"gridInitializing"!==e&&(this.flex=null),n||this.fireColumnWidthChangedEvent(e)),this.dispatchStateUpdatedEvent("width")},t.prototype.fireColumnWidthChangedEvent=function(t){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",t))},t.prototype.isGreaterThanMax=function(t){return null!=this.maxWidth&&t>this.maxWidth},t.prototype.getMinWidth=function(){return this.minWidth},t.prototype.getMaxWidth=function(){return this.maxWidth},t.prototype.getFlex=function(){return this.flex||0},t.prototype.setFlex=function(t){this.flex!==t&&(this.flex=t),this.dispatchStateUpdatedEvent("flex")},t.prototype.setMinimum=function(t){void 0===t&&(t="api"),r(this.minWidth)&&this.setActualWidth(this.minWidth,t)},t.prototype.setRowGroupActive=function(t,e){void 0===e&&(e="api"),this.rowGroupActive!==t&&(this.rowGroupActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",e))),this.dispatchStateUpdatedEvent("rowGroup")},t.prototype.isRowGroupActive=function(){return this.rowGroupActive},t.prototype.setPivotActive=function(t,e){void 0===e&&(e="api"),this.pivotActive!==t&&(this.pivotActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",e))),this.dispatchStateUpdatedEvent("pivot")},t.prototype.isPivotActive=function(){return this.pivotActive},t.prototype.isAnyFunctionActive=function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()},t.prototype.isAnyFunctionAllowed=function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()},t.prototype.setValueActive=function(t,e){void 0===e&&(e="api"),this.aggregationActive!==t&&(this.aggregationActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",e)))},t.prototype.isValueActive=function(){return this.aggregationActive},t.prototype.isAllowPivot=function(){return!0===this.colDef.enablePivot},t.prototype.isAllowValue=function(){return!0===this.colDef.enableValue},t.prototype.isAllowRowGroup=function(){return!0===this.colDef.enableRowGroup},t.prototype.getMenuTabs=function(t){var e=this.getColDef().menuTabs;return null==e&&(e=t),e},t.prototype.dispatchStateUpdatedEvent=function(e){this.eventService.dispatchEvent({type:t.EVENT_STATE_UPDATED,key:e})},t.EVENT_MOVING_CHANGED="movingChanged",t.EVENT_LEFT_CHANGED="leftChanged",t.EVENT_WIDTH_CHANGED="widthChanged",t.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",t.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",t.EVENT_VISIBLE_CHANGED="visibleChanged",t.EVENT_FILTER_CHANGED="filterChanged",t.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",t.EVENT_SORT_CHANGED="sortChanged",t.EVENT_COL_DEF_CHANGED="colDefChanged",t.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",t.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",t.EVENT_PIVOT_CHANGED="columnPivotChanged",t.EVENT_VALUE_CHANGED="columnValueChanged",t.EVENT_STATE_UPDATED="columnStateUpdated",at([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),at([$("columnUtils")],t.prototype,"columnUtils",void 0),at([$("columnHoverService")],t.prototype,"columnHoverService",void 0),at([Z],t.prototype,"initialise",null),t}(),dt=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ft=function(){function t(t,e,n,o){this.localEventService=new st,this.expandable=!1,this.instanceId=pt(),this.expandableListenerRemoveCallback=null,this.colGroupDef=t,this.groupId=e,this.expanded=!!t&&!!t.openByDefault,this.padding=n,this.level=o}return t.prototype.destroy=function(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)},t.prototype.reset=function(t,e){this.colGroupDef=t,this.level=e,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setOriginalParent=function(t){this.originalParent=t},t.prototype.getOriginalParent=function(){return this.originalParent},t.prototype.getLevel=function(){return this.level},t.prototype.isVisible=function(){return!!this.children&&this.children.some((function(t){return t.isVisible()}))},t.prototype.isPadding=function(){return this.padding},t.prototype.setExpanded=function(e){this.expanded=void 0!==e&&e;var n={type:t.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(n)},t.prototype.isExpandable=function(){return this.expandable},t.prototype.isExpanded=function(){return this.expanded},t.prototype.getGroupId=function(){return this.groupId},t.prototype.getId=function(){return this.getGroupId()},t.prototype.setChildren=function(t){this.children=t},t.prototype.getChildren=function(){return this.children},t.prototype.getColGroupDef=function(){return this.colGroupDef},t.prototype.getLeafColumns=function(){var t=[];return this.addLeafColumns(t),t},t.prototype.addLeafColumns=function(e){this.children&&this.children.forEach((function(n){n instanceof ht?e.push(n):n instanceof t&&n.addLeafColumns(e)}))},t.prototype.getColumnGroupShow=function(){var t=this.colGroupDef;if(t)return t.columnGroupShow},t.prototype.setupExpandable=function(){var t=this;this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();var e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((function(t){return t.addEventListener("visibleChanged",e)})),this.expandableListenerRemoveCallback=function(){t.getLeafColumns().forEach((function(t){return t.removeEventListener("visibleChanged",e)})),t.expandableListenerRemoveCallback=null}},t.prototype.setExpandable=function(){if(!this.isPadding()){for(var e=!1,n=!1,o=!1,r=this.findChildrenRemovingPadding(),i=0,s=r.length;i<s;i++){var a=r[i];if(a.isVisible()){var l=a.getColumnGroupShow();"open"===l?(e=!0,o=!0):"closed"===l?(n=!0,o=!0):(e=!0,n=!0)}}var u=e&&n&&o;if(this.expandable!==u){this.expandable=u;var c={type:t.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(c)}}},t.prototype.findChildrenRemovingPadding=function(){var e=[],n=function(o){o.forEach((function(o){o instanceof t&&o.isPadding()?n(o.children):e.push(o)}))};return n(this.children),e},t.prototype.onColumnVisibilityChanged=function(){this.setExpandable()},t.prototype.addEventListener=function(t,e){this.localEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.localEventService.removeEventListener(t,e)},t.EVENT_EXPANDED_CHANGED="expandedChanged",t.EVENT_EXPANDABLE_CHANGED="expandableChanged",dt([J],t.prototype,"destroy",null),t}(),gt={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function mt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++){var o=t[n];if(r(o))return o}return null}function yt(t){if(t&&t.length)return t[t.length-1]}function vt(t,e,n){return null==t&&null==e||null!=t&&null!=e&&t.length===e.length&&t.every((function(t,o){return n?n(t,e[o]):e[o]===t}))}function _t(t){return t.sort((function(t,e){return t-e}))}function Ct(t,e){var n=t.indexOf(e);n>=0&&(t[n]=t[t.length-1],t.pop())}function wt(t,e){var n=t.indexOf(e);n>=0&&t.splice(n,1)}function bt(t,e){for(var n=0;n<e.length;n++)Ct(t,e[n])}function xt(t,e){for(var n=0;n<e.length;n++)wt(t,e[n])}function Et(t,e,n){t.splice(n,0,e)}function St(t,e,n){xt(t,e),e.slice().reverse().forEach((function(e){return Et(t,e,n)}))}function Tt(t,e){return t.indexOf(e)>-1}function Rt(t){return[].concat.apply([],t)}function Ot(t,e){null!=e&&null!=t&&e.forEach((function(e){return t.push(e)}))}var Pt=Object.freeze({__proto__:null,firstExistingValue:mt,existsAndNotEmpty:function(t){return null!=t&&t.length>0},last:yt,areEqual:vt,shallowCompare:function(t,e){return vt(t,e)},sortNumerically:_t,removeRepeatsFromArray:function(t,e){if(t)for(var n=t.length-2;n>=0;n--){var o=t[n]===e,r=t[n+1]===e;o&&r&&t.splice(n+1,1)}},removeFromUnorderedArray:Ct,removeFromArray:wt,removeAllFromUnorderedArray:bt,removeAllFromArray:xt,insertIntoArray:Et,insertArrayIntoArray:function(t,e,n){if(null!=t&&null!=e)for(var o=e.length-1;o>=0;o--){Et(t,e[o],n)}},moveInArray:St,includes:Tt,flatten:Rt,pushAll:Ot,toStrings:function(t){return t.map(a)},forEachReverse:function(t,e){if(null!=t)for(var n=t.length-1;n>=0;n--)e(t[n],n)}}),It="__ag_Grid_Stop_Propagation",At=["touchstart","touchend","touchmove","touchcancel","scroll"],Dt={};function Mt(t){t[It]=!0}function Lt(t){return!0===t[It]}var Nt=function(){var t={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(e){if("boolean"===typeof Dt[e])return Dt[e];var n=document.createElement(t[e]||"div");return Dt[e="on"+e]=e in n}}();function Ft(t,e,n){for(var o=e;o;){var r=t.getDomData(o,n);if(r)return r;o=o.parentElement}return null}function kt(t,e){return!(!e||!t)&&Bt(e).indexOf(t)>=0}function Gt(t){for(var e=[],n=t.target;n;)e.push(n),n=n.parentElement;return e}function Bt(t){var e=t;return e.path?e.path:e.composedPath?e.composedPath():Gt(e)}function Vt(t,e,n,o){var r=Tt(At,n)?{passive:!0}:void 0;t&&t.addEventListener&&t.addEventListener(e,n,o,r)}var zt=Object.freeze({__proto__:null,stopPropagationForAgGrid:Mt,isStopPropagationForAgGrid:Lt,isEventSupported:Nt,getCtrlForEventTarget:Ft,isElementInEventPath:kt,createEventPath:Gt,getEventPath:Bt,addSafePassiveEventListener:Vt}),jt=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ht=function(){function t(){var t=this;this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=function(){return!t.destroyed}}return t.prototype.getFrameworkOverrides=function(){return this.frameworkOverrides},t.prototype.getContext=function(){return this.context},t.prototype.destroy=function(){this.destroyFunctions.forEach((function(t){return t()})),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:t.EVENT_DESTROYED})},t.prototype.addEventListener=function(t,e){this.localEventService||(this.localEventService=new st),this.localEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.localEventService&&this.localEventService.removeEventListener(t,e)},t.prototype.dispatchEventAsync=function(t){var e=this;window.setTimeout((function(){return e.dispatchEvent(t)}),0)},t.prototype.dispatchEvent=function(t){this.localEventService&&this.localEventService.dispatchEvent(t)},t.prototype.addManagedListener=function(t,e,n){var o=this;if(!this.destroyed){t instanceof HTMLElement?Vt(this.getFrameworkOverrides(),t,e,n):t.addEventListener(e,n);var r=function(){return t.removeEventListener(e,n),o.destroyFunctions=o.destroyFunctions.filter((function(t){return t!==r})),null};return this.destroyFunctions.push(r),r}},t.prototype.addManagedPropertyListener=function(t,e){var n=this;if(!this.destroyed){this.gridOptionsService.addEventListener(t,e);var o=function(){return n.gridOptionsService.removeEventListener(t,e),n.destroyFunctions=n.destroyFunctions.filter((function(t){return t!==o})),null};return this.destroyFunctions.push(o),o}},t.prototype.addDestroyFunc=function(t){this.isAlive()?this.destroyFunctions.push(t):t()},t.prototype.createManagedBean=function(t,e){var n=this.createBean(t,e);return this.addDestroyFunc(this.destroyBean.bind(this,t,e)),n},t.prototype.createBean=function(t,e,n){return(e||this.getContext()).createBean(t,n)},t.prototype.destroyBean=function(t,e){return(e||this.getContext()).destroyBean(t)},t.prototype.destroyBeans=function(t,e){var n=this;return t&&t.forEach((function(t){return n.destroyBean(t,e)})),[]},t.EVENT_DESTROYED="destroyed",jt([$("frameworkOverrides")],t.prototype,"frameworkOverrides",void 0),jt([$("context")],t.prototype,"context",void 0),jt([$("eventService")],t.prototype,"eventService",void 0),jt([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),jt([$("localeService")],t.prototype,"localeService",void 0),jt([$("environment")],t.prototype,"environment",void 0),jt([J],t.prototype,"destroy",null),t}(),Ut=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Wt=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qt=function(t,e){return function(n,o){e(n,o,t)}},Xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ut(e,t),e.prototype.setBeans=function(t){this.logger=t.create("ColumnFactory")},e.prototype.createColumnTree=function(t,e,n){var o=new h,r=this.extractExistingTreeData(n),i=r.existingCols,s=r.existingGroups,a=r.existingColKeys;o.addExistingKeys(a);var l=this.recursivelyCreateColumns(t,0,e,i,o,s),u=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+u);var c=this.balanceColumnTree(l,0,u,o);return this.columnUtils.depthFirstOriginalTreeSearch(null,c,(function(t,e){t instanceof ft&&t.setupExpandable(),t.setOriginalParent(e)})),{columnTree:c,treeDept:u}},e.prototype.extractExistingTreeData=function(t){var e=[],n=[],o=[];return t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,(function(t){if(t instanceof ft){var r=t;n.push(r)}else{var i=t;o.push(i.getId()),e.push(i)}})),{existingCols:e,existingGroups:n,existingColKeys:o}},e.prototype.createForAutoGroups=function(t,e){var n=this;return t.map((function(t){return n.createAutoGroupTreeItem(e,t)}))},e.prototype.createAutoGroupTreeItem=function(t,e){for(var n=this.findDepth(t),o=e,r=n-1;r>=0;r--){var i=new ft(null,"FAKE_PATH_"+e.getId()+"}_"+r,!0,r);this.createBean(i),i.setChildren([o]),o.setOriginalParent(i),o=i}return 0===n&&e.setOriginalParent(null),o},e.prototype.findDepth=function(t){for(var e=0,n=t;n&&n[0]&&n[0]instanceof ft;)e++,n=n[0].getChildren();return e},e.prototype.balanceColumnTree=function(t,e,n,o){for(var r=[],i=0;i<t.length;i++){var s=t[i];if(s instanceof ft){var a=s,l=this.balanceColumnTree(a.getChildren(),e+1,n,o);a.setChildren(l),r.push(a)}else{for(var u=void 0,c=void 0,p=n-1;p>=e;p--){var h=o.getUniqueKey(null,null),d=this.createMergedColGroupDef(null),f=new ft(d,h,!0,e);this.createBean(f),c&&c.setChildren([f]),c=f,u||(u=c)}if(u&&c){if(r.push(u),t.some((function(t){return t instanceof ft}))){c.setChildren([s]);continue}c.setChildren(t);break}r.push(s)}}return r},e.prototype.findMaxDept=function(t,e){for(var n=e,o=0;o<t.length;o++){var r=t[o];if(r instanceof ft){var i=r,s=this.findMaxDept(i.getChildren(),e+1);n<s&&(n=s)}}return n},e.prototype.recursivelyCreateColumns=function(t,e,n,o,r,i){if(!t)return[];for(var s=new Array(t.length),a=0;a<s.length;a++){var l=t[a];this.isColumnGroup(l)?s[a]=this.createColumnGroup(n,l,e,o,r,i):s[a]=this.createColumn(n,l,o,r)}return s},e.prototype.createColumnGroup=function(t,e,n,o,r,i){var s=this.createMergedColGroupDef(e),a=r.getUniqueKey(s.groupId||null,null),l=new ft(s,a,!1,n);this.createBean(l);var u=this.findExistingGroup(e,i);u&&wt(i,u),u&&u.isExpanded()&&l.setExpanded(!0);var c=this.recursivelyCreateColumns(s.children,n+1,t,o,r,i);return l.setChildren(c),l},e.prototype.createMergedColGroupDef=function(t){var e={};return Object.assign(e,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(e,t),e},e.prototype.createColumn=function(t,e,n,o){var r=this.findExistingColumn(e,n);if(n&&r&&wt(n,r),r){s=this.addColumnDefaultAndTypes(e,r.getColId());r.setColDef(s,e),this.applyColumnState(r,s)}else{var i=o.getUniqueKey(e.colId,e.field),s=this.addColumnDefaultAndTypes(e,i);r=new ht(s,e,i,t),this.context.createBean(r)}return this.dataTypeService.addColumnListeners(r),r},e.prototype.applyColumnState=function(t,e){var n=l(e.flex);if(void 0!==n&&t.setFlex(n),t.getFlex()<=0){var o=l(e.width);if(null!=o)t.setActualWidth(o);else{var r=t.getActualWidth();t.setActualWidth(r)}}void 0!==e.sort&&("asc"==e.sort||"desc"==e.sort?t.setSort(e.sort):t.setSort(void 0));var i=l(e.sortIndex);void 0!==i&&t.setSortIndex(i);var s=u(e.hide);void 0!==s&&t.setVisible(!s),void 0!==e.pinned&&t.setPinned(e.pinned)},e.prototype.findExistingColumn=function(t,e){if(e)for(var n=0;n<e.length;n++){var o=e[n].getUserProvidedColDef();if(o)if(null!=t.colId){if(e[n].getId()===t.colId)return e[n]}else if(null!=t.field){if(o.field===t.field)return e[n]}else if(o===t)return e[n]}},e.prototype.findExistingGroup=function(t,e){return e.find((function(e){return!!e.getColGroupDef()&&(!(null==t.groupId)&&e.getId()===t.groupId)}))},e.prototype.addColumnDefaultAndTypes=function(t,e){var n={};x(n,this.gridOptionsService.get("defaultColDef"),!1,!0);var o=this.dataTypeService.updateColDefAndGetColumnType(n,t,e);o&&this.assignColumnTypes(o,n),x(n,t,!1,!0);var r=this.gridOptionsService.get("autoGroupColumnDef"),i=this.gridOptionsService.isColumnsSortingCoupledToGroup();return t.rowGroup&&r&&i&&x(n,{sort:r.sort,initialSort:r.initialSort},!1,!0),this.dataTypeService.validateColDef(n),n},e.prototype.assignColumnTypes=function(t,e){if(t.length){var n=Object.assign({},gt);g(this.gridOptionsService.get("columnTypes")||{},(function(t,e){t in n?console.warn("AG Grid: the column type '"+t+"' is a default column type and cannot be overridden."):n[t]=e})),t.forEach((function(t){var o=n[t.trim()];o?x(e,o,!1,!0):console.warn("AG Grid: colDef.type '"+t+"' does not correspond to defined gridOptions.columnTypes")}))}},e.prototype.isColumnGroup=function(t){return void 0!==t.children},Wt([$("columnUtils")],e.prototype,"columnUtils",void 0),Wt([$("dataTypeService")],e.prototype,"dataTypeService",void 0),Wt([qt(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=Wt([Q("columnFactory")],e)}(Ht),Yt=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Kt=function(){function t(t,e,n,o){this.displayedChildren=[],this.localEventService=new st,this.groupId=e,this.partId=n,this.providedColumnGroup=t,this.pinned=o}return t.createUniqueId=function(t,e){return t+"_"+e},t.prototype.reset=function(){this.parent=null,this.children=null,this.displayedChildren=null},t.prototype.getParent=function(){return this.parent},t.prototype.setParent=function(t){this.parent=t},t.prototype.getUniqueId=function(){return t.createUniqueId(this.groupId,this.partId)},t.prototype.isEmptyGroup=function(){return 0===this.displayedChildren.length},t.prototype.isMoving=function(){var t=this.getProvidedColumnGroup().getLeafColumns();return!(!t||0===t.length)&&t.every((function(t){return t.isMoving()}))},t.prototype.checkLeft=function(){if(this.displayedChildren.forEach((function(e){e instanceof t&&e.checkLeft()})),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){var e=yt(this.displayedChildren).getLeft();this.setLeft(e)}else{var n=this.displayedChildren[0].getLeft();this.setLeft(n)}else this.setLeft(null)},t.prototype.getLeft=function(){return this.left},t.prototype.getOldLeft=function(){return this.oldLeft},t.prototype.setLeft=function(e){this.oldLeft=e,this.left!==e&&(this.left=e,this.localEventService.dispatchEvent(this.createAgEvent(t.EVENT_LEFT_CHANGED)))},t.prototype.getPinned=function(){return this.pinned},t.prototype.createAgEvent=function(t){return{type:t}},t.prototype.addEventListener=function(t,e){this.localEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.localEventService.removeEventListener(t,e)},t.prototype.getGroupId=function(){return this.groupId},t.prototype.getPartId=function(){return this.partId},t.prototype.isChildInThisGroupDeepSearch=function(e){var n=!1;return this.children.forEach((function(o){e===o&&(n=!0),o instanceof t&&o.isChildInThisGroupDeepSearch(e)&&(n=!0)})),n},t.prototype.getActualWidth=function(){var t=0;return this.displayedChildren&&this.displayedChildren.forEach((function(e){t+=e.getActualWidth()})),t},t.prototype.isResizable=function(){if(!this.displayedChildren)return!1;var t=!1;return this.displayedChildren.forEach((function(e){e.isResizable()&&(t=!0)})),t},t.prototype.getMinWidth=function(){var t=0;return this.displayedChildren.forEach((function(e){t+=e.getMinWidth()||0})),t},t.prototype.addChild=function(t){this.children||(this.children=[]),this.children.push(t)},t.prototype.getDisplayedChildren=function(){return this.displayedChildren},t.prototype.getLeafColumns=function(){var t=[];return this.addLeafColumns(t),t},t.prototype.getDisplayedLeafColumns=function(){var t=[];return this.addDisplayedLeafColumns(t),t},t.prototype.getDefinition=function(){return this.providedColumnGroup.getColGroupDef()},t.prototype.getColGroupDef=function(){return this.providedColumnGroup.getColGroupDef()},t.prototype.isPadding=function(){return this.providedColumnGroup.isPadding()},t.prototype.isExpandable=function(){return this.providedColumnGroup.isExpandable()},t.prototype.isExpanded=function(){return this.providedColumnGroup.isExpanded()},t.prototype.setExpanded=function(t){this.providedColumnGroup.setExpanded(t)},t.prototype.addDisplayedLeafColumns=function(e){this.displayedChildren.forEach((function(n){n instanceof ht?e.push(n):n instanceof t&&n.addDisplayedLeafColumns(e)}))},t.prototype.addLeafColumns=function(e){this.children.forEach((function(n){n instanceof ht?e.push(n):n instanceof t&&n.addLeafColumns(e)}))},t.prototype.getChildren=function(){return this.children},t.prototype.getColumnGroupShow=function(){return this.providedColumnGroup.getColumnGroupShow()},t.prototype.getProvidedColumnGroup=function(){return this.providedColumnGroup},t.prototype.getPaddingLevel=function(){var t=this.getParent();return this.isPadding()&&t&&t.isPadding()?1+t.getPaddingLevel():0},t.prototype.calculateDisplayedColumns=function(){var e=this;this.displayedChildren=[];for(var n=this;null!=n&&n.isPadding();)n=n.getParent();if(!(!!n&&n.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(t.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach((function(o){if(!(o instanceof t&&(!o.displayedChildren||!o.displayedChildren.length)))switch(o.getColumnGroupShow()){case"open":n.providedColumnGroup.isExpanded()&&e.displayedChildren.push(o);break;case"closed":n.providedColumnGroup.isExpanded()||e.displayedChildren.push(o);break;default:e.displayedChildren.push(o)}})),this.localEventService.dispatchEvent(this.createAgEvent(t.EVENT_DISPLAYED_CHILDREN_CHANGED))},t.EVENT_LEFT_CHANGED="leftChanged",t.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",Yt([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),t}(),Zt=function(){function t(){}return t.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",t.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",t.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",t.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",t.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",t.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",t.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",t.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",t.EVENT_COLUMN_MOVED="columnMoved",t.EVENT_COLUMN_VISIBLE="columnVisible",t.EVENT_COLUMN_PINNED="columnPinned",t.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",t.EVENT_COLUMN_RESIZED="columnResized",t.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",t.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",t.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",t.EVENT_ROW_GROUP_OPENED="rowGroupOpened",t.EVENT_ROW_DATA_CHANGED="rowDataChanged",t.EVENT_ROW_DATA_UPDATED="rowDataUpdated",t.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",t.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",t.EVENT_CHART_CREATED="chartCreated",t.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",t.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",t.EVENT_CHART_DESTROYED="chartDestroyed",t.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",t.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",t.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",t.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",t.EVENT_MODEL_UPDATED="modelUpdated",t.EVENT_CUT_START="cutStart",t.EVENT_CUT_END="cutEnd",t.EVENT_PASTE_START="pasteStart",t.EVENT_PASTE_END="pasteEnd",t.EVENT_FILL_START="fillStart",t.EVENT_FILL_END="fillEnd",t.EVENT_RANGE_DELETE_START="rangeDeleteStart",t.EVENT_RANGE_DELETE_END="rangeDeleteEnd",t.EVENT_UNDO_STARTED="undoStarted",t.EVENT_UNDO_ENDED="undoEnded",t.EVENT_REDO_STARTED="redoStarted",t.EVENT_REDO_ENDED="redoEnded",t.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",t.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",t.EVENT_CELL_CLICKED="cellClicked",t.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",t.EVENT_CELL_MOUSE_DOWN="cellMouseDown",t.EVENT_CELL_CONTEXT_MENU="cellContextMenu",t.EVENT_CELL_VALUE_CHANGED="cellValueChanged",t.EVENT_CELL_EDIT_REQUEST="cellEditRequest",t.EVENT_ROW_VALUE_CHANGED="rowValueChanged",t.EVENT_CELL_FOCUSED="cellFocused",t.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",t.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",t.EVENT_ROW_SELECTED="rowSelected",t.EVENT_SELECTION_CHANGED="selectionChanged",t.EVENT_TOOLTIP_SHOW="tooltipShow",t.EVENT_TOOLTIP_HIDE="tooltipHide",t.EVENT_CELL_KEY_DOWN="cellKeyDown",t.EVENT_CELL_MOUSE_OVER="cellMouseOver",t.EVENT_CELL_MOUSE_OUT="cellMouseOut",t.EVENT_FILTER_CHANGED="filterChanged",t.EVENT_FILTER_MODIFIED="filterModified",t.EVENT_FILTER_OPENED="filterOpened",t.EVENT_SORT_CHANGED="sortChanged",t.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",t.EVENT_ROW_CLICKED="rowClicked",t.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",t.EVENT_GRID_READY="gridReady",t.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",t.EVENT_VIEWPORT_CHANGED="viewportChanged",t.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",t.EVENT_FIRST_DATA_RENDERED="firstDataRendered",t.EVENT_DRAG_STARTED="dragStarted",t.EVENT_DRAG_STOPPED="dragStopped",t.EVENT_CHECKBOX_CHANGED="checkboxChanged",t.EVENT_ROW_EDITING_STARTED="rowEditingStarted",t.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",t.EVENT_CELL_EDITING_STARTED="cellEditingStarted",t.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",t.EVENT_BODY_SCROLL="bodyScroll",t.EVENT_BODY_SCROLL_END="bodyScrollEnd",t.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",t.EVENT_PAGINATION_CHANGED="paginationChanged",t.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",t.EVENT_STORE_REFRESHED="storeRefreshed",t.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",t.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",t.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",t.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",t.EVENT_FLASH_CELLS="flashCells",t.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",t.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",t.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",t.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",t.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",t.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",t.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",t.EVENT_ROW_DRAG_ENTER="rowDragEnter",t.EVENT_ROW_DRAG_MOVE="rowDragMove",t.EVENT_ROW_DRAG_LEAVE="rowDragLeave",t.EVENT_ROW_DRAG_END="rowDragEnd",t.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",t.EVENT_POPUP_TO_FRONT="popupToFront",t.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",t.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",t.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",t.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",t.EVENT_KEYBOARD_FOCUS="keyboardFocus",t.EVENT_MOUSE_FOCUS="mouseFocus",t.EVENT_STORE_UPDATED="storeUpdated",t.EVENT_FILTER_DESTROYED="filterDestroyed",t.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted",t.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged",t.EVENT_DATA_TYPES_INFERRED="dataTypesInferred",t.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged",t.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected",t}(),Jt=function(){function t(){this.existingIds={}}return t.prototype.getInstanceIdForKey=function(t){var e,n=this.existingIds[t];return e="number"!==typeof n?0:n+1,this.existingIds[t]=e,e},t}(),Qt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$t=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},te="ag-Grid-AutoColumn",ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qt(e,t),e.prototype.createAutoGroupColumns=function(t){var e=this,n=[],o=this.gridOptionsService.isTreeData(),r=this.gridOptionsService.isGroupMultiAutoColumn();return o&&r&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),r=!1),r?t.forEach((function(t,o){n.push(e.createOneAutoGroupColumn(t,o))})):n.push(this.createOneAutoGroupColumn()),n},e.prototype.updateAutoGroupColumns=function(t){var e=this;t.forEach((function(t,n){return e.updateOneAutoGroupColumn(t,n)}))},e.prototype.createOneAutoGroupColumn=function(t,e){var n;n=t?te+"-"+t.getId():te;var o=this.createAutoGroupColDef(n,t,e);o.colId=n;var r=new ht(o,null,n,!0);return this.context.createBean(r),r},e.prototype.updateOneAutoGroupColumn=function(t,e){var n=t.getColDef(),o="string"==typeof n.showRowGroup?n.showRowGroup:void 0,r=null!=o?this.columnModel.getPrimaryColumn(o):void 0,i=this.createAutoGroupColDef(t.getId(),null!==r&&void 0!==r?r:void 0,e);t.setColDef(i,null),this.columnFactory.applyColumnState(t,i)},e.prototype.createAutoGroupColDef=function(t,e,n){var o=this.createBaseColDef(e);(x(o,this.gridOptionsService.get("autoGroupColumnDef")),o=this.columnFactory.addColumnDefaultAndTypes(o,t),this.gridOptionsService.isTreeData())||i(o.field)&&i(o.valueGetter)&&i(o.filterValueGetter)&&"agGroupColumnFilter"!==o.filter&&(o.filter=!1);n&&n>0&&(o.headerCheckboxSelection=!1);var r=this.gridOptionsService.isColumnsSortingCoupledToGroup(),s=o.valueGetter||null!=o.field;return r&&!s&&(o.sortIndex=void 0,o.initialSort=void 0),o},e.prototype.createBaseColDef=function(t){var e=this.gridOptionsService.get("autoGroupColumnDef"),n={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(e&&(e.cellRenderer||e.cellRendererSelector)||(n.cellRenderer="agGroupCellRenderer"),t){var o=t.getColDef();Object.assign(n,{headerName:this.columnModel.getDisplayNameForColumn(t,"header"),headerValueGetter:o.headerValueGetter}),o.cellRenderer&&Object.assign(n,{cellRendererParams:{innerRenderer:o.cellRenderer,innerRendererParams:o.cellRendererParams}}),n.showRowGroup=t.getColId()}else n.showRowGroup=!0;return n},$t([$("columnModel")],e.prototype,"columnModel",void 0),$t([$("columnFactory")],e.prototype,"columnFactory",void 0),e=$t([Q("autoGroupColService")],e)}(Ht),ne=/[&<>"']/g,oe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function re(t,e){if(null==t)return null;var n=t.toString().toString();return e?n:n.replace(ne,(function(t){return oe[t]}))}function ie(t){if(!t||null==t)return null;return t.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((function(t){return t.substring(0,1).toUpperCase()+(t.length>1?t.substring(1,t.length):"")})).join(" ")}function se(t){return t.replace(/[A-Z]/g,(function(t){return"-"+t.toLocaleLowerCase()}))}var ae=Object.freeze({__proto__:null,utf8_encode:function(t){var e=String.fromCharCode;function n(t,n){return e(t>>n&63|128)}function o(t){if(t>=0&&t<=31&&10!==t)return"_x"+t.toString(16).toUpperCase().padStart(4,"0")+"_";if(0==(4294967168&t))return e(t);var o="";return 0==(4294965248&t)?o=e(t>>6&31|192):0==(4294901760&t)?(!function(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}(t),o=e(t>>12&15|224),o+=n(t,6)):0==(4292870144&t)&&(o=e(t>>18&7|240),o+=n(t,12),o+=n(t,6)),o+=e(63&t|128)}for(var r=function(t){var e=[];if(!t)return[];for(var n,o,r=t.length,i=0;i<r;)(n=t.charCodeAt(i++))>=55296&&n<=56319&&i<r?56320==(64512&(o=t.charCodeAt(i++)))?e.push(((1023&n)<<10)+(1023&o)+65536):(e.push(n),i--):e.push(n);return e}(t),i=r.length,s=-1,a="";++s<i;)a+=o(r[s]);return a},capitalise:function(t){return t[0].toUpperCase()+t.substr(1).toLowerCase()},escapeString:re,camelCaseToHumanText:ie,camelCaseToHyphenated:se});function le(t){var e=new Map;return t.forEach((function(t){return e.set(t[0],t[1])})),e}var ue=Object.freeze({__proto__:null,convertToMap:le,mapById:function(t,e){var n=new Map;return t.forEach((function(t){return n.set(e(t),t)})),n},keys:function(t){var e=[];return t.forEach((function(t,n){return e.push(n)})),e}}),ce=function(){function t(){}return t.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0},t.ALL_PROPERTIES=Object.keys(t.ColDefPropertyMap),t}(),pe=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},he=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},de=function(){function t(){}return t.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator"],t.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent"],t.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],t.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],t.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideFilterAllLevels","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard","enableAdvancedFilter","includeHiddenColumnsInAdvancedFilter"],t.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer"],t.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],t.FUNCTION_PROPERTIES=he(he([],pe(t.FUNCTIONAL_PROPERTIES)),pe(t.CALLBACK_PROPERTIES)),t.ALL_PROPERTIES=he(he(he(he(he(he([],pe(t.ARRAY_PROPERTIES)),pe(t.OBJECT_PROPERTIES)),pe(t.STRING_PROPERTIES)),pe(t.NUMBER_PROPERTIES)),pe(t.FUNCTION_PROPERTIES)),pe(t.BOOLEAN_PROPERTIES)),t}(),fe=function(){return fe=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},fe.apply(this,arguments)},ge=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},me=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},ye=function(){function t(){}return t.getCallbackForEvent=function(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substr(1)},t.getCoercionLookup=function(){var e={};return me(me(me(me(me([],ge(t.ARRAY_PROPERTIES)),ge(t.OBJECT_PROPERTIES)),ge(t.STRING_PROPERTIES)),ge(t.FUNCTION_PROPERTIES)),ge(t.EVENT_CALLBACKS)).forEach((function(t){return e[t]="none"})),t.BOOLEAN_PROPERTIES.forEach((function(t){return e[t]="boolean"})),t.NUMBER_PROPERTIES.forEach((function(t){return e[t]="number"})),e},t.getValue=function(e,n){var o=t.coercionLookup[e];if(o){var r=n;switch(o){case"number":r=t.toNumber(n);break;case"boolean":r=t.toBoolean(n);break;case"none":"groupAggFiltering"===e&&"function"!==typeof n&&(r=t.toBoolean(n))}return r}},t.getGridOptionKeys=function(e,n){return n?Object.keys(t.coercionLookup):Object.keys(e)},t.copyAttributesToGridOptions=function(e,n,o){void 0===o&&(o=!1),"object"!==typeof e&&(e={});var r=e;return t.getGridOptionKeys(n,o).forEach((function(e){var o=n[e];if("undefined"!==typeof o){var i=t.getValue(e,o);void 0!==i&&(r[e]=i)}})),e},t.processOnChange=function(e,n){if(e&&0!==Object.keys(e).length){var o=fe({},e);o.columnTypes&&(n.setColumnTypes(o.columnTypes.currentValue,"gridOptionsChanged"),delete o.columnTypes),o.autoGroupColumnDef&&(n.setAutoGroupColumnDef(o.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete o.autoGroupColumnDef),o.defaultColDef&&(n.setDefaultColDef(o.defaultColDef.currentValue,"gridOptionsChanged"),delete o.defaultColDef),o.columnDefs&&(n.setColumnDefs(o.columnDefs.currentValue,"gridOptionsChanged"),delete o.columnDefs),Object.keys(o).forEach((function(e){var r=e,i=t.getValue(r,o[r].currentValue);n.__setProperty(r,i)}));var r={type:Zt.EVENT_COMPONENT_STATE_CHANGED};g(e,(function(t,e){r[t]=e})),n.dispatchEvent(r)}},t.toBoolean=function(t){return"boolean"===typeof t?t:"string"===typeof t&&("TRUE"===t.toUpperCase()||""==t)},t.toNumber=function(t){return"number"===typeof t?t:"string"===typeof t?Number(t):void 0},t.EVENTS=c(Zt),t.EXCLUDED_INTERNAL_EVENTS=[Zt.EVENT_SCROLLBAR_WIDTH_CHANGED,Zt.EVENT_CHECKBOX_CHANGED,Zt.EVENT_HEIGHT_SCALE_CHANGED,Zt.EVENT_BODY_HEIGHT_CHANGED,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,Zt.EVENT_COLUMN_HOVER_CHANGED,Zt.EVENT_FLASH_CELLS,Zt.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,Zt.EVENT_DISPLAYED_ROWS_CHANGED,Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED,Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,Zt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,Zt.EVENT_POPUP_TO_FRONT,Zt.EVENT_KEYBOARD_FOCUS,Zt.EVENT_MOUSE_FOCUS,Zt.EVENT_STORE_UPDATED,Zt.EVENT_COLUMN_PANEL_ITEM_DRAG_START,Zt.EVENT_COLUMN_PANEL_ITEM_DRAG_END,Zt.EVENT_FILL_START,Zt.EVENT_FILL_END,Zt.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,Zt.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,Zt.EVENT_FULL_WIDTH_ROW_FOCUSED,Zt.EVENT_HEADER_HEIGHT_CHANGED,Zt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,Zt.EVENT_CELL_FOCUS_CLEARED,Zt.EVENT_GRID_STYLES_CHANGED,Zt.EVENT_FILTER_DESTROYED,Zt.EVENT_ROW_DATA_UPDATE_STARTED,Zt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,Zt.EVENT_DATA_TYPES_INFERRED,Zt.EVENT_FIELD_VALUE_CHANGED,Zt.EVENT_FIELD_PICKER_VALUE_SELECTED],t.PUBLIC_EVENTS=t.EVENTS.filter((function(e){return!Tt(t.EXCLUDED_INTERNAL_EVENTS,e)})),t.EVENT_CALLBACKS=t.EVENTS.map((function(e){return t.getCallbackForEvent(e)})),t.STRING_PROPERTIES=de.STRING_PROPERTIES,t.OBJECT_PROPERTIES=de.OBJECT_PROPERTIES,t.ARRAY_PROPERTIES=de.ARRAY_PROPERTIES,t.NUMBER_PROPERTIES=de.NUMBER_PROPERTIES,t.BOOLEAN_PROPERTIES=de.BOOLEAN_PROPERTIES,t.FUNCTION_PROPERTIES=de.FUNCTION_PROPERTIES,t.ALL_PROPERTIES=de.ALL_PROPERTIES,t.ALL_PROPERTIES_SET=new Set(de.ALL_PROPERTIES),t.coercionLookup=t.getCoercionLookup(),t}();function ve(t,e,n){var o={},r=t.filter((function(t){return!e.some((function(e){return e===t}))}));return r.length>0&&r.forEach((function(t){return o[t]=_e(t,n)})),o}function _e(t,e,n,o){var r=e.map((function(e){return{value:e,relevance:Ce(t.toLowerCase(),e.toLocaleLowerCase())}}));if(r.sort((function(t,e){return e.relevance-t.relevance})),n&&(r=r.filter((function(t){return 0!==t.relevance}))),r.length>0&&o&&o>0){var i=r[0].relevance*o;r=r.filter((function(t){return i-t.relevance<0}))}return r.map((function(t){return t.value}))}function Ce(t,e){for(var n=t.replace(/\s/g,""),o=e.replace(/\s/g,""),r=0,i=-1,s=0;s<n.length;s++){var a=o.indexOf(n[s],i+1);-1!==a&&(r+=100-100*(i=a)/1e4*100)}return r}var we=Object.freeze({__proto__:null,fuzzyCheckStrings:ve,fuzzySuggestions:_e}),be=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xe=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Ee=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};function Se(t,e,n,o){var r=n?"Please use '"+n+"' instead. ":"";P((function(){return console.warn("AG Grid: since v"+t+", '"+e+"' is deprecated. "+r+(null!==o&&void 0!==o?o:""))}),"Deprecated_"+e)}var Te=["__ob__","__v_skip","__metadata__"],Re=function(){function t(){this.deprecatedProperties={rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideOnlyRefreshFilteredGroups",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",newProp:"enterNavigatesVertically",copyToNewProp:!0},enterMovesDownAfterEdit:{version:"30",newProp:"enterNavigatesVerticallyAfterEdit",copyToNewProp:!0}}}return t.prototype.pickOneWarning=function(t,e){console.warn("AG Grid: "+t+" and "+e+" do not work with each other, you need to pick one.")},t.prototype.init=function(){var t=this;if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),this.gridOptionsService.isRowModelType("serverSide")){var e=function(t,e){return"AG Grid: '"+t+"' is not supported on the Server-Side Row Model."+(e?" Please use "+e+" instead.":"")};this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(e("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&this.gridOptionsService.is("suppressServerSideInfiniteScroll")&&console.warn(e("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(e("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?W.__assertRegistered(z.RangeSelectionModule,"enableRangeSelection",this.gridOptionsService.getGridId()):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");var n=function(e,n){return t.gridOptionsService.exists(e)&&W.__assertRegistered(n,e,t.gridOptionsService.getGridId())};n("sideBar",z.SideBarModule),n("statusBar",z.StatusBarModule),n("enableCharts",z.GridChartsModule),n("getMainMenuItems",z.MenuModule),n("getContextMenuItems",z.MenuModule),n("allowContextMenuWithControlKey",z.MenuModule),n("enableAdvancedFilter",z.AdvancedFilterModule)},t.prototype.checkColumnDefProperties=function(){var t=this;if(null!=this.gridOptions.columnDefs){var e=ce.ALL_PROPERTIES,n=function(o,r){var i=Object.getOwnPropertyNames(o);t.checkProperties(i,Ee(Ee([],xe(e)),xe(Te)),e,r,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),o.children&&o.children.forEach((function(t){return n(t,"columnDefs.children")}))};this.gridOptions.columnDefs.forEach((function(t){return n(t,"columnDefs")})),this.gridOptions.defaultColDef&&n(this.gridOptions.defaultColDef,"defaultColDef")}},t.prototype.checkColumnDefViolations=function(){var t,e=null!==(t=this.gridOptionsService.get("rowModelType"))&&void 0!==t?t:"clientSide",n={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[e];if(null===n||void 0===n?void 0:n.length){var o=function(t){n.forEach((function(n){n in t&&t[n]&&console.warn("AG Grid: Column property "+n+" is not supported with the row model type "+e+".")}))};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach((function(t){return o(t)})),null!=this.gridOptions.autoGroupColumnDef&&o(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&o(this.gridOptions.defaultColDef)}},t.prototype.checkGridOptionsProperties=function(){var t=Object.getOwnPropertyNames(this.gridOptions),e=Ee(Ee([],xe(de.ALL_PROPERTIES)),xe(ye.EVENT_CALLBACKS)),n=Ee(Ee(Ee(Ee([],xe(e)),["api","columnApi"]),xe(Te)),xe(Object.keys(this.deprecatedProperties)));this.checkProperties(t,n,e,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")},t.prototype.checkProperties=function(t,e,n,o,r){var i=ve(t,e,n);g(i,(function(t,e){P((function(){return console.warn("AG Grid: invalid "+o+" property '"+t+"' did you mean any of these: "+e.slice(0,8).join(", "))}),"invalidProperty"+o+t)})),Object.keys(i).length>0&&P((function(){return console.warn("AG Grid: to see all the valid "+o+" properties please check: "+r)}),"invalidProperties"+o+r)},t.prototype.checkForDeprecated=function(){var t=this.gridOptions;Object.entries(this.deprecatedProperties).forEach((function(e){var n,o=xe(e,2),r=o[0],i=o[1],s=t[r];s&&(Se(i.version,r,i.newProp,i.message),i.copyToNewProp&&i.newProp&&null==t[i.newProp]&&(t[i.newProp]=null!==(n=i.newPropValue)&&void 0!==n?n:s))})),t.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),t.suppressServerSideInfiniteScroll="partial"!==t.serverSideStoreType)},t.prototype.checkForViolations=function(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()},t.prototype.treeDataViolations=function(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))},be([$("gridOptions")],t.prototype,"gridOptions",void 0),be([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),be([Z],t.prototype,"init",null),t=be([Q("gridOptionsValidator")],t)}();function Oe(t,e){var n=["groupRows","multipleColumns","custom","singleColumn"];return n.indexOf(e)<0?(console.warn("AG Grid: '"+e+"' is not a valid groupDisplayType value - possible values are: '"+n.join("', '")+"'"),!1):e===t}var Pe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ie=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ae=function(t,e){return function(n,o){e(n,o,t)}},De=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n},Me=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Le=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Ne=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Fe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.primaryHeaderRowCount=0,e.secondaryHeaderRowCount=0,e.gridHeaderRowCount=0,e.displayedColumnsLeft=[],e.displayedColumnsRight=[],e.displayedColumnsCenter=[],e.displayedColumns=[],e.displayedColumnsAndGroupsMap={},e.viewportColumns=[],e.viewportColumnsHash="",e.headerViewportColumns=[],e.viewportColumnsCenter=[],e.headerViewportColumnsCenter=[],e.autoHeightActiveAtLeastOnce=!1,e.rowGroupColumns=[],e.valueColumns=[],e.pivotColumns=[],e.ready=!1,e.autoGroupsNeedBuilding=!1,e.forceRecreateAutoGroups=!1,e.pivotMode=!1,e.bodyWidth=0,e.leftWidth=0,e.rightWidth=0,e.bodyWidthDirty=!0,e.shouldQueueResizeOperations=!1,e.resizeOperationQueue=[],e}return Pe(e,t),e.prototype.init=function(){var t=this;this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");var e=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",(function(){return t.onGroupDisplayTypeChanged()})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return t.onAutoGroupColumnDefChanged()})),this.addManagedPropertyListener("defaultColDef",(function(e){return t.onSharedColDefChanged(e.source)})),this.addManagedPropertyListener("columnTypes",(function(e){return t.onSharedColDefChanged(e.source)}))},e.prototype.onGroupDisplayTypeChanged=function(){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged"))},e.prototype.onAutoGroupColumnDefChanged=function(){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns)},e.prototype.onSharedColDefChanged=function(t){void 0===t&&(t="api"),this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns),this.createColumnsFromColumnDefs(!0,t)},e.prototype.setColumnDefs=function(t,e){void 0===e&&(e="api");var n=!!this.columnDefs;this.columnDefs=t,this.createColumnsFromColumnDefs(n,e)},e.prototype.recreateColumnDefs=function(t){void 0===t&&(t="api"),this.onSharedColDefChanged(t)},e.prototype.destroyOldColumns=function(t,e){var n={};if(t){this.columnUtils.depthFirstOriginalTreeSearch(null,t,(function(t){n[t.getInstanceId()]=t})),e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,(function(t){n[t.getInstanceId()]=null}));var o=Object.values(n).filter((function(t){return null!=t}));this.destroyBeans(o)}},e.prototype.destroyColumns=function(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)},e.prototype.createColumnsFromColumnDefs=function(t,e){var n=this;void 0===e&&(e="api");var o=t?this.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var r=this.primaryColumns,i=this.primaryColumnTree,s=this.columnFactory.createColumnTree(this.columnDefs,!0,i);this.destroyOldColumns(this.primaryColumnTree,s.columnTree),this.primaryColumnTree=s.columnTree,this.primaryHeaderRowCount=s.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach((function(t){return n.primaryColumnsMap[t.getId()]=t})),this.extractRowGroupColumns(e,r),this.extractPivotColumns(e,r),this.extractValueColumns(e,r),this.ready=!0;var a=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||a)&&(this.updateGridColumns(),t&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(e),this.checkViewportColumns()),this.dispatchEverythingChanged(e),o&&o(),this.dispatchNewColumnsLoaded(e)},e.prototype.dispatchNewColumnsLoaded=function(t){var e={type:Zt.EVENT_NEW_COLUMNS_LOADED,source:t};this.eventService.dispatchEvent(e)},e.prototype.dispatchEverythingChanged=function(t){void 0===t&&(t="api");var e={type:Zt.EVENT_COLUMN_EVERYTHING_CHANGED,source:t};this.eventService.dispatchEvent(e)},e.prototype.orderGridColumnsLikePrimary=function(){var t=this,e=this.primaryColumns;if(e){var n=e.filter((function(e){return t.gridColumns.indexOf(e)>=0})),o=this.gridColumns.filter((function(t){return n.indexOf(t)<0}));this.gridColumns=Le(Le([],Me(o)),Me(n)),this.gridColumns=this.placeLockedColumns(this.gridColumns)}},e.prototype.getAllDisplayedAutoHeightCols=function(){return this.displayedAutoHeightCols},e.prototype.setViewport=function(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)},e.prototype.getDisplayedColumnsStartingAt=function(t){for(var e=t,n=[];null!=e;)n.push(e),e=this.getDisplayedColAfter(e);return n},e.prototype.checkViewportColumns=function(){if(null!=this.displayedColumnsCenter&&this.extractViewport()){var t={type:Zt.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}},e.prototype.setViewportPosition=function(t,e){(t!==this.scrollWidth||e!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=t,this.scrollPosition=e,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())},e.prototype.isPivotMode=function(){return this.pivotMode},e.prototype.isPivotSettingAllowed=function(t){return!t||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)},e.prototype.setPivotMode=function(t,e){if(void 0===e&&(e="api"),t!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)){this.pivotMode=t,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(e);var n={type:Zt.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(n)}},e.prototype.getSecondaryPivotColumn=function(t,e){if(i(this.secondaryColumns))return null;var n=this.getPrimaryColumn(e),o=null;return this.secondaryColumns.forEach((function(e){var r=e.getColDef().pivotKeys,i=e.getColDef().pivotValueColumn;vt(r,t)&&i===n&&(o=e)})),o},e.prototype.setBeans=function(t){this.logger=t.create("columnModel")},e.prototype.setFirstRightAndLastLeftPinned=function(t){var e,n;this.gridOptionsService.is("enableRtl")?(e=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,n=this.displayedColumnsRight?yt(this.displayedColumnsRight):null):(e=this.displayedColumnsLeft?yt(this.displayedColumnsLeft):null,n=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach((function(o){o.setLastLeftPinned(o===e,t),o.setFirstRightPinned(o===n,t)}))},e.prototype.autoSizeColumns=function(t){var e=this;if(this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return e.autoSizeColumns(t)}));else{var n=t.columns,o=t.skipHeader,r=t.skipHeaderGroups,i=t.stopAtGroup,s=t.source,a=void 0===s?"api":s;this.animationFrameService.flushAllFrames();for(var l=[],u=-1,c=null!=o?o:this.gridOptionsService.is("skipHeaderOnAutoSize"),p=null!=r?r:c;0!==u;)u=0,this.actionOnGridColumns(n,(function(t){if(l.indexOf(t)>=0)return!1;var n=e.autoWidthCalculator.getPreferredWidthForColumn(t,c);if(n>0){var o=e.normaliseColumnWidth(t,n);t.setActualWidth(o,a),l.push(t),u++}return!0}),a);p||this.autoSizeColumnGroupsByColumns(n,a,i),this.dispatchColumnResizedEvent(l,!0,"autosizeColumns")}},e.prototype.dispatchColumnResizedEvent=function(t,e,n,o){if(void 0===o&&(o=null),t&&t.length){var r={type:Zt.EVENT_COLUMN_RESIZED,columns:t,column:1===t.length?t[0]:null,flexColumns:o,finished:e,source:n};this.eventService.dispatchEvent(r)}},e.prototype.dispatchColumnChangedEvent=function(t,e,n){var o={type:t,columns:e,column:e&&1==e.length?e[0]:null,source:n};this.eventService.dispatchEvent(o)},e.prototype.dispatchColumnMovedEvent=function(t){var e=t.movedColumns,n=t.source,o=t.toIndex,r=t.finished,i={type:Zt.EVENT_COLUMN_MOVED,columns:e,column:e&&1===e.length?e[0]:null,toIndex:o,finished:r,source:n};this.eventService.dispatchEvent(i)},e.prototype.dispatchColumnPinnedEvent=function(t,e){if(t.length){var n=1===t.length?t[0]:null,o=this.getCommonValue(t,(function(t){return t.getPinned()})),r={type:Zt.EVENT_COLUMN_PINNED,pinned:null!=o?o:null,columns:t,column:n,source:e};this.eventService.dispatchEvent(r)}},e.prototype.dispatchColumnVisibleEvent=function(t,e){if(t.length){var n=1===t.length?t[0]:null,o=this.getCommonValue(t,(function(t){return t.isVisible()})),r={type:Zt.EVENT_COLUMN_VISIBLE,visible:o,columns:t,column:n,source:e};this.eventService.dispatchEvent(r)}},e.prototype.autoSizeColumn=function(t,e,n){void 0===n&&(n="api"),t&&this.autoSizeColumns({columns:[t],skipHeader:e,skipHeaderGroups:!0,source:n})},e.prototype.autoSizeColumnGroupsByColumns=function(t,e,n){var o,r,i,s,a,l=new Set;this.getGridColumns(t).forEach((function(t){for(var e=t.getParent();e&&e!=n;)e.isPadding()||l.add(e),e=e.getParent()}));try{for(var u=Ne(l),c=u.next();!c.done;c=u.next()){var p=c.value;try{for(var h=(i=void 0,Ne(this.ctrlsService.getHeaderRowContainerCtrls())),d=h.next();!d.done;d=h.next()){if(a=d.value.getHeaderCtrlForColumn(p))break}}catch(f){i={error:f}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}a&&a.resizeLeafColumnsToFit(e)}}catch(g){o={error:g}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(o)throw o.error}}return[]},e.prototype.autoSizeAllColumns=function(t,e){var n=this;if(void 0===e&&(e="api"),this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return n.autoSizeAllColumns(t,e)}));else{var o=this.getAllDisplayedColumns();this.autoSizeColumns({columns:o,skipHeader:t,source:e})}},e.prototype.getColumnsFromTree=function(t){var e=[],n=function(t){for(var o=0;o<t.length;o++){var r=t[o];r instanceof ht?e.push(r):r instanceof ft&&n(r.getChildren())}};return n(t),e},e.prototype.getAllDisplayedTrees=function(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null},e.prototype.getPrimaryColumnTree=function(){return this.primaryColumnTree},e.prototype.getHeaderRowCount=function(){return this.gridHeaderRowCount},e.prototype.getDisplayedTreeLeft=function(){return this.displayedTreeLeft},e.prototype.getDisplayedTreeRight=function(){return this.displayedTreeRight},e.prototype.getDisplayedTreeCentre=function(){return this.displayedTreeCentre},e.prototype.isColumnDisplayed=function(t){return this.getAllDisplayedColumns().indexOf(t)>=0},e.prototype.getAllDisplayedColumns=function(){return this.displayedColumns},e.prototype.getViewportColumns=function(){return this.viewportColumns},e.prototype.getDisplayedLeftColumnsForRow=function(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsLeft):this.displayedColumnsLeft},e.prototype.getDisplayedRightColumnsForRow=function(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsRight):this.displayedColumnsRight},e.prototype.isColSpanActive=function(){return this.colSpanActive},e.prototype.getDisplayedColumnsForRow=function(t,e,n,o){for(var r,i=[],s=null,a=function(a){var l,u=e[a],c=e.length-a,p=Math.min(u.getColSpan(t),c),h=[u];if(p>1){for(var d=p-1,f=1;f<=d;f++)h.push(e[a+f]);a+=d}if(n?(l=!1,h.forEach((function(t){n(t)&&(l=!0)}))):l=!0,l){if(0===i.length&&s)!!o&&o(u)&&i.push(s);i.push(u)}s=u,r=a},l=0;l<e.length;l++)a(l),l=r;return i},e.prototype.getViewportCenterColumnsForRow=function(t){var e=this;if(!this.colSpanActive)return this.viewportColumnsCenter;var n=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(t,this.displayedColumnsCenter,n,(function(t){var n=t.getLeft();return r(n)&&n>e.viewportLeft}))},e.prototype.getAriaColumnIndex=function(t){return this.getAllGridColumns().indexOf(t)+1},e.prototype.isColumnInHeaderViewport=function(t){return!!t.isAutoHeaderHeight()||this.isColumnInRowViewport(t)},e.prototype.isColumnInRowViewport=function(t){if(t.isAutoHeight())return!0;var e=t.getLeft()||0,n=e+t.getActualWidth(),o=this.viewportLeft-200,r=this.viewportRight+200;return!(e<o&&n<o)&&!(e>r&&n>r)},e.prototype.getDisplayedColumnsLeftWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsLeft)},e.prototype.getDisplayedColumnsRightWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsRight)},e.prototype.updatePrimaryColumnList=function(t,e,n,o,r,i){var a=this;if(void 0===i&&(i="api"),t&&!s(t)){var l=!1;if(t.forEach((function(t){var r=a.getPrimaryColumn(t);if(r){if(n){if(e.indexOf(r)>=0)return;e.push(r)}else{if(e.indexOf(r)<0)return;wt(e,r)}o(r),l=!0}})),l){this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(i);var u={type:r,columns:e,column:1===e.length?e[0]:null,source:i};this.eventService.dispatchEvent(u)}}},e.prototype.setRowGroupColumns=function(t,e){void 0===e&&(e="api"),this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(t,this.rowGroupColumns,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),e)},e.prototype.setRowGroupActive=function(t,e,n){t!==e.isRowGroupActive()&&(e.setRowGroupActive(t,n),t&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(e,!1,n),t||this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnVisible(e,!0,n))},e.prototype.addRowGroupColumn=function(t,e){void 0===e&&(e="api"),t&&this.addRowGroupColumns([t],e)},e.prototype.addRowGroupColumns=function(t,e){void 0===e&&(e="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,e)},e.prototype.removeRowGroupColumns=function(t,e){void 0===e&&(e="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,e)},e.prototype.removeRowGroupColumn=function(t,e){void 0===e&&(e="api"),t&&this.removeRowGroupColumns([t],e)},e.prototype.addPivotColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.pivotColumns,!0,(function(t){return t.setPivotActive(!0,e)}),Zt.EVENT_COLUMN_PIVOT_CHANGED,e)},e.prototype.setPivotColumns=function(t,e){void 0===e&&(e="api"),this.setPrimaryColumnList(t,this.pivotColumns,Zt.EVENT_COLUMN_PIVOT_CHANGED,!0,(function(t,n){n.setPivotActive(t,e)}),e)},e.prototype.addPivotColumn=function(t,e){void 0===e&&(e="api"),this.addPivotColumns([t],e)},e.prototype.removePivotColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.pivotColumns,!1,(function(t){return t.setPivotActive(!1,e)}),Zt.EVENT_COLUMN_PIVOT_CHANGED,e)},e.prototype.removePivotColumn=function(t,e){void 0===e&&(e="api"),this.removePivotColumns([t],e)},e.prototype.setPrimaryColumnList=function(t,e,n,o,i,s){var a=this,l=new Map;e.forEach((function(t,e){return l.set(t,e)})),e.length=0,r(t)&&t.forEach((function(t){var n=a.getPrimaryColumn(t);n&&e.push(n)})),e.forEach((function(t,e){var n=l.get(t);void 0!==n?o&&n!==e||l.delete(t):l.set(t,0)})),(this.primaryColumns||[]).forEach((function(t){var n=e.indexOf(t)>=0;i(n,t)})),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(s),this.dispatchColumnChangedEvent(n,Le([],Me(l.keys())),s)},e.prototype.setValueColumns=function(t,e){void 0===e&&(e="api"),this.setPrimaryColumnList(t,this.valueColumns,Zt.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),e)},e.prototype.setValueActive=function(t,e,n){if(t!==e.isValueActive()&&(e.setValueActive(t,n),t&&!e.getAggFunc())){var o=this.aggFuncService.getDefaultAggFunc(e);e.setAggFunc(o)}},e.prototype.addValueColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.valueColumns,!0,this.setValueActive.bind(this,!0),Zt.EVENT_COLUMN_VALUE_CHANGED,e)},e.prototype.addValueColumn=function(t,e){void 0===e&&(e="api"),t&&this.addValueColumns([t],e)},e.prototype.removeValueColumn=function(t,e){void 0===e&&(e="api"),this.removeValueColumns([t],e)},e.prototype.removeValueColumns=function(t,e){void 0===e&&(e="api"),this.updatePrimaryColumnList(t,this.valueColumns,!1,this.setValueActive.bind(this,!1),Zt.EVENT_COLUMN_VALUE_CHANGED,e)},e.prototype.normaliseColumnWidth=function(t,e){var n=t.getMinWidth();r(n)&&e<n&&(e=n);var o=t.getMaxWidth();return r(o)&&t.isGreaterThanMax(e)&&(e=o),e},e.prototype.getPrimaryOrGridColumn=function(t){return this.getPrimaryColumn(t)||this.getGridColumn(t)},e.prototype.setColumnWidths=function(t,e,n,o){var r=this;void 0===o&&(o="api");var i=[];t.forEach((function(t){var n=r.getPrimaryOrGridColumn(t.key);if(n&&(i.push({width:t.newWidth,ratios:[1],columns:[n]}),"shift"===r.gridOptionsService.get("colResizeDefault")&&(e=!e),e)){var o=r.getDisplayedColAfter(n);if(!o)return;var s=n.getActualWidth()-t.newWidth,a=o.getActualWidth()+s;i.push({width:a,ratios:[1],columns:[o]})}})),0!==i.length&&this.resizeColumnSets({resizeSets:i,finished:n,source:o})},e.prototype.checkMinAndMaxWidthsForSet=function(t){var e=t.columns,n=t.width,o=0,i=0,s=!0;return e.forEach((function(t){var e=t.getMinWidth();o+=e||0;var n=t.getMaxWidth();r(n)&&n>0?i+=n:s=!1})),n>=o&&(!s||n<=i)},e.prototype.resizeColumnSets=function(t){var e=this,n=t.resizeSets,o=t.finished,i=t.source;if(!n||n.every((function(t){return e.checkMinAndMaxWidthsForSet(t)}))){var s=[],a=[];n.forEach((function(t){var e=t.width,n=t.columns,o=t.ratios,l={},u={};n.forEach((function(t){return a.push(t)}));for(var c=!0,p=0,h=function(){if(++p>1e3)return console.error("AG Grid: infinite loop in resizeColumnSets"),"break";c=!1;var t=[],i=0,s=e;n.forEach((function(e,n){if(u[e.getId()])s-=l[e.getId()];else{t.push(e);var r=o[n];i+=r}}));var a=1/i;t.forEach((function(n,i){var p;i===t.length-1?p=s:(p=Math.round(o[i]*e*a),s-=p);var h=n.getMinWidth(),d=n.getMaxWidth();r(h)&&p<h?(p=h,u[n.getId()]=!0,c=!0):r(d)&&d>0&&p>d&&(p=d,u[n.getId()]=!0,c=!0),l[n.getId()]=p}))};c;){if("break"===h())break}n.forEach((function(t){var e=l[t.getId()];t.getActualWidth()!==e&&(t.setActualWidth(e,i),s.push(t))}))}));var l=s.length>0,u=[];l&&(u=this.refreshFlexedColumns({resizingCols:a,skipSetLeft:!0}),this.setLeftValues(i),this.updateBodyWidths(),this.checkViewportColumns());var c=a.concat(u);(l||o)&&this.dispatchColumnResizedEvent(c,o,i,u)}else if(o){var p=n&&n.length>0?n[0].columns:null;this.dispatchColumnResizedEvent(p,o,i)}},e.prototype.setColumnAggFunc=function(t,e,n){if(void 0===n&&(n="api"),t){var o=this.getPrimaryColumn(t);o&&(o.setAggFunc(e),this.dispatchColumnChangedEvent(Zt.EVENT_COLUMN_VALUE_CHANGED,[o],n))}},e.prototype.moveRowGroupColumn=function(t,e,n){void 0===n&&(n="api");var o=this.rowGroupColumns[t],r=this.rowGroupColumns.slice(t,e);this.rowGroupColumns.splice(t,1),this.rowGroupColumns.splice(e,0,o);var i={type:Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:r,column:1===r.length?r[0]:null,source:n};this.eventService.dispatchEvent(i)},e.prototype.moveColumns=function(t,e,n,o){if(void 0===n&&(n="api"),void 0===o&&(o=!0),this.columnAnimationService.start(),e>this.gridColumns.length-t.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+e),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");var r=this.getGridColumns(t);!this.doesMovePassRules(r,e)||(St(this.gridColumns,r,e),this.updateDisplayedColumns(n),this.dispatchColumnMovedEvent({movedColumns:r,source:n,toIndex:e,finished:o}),this.columnAnimationService.finish())},e.prototype.doesMovePassRules=function(t,e){var n=this.getProposedColumnOrder(t,e);return this.doesOrderPassRules(n)},e.prototype.doesOrderPassRules=function(t){return!!this.doesMovePassMarryChildren(t)&&!!this.doesMovePassLockedPositions(t)},e.prototype.getProposedColumnOrder=function(t,e){var n=this.gridColumns.slice();return St(n,t,e),n},e.prototype.sortColumnsLikeGridColumns=function(t){var e=this;!t||t.length<=1||(t.filter((function(t){return e.gridColumns.indexOf(t)<0})).length>0||t.sort((function(t,n){return e.gridColumns.indexOf(t)-e.gridColumns.indexOf(n)})))},e.prototype.doesMovePassLockedPositions=function(t){var e=0,n=!0;return t.forEach((function(t){var o,r=(o=t.getColDef().lockPosition)?!0===o||"left"===o?0:2:1;r<e&&(n=!1),e=r})),n},e.prototype.doesMovePassMarryChildren=function(t){var e=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(n){if(n instanceof ft){var o=n,r=o.getColGroupDef();if(r&&r.marryChildren){var i=[];o.getLeafColumns().forEach((function(e){var n=t.indexOf(e);i.push(n)})),Math.max.apply(Math,i)-Math.min.apply(Math,i)>o.getLeafColumns().length-1&&(e=!1)}}})),e},e.prototype.moveColumn=function(t,e,n){void 0===n&&(n="api"),this.moveColumns([t],e,n)},e.prototype.moveColumnByIndex=function(t,e,n){void 0===n&&(n="api");var o=this.gridColumns[t];this.moveColumn(o,e,n)},e.prototype.getColumnDefs=function(){var t=this;if(this.primaryColumns){var e=this.primaryColumns.slice();return this.gridColsArePrimary?e.sort((function(e,n){return t.gridColumns.indexOf(e)-t.gridColumns.indexOf(n)})):this.lastPrimaryOrder&&e.sort((function(e,n){return t.lastPrimaryOrder.indexOf(e)-t.lastPrimaryOrder.indexOf(n)})),this.columnDefFactory.buildColumnDefs(e,this.rowGroupColumns,this.pivotColumns)}},e.prototype.getBodyContainerWidth=function(){return this.bodyWidth},e.prototype.getContainerWidth=function(t){switch(t){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}},e.prototype.updateBodyWidths=function(){var t=this.getWidthOfColsInList(this.displayedColumnsCenter),e=this.getWidthOfColsInList(this.displayedColumnsLeft),n=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==t,this.bodyWidth!==t||this.leftWidth!==e||this.rightWidth!==n){this.bodyWidth=t,this.leftWidth=e,this.rightWidth=n;var o={type:Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(o)}},e.prototype.getValueColumns=function(){return this.valueColumns?this.valueColumns:[]},e.prototype.getPivotColumns=function(){return this.pivotColumns?this.pivotColumns:[]},e.prototype.isPivotActive=function(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode},e.prototype.getRowGroupColumns=function(){return this.rowGroupColumns?this.rowGroupColumns:[]},e.prototype.getDisplayedCenterColumns=function(){return this.displayedColumnsCenter},e.prototype.getDisplayedLeftColumns=function(){return this.displayedColumnsLeft},e.prototype.getDisplayedRightColumns=function(){return this.displayedColumnsRight},e.prototype.getDisplayedColumns=function(t){switch(t){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}},e.prototype.getAllPrimaryColumns=function(){return this.primaryColumns?this.primaryColumns.slice():null},e.prototype.getSecondaryColumns=function(){return this.secondaryColumns?this.secondaryColumns.slice():null},e.prototype.getAllColumnsForQuickFilter=function(){return this.columnsForQuickFilter},e.prototype.getAllGridColumns=function(){return this.gridColumns},e.prototype.isEmpty=function(){return s(this.gridColumns)},e.prototype.isRowGroupEmpty=function(){return s(this.rowGroupColumns)},e.prototype.setColumnVisible=function(t,e,n){void 0===n&&(n="api"),this.setColumnsVisible([t],e,n)},e.prototype.setColumnsVisible=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n="api"),this.applyColumnState({state:t.map((function(t){return{colId:"string"===typeof t?t:t.getColId(),hide:!e}}))},n)},e.prototype.setColumnPinned=function(t,e,n){void 0===n&&(n="api"),t&&this.setColumnsPinned([t],e,n)},e.prototype.setColumnsPinned=function(t,e,n){var o;(void 0===n&&(n="api"),this.gridOptionsService.isDomLayout("print"))?console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'"):(this.columnAnimationService.start(),o=!0===e||"left"===e?"left":"right"===e?"right":null,this.actionOnGridColumns(t,(function(t){return t.getPinned()!==o&&(t.setPinned(o),!0)}),n,(function(){return{type:Zt.EVENT_COLUMN_PINNED,pinned:o,column:null,columns:null,source:n}})),this.columnAnimationService.finish())},e.prototype.actionOnGridColumns=function(t,e,n,o){var i=this;if(!s(t)){var a=[];if(t.forEach((function(t){var n=i.getGridColumn(t);n&&(!1!==e(n)&&a.push(n))})),a.length&&(this.updateDisplayedColumns(n),r(o)&&o)){var l=o();l.columns=a,l.column=1===a.length?a[0]:null,this.eventService.dispatchEvent(l)}}},e.prototype.getDisplayedColBefore=function(t){var e=this.getAllDisplayedColumns(),n=e.indexOf(t);return n>0?e[n-1]:null},e.prototype.getDisplayedColAfter=function(t){var e=this.getAllDisplayedColumns(),n=e.indexOf(t);return n<e.length-1?e[n+1]:null},e.prototype.getDisplayedGroupAfter=function(t){return this.getDisplayedGroupAtDirection(t,"After")},e.prototype.getDisplayedGroupBefore=function(t){return this.getDisplayedGroupAtDirection(t,"Before")},e.prototype.getDisplayedGroupAtDirection=function(t,e){for(var n=t.getProvidedColumnGroup().getLevel()+t.getPaddingLevel(),o=t.getDisplayedLeafColumns(),r="After"===e?yt(o):o[0],i="getDisplayedCol"+e;;){var s=this[i](r);if(!s)return null;var a=this.getColumnGroupAtLevel(s,n);if(a!==t)return a}},e.prototype.getColumnGroupAtLevel=function(t,e){for(var n=t.getParent();;){if(n.getProvidedColumnGroup().getLevel()+n.getPaddingLevel()<=e)break;n=n.getParent()}return n},e.prototype.isPinningLeft=function(){return this.displayedColumnsLeft.length>0},e.prototype.isPinningRight=function(){return this.displayedColumnsRight.length>0},e.prototype.getPrimaryAndSecondaryAndAutoColumns=function(){var t;return(t=[]).concat.apply(t,[this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[]])},e.prototype.createStateItemFromColumn=function(t){var e=t.isRowGroupActive()?this.rowGroupColumns.indexOf(t):null,n=t.isPivotActive()?this.pivotColumns.indexOf(t):null,o=t.isValueActive()?t.getAggFunc():null,r=null!=t.getSort()?t.getSort():null,i=null!=t.getSortIndex()?t.getSortIndex():null,s=null!=t.getFlex()&&t.getFlex()>0?t.getFlex():null;return{colId:t.getColId(),width:t.getActualWidth(),hide:!t.isVisible(),pinned:t.getPinned(),sort:r,sortIndex:i,aggFunc:o,rowGroup:t.isRowGroupActive(),rowGroupIndex:e,pivot:t.isPivotActive(),pivotIndex:n,flex:s}},e.prototype.getColumnState=function(){if(i(this.primaryColumns)||!this.isAlive())return[];var t=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(t),t},e.prototype.orderColumnStateList=function(t){var e=le(this.gridColumns.map((function(t,e){return[t.getColId(),e]})));t.sort((function(t,n){return(e.has(t.colId)?e.get(t.colId):-1)-(e.has(n.colId)?e.get(n.colId):-1)}))},e.prototype.resetColumnState=function(t){var e=this;void 0===t&&(t="api");var n=this.getColumnsFromTree(this.primaryColumnTree),o=[],r=1e3,s=1e3,a=[];this.groupAutoColumns&&(a=a.concat(this.groupAutoColumns)),n&&(a=a.concat(n)),a.forEach((function(t){var n=e.getColumnStateFromColDef(t);i(n.rowGroupIndex)&&n.rowGroup&&(n.rowGroupIndex=r++),i(n.pivotIndex)&&n.pivot&&(n.pivotIndex=s++),o.push(n)})),this.applyColumnState({state:o,applyOrder:!0},t)},e.prototype.getColumnStateFromColDef=function(t){var e=function(t,e){return null!=t?t:null!=e?e:null},n=t.getColDef(),o=e(n.sort,n.initialSort),r=e(n.sortIndex,n.initialSortIndex),i=e(n.hide,n.initialHide),s=e(n.pinned,n.initialPinned),a=e(n.width,n.initialWidth),l=e(n.flex,n.initialFlex),u=e(n.rowGroupIndex,n.initialRowGroupIndex),c=e(n.rowGroup,n.initialRowGroup);null!=u||null!=c&&0!=c||(u=null,c=null);var p=e(n.pivotIndex,n.initialPivotIndex),h=e(n.pivot,n.initialPivot);null!=p||null!=h&&0!=h||(p=null,h=null);var d=e(n.aggFunc,n.initialAggFunc);return{colId:t.getColId(),sort:o,sortIndex:r,hide:i,pinned:s,width:a,flex:l,rowGroup:c,rowGroupIndex:u,pivot:h,pivotIndex:p,aggFunc:d}},e.prototype.applyColumnState=function(t,e){var n=this;if(s(this.primaryColumns))return!1;if(t&&t.state&&!t.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;var o=function(o,r,i){var s=n.compareColumnStatesAndDispatchEvents(e);n.autoGroupsNeedBuilding=!0;var a=r.slice(),l={},u={},c=[],p=[],h=0,d=n.rowGroupColumns.slice(),f=n.pivotColumns.slice();o.forEach((function(o){var r=o.colId||"";if(r.startsWith(te))return c.push(o),void p.push(o);var s=i(r);s?(n.syncColumnWithStateItem(s,o,t.defaultState,l,u,!1,e),wt(a,s)):(p.push(o),h+=1)}));var g=function(o){return n.syncColumnWithStateItem(o,null,t.defaultState,l,u,!1,e)};a.forEach(g);var m=function(t,e,n,o){var r=t[n.getId()],i=t[o.getId()],s=null!=r,a=null!=i;if(s&&a)return r-i;if(s)return-1;if(a)return 1;var l=e.indexOf(n),u=e.indexOf(o),c=l>=0;return c&&u>=0?l-u:c?-1:1};n.rowGroupColumns.sort(m.bind(n,l,d)),n.pivotColumns.sort(m.bind(n,u,f)),n.updateGridColumns();var y=n.groupAutoColumns?n.groupAutoColumns.slice():[];return c.forEach((function(o){var r=n.getAutoColumn(o.colId);wt(y,r),n.syncColumnWithStateItem(r,o,t.defaultState,null,null,!0,e)})),y.forEach(g),n.applyOrderAfterApplyState(t),n.updateDisplayedColumns(e),n.dispatchEverythingChanged(e),s(),{unmatchedAndAutoStates:p,unmatchedCount:h}};this.columnAnimationService.start();var i=o(t.state||[],this.primaryColumns||[],(function(t){return n.getPrimaryColumn(t)})),a=i.unmatchedAndAutoStates,l=i.unmatchedCount;return(a.length>0||r(t.defaultState))&&(l=o(a,this.secondaryColumns||[],(function(t){return n.getSecondaryColumn(t)})).unmatchedCount),this.columnAnimationService.finish(),0===l},e.prototype.applyOrderAfterApplyState=function(t){var e=this;if(t.applyOrder&&t.state){var n=[],o={};t.state.forEach((function(t){if(t.colId&&!o[t.colId]){var r=e.gridColumnsMap[t.colId];r&&(n.push(r),o[t.colId]=!0)}}));var r=0;this.gridColumns.forEach((function(t){var e=t.getColId();null!=o[e]||(e.startsWith(te)?Et(n,t,r++):n.push(t))})),n=this.placeLockedColumns(n),this.doesMovePassMarryChildren(n)?this.gridColumns=n:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}},e.prototype.compareColumnStatesAndDispatchEvents=function(t){var e=this,n={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},o=this.getColumnState(),r={};return o.forEach((function(t){r[t.colId]=t})),function(){var i=e.getPrimaryAndSecondaryAndAutoColumns(),s=function(n,o,r,i){if(!vt(o.map(i),r.map(i))){var s=new Set(o);r.forEach((function(t){s.delete(t)||s.add(t)}));var a=Le([],Me(s)),l={type:n,columns:a,column:1===a.length?a[0]:null,source:t};e.eventService.dispatchEvent(l)}},a=function(t){var e=[];return i.forEach((function(n){var o=r[n.getColId()];o&&t(o,n)&&e.push(n)})),e},l=function(t){return t.getColId()};s(Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,n.rowGroupColumns,e.rowGroupColumns,l),s(Zt.EVENT_COLUMN_PIVOT_CHANGED,n.pivotColumns,e.pivotColumns,l);var u=a((function(t,e){var n=null!=t.aggFunc,o=n!=e.isValueActive(),r=n&&t.aggFunc!=e.getAggFunc();return o||r}));u.length>0&&e.dispatchColumnChangedEvent(Zt.EVENT_COLUMN_VALUE_CHANGED,u,t);e.dispatchColumnResizedEvent(a((function(t,e){return t.width!=e.getActualWidth()})),!0,t);e.dispatchColumnPinnedEvent(a((function(t,e){return t.pinned!=e.getPinned()})),t);e.dispatchColumnVisibleEvent(a((function(t,e){return t.hide==e.isVisible()})),t);a((function(t,e){return t.sort!=e.getSort()||t.sortIndex!=e.getSortIndex()})).length>0&&e.sortController.dispatchSortChangedEvents(t),e.normaliseColumnMovedEventForColumnState(o,t)}},e.prototype.getCommonValue=function(t,e){if(t&&0!=t.length){for(var n=e(t[0]),o=1;o<t.length;o++)if(n!==e(t[o]))return;return n}},e.prototype.normaliseColumnMovedEventForColumnState=function(t,e){var n=this,o=this.getColumnState(),r={};o.forEach((function(t){return r[t.colId]=t}));var i={};t.forEach((function(t){r[t.colId]&&(i[t.colId]=!0)}));var s=t.filter((function(t){return i[t.colId]})),a=o.filter((function(t){return i[t.colId]})),l=[];a.forEach((function(t,e){var o=s&&s[e];if(o&&o.colId!==t.colId){var r=n.getGridColumn(o.colId);r&&l.push(r)}})),l.length&&this.dispatchColumnMovedEvent({movedColumns:l,source:e,finished:!0})},e.prototype.syncColumnWithStateItem=function(t,e,n,o,i,s,a){if(t){var l=function(t,o){var i={value1:void 0,value2:void 0},s=!1;return e&&(void 0!==e[t]&&(i.value1=e[t],s=!0),r(o)&&void 0!==e[o]&&(i.value2=e[o],s=!0)),!s&&n&&(void 0!==n[t]&&(i.value1=n[t]),r(o)&&void 0!==n[o]&&(i.value2=n[o])),i},u=l("hide").value1;void 0!==u&&t.setVisible(!u,a);var c=l("pinned").value1;void 0!==c&&t.setPinned(c);var p=this.columnUtils.calculateColMinWidth(t.getColDef()),h=l("flex").value1;if(void 0!==h&&t.setFlex(h),t.getFlex()<=0){var d=l("width").value1;null!=d&&null!=p&&d>=p&&t.setActualWidth(d,a)}var f=l("sort").value1;void 0!==f&&("desc"===f||"asc"===f?t.setSort(f,a):t.setSort(void 0,a));var g=l("sortIndex").value1;if(void 0!==g&&t.setSortIndex(g),!s&&t.isPrimary()){var m=l("aggFunc").value1;void 0!==m&&("string"===typeof m?(t.setAggFunc(m),t.isValueActive()||(t.setValueActive(!0,a),this.valueColumns.push(t))):(r(m)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),t.isValueActive()&&(t.setValueActive(!1,a),wt(this.valueColumns,t))));var y=l("rowGroup","rowGroupIndex"),v=y.value1,_=y.value2;void 0===v&&void 0===_||("number"===typeof _||v?(t.isRowGroupActive()||(t.setRowGroupActive(!0,a),this.rowGroupColumns.push(t)),o&&"number"===typeof _&&(o[t.getId()]=_)):t.isRowGroupActive()&&(t.setRowGroupActive(!1,a),wt(this.rowGroupColumns,t)));var C=l("pivot","pivotIndex"),w=C.value1,b=C.value2;void 0===w&&void 0===b||("number"===typeof b||w?(t.isPivotActive()||(t.setPivotActive(!0,a),this.pivotColumns.push(t)),i&&"number"===typeof b&&(i[t.getId()]=b)):t.isPivotActive()&&(t.setPivotActive(!1,a),wt(this.pivotColumns,t)))}}},e.prototype.getGridColumns=function(t){return this.getColumns(t,this.getGridColumn.bind(this))},e.prototype.getColumns=function(t,e){var n=[];return t&&t.forEach((function(t){var o=e(t);o&&n.push(o)})),n},e.prototype.getColumnWithValidation=function(t){if(null==t)return null;var e=this.getGridColumn(t);return e||console.warn("AG Grid: could not find column "+t),e},e.prototype.getPrimaryColumn=function(t){return this.primaryColumns?this.getColumn(t,this.primaryColumns,this.primaryColumnsMap):null},e.prototype.getGridColumn=function(t){return this.getColumn(t,this.gridColumns,this.gridColumnsMap)},e.prototype.getSecondaryColumn=function(t){return this.secondaryColumns?this.getColumn(t,this.secondaryColumns,this.secondaryColumnsMap):null},e.prototype.getColumn=function(t,e,n){if(!t)return null;if("string"==typeof t&&n[t])return n[t];for(var o=0;o<e.length;o++)if(this.columnsMatch(e[o],t))return e[o];return this.getAutoColumn(t)},e.prototype.getSourceColumnsForGroupColumn=function(t){var e=t.getColDef().showRowGroup;if(!e)return null;if(!0===e)return this.rowGroupColumns.slice(0);var n=this.getPrimaryColumn(e);return n?[n]:null},e.prototype.getAutoColumn=function(t){var e=this;return this.groupAutoColumns&&r(this.groupAutoColumns)&&!i(this.groupAutoColumns)&&this.groupAutoColumns.find((function(n){return e.columnsMatch(n,t)}))||null},e.prototype.columnsMatch=function(t,e){var n=t===e,o=t.getColDef()===e,r=t.getColId()==e;return n||o||r},e.prototype.getDisplayNameForColumn=function(t,e,n){if(void 0===n&&(n=!1),!t)return null;var o=this.getHeaderName(t.getColDef(),t,null,null,e);return n?this.wrapHeaderNameWithAggFunc(t,o):o},e.prototype.getDisplayNameForProvidedColumnGroup=function(t,e,n){var o=e?e.getColGroupDef():null;return o?this.getHeaderName(o,null,t,e,n):null},e.prototype.getDisplayNameForColumnGroup=function(t,e){return this.getDisplayNameForProvidedColumnGroup(t,t.getProvidedColumnGroup(),e)},e.prototype.getHeaderName=function(t,e,n,o,r){var i=t.headerValueGetter;if(i){var s={colDef:t,column:e,columnGroup:n,providedColumnGroup:o,location:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"===typeof i?i(s):"string"===typeof i?this.expressionService.evaluate(i,s):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=t.headerName?t.headerName:t.field?ie(t.field):""},e.prototype.wrapHeaderNameWithAggFunc=function(t,e){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return e;var n,o=t.getColDef().pivotValueColumn,i=null;if(r(o)){var s=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,a=void 0!==t.getColDef().pivotTotalColumnIds;if(s&&!a)return e;i=o?o.getAggFunc():null,n=!0}else{var l=t.isValueActive(),u=this.pivotMode||!this.isRowGroupEmpty();l&&u?(i=t.getAggFunc(),n=!0):n=!1}if(n){var c="string"===typeof i?i:"func";return this.localeService.getLocaleTextFunc()(c,c)+"("+e+")"}return e},e.prototype.getColumnGroup=function(t,e){if(!t)return null;if(t instanceof Kt)return t;var n=this.getAllDisplayedTrees(),o="number"===typeof e,r=null;return this.columnUtils.depthFirstAllColumnTreeSearch(n,(function(n){if(n instanceof Kt){var i=n;(o?t===i.getGroupId()&&e===i.getPartId():t===i.getGroupId())&&(r=i)}})),r},e.prototype.isReady=function(){return this.ready},e.prototype.extractValueColumns=function(t,e){this.valueColumns=this.extractColumns(e,this.valueColumns,(function(e,n){return e.setValueActive(n,t)}),(function(){}),(function(){}),(function(t){var e=t.aggFunc;return null===e||""===e?null:void 0!==e?!!e:void 0}),(function(t){return null!=t.initialAggFunc&&""!=t.initialAggFunc})),this.valueColumns.forEach((function(t){var e=t.getColDef();null!=e.aggFunc&&""!=e.aggFunc?t.setAggFunc(e.aggFunc):t.getAggFunc()||t.setAggFunc(e.initialAggFunc)}))},e.prototype.extractRowGroupColumns=function(t,e){this.rowGroupColumns=this.extractColumns(e,this.rowGroupColumns,(function(e,n){return e.setRowGroupActive(n,t)}),(function(t){return t.rowGroupIndex}),(function(t){return t.initialRowGroupIndex}),(function(t){return t.rowGroup}),(function(t){return t.initialRowGroup}))},e.prototype.extractColumns=function(t,e,n,o,r,i,s){void 0===t&&(t=[]),void 0===e&&(e=[]);var a=[],c=[];(this.primaryColumns||[]).forEach((function(n){var p=t.indexOf(n)<0,h=n.getColDef(),d=u(i(h)),f=u(s(h)),g=l(o(h)),m=l(r(h));(void 0!==d?d:void 0!==g?null!==g&&g>=0:p?void 0!==f?f:!!(void 0!==m)&&(null!=m&&m>=0):e.indexOf(n)>=0)&&((p?null!=g||null!=m:null!=g)?a.push(n):c.push(n))}));var p=function(t){var e=o(t.getColDef()),n=r(t.getColDef());return null!=e?e:n};a.sort((function(t,e){var n=p(t),o=p(e);return n===o?0:n<o?-1:1}));var h=[].concat(a);return e.forEach((function(t){c.indexOf(t)>=0&&h.push(t)})),c.forEach((function(t){h.indexOf(t)<0&&h.push(t)})),e.forEach((function(t){h.indexOf(t)<0&&n(t,!1)})),h.forEach((function(t){e.indexOf(t)<0&&n(t,!0)})),h},e.prototype.extractPivotColumns=function(t,e){this.pivotColumns=this.extractColumns(e,this.pivotColumns,(function(e,n){return e.setPivotActive(n,t)}),(function(t){return t.pivotIndex}),(function(t){return t.initialPivotIndex}),(function(t){return t.pivot}),(function(t){return t.initialPivot}))},e.prototype.resetColumnGroupState=function(t){void 0===t&&(t="api");var e=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,(function(t){if(t instanceof ft){var n=t.getColGroupDef(),o={groupId:t.getGroupId(),open:n?n.openByDefault:void 0};e.push(o)}})),this.setColumnGroupState(e,t)},e.prototype.getColumnGroupState=function(){var t=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(e){e instanceof ft&&t.push({groupId:e.getGroupId(),open:e.isExpanded()})})),t},e.prototype.setColumnGroupState=function(t,e){var n=this;void 0===e&&(e="api"),this.columnAnimationService.start();var o=[];t.forEach((function(t){var e=t.groupId,r=t.open,i=n.getProvidedColumnGroup(e);i&&i.isExpanded()!==r&&(n.logger.log("columnGroupOpened("+i.getGroupId()+","+r+")"),i.setExpanded(r),o.push(i))})),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e),o.forEach((function(t){var e={type:Zt.EVENT_COLUMN_GROUP_OPENED,columnGroup:t};n.eventService.dispatchEvent(e)})),this.columnAnimationService.finish()},e.prototype.setColumnGroupOpened=function(t,e,n){var o;void 0===n&&(n="api"),o=t instanceof ft?t.getId():t||"",this.setColumnGroupState([{groupId:o,open:e}],n)},e.prototype.getProvidedColumnGroup=function(t){"string"!==typeof t&&console.error("AG Grid: group key must be a string");var e=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(n){n instanceof ft&&n.getId()===t&&(e=n)})),e},e.prototype.calculateColumnsForDisplay=function(){var t=this;return this.pivotMode&&i(this.secondaryColumns)?this.gridColumns.filter((function(e){var n=t.groupAutoColumns&&Tt(t.groupAutoColumns,e),o=t.valueColumns&&Tt(t.valueColumns,e);return n||o})):this.gridColumns.filter((function(e){return t.groupAutoColumns&&Tt(t.groupAutoColumns,e)||e.isVisible()}))},e.prototype.checkColSpanActiveInCols=function(t){var e=!1;return t.forEach((function(t){r(t.getColDef().colSpan)&&(e=!0)})),e},e.prototype.calculateColumnsForGroupDisplay=function(){var t=this;this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};this.gridColumns.forEach((function(e){var n=e.getColDef(),o=n.showRowGroup;n&&r(o)&&(t.groupDisplayColumns.push(e),"string"===typeof o?t.groupDisplayColumnsMap[o]=e:!0===o&&t.getRowGroupColumns().forEach((function(n){t.groupDisplayColumnsMap[n.getId()]=e})))}))},e.prototype.getGroupDisplayColumns=function(){return this.groupDisplayColumns},e.prototype.getGroupDisplayColumnForGroup=function(t){return this.groupDisplayColumnsMap[t]},e.prototype.updateDisplayedColumns=function(t){var e=this.calculateColumnsForDisplay();this.buildDisplayedTrees(e),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t)},e.prototype.isSecondaryColumnsPresent=function(){return r(this.secondaryColumns)},e.prototype.setSecondaryColumns=function(t,e){var n=this;void 0===e&&(e="api");var o=t&&t.length>0;if(o||!i(this.secondaryColumns)){if(o){this.processSecondaryColumnDefinitions(t);var r=this.columnFactory.createColumnTree(t,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,r.columnTree),this.secondaryBalancedTree=r.columnTree,this.secondaryHeaderRowCount=r.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach((function(t){return n.secondaryColumnsMap[t.getId()]=t})),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(e)}},e.prototype.processSecondaryColumnDefinitions=function(t){var e=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),n=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(e||n){var o=function(t){t.forEach((function(t){if(r(t.children)){var i=t;n&&n(i),o(i.children)}else{e&&e(t)}}))};t&&o(t)}},e.prototype.updateGridColumns=function(){var t,e=this,n=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){var o=this.secondaryColumns.every((function(t){return void 0!==e.gridColumnsMap[t.getColId()]}));this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,o&&(t=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,t=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&t){var r=le(this.groupAutoColumns.map((function(t){return[t,!0]})));t=t.filter((function(t){return!r.has(t)})),t=Le(Le([],Me(this.groupAutoColumns)),Me(t))}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(t),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach((function(t){return e.gridColumnsMap[t.getId()]=t})),this.setAutoHeightActive(),!vt(n,this.gridBalancedTree)){var i={type:Zt.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(i)}},e.prototype.setAutoHeightActive=function(){if((this.autoHeightActive=this.gridColumns.filter((function(t){return t.isAutoHeight()})).length>0,this.autoHeightActive)&&(this.autoHeightActiveAtLeastOnce=!0,!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide")))){P((function(){return console.warn("AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}),"autoHeightActive.wrongRowModel")}},e.prototype.orderGridColsLike=function(t){if(!i(t)){var e=le(t.map((function(t,e){return[t,e]}))),n=!0;if(this.gridColumns.forEach((function(t){e.has(t)&&(n=!1)})),!n){var o=le(this.gridColumns.map((function(t){return[t,!0]}))),r=t.filter((function(t){return o.has(t)})),s=le(r.map((function(t){return[t,!0]}))),a=this.gridColumns.filter((function(t){return!s.has(t)})),l=r.slice();a.forEach((function(t){var e=t.getOriginalParent();if(e){for(var n=[];!n.length&&e;){e.getLeafColumns().forEach((function(t){var e=l.indexOf(t)>=0,o=n.indexOf(t)<0;e&&o&&n.push(t)})),e=e.getOriginalParent()}if(n.length){var o=n.map((function(t){return l.indexOf(t)})),r=Math.max.apply(Math,Le([],Me(o)));Et(l,t,r+1)}else l.push(t)}else l.push(t)})),this.gridColumns=l}}},e.prototype.isPrimaryColumnGroupsPresent=function(){return this.primaryHeaderRowCount>1},e.prototype.refreshQuickFilterColumns=function(){var t,e=null!==(t=this.isPivotMode()?this.secondaryColumns:this.primaryColumns)&&void 0!==t?t:[];this.groupAutoColumns&&(e=e.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")?e:e.filter((function(t){return t.isVisible()||t.isRowGroupActive()}))},e.prototype.placeLockedColumns=function(t){var e=[],n=[],o=[];return t.forEach((function(t){var r=t.getColDef().lockPosition;"right"===r?o.push(t):"left"===r||!0===r?e.push(t):n.push(t)})),Le(Le(Le([],Me(e)),Me(n)),Me(o))},e.prototype.addAutoGroupToGridColumns=function(){if(i(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;var t=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,t),this.groupAutoColsBalancedTree=t,this.gridBalancedTree=t.concat(this.gridBalancedTree)},e.prototype.clearDisplayedAndViewportColumns=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""},e.prototype.updateGroupsAndDisplayedColumns=function(t){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(t),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();var e={type:Zt.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.deriveDisplayedColumns=function(t){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(t),this.displayedAutoHeightCols=this.displayedColumns.filter((function(t){return t.isAutoHeight()}))},e.prototype.isAutoRowHeightActive=function(){return this.autoHeightActive},e.prototype.wasAutoRowHeightEverActive=function(){return this.autoHeightActiveAtLeastOnce},e.prototype.joinDisplayedColumns=function(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)},e.prototype.setLeftValues=function(t){this.setLeftValuesOfColumns(t),this.setLeftValuesOfGroups()},e.prototype.setLeftValuesOfColumns=function(t){var e=this;if(this.primaryColumns){var n=this.primaryColumns.slice(0),o=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach((function(r){if(o){var i=e.getWidthOfColsInList(r);r.forEach((function(e){i-=e.getActualWidth(),e.setLeft(i,t)}))}else{var s=0;r.forEach((function(e){e.setLeft(s,t),s+=e.getActualWidth()}))}bt(n,r)})),n.forEach((function(e){e.setLeft(null,t)}))}},e.prototype.setLeftValuesOfGroups=function(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach((function(t){t.forEach((function(t){t instanceof Kt&&t.checkLeft()}))}))},e.prototype.derivedDisplayedColumnsFromDisplayedTree=function(t,e){e.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(t,(function(t){t instanceof ht&&e.push(t)}))},e.prototype.extractViewportColumns=function(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)},e.prototype.getVirtualHeaderGroupRow=function(t,e){var n;switch(t){case"left":n=this.viewportRowLeft[e];break;case"right":n=this.viewportRowRight[e];break;default:n=this.viewportRowCenter[e]}return i(n)&&(n=[]),n},e.prototype.calculateHeaderRows=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};var t={};this.headerViewportColumns.forEach((function(e){return t[e.getId()]=!0}));var e=function(n,o,r){for(var i=!1,s=0;s<n.length;s++){var a=n[s],l=!1;if(a instanceof ht)l=!0===t[a.getId()];else{var u=a.getDisplayedChildren();u&&(l=e(u,o,r+1))}l&&(i=!0,o[r]||(o[r]=[]),o[r].push(a))}return i};e(this.displayedTreeLeft,this.viewportRowLeft,0),e(this.displayedTreeRight,this.viewportRowRight,0),e(this.displayedTreeCentre,this.viewportRowCenter,0)},e.prototype.extractViewport=function(){this.extractViewportColumns();var t=this.viewportColumns.map((function(t){return t.getId()+"-"+(t.getPinned()||"normal")})).join("#"),e=this.viewportColumnsHash!==t;return e&&(this.viewportColumnsHash=t,this.calculateHeaderRows()),e},e.prototype.refreshFlexedColumns=function(t){var e;void 0===t&&(t={});var n=t.source?t.source:"flex";if(null!=t.viewportWidth&&(this.flexViewportWidth=t.viewportWidth),!this.flexViewportWidth)return[];var o=-1;if(t.resizingCols)for(var i=new Set(t.resizingCols),s=this.displayedColumnsCenter,a=s.length-1;a>=0;a--)if(i.has(s[a])){o=a;break}var l=0,u=[],c=0,p=0;for(a=0;a<this.displayedColumnsCenter.length;a++){this.displayedColumnsCenter[a].getFlex()&&a>o?(u.push(this.displayedColumnsCenter[a]),p+=this.displayedColumnsCenter[a].getFlex(),c+=null!==(e=this.displayedColumnsCenter[a].getMinWidth())&&void 0!==e?e:0):l+=this.displayedColumnsCenter[a].getActualWidth()}if(!u.length)return[];var h=[];l+c>this.flexViewportWidth&&(u.forEach((function(t){var e;return t.setActualWidth(null!==(e=t.getMinWidth())&&void 0!==e?e:0,n)})),h=u,u=[]);var d,f=[];t:for(;;){var g=(d=this.flexViewportWidth-l)/p;for(a=0;a<u.length;a++){var m=u[a],y=g*m.getFlex(),v=0,_=m.getMinWidth(),C=m.getMaxWidth();if(r(_)&&y<_?v=_:r(C)&&y>C&&(v=C),v){m.setActualWidth(v,n),Ct(u,m),p-=m.getFlex(),h.push(m),l+=m.getActualWidth();continue t}f[a]=Math.round(y)}break}var w=d;return u.forEach((function(t,e){t.setActualWidth(Math.min(f[e],w),n),h.push(t),w-=f[e]})),t.skipSetLeft||this.setLeftValues(n),t.updateBodyWidths&&this.updateBodyWidths(),t.fireResizedEvent&&this.dispatchColumnResizedEvent(h,!0,n,u),u},e.prototype.sizeColumnsToFit=function(t,e,n,o){var i,s,a,l,u,c=this;if(void 0===e&&(e="sizeColumnsToFit"),this.shouldQueueResizeOperations)this.resizeOperationQueue.push((function(){return c.sizeColumnsToFit(t,e,n,o)}));else{var p={};o&&(null===(i=null===o||void 0===o?void 0:o.columnLimits)||void 0===i||i.forEach((function(t){var e=t.key,n=De(t,["key"]);p["string"===typeof e?e:e.getColId()]=n})));var h=this.getAllDisplayedColumns(),d=t===this.getWidthOfColsInList(h);if(!(t<=0||!h.length||d)){var f=[],g=[];h.forEach((function(t){!0===t.getColDef().suppressSizeToFit?g.push(t):f.push(t)}));var m=f.slice(0),y=!1,v=function(t){wt(f,t),g.push(t)};for(f.forEach((function(t){var n,r;t.resetActualWidth(e);var i=null===p||void 0===p?void 0:p[t.getId()],s=null!==(n=null===i||void 0===i?void 0:i.minWidth)&&void 0!==n?n:null===o||void 0===o?void 0:o.defaultMinWidth,a=null!==(r=null===i||void 0===i?void 0:i.maxWidth)&&void 0!==r?r:null===o||void 0===o?void 0:o.defaultMaxWidth,l=t.getActualWidth();"number"===typeof s&&l<s?t.setActualWidth(s,e,!0):"number"===typeof a&&l>a&&t.setActualWidth(a,e,!0)}));!y;){y=!0;var _=t-this.getWidthOfColsInList(g);if(_<=0)f.forEach((function(t){var n,r,i=null!==(r=null===(n=null===p||void 0===p?void 0:p[t.getId()])||void 0===n?void 0:n.minWidth)&&void 0!==r?r:null===o||void 0===o?void 0:o.defaultMinWidth;"number"!==typeof i?t.setMinimum(e):t.setActualWidth(i,e,!0)}));else for(var C=_/this.getWidthOfColsInList(f),w=_,b=f.length-1;b>=0;b--){var x=f[b],E=null===p||void 0===p?void 0:p[x.getId()],S=null!==(s=null===E||void 0===E?void 0:E.minWidth)&&void 0!==s?s:null===o||void 0===o?void 0:o.defaultMinWidth,T=null!==(a=null===E||void 0===E?void 0:E.maxWidth)&&void 0!==a?a:null===o||void 0===o?void 0:o.defaultMaxWidth,R=null!==(l=x.getMinWidth())&&void 0!==l?l:0,O=null!==(u=x.getMaxWidth())&&void 0!==u?u:Number.MAX_VALUE,P="number"===typeof S&&S>R?S:x.getMinWidth(),I="number"===typeof T&&T<O?T:x.getMaxWidth(),A=Math.round(x.getActualWidth()*C);r(P)&&A<P?(A=P,v(x),y=!1):r(I)&&A>I?(A=I,v(x),y=!1):0===b&&(A=w),x.setActualWidth(A,e,!0),w-=A}}m.forEach((function(t){t.fireColumnWidthChangedEvent(e)})),this.setLeftValues(e),this.updateBodyWidths(),n||this.dispatchColumnResizedEvent(m,!0,e)}}},e.prototype.buildDisplayedTrees=function(t){var e=[],n=[],o=[];t.forEach((function(t){switch(t.getPinned()){case"left":e.push(t);break;case"right":n.push(t);break;default:o.push(t)}}));var r=new Jt;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(e,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(n,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(o,r,null,this.displayedTreeCentre),this.updateDisplayedMap()},e.prototype.updateDisplayedMap=function(){var t=this;this.displayedColumnsAndGroupsMap={};var e=function(e){t.displayedColumnsAndGroupsMap[e.getUniqueId()]=e};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,e),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,e)},e.prototype.isDisplayed=function(t){return this.displayedColumnsAndGroupsMap[t.getUniqueId()]===t},e.prototype.updateOpenClosedVisibilityInColumnGroups=function(){var t=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(t,(function(t){t instanceof Kt&&t.calculateDisplayedColumns()}))},e.prototype.getGroupAutoColumns=function(){return this.groupAutoColumns},e.prototype.createGroupAutoColumnsIfNeeded=function(){var t=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;var e=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),n=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!n&&!e){var o=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(o,this.groupAutoColumns)||t)return this.groupAutoColumns=o,!0}else this.groupAutoColumns=null;return!1},e.prototype.isGroupSuppressAutoColumn=function(){var t=this.gridOptionsService.get("groupDisplayType");if(!!t&&Oe("custom",t))return!0;var e=this.gridOptionsService.get("treeDataDisplayType");return!!e&&function(t,e){var n=["auto","custom"];return n.indexOf(e)<0?(console.warn("AG Grid: '"+e+"' is not a valid treeDataDisplayType value - possible values are: '"+n.join("', '")+"'"),!1):e===t}("custom",e)},e.prototype.autoColsEqual=function(t,e){return vt(t,e,(function(t,e){return t.getColId()===e.getColId()}))},e.prototype.getWidthOfColsInList=function(t){return t.reduce((function(t,e){return t+e.getActualWidth()}),0)},e.prototype.getGridBalancedTree=function(){return this.gridBalancedTree},e.prototype.getFirstDisplayedColumn=function(){var t=this.gridOptionsService.is("enableRtl"),e=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];t&&e.reverse();for(var n=0;n<e.length;n++){var o=this[e[n]]();if(o.length)return t?yt(o):o[0]}return null},e.prototype.setColumnHeaderHeight=function(t,e){if(t.setAutoHeaderHeight(e)){var n={type:Zt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:t,columns:[t],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(n)}},e.prototype.getColumnGroupHeaderRowHeight=function(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()},e.prototype.getColumnHeaderRowHeight=function(){var t=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),e=this.getAllDisplayedColumns().filter((function(t){return t.isAutoHeaderHeight()})).map((function(t){return t.getAutoHeaderHeight()||0}));return Math.max.apply(Math,Le([t],Me(e)))},e.prototype.getHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("headerHeight"))&&void 0!==t?t:this.environment.getFromTheme(25,"headerHeight")},e.prototype.getFloatingFiltersHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==t?t:this.getHeaderHeight()},e.prototype.getGroupHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==t?t:this.getHeaderHeight()},e.prototype.getPivotHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==t?t:this.getHeaderHeight()},e.prototype.getPivotGroupHeaderHeight=function(){var t;return null!==(t=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==t?t:this.getGroupHeaderHeight()},e.prototype.queueResizeOperations=function(){this.shouldQueueResizeOperations=!0},e.prototype.processResizeOperations=function(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach((function(t){return t()})),this.resizeOperationQueue=[]},e.prototype.resetColumnDefIntoColumn=function(t){var e=t.getUserProvidedColDef();if(!e)return!1;var n=this.columnFactory.addColumnDefaultAndTypes(e,t.getColId());return t.setColDef(n,e),!0},e.prototype.generateColumnStateForRowGroupAndPivotIndexes=function(t,e){var n=this,o={},r=function(t,e,r,i,s,a){if(!e.length||!n.primaryColumns)return[];for(var l=Object.keys(t),u=new Set(l),c=new Set(l),p=new Set(e.map((function(t){var e=t.getColId();return c.delete(e),e})).concat(l)),h=[],d={},f=0,g=0;g<n.primaryColumns.length;g++){var m=n.primaryColumns[g].getColId();p.has(m)&&(h.push(m),d[m]=f++)}var y=1e3,v=!1,_=0,C=function(e){for(var n=d[e],o=_;o<n;o++){var r=h[o];c.has(r)&&(t[r][s]=y++,c.delete(r))}_=n};e.forEach((function(e){var n=e.getColId();if(u.has(n))C(n),t[n][s]=y++;else{var l=e.getColDef();if(null===l[s]||void 0===l[s]&&null==l[a]){if(!v)l[r]||void 0===l[r]&&l[i]?C(n):(c.forEach((function(e){t[e][s]=y+d[e]})),y+=h.length,v=!0);o[n]||(o[n]={colId:n}),o[n][s]=y++}}}))};return r(t,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),r(e,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(o)},Ie([$("expressionService")],e.prototype,"expressionService",void 0),Ie([$("columnFactory")],e.prototype,"columnFactory",void 0),Ie([$("displayedGroupCreator")],e.prototype,"displayedGroupCreator",void 0),Ie([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Ie([$("autoWidthCalculator")],e.prototype,"autoWidthCalculator",void 0),Ie([$("columnUtils")],e.prototype,"columnUtils",void 0),Ie([$("columnAnimationService")],e.prototype,"columnAnimationService",void 0),Ie([$("autoGroupColService")],e.prototype,"autoGroupColService",void 0),Ie([tt("aggFuncService")],e.prototype,"aggFuncService",void 0),Ie([tt("valueCache")],e.prototype,"valueCache",void 0),Ie([tt("animationFrameService")],e.prototype,"animationFrameService",void 0),Ie([$("sortController")],e.prototype,"sortController",void 0),Ie([$("columnDefFactory")],e.prototype,"columnDefFactory",void 0),Ie([Z],e.prototype,"init",null),Ie([J],e.prototype,"destroyColumns",null),Ie([Ae(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=Ie([Q("columnModel")],e)}(Ht),ke=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ge=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ke(e,t),e.prototype.calculateColMinWidth=function(t){return null!=t.minWidth?t.minWidth:this.environment.getMinColWidth()},e.prototype.calculateColMaxWidth=function(t){return null!=t.maxWidth?t.maxWidth:Number.MAX_SAFE_INTEGER},e.prototype.calculateColInitialWidth=function(t){var e,n=this.calculateColMinWidth(t),o=this.calculateColMaxWidth(t),r=l(t.width),i=l(t.initialWidth);return e=null!=r?r:null!=i?i:200,Math.max(Math.min(e,o),n)},e.prototype.getOriginalPathForColumn=function(t,e){var n=[],o=!1,r=function(e,i){for(var s=0;s<e.length;s++){if(o)return;var a=e[s];if(a instanceof ft)r(a.getChildren(),i+1),n[i]=a;else a===t&&(o=!0)}};return r(e,0),o?n:null},e.prototype.depthFirstOriginalTreeSearch=function(t,e,n){var o=this;e&&e.forEach((function(e){e instanceof ft&&o.depthFirstOriginalTreeSearch(e,e.getChildren(),n),n(e,t)}))},e.prototype.depthFirstAllColumnTreeSearch=function(t,e){var n=this;t&&t.forEach((function(t){t instanceof Kt&&n.depthFirstAllColumnTreeSearch(t.getChildren(),e),e(t)}))},e.prototype.depthFirstDisplayedColumnTreeSearch=function(t,e){var n=this;t&&t.forEach((function(t){t instanceof Kt&&n.depthFirstDisplayedColumnTreeSearch(t.getDisplayedChildren(),e),e(t)}))},e=Ge([Q("columnUtils")],e)}(Ht),Ve=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ze=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ve(e,t),e.prototype.createDisplayedGroups=function(t,e,n,o){for(var r=this,i=this.mapOldGroupsById(o),s=[],a=t,l=function(){var t=a;a=[];for(var o=0,l=function(l){var u=o;o=l;var c=t[u],p=(c instanceof Kt?c.getProvidedColumnGroup():c).getOriginalParent();if(null!=p){var h=r.createColumnGroup(p,e,i,n);for(d=u;d<l;d++)h.addChild(t[d]);a.push(h)}else for(var d=u;d<l;d++)s.push(t[d])},u=1;u<t.length;u++){var c=t[u],p=(c instanceof Kt?c.getProvidedColumnGroup():c).getOriginalParent(),h=t[o];p!==(h instanceof Kt?h.getProvidedColumnGroup():h).getOriginalParent()&&l(u)}o<t.length&&l(t.length)};a.length;)l();return this.setupParentsIntoColumns(s,null),s},e.prototype.createColumnGroup=function(t,e,n,o){var i=t.getGroupId(),s=e.getInstanceIdForKey(i),a=n[Kt.createUniqueId(i,s)];return a&&a.getProvidedColumnGroup()!==t&&(a=null),r(a)?a.reset():(a=new Kt(t,i,s,o),this.context.createBean(a)),a},e.prototype.mapOldGroupsById=function(t){var e={},n=function(t){t.forEach((function(t){if(t instanceof Kt){var o=t;e[t.getUniqueId()]=o,n(o.getChildren())}}))};return t&&n(t),e},e.prototype.setupParentsIntoColumns=function(t,e){var n=this;t.forEach((function(t){if(t.setParent(e),t instanceof Kt){var o=t;n.setupParentsIntoColumns(o.getChildren(),o)}}))},e=ze([Q("displayedGroupCreator")],e)}(Ht),He=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ue=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},We=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.componentsMappedByName={},e}return He(e,t),e.prototype.setupComponents=function(t){var e=this;t&&t.forEach((function(t){return e.addComponent(t)}))},e.prototype.addComponent=function(t){var e=t.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[e]=t.componentClass},e.prototype.getComponentClass=function(t){return this.componentsMappedByName[t]},e=Ue([Q("agStackComponentsRegistry")],e)}(Ht);function qe(t,e,n){null==n||""==n?Ye(t,e):Xe(t,e,n)}function Xe(t,e,n){t.setAttribute(Ke(e),n.toString())}function Ye(t,e){t.removeAttribute(Ke(e))}function Ke(t){return"aria-"+t}function Ze(t,e){e?t.setAttribute("role",e):t.removeAttribute("role")}function Je(t){return"asc"===t?"ascending":"desc"===t?"descending":"mixed"===t?"other":"none"}function Qe(t){return parseInt(t.getAttribute("aria-level"),10)}function $e(t){return parseInt(t.getAttribute("aria-posinset"),10)}function tn(t,e){qe(t,"label",e)}function en(t,e){qe(t,"labelledby",e)}function nn(t,e){qe(t,"description",e)}function on(t,e){qe(t,"describedby",e)}function rn(t,e){qe(t,"live",e)}function sn(t,e){qe(t,"level",e)}function an(t,e){qe(t,"disabled",e)}function ln(t,e){qe(t,"hidden",e)}function un(t,e){Xe(t,"expanded",e)}function cn(t){Ye(t,"expanded")}function pn(t,e){Xe(t,"setsize",e)}function hn(t,e){Xe(t,"posinset",e)}function dn(t,e){Xe(t,"multiselectable",e)}function fn(t,e){Xe(t,"rowcount",e)}function gn(t,e){Xe(t,"rowindex",e)}function mn(t,e){Xe(t,"colcount",e)}function yn(t,e){Xe(t,"colindex",e)}function vn(t,e){Xe(t,"colspan",e)}function _n(t,e){Xe(t,"sort",e)}function Cn(t){Ye(t,"sort")}function wn(t,e){qe(t,"selected",e)}function bn(t,e){Xe(t,"checked",void 0===e?"mixed":e)}function xn(t,e){qe(t,"controls",e.id),en(e,t.id)}function En(t,e){return void 0===e?t("ariaIndeterminate","indeterminate"):!0===e?t("ariaChecked","checked"):t("ariaUnchecked","unchecked")}var Sn,Tn,Rn,On,Pn,In,An,Dn,Mn=Object.freeze({__proto__:null,setAriaRole:Ze,getAriaSortState:Je,getAriaLevel:Qe,getAriaPosInSet:$e,getAriaDescribedBy:function(t){return t.getAttribute("aria-describedby")||""},setAriaLabel:tn,setAriaLabelledBy:en,setAriaDescription:nn,setAriaDescribedBy:on,setAriaLive:rn,setAriaLevel:sn,setAriaDisabled:an,setAriaHidden:ln,setAriaExpanded:un,removeAriaExpanded:cn,setAriaSetSize:pn,setAriaPosInSet:hn,setAriaMultiSelectable:dn,setAriaRowCount:fn,setAriaRowIndex:gn,setAriaColCount:mn,setAriaColIndex:yn,setAriaColSpan:vn,setAriaSort:_n,removeAriaSort:Cn,setAriaSelected:wn,setAriaChecked:bn,setAriaControls:xn,getAriaCheckboxStateName:En});function Ln(){return void 0===Sn&&(Sn=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Sn}function Nn(){if(void 0===Tn)if(Ln()){var t=navigator.userAgent.match(/version\/(\d+)/i);t&&(Tn=null!=t[1]?parseFloat(t[1]):0)}else Tn=0;return Tn}function Fn(){if(void 0===Rn){var t=window;Rn=!!t.chrome&&(!!t.chrome.webstore||!!t.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return Rn}function kn(){return void 0===On&&(On=/(firefox)/i.test(navigator.userAgent)),On}function Gn(){return void 0===Pn&&(Pn=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Pn}function Bn(){return void 0===In&&(In=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),In}function Vn(){return!Ln()||Nn()>=15}function zn(t){if(!t)return null;var e=t.tabIndex,n=t.getAttribute("tabIndex");return-1!==e||null!==n&&(""!==n||kn())?e.toString():null}function jn(){if(!document.body)return-1;var t=1e6,e=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){var o=2*t;if(n.style.height=o+"px",o>e||n.clientHeight!==o)break;t=o}return document.body.removeChild(n),t}function Hn(){var t,e,n;return null!==(e=null===(t=document.body)||void 0===t?void 0:t.clientWidth)&&void 0!==e?e:window.innerHeight||(null===(n=document.documentElement)||void 0===n?void 0:n.clientWidth)||-1}function Un(){var t,e,n;return null!==(e=null===(t=document.body)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:window.innerHeight||(null===(n=document.documentElement)||void 0===n?void 0:n.clientHeight)||-1}function Wn(){return null==Dn&&qn(),Dn}function qn(){var t=document.body,e=document.createElement("div");e.style.width=e.style.height="100px",e.style.opacity="0",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",e.style.position="absolute",t.appendChild(e);var n=e.offsetWidth-e.clientWidth;0===n&&0===e.clientWidth&&(n=null),e.parentNode&&e.parentNode.removeChild(e),null!=n&&(Dn=n,An=0===n)}function Xn(){return null==An&&qn(),An}var Yn=Object.freeze({__proto__:null,isBrowserSafari:Ln,getSafariVersion:Nn,isBrowserChrome:Fn,isBrowserFirefox:kn,isMacOsUserAgent:Gn,isIOSUserAgent:Bn,browserSupportsPreventScroll:Vn,getTabIndex:zn,getMaxDivHeight:jn,getBodyWidth:Hn,getBodyHeight:Un,getScrollbarWidth:Wn,isInvisibleScrollbar:Xn});function Kn(t,e){return t.toString().padStart(e,"0")}function Zn(t,e){for(var n=[],o=t;o<=e;o++)n.push(o);return n}function Jn(t,e,n){return"number"!==typeof t?"":t.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+e)}var Qn=Object.freeze({__proto__:null,padStartWidthZeros:Kn,createArrayOfNumbers:Zn,cleanNumber:function(t){return"string"===typeof t&&(t=parseInt(t,10)),"number"===typeof t?Math.floor(t):null},decToHex:function(t,e){for(var n="",o=0;o<e;o++)n+=String.fromCharCode(255&t),t>>>=8;return n},formatNumberTwoDecimalPlacesAndCommas:function(t,e,n){return"number"!==typeof t?"":Jn(Math.round(100*t)/100,e,n)},formatNumberCommas:Jn,sum:function(t){return null==t?null:t.reduce((function(t,e){return t+e}),0)},zeroOrGreater:function(t,e){return t>=0?t:e},oneOrGreater:function(t,e){var n=parseInt(t,10);return!isNaN(n)&&isFinite(n)&&n>0?n:e}}),$n=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s};function to(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n="-"),!t)return null;var o=[t.getFullYear(),t.getMonth()+1,t.getDate()].map((function(t){return Kn(t,2)})).join(n);return e&&(o+=" "+[t.getHours(),t.getMinutes(),t.getSeconds()].map((function(t){return Kn(t,2)})).join(":")),o}var eo=function(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function no(t,e){void 0===e&&(e="YYYY-MM-DD");var n=Kn(t.getFullYear(),4),o=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i={YYYY:function(){return n.slice(n.length-4,n.length)},YY:function(){return n.slice(n.length-2,n.length)},Y:function(){return""+t.getFullYear()},MMMM:function(){return o[t.getMonth()]},MMM:function(){return o[t.getMonth()].slice(0,3)},MM:function(){return Kn(t.getMonth()+1,2)},Mo:function(){return""+(t.getMonth()+1)+eo(t.getMonth()+1)},M:function(){return""+(t.getMonth()+1)},Do:function(){return""+t.getDate()+eo(t.getDate())},DD:function(){return Kn(t.getDate(),2)},D:function(){return""+t.getDate()},dddd:function(){return r[t.getDay()]},ddd:function(){return r[t.getDay()].slice(0,3)},dd:function(){return r[t.getDay()].slice(0,2)},do:function(){return""+t.getDay()+eo(t.getDay())},d:function(){return""+t.getDay()}},s=new RegExp(Object.keys(i).join("|"),"g");return e.replace(s,(function(t){return t in i?i[t]():t}))}function oo(t){if(!t)return null;var e=$n(t.split(" "),2),n=e[0],o=e[1];if(!n)return null;var r=n.split("-").map((function(t){return parseInt(t,10)}));if(3!==r.filter((function(t){return!isNaN(t)})).length)return null;var i=$n(r,3),s=i[0],a=i[1],l=i[2],u=new Date(s,a-1,l);if(u.getFullYear()!==s||u.getMonth()!==a-1||u.getDate()!==l)return null;if(!o||"00:00:00"===o)return u;var c=$n(o.split(":").map((function(t){return parseInt(t,10)})),3),p=c[0],h=c[1],d=c[2];return p>=0&&p<24&&u.setHours(p),h>=0&&h<60&&u.setMinutes(h),d>=0&&d<60&&u.setSeconds(d),u}var ro,io=Object.freeze({__proto__:null,serialiseDate:to,dateToFormattedString:no,parseDateTimeFromString:oo}),so=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ao=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s};var lo="[tabindex], input, select, button, textarea, [href]",uo=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function co(t){var e=Element.prototype.matches||Element.prototype.msMatchesSelector,n=e.call(t,"input, select, button, textarea"),o=e.call(t,uo),r=Ro(t);return n&&!o&&r}function po(t,e,n){void 0===n&&(n={});var o=n.skipAriaHidden;t.classList.toggle("ag-hidden",!e),o||ln(t,!e)}function ho(t,e,n){void 0===n&&(n={});var o=n.skipAriaHidden;t.classList.toggle("ag-invisible",!e),o||ln(t,!e)}function fo(t,e){var n="disabled",o=e?function(t){return t.setAttribute(n,"")}:function(t){return t.removeAttribute(n)};o(t),Wo(t.querySelectorAll("input"),(function(t){return o(t)}))}function go(t,e,n){for(var o=0;t;){if(t.classList.contains(e))return!0;if(t=t.parentElement,"number"==typeof n){if(++o>n)break}else if(t===n)break}return!1}function mo(t){var e=window.getComputedStyle(t),n=e.height,o=e.width,r=e.borderTopWidth,i=e.borderRightWidth,s=e.borderBottomWidth,a=e.borderLeftWidth,l=e.paddingTop,u=e.paddingRight,c=e.paddingBottom,p=e.paddingLeft,h=e.marginTop,d=e.marginRight,f=e.marginBottom,g=e.marginLeft,m=e.boxSizing;return{height:parseFloat(n),width:parseFloat(o),borderTopWidth:parseFloat(r),borderRightWidth:parseFloat(i),borderBottomWidth:parseFloat(s),borderLeftWidth:parseFloat(a),paddingTop:parseFloat(l),paddingRight:parseFloat(u),paddingBottom:parseFloat(c),paddingLeft:parseFloat(p),marginTop:parseFloat(h),marginRight:parseFloat(d),marginBottom:parseFloat(f),marginLeft:parseFloat(g),boxSizing:m}}function yo(t){var e=mo(t);return"border-box"===e.boxSizing?e.height-e.paddingTop-e.paddingBottom:e.height}function vo(t){var e=mo(t);return"border-box"===e.boxSizing?e.width-e.paddingLeft-e.paddingRight:e.width}function _o(t){var e=mo(t),n=e.marginBottom+e.marginTop;return Math.ceil(t.offsetHeight+n)}function Co(t){var e=mo(t),n=e.marginLeft+e.marginRight;return Math.ceil(t.offsetWidth+n)}function wo(t){var e=t.getBoundingClientRect(),n=mo(t),o=n.borderTopWidth,r=n.borderLeftWidth,i=n.borderRightWidth,s=n.borderBottomWidth;return{top:e.top+(o||0),left:e.left+(r||0),right:e.right+(i||0),bottom:e.bottom+(s||0)}}function bo(){if("boolean"===typeof ro)return ro;var t=document.createElement("div");return t.style.direction="rtl",t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="0px",t.style.overflow="hidden",t.dir="rtl",t.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(t),t.scrollLeft=1,ro=0===Math.floor(t.scrollLeft),document.body.removeChild(t),ro}function xo(t,e){var n=t.scrollLeft;return e&&(n=Math.abs(n),Fn()&&!bo()&&(n=t.scrollWidth-t.clientWidth-n)),n}function Eo(t,e,n){n&&(bo()?e*=-1:(Ln()||Fn())&&(e=t.scrollWidth-t.clientWidth-e)),t.scrollLeft=e}function So(t){for(;t&&t.firstChild;)t.removeChild(t.firstChild)}function To(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ro(t){return null!==t.offsetParent}function Oo(t){var e=document.createElement("div");return e.innerHTML=(t||"").trim(),e.firstChild}function Po(t){return t&&t.clientHeight?t.clientHeight:0}function Io(t){return t&&t.clientWidth?t.clientWidth:0}function Ao(t,e,n){if(!n||n.nextSibling!==e){var o=document.activeElement,r=e.contains(o);n?n.nextSibling?t.insertBefore(e,n.nextSibling):t.appendChild(e):t.firstChild&&t.firstChild!==e&&t.insertAdjacentElement("afterbegin",e),r&&o&&Vn()&&o.focus({preventScroll:!0})}}function Do(t,e){for(var n=0;n<e.length;n++){var o=e[n],r=t.children[n];r!==o&&t.insertBefore(o,r)}}function Mo(t,e,n){n?n.insertAdjacentElement("afterend",e):t.firstChild?t.insertAdjacentElement("afterbegin",e):t.appendChild(e)}function Lo(t,e){var n,o;if(e)try{for(var r=so(Object.entries(e)),i=r.next();!i.done;i=r.next()){var s=ao(i.value,2),a=s[0],l=s[1];if(a&&a.length&&null!=l){var u=se(a),c=l.toString(),p=c.replace(/\s*!important/g,""),h=p.length!=c.length?"important":void 0;t.style.setProperty(u,p,h)}}}catch(d){n={error:d}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}}function No(t){return t.clientWidth<t.scrollWidth}function Fo(t){return t.clientHeight<t.scrollHeight}function ko(t,e){"flex"===e?(t.style.removeProperty("width"),t.style.removeProperty("minWidth"),t.style.removeProperty("maxWidth"),t.style.flex="1 1 auto"):Go(t,e)}function Go(t,e){e=Vo(e),t.style.width=e.toString(),t.style.maxWidth=e.toString(),t.style.minWidth=e.toString()}function Bo(t,e){e=Vo(e),t.style.height=e.toString(),t.style.maxHeight=e.toString(),t.style.minHeight=e.toString()}function Vo(t){return"number"===typeof t?t+"px":t}function zo(t){return t instanceof Node||t instanceof HTMLElement}function jo(t){if(null==t)return[];var e=[];return Wo(t,(function(t){return e.push(t)})),e}function Ho(t,e){if(t)for(var n=0;n<t.length;n++){var o=t[n];e(o.name,o.value)}}function Uo(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n.toString())}function Wo(t,e){if(null!=t)for(var n=0;n<t.length;n++)e(t[n])}function qo(t,e){t.then((function(t){var n=t.getGui();null!=n&&("object"===typeof n?e.appendChild(n):e.innerHTML=n)}))}var Xo=Object.freeze({__proto__:null,radioCssClass:function(t,e,n){for(var o=t.parentElement,r=o&&o.firstChild;r;)e&&r.classList.toggle(e,r===t),n&&r.classList.toggle(n,r!==t),r=r.nextSibling},FOCUSABLE_SELECTOR:lo,FOCUSABLE_EXCLUDE:uo,isFocusableFormField:co,setDisplayed:po,setVisible:ho,setDisabled:fo,isElementChildOfClass:go,getElementSize:mo,getInnerHeight:yo,getInnerWidth:vo,getAbsoluteHeight:_o,getAbsoluteWidth:Co,getElementRectWithOffset:wo,isRtlNegativeScroll:bo,getScrollLeft:xo,setScrollLeft:Eo,clearElement:So,removeElement:function(t,e){To(t.querySelector(e))},removeFromParent:To,isVisible:Ro,loadTemplate:Oo,appendHtml:function(t,e){t.lastChild?t.insertAdjacentHTML("afterbegin",e):t.innerHTML=e},getElementAttribute:function(t,e){return t.attributes&&t.attributes[e]?t.attributes[e].value:null},offsetHeight:Po,offsetWidth:Io,ensureDomOrder:Ao,setDomChildOrder:Do,insertWithDomOrder:Mo,prependDC:function(t,e){r(t.firstChild)?t.insertBefore(e,t.firstChild):t.appendChild(e)},addStylesToElement:Lo,isHorizontalScrollShowing:No,isVerticalScrollShowing:Fo,setElementWidth:ko,setFixedWidth:Go,setElementHeight:function(t,e){"flex"===e?(t.style.removeProperty("height"),t.style.removeProperty("minHeight"),t.style.removeProperty("maxHeight"),t.style.flex="1 1 auto"):Bo(t,e)},setFixedHeight:Bo,formatSize:Vo,isNodeOrElement:zo,copyNodeList:jo,iterateNamedNodeMap:Ho,addOrRemoveAttribute:Uo,nodeListForEach:Wo,bindCellRendererToHtmlElement:qo}),Yo={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function Ko(t,e,n){var o=Zo(t,e,n);if(o){var r=o.className;if("string"===typeof r&&r.indexOf("ag-icon")>-1||"object"===typeof r&&r["ag-icon"])return o}var i=document.createElement("span");return i.appendChild(o),i}function Zo(t,e,n,o){var r=null,i=n&&n.getColDef().icons;if(i&&(r=i[t]),e&&!r){var s=e.get("icons");s&&(r=s[t])}if(!r){var a=document.createElement("span"),l=Yo[t];return l||(o?l=t:(console.warn("AG Grid: Did not find icon "+t),l="")),a.setAttribute("class","ag-icon ag-icon-"+l),a.setAttribute("unselectable","on"),Ze(a,"presentation"),a}var u=void 0;if("function"===typeof r)u=r();else{if("string"!==typeof r)throw new Error("icon from grid options needs to be a string or a function");u=r}return"string"===typeof u?Oo(u):zo(u)?u:void console.warn("AG Grid: iconRenderer should return back a string or a dom object")}var Jo=Object.freeze({__proto__:null,iconNameClassMap:Yo,createIcon:Ko,createIconNoSpan:Zo}),Qo=function(){function t(){}return t.BACKSPACE="Backspace",t.TAB="Tab",t.ENTER="Enter",t.ESCAPE="Escape",t.SPACE=" ",t.LEFT="ArrowLeft",t.UP="ArrowUp",t.RIGHT="ArrowRight",t.DOWN="ArrowDown",t.DELETE="Delete",t.F2="F2",t.PAGE_UP="PageUp",t.PAGE_DOWN="PageDown",t.PAGE_HOME="Home",t.PAGE_END="End",t.A="KeyA",t.C="KeyC",t.D="KeyD",t.V="KeyV",t.X="KeyX",t.Y="KeyY",t.Z="KeyZ",t}();function $o(t){return!(t.altKey||t.ctrlKey||t.metaKey)&&1===t.key.length}function tr(t,e,n,o,r){var i=o?o.getColDef().suppressKeyboardEvent:void 0;if(!i)return!1;var s={event:e,editing:r,column:o,api:t.api,node:n,data:n.data,colDef:o.getColDef(),context:t.context,columnApi:t.columnApi};if(i&&i(s))return!0;return!1}function er(t,e,n,o){var i=o.getDefinition(),s=i&&i.suppressHeaderKeyboardEvent;return!!r(s)&&!!s({api:t.api,columnApi:t.columnApi,context:t.context,colDef:i,column:o,headerRowIndex:n,event:e})}function nr(t){var e;switch(t.keyCode){case 65:e=Qo.A;break;case 67:e=Qo.C;break;case 86:e=Qo.V;break;case 68:e=Qo.D;break;case 90:e=Qo.Z;break;case 89:e=Qo.Y;break;default:e=t.code}return e}function or(t,e){return void 0===e&&(e=!1),t===Qo.DELETE||!e&&t===Qo.BACKSPACE&&Gn()}var rr=Object.freeze({__proto__:null,isEventFromPrintableCharacter:$o,isUserSuppressingKeyboardEvent:tr,isUserSuppressingHeaderKeyboardEvent:er,normaliseQwertyAzerty:nr,isDeleteKey:or});function ir(t,e,n){if(0===n)return!1;var o=Math.abs(t.clientX-e.clientX),r=Math.abs(t.clientY-e.clientY);return Math.max(o,r)<=n}var sr=Object.freeze({__proto__:null,areEventsNear:ir});var ar=Object.freeze({__proto__:null,sortRowNodesByOrder:function(t,e){if(!t)return!1;for(var n=function(t,n){var o=e[t.id],r=e[n.id],i=void 0!==o,s=void 0!==r;return i&&s?o-r:!i&&!s?t.__objectId-n.__objectId:i?1:-1},o=!1,r=0;r<t.length-1;r++)if(n(t[r],t[r+1])>0){o=!0;break}return!!o&&(t.sort(n),!0)},traverseNodesWithKey:function(t,e){var n=[];!function t(o){if(!o)return;o.forEach((function(o){if(o.group||o.hasChildren()){n.push(o.key);var r=n.join("|");e(o,r),t(o.childrenAfterGroup),n.pop()}}))}(t)}});function lr(t){var e=new Set;return t.forEach((function(t){return e.add(t)})),e}var ur,cr=Object.freeze({__proto__:null,convertToSet:lr}),pr=function(){return pr=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},pr.apply(this,arguments)},hr=pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr(pr({},Mn),Pt),Yn),io),Xo),zt),j),we),p),Jo),rr),ue),sr),Qn),R),ar),cr),ae),dr=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.nextValue=t,this.step=e}return t.prototype.next=function(){var t=this.nextValue;return this.nextValue+=this.step,t},t.prototype.peek=function(){return this.nextValue},t.prototype.skip=function(t){this.nextValue+=t},t}();!function(t){t[t.IN_PROGRESS=0]="IN_PROGRESS",t[t.RESOLVED=1]="RESOLVED"}(ur||(ur={}));var fr,gr,mr=function(){function t(t){var e=this;this.status=ur.IN_PROGRESS,this.resolution=null,this.waiters=[],t((function(t){return e.onDone(t)}),(function(t){return e.onReject(t)}))}return t.all=function(e){return new t((function(t){var n=e.length,o=new Array(n);e.forEach((function(e,r){e.then((function(e){o[r]=e,0===--n&&t(o)}))}))}))},t.resolve=function(e){return void 0===e&&(e=null),new t((function(t){return t(e)}))},t.prototype.then=function(e){var n=this;return new t((function(t){n.status===ur.RESOLVED?t(e(n.resolution)):n.waiters.push((function(n){return t(e(n))}))}))},t.prototype.resolveNow=function(t,e){return this.status===ur.RESOLVED?e(this.resolution):t},t.prototype.onDone=function(t){this.status=ur.RESOLVED,this.resolution=t,this.waiters.forEach((function(e){return e(t)}))},t.prototype.onReject=function(t){console.warn("TBI")},t}(),yr=function(){function t(){this.timestamp=(new Date).getTime()}return t.prototype.print=function(t){var e=(new Date).getTime()-this.timestamp;console.info(t+" = "+e),this.timestamp=(new Date).getTime()},t}(),vr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_r=function(){return _r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},_r.apply(this,arguments)},Cr=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.NOTHING=0]="NOTHING",t[t.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",t[t.SHOWING=2]="SHOWING"}(fr||(fr={})),function(t){t[t.HOVER=0]="HOVER",t[t.FOCUS=1]="FOCUS"}(gr||(gr={}));var wr=function(t){function e(e,n,o){var r=t.call(this)||this;return r.parentComp=e,r.tooltipShowDelayOverride=n,r.tooltipHideDelayOverride=o,r.DEFAULT_SHOW_TOOLTIP_DELAY=2e3,r.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,r.SHOW_QUICK_TOOLTIP_DIFF=1e3,r.FADE_OUT_TOOLTIP_TIMEOUT=1e3,r.INTERACTIVE_HIDE_DELAY=100,r.interactionEnabled=!1,r.isInteractingWithTooltip=!1,r.state=fr.NOTHING,r.tooltipInstanceCount=0,r.tooltipMouseTrack=!1,r}return vr(e,t),e.prototype.postConstruct=function(){this.gridOptionsService.is("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipShowDelay=this.getTooltipDelay("show"),this.tooltipHideDelay=this.getTooltipDelay("hide"),this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");var t=this.parentComp.getGui();this.tooltipTrigger===gr.HOVER&&(this.addManagedListener(t,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(t,"mouseleave",this.onMouseLeave.bind(this))),this.tooltipTrigger===gr.FOCUS&&(this.addManagedListener(t,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(t,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(t,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(t,"keydown",this.onKeyDown.bind(this)))},e.prototype.getGridOptionsTooltipDelay=function(t){var e=this.gridOptionsService.getNum(t);if(r(e))return e<0&&P((function(){return console.warn("AG Grid: "+t+" should not be lower than 0")}),t+"Warn"),Math.max(200,e)},e.prototype.getTooltipDelay=function(t){var e,n,o,r;return"show"===t?null!==(n=null!==(e=this.getGridOptionsTooltipDelay("tooltipShowDelay"))&&void 0!==e?e:this.tooltipShowDelayOverride)&&void 0!==n?n:this.DEFAULT_SHOW_TOOLTIP_DELAY:null!==(r=null!==(o=this.getGridOptionsTooltipDelay("tooltipHideDelay"))&&void 0!==o?o:this.tooltipHideDelayOverride)&&void 0!==r?r:this.DEFAULT_HIDE_TOOLTIP_DELAY},e.prototype.destroy=function(){this.setToDoNothing(),t.prototype.destroy.call(this)},e.prototype.getTooltipTrigger=function(){var t=this.gridOptionsService.get("tooltipTrigger");return t&&"hover"!==t?gr.FOCUS:gr.HOVER},e.prototype.onMouseEnter=function(t){var n=this;this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),Bn()||(e.isLocked?this.showTooltipTimeoutId=window.setTimeout((function(){n.prepareToShowTooltip(t)}),this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(t))},e.prototype.onMouseMove=function(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&this.state===fr.SHOWING&&this.tooltipComp&&this.positionTooltip()},e.prototype.onMouseDown=function(){this.setToDoNothing()},e.prototype.onMouseLeave=function(){this.interactionEnabled?this.lockService():this.setToDoNothing()},e.prototype.onFocusIn=function(){this.prepareToShowTooltip()},e.prototype.onFocusOut=function(t){var e,n=t.relatedTarget,o=this.parentComp.getGui(),r=null===(e=this.tooltipComp)||void 0===e?void 0:e.getGui();this.isInteractingWithTooltip||o.contains(n)||this.interactionEnabled&&(null===r||void 0===r?void 0:r.contains(n))||this.setToDoNothing()},e.prototype.onKeyDown=function(){this.setToDoNothing()},e.prototype.prepareToShowTooltip=function(t){if(this.state!=fr.NOTHING||e.isLocked)return!1;var n=0;return t&&(n=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),n),this.state=fr.WAITING_TO_SHOW,!0},e.prototype.isLastTooltipHiddenRecently=function(){return(new Date).getTime()-e.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF},e.prototype.setToDoNothing=function(){this.state===fr.SHOWING&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=fr.NOTHING,this.lastMouseEvent=null},e.prototype.showTooltip=function(){var t=_r({},this.parentComp.getTooltipParams());if(r(t.value)){this.state=fr.SHOWING,this.tooltipInstanceCount++;var e=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(e)}else this.setToDoNothing()},e.prototype.hideTooltip=function(t){if(t||!this.isInteractingWithTooltip){this.tooltipComp&&(this.destroyTooltipComp(),e.lastTooltipHideTime=(new Date).getTime());var n={type:Zt.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(n),this.state=fr.NOTHING}},e.prototype.newTooltipComponentCallback=function(t,e){if(this.state!==fr.SHOWING||this.tooltipInstanceCount!==t)this.getContext().destroyBean(e);else{var n=e.getGui();this.tooltipComp=e,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===gr.HOVER&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");var o=this.localeService.getLocaleTextFunc(),r=this.popupService.addPopup({eChild:n,ariaLabel:o("ariaLabelTooltip","Tooltip")});r&&(this.tooltipPopupDestroyFunc=r.hideFunc),this.positionTooltip(),this.tooltipTrigger===gr.FOCUS&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,Zt.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(this.tooltipTrigger===gr.HOVER?(this.tooltipMouseEnterListener=this.addManagedListener(n,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(n,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(n,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(n,"focusout",this.onTooltipFocusOut.bind(this))||null));var i={type:Zt.EVENT_TOOLTIP_SHOW,tooltipGui:n,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(i),this.startHideTimeout()}},e.prototype.onTooltipMouseEnter=function(){this.isInteractingWithTooltip=!0,this.unlockService()},e.prototype.onTooltipMouseLeave=function(){this.isInteractingWithTooltip=!1,this.lockService()},e.prototype.onTooltipFocusIn=function(){this.isInteractingWithTooltip=!0},e.prototype.onTooltipFocusOut=function(t){var e,n=this.parentComp.getGui(),o=null===(e=this.tooltipComp)||void 0===e?void 0:e.getGui(),r=t.relatedTarget;(null===o||void 0===o?void 0:o.contains(r))||(this.isInteractingWithTooltip=!1,n.contains(r)?this.startHideTimeout():this.hideTooltip())},e.prototype.positionTooltip=function(){var t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(_r(_r({},t),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(_r(_r({},t),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))},e.prototype.destroyTooltipComp=function(){var t=this;this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");var e=this.tooltipPopupDestroyFunc,n=this.tooltipComp,o=this.tooltipTrigger===gr.HOVER?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout((function(){e(),t.getContext().destroyBean(n)}),o),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0},e.prototype.clearTooltipListeners=function(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach((function(t){t&&t()})),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null},e.prototype.lockService=function(){var t=this;e.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout((function(){t.unlockService(),t.setToDoNothing()}),this.INTERACTIVE_HIDE_DELAY)},e.prototype.unlockService=function(){e.isLocked=!1,this.clearInteractiveTimeout()},e.prototype.startHideTimeout=function(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)},e.prototype.clearShowTimeout=function(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)},e.prototype.clearHideTimeout=function(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)},e.prototype.clearInteractiveTimeout=function(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)},e.prototype.clearTimeouts=function(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()},e.isLocked=!1,Cr([$("popupService")],e.prototype,"popupService",void 0),Cr([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Cr([Z],e.prototype,"postConstruct",null),e}(Ht),br=function(){function t(t){this.cssClassStates={},this.getGui=t}return t.prototype.addCssClass=function(t){var e=this,n=(t||"").split(" ");if(n.length>1)n.forEach((function(t){return e.addCssClass(t)}));else if(!0!==this.cssClassStates[t]&&t.length){var o=this.getGui();o&&o.classList.add(t),this.cssClassStates[t]=!0}},t.prototype.removeCssClass=function(t){var e=this,n=(t||"").split(" ");if(n.length>1)n.forEach((function(t){return e.removeCssClass(t)}));else if(!1!==this.cssClassStates[t]&&t.length){var o=this.getGui();o&&o.classList.remove(t),this.cssClassStates[t]=!1}},t.prototype.containsCssClass=function(t){var e=this.getGui();return!!e&&e.classList.contains(t)},t.prototype.addOrRemoveCssClass=function(t,e){var n=this;if(t){if(t.indexOf(" ")>=0){var o=(t||"").split(" ");if(o.length>1)return void o.forEach((function(t){return n.addOrRemoveCssClass(t,e)}))}if(this.cssClassStates[t]!==e&&t.length){var r=this.getGui();r&&r.classList.toggle(t,e),this.cssClassStates[t]=e}}},t}(),xr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Er=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Sr=new dr,Tr=function(t){function e(e){var n=t.call(this)||this;return n.displayed=!0,n.visible=!0,n.compId=Sr.next(),n.cssClassManager=new br((function(){return n.eGui})),e&&n.setTemplate(e),n}return xr(e,t),e.prototype.preConstructOnComponent=function(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")},e.prototype.getCompId=function(){return this.compId},e.prototype.getTooltipParams=function(){return{value:this.tooltipText,location:"UNKNOWN"}},e.prototype.setTooltip=function(t,e,n){var o=this;this.tooltipText!=t&&(this.tooltipText&&(o.usingBrowserTooltips?o.getGui().removeAttribute("title"):o.tooltipFeature=o.destroyBean(o.tooltipFeature)),null!=t&&(this.tooltipText=t,this.tooltipText&&(o.usingBrowserTooltips?o.getGui().setAttribute("title",o.tooltipText):o.tooltipFeature=o.createBean(new wr(o,e,n)))))},e.prototype.createChildComponentsFromTags=function(t,e){var n=this;jo(t.childNodes).forEach((function(o){if(o instanceof HTMLElement){var r=n.createComponentFromElement(o,(function(t){t.getGui()&&n.copyAttributesFromNode(o,t.getGui())}),e);if(r){if(r.addItems&&o.children.length){n.createChildComponentsFromTags(o,e);var i=Array.prototype.slice.call(o.children);r.addItems(i)}n.swapComponentForNode(r,t,o)}else o.childNodes&&n.createChildComponentsFromTags(o,e)}}))},e.prototype.createComponentFromElement=function(t,n,o){var r=t.nodeName,i=o?o[t.getAttribute("ref")]:void 0,s=this.agStackComponentsRegistry.getComponentClass(r);if(s){e.elementGettingCreated=t;var a=new s(i);return a.setParentComponent(this),this.createBean(a,null,n),a}return null},e.prototype.copyAttributesFromNode=function(t,e){Ho(t.attributes,(function(t,n){return e.setAttribute(t,n)}))},e.prototype.swapComponentForNode=function(t,e,n){var o=t.getGui();e.replaceChild(o,n),e.insertBefore(document.createComment(n.nodeName),o),this.addDestroyFunc(this.destroyBean.bind(this,t)),this.swapInComponentForQuerySelectors(t,n)},e.prototype.swapInComponentForQuerySelectors=function(t,e){var n=this;this.iterateOverQuerySelectors((function(o){n[o.attributeName]===e&&(n[o.attributeName]=t)}))},e.prototype.iterateOverQuerySelectors=function(t){for(var e=Object.getPrototypeOf(this);null!=e;){var n=e.__agComponentMetaData,o=I(e.constructor);n&&n[o]&&n[o].querySelectors&&n[o].querySelectors.forEach((function(e){return t(e)})),e=Object.getPrototypeOf(e)}},e.prototype.activateTabIndex=function(t){var e=this.gridOptionsService.getNum("tabIndex")||0;t||(t=[]),t.length||t.push(this.getGui()),t.forEach((function(t){return t.setAttribute("tabindex",e.toString())}))},e.prototype.setTemplate=function(t,e){var n=Oo(t);this.setTemplateFromElement(n,e)},e.prototype.setTemplateFromElement=function(t,e){this.eGui=t,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),e)},e.prototype.createChildComponentsPreConstruct=function(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())},e.prototype.wireQuerySelectors=function(){var t=this;if(this.eGui){var e=this;this.iterateOverQuerySelectors((function(n){var o=function(t){return e[n.attributeName]=t};if(n.refSelector&&t.getAttribute("ref")===n.refSelector)o(t.eGui);else{var r=t.eGui.querySelector(n.querySelector);r&&o(r.__agComponent||r)}}))}},e.prototype.getGui=function(){return this.eGui},e.prototype.getFocusableElement=function(){return this.eGui},e.prototype.setParentComponent=function(t){this.parentComponent=t},e.prototype.getParentComponent=function(){return this.parentComponent},e.prototype.setGui=function(t){this.eGui=t},e.prototype.queryForHtmlElement=function(t){return this.eGui.querySelector(t)},e.prototype.queryForHtmlInputElement=function(t){return this.eGui.querySelector(t)},e.prototype.appendChild=function(t,e){if(null!=t)if(e||(e=this.eGui),zo(t))e.appendChild(t);else{var n=t;e.appendChild(n.getGui())}},e.prototype.isDisplayed=function(){return this.displayed},e.prototype.setVisible=function(t,e){if(void 0===e&&(e={}),t!==this.visible){this.visible=t;var n=e.skipAriaHidden;ho(this.eGui,t,{skipAriaHidden:n})}},e.prototype.setDisplayed=function(t,n){if(void 0===n&&(n={}),t!==this.displayed){this.displayed=t;var o=n.skipAriaHidden;po(this.eGui,t,{skipAriaHidden:o});var r={type:e.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(r)}},e.prototype.destroy=function(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);var e=this.eGui;e&&e.__agComponent&&(e.__agComponent=void 0),t.prototype.destroy.call(this)},e.prototype.addGuiEventListener=function(t,e,n){var o=this;this.eGui.addEventListener(t,e,n),this.addDestroyFunc((function(){return o.eGui.removeEventListener(t,e)}))},e.prototype.addCssClass=function(t){this.cssClassManager.addCssClass(t)},e.prototype.removeCssClass=function(t){this.cssClassManager.removeCssClass(t)},e.prototype.containsCssClass=function(t){return this.cssClassManager.containsCssClass(t)},e.prototype.addOrRemoveCssClass=function(t,e){this.cssClassManager.addOrRemoveCssClass(t,e)},e.prototype.getAttribute=function(t){var e=this.eGui;return e?e.getAttribute(t):null},e.prototype.getRefElement=function(t){return this.queryForHtmlElement('[ref="'+t+'"]')},e.EVENT_DISPLAYED_CHANGED="displayedChanged",Er([$("agStackComponentsRegistry")],e.prototype,"agStackComponentsRegistry",void 0),Er([K],e.prototype,"preConstructOnComponent",null),Er([K],e.prototype,"createChildComponentsPreConstruct",null),e}(Ht);function Rr(t){return Pr.bind(this,t,void 0)}function Or(t){return Pr.bind(this,"[ref="+t+"]",t)}function Pr(t,e,n,o,r){null!==t?"number"!==typeof r?function(t,e,n){var o=function(t,e){t.__agComponentMetaData||(t.__agComponentMetaData={});t.__agComponentMetaData[e]||(t.__agComponentMetaData[e]={});return t.__agComponentMetaData[e]}(t,I(t.constructor));o[e]||(o[e]=[]);o[e].push(n)}(n,"querySelectors",{attributeName:o,querySelector:t,refSelector:e}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}var Ir=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ar=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Dr=function(t){function e(){return t.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this}return Ir(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){this.params=t;var e=this.columnModel.getDisplayNameForColumn(t.column,"header",!0),n=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(e+" "+n("ariaFilterInput","Filter Input"))},e.prototype.onParentModelChanged=function(t){var e=this;t?this.params.parentFilterInstance((function(n){if(n.getModelAsString){var o=n.getModelAsString(t);e.eFloatingFilterText.setValue(o)}})):this.eFloatingFilterText.setValue("")},e.prototype.onParamsUpdated=function(t){this.init(t)},Ar([Or("eFloatingFilterText")],e.prototype,"eFloatingFilterText",void 0),Ar([$("columnModel")],e.prototype,"columnModel",void 0),e}(Tr),Mr=function(){function t(t,e,n,o){var r=this;this.alive=!0,this.context=t,this.eParent=o,e.getDateCompDetails(n).newAgStackInstance().then((function(e){r.alive?(r.dateComp=e,e&&(o.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached(),r.tempValue&&e.setDate(r.tempValue),null!=r.disabled&&r.setDateCompDisabled(r.disabled))):t.destroyBean(e)}))}return t.prototype.destroy=function(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)},t.prototype.getDate=function(){return this.dateComp?this.dateComp.getDate():this.tempValue},t.prototype.setDate=function(t){this.dateComp?this.dateComp.setDate(t):this.tempValue=t},t.prototype.setDisabled=function(t){this.dateComp?this.setDateCompDisabled(t):this.disabled=t},t.prototype.setDisplayed=function(t){po(this.eParent,t)},t.prototype.setInputPlaceholder=function(t){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(t)},t.prototype.setInputAriaLabel=function(t){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(t)},t.prototype.afterGuiAttached=function(t){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(t)},t.prototype.updateParams=function(t){var e;(null===(e=this.dateComp)||void 0===e?void 0:e.onParamsUpdated)&&"function"===typeof this.dateComp.onParamsUpdated&&this.dateComp.onParamsUpdated(t)},t.prototype.setDateCompDisabled=function(t){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(t)},t}(),Lr=function(){function t(){this.customFilterOptions={}}return t.prototype.init=function(t,e){this.filterOptions=t.filterOptions||e,this.mapCustomOptions(),this.selectDefaultItem(t)},t.prototype.getFilterOptions=function(){return this.filterOptions},t.prototype.mapCustomOptions=function(){var t=this;this.filterOptions&&this.filterOptions.forEach((function(e){if("string"!==typeof e){[["displayKey"],["displayName"],["predicate","test"]].every((function(t){return!!t.some((function(t){return null!=e[t]}))||(console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '"+t+"'"),!1)}))?t.customFilterOptions[e.displayKey]=e:t.filterOptions=t.filterOptions.filter((function(t){return t===e}))||[]}}))},t.prototype.selectDefaultItem=function(t){if(t.defaultOption)this.defaultOption=t.defaultOption;else if(this.filterOptions.length>=1){var e=this.filterOptions[0];"string"===typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")},t.prototype.getDefaultOption=function(){return this.defaultOption},t.prototype.getCustomOption=function(t){return this.customFilterOptions[t]},t}(),Nr={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},Fr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),kr=function(){return kr=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},kr.apply(this,arguments)},Gr=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Br=function(t){function e(e,n){void 0===n&&(n={});var o=t.call(this)||this;return o.eFocusableElement=e,o.callbacks=n,o.callbacks=kr({shouldStopEventPropagation:function(){return!1},onTabKeyDown:function(t){if(!t.defaultPrevented){var e=o.focusService.findNextFocusableElement(o.eFocusableElement,!1,t.shiftKey);e&&(e.focus(),t.preventDefault())}}},n),o}return Fr(e,t),e.prototype.postConstruct=function(){this.eFocusableElement.classList.add(e.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)},e.prototype.addKeyDownListeners=function(t){var e=this;this.addManagedListener(t,"keydown",(function(t){t.defaultPrevented||Lt(t)||(e.callbacks.shouldStopEventPropagation(t)?Mt(t):t.key===Qo.TAB?e.callbacks.onTabKeyDown(t):e.callbacks.handleKeyDown&&e.callbacks.handleKeyDown(t))}))},e.FOCUS_MANAGED_CLASS="ag-focus-managed",Gr([$("focusService")],e.prototype,"focusService",void 0),Gr([Z],e.prototype,"postConstruct",null),e}(Ht),Vr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zr=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jr="ag-resizer-wrapper",Hr='<div class="'+jr+'">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',Ur=function(t){function e(e,n){var o=t.call(this)||this;return o.element=e,o.dragStartPosition={x:0,y:0},o.position={x:0,y:0},o.lastSize={width:-1,height:-1},o.positioned=!1,o.resizersAdded=!1,o.resizeListeners=[],o.boundaryEl=null,o.isResizing=!1,o.isMoving=!1,o.resizable={},o.movable=!1,o.currentResizer=null,o.config=Object.assign({},{popup:!1},n),o}return Vr(e,t),e.prototype.center=function(){var t=this.offsetParent,e=t.clientHeight,n=t.clientWidth/2-this.getWidth()/2,o=e/2-this.getHeight()/2;this.offsetElement(n,o)},e.prototype.initialisePosition=function(){if(!this.positioned){var t=this.config,e=t.centered,n=t.forcePopupParentAsOffsetParent,o=t.minWidth,r=t.width,i=t.minHeight,s=t.height,a=t.x,l=t.y;this.offsetParent||this.setOffsetParent();var u=0,c=0,p=!!this.element.offsetParent;if(p){var h=this.findBoundaryElement(),d=window.getComputedStyle(h);if(null!=d.minWidth){var f=h.offsetWidth-this.element.offsetWidth;c=parseInt(d.minWidth,10)-f}if(null!=d.minHeight){var g=h.offsetHeight-this.element.offsetHeight;u=parseInt(d.minHeight,10)-g}}if(this.minHeight=i||u,this.minWidth=o||c,r&&this.setWidth(r),s&&this.setHeight(s),r&&s||this.refreshSize(),e)this.center();else if(a||l)this.offsetElement(a,l);else if(p&&n){var m=!0;if((h=this.boundaryEl)||(h=this.findBoundaryElement(),m=!1),h){var y=parseFloat(h.style.top),v=parseFloat(h.style.left);m?this.offsetElement(isNaN(v)?0:v,isNaN(y)?0:y):this.setPosition(v,y)}}this.positioned=!!this.offsetParent}},e.prototype.isPositioned=function(){return this.positioned},e.prototype.getPosition=function(){return this.position},e.prototype.setMovable=function(t,e){if(this.config.popup&&t!==this.movable){this.movable=t;var n=this.moveElementDragListener||{eElement:e,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};t?(this.dragService.addDragSource(n),this.moveElementDragListener=n):(this.dragService.removeDragSource(n),this.moveElementDragListener=void 0)}},e.prototype.setResizable=function(t){var e=this;if(this.clearResizeListeners(),t?this.addResizers():this.removeResizers(),"boolean"===typeof t){if(!1===t)return;t={topLeft:t,top:t,topRight:t,right:t,bottomRight:t,bottom:t,bottomLeft:t,left:t}}Object.keys(t).forEach((function(n){var o=!!t[n],r=e.getResizerElement(n),i={dragStartPixels:0,eElement:r,onDragStart:function(t){return e.onResizeStart(t,n)},onDragging:e.onResize.bind(e),onDragStop:function(t){return e.onResizeEnd(t,n)}};(o||!e.isAlive()&&!o)&&(o?(e.dragService.addDragSource(i),e.resizeListeners.push(i),r.style.pointerEvents="all"):r.style.pointerEvents="none",e.resizable[n]=o)}))},e.prototype.removeSizeFromEl=function(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")},e.prototype.restoreLastSize=function(){this.element.style.flex="0 0 auto";var t=this.lastSize,e=t.height,n=t.width;-1!==n&&(this.element.style.width=n+"px"),-1!==e&&(this.element.style.height=e+"px")},e.prototype.getHeight=function(){return this.element.offsetHeight},e.prototype.setHeight=function(t){var e=this.config.popup,n=this.element,o=!1;if("string"===typeof t&&-1!==t.indexOf("%"))Bo(n,t),t=_o(n),o=!0;else if(t=Math.max(this.minHeight,t),this.positioned){var r=this.getAvailableHeight();r&&t>r&&(t=r)}this.getHeight()!==t&&(o?(n.style.maxHeight="unset",n.style.minHeight="unset"):e?Bo(n,t):(n.style.height=t+"px",n.style.flex="0 0 auto",this.lastSize.height="number"===typeof t?t:parseFloat(t)))},e.prototype.getAvailableHeight=function(){var t=this.config,e=t.popup,n=t.forcePopupParentAsOffsetParent;this.positioned||this.initialisePosition();var o=this.offsetParent.clientHeight;if(!o)return null;var r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:r.top,a=e?0:i.top,l=0;if(n){var u=this.element.parentElement;if(u)l=u.getBoundingClientRect().bottom-r.bottom}return o+a-s-l},e.prototype.getWidth=function(){return this.element.offsetWidth},e.prototype.setWidth=function(t){var e=this.element,n=this.config.popup,o=!1;if("string"===typeof t&&-1!==t.indexOf("%"))Go(e,t),t=Co(e),o=!0;else if(this.positioned){t=Math.max(this.minWidth,t);var r=this.offsetParent.clientWidth,i=n?this.position.x:this.element.getBoundingClientRect().left;r&&t+i>r&&(t=r-i)}this.getWidth()!==t&&(o?(e.style.maxWidth="unset",e.style.minWidth="unset"):this.config.popup?Go(e,t):(e.style.width=t+"px",e.style.flex=" unset",this.lastSize.width="number"===typeof t?t:parseFloat(t)))},e.prototype.offsetElement=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n=this.config.forcePopupParentAsOffsetParent?this.boundaryEl:this.element;n&&(this.popupService.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:function(){return{x:t,y:e}}}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))},e.prototype.constrainSizeToAvailableHeight=function(t){var e=this;if(this.config.forcePopupParentAsOffsetParent){t?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),(function(){var t=e.getAvailableHeight();e.element.style.setProperty("max-height",t+"px")})):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}},e.prototype.setPosition=function(t,e){this.position.x=t,this.position.y=e},e.prototype.updateDragStartPosition=function(t,e){this.dragStartPosition={x:t,y:e}},e.prototype.calculateMouseMovement=function(t){var e=t.e,n=t.isLeft,o=t.isTop,r=t.anywhereWithin,i=t.topBuffer,s=e.clientX-this.dragStartPosition.x,a=e.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(e,!!n,!!r,s)?0:s,movementY:this.shouldSkipY(e,!!o,i,a)?0:a}},e.prototype.shouldSkipX=function(t,e,n,o){var r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left,l=a<=0&&i.left>=t.clientX||i.right<=t.clientX&&i.right<=s.right;return!!l||(l=e?o<0&&t.clientX>a+i.left||o>0&&t.clientX<a+i.left:n?o<0&&t.clientX>s.right||o>0&&t.clientX<a+i.left:o<0&&t.clientX>s.right||o>0&&t.clientX<s.right)},e.prototype.shouldSkipY=function(t,e,n,o){void 0===n&&(n=0);var r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top,l=a<=0&&i.top>=t.clientY||i.bottom<=t.clientY&&i.bottom<=s.bottom;return!!l||(l=e?o<0&&t.clientY>a+i.top+n||o>0&&t.clientY<a+i.top:o<0&&t.clientY>s.bottom||o>0&&t.clientY<s.bottom)},e.prototype.createResizeMap=function(){var t=this.element;this.resizerMap={topLeft:{element:t.querySelector("[ref=eTopLeftResizer]")},top:{element:t.querySelector("[ref=eTopResizer]")},topRight:{element:t.querySelector("[ref=eTopRightResizer]")},right:{element:t.querySelector("[ref=eRightResizer]")},bottomRight:{element:t.querySelector("[ref=eBottomRightResizer]")},bottom:{element:t.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:t.querySelector("[ref=eBottomLeftResizer]")},left:{element:t.querySelector("[ref=eLeftResizer]")}}},e.prototype.addResizers=function(){if(!this.resizersAdded){var t=this.element;if(t){var e=(new DOMParser).parseFromString(Hr,"text/html").body;t.appendChild(e.firstChild),this.createResizeMap(),this.resizersAdded=!0}}},e.prototype.removeResizers=function(){this.resizerMap=void 0;var t=this.element.querySelector("."+jr);t&&this.element.removeChild(t),this.resizersAdded=!1},e.prototype.getResizerElement=function(t){return this.resizerMap[t].element},e.prototype.onResizeStart=function(t,e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!e.match(/top/i),isRight:!!e.match(/right/i),isBottom:!!e.match(/bottom/i),isLeft:!!e.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[e].element.classList.add("ag-active");var n=this.config,o=n.popup,r=n.forcePopupParentAsOffsetParent;o||r||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(t.clientX,t.clientY)},e.prototype.getSiblings=function(){var t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter((function(t){return!t.classList.contains("ag-hidden")})):null},e.prototype.getMinSizeOfSiblings=function(){for(var t=this.getSiblings()||[],e=0,n=0,o=0;o<t.length;o++){var r=t[o],i=!!r.style.flex&&"0 0 auto"!==r.style.flex;if(r!==this.element){var s=this.minHeight||0,a=this.minWidth||0;if(i){var l=window.getComputedStyle(r);l.minHeight&&(s=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else s=r.offsetHeight,a=r.offsetWidth;e+=s,n+=a}}return{height:e,width:n}},e.prototype.applySizeToSiblings=function(t){var e=null,n=this.getSiblings();if(n){for(var o=0;o<n.length;o++){var r=n[o];r!==e&&(t?r.style.height=r.offsetHeight+"px":r.style.width=r.offsetWidth+"px",r.style.flex="0 0 auto",r===this.element&&(e=n[o+1]))}e&&(e.style.removeProperty("height"),e.style.removeProperty("min-height"),e.style.removeProperty("max-height"),e.style.flex="1 1 auto")}},e.prototype.isResizable=function(){return Object.values(this.resizable).some((function(t){return t}))},e.prototype.onResize=function(t){if(this.isResizing&&this.currentResizer){var e=this.config,n=e.popup,o=e.forcePopupParentAsOffsetParent,r=this.currentResizer,i=r.isTop,s=r.isRight,a=r.isBottom,l=r.isLeft,u=s||l,c=a||i,p=this.calculateMouseMovement({e:t,isLeft:l,isTop:i}),h=p.movementX,d=p.movementY,f=this.position.x,g=this.position.y,m=0,y=0;if(u&&h){var v=l?-1:1,_=this.getWidth(),C=_+h*v,w=!1;l&&(f+(m=_-C)<=0||C<=this.minWidth)&&(w=!0,m=0),w||this.setWidth(C)}if(c&&d){v=i?-1:1;var b=this.getHeight(),x=b+d*v,E=!1;i?(g+(y=b-x)<=0||x<=this.minHeight)&&(E=!0,y=0):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&b<x&&this.getMinSizeOfSiblings().height+x>this.element.parentElement.offsetHeight&&(E=!0),E||this.setHeight(x)}this.updateDragStartPosition(t.clientX,t.clientY),((n||o)&&m||y)&&this.offsetElement(f+m,g+y)}},e.prototype.onResizeEnd=function(t,e){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;var n={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[e].element.classList.remove("ag-active"),this.dispatchEvent(n)},e.prototype.refreshSize=function(){var t=this.element;this.config.popup&&(this.config.width||this.setWidth(t.offsetWidth),this.config.height||this.setHeight(t.offsetHeight))},e.prototype.onMoveStart=function(t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(t.clientX,t.clientY)},e.prototype.onMove=function(t){if(this.isMoving){var e,n=this.position,o=n.x,r=n.y;this.config.calculateTopBuffer&&(e=this.config.calculateTopBuffer());var i=this.calculateMouseMovement({e:t,isTop:!0,anywhereWithin:!0,topBuffer:e}),s=i.movementX,a=i.movementY;this.offsetElement(o+s,r+a),this.updateDragStartPosition(t.clientX,t.clientY)}},e.prototype.onMoveEnd=function(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")},e.prototype.setOffsetParent=function(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent},e.prototype.findBoundaryElement=function(){for(var t=this.element;t;){if("static"!==window.getComputedStyle(t).position)return t;t=t.parentElement}return this.element},e.prototype.clearResizeListeners=function(){for(;this.resizeListeners.length;){var t=this.resizeListeners.pop();this.dragService.removeDragSource(t)}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()},zr([$("popupService")],e.prototype,"popupService",void 0),zr([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),zr([$("dragService")],e.prototype,"dragService",void 0),e}(Ht),Wr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qr=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Xr=function(t){function e(e){var n=t.call(this)||this;return n.filterNameKey=e,n.applyActive=!1,n.hidePopup=null,n.debouncePending=!1,n.appliedModel=null,n}return Wr(e,t),e.prototype.postConstruct=function(){this.resetTemplate(),this.createManagedBean(new Br(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Ur(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)},e.prototype.handleKeyDown=function(t){},e.prototype.getFilterTitle=function(){return this.translate(this.filterNameKey)},e.prototype.isFilterActive=function(){return!!this.appliedModel},e.prototype.resetTemplate=function(t){var e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit);var n='\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'+this.getCssIdentifier()+'-body-wrapper" ref="eFilterBody">\n                    '+this.createBodyTemplate()+"\n                </div>\n            </form>";this.setTemplate(n,t),(e=this.getGui())&&e.addEventListener("submit",this.onFormSubmit)},e.prototype.isReadOnly=function(){return!!this.providedFilterParams.readOnly},e.prototype.init=function(t){var e=this;this.setParams(t),this.resetUiToDefaults(!0).then((function(){e.updateUiVisibility(),e.setupOnBtApplyDebounce()}))},e.prototype.setParams=function(t){this.providedFilterParams=t,this.applyActive=e.isUseApplyButton(t),this.createButtonPanel()},e.prototype.createButtonPanel=function(){var t=this,e=this.providedFilterParams.buttons;if(!(!e||e.length<1||this.isReadOnly())){var n=document.createElement("div");n.classList.add("ag-filter-apply-panel");lr(e).forEach((function(e){return function(e){var o,r;switch(e){case"apply":o=t.translate("applyFilter"),r=function(e){return t.onBtApply(!1,!1,e)};break;case"clear":o=t.translate("clearFilter"),r=function(){return t.onBtClear()};break;case"reset":o=t.translate("resetFilter"),r=function(){return t.onBtReset()};break;case"cancel":o=t.translate("cancelFilter"),r=function(e){t.onBtCancel(e)};break;default:return void console.warn("AG Grid: Unknown button type specified")}var i=Oo('<button\n                    type="'+("apply"===e?"submit":"button")+'"\n                    ref="'+e+'FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >'+o+"\n                </button>");n.appendChild(i),t.addManagedListener(i,"click",r)}(e)})),this.getGui().appendChild(n)}},e.prototype.getDefaultDebounceMs=function(){return 0},e.prototype.setupOnBtApplyDebounce=function(){var t=this,n=e.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),o=k(this.checkApplyDebounce.bind(this),n);this.onBtApplyDebounce=function(){t.debouncePending=!0,o()}},e.prototype.checkApplyDebounce=function(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())},e.prototype.getModel=function(){return this.appliedModel?this.appliedModel:null},e.prototype.setModel=function(t){var e=this;return(null!=t?this.setModelIntoUi(t):this.resetUiToDefaults()).then((function(){e.updateUiVisibility(),e.applyModel("api")}))},e.prototype.onBtCancel=function(t){var e=this;this.resetUiToActiveModel(this.getModel(),(function(){e.handleCancelEnd(t)}))},e.prototype.handleCancelEnd=function(t){this.providedFilterParams.closeOnApply&&this.close(t)},e.prototype.resetUiToActiveModel=function(t,e){var n=this,o=function(){n.onUiChanged(!1,"prevent"),null===e||void 0===e||e()};null!=t?this.setModelIntoUi(t).then(o):this.resetUiToDefaults().then(o)},e.prototype.onBtClear=function(){var t=this;this.resetUiToDefaults().then((function(){return t.onUiChanged()}))},e.prototype.onBtReset=function(){this.onBtClear(),this.onBtApply()},e.prototype.applyModel=function(t){var e=this.getModelFromUi();if(!this.isModelValid(e))return!1;var n=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(n,e)},e.prototype.isModelValid=function(t){return!0},e.prototype.onFormSubmit=function(t){t.preventDefault()},e.prototype.onBtApply=function(t,e,n){if(void 0===t&&(t=!1),void 0===e&&(e=!1),n&&n.preventDefault(),this.applyModel(e?"rowDataUpdated":"ui")){this.providedFilterParams.filterChangedCallback({afterFloatingFilter:t,afterDataChange:e,source:"columnFilter"})}this.providedFilterParams.closeOnApply&&this.applyActive&&!t&&!e&&this.close(n)},e.prototype.onNewRowsLoaded=function(){},e.prototype.close=function(t){if(this.hidePopup){var e,n=t,o=n&&n.key;"Enter"!==o&&"Space"!==o||(e={keyboardEvent:n}),this.hidePopup(e),this.hidePopup=null}},e.prototype.onUiChanged=function(t,e){if(void 0===t&&(t=!1),this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){var n=this.isModelValid(this.getModelFromUi());fo(this.getRefElement("applyFilterButton"),!n)}t&&!e||"immediately"===e?this.onBtApply(t):(this.applyActive||e)&&"debounce"!==e||this.onBtApplyDebounce()},e.prototype.afterGuiAttached=function(t){t&&(this.hidePopup=t.hidePopup),this.refreshFilterResizer(null===t||void 0===t?void 0:t.container)},e.prototype.refreshFilterResizer=function(t){if(this.positionableFeature&&"toolPanel"!==t){var e="floatingFilter"===t,n=this.positionableFeature,o=this.gridOptionsService;e?(n.restoreLastSize(),n.setResizable(o.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}},e.prototype.afterGuiDetached=function(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)},e.getDebounceMs=function(t,n){return e.isUseApplyButton(t)?(null!=t.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=t.debounceMs?t.debounceMs:n},e.isUseApplyButton=function(t){return!!t.buttons&&t.buttons.indexOf("apply")>=0},e.prototype.destroy=function(){var e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),t.prototype.destroy.call(this)},e.prototype.translate=function(t){return this.localeService.getLocaleTextFunc()(t,Nr[t])},e.prototype.getCellValue=function(t){var e=this.providedFilterParams,n=e.api,o=e.colDef,r=e.column,i=e.columnApi,s=e.context;return this.providedFilterParams.valueGetter({api:n,colDef:o,column:r,columnApi:i,context:s,data:t.data,getValue:function(e){return t.data[e]},node:t})},e.prototype.getPositionableElement=function(){return this.eFilterBody},qr([$("rowModel")],e.prototype,"rowModel",void 0),qr([Or("eFilterBody")],e.prototype,"eFilterBody",void 0),qr([Z],e.prototype,"postConstruct",null),e}(Tr),Yr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kr=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zr=function(t){function e(e,n){var o=t.call(this,n)||this;return o.labelSeparator="",o.labelAlignment="left",o.disabled=!1,o.label="",o.config=e||{},o}return Yr(e,t),e.prototype.postConstruct=function(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");var t=this.config,e=t.labelSeparator,n=t.label,o=t.labelWidth,r=t.labelAlignment;null!=e&&this.setLabelSeparator(e),null!=n&&this.setLabel(n),null!=o&&this.setLabelWidth(o),this.setLabelAlignment(r||this.labelAlignment),this.refreshLabel()},e.prototype.refreshLabel=function(){So(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(po(this.eLabel,!1),Ze(this.eLabel,"presentation")):(po(this.eLabel,!0),Ze(this.eLabel,null))},e.prototype.setLabelSeparator=function(t){return this.labelSeparator===t||(this.labelSeparator=t,null!=this.label&&this.refreshLabel()),this},e.prototype.getLabelId=function(){return this.eLabel.id=this.eLabel.id||"ag-"+this.getCompId()+"-label",this.eLabel.id},e.prototype.getLabel=function(){return this.label},e.prototype.setLabel=function(t){return this.label===t||(this.label=t,this.refreshLabel()),this},e.prototype.setLabelAlignment=function(t){var e=this.getGui().classList;return e.toggle("ag-label-align-left","left"===t),e.toggle("ag-label-align-right","right"===t),e.toggle("ag-label-align-top","top"===t),this},e.prototype.setLabelEllipsis=function(t){return this.eLabel.classList.toggle("ag-label-ellipsis",t),this},e.prototype.setLabelWidth=function(t){return null==this.label||ko(this.eLabel,t),this},e.prototype.setDisabled=function(t){t=!!t;var e=this.getGui();return fo(e,t),e.classList.toggle("ag-disabled",t),this.disabled=t,this},e.prototype.isDisabled=function(){return!!this.disabled},Kr([Z],e.prototype,"postConstruct",null),e}(Tr),Jr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qr=function(t){function e(e,n,o){var r=t.call(this,e,n)||this;return r.className=o,r}return Jr(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.className&&this.addCssClass(this.className)},e.prototype.onValueChange=function(t){var e=this;return this.addManagedListener(this,Zt.EVENT_FIELD_VALUE_CHANGED,(function(){return t(e.getValue())})),this},e.prototype.getWidth=function(){return this.getGui().clientWidth},e.prototype.setWidth=function(t){return Go(this.getGui(),t),this},e.prototype.getPreviousValue=function(){return this.previousValue},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t,e){return this.value===t||(this.previousValue=this.value,this.value=t,e||this.dispatchEvent({type:Zt.EVENT_FIELD_VALUE_CHANGED})),this},e}(Zr),$r=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ti=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ei=function(t){function e(e,n,o,r){var i=t.call(this,e,'<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    '+(r?'role="'+r+'"':"")+'\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',n)||this;return i.pickerIcon=o,i.isPickerDisplayed=!1,i.skipClick=!1,i.pickerGap=4,i.hideCurrentPicker=null,i.onPickerFocusIn=i.onPickerFocusIn.bind(i),i.onPickerFocusOut=i.onPickerFocusOut.bind(i),null!=(null===e||void 0===e?void 0:e.pickerGap)&&(i.pickerGap=e.pickerGap),i}return $r(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this);var n="ag-"+this.getCompId()+"-display";this.eDisplayField.setAttribute("id",n),on(this.eWrapper,n);var o=this.getGui();this.addManagedListener(o,"mousedown",(function(t){var n;!e.skipClick&&(null===(n=e.pickerComponent)||void 0===n?void 0:n.isAlive())&&Ro(e.pickerComponent.getGui())&&o.contains(t.target)&&(e.skipClick=!0)}));var r=this.getFocusableElement();if(this.addManagedListener(o,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"click",this.clickHandler.bind(this)),this.addManagedListener(r,"click",this.clickHandler.bind(this)),this.pickerIcon){var i=Zo(this.pickerIcon,this.gridOptionsService);i&&this.eIcon.appendChild(i)}},e.prototype.refreshLabel=function(){r(this.getLabel())?en(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),t.prototype.refreshLabel.call(this)},e.prototype.clickHandler=function(){this.skipClick?this.skipClick=!1:this.isDisabled()||this.showPicker()},e.prototype.onKeyDown=function(t){switch(t.key){case Qo.UP:case Qo.DOWN:case Qo.ENTER:case Qo.SPACE:t.preventDefault(),this.clickHandler();break;case Qo.ESCAPE:this.isPickerDisplayed&&(t.preventDefault(),t.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}},e.prototype.showPicker=function(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());var t=this.pickerComponent.getGui();t.addEventListener("focusin",this.onPickerFocusIn),t.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)},e.prototype.renderAndPositionPicker=function(){var t=this,e=this.gridOptionsService.getDocument(),n=this.pickerComponent.getGui();this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(e.body,"wheel",(function(e){n.contains(e.target)||t.hidePicker()})));var o=this.localeService.getLocaleTextFunc(),r=this.config,i=r.pickerType,s=r.pickerAriaLabelKey,a=r.pickerAriaLabelValue,l={modal:!0,eChild:n,closeOnEsc:!0,closedCallback:function(){var n=e.activeElement===e.body;t.beforeHidePicker(),n&&t.isAlive()&&t.getFocusableElement().focus()},ariaLabel:o(s,a)},u=this.popupService.addPopup(l);return ko(n,Co(this.eWrapper)),n.style.position="absolute",this.popupService.positionPopupByComponent({type:i,eventSource:this.eWrapper,ePopup:n,position:"under",keepWithinBounds:!0,nudgeY:this.pickerGap}),u.hideFunc},e.prototype.beforeHidePicker=function(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);var t=this.pickerComponent.getGui();t.removeEventListener("focusin",this.onPickerFocusIn),t.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null},e.prototype.toggleExpandedStyles=function(t){this.isAlive()&&(un(this.eWrapper,t),this.eWrapper.classList.toggle("ag-picker-expanded",t),this.eWrapper.classList.toggle("ag-picker-collapsed",!t))},e.prototype.onPickerFocusIn=function(){this.togglePickerHasFocus(!0)},e.prototype.onPickerFocusOut=function(t){var e;(null===(e=this.pickerComponent)||void 0===e?void 0:e.getGui().contains(t.relatedTarget))||this.togglePickerHasFocus(!1)},e.prototype.togglePickerHasFocus=function(t){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",t)},e.prototype.hidePicker=function(){this.hideCurrentPicker&&this.hideCurrentPicker()},e.prototype.setAriaLabel=function(t){return tn(this.eWrapper,t),this},e.prototype.setInputWidth=function(t){return ko(this.eWrapper,t),this},e.prototype.getFocusableElement=function(){return this.eWrapper},e.prototype.setPickerGap=function(t){return this.pickerGap=t,this},e.prototype.destroy=function(){this.hidePicker(),t.prototype.destroy.call(this)},ti([$("popupService")],e.prototype,"popupService",void 0),ti([Or("eLabel")],e.prototype,"eLabel",void 0),ti([Or("eWrapper")],e.prototype,"eWrapper",void 0),ti([Or("eDisplayField")],e.prototype,"eDisplayField",void 0),ti([Or("eIcon")],e.prototype,"eIcon",void 0),e}(Qr),ni=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),oi=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ri=function(t){function e(e){void 0===e&&(e="default");var n=t.call(this,'<div class="ag-list ag-'+e+'-list" role="listbox"></div>')||this;return n.cssIdentifier=e,n.options=[],n.itemEls=[],n}return ni(e,t),e.prototype.init=function(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))},e.prototype.handleKeyDown=function(t){var e=t.key;switch(e){case Qo.ENTER:if(this.highlightedEl){var n=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(n)}else this.setValue(this.getValue());break;case Qo.DOWN:case Qo.UP:var o=e===Qo.DOWN,r=void 0;if(t.preventDefault(),this.highlightedEl){var i=this.itemEls.indexOf(this.highlightedEl)+(o?1:-1);i=Math.min(Math.max(i,0),this.itemEls.length-1),r=this.itemEls[i]}else r=this.itemEls[o?0:this.itemEls.length-1];this.highlightItem(r)}},e.prototype.addOptions=function(t){var e=this;return t.forEach((function(t){return e.addOption(t)})),this},e.prototype.addOption=function(t){var e=t.value,n=re(t.text||e);return this.options.push({value:e,text:n}),this.renderOption(e,n),this.updateIndices(),this},e.prototype.updateIndices=function(){var t=this.getGui().querySelectorAll(".ag-list-item");t.forEach((function(e,n){hn(e,n+1),pn(e,t.length)}))},e.prototype.renderOption=function(t,e){var n=this,o=document.createElement("div");Ze(o,"option"),o.classList.add("ag-list-item","ag-"+this.cssIdentifier+"-list-item"),o.innerHTML="<span>"+e+"</span>",o.tabIndex=-1,this.itemEls.push(o),this.addManagedListener(o,"mouseover",(function(){return n.highlightItem(o)})),this.addManagedListener(o,"mouseleave",(function(){return n.clearHighlighted()})),this.addManagedListener(o,"click",(function(){return n.setValue(t)})),this.getGui().appendChild(o)},e.prototype.setValue=function(t,e){if(this.value===t)return this.fireItemSelected(),this;if(null==t)return this.reset(),this;var n=this.options.findIndex((function(e){return e.value===t}));if(-1!==n){var o=this.options[n];this.value=o.value,this.displayValue=null!=o.text?o.text:o.value,this.highlightItem(this.itemEls[n]),e||this.fireChangeEvent()}return this},e.prototype.setValueByIndex=function(t){return this.setValue(this.options[t].value)},e.prototype.getValue=function(){return this.value},e.prototype.getDisplayValue=function(){return this.displayValue},e.prototype.refreshHighlighted=function(){var t=this;this.clearHighlighted();var e=this.options.findIndex((function(e){return e.value===t.value}));-1!==e&&this.highlightItem(this.itemEls[e])},e.prototype.reset=function(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()},e.prototype.highlightItem=function(t){t.offsetParent&&(this.clearHighlighted(),this.highlightedEl=t,this.highlightedEl.classList.add(e.ACTIVE_CLASS),wn(this.highlightedEl,!0),this.highlightedEl.focus())},e.prototype.clearHighlighted=function(){this.highlightedEl&&this.highlightedEl.offsetParent&&(this.highlightedEl.classList.remove(e.ACTIVE_CLASS),wn(this.highlightedEl,!1),this.highlightedEl=null)},e.prototype.fireChangeEvent=function(){this.dispatchEvent({type:Zt.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()},e.prototype.fireItemSelected=function(){this.dispatchEvent({type:e.EVENT_ITEM_SELECTED})},e.EVENT_ITEM_SELECTED="selectedItem",e.ACTIVE_CLASS="ag-active-item",oi([Z],e.prototype,"init",null),e}(Tr),ii=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),si=function(){return si=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},si.apply(this,arguments)},ai=function(t){function e(e){return t.call(this,si({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list"},e),"ag-select","smallDown","listbox")||this}return ii(e,t),e.prototype.postConstruct=function(){var e;t.prototype.postConstruct.call(this),this.createListComponent(),this.eWrapper.tabIndex=null!==(e=this.gridOptionsService.getNum("tabIndex"))&&void 0!==e?e:0},e.prototype.createListComponent=function(){var t=this;this.listComponent=this.createBean(new ri("select")),this.listComponent.setParentComponent(this),this.listComponent.addGuiEventListener("keydown",(function(e){e.key===Qo.TAB&&(e.preventDefault(),e.stopImmediatePropagation(),t.getGui().dispatchEvent(new KeyboardEvent("keydown",{key:e.key,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,bubbles:!0})))})),this.listComponent.addManagedListener(this.listComponent,ri.EVENT_ITEM_SELECTED,(function(){t.hidePicker(),t.dispatchEvent({type:e.EVENT_ITEM_SELECTED})})),this.listComponent.addManagedListener(this.listComponent,Zt.EVENT_FIELD_VALUE_CHANGED,(function(){t.listComponent&&(t.setValue(t.listComponent.getValue(),!1,!0),t.hidePicker())}))},e.prototype.createPickerComponent=function(){return this.listComponent},e.prototype.showPicker=function(){var e=this;if(this.listComponent){t.prototype.showPicker.call(this),this.listComponent.getGui().style.maxHeight=yo(this.popupService.getPopupParent())+"px";var n=this.listComponent.getGui();this.pickerFocusOutListener=this.addManagedListener(n,"focusout",(function(t){n.contains(t.relatedTarget)||e.hidePicker()})),this.listComponent.refreshHighlighted()}},e.prototype.beforeHidePicker=function(){this.pickerFocusOutListener&&(this.pickerFocusOutListener(),this.pickerFocusOutListener=void 0),t.prototype.beforeHidePicker.call(this)},e.prototype.addOptions=function(t){var e=this;return t.forEach((function(t){return e.addOption(t)})),this},e.prototype.addOption=function(t){return this.listComponent.addOption(t),this},e.prototype.setValue=function(e,n,o){return this.value!==e&&this.listComponent?(o||this.listComponent.setValue(e,!0),this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),t.prototype.setValue.call(this,e,n))):this},e.prototype.destroy=function(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),t.prototype.destroy.call(this)},e.EVENT_ITEM_SELECTED="selectedItem",e}(ei),li=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ui=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ci=function(t){function e(e,n,o,r){void 0===o&&(o="text"),void 0===r&&(r="input");var i=t.call(this,e,'\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'+r+' ref="eInput" class="ag-input-field-input"></'+r+">\n                </div>\n            </div>",n)||this;return i.inputType=o,i.displayFieldTag=r,i}return li(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.setInputType(),this.eLabel.classList.add(this.className+"-label"),this.eWrapper.classList.add(this.className+"-input-wrapper"),this.eInput.classList.add(this.className+"-input"),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||"ag-"+this.getCompId()+"-input";var e=this.config,n=e.width,o=e.value;null!=n&&this.setWidth(n),null!=o&&this.setValue(o),this.addInputListeners(),this.activateTabIndex([this.eInput])},e.prototype.refreshLabel=function(){r(this.getLabel())?en(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),t.prototype.refreshLabel.call(this)},e.prototype.addInputListeners=function(){var t=this;this.addManagedListener(this.eInput,"input",(function(e){return t.setValue(e.target.value)}))},e.prototype.setInputType=function(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)},e.prototype.getInputElement=function(){return this.eInput},e.prototype.setInputWidth=function(t){return ko(this.eWrapper,t),this},e.prototype.setInputName=function(t){return this.getInputElement().setAttribute("name",t),this},e.prototype.getFocusableElement=function(){return this.eInput},e.prototype.setMaxLength=function(t){return this.eInput.maxLength=t,this},e.prototype.setInputPlaceholder=function(t){return Uo(this.eInput,"placeholder",t),this},e.prototype.setInputAriaLabel=function(t){return tn(this.eInput,t),this},e.prototype.setDisabled=function(e){return fo(this.eInput,e),t.prototype.setDisabled.call(this,e)},e.prototype.setAutoComplete=function(t){if(!0===t)Uo(this.eInput,"autocomplete",null);else{var e="string"===typeof t?t:"off";Uo(this.eInput,"autocomplete",e)}return this},ui([Or("eLabel")],e.prototype,"eLabel",void 0),ui([Or("eWrapper")],e.prototype,"eWrapper",void 0),ui([Or("eInput")],e.prototype,"eInput",void 0),e}(Qr),pi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),hi=function(t){function e(e,n,o){void 0===n&&(n="ag-checkbox"),void 0===o&&(o="checkbox");var r=t.call(this,e,n,o)||this;return r.labelAlignment="right",r.selected=!1,r.readOnly=!1,r.passive=!1,r}return pi(e,t),e.prototype.addInputListeners=function(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))},e.prototype.getNextValue=function(){return void 0===this.selected||!this.selected},e.prototype.setPassive=function(t){this.passive=t},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.setReadOnly=function(t){this.eWrapper.classList.toggle("ag-disabled",t),this.eInput.disabled=t,this.readOnly=t},e.prototype.setDisabled=function(e){return this.eWrapper.classList.toggle("ag-disabled",e),t.prototype.setDisabled.call(this,e)},e.prototype.toggle=function(){if(!this.eInput.disabled){var t=this.isSelected(),e=this.getNextValue();this.passive?this.dispatchChange(e,t):this.setValue(e)}},e.prototype.getValue=function(){return this.isSelected()},e.prototype.setValue=function(t,e){return this.refreshSelectedClass(t),this.setSelected(t,e),this},e.prototype.setName=function(t){return this.getInputElement().name=t,this},e.prototype.isSelected=function(){return this.selected},e.prototype.setSelected=function(t,e){this.isSelected()!==t&&(this.previousValue=this.isSelected(),t=this.selected="boolean"===typeof t?t:void 0,this.eInput.checked=t,this.eInput.indeterminate=void 0===t,e||this.dispatchChange(this.selected,this.previousValue))},e.prototype.dispatchChange=function(t,e,n){this.dispatchEvent({type:Zt.EVENT_FIELD_VALUE_CHANGED,selected:t,previousValue:e,event:n});var o=this.getInputElement(),r={type:Zt.EVENT_CHECKBOX_CHANGED,id:o.id,name:o.name,selected:t,previousValue:e};this.eventService.dispatchEvent(r)},e.prototype.onCheckboxClick=function(t){if(!this.passive&&!this.eInput.disabled){var e=this.isSelected(),n=this.selected=t.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,e,t)}},e.prototype.refreshSelectedClass=function(t){this.eWrapper.classList.toggle("ag-checked",!0===t),this.eWrapper.classList.toggle("ag-indeterminate",null==t)},e}(ci),di=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fi=function(t){function e(e){return t.call(this,e,"ag-radio-button","radio")||this}return di(e,t),e.prototype.isSelected=function(){return this.eInput.checked},e.prototype.toggle=function(){this.eInput.disabled||this.isSelected()||this.setValue(!0)},e.prototype.addInputListeners=function(){t.prototype.addInputListeners.call(this),this.addManagedListener(this.eventService,Zt.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))},e.prototype.onChange=function(t){t.selected&&t.name&&this.eInput.name&&this.eInput.name===t.name&&t.id&&this.eInput.id!==t.id&&this.setValue(!1,!0)},e}(hi),gi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mi=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},yi=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},vi=function(){function t(t,e,n){this.localeService=t,this.optionsFactory=e,this.valueFormatter=n}return t.prototype.getModelAsString=function(t){var e=this;if(!t)return null;var n=null!=t.operator,o=this.localeService.getLocaleTextFunc();if(n){var r=t,i=r.conditions;if(!i)i=[r.condition1,r.condition2];var s=i.map((function(t){return e.getModelAsString(t)})),a="AND"===r.operator?"andCondition":"orCondition";return s.join(" "+o(a,Nr[a])+" ")}if(t.type===_i.BLANK||t.type===_i.NOT_BLANK)return o(t.type,t.type);var l=t,u=this.optionsFactory.getCustomOption(l.type),c=u||{},p=c.displayKey,h=c.displayName,d=c.numberOfInputs;return p&&h&&0===d?(o(p,h),h):this.conditionToString(l,u)},t.prototype.updateParams=function(t){this.optionsFactory=t.optionsFactory},t.prototype.formatValue=function(t){var e;return this.valueFormatter?null!==(e=this.valueFormatter(null!==t&&void 0!==t?t:null))&&void 0!==e?e:"":String(t)},t}(),_i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eTypes=[],e.eJoinOperatorPanels=[],e.eJoinOperatorsAnd=[],e.eJoinOperatorsOr=[],e.eConditionBodies=[],e.listener=function(){return e.onUiChanged()},e.lastUiCompletePosition=null,e.joinOperatorId=0,e}return gi(e,t),e.prototype.getNumberOfInputs=function(t){var n=this.optionsFactory.getCustomOption(t);if(n){var o=n.numberOfInputs;return null!=o?o:1}var r=[e.EMPTY,e.NOT_BLANK,e.BLANK];return t&&r.indexOf(t)>=0?0:t===e.IN_RANGE?2:1},e.prototype.onFloatingFilterChanged=function(t,e){this.setTypeFromFloatingFilter(t),this.setValueFromFloatingFilter(e),this.onUiChanged(!0)},e.prototype.setTypeFromFloatingFilter=function(t){var e=this;this.eTypes.forEach((function(n,o){0===o?n.setValue(t,!0):n.setValue(e.optionsFactory.getDefaultOption(),!0)}))},e.prototype.getModelFromUi=function(){var t=this.getUiCompleteConditions();return 0===t.length?null:this.maxNumConditions>1&&t.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:t[0],condition2:t[1],conditions:t}:t[0]},e.prototype.getConditionTypes=function(){return this.eTypes.map((function(t){return t.getValue()}))},e.prototype.getConditionType=function(t){return this.eTypes[t].getValue()},e.prototype.getJoinOperator=function(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"},e.prototype.areModelsEqual=function(t,e){var n=this;if(!t&&!e)return!0;if(!t&&e||t&&!e)return!1;var o,r=!t.operator,i=!e.operator;if(!r&&i||r&&!i)return!1;if(r){var s=t,a=e;o=this.areSimpleModelsEqual(s,a)}else{var l=t,u=e;o=l.operator===u.operator&&vt(l.conditions,u.conditions,(function(t,e){return n.areSimpleModelsEqual(t,e)}))}return o},e.prototype.setModelIntoUi=function(t){var e=this;if(t.operator){var n=t;n.conditions||(n.conditions=[n.condition1,n.condition2]);var o=this.validateAndUpdateConditions(n.conditions),r=this.getNumConditions();if(o<r)this.removeConditionsAndOperators(o);else if(o>r)for(var i=r;i<o;i++)this.createJoinOperatorPanel(),this.createOption();var s="OR"===n.operator;this.eJoinOperatorsAnd.forEach((function(t){return t.setValue(!s,!0)})),this.eJoinOperatorsOr.forEach((function(t){return t.setValue(s,!0)})),n.conditions.forEach((function(t,n){e.eTypes[n].setValue(t.type,!0),e.setConditionIntoUi(t,n)}))}else{var a=t;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(a.type,!0),this.setConditionIntoUi(a,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),mr.resolve()},e.prototype.validateAndUpdateConditions=function(t){var e=t.length;return e>this.maxNumConditions&&(t.splice(this.maxNumConditions),P((function(){return console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.')}),"simpleFilterSetModelMaxNumConditions"),e=this.maxNumConditions),e},e.prototype.doesFilterPass=function(t){var e,n=this,o=this.getModel();if(null==o)return!0;var r=o.operator,i=[];if(r){var s=o;i.push.apply(i,yi([],mi(null!==(e=s.conditions)&&void 0!==e?e:[])))}else i.push(o);return i[r&&"OR"===r?"some":"every"]((function(e){return n.individualConditionPasses(t,e)}))},e.prototype.setParams=function(e){t.prototype.setParams.call(this,e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Lr,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")},e.prototype.setNumConditions=function(t){var e,n;null!=t.suppressAndOrCondition&&P((function(){return console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.')}),"simpleFilterSuppressAndOrCondition"),null!=t.alwaysShowBothConditions&&P((function(){return console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.')}),"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(e=t.maxNumConditions)&&void 0!==e?e:t.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(P((function(){return console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.')}),"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(n=t.numAlwaysVisibleConditions)&&void 0!==n?n:t.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(P((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.')}),"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(P((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".')}),"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)},e.prototype.createOption=function(){var t=this,e=this.createManagedBean(new ai);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());var n=this.createValueElement();this.eConditionBodies.push(n),this.eFilterBody.appendChild(n),this.putOptionsIntoDropdown(e),this.resetType(e);var o=this.getNumConditions()-1;this.forEachPositionInput(o,(function(e){return t.resetInput(e)})),this.addChangedListeners(e,o)},e.prototype.createJoinOperatorPanel=function(){var t=document.createElement("div");this.eJoinOperatorPanels.push(t),t.classList.add("ag-filter-condition");var e=this.createJoinOperator(this.eJoinOperatorsAnd,t,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,t,"or");this.eFilterBody.appendChild(t);var o=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(e,o,r),this.resetJoinOperatorOr(n,o,r),this.isReadOnly()||(e.onValueChange(this.listener),n.onValueChange(this.listener))},e.prototype.createJoinOperator=function(t,e,n){var o=this.createManagedBean(new fi);return t.push(o),o.addCssClass("ag-filter-condition-operator"),o.addCssClass("ag-filter-condition-operator-"+n),e.appendChild(o.getGui()),o},e.prototype.getDefaultJoinOperator=function(t){return"AND"===t||"OR"===t?t:"AND"},e.prototype.createFilterListOptions=function(){var t=this,e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map((function(e){return"string"===typeof e?t.createBoilerplateListOption(e):t.createCustomListOption(e)}))},e.prototype.putOptionsIntoDropdown=function(t){this.filterListOptions.forEach((function(e){t.addOption(e)})),t.setDisabled(this.filterListOptions.length<=1)},e.prototype.createBoilerplateListOption=function(t){return{value:t,text:this.translate(t)}},e.prototype.createCustomListOption=function(t){var e=t.displayKey,n=this.optionsFactory.getCustomOption(t.displayKey);return{value:e,text:n?this.localeService.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(e)}},e.prototype.isAllowTwoConditions=function(){return this.maxNumConditions>=2},e.prototype.createBodyTemplate=function(){return""},e.prototype.getCssIdentifier=function(){return"simple-filter"},e.prototype.updateUiVisibility=function(){var t=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,t)},e.prototype.updateNumConditions=function(){for(var t,e=-1,n=!0,o=0;o<this.getNumConditions();o++)this.isConditionUiComplete(o)?e=o:n=!1;if(this.shouldAddNewConditionAtEnd(n))this.createJoinOperatorPanel(),this.createOption();else{var r=null!==(t=this.lastUiCompletePosition)&&void 0!==t?t:this.getNumConditions()-2;if(e<r){this.removeConditionsAndOperators(r+1);var i=e+1,s=r-i;s>0&&this.removeConditionsAndOperators(i,s),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e},e.prototype.updateConditionStatusesAndValues=function(t,e){var n=this;this.eTypes.forEach((function(e,o){var r=n.isConditionDisabled(o,t);e.setDisabled(r||n.filterListOptions.length<=1),1===o&&(fo(n.eJoinOperatorPanels[0],r),n.eJoinOperatorsAnd[0].setDisabled(r),n.eJoinOperatorsOr[0].setDisabled(r))})),this.eConditionBodies.forEach((function(t,e){po(t,n.isConditionBodyVisible(e))}));var o="OR"===(null!==e&&void 0!==e?e:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((function(t,e){t.setValue(!o,!0)})),this.eJoinOperatorsOr.forEach((function(t,e){t.setValue(o,!0)})),this.forEachInput((function(e,o,r,i){n.setElementDisplayed(e,o<i),n.setElementDisabled(e,n.isConditionDisabled(r,t))})),this.resetPlaceholder()},e.prototype.shouldAddNewConditionAtEnd=function(t){return t&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()},e.prototype.removeConditionsAndOperators=function(t,e){if(!(t>=this.getNumConditions())){this.removeComponents(this.eTypes,t,e),this.removeElements(this.eConditionBodies,t,e),this.removeValueElements(t,e);var n=Math.max(t-1,0);this.removeElements(this.eJoinOperatorPanels,n,e),this.removeComponents(this.eJoinOperatorsAnd,n,e),this.removeComponents(this.eJoinOperatorsOr,n,e)}},e.prototype.removeElements=function(t,e,n){this.removeItems(t,e,n).forEach((function(t){return To(t)}))},e.prototype.removeComponents=function(t,e,n){var o=this;this.removeItems(t,e,n).forEach((function(t){To(t.getGui()),o.destroyBean(t)}))},e.prototype.removeItems=function(t,e,n){return null==n?t.splice(e):t.splice(e,n)},e.prototype.afterGuiAttached=function(e){if(t.prototype.afterGuiAttached.call(this,e),this.resetPlaceholder(),!(null===e||void 0===e?void 0:e.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{var n=this.getInputs(0)[0];if(!n)return;n instanceof ci&&n.getInputElement().focus()}},e.prototype.afterGuiDetached=function(){t.prototype.afterGuiDetached.call(this);var e=this.getModel();this.areModelsEqual(e,this.getModelFromUi())&&!this.hasInvalidInputs()||this.resetUiToActiveModel(e);for(var n=-1,o=-1,r=!1,i=this.getJoinOperator(),s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))-1===n&&(n=s,o=s);else{var a=s<n;(s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1)||a)&&(this.removeConditionsAndOperators(s,1),r=!0,a&&o--)}var l=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),l=!0),this.shouldAddNewConditionAtEnd(o===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),l=!0),l&&this.updateConditionStatusesAndValues(o,i),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=o},e.prototype.getPlaceholderText=function(t,e){var n=this.translate(t);if(A(this.filterPlaceholder)){var o=this.filterPlaceholder,r=this.eTypes[e].getValue();n=o({filterOptionKey:r,filterOption:this.translate(r),placeholder:n})}else"string"===typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n},e.prototype.resetPlaceholder=function(){var t=this,e=this.localeService.getLocaleTextFunc();this.forEachInput((function(n,o,r,i){if(n instanceof ci){var s=0===o&&i>1?"inRangeStart":0===o?"filterOoo":"inRangeEnd",a=0===o&&i>1?e("ariaFilterFromValue","Filter from value"):0===o?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");n.setInputPlaceholder(t.getPlaceholderText(s,r)),n.setInputAriaLabel(a)}}))},e.prototype.setElementValue=function(t,e){t instanceof ci&&t.setValue(null!=e?String(e):null,!0)},e.prototype.setElementDisplayed=function(t,e){t instanceof Tr&&po(t.getGui(),e)},e.prototype.setElementDisabled=function(t,e){t instanceof Tr&&fo(t.getGui(),e)},e.prototype.attachElementOnChange=function(t,e){t instanceof ci&&t.onValueChange(e)},e.prototype.forEachInput=function(t){var e=this;this.getConditionTypes().forEach((function(n,o){e.forEachPositionTypeInput(o,n,t)}))},e.prototype.forEachPositionInput=function(t,e){var n=this.getConditionType(t);this.forEachPositionTypeInput(t,n,e)},e.prototype.forEachPositionTypeInput=function(t,e,n){for(var o=this.getNumberOfInputs(e),r=this.getInputs(t),i=0;i<r.length;i++){var s=r[i];null!=s&&n(s,i,t,o)}},e.prototype.isConditionDisabled=function(t,e){return!!this.isReadOnly()||0!==t&&t>e+1},e.prototype.isConditionBodyVisible=function(t){var e=this.getConditionType(t);return this.getNumberOfInputs(e)>0},e.prototype.isConditionUiComplete=function(t){return!(t>=this.getNumConditions())&&(this.getConditionType(t)!==e.EMPTY&&!this.getValues(t).some((function(t){return null==t})))},e.prototype.getNumConditions=function(){return this.eTypes.length},e.prototype.getUiCompleteConditions=function(){for(var t=[],e=0;e<this.getNumConditions();e++)this.isConditionUiComplete(e)&&t.push(this.createCondition(e));return t},e.prototype.createMissingConditionsAndOperators=function(){if(!this.isReadOnly())for(var t=this.getNumConditions();t<this.numAlwaysVisibleConditions;t++)this.createJoinOperatorPanel(),this.createOption()},e.prototype.resetUiToDefaults=function(t){var e=this;return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((function(t){return e.resetType(t)})),this.eJoinOperatorsAnd.forEach((function(t,n){return e.resetJoinOperatorAnd(t,n,e.joinOperatorId+n)})),this.eJoinOperatorsOr.forEach((function(t,n){return e.resetJoinOperatorOr(t,n,e.joinOperatorId+n)})),this.joinOperatorId++,this.forEachInput((function(t){return e.resetInput(t)})),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,t||this.onUiChanged(),mr.resolve()},e.prototype.resetType=function(t){var e=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");t.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(e).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)},e.prototype.resetJoinOperatorAnd=function(t,e,n){this.resetJoinOperator(t,e,this.isDefaultOperator("AND"),this.translate("andCondition"),n)},e.prototype.resetJoinOperatorOr=function(t,e,n){this.resetJoinOperator(t,e,this.isDefaultOperator("OR"),this.translate("orCondition"),n)},e.prototype.resetJoinOperator=function(t,e,n,o,r){this.updateJoinOperatorDisabled(t.setValue(n,!0).setName("ag-simple-filter-and-or-"+this.getCompId()+"-"+r).setLabel(o),e)},e.prototype.updateJoinOperatorsDisabled=function(){var t=this;this.eJoinOperatorsAnd.forEach((function(e,n){return t.updateJoinOperatorDisabled(e,n)})),this.eJoinOperatorsOr.forEach((function(e,n){return t.updateJoinOperatorDisabled(e,n)}))},e.prototype.updateJoinOperatorDisabled=function(t,e){t.setDisabled(this.isReadOnly()||e>0)},e.prototype.resetInput=function(t){this.setElementValue(t,null),this.setElementDisabled(t,this.isReadOnly())},e.prototype.setConditionIntoUi=function(t,e){var n=this,o=this.mapValuesFromModel(t);this.forEachInput((function(t,r,i,s){i===e&&n.setElementValue(t,null!=o[r]?o[r]:null)}))},e.prototype.setValueFromFloatingFilter=function(t){var e=this;this.forEachInput((function(n,o,r,i){e.setElementValue(n,0===o&&0===r?t:null)}))},e.prototype.isDefaultOperator=function(t){return t===this.defaultJoinOperator},e.prototype.addChangedListeners=function(t,e){var n=this;this.isReadOnly()||(t.onValueChange(this.listener),this.forEachPositionInput(e,(function(t){n.attachElementOnChange(t,n.listener)})))},e.prototype.individualConditionPasses=function(t,e){var n=this.getCellValue(t.node),o=this.mapValuesFromModel(e),r=this.optionsFactory.getCustomOption(e.type),i=this.evaluateCustomFilter(r,o,n);return null!=i?i:null==n?this.evaluateNullValue(e.type):this.evaluateNonNullValue(o,n,e,t)},e.prototype.evaluateCustomFilter=function(t,e,n){if(null!=t){var o=t.predicate;return null==o||e.some((function(t){return null==t}))?void 0:o(e,n)}},e.prototype.isBlank=function(t){return null==t||"string"===typeof t&&0===t.trim().length},e.prototype.hasInvalidInputs=function(){return!1},e.EMPTY="empty",e.BLANK="blank",e.NOT_BLANK="notBlank",e.EQUALS="equals",e.NOT_EQUAL="notEqual",e.LESS_THAN="lessThan",e.LESS_THAN_OR_EQUAL="lessThanOrEqual",e.GREATER_THAN="greaterThan",e.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e.IN_RANGE="inRange",e.CONTAINS="contains",e.NOT_CONTAINS="notContains",e.STARTS_WITH="startsWith",e.ENDS_WITH="endsWith",e}(Xr),Ci=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),wi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ci(e,t),e.prototype.setParams=function(e){t.prototype.setParams.call(this,e),this.scalarFilterParams=e},e.prototype.evaluateNullValue=function(t){switch(t){case e.EQUALS:case e.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case e.GREATER_THAN:case e.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case e.LESS_THAN:case e.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case e.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case e.BLANK:return!0;case e.NOT_BLANK:return!1}return!1},e.prototype.evaluateNonNullValue=function(t,n,o){var r=this.comparator(),i=null!=t[0]?r(t[0],n):0;switch(o.type){case e.EQUALS:return 0===i;case e.NOT_EQUAL:return 0!==i;case e.GREATER_THAN:return i>0;case e.GREATER_THAN_OR_EQUAL:return i>=0;case e.LESS_THAN:return i<0;case e.LESS_THAN_OR_EQUAL:return i<=0;case e.IN_RANGE:var s=r(t[1],n);return this.scalarFilterParams.inRangeInclusive?i>=0&&s<=0:i>0&&s<0;case e.BLANK:return this.isBlank(n);case e.NOT_BLANK:return!this.isBlank(n);default:return console.warn('AG Grid: Unexpected type of filter "'+o.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}},e}(_i),bi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xi=function(){return xi=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},xi.apply(this,arguments)},Ei=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Si=1/0,Ti=function(t){function e(e,n,o){var r=t.call(this,n,o)||this;return r.dateFilterParams=e,r}return bi(e,t),e.prototype.conditionToString=function(t,e){var n=t.type,o=(e||{}).numberOfInputs,r=n==_i.IN_RANGE||2===o,i=oo(t.dateFrom),s=oo(t.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;return r?(null!==i?no(i,a):"null")+"-"+(null!==s?no(s,a):"null"):null!=i?no(i,a):""+n},e.prototype.updateParams=function(e){t.prototype.updateParams.call(this,e),this.dateFilterParams=e.dateFilterParams},e}(vi),Ri=function(t){function e(){var e=t.call(this,"dateFilter")||this;return e.eConditionPanelsFrom=[],e.eConditionPanelsTo=[],e.dateConditionFromComps=[],e.dateConditionToComps=[],e.minValidYear=1e3,e.maxValidYear=Si,e}return bi(e,t),e.prototype.afterGuiAttached=function(e){t.prototype.afterGuiAttached.call(this,e),this.dateConditionFromComps[0].afterGuiAttached(e)},e.prototype.mapValuesFromModel=function(t){var e=t||{},n=e.dateFrom,o=e.dateTo,r=e.type;return[n&&oo(n)||null,o&&oo(o)||null].slice(0,this.getNumberOfInputs(r))},e.prototype.comparator=function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)},e.prototype.defaultComparator=function(t,e){return null==e||e<t?-1:e>t?1:0},e.prototype.setParams=function(e){this.dateFilterParams=e,t.prototype.setParams.call(this,e);var n=function(t,n){if(null!=e[t]){if(!isNaN(e[t]))return null==e[t]?n:Number(e[t]);console.warn("AG Grid: DateFilter "+t+" is not a number")}return n};this.minValidYear=n("minValidYear",1e3),this.maxValidYear=n("maxValidYear",Si),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new Ti(this.dateFilterParams,this.localeService,this.optionsFactory)},e.prototype.createDateCompWrapper=function(t){var e=this,n=new Mr(this.getContext(),this.userComponentFactory,{onDateChanged:function(){return e.onUiChanged()},filterParams:this.dateFilterParams},t);return this.addDestroyFunc((function(){return n.destroy()})),n},e.prototype.setElementValue=function(t,e){t.setDate(e)},e.prototype.setElementDisplayed=function(t,e){t.setDisplayed(e)},e.prototype.setElementDisabled=function(t,e){t.setDisabled(e)},e.prototype.getDefaultFilterOptions=function(){return e.DEFAULT_FILTER_OPTIONS},e.prototype.createValueElement=function(){var t=document.createElement("div");return t.classList.add("ag-filter-body"),this.createFromToElement(t,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(t,this.eConditionPanelsTo,this.dateConditionToComps,"to"),t},e.prototype.createFromToElement=function(t,e,n,o){var r=document.createElement("div");r.classList.add("ag-filter-"+o),r.classList.add("ag-filter-date-"+o),e.push(r),t.appendChild(r),n.push(this.createDateCompWrapper(r))},e.prototype.removeValueElements=function(t,e){this.removeDateComps(this.dateConditionFromComps,t,e),this.removeDateComps(this.dateConditionToComps,t,e),this.removeItems(this.eConditionPanelsFrom,t,e),this.removeItems(this.eConditionPanelsTo,t,e)},e.prototype.removeDateComps=function(t,e,n){this.removeItems(t,e,n).forEach((function(t){return t.destroy()}))},e.prototype.isConditionUiComplete=function(e){var n=this;if(!t.prototype.isConditionUiComplete.call(this,e))return!1;var o=!0;return this.forEachInput((function(t,r,i,s){var a;i!==e||!o||r>=s||(o=o&&(null!=(a=t.getDate())&&a.getUTCFullYear()>=n.minValidYear&&a.getUTCFullYear()<=n.maxValidYear))})),o},e.prototype.areSimpleModelsEqual=function(t,e){return t.dateFrom===e.dateFrom&&t.dateTo===e.dateTo&&t.type===e.type},e.prototype.getFilterType=function(){return"date"},e.prototype.createCondition=function(t){var e=this.getConditionType(t),n={},o=this.getValues(t);return o.length>0&&(n.dateFrom=to(o[0])),o.length>1&&(n.dateTo=to(o[1])),xi({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:e},n)},e.prototype.resetPlaceholder=function(){var t=this.localeService.getLocaleTextFunc(),e=this.translate("dateFormatOoo"),n=t("ariaFilterValue","Filter Value");this.forEachInput((function(t){t.setInputPlaceholder(e),t.setInputAriaLabel(n)}))},e.prototype.getInputs=function(t){return t>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[t],this.dateConditionToComps[t]]},e.prototype.getValues=function(t){var e=[];return this.forEachPositionInput(t,(function(t,n,o,r){n<r&&e.push(t.getDate())})),e},e.prototype.getModelAsString=function(t){var e;return null!==(e=this.filterModelFormatter.getModelAsString(t))&&void 0!==e?e:""},e.DEFAULT_FILTER_OPTIONS=[wi.EQUALS,wi.GREATER_THAN,wi.LESS_THAN,wi.NOT_EQUAL,wi.IN_RANGE,wi.BLANK,wi.NOT_BLANK],Ei([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),e}(wi),Oi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Oi(e,t),e.prototype.getDefaultDebounceMs=function(){return 0},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.isEventFromFloatingFilter=function(t){return t&&t.afterFloatingFilter},e.prototype.isEventFromDataChange=function(t){return null===t||void 0===t?void 0:t.afterDataChange},e.prototype.getLastType=function(){return this.lastType},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.setLastTypeFromModel=function(t){if(t){var e;if(t.operator)e=t.conditions[0];else e=t;this.lastType=e.type}else this.lastType=this.optionsFactory.getDefaultOption()},e.prototype.canWeEditAfterModelFromParentFilter=function(t){if(!t)return this.isTypeEditable(this.lastType);if(t.operator)return!1;var e=t;return this.isTypeEditable(e.type)},e.prototype.init=function(t){this.setSimpleParams(t)},e.prototype.setSimpleParams=function(t){this.optionsFactory=new Lr,this.optionsFactory.init(t.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!t.filterParams.readOnly;var e=this.isTypeEditable(this.lastType);this.setEditable(e)},e.prototype.onParamsUpdated=function(t){this.setSimpleParams(t)},e.prototype.doesFilterHaveSingleInput=function(t){var e=(this.optionsFactory.getCustomOption(t)||{}).numberOfInputs;return null==e||1==e},e.prototype.isTypeEditable=function(t){var e=[_i.IN_RANGE,_i.EMPTY,_i.BLANK,_i.NOT_BLANK];return!!t&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(t)&&e.indexOf(t)<0},e}(Tr),Ii=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ai=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Di=function(t){function e(){return t.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')||this}return Ii(e,t),e.prototype.getDefaultFilterOptions=function(){return Ri.DEFAULT_FILTER_OPTIONS},e.prototype.init=function(e){t.prototype.init.call(this,e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new Ti(this.filterParams,this.localeService,this.optionsFactory);var n=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(n("ariaDateFilterInput","Date Filter Input"))},e.prototype.onParamsUpdated=function(e){t.prototype.onParamsUpdated.call(this,e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams})},e.prototype.setEditable=function(t){po(this.eDateWrapper,t),po(this.eReadOnlyText.getGui(),!t)},e.prototype.onParentModelChanged=function(e,n){if(!this.isEventFromFloatingFilter(n)&&!this.isEventFromDataChange(n)){t.prototype.setLastTypeFromModel.call(this,e);var o=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(o),o){if(e){var r=e;this.dateComp.setDate(oo(r.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}},e.prototype.onDateChanged=function(){var t=this,e=to(this.dateComp.getDate());this.params.parentFilterInstance((function(n){if(n){var o=oo(e);n.onFloatingFilterChanged(t.getLastType()||null,o)}}))},e.prototype.getDateComponentParams=function(){var t=Xr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:k(this.onDateChanged.bind(this),t),filterParams:this.params.column.getColDef().filterParams}},e.prototype.createDateComponent=function(){var t=this;this.dateComp=new Mr(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper),this.addDestroyFunc((function(){return t.dateComp.destroy()}))},e.prototype.updateDateComponent=function(){var t=this.getDateComponentParams(),e=this.gridOptionsService,n=e.api,o=e.columnApi,r=e.context;t.api=n,t.columnApi=o,t.context=r,this.dateComp.updateParams(t)},e.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},Ai([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Ai([Or("eReadOnlyText")],e.prototype,"eReadOnlyText",void 0),Ai([Or("eDateWrapper")],e.prototype,"eDateWrapper",void 0),e}(Pi),Mi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Li=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ni=function(t){function e(){return t.call(this,'\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')||this}return Mi(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){var e=this;this.params=t,this.setParams(t);var n=this.gridOptionsService.getDocument(),o=this.eDateInput.getInputElement();this.addManagedListener(o,"mousedown",(function(){e.eDateInput.isDisabled()||e.usingSafariDatePicker||o.focus()})),this.addManagedListener(o,"input",(function(t){t.target===n.activeElement&&(e.eDateInput.isDisabled()||e.params.onDateChanged())}))},e.prototype.setParams=function(t){var e=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(t);this.usingSafariDatePicker=n&&Ln(),e.type=n?"date":"text";var o=t.filterParams||{},r=o.minValidYear,i=o.maxValidYear;r&&(e.min=r+"-01-01"),i&&(e.max=i+"-12-31")},e.prototype.onParamsUpdated=function(t){this.params=t,this.setParams(t)},e.prototype.getDate=function(){return oo(this.eDateInput.getValue())},e.prototype.setDate=function(t){this.eDateInput.setValue(to(t,!1))},e.prototype.setInputPlaceholder=function(t){this.eDateInput.setInputPlaceholder(t)},e.prototype.setDisabled=function(t){this.eDateInput.setDisabled(t)},e.prototype.afterGuiAttached=function(t){t&&t.suppressFocus||this.eDateInput.getInputElement().focus()},e.prototype.shouldUseBrowserDatePicker=function(t){return t.filterParams&&null!=t.filterParams.browserDatePicker?t.filterParams.browserDatePicker:Fn()||kn()||Ln()&&Nn()>=14.1},Li([Or("eDateInput")],e.prototype,"eDateInput",void 0),e}(Tr),Fi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ki=function(t){function e(e,n,o){return void 0===n&&(n="ag-text-field"),void 0===o&&(o="text"),t.call(this,e,n,o)||this}return Fi(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.config.allowedCharPattern&&this.preventDisallowedCharacters()},e.prototype.setValue=function(e,n){return this.eInput.value!==e&&(this.eInput.value=r(e)?e:""),t.prototype.setValue.call(this,e,n)},e.prototype.setStartValue=function(t){this.setValue(t,!0)},e.prototype.preventDisallowedCharacters=function(){var t=new RegExp("["+this.config.allowedCharPattern+"]");this.addManagedListener(this.eInput,"keydown",(function(e){$o(e)&&e.key&&!t.test(e.key)&&e.preventDefault()})),this.addManagedListener(this.eInput,"paste",(function(e){var n,o=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text");o&&o.split("").some((function(e){return!t.test(e)}))&&e.preventDefault()}))},e}(ci),Gi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bi=function(t){function e(e){return t.call(this,e,"ag-number-field","number")||this}return Gi(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"blur",(function(){var t=parseFloat(e.eInput.value),n=isNaN(t)?"":e.normalizeValue(t.toString());e.value!==n&&e.setValue(n)})),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"},e.prototype.onWheel=function(t){document.activeElement===this.eInput&&t.preventDefault()},e.prototype.normalizeValue=function(t){if(""===t)return"";null!=this.precision&&(t=this.adjustPrecision(t));var e=parseFloat(t);return null!=this.min&&e<this.min?t=this.min.toString():null!=this.max&&e>this.max&&(t=this.max.toString()),t},e.prototype.adjustPrecision=function(t,e){if(null==this.precision)return t;if(e){var n=parseFloat(t).toFixed(this.precision);return parseFloat(n).toString()}var o=String(t).split(".");if(o.length>1){if(o[1].length<=this.precision)return t;if(this.precision>0)return o[0]+"."+o[1].slice(0,this.precision)}return o[0]},e.prototype.setMin=function(t){return this.min===t||(this.min=t,Uo(this.eInput,"min",t)),this},e.prototype.setMax=function(t){return this.max===t||(this.max=t,Uo(this.eInput,"max",t)),this},e.prototype.setPrecision=function(t){return this.precision=t,this},e.prototype.setStep=function(t){return this.step===t||(this.step=t,Uo(this.eInput,"step",t)),this},e.prototype.setValue=function(e,n){var o=this;return this.setValueOrInputValue((function(e){return t.prototype.setValue.call(o,e,n)}),(function(){return o}),e)},e.prototype.setStartValue=function(e){var n=this;return this.setValueOrInputValue((function(e){return t.prototype.setValue.call(n,e,!0)}),(function(t){n.eInput.value=t}),e)},e.prototype.setValueOrInputValue=function(t,e,n){if(r(n)){var o=this.isScientificNotation(n);if(o&&this.eInput.validity.valid)return t(n);if(!o)o=(n=this.adjustPrecision(n))!=this.normalizeValue(n);if(o)return e(n)}return t(n)},e.prototype.getValue=function(){if(this.eInput.validity.valid){var e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):t.prototype.getValue.call(this)}},e.prototype.isScientificNotation=function(t){return"string"===typeof t&&t.includes("e")},e}(ki),Vi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vi(e,t),e.prototype.conditionToString=function(t,e){var n=(e||{}).numberOfInputs;return t.type==_i.IN_RANGE||2===n?this.formatValue(t.filter)+"-"+this.formatValue(t.filterTo):null!=t.filter?this.formatValue(t.filter):""+t.type},e}(vi);function ji(t){var e=(null!==t&&void 0!==t?t:{}).allowedCharPattern;return null!==e&&void 0!==e?e:null}var Hi,Ui,Wi,qi=function(t){function e(){var e=t.call(this,"numberFilter")||this;return e.eValuesFrom=[],e.eValuesTo=[],e}return Vi(e,t),e.prototype.mapValuesFromModel=function(t){var e=t||{},n=e.filter,o=e.filterTo,r=e.type;return[this.processValue(n),this.processValue(o)].slice(0,this.getNumberOfInputs(r))},e.prototype.getDefaultDebounceMs=function(){return 500},e.prototype.comparator=function(){return function(t,e){return t===e?0:t<e?1:-1}},e.prototype.setParams=function(e){this.numberFilterParams=e,t.prototype.setParams.call(this,e),this.filterModelFormatter=new zi(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)},e.prototype.getDefaultFilterOptions=function(){return e.DEFAULT_FILTER_OPTIONS},e.prototype.setElementValue=function(e,n){var o=this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(null!==n&&void 0!==n?n:null):n;t.prototype.setElementValue.call(this,e,o)},e.prototype.createValueElement=function(){var t=ji(this.numberFilterParams),e=document.createElement("div");return e.classList.add("ag-filter-body"),Ze(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from",t),this.createFromToElement(e,this.eValuesTo,"to",t),e},e.prototype.createFromToElement=function(t,e,n,o){var r=this.createManagedBean(o?new ki({allowedCharPattern:o}):new Bi);r.addCssClass("ag-filter-"+n),r.addCssClass("ag-filter-filter"),e.push(r),t.appendChild(r.getGui())},e.prototype.removeValueElements=function(t,e){this.removeComponents(this.eValuesFrom,t,e),this.removeComponents(this.eValuesTo,t,e)},e.prototype.getValues=function(t){var e=this,n=[];return this.forEachPositionInput(t,(function(t,o,r,i){o<i&&n.push(e.processValue(e.stringToFloat(t.getValue())))})),n},e.prototype.areSimpleModelsEqual=function(t,e){return t.filter===e.filter&&t.filterTo===e.filterTo&&t.type===e.type},e.prototype.getFilterType=function(){return"number"},e.prototype.processValue=function(t){return null==t||isNaN(t)?null:t},e.prototype.stringToFloat=function(t){if("number"===typeof t)return t;var e=o(t);return null!=e&&""===e.trim()&&(e=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(e):null==e||"-"===e.trim()?null:parseFloat(e)},e.prototype.createCondition=function(t){var e=this.getConditionType(t),n={filterType:this.getFilterType(),type:e},o=this.getValues(t);return o.length>0&&(n.filter=o[0]),o.length>1&&(n.filterTo=o[1]),n},e.prototype.getInputs=function(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]},e.prototype.getModelAsString=function(t){var e;return null!==(e=this.filterModelFormatter.getModelAsString(t))&&void 0!==e?e:""},e.prototype.hasInvalidInputs=function(){var t=!1;return this.forEachInput((function(e){e.getInputElement().validity.valid||(t=!0)})),t},e.DEFAULT_FILTER_OPTIONS=[wi.EQUALS,wi.NOT_EQUAL,wi.LESS_THAN,wi.LESS_THAN_OR_EQUAL,wi.GREATER_THAN,wi.GREATER_THAN_OR_EQUAL,wi.IN_RANGE,wi.BLANK,wi.NOT_BLANK],e}(wi),Xi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yi=function(){return Yi=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Yi.apply(this,arguments)},Ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xi(e,t),e.prototype.conditionToString=function(t,e){var n=(e||{}).numberOfInputs;return t.type==_i.IN_RANGE||2===n?t.filter+"-"+t.filterTo:null!=t.filter?""+t.filter:""+t.type},e}(vi),Zi=function(t){function e(){var e=t.call(this,"textFilter")||this;return e.eValuesFrom=[],e.eValuesTo=[],e}return Xi(e,t),e.trimInput=function(t){var e=t&&t.trim();return""===e?t:e},e.prototype.getDefaultDebounceMs=function(){return 500},e.prototype.setParams=function(n){this.textFilterParams=n,t.prototype.setParams.call(this,n),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?e.DEFAULT_FORMATTER:e.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new Ki(this.localeService,this.optionsFactory)},e.prototype.getTextMatcher=function(){var t=this.textFilterParams.textCustomComparator;return t?(hr.doOnce((function(){return console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead.")}),"textCustomComparator.deprecated"),function(e){var n=e.filterOption,o=e.value,r=e.filterText;return t(n,o,r)}):this.textFilterParams.textMatcher||e.DEFAULT_MATCHER},e.prototype.createCondition=function(t){var e=this.getConditionType(t),n={filterType:this.getFilterType(),type:e},o=this.getValuesWithSideEffects(t,!0);return o.length>0&&(n.filter=o[0]),o.length>1&&(n.filterTo=o[1]),n},e.prototype.getFilterType=function(){return"text"},e.prototype.areSimpleModelsEqual=function(t,e){return t.filter===e.filter&&t.filterTo===e.filterTo&&t.type===e.type},e.prototype.getInputs=function(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]},e.prototype.getValues=function(t){return this.getValuesWithSideEffects(t,!1)},e.prototype.getValuesWithSideEffects=function(t,n){var r=this,i=[];return this.forEachPositionInput(t,(function(t,s,a,l){var u;if(s<l){var c=o(t.getValue());n&&r.textFilterParams.trimInput&&(c=null!==(u=e.trimInput(c))&&void 0!==u?u:null,t.setValue(c,!0)),i.push(c)}})),i},e.prototype.getDefaultFilterOptions=function(){return e.DEFAULT_FILTER_OPTIONS},e.prototype.createValueElement=function(){var t=document.createElement("div");return t.classList.add("ag-filter-body"),Ze(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from"),this.createFromToElement(t,this.eValuesTo,"to"),t},e.prototype.createFromToElement=function(t,e,n){var o=this.createManagedBean(new ki);o.addCssClass("ag-filter-"+n),o.addCssClass("ag-filter-filter"),e.push(o),t.appendChild(o.getGui())},e.prototype.removeValueElements=function(t,e){this.removeComponents(this.eValuesFrom,t,e),this.removeComponents(this.eValuesTo,t,e)},e.prototype.mapValuesFromModel=function(t){var e=t||{},n=e.filter,o=e.filterTo,r=e.type;return[n||null,o||null].slice(0,this.getNumberOfInputs(r))},e.prototype.evaluateNullValue=function(t){var e=[_i.NOT_EQUAL,_i.NOT_CONTAINS,_i.BLANK];return!!t&&e.indexOf(t)>=0},e.prototype.evaluateNonNullValue=function(t,e,n,o){var r=this,i=t.map((function(t){return r.formatter(t)}))||[],s=this.formatter(e),a=this.textFilterParams,l=a.api,u=a.colDef,c=a.column,p=a.columnApi,h=a.context,d=a.textFormatter;if(n.type===_i.BLANK)return this.isBlank(e);if(n.type===_i.NOT_BLANK)return!this.isBlank(e);var f={api:l,colDef:u,column:c,columnApi:p,context:h,node:o.node,data:o.data,filterOption:n.type,value:s,textFormatter:d};return i.some((function(t){return r.matcher(Yi(Yi({},f),{filterText:t}))}))},e.prototype.getModelAsString=function(t){var e;return null!==(e=this.filterModelFormatter.getModelAsString(t))&&void 0!==e?e:""},e.DEFAULT_FILTER_OPTIONS=[_i.CONTAINS,_i.NOT_CONTAINS,_i.EQUALS,_i.NOT_EQUAL,_i.STARTS_WITH,_i.ENDS_WITH,_i.BLANK,_i.NOT_BLANK],e.DEFAULT_FORMATTER=function(t){return t},e.DEFAULT_LOWERCASE_FORMATTER=function(t){return null==t?null:t.toString().toLowerCase()},e.DEFAULT_MATCHER=function(t){var n=t.filterOption,o=t.value,r=t.filterText;if(null==r)return!1;switch(n){case e.CONTAINS:return o.indexOf(r)>=0;case e.NOT_CONTAINS:return o.indexOf(r)<0;case e.EQUALS:return o===r;case e.NOT_EQUAL:return o!=r;case e.STARTS_WITH:return 0===o.indexOf(r);case e.ENDS_WITH:var i=o.lastIndexOf(r);return i>=0&&i===o.length-r.length;default:return!1}},e}(_i),Ji=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qi=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$i=function(t){function e(e){var n=t.call(this)||this;return n.params=e,n.valueChangedListener=function(){},n}return Ji(e,t),e.prototype.setupGui=function(t){var e,n=this;this.eFloatingFilterTextInput=this.createManagedBean(new ki(null===(e=this.params)||void 0===e?void 0:e.config));var o=this.eFloatingFilterTextInput.getGui();t.appendChild(o),this.addManagedListener(o,"input",(function(t){return n.valueChangedListener(t)})),this.addManagedListener(o,"keydown",(function(t){return n.valueChangedListener(t)}))},e.prototype.setEditable=function(t){this.eFloatingFilterTextInput.setDisabled(!t)},e.prototype.setAutoComplete=function(t){this.eFloatingFilterTextInput.setAutoComplete(t)},e.prototype.getValue=function(){return this.eFloatingFilterTextInput.getValue()},e.prototype.setValue=function(t,e){this.eFloatingFilterTextInput.setValue(t,e)},e.prototype.setValueChangedListener=function(t){this.valueChangedListener=t},e.prototype.setParams=function(t){this.setAriaLabel(t.ariaLabel),void 0!==t.autoComplete&&this.setAutoComplete(t.autoComplete)},e.prototype.setAriaLabel=function(t){this.eFloatingFilterTextInput.setInputAriaLabel(t)},e}(Ht),ts=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ji(e,t),e.prototype.postConstruct=function(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')},e.prototype.getDefaultDebounceMs=function(){return 500},e.prototype.onParentModelChanged=function(t,e){this.isEventFromFloatingFilter(e)||this.isEventFromDataChange(e)||(this.setLastTypeFromModel(t),this.setEditable(this.canWeEditAfterModelFromParentFilter(t)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(t)))},e.prototype.init=function(e){this.setupFloatingFilterInputService(e),t.prototype.init.call(this,e),this.setTextInputParams(e)},e.prototype.setupFloatingFilterInputService=function(t){this.floatingFilterInputService=this.createFloatingFilterInputService(t),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)},e.prototype.setTextInputParams=function(t){var e;this.params=t;var n=null!==(e=t.browserAutoComplete)&&void 0!==e&&e;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(t),autoComplete:n}),this.applyActive=Xr.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){var o=Xr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),r=k(this.syncUpWithParentFilter.bind(this),o);this.floatingFilterInputService.setValueChangedListener(r)}},e.prototype.onParamsUpdated=function(e){t.prototype.onParamsUpdated.call(this,e),this.setTextInputParams(e)},e.prototype.recreateFloatingFilterInputService=function(t){var e=this.floatingFilterInputService.getValue();So(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(t),this.floatingFilterInputService.setValue(e,!0)},e.prototype.getAriaLabel=function(t){return this.columnModel.getDisplayNameForColumn(t.column,"header",!0)+" "+this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")},e.prototype.syncUpWithParentFilter=function(t){var e=this,n=t.key===Qo.ENTER;if(!this.applyActive||n){var o=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(o=Zi.trimInput(o),this.floatingFilterInputService.setValue(o,!0)),this.params.parentFilterInstance((function(t){t&&t.onFloatingFilterChanged(e.getLastType()||null,o||null)}))}},e.prototype.setEditable=function(t){this.floatingFilterInputService.setEditable(t)},Qi([$("columnModel")],e.prototype,"columnModel",void 0),Qi([Or("eFloatingFilterInputContainer")],e.prototype,"eFloatingFilterInputContainer",void 0),Qi([Z],e.prototype,"postConstruct",null),e}(Pi),es=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ns=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueChangedListener=function(){},e.numberInputActive=!0,e}return es(e,t),e.prototype.setupGui=function(t){var e=this;this.eFloatingFilterNumberInput=this.createManagedBean(new Bi),this.eFloatingFilterTextInput=this.createManagedBean(new ki),this.eFloatingFilterTextInput.setDisabled(!0);var n=this.eFloatingFilterNumberInput.getGui(),o=this.eFloatingFilterTextInput.getGui();t.appendChild(n),t.appendChild(o),this.setupListeners(n,(function(t){return e.valueChangedListener(t)})),this.setupListeners(o,(function(t){return e.valueChangedListener(t)}))},e.prototype.setEditable=function(t){this.numberInputActive=t,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)},e.prototype.setAutoComplete=function(t){this.eFloatingFilterNumberInput.setAutoComplete(t),this.eFloatingFilterTextInput.setAutoComplete(t)},e.prototype.getValue=function(){return this.getActiveInputElement().getValue()},e.prototype.setValue=function(t,e){this.getActiveInputElement().setValue(t,e)},e.prototype.getActiveInputElement=function(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput},e.prototype.setValueChangedListener=function(t){this.valueChangedListener=t},e.prototype.setupListeners=function(t,e){this.addManagedListener(t,"input",e),this.addManagedListener(t,"keydown",e)},e.prototype.setParams=function(t){this.setAriaLabel(t.ariaLabel),void 0!==t.autoComplete&&this.setAutoComplete(t.autoComplete)},e.prototype.setAriaLabel=function(t){this.eFloatingFilterNumberInput.setInputAriaLabel(t),this.eFloatingFilterTextInput.setInputAriaLabel(t)},e}(Ht),os=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return es(e,t),e.prototype.init=function(e){var n;t.prototype.init.call(this,e),this.filterModelFormatter=new zi(this.localeService,this.optionsFactory,null===(n=e.filterParams)||void 0===n?void 0:n.numberFormatter)},e.prototype.onParamsUpdated=function(e){ji(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),t.prototype.onParamsUpdated.call(this,e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})},e.prototype.getDefaultFilterOptions=function(){return qi.DEFAULT_FILTER_OPTIONS},e.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},e.prototype.createFloatingFilterInputService=function(t){return this.allowedCharPattern=ji(t.filterParams),this.allowedCharPattern?this.createManagedBean(new $i({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new ns)},e}(ts),rs=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),is=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return rs(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.filterModelFormatter=new Ki(this.localeService,this.optionsFactory)},e.prototype.onParamsUpdated=function(e){t.prototype.onParamsUpdated.call(this,e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})},e.prototype.getDefaultFilterOptions=function(){return Zi.DEFAULT_FILTER_OPTIONS},e.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},e.prototype.createFloatingFilterInputService=function(){return this.createManagedBean(new $i)},e}(ts),ss=function(){function t(t,e){var n=this;void 0===e&&(e=!1),this.destroyFuncs=[],this.touching=!1,this.eventService=new st,this.eElement=t,this.preventMouseClick=e;var o=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",o,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",i,{passive:!1}),this.destroyFuncs.push((function(){n.eElement.removeEventListener("touchstart",o,{passive:!0}),n.eElement.removeEventListener("touchmove",r,{passive:!0}),n.eElement.removeEventListener("touchend",i,{passive:!1})}))}return t.prototype.getActiveTouch=function(t){for(var e=0;e<t.length;e++){if(t[e].identifier===this.touchStart.identifier)return t[e]}return null},t.prototype.addEventListener=function(t,e){this.eventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.eventService.removeEventListener(t,e)},t.prototype.onTouchStart=function(e){var n=this;if(!this.touching){this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;var o=this.touchStart;window.setTimeout((function(){var r=n.touchStart===o;if(n.touching&&r&&!n.moved){n.moved=!0;var i={type:t.EVENT_LONG_TAP,touchStart:n.touchStart,touchEvent:e};n.eventService.dispatchEvent(i)}}),500)}},t.prototype.onTouchMove=function(t){if(this.touching){var e=this.getActiveTouch(t.touches);if(e)!ir(e,this.touchStart,4)&&(this.moved=!0)}},t.prototype.onTouchEnd=function(e){if(this.touching){if(!this.moved){var n={type:t.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(n),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}},t.prototype.checkForDoubleTap=function(){var e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>t.DOUBLE_TAP_MILLIS){var n={type:t.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(n),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e},t.prototype.destroy=function(){this.destroyFuncs.forEach((function(t){return t()}))},t.EVENT_TAP="tap",t.EVENT_DOUBLE_TAP="doubleTap",t.EVENT_LONG_TAP="longTap",t.DOUBLE_TAP_MILLIS=500,t}(),as=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ls=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},us=function(t){function e(n){var o=t.call(this)||this;return n||o.setTemplate(e.TEMPLATE),o}return as(e,t),e.prototype.attachCustomElements=function(t,e,n,o,r){this.eSortOrder=t,this.eSortAsc=e,this.eSortDesc=n,this.eSortMixed=o,this.eSortNone=r},e.prototype.setupSort=function(t,e){var n=this;void 0===e&&(e=!1),this.column=t,this.suppressOrder=e,this.setupMultiSortIndicator(),!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,t),this.addInIcon("sortDescending",this.eSortDesc,t),this.addInIcon("sortUnSort",this.eSortNone,t),this.addManagedListener(this.eventService,Zt.EVENT_SORT_CHANGED,(function(){return n.onSortChanged()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return n.onSortChanged()})),this.onSortChanged())},e.prototype.addInIcon=function(t,e,n){if(null!=e){var o=Zo(t,this.gridOptionsService,n);o&&e.appendChild(o)}},e.prototype.onSortChanged=function(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()},e.prototype.updateIcons=function(){var t=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){var e="asc"===t;po(this.eSortAsc,e,{skipAriaHidden:!0})}if(this.eSortDesc){var n="desc"===t;po(this.eSortDesc,n,{skipAriaHidden:!0})}if(this.eSortNone){var o=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),r=null===t||void 0===t;po(this.eSortNone,!o&&r,{skipAriaHidden:!0})}},e.prototype.setupMultiSortIndicator=function(){var t=this;this.addInIcon("sortUnSort",this.eSortMixed,this.column);var e=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e&&(this.addManagedListener(this.eventService,Zt.EVENT_SORT_CHANGED,(function(){return t.updateMultiSortIndicator()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return t.updateMultiSortIndicator()})),this.updateMultiSortIndicator())},e.prototype.updateMultiSortIndicator=function(){if(this.eSortMixed){var t="mixed"===this.sortController.getDisplaySortForColumn(this.column);po(this.eSortMixed,t,{skipAriaHidden:!0})}},e.prototype.updateSortOrder=function(){var t,e=this;if(this.eSortOrder){var n=this.sortController.getColumnsWithSortingOrdered(),o=null!==(t=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==t?t:-1,r=n.some((function(t){var n;return null!==(n=e.sortController.getDisplaySortIndexForColumn(t))&&void 0!==n&&n})),i=o>=0&&r;po(this.eSortOrder,i,{skipAriaHidden:!0}),o>=0?this.eSortOrder.innerHTML=(o+1).toString():So(this.eSortOrder)}},e.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',ls([Or("eSortOrder")],e.prototype,"eSortOrder",void 0),ls([Or("eSortAsc")],e.prototype,"eSortAsc",void 0),ls([Or("eSortDesc")],e.prototype,"eSortDesc",void 0),ls([Or("eSortMixed")],e.prototype,"eSortMixed",void 0),ls([Or("eSortNone")],e.prototype,"eSortNone",void 0),ls([$("columnModel")],e.prototype,"columnModel",void 0),ls([$("sortController")],e.prototype,"sortController",void 0),e}(Tr),cs=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ps=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},hs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastMovingChanged=0,e}return cs(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.refresh=function(t){return this.params=t,this.workOutTemplate()==this.currentTemplate&&(this.workOutShowMenu()==this.currentShowMenu&&(this.workOutSort()==this.currentSort&&(this.setDisplayName(t),!0)))},e.prototype.workOutTemplate=function(){var t=mt(this.params.template,e.TEMPLATE);return t=t&&t.trim?t.trim():t},e.prototype.init=function(t){this.params=t,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(t.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(t)},e.prototype.setDisplayName=function(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;var e=re(this.currentDisplayName);this.eText&&(this.eText.innerHTML=e)}},e.prototype.setupIcons=function(t){this.addInIcon("menu",this.eMenu,t),this.addInIcon("filter",this.eFilter,t)},e.prototype.addInIcon=function(t,e,n){if(null!=e){var o=Zo(t,this.gridOptionsService,n);o&&e.appendChild(o)}},e.prototype.setupTap=function(){var t=this,e=this.gridOptionsService;if(!e.is("suppressTouch")){var n=new ss(this.getGui(),!0),o=e.is("suppressMenuHide"),i=o&&r(this.eMenu),s=i?new ss(this.eMenu,!0):n;if(this.params.enableMenu){var a=i?"EVENT_TAP":"EVENT_LONG_TAP";this.addManagedListener(s,ss[a],(function(n){e.api.showColumnMenuAfterMouseClick(t.params.column,n.touchStart)}))}if(this.params.enableSorting){this.addManagedListener(n,ss.EVENT_TAP,(function(e){var n=e.touchStart.target;o&&t.eMenu.contains(n)||t.sortController.progressSort(t.params.column,!1,"uiColumnSorted")}))}this.addDestroyFunc((function(){return n.destroy()})),i&&this.addDestroyFunc((function(){return s.destroy()}))}},e.prototype.workOutShowMenu=function(){var t=!this.gridOptionsService.is("suppressMenuHide"),e=Bn()&&t;return this.params.enableMenu&&!e},e.prototype.setMenu=function(){var t=this;if(this.eMenu)if(this.currentShowMenu=this.workOutShowMenu(),this.currentShowMenu){var e=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",(function(){return t.showMenu(t.eMenu)})),this.eMenu.classList.toggle("ag-header-menu-always-show",e)}else To(this.eMenu)},e.prototype.showMenu=function(t){t||(t=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,t,"columnMenu")},e.prototype.workOutSort=function(){return this.params.enableSorting},e.prototype.setupSort=function(){var t=this;if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new us(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),this.currentSort){var e="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,ht.EVENT_MOVING_CHANGED,(function(){t.lastMovingChanged=(new Date).getTime()})),this.eLabel&&this.addManagedListener(this.eLabel,"click",(function(n){var o=t.params.column.isMoving(),r=(new Date).getTime()-t.lastMovingChanged<50;if(!(o||r)){var i=e?n.ctrlKey||n.metaKey:n.shiftKey;t.params.progressSort(i)}}));var n=function(){if(t.addOrRemoveCssClass("ag-header-cell-sorted-asc",t.params.column.isSortAscending()),t.addOrRemoveCssClass("ag-header-cell-sorted-desc",t.params.column.isSortDescending()),t.addOrRemoveCssClass("ag-header-cell-sorted-none",t.params.column.isSortNone()),t.params.column.getColDef().showRowGroup){var e=t.columnModel.getSourceColumnsForGroupColumn(t.params.column),n=!(null===e||void 0===e?void 0:e.every((function(e){return t.params.column.getSort()==e.getSort()})));t.addOrRemoveCssClass("ag-header-cell-sorted-mixed",n)}};this.addManagedListener(this.eventService,Zt.EVENT_SORT_CHANGED,n),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,n)}},e.prototype.setupFilterIcon=function(){this.eFilter&&(this.addManagedListener(this.params.column,ht.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())},e.prototype.onFilterChanged=function(){var t=this.params.column.isFilterActive();po(this.eFilter,t,{skipAriaHidden:!0})},e.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',ps([$("sortController")],e.prototype,"sortController",void 0),ps([$("menuFactory")],e.prototype,"menuFactory",void 0),ps([$("columnModel")],e.prototype,"columnModel",void 0),ps([Or("eFilter")],e.prototype,"eFilter",void 0),ps([Or("eSortIndicator")],e.prototype,"eSortIndicator",void 0),ps([Or("eMenu")],e.prototype,"eMenu",void 0),ps([Or("eLabel")],e.prototype,"eLabel",void 0),ps([Or("eText")],e.prototype,"eText",void 0),ps([Or("eSortOrder")],e.prototype,"eSortOrder",void 0),ps([Or("eSortAsc")],e.prototype,"eSortAsc",void 0),ps([Or("eSortDesc")],e.prototype,"eSortDesc",void 0),ps([Or("eSortMixed")],e.prototype,"eSortMixed",void 0),ps([Or("eSortNone")],e.prototype,"eSortNone",void 0),e}(Tr),ds=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fs=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gs=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return ds(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){this.params=t,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()},e.prototype.checkWarnings=function(){if(this.params.template){P((function(){return console.warn("AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}),"HeaderGroupComp.templateNotSupported")}},e.prototype.setupExpandIcons=function(){var t=this;this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");var e=function(e){if(!Lt(e)){var n=!t.params.columnGroup.isExpanded();t.columnModel.setColumnGroupOpened(t.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")}};this.addTouchAndClickListeners(this.eCloseIcon,e),this.addTouchAndClickListeners(this.eOpenIcon,e);var n=function(t){Mt(t)};this.addManagedListener(this.eCloseIcon,"dblclick",n),this.addManagedListener(this.eOpenIcon,"dblclick",n),this.addManagedListener(this.getGui(),"dblclick",e),this.updateIconVisibility();var o=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(o,ft.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(o,ft.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))},e.prototype.addTouchAndClickListeners=function(t,e){var n=new ss(t,!0);this.addManagedListener(n,ss.EVENT_TAP,e),this.addDestroyFunc((function(){return n.destroy()})),this.addManagedListener(t,"click",e)},e.prototype.updateIconVisibility=function(){if(this.params.columnGroup.isExpandable()){var t=this.params.columnGroup.isExpanded();po(this.eOpenIcon,t),po(this.eCloseIcon,!t)}else po(this.eOpenIcon,!1),po(this.eCloseIcon,!1)},e.prototype.addInIcon=function(t,e){var n=Zo(t,this.gridOptionsService,null);n&&this.getRefElement(e).appendChild(n)},e.prototype.addGroupExpandIcon=function(){if(!this.params.columnGroup.isExpandable())return po(this.eOpenIcon,!1),void po(this.eCloseIcon,!1)},e.prototype.setupLabel=function(){var t,e=this.params,n=e.displayName,o=e.columnGroup;if(r(n)){var i=re(n);this.getRefElement("agLabel").innerHTML=i}this.addOrRemoveCssClass("ag-sticky-label",!(null===(t=o.getColGroupDef())||void 0===t?void 0:t.suppressStickyLabel))},e.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',fs([$("columnModel")],e.prototype,"columnModel",void 0),fs([Or("agOpened")],e.prototype,"eOpenIcon",void 0),fs([Or("agClosed")],e.prototype,"eCloseIcon",void 0),e}(Tr),ms=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ys=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ms(e,t),e.prototype.isPopup=function(){return!0},e.prototype.setParentComponent=function(e){e.addCssClass("ag-has-popup"),t.prototype.setParentComponent.call(this,e)},e.prototype.destroy=function(){var e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),t.prototype.destroy.call(this)},e}(Tr),vs=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_s=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Cs=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return vs(e,t),e.prototype.init=function(t){this.params=t,this.focusAfterAttached=t.cellStartedEdit,this.eTextArea.setMaxLength(t.maxLength||200).setCols(t.cols||60).setRows(t.rows||10),r(t.value,!0)&&this.eTextArea.setValue(t.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()},e.prototype.onKeyDown=function(t){var e=t.key;(e===Qo.LEFT||e===Qo.UP||e===Qo.RIGHT||e===Qo.DOWN||t.shiftKey&&e===Qo.ENTER)&&t.stopPropagation()},e.prototype.afterGuiAttached=function(){var t=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(t("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()},e.prototype.getValue=function(){var t=this.eTextArea.getValue();return r(t)||r(this.params.value)?this.params.parseValue(t):this.params.value},e.TEMPLATE='<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',_s([Or("eTextArea")],e.prototype,"eTextArea",void 0),e}(ys),ws=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),bs=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xs=function(t){function e(){var e=t.call(this,'<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>\n            </div>')||this;return e.startedByEnter=!1,e}return ws(e,t),e.prototype.init=function(t){var e=this;this.focusAfterAttached=t.cellStartedEdit;var n=t.values,o=t.value,r=t.eventKey;if(i(n))console.warn("AG Grid: no values found for select cellEditor");else{this.startedByEnter=null!=r&&r===Qo.ENTER;var s=!1;n.forEach((function(n){var r={value:n},i=e.valueFormatterService.formatValue(t.column,null,n),a=null!==i&&void 0!==i;r.text=a?i:n,e.eSelect.addOption(r),s=s||o===n})),s?this.eSelect.setValue(t.value,!0):t.values.length&&this.eSelect.setValue(t.values[0],!0),null!=t.valueListGap&&this.eSelect.setPickerGap(t.valueListGap),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,ai.EVENT_ITEM_SELECTED,(function(){return t.stopEditing()}))}},e.prototype.afterGuiAttached=function(){var t=this;this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout((function(){t.isAlive()&&t.eSelect.showPicker()}))},e.prototype.focusIn=function(){this.eSelect.getFocusableElement().focus()},e.prototype.getValue=function(){return this.eSelect.getValue()},e.prototype.isPopup=function(){return!1},bs([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),bs([Or("eSelect")],e.prototype,"eSelect",void 0),e}(ys),Es=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ss=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ts=function(t){function e(e){var n=t.call(this,'\n            <div class="ag-cell-edit-wrapper">\n                '+e.getTemplate()+"\n            </div>")||this;return n.cellEditorInput=e,n}return Es(e,t),e.prototype.init=function(t){this.params=t;var e,n=this.eInput;if(this.cellEditorInput.init(n,t),t.cellStartedEdit){this.focusAfterAttached=!0;var o=t.eventKey;o===Qo.BACKSPACE||t.eventKey===Qo.DELETE?e="":o&&1===o.length?e=o:(e=this.cellEditorInput.getStartValue(),o!==Qo.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,e=this.cellEditorInput.getStartValue();null!=e&&n.setStartValue(e),this.addManagedListener(n.getGui(),"keydown",(function(t){var e=t.key;e!==Qo.PAGE_UP&&e!==Qo.PAGE_DOWN||t.preventDefault()}))},e.prototype.afterGuiAttached=function(){var t,e,n=this.localeService.getLocaleTextFunc(),o=this.eInput;if(o.setInputAriaLabel(n("ariaInputEditor","Input Editor")),this.focusAfterAttached){Ln()||o.getFocusableElement().focus();var r=o.getInputElement();this.highlightAllOnFocus?r.select():null===(e=(t=this.cellEditorInput).setCaret)||void 0===e||e.call(t)}},e.prototype.focusIn=function(){var t=this.eInput,e=t.getFocusableElement(),n=t.getInputElement();e.focus(),n.select()},e.prototype.getValue=function(){return this.cellEditorInput.getValue()},e.prototype.isPopup=function(){return!1},Ss([Or("eInput")],e.prototype,"eInput",void 0),e}(ys),Rs=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Os=function(){function t(){}return t.prototype.getTemplate=function(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.maxLength&&t.setMaxLength(e.maxLength)},t.prototype.getValue=function(){var t=this.eInput.getValue();return r(t)||r(this.params.value)?this.params.parseValue(t):this.params.value},t.prototype.getStartValue=function(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value},t.prototype.setCaret=function(){var t=this.eInput.getValue(),e=r(t)&&t.length||0;e&&this.eInput.getInputElement().setSelectionRange(e,e)},t}(),Ps=function(t){function e(){return t.call(this,new Os)||this}return Rs(e,t),e}(Ts),Is=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),As=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ds=function(t){function e(){var n=t.call(this,e.TEMPLATE)||this;return n.refreshCount=0,n}return Is(e,t),e.prototype.init=function(t){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(t)},e.prototype.showDelta=function(t,e){var n=Math.abs(e),o=t.formatValue(n),i=r(o)?o:n,s=e>=0;this.eDelta.innerHTML=s?"\u2191"+i:"\u2193"+i,this.eDelta.classList.toggle("ag-value-change-delta-up",s),this.eDelta.classList.toggle("ag-value-change-delta-down",!s)},e.prototype.setTimerToRemoveDelta=function(){var t=this;this.refreshCount++;var e=this.refreshCount;window.setTimeout((function(){e===t.refreshCount&&t.hideDeltaValue()}),2e3)},e.prototype.hideDeltaValue=function(){this.eValue.classList.remove("ag-value-change-value-highlight"),So(this.eDelta)},e.prototype.refresh=function(t){var e=t.value;if(e===this.lastValue)return!1;if(r(t.valueFormatted)?this.eValue.innerHTML=t.valueFormatted:r(t.value)?this.eValue.innerHTML=e:So(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof e&&"number"===typeof this.lastValue){var n=e-this.lastValue;this.showDelta(t,n)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=e,!0},e.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',As([$("filterManager")],e.prototype,"filterManager",void 0),e}(Tr),Ms=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ls=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ns=function(t){function e(){var n=t.call(this,e.TEMPLATE)||this;return n.refreshCount=0,n.eCurrent=n.queryForHtmlElement(".ag-value-slide-current"),n}return Ms(e,t),e.prototype.init=function(t){this.refresh(t)},e.prototype.addSlideAnimation=function(){var t=this;this.refreshCount++;var e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=Oo('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout((function(){e===t.refreshCount&&t.ePrevious.classList.add("ag-value-slide-out-end")}),50),window.setTimeout((function(){e===t.refreshCount&&(t.getGui().removeChild(t.ePrevious),t.ePrevious=null)}),3e3)},e.prototype.refresh=function(t){var e=t.value;return i(e)&&(e=""),e!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=e,r(t.valueFormatted)?this.eCurrent.innerHTML=t.valueFormatted:r(t.value)?this.eCurrent.innerHTML=e:So(this.eCurrent),!0))},e.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',Ls([$("filterManager")],e.prototype,"filterManager",void 0),e}(Tr),Fs=function(){return Fs=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Fs.apply(this,arguments)},ks=function(){function t(e){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=t.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=e}return t.prototype.setData=function(t){this.setDataCommon(t,!1)},t.prototype.updateData=function(t){this.setDataCommon(t,!0)},t.prototype.setDataCommon=function(t,e){var n=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();var o=this.createDataChangedEvent(t,n,e);this.dispatchLocalEvent(o)},t.prototype.updateDataOnDetailNode=function(){this.detailNode&&(this.detailNode.data=this.data)},t.prototype.createDataChangedEvent=function(e,n,o){return{type:t.EVENT_DATA_CHANGED,node:this,oldData:n,newData:e,update:o}},t.prototype.createLocalRowEvent=function(t){return{type:t,node:this}},t.prototype.getRowIndexString=function(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()},t.prototype.createDaemonNode=function(){var e=new t(this.beans);return e.id=this.id,e.data=this.data,e.__daemon=!0,e.selected=this.selected,e.level=this.level,e},t.prototype.setDataAndId=function(t,e){var n=r(this.id)?this.createDaemonNode():null,o=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(e),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,n);var i=this.createDataChangedEvent(t,o,!1);this.dispatchLocalEvent(i)},t.prototype.checkRowSelectable=function(){var t=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!t||t(this))},t.prototype.setRowSelectable=function(e){if(this.selectable!==e&&(this.selectable=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_SELECTABLE_CHANGED)),this.beans.gridOptionsService.is("groupSelectsChildren"))){var n=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:null!==n&&void 0!==n&&n,source:"selectableChanged"})}},t.prototype.setId=function(e){var n=this.beans.gridOptionsService.getCallback("getRowId");if(n)if(this.data){var o=this.getGroupKeys(!0);this.id=n({data:this.data,parentKeys:o.length>0?o:void 0,level:this.level}),null!==this.id&&"string"===typeof this.id&&this.id.startsWith(t.ID_PREFIX_ROW_GROUP)&&console.error("AG Grid: Row IDs cannot start with "+t.ID_PREFIX_ROW_GROUP+", this is a reserved prefix for AG Grid's row grouping feature."),null!==this.id&&"string"!==typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=e},t.prototype.getGroupKeys=function(t){void 0===t&&(t=!1);var e=[],n=this;for(t&&(n=n.parent);n&&n.level>=0;)e.push(n.key),n=n.parent;return e.reverse(),e},t.prototype.isPixelInRange=function(t){return!(!r(this.rowTop)||!r(this.rowHeight))&&(t>=this.rowTop&&t<this.rowTop+this.rowHeight)},t.prototype.setFirstChild=function(e){this.firstChild!==e&&(this.firstChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_FIRST_CHILD_CHANGED)))},t.prototype.setLastChild=function(e){this.lastChild!==e&&(this.lastChild=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_LAST_CHILD_CHANGED)))},t.prototype.setChildIndex=function(e){this.childIndex!==e&&(this.childIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_CHILD_INDEX_CHANGED)))},t.prototype.setRowTop=function(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_TOP_CHANGED)),this.setDisplayed(null!==e))},t.prototype.clearRowTopAndRowIndex=function(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)},t.prototype.setDisplayed=function(e){this.displayed!==e&&(this.displayed=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_DISPLAYED_CHANGED)))},t.prototype.setDragging=function(e){this.dragging!==e&&(this.dragging=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_DRAGGING_CHANGED)))},t.prototype.setHighlighted=function(e){e!==this.highlighted&&(this.highlighted=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_HIGHLIGHT_CHANGED)))},t.prototype.setHovered=function(t){this.hovered!==t&&(this.hovered=t)},t.prototype.isHovered=function(){return this.hovered},t.prototype.setAllChildrenCount=function(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_ALL_CHILDREN_COUNT_CHANGED)))},t.prototype.setMaster=function(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_MASTER_CHANGED)))},t.prototype.setGroup=function(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_GROUP_CHANGED)))},t.prototype.setRowHeight=function(e,n){void 0===n&&(n=!1),this.rowHeight=e,this.rowHeightEstimated=n,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_HEIGHT_CHANGED))},t.prototype.setRowAutoHeight=function(t,e){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[e.getId()]=t,null!=t&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=k(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())},t.prototype.checkAutoHeights=function(){var t=this,e=!1,n=!0,o=0,r=this.__autoHeights;if(null!=r&&(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach((function(i){var s=r[i.getId()];if(null==s){if(!t.beans.columnModel.isColSpanActive())return void(e=!0);var a=[];switch(i.getPinned()){case"left":a=t.beans.columnModel.getDisplayedLeftColumnsForRow(t);break;case"right":a=t.beans.columnModel.getDisplayedRightColumnsForRow(t);break;case null:a=t.beans.columnModel.getViewportCenterColumnsForRow(t)}if(a.includes(i))return void(e=!0);s=-1}else n=!1;s>o&&(o=s)})),!e&&((n||o<10)&&(o=this.beans.gridOptionsService.getRowHeightForNode(this).height),o!=this.rowHeight))){this.setRowHeight(o);var i=this.beans.rowModel;i.onRowHeightChangedDebounced&&i.onRowHeightChangedDebounced()}},t.prototype.setRowIndex=function(e){this.rowIndex!==e&&(this.rowIndex=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_ROW_INDEX_CHANGED)))},t.prototype.setUiLevel=function(e){this.uiLevel!==e&&(this.uiLevel=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_UI_LEVEL_CHANGED)))},t.prototype.setExpanded=function(e,n){if(this.expanded!==e){this.expanded=e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_EXPANDED_CHANGED));var o=Object.assign({},this.createGlobalRowEvent(Zt.EVENT_ROW_GROUP_OPENED),{expanded:e,event:n||null});this.beans.rowNodeEventThrottle.dispatchExpanded(o),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}},t.prototype.createGlobalRowEvent=function(t){return{type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}},t.prototype.dispatchLocalEvent=function(t){this.eventService&&this.eventService.dispatchEvent(t)},t.prototype.setDataValue=function(t,e,n){var o=this,r=function(){var e;return"string"!==typeof t?t:null!==(e=o.beans.columnModel.getGridColumn(t))&&void 0!==e?e:o.beans.columnModel.getPrimaryColumn(t)}(),i=this.getValueFromValueService(r);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(r,i,e,n),!1;var s=this.beans.valueService.setValue(this,r,e,n);return this.dispatchCellChangedEvent(r,e,i),this.checkRowSelectable(),s},t.prototype.getValueFromValueService=function(t){var e=this.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.group&&this.expanded&&!this.footer&&!e,o=this.beans.gridOptionsService.is("groupIncludeFooter"),r=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),i=n&&o&&!r;return this.beans.valueService.getValue(t,this,!1,i)},t.prototype.dispatchEventForSaveValueReadOnly=function(t,e,n,o){var r={type:Zt.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:t,colDef:t.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:e,newValue:n,value:n,source:o};this.beans.eventService.dispatchEvent(r)},t.prototype.setGroupValue=function(t,e){var n=this.beans.columnModel.getGridColumn(t);i(this.groupData)&&(this.groupData={});var o=n.getColId(),r=this.groupData[o];r!==e&&(this.groupData[o]=e,this.dispatchCellChangedEvent(n,e,r))},t.prototype.setAggData=function(t){var e=this,n=w([this.aggData,t]),o=this.aggData;this.aggData=t,this.eventService&&n.forEach((function(t){var n=e.beans.columnModel.getGridColumn(t),r=e.aggData?e.aggData[t]:void 0,i=o?o[t]:void 0;e.dispatchCellChangedEvent(n,r,i)}))},t.prototype.updateHasChildren=function(){var e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){var n=this.beans.gridOptionsService.isTreeData(),o=this.beans.gridOptionsService.get("isServerSideGroup");e=!this.stub&&!this.footer&&(n?!!o&&o(this.data):!!this.group)}e!==this.__hasChildren&&(this.__hasChildren=!!e,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(t.EVENT_HAS_CHILDREN_CHANGED)))},t.prototype.hasChildren=function(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren},t.prototype.isEmptyRowGroupNode=function(){return this.group&&s(this.childrenAfterGroup)},t.prototype.dispatchCellChangedEvent=function(e,n,o){var r={type:t.EVENT_CELL_CHANGED,node:this,column:e,newValue:n,oldValue:o};this.dispatchLocalEvent(r)},t.prototype.resetQuickFilterAggregateText=function(){this.quickFilterAggregateText=null},t.prototype.isExpandable=function(){return!!(this.hasChildren()&&!this.footer||this.master)},t.prototype.isSelected=function(){return this.footer?this.sibling.isSelected():this.selected},t.prototype.depthFirstSearch=function(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach((function(e){return e.depthFirstSearch(t)})),t(this)},t.prototype.calculateSelectedFromChildren=function(){var t,e=!1,n=!1,o=!1;if(!(null===(t=this.childrenAfterGroup)||void 0===t?void 0:t.length))return this.selectable?this.selected:null;for(var r=0;r<this.childrenAfterGroup.length;r++){var i=this.childrenAfterGroup[r],s=i.isSelected();if(!i.selectable){var a=i.calculateSelectedFromChildren();if(null===a)continue;s=a}switch(s){case!0:e=!0;break;case!1:n=!0;break;default:o=!0}}return o||e&&n?void 0:!!e||!n&&(this.selectable?this.selected:null)},t.prototype.setSelectedInitialValue=function(t){this.selected=t},t.prototype.selectThisNode=function(e,n,o){void 0===o&&(o="api");var r=!this.selectable&&e,i=this.selected===e;if(r||i)return!1;this.selected=e,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(t.EVENT_ROW_SELECTED));var s=Fs(Fs({},this.createGlobalRowEvent(Zt.EVENT_ROW_SELECTED)),{event:n||null,source:o});return this.beans.eventService.dispatchEvent(s),!0},t.prototype.setSelected=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n="api"),"boolean"!==typeof n?this.setSelectedParams({newValue:t,clearSelection:e,rangeSelect:!1,source:n}):console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")},t.prototype.setSelectedParams=function(t){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(Fs(Fs({},t),{nodes:[this.footer?this.sibling:this]}))},t.prototype.isRowPinned=function(){return"top"===this.rowPinned||"bottom"===this.rowPinned},t.prototype.isParentOfNode=function(t){for(var e=this.parent;e;){if(e===t)return!0;e=e.parent}return!1},t.prototype.addEventListener=function(t,e){this.eventService||(this.eventService=new st),this.eventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.eventService&&(this.eventService.removeEventListener(t,e),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))},t.prototype.onMouseEnter=function(){this.dispatchLocalEvent(this.createLocalRowEvent(t.EVENT_MOUSE_ENTER))},t.prototype.onMouseLeave=function(){this.dispatchLocalEvent(this.createLocalRowEvent(t.EVENT_MOUSE_LEAVE))},t.prototype.getFirstChildOfFirstChild=function(t){for(var e=this,n=!0,o=!1,i=null;n&&!o;){var s=e.parent;r(s)&&e.firstChild?s.rowGroupColumn===t&&(o=!0,i=s):n=!1,e=s}return o?i:null},t.prototype.isFullWidthCell=function(){var t=this.beans.gridOptionsService.getCallback("isFullWidthRow");return!!t&&t({rowNode:this})},t.prototype.getRoute=function(){if(null!=this.key){for(var t=[],e=this;null!=e.key;)t.push(e.key),e=e.parent;return t.reverse()}},t.prototype.createFooter=function(){var e=this;if(!this.sibling){var n=new t(this.beans);Object.keys(this).forEach((function(t){n[t]=e[t]})),n.footer=!0,n.setRowTop(null),n.setRowIndex(null),n.oldRowTop=null,n.id="rowGroupFooter_"+this.id,n.sibling=this,this.sibling=n}},t.ID_PREFIX_ROW_GROUP="row-group-",t.ID_PREFIX_TOP_PINNED="t-",t.ID_PREFIX_BOTTOM_PINNED="b-",t.OBJECT_ID_SEQUENCE=0,t.EVENT_ROW_SELECTED="rowSelected",t.EVENT_DATA_CHANGED="dataChanged",t.EVENT_CELL_CHANGED="cellChanged",t.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",t.EVENT_MASTER_CHANGED="masterChanged",t.EVENT_GROUP_CHANGED="groupChanged",t.EVENT_MOUSE_ENTER="mouseEnter",t.EVENT_MOUSE_LEAVE="mouseLeave",t.EVENT_HEIGHT_CHANGED="heightChanged",t.EVENT_TOP_CHANGED="topChanged",t.EVENT_DISPLAYED_CHANGED="displayedChanged",t.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",t.EVENT_LAST_CHILD_CHANGED="lastChildChanged",t.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",t.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",t.EVENT_EXPANDED_CHANGED="expandedChanged",t.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",t.EVENT_SELECTABLE_CHANGED="selectableChanged",t.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",t.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",t.EVENT_DRAGGING_CHANGED="draggingChanged",t}(),Gs=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bs=function(){return Bs=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Bs.apply(this,arguments)},Vs=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},zs=function(t){function e(){return t.call(this,'\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return Gs(e,t),e.prototype.postConstruct=function(){this.eCheckbox.setPassive(!0),rn(this.eCheckbox.getInputElement(),"polite")},e.prototype.getCheckboxId=function(){return this.eCheckbox.getInputElement().id},e.prototype.onDataChanged=function(){this.onSelectionChanged()},e.prototype.onSelectableChanged=function(){this.showOrHideSelect()},e.prototype.onSelectionChanged=function(){var t=this.localeService.getLocaleTextFunc(),e=this.rowNode.isSelected(),n=En(t,e),o=t("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(e,!0),this.eCheckbox.setInputAriaLabel(o+" ("+n+")")},e.prototype.onClicked=function(t,e,n){return this.rowNode.setSelectedParams({newValue:t,rangeSelect:n.shiftKey,groupSelectsFiltered:e,event:n,source:"checkboxSelected"})},e.prototype.init=function(t){var e=this;if(this.rowNode=t.rowNode,this.column=t.column,this.overrides=t.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(t){Mt(t)})),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(t){Mt(t);var n=e.gridOptionsService.is("groupSelectsFiltered"),o=e.eCheckbox.getValue();e.shouldHandleIndeterminateState(o,n)?0===e.onClicked(!0,n,t||{})&&e.onClicked(!1,n,t):o?e.onClicked(!1,n,t):e.onClicked(!0,n,t||{})})),this.addManagedListener(this.rowNode,ks.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsService.get("isRowSelectable")||"function"===typeof this.getIsVisible()){var n=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,n),this.addManagedListener(this.rowNode,ks.EVENT_DATA_CHANGED,n),this.addManagedListener(this.rowNode,ks.EVENT_CELL_CHANGED,n),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")},e.prototype.shouldHandleIndeterminateState=function(t,e){return e&&(void 0===this.eCheckbox.getPreviousValue()||void 0===t)&&this.gridOptionsService.isRowModelType("clientSide")},e.prototype.showOrHideSelect=function(){var t,e,n,o,r=this.rowNode.selectable,i=this.getIsVisible();if(r)if("function"===typeof i){var s=null===(t=this.overrides)||void 0===t?void 0:t.callbackParams,a=null===(e=this.column)||void 0===e?void 0:e.createColumnFunctionCallbackParams(this.rowNode);r=!!a&&i(Bs(Bs({},s),a))}else r=null!==i&&void 0!==i&&i;if(null===(n=this.column)||void 0===n?void 0:n.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!r),this.setVisible(!0),void this.setDisplayed(!0);(null===(o=this.overrides)||void 0===o?void 0:o.removeHidden)?this.setDisplayed(r):this.setVisible(r)},e.prototype.getIsVisible=function(){var t,e;return this.overrides?this.overrides.isVisible:null===(e=null===(t=this.column)||void 0===t?void 0:t.getColDef())||void 0===e?void 0:e.checkboxSelection},Vs([Or("eCheckbox")],e.prototype,"eCheckbox",void 0),Vs([Z],e.prototype,"postConstruct",null),e}(Tr),js=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hs=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Us=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(t){t[t.ToolPanel=0]="ToolPanel",t[t.HeaderCell=1]="HeaderCell",t[t.RowDrag=2]="RowDrag",t[t.ChartPanel=3]="ChartPanel"}(Hi||(Hi={})),function(t){t[t.Up=0]="Up",t[t.Down=1]="Down"}(Ui||(Ui={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(Wi||(Wi={}));var Ws,qs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragSourceAndParamsList=[],e.dropTargets=[],e}var n;return js(e,t),n=e,e.prototype.init=function(){this.ePinnedIcon=Ko("columnMovePin",this.gridOptionsService,null),this.eHideIcon=Ko("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=Ko("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=Ko("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=Ko("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=Ko("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=Ko("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=Ko("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=Ko("dropNotAllowed",this.gridOptionsService,null)},e.prototype.addDragSource=function(t,e){void 0===e&&(e=!1);var n={eElement:t.eElement,dragStartPixels:t.dragStartPixels,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:e};this.dragSourceAndParamsList.push({params:n,dragSource:t}),this.dragService.addDragSource(n)},e.prototype.removeDragSource=function(t){var e=this.dragSourceAndParamsList.find((function(e){return e.dragSource===t}));e&&(this.dragService.removeDragSource(e.params),wt(this.dragSourceAndParamsList,e))},e.prototype.clearDragSourceParamsList=function(){var t=this;this.dragSourceAndParamsList.forEach((function(e){return t.dragService.removeDragSource(e.params)})),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0},e.prototype.nudge=function(){this.dragging&&this.onDragging(this.eventLastTime,!0)},e.prototype.onDragStart=function(t,e){this.dragging=!0,this.dragSource=t,this.eventLastTime=e,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()},e.prototype.onDragStop=function(t){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var e=this.createDropTargetEvent(this.lastDropTarget,t,null,null,!1);this.lastDropTarget.onDragStop(e)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()},e.prototype.onDragging=function(t,e){var n,o,r,i,s=this,a=this.getHorizontalDirection(t),l=this.getVerticalDirection(t);this.eventLastTime=t,this.positionGhost(t);var u=this.dropTargets.filter((function(e){return s.isMouseOnDropTarget(t,e)})),c=this.findCurrentDropTarget(t,u);if(c!==this.lastDropTarget)this.leaveLastTargetIfExists(t,a,l,e),null!==this.lastDropTarget&&null===c&&(null===(o=(n=this.dragSource).onGridExit)||void 0===o||o.call(n,this.dragItem)),null===this.lastDropTarget&&null!==c&&(null===(i=(r=this.dragSource).onGridEnter)||void 0===i||i.call(r,this.dragItem)),this.enterDragTargetIfExists(c,t,a,l,e),this.lastDropTarget=c;else if(c&&c.onDragging){var p=this.createDropTargetEvent(c,t,a,l,e);c.onDragging(p)}},e.prototype.getAllContainersFromDropTarget=function(t){var e=t.getSecondaryContainers?t.getSecondaryContainers():null,n=[[t.getContainer()]];return e?n.concat(e):n},e.prototype.allContainersIntersect=function(t,e){var n,o;try{for(var r=Us(e),i=r.next();!i.done;i=r.next()){var s=i.value.getBoundingClientRect();if(0===s.width||0===s.height)return!1;var a=t.clientX>=s.left&&t.clientX<s.right,l=t.clientY>=s.top&&t.clientY<s.bottom;if(!a||!l)return!1}}catch(u){n={error:u}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return!0},e.prototype.isMouseOnDropTarget=function(t,e){var n,o,r=this.getAllContainersFromDropTarget(e),i=!1;try{for(var s=Us(r),a=s.next();!a.done;a=s.next()){var l=a.value;if(this.allContainersIntersect(t,l)){i=!0;break}}}catch(u){n={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return!(e.targetContainsSource&&!e.getContainer().contains(this.dragSource.eElement))&&(i&&e.isInterestedIn(this.dragSource.type,this.dragSource.eElement))},e.prototype.findCurrentDropTarget=function(t,e){var n,o,r,i,s=e.length;if(0===s)return null;if(1===s)return e[0];var a=this.gridOptionsService.getRootNode().elementsFromPoint(t.clientX,t.clientY);try{for(var l=Us(a),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var p=(r=void 0,Us(e)),h=p.next();!h.done;h=p.next()){var d=h.value;if(-1!==Rt(this.getAllContainersFromDropTarget(d)).indexOf(c))return d}}catch(f){r={error:f}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}}}catch(g){n={error:g}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return null},e.prototype.enterDragTargetIfExists=function(t,e,n,o,r){if(t){if(t.onDragEnter){var i=this.createDropTargetEvent(t,e,n,o,r);t.onDragEnter(i)}this.setGhostIcon(t.getIconName?t.getIconName():null)}},e.prototype.leaveLastTargetIfExists=function(t,e,n,o){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){var r=this.createDropTargetEvent(this.lastDropTarget,t,e,n,o);this.lastDropTarget.onDragLeave(r)}this.setGhostIcon(null)}},e.prototype.addDropTarget=function(t){this.dropTargets.push(t)},e.prototype.removeDropTarget=function(t){this.dropTargets=this.dropTargets.filter((function(e){return e.getContainer()!==t.getContainer()}))},e.prototype.hasExternalDropZones=function(){return this.dropTargets.some((function(t){return t.external}))},e.prototype.findExternalZone=function(t){return this.dropTargets.filter((function(t){return t.external})).find((function(e){return e.getContainer()===t.getContainer()}))||null},e.prototype.getHorizontalDirection=function(t){var e=this.eventLastTime&&this.eventLastTime.clientX,n=t.clientX;return e===n?null:e>n?Wi.Left:Wi.Right},e.prototype.getVerticalDirection=function(t){var e=this.eventLastTime&&this.eventLastTime.clientY,n=t.clientY;return e===n?null:e>n?Ui.Up:Ui.Down},e.prototype.createDropTargetEvent=function(t,e,n,o,r){var i=t.getContainer(),s=i.getBoundingClientRect(),a=this,l=a.gridApi,u=a.columnApi,c=a.dragItem,p=a.dragSource;return{event:e,x:e.clientX-s.left,y:e.clientY-s.top,vDirection:o,hDirection:n,dragSource:p,fromNudge:r,dragItem:c,api:l,columnApi:u,dropZoneTarget:i}},e.prototype.positionGhost=function(t){var e=this.eGhost;if(e){var n=e.getBoundingClientRect().height,o=Hn()-2,r=Un()-2,i=wo(e.offsetParent),s=t.clientY,a=t.clientX,l=s-i.top-n/2,u=a-i.left-10,c=this.gridOptionsService.getDocument(),p=c.defaultView||window,h=p.pageYOffset||c.documentElement.scrollTop,d=p.pageXOffset||c.documentElement.scrollLeft;o>0&&u+e.clientWidth>o+d&&(u=o+d-e.clientWidth),u<0&&(u=0),r>0&&l+e.clientHeight>r+h&&(l=r+h-e.clientHeight),l<0&&(l=0),e.style.left=u+"px",e.style.top=l+"px"}},e.prototype.removeGhost=function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null},e.prototype.createGhost=function(){this.eGhost=Oo(n.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);var t=this.environment.getTheme().theme;t&&this.eGhost.classList.add(t),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);var e=this.eGhost.querySelector(".ag-dnd-ghost-label"),o=this.dragSource.dragItemName;A(o)&&(o=o()),e.innerHTML=re(o)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var r=this.gridOptionsService.getDocument(),i=null;try{i=r.fullscreenElement}catch(l){}finally{if(!i){var s=this.gridOptionsService.getRootNode(),a=s.querySelector("body");i=a||(s instanceof ShadowRoot?s:null===s||void 0===s?void 0:s.documentElement)}}this.eGhostParent=i,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")},e.prototype.setGhostIcon=function(t,e){void 0===e&&(e=!1),So(this.eGhostIcon);var o=null;switch(t||(t=this.dragSource.defaultIconName||n.ICON_NOT_ALLOWED),t){case n.ICON_PINNED:o=this.ePinnedIcon;break;case n.ICON_MOVE:o=this.eMoveIcon;break;case n.ICON_LEFT:o=this.eLeftIcon;break;case n.ICON_RIGHT:o=this.eRightIcon;break;case n.ICON_GROUP:o=this.eGroupIcon;break;case n.ICON_AGGREGATE:o=this.eAggregateIcon;break;case n.ICON_PIVOT:o=this.ePivotIcon;break;case n.ICON_NOT_ALLOWED:o=this.eDropNotAllowedIcon;break;case n.ICON_HIDE:o=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",e),o===this.eHideIcon&&this.gridOptionsService.is("suppressDragLeaveHidesColumns")||o&&this.eGhostIcon.appendChild(o)},e.ICON_PINNED="pinned",e.ICON_MOVE="move",e.ICON_LEFT="left",e.ICON_RIGHT="right",e.ICON_GROUP="group",e.ICON_AGGREGATE="aggregate",e.ICON_PIVOT="pivot",e.ICON_NOT_ALLOWED="notAllowed",e.ICON_HIDE="hide",e.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',Hs([$("dragService")],e.prototype,"dragService",void 0),Hs([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Hs([$("columnApi")],e.prototype,"columnApi",void 0),Hs([$("gridApi")],e.prototype,"gridApi",void 0),Hs([Z],e.prototype,"init",null),Hs([J],e.prototype,"clearDragSourceParamsList",null),e=n=Hs([Q("dragAndDropService")],e)}(Ht),Xs=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ys=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ks=function(t){function e(e,n,o,r,i,s){var a=t.call(this)||this;return a.cellValueFn=e,a.rowNode=n,a.column=o,a.customGui=r,a.dragStartPixels=i,a.suppressVisibilityChange=s,a.dragSource=null,a}return Xs(e,t),e.prototype.isCustomGui=function(){return null!=this.customGui},e.prototype.postConstruct=function(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(Zo("rowDrag",this.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){var t=this.gridOptionsService.is("rowDragManaged")?new Qs(this,this.beans,this.rowNode,this.column):new Js(this,this.beans,this.rowNode,this.column);this.createManagedBean(t,this.beans.context)}},e.prototype.setDragElement=function(t,e){this.setTemplateFromElement(t),this.addDragSource(e)},e.prototype.getSelectedNodes=function(){if(!this.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];var t=this.beans.selectionService.getSelectedNodes();return-1!==t.indexOf(this.rowNode)?t:[this.rowNode]},e.prototype.checkCompatibility=function(){var t=this.gridOptionsService.is("rowDragManaged");this.gridOptionsService.isTreeData()&&t&&P((function(){return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true")}),"RowDragComp.managedAndTreeData")},e.prototype.getDragItem=function(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}},e.prototype.getRowDragText=function(t){if(t){var e=t.getColDef();if(e.rowDragText)return e.rowDragText}return this.gridOptionsService.get("rowDragText")},e.prototype.addDragSource=function(t){var e=this;void 0===t&&(t=4),this.dragSource&&this.removeDragSource();var n=this.getRowDragText(this.column),o=this.localeService.getLocaleTextFunc();this.dragSource={type:Hi.RowDrag,eElement:this.getGui(),dragItemName:function(){var t,r=e.getDragItem(),i=(null===(t=r.rowNodes)||void 0===t?void 0:t.length)||1;return n?n(r,i):1===i?e.cellValueFn():i+" "+o("rowDragRows","rows")},getDragItem:function(){return e.getDragItem()},dragStartPixels:t,dragSourceDomDataKey:this.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)},e.prototype.removeDragSource=function(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null},Ys([$("beans")],e.prototype,"beans",void 0),Ys([Z],e.prototype,"postConstruct",null),Ys([J],e.prototype,"removeDragSource",null),e}(Tr),Zs=function(t){function e(e,n,o){var r=t.call(this)||this;return r.parent=e,r.rowNode=n,r.column=o,r}return Xs(e,t),e.prototype.setDisplayedOrVisible=function(t){var e={skipAriaHidden:!0};if(t)this.parent.setDisplayed(!1,e);else{var n=!0,o=!1;this.column&&(n=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),o=A(this.column.getColDef().rowDrag)),o?(this.parent.setDisplayed(!0,e),this.parent.setVisible(n,e)):(this.parent.setDisplayed(n,e),this.parent.setVisible(!0,e))}},e}(Ht),Js=function(t){function e(e,n,o,r){var i=t.call(this,e,o,r)||this;return i.beans=n,i}return Xs(e,t),e.prototype.postConstruct=function(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()},e.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},e.prototype.workOutVisibility=function(){var t=this.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(t)},Ys([Z],e.prototype,"postConstruct",null),e}(Zs),Qs=function(t){function e(e,n,o,r){var i=t.call(this,e,o,r)||this;return i.beans=n,i}return Xs(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.beans.eventService,Zt.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Zt.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()},e.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},e.prototype.workOutVisibility=function(){var t=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),e=t&&t.shouldPreventRowMove(),n=this.gridOptionsService.is("suppressRowDrag"),o=this.beans.dragAndDropService.hasExternalDropZones(),r=e&&!o||n;this.setDisplayedOrVisible(r)},Ys([Z],e.prototype,"postConstruct",null),e}(Zs),$s=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ta=function(){return ta=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ta.apply(this,arguments)},ea=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},na=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $s(e,t),e.prototype.init=function(t,e,n,o,r,i,s){this.params=s,this.eGui=e,this.eCheckbox=n,this.eExpanded=o,this.eContracted=r,this.comp=t,this.compClass=i;var a=this.isTopLevelFooter(),l=this.isEmbeddedRowMismatch(),u=null==s.value&&!s.node.master,c=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){var p=s.node;if(p.footer)c=(s.colDef&&s.colDef.showRowGroup)!==(p.rowGroupColumn&&p.rowGroupColumn.getColId())}this.cellIsBlank=!a&&(l||u&&!s.node.master||c),this.cellIsBlank||(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.expandListener=null},e.prototype.refreshAriaExpanded=function(){var t=this.params,e=t.node,n=t.eParentOfValue;if(this.expandListener&&(this.expandListener=this.expandListener()),this.isExpandable()){var o=function(){un(n,!!e.expanded)};this.expandListener=this.addManagedListener(e,ks.EVENT_EXPANDED_CHANGED,o)||null,o()}else cn(n)},e.prototype.isTopLevelFooter=function(){if(!this.gridOptionsService.is("groupIncludeTotalFooter"))return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;var t=this.params.colDef;if(null==t)return!0;if(!0===t.showRowGroup)return!0;var e=this.columnModel.getRowGroupColumns();return!e||0===e.length||e[0].getId()===t.showRowGroup},e.prototype.isEmbeddedRowMismatch=function(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;var t="left"===this.params.pinned,e="right"===this.params.pinned,n=!t&&!e;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!e:!n:this.columnModel.isPinningLeft()?!t:!n},e.prototype.findDisplayedGroupNode=function(){var t=this.params.column,e=this.params.node;if(this.showingValueForOpenedParent)for(var n=e.parent;null!=n;){if(n.rowGroupColumn&&t.isRowGroupDisplayed(n.rowGroupColumn.getId())){this.displayedGroupNode=n;break}n=n.parent}i(this.displayedGroupNode)&&(this.displayedGroupNode=e)},e.prototype.setupShowingValueForOpenedParent=function(){var t=this.params.node,e=this.params.column;if(this.gridOptionsService.is("groupHideOpenParents"))if(t.groupData){if(null!=t.rowGroupColumn){var n=t.rowGroupColumn.getId();if(e.isRowGroupDisplayed(n))return void(this.showingValueForOpenedParent=!1)}var o=null!=t.groupData[e.getId()];this.showingValueForOpenedParent=o}else this.showingValueForOpenedParent=!1;else this.showingValueForOpenedParent=!1},e.prototype.addValueElement=function(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())},e.prototype.addGroupValue=function(){var t=this.adjustParamsWithDetailsFromRelatedColumn(),e=this.getInnerCompDetails(t),n=t.valueFormatted,o=t.value,r=n;null==r&&(r=""===o&&this.params.node.group?this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):null!==o&&void 0!==o?o:null);this.comp.setInnerRenderer(e,r)},e.prototype.adjustParamsWithDetailsFromRelatedColumn=function(){var t=this.displayedGroupNode.rowGroupColumn,e=this.params.column;if(!t)return this.params;if(null!=e&&!e.isRowGroupDisplayed(t.getId()))return this.params;var n=this.params,o=this.params,r=o.value,i=o.node,s=this.valueFormatterService.formatValue(t,i,r);return ta(ta({},n),{valueFormatted:s})},e.prototype.addFooterValue=function(){var t=this.params.footerValueGetter,e="";if(t){var n=m(this.params);n.value=this.params.value,"function"===typeof t?e=t(n):"string"===typeof t?e=this.expressionService.evaluate(t,n):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else e="Total "+(null!=this.params.value?this.params.value:"");var o=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(o,e)},e.prototype.getInnerCompDetails=function(t){var e=this;if(t.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),t);var n=this.userComponentFactory.getInnerRendererDetails(t,t),o=function(t){return t&&t.componentClass==e.compClass};if(n&&!o(n))return n;var r=this.displayedGroupNode.rowGroupColumn,i=r?r.getColDef():void 0;if(i){var s=this.userComponentFactory.getCellRendererDetails(i,t);if(s&&!o(s))return s;if(o(s)&&i.cellRendererParams&&i.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(i.cellRendererParams,t)}},e.prototype.addChildCount=function(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,ks.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())},e.prototype.updateChildCount=function(){var t=this.displayedGroupNode.allChildrenCount,e=this.isShowRowGroupForThisRow()&&null!=t&&t>=0?"("+t+")":"";this.comp.setChildCount(e)},e.prototype.isShowRowGroupForThisRow=function(){if(this.gridOptionsService.isTreeData())return!0;var t=this.displayedGroupNode.rowGroupColumn;if(!t)return!1;var e=this.params.column;return null==e||e.isRowGroupDisplayed(t.getId())},e.prototype.addExpandAndContract=function(){var t,e=this.params,n=Zo("groupExpanded",this.gridOptionsService,null),o=Zo("groupContracted",this.gridOptionsService,null);n&&this.eExpanded.appendChild(n),o&&this.eContracted.appendChild(o);var r=e.eGridCell;(null===(t=this.params.column)||void 0===t?void 0:t.isCellEditable(e.node))&&this.gridOptionsService.is("enableGroupEdit")||!this.isExpandable()||e.suppressDoubleClickExpand||this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(e.node,ks.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();var i=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,ks.EVENT_ALL_CHILDREN_COUNT_CHANGED,i),this.addManagedListener(this.displayedGroupNode,ks.EVENT_MASTER_CHANGED,i),this.addManagedListener(this.displayedGroupNode,ks.EVENT_GROUP_CHANGED,i),this.addManagedListener(this.displayedGroupNode,ks.EVENT_HAS_CHILDREN_CHANGED,i)},e.prototype.onExpandClicked=function(t){Lt(t)||(Mt(t),this.onExpandOrContract(t))},e.prototype.onExpandOrContract=function(t){var e=this.displayedGroupNode,n=!e.expanded;!n&&e.sticky&&this.scrollToStickyNode(e),e.setExpanded(n,t)},e.prototype.scrollToStickyNode=function(t){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(t.rowTop-t.stickyRowTop)},e.prototype.isExpandable=function(){if(this.showingValueForOpenedParent)return!0;var t=this.displayedGroupNode,e=this.columnModel.isPivotMode()&&t.leafGroup;if(!(t.isExpandable()&&!t.footer&&!e))return!1;var n=this.params.column;return null==n||"string"!==typeof n.getColDef().showRowGroup||this.isShowRowGroupForThisRow()},e.prototype.showExpandAndContractIcons=function(){var t=this,e=t.params,n=t.displayedGroupNode,o=t.columnModel,r=e.node,i=this.isExpandable();if(i){var s=!!this.showingValueForOpenedParent||r.expanded;this.comp.setExpandedDisplayed(s),this.comp.setContractedDisplayed(!s)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);var a=o.isPivotMode(),l=a&&n.leafGroup,u=i&&!l,c=r.footer&&-1===r.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",u),this.comp.addOrRemoveCssClass("ag-row-group",u),a?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",l):c||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!u)},e.prototype.onRowNodeIsExpandableChanged=function(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()},e.prototype.setupIndent=function(){var t=this.params.node;this.params.suppressPadding||(this.addManagedListener(t,ks.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())},e.prototype.setIndent=function(){if(!this.gridOptionsService.is("groupHideOpenParents")){var t=this.params,e=t.node,n=!!t.colDef,o=this.gridOptionsService.isTreeData(),r=!n||o||!0===t.colDef.showRowGroup?e.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+r,this.comp.addOrRemoveCssClass(this.indentClass,!0)}},e.prototype.addFullWidthRowDraggerIfNeeded=function(){var t=this;if(this.params.fullWidth&&this.params.rowDrag){var e=new Ks((function(){return t.params.value}),this.params.node);this.createManagedBean(e,this.context),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}},e.prototype.isUserWantsSelected=function(){var t=this.params.checkbox;return"function"===typeof t||!0===t},e.prototype.addCheckboxIfNeeded=function(){var t=this,e=this.displayedGroupNode,n=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(n){var o=new zs;this.getContext().createBean(o),o.init({rowNode:e,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(o.getGui()),this.addDestroyFunc((function(){return t.getContext().destroyBean(o)}))}this.comp.setCheckboxVisible(n)},e.prototype.onKeyDown=function(t){t.key!==Qo.ENTER||this.params.suppressEnterExpand||(this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(t))},e.prototype.onCellDblClicked=function(t){Lt(t)||(kt(this.eExpanded,t)||kt(this.eContracted,t)||this.onExpandOrContract(t))},ea([$("expressionService")],e.prototype,"expressionService",void 0),ea([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),ea([$("columnModel")],e.prototype,"columnModel",void 0),ea([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),ea([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e}(Ht),oa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ra=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ia=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return oa(e,t),e.prototype.init=function(t){var e=this,n={setInnerRenderer:function(t,n){return e.setRenderDetails(t,n)},setChildCount:function(t){return e.eChildCount.innerHTML=t},addOrRemoveCssClass:function(t,n){return e.addOrRemoveCssClass(t,n)},setContractedDisplayed:function(t){return po(e.eContracted,t)},setExpandedDisplayed:function(t){return po(e.eExpanded,t)},setCheckboxVisible:function(t){return e.eCheckbox.classList.toggle("ag-invisible",!t)}},o=this.createManagedBean(new na),r=!t.colDef,i=this.getGui();o.init(n,i,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,t),r&&Ze(i,"gridcell")},e.prototype.setRenderDetails=function(t,e){var n=this;if(t){var o=t.newAgStackInstance();if(!o)return;o.then((function(t){if(t){var e=function(){return n.context.destroyBean(t)};n.isAlive()?(n.eValue.appendChild(t.getGui()),n.addDestroyFunc(e)):e()}}))}else this.eValue.innerText=e},e.prototype.destroy=function(){this.getContext().destroyBean(this.innerCellRenderer),t.prototype.destroy.call(this)},e.prototype.refresh=function(){return!1},e.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',ra([Or("eExpanded")],e.prototype,"eExpanded",void 0),ra([Or("eContracted")],e.prototype,"eContracted",void 0),ra([Or("eCheckbox")],e.prototype,"eCheckbox",void 0),ra([Or("eValue")],e.prototype,"eValue",void 0),ra([Or("eChildCount")],e.prototype,"eChildCount",void 0),e}(Tr),sa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),aa=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},la=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return sa(e,t),e.prototype.init=function(t){t.node.failedLoad?this.setupFailed():this.setupLoading()},e.prototype.setupFailed=function(){var t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingError","ERR")},e.prototype.setupLoading=function(){var t=Zo("groupLoading",this.gridOptionsService,null);t&&this.eLoadingIcon.appendChild(t);var e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingOoo","Loading")},e.prototype.refresh=function(t){return!1},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',aa([Or("eLoadingIcon")],e.prototype,"eLoadingIcon",void 0),aa([Or("eLoadingText")],e.prototype,"eLoadingText",void 0),e}(Tr),ua=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ca=function(t){function e(){return t.call(this)||this}return ua(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){var n,o=null!==(n=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==n?n:e.DEFAULT_LOADING_OVERLAY_TEMPLATE,r=this.localeService.getLocaleTextFunc(),i=o.replace("[LOADING...]",r("loadingOoo","Loading..."));this.setTemplate(i)},e.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>',e}(Tr),pa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ha=function(t){function e(){return t.call(this)||this}return pa(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(t){var n,o=null!==(n=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==n?n:e.DEFAULT_NO_ROWS_TEMPLATE,r=this.localeService.getLocaleTextFunc(),i=o.replace("[NO_ROWS_TO_SHOW]",r("noRowsToShow","No Rows To Show"));this.setTemplate(i)},e.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>',e}(Tr),da=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fa=function(t){function e(){return t.call(this,'<div class="ag-tooltip"></div>')||this}return da(e,t),e.prototype.init=function(t){var e=t.value;this.getGui().innerHTML=re(e)},e}(ys),ga=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ma=function(){function t(){}return t.prototype.getTemplate=function(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.max&&t.setMax(e.max),null!=e.min&&t.setMin(e.min),null!=e.precision&&t.setPrecision(e.precision),null!=e.step&&t.setStep(e.step),e.showStepperButtons&&t.getInputElement().classList.add("ag-number-field-input-stepper")},t.prototype.getValue=function(){var t=this.eInput.getValue();if(!r(t)&&!r(this.params.value))return this.params.value;var e=this.params.parseValue(t);if(null==e)return e;if("string"===typeof e){if(""===e)return null;e=Number(e)}return isNaN(e)?null:e},t.prototype.getStartValue=function(){return this.params.value},t}(),ya=function(t){function e(){return t.call(this,new ma)||this}return ga(e,t),e}(Ts),va=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_a=function(){function t(){}return t.prototype.getTemplate=function(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.min&&t.setMin(e.min),null!=e.max&&t.setMax(e.max),null!=e.step&&t.setStep(e.step)},t.prototype.getValue=function(){var t=this.eInput.getDate();return r(t)||r(this.params.value)?null!==t&&void 0!==t?t:null:this.params.value},t.prototype.getStartValue=function(){var t=this.params.value;if(t instanceof Date)return to(t,!1)},t}(),Ca=function(t){function e(){return t.call(this,new _a)||this}return va(e,t),e}(Ts),wa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ba=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xa=function(){function t(t){this.getDataTypeService=t}return t.prototype.getTemplate=function(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'},t.prototype.init=function(t,e){this.eInput=t,this.params=e,null!=e.min&&t.setMin(e.min),null!=e.max&&t.setMax(e.max),null!=e.step&&t.setStep(e.step)},t.prototype.getValue=function(){var t=this.formatDate(this.eInput.getDate());return r(t)||r(this.params.value)?this.params.parseValue(null!==t&&void 0!==t?t:""):this.params.value},t.prototype.getStartValue=function(){var t,e;return to(null!==(e=this.parseDate(null!==(t=this.params.value)&&void 0!==t?t:void 0))&&void 0!==e?e:null,!1)},t.prototype.parseDate=function(t){return this.getDataTypeService().getDateParserFunction()(t)},t.prototype.formatDate=function(t){return this.getDataTypeService().getDateFormatterFunction()(t)},t}(),Ea=function(t){function e(){var e=t.call(this,new xa((function(){return e.dataTypeService})))||this;return e}return wa(e,t),ba([$("dataTypeService")],e.prototype,"dataTypeService",void 0),e}(Ts),Sa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ta=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ra=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return Sa(e,t),e.prototype.init=function(t){var e=this;this.params=t,this.updateCheckbox(t),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(t){if(Mt(t),!e.eCheckbox.isDisabled()){var n=e.eCheckbox.getValue();e.onCheckboxChanged(n)}})),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(t){Mt(t)}));var n=this.gridOptionsService.getDocument();this.addManagedListener(this.params.eGridCell,"keydown",(function(t){if(t.key===Qo.SPACE&&!e.eCheckbox.isDisabled()){e.params.eGridCell===n.activeElement&&e.eCheckbox.toggle();var o=e.eCheckbox.getValue();e.onCheckboxChanged(o),t.preventDefault()}}))},e.prototype.refresh=function(t){return this.params=t,this.updateCheckbox(t),!0},e.prototype.updateCheckbox=function(t){var e,n,o,r,i=!0;if(t.node.group&&t.column){var s=t.column.getColId();s.startsWith(te)?r=null==t.value||""===t.value?void 0:"true"===t.value:t.node.aggData&&void 0!==t.node.aggData[s]?r=null!==(e=t.value)&&void 0!==e?e:void 0:i=!1}else r=null!==(n=t.value)&&void 0!==n?n:void 0;if(i){this.eCheckbox.setValue(r);var a=null!=t.disabled?t.disabled:!(null===(o=t.column)||void 0===o?void 0:o.isCellEditable(t.node));this.eCheckbox.setDisabled(a);var l=this.localeService.getLocaleTextFunc(),u=En(l,r),c=a?u:l("ariaToggleCellValue","Press SPACE to toggle cell value")+" ("+u+")";this.eCheckbox.setInputAriaLabel(c)}else this.eCheckbox.setDisplayed(!1)},e.prototype.onCheckboxChanged=function(t){var e=this.params,n=e.column,o=e.node,r=e.rowIndex,i=e.value,s={type:Zt.EVENT_CELL_EDITING_STARTED,column:n,colDef:null===n||void 0===n?void 0:n.getColDef(),data:o.data,node:o,rowIndex:r,rowPinned:o.rowPinned,value:i};this.eventService.dispatchEvent(s);var a=this.params.node.setDataValue(this.params.column,t,"edit"),l={type:Zt.EVENT_CELL_EDITING_STOPPED,column:n,colDef:null===n||void 0===n?void 0:n.getColDef(),data:o.data,node:o,rowIndex:r,rowPinned:o.rowPinned,value:i,oldValue:i,newValue:t,valueChanged:a};this.eventService.dispatchEvent(l)},e.TEMPLATE='\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>',Ta([Or("eCheckbox")],e.prototype,"eCheckbox",void 0),e}(Tr),Oa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pa=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ia=function(t){function e(){return t.call(this,'\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return Oa(e,t),e.prototype.init=function(t){var e,n=this;this.params=t;var o=null!==(e=t.value)&&void 0!==e?e:void 0;this.eCheckbox.setValue(o),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(o),this.addManagedListener(this.eCheckbox,Zt.EVENT_FIELD_VALUE_CHANGED,(function(t){return n.setAriaLabel(t.selected)}))},e.prototype.getValue=function(){return this.eCheckbox.getValue()},e.prototype.focusIn=function(){this.eCheckbox.getFocusableElement().focus()},e.prototype.afterGuiAttached=function(){this.params.cellStartedEdit&&this.focusIn()},e.prototype.isPopup=function(){return!1},e.prototype.setAriaLabel=function(t){var e=this.localeService.getLocaleTextFunc(),n=En(e,t),o=e("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(o+" ("+n+")")},Pa([Or("eCheckbox")],e.prototype,"eCheckbox",void 0),e}(ys),Aa=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Da=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ma=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},La=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Na=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.agGridDefaults={agDateInput:Ni,agColumnHeader:hs,agColumnGroupHeader:gs,agSortIndicator:us,agTextColumnFloatingFilter:is,agNumberColumnFloatingFilter:os,agDateColumnFloatingFilter:Di,agReadOnlyFloatingFilter:Dr,agAnimateShowChangeCellRenderer:Ds,agAnimateSlideCellRenderer:Ns,agGroupCellRenderer:ia,agGroupRowRenderer:ia,agLoadingCellRenderer:la,agCheckboxCellRenderer:Ra,agCellEditor:Ps,agTextCellEditor:Ps,agNumberCellEditor:ya,agDateCellEditor:Ca,agDateStringCellEditor:Ea,agSelectCellEditor:xs,agLargeTextCellEditor:Cs,agCheckboxCellEditor:Ia,agTextColumnFilter:Zi,agNumberColumnFilter:qi,agDateColumnFilter:Ri,agLoadingOverlay:ca,agNoRowsOverlay:ha,agTooltipComponent:fa},e.enterpriseAgDefaultCompsModule={agSetColumnFilter:z.SetFilterModule,agSetColumnFloatingFilter:z.SetFilterModule,agMultiColumnFilter:z.MultiFilterModule,agMultiColumnFloatingFilter:z.MultiFilterModule,agGroupColumnFilter:z.RowGroupingModule,agGroupColumnFloatingFilter:z.RowGroupingModule,agRichSelect:z.RichSelectModule,agRichSelectCellEditor:z.RichSelectModule,agDetailCellRenderer:z.MasterDetailModule,agSparklineCellRenderer:z.SparklinesModule},e.jsComps={},e}return Aa(e,t),e.prototype.init=function(){var t=this;null!=this.gridOptions.components&&g(this.gridOptions.components,(function(e,n){return t.registerJsComponent(e,n)}))},e.prototype.registerDefaultComponent=function(t,e){this.agGridDefaults[t]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[t]=e},e.prototype.registerJsComponent=function(t,e){this.jsComps[t]=e},e.prototype.retrieve=function(t,e){var n=this,o=function(t,e){return{componentFromFramework:e,component:t}},r=this.getFrameworkOverrides().frameworkComponent(e,this.gridOptions.components);if(null!=r)return o(r,!0);var i=this.jsComps[e];if(i)return o(i,this.getFrameworkOverrides().isFrameworkComponent(i));var s=this.agGridDefaults[e];if(s)return o(s,!1);var a=this.enterpriseAgDefaultCompsModule[e];return a?W.__assertRegistered(a,"AG Grid '"+t+"' component: "+e,this.context.getGridId()):P((function(){n.warnAboutMissingComponent(t,e)}),"MissingComp"+e),null},e.prototype.warnAboutMissingComponent=function(t,e){var n=_e(e,La(La([],Ma(Object.keys(this.agGridDefaults).filter((function(t){return!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(t)})))),Ma(Object.keys(this.jsComps))),!0,.8);console.warn("AG Grid: Could not find '"+e+"' component. It was configured as \""+t+": '"+e+"'\" but it wasn't found in the list of registered components."),n.length>0&&console.warn("         Did you mean: ["+n.slice(0,3)+"]?"),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")},Da([$("gridOptions")],e.prototype,"gridOptions",void 0),Da([Z],e.prototype,"init",null),e=Da([Q("userComponentRegistry")],e)}(Ht),Fa={propertyName:"dateComponent",cellRenderer:!1},ka={propertyName:"headerComponent",cellRenderer:!1},Ga={propertyName:"headerGroupComponent",cellRenderer:!1},Ba={propertyName:"cellRenderer",cellRenderer:!0},Va={propertyName:"cellEditor",cellRenderer:!1},za={propertyName:"innerRenderer",cellRenderer:!0},ja={propertyName:"loadingOverlayComponent",cellRenderer:!1},Ha={propertyName:"noRowsOverlayComponent",cellRenderer:!1},Ua={propertyName:"tooltipComponent",cellRenderer:!1},Wa={propertyName:"filter",cellRenderer:!1},qa={propertyName:"floatingFilterComponent",cellRenderer:!1},Xa={propertyName:"toolPanel",cellRenderer:!1},Ya={propertyName:"statusPanel",cellRenderer:!1},Ka={propertyName:"fullWidthCellRenderer",cellRenderer:!0},Za={propertyName:"loadingCellRenderer",cellRenderer:!0},Ja={propertyName:"groupRowRenderer",cellRenderer:!0},Qa={propertyName:"detailCellRenderer",cellRenderer:!0},$a=function(){function t(){}return t.getFloatingFilterType=function(t){return this.filterToFloatingFilterMapping[t]},t.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"},t}(),tl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),el=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},nl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tl(e,t),e.prototype.getHeaderCompDetails=function(t,e){return this.getCompDetails(t,ka,"agColumnHeader",e)},e.prototype.getHeaderGroupCompDetails=function(t){var e=t.columnGroup.getColGroupDef();return this.getCompDetails(e,Ga,"agColumnGroupHeader",t)},e.prototype.getFullWidthCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Ka,null,t,!0)},e.prototype.getFullWidthLoadingCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Za,"agLoadingCellRenderer",t,!0)},e.prototype.getFullWidthGroupCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Ja,"agGroupRowRenderer",t,!0)},e.prototype.getFullWidthDetailCellRendererDetails=function(t){return this.getCompDetails(this.gridOptions,Qa,"agDetailCellRenderer",t,!0)},e.prototype.getInnerRendererDetails=function(t,e){return this.getCompDetails(t,za,null,e)},e.prototype.getFullWidthGroupRowInnerCellRenderer=function(t,e){return this.getCompDetails(t,za,null,e)},e.prototype.getCellRendererDetails=function(t,e){return this.getCompDetails(t,Ba,null,e)},e.prototype.getCellEditorDetails=function(t,e){return this.getCompDetails(t,Va,"agCellEditor",e,!0)},e.prototype.getFilterDetails=function(t,e,n){return this.getCompDetails(t,Wa,n,e,!0)},e.prototype.getDateCompDetails=function(t){return this.getCompDetails(this.gridOptions,Fa,"agDateInput",t,!0)},e.prototype.getLoadingOverlayCompDetails=function(t){return this.getCompDetails(this.gridOptions,ja,"agLoadingOverlay",t,!0)},e.prototype.getNoRowsOverlayCompDetails=function(t){return this.getCompDetails(this.gridOptions,Ha,"agNoRowsOverlay",t,!0)},e.prototype.getTooltipCompDetails=function(t){return this.getCompDetails(t.colDef,Ua,"agTooltipComponent",t,!0)},e.prototype.getSetFilterCellRendererDetails=function(t,e){return this.getCompDetails(t,Ba,null,e)},e.prototype.getFloatingFilterCompDetails=function(t,e,n){return this.getCompDetails(t,qa,n,e)},e.prototype.getToolPanelCompDetails=function(t,e){return this.getCompDetails(t,Xa,null,e,!0)},e.prototype.getStatusPanelCompDetails=function(t,e){return this.getCompDetails(t,Ya,null,e,!0)},e.prototype.getCompDetails=function(t,e,n,o,r){var i=this;void 0===r&&(r=!1);var s=e.propertyName,a=e.cellRenderer,l=this.getCompKeys(t,e,o),u=l.compName,c=l.jsComp,p=l.fwComp,h=l.paramsFromSelector,d=l.popupFromSelector,f=l.popupPositionFromSelector,g=function(t){var e=i.userComponentRegistry.retrieve(s,t);e&&(c=e.componentFromFramework?void 0:e.component,p=e.componentFromFramework?e.component:void 0)};if(null!=u&&g(u),null==c&&null==p&&null!=n&&g(n),c&&a&&!this.agComponentUtils.doesImplementIComponent(c)&&(c=this.agComponentUtils.adaptFunction(s,c)),c||p){var m=this.mergeParamsWithApplicationProvidedParams(t,e,o,h),y=null==c,v=c||p;return{componentFromFramework:y,componentClass:v,params:m,type:e,popupFromSelector:d,popupPositionFromSelector:f,newAgStackInstance:function(){return i.newAgStackInstance(v,y,m,e)}}}r&&console.error("AG Grid: Could not find component "+u+", did you forget to configure this component?")},e.prototype.getCompKeys=function(t,e,n){var o,r,i,s,a,l,u=this,c=e.propertyName;if(t){var p=t,h=p[c+"Selector"],d=h?h(n):null,f=function(t){if("string"===typeof t)o=t;else if(null!=t&&!0!==t){u.getFrameworkOverrides().isFrameworkComponent(t)?i=t:r=t}};d?(f(d.component),s=d.params,a=d.popup,l=d.popupPosition):f(p[c])}return{compName:o,jsComp:r,fwComp:i,paramsFromSelector:s,popupFromSelector:a,popupPositionFromSelector:l}},e.prototype.newAgStackInstance=function(t,e,n,o){var r,i=o.propertyName;if(!e)r=new t;else{var s=this.componentMetadataProvider.retrieve(i);r=this.frameworkComponentWrapper.wrap(t,s.mandatoryMethodList,s.optionalMethodList,o)}var a=this.initComponent(r,n);return null==a?mr.resolve(r):a.then((function(){return r}))},e.prototype.mergeParamsWithApplicationProvidedParams=function(t,e,n,o){void 0===o&&(o=null);var r={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};x(r,n);var i=t&&t[e.propertyName+"Params"];"function"===typeof i?x(r,i(n)):"object"===typeof i&&x(r,i);return x(r,o),r},e.prototype.initComponent=function(t,e){if(this.context.createBean(t),null!=t.init)return t.init(e)},e.prototype.getDefaultFloatingFilterType=function(t,e){if(null==t)return null;var n=null,o=this.getCompKeys(t,Wa),r=o.compName,i=o.jsComp,s=o.fwComp;r?n=$a.getFloatingFilterType(r):null==i&&null==s&&!0===t.filter&&(n=e());return n},el([$("gridOptions")],e.prototype,"gridOptions",void 0),el([$("agComponentUtils")],e.prototype,"agComponentUtils",void 0),el([$("componentMetadataProvider")],e.prototype,"componentMetadataProvider",void 0),el([$("userComponentRegistry")],e.prototype,"userComponentRegistry",void 0),el([tt("frameworkComponentWrapper")],e.prototype,"frameworkComponentWrapper",void 0),e=el([Q("userComponentFactory")],e)}(Ht);!function(t){t[t.SINGLE_SHEET=0]="SINGLE_SHEET",t[t.MULTI_SHEET=1]="MULTI_SHEET"}(Ws||(Ws={}));var ol,rl,il=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),sl=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},al=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragEndFunctions=[],e.dragSources=[],e}return il(e,t),e.prototype.removeAllListeners=function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0},e.prototype.removeListener=function(t){var e=t.dragSource.eElement,n=t.mouseDownListener;if(e.removeEventListener("mousedown",n),t.touchEnabled){var o=t.touchStartListener;e.removeEventListener("touchstart",o,{passive:!0})}},e.prototype.removeDragSource=function(t){var e=this.dragSources.find((function(e){return e.dragSource===t}));e&&(this.removeListener(e),wt(this.dragSources,e))},e.prototype.isDragging=function(){return this.dragging},e.prototype.addDragSource=function(t){var e=this,n=this.onMouseDown.bind(this,t),o=t.eElement,r=t.includeTouch,i=t.stopPropagationForTouch;o.addEventListener("mousedown",n);var s=null,a=this.gridOptionsService.is("suppressTouch");r&&!a&&(s=function(n){co(n.target)||(n.cancelable&&(n.preventDefault(),i&&n.stopPropagation()),e.onTouchStart(t,n))},o.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:t,mouseDownListener:n,touchStartListener:s,touchEnabled:!!r})},e.prototype.getStartTarget=function(){return this.startTarget},e.prototype.onTouchStart=function(t,e){var n=this;this.currentDragParams=t,this.dragging=!1;var o=e.touches[0];this.touchLastTime=o,this.touchStart=o;var r=function(e){return n.onTouchUp(e,t.eElement)},i=e.target,s=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:function(t){t.cancelable&&t.preventDefault()},options:{passive:!1}},{target:i,type:"touchmove",listener:function(e){return n.onTouchMove(e,t.eElement)},options:{passive:!0}},{target:i,type:"touchend",listener:r,options:{passive:!0}},{target:i,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(s),0===t.dragStartPixels&&this.onCommonMove(o,this.touchStart,t.eElement)},e.prototype.onMouseDown=function(t,e){var n=this,o=e;if((!t.skipMouseEvent||!t.skipMouseEvent(e))&&!o._alreadyProcessedByDragService&&(o._alreadyProcessedByDragService=!0,0===e.button)){this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.currentDragParams=t,this.dragging=!1,this.mouseStartEvent=e,this.startTarget=e.target;var r=this.gridOptionsService.getRootNode(),i=[{target:r,type:"mousemove",listener:function(e){return n.onMouseMove(e,t.eElement)}},{target:r,type:"mouseup",listener:function(e){return n.onMouseUp(e,t.eElement)}},{target:r,type:"contextmenu",listener:function(t){return t.preventDefault()}}];this.addTemporaryEvents(i),0===t.dragStartPixels&&this.onMouseMove(e,t.eElement)}},e.prototype.addTemporaryEvents=function(t){t.forEach((function(t){var e=t.target,n=t.type,o=t.listener,r=t.options;e.addEventListener(n,o,r)})),this.dragEndFunctions.push((function(){t.forEach((function(t){var e=t.target,n=t.type,o=t.listener,r=t.options;e.removeEventListener(n,o,r)}))}))},e.prototype.isEventNearStartEvent=function(t,e){var n=this.currentDragParams.dragStartPixels;return ir(t,e,r(n)?n:4)},e.prototype.getFirstActiveTouch=function(t){for(var e=0;e<t.length;e++)if(t[e].identifier===this.touchStart.identifier)return t[e];return null},e.prototype.onCommonMove=function(t,e,n){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(t,e))return;this.dragging=!0;var o={type:Zt.EVENT_DRAG_STARTED,target:n};this.eventService.dispatchEvent(o),this.currentDragParams.onDragStart(e),this.currentDragParams.onDragging(e)}this.currentDragParams.onDragging(t)},e.prototype.onTouchMove=function(t,e){var n=this.getFirstActiveTouch(t.touches);n&&this.onCommonMove(n,this.touchStart,e)},e.prototype.onMouseMove=function(t,e){this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.onCommonMove(t,this.mouseStartEvent,e)},e.prototype.shouldPreventMouseEvent=function(t){var e=this.gridOptionsService.is("enableCellTextSelection"),n=Ln(),o="mousemove"===t.type;return(e&&o||n)&&t.cancelable&&this.mouseEventService.isEventFromThisGrid(t)&&!this.isOverFormFieldElement(t)},e.prototype.isOverFormFieldElement=function(t){var e=t.target,n=null===e||void 0===e?void 0:e.tagName.toLocaleLowerCase();return!!(null===n||void 0===n?void 0:n.match("^a$|textarea|input|select|button"))},e.prototype.onTouchUp=function(t,e){var n=this.getFirstActiveTouch(t.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,e)},e.prototype.onMouseUp=function(t,e){this.onUpCommon(t,e)},e.prototype.onUpCommon=function(t,e){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(t);var n={type:Zt.EVENT_DRAG_STOPPED,target:e};this.eventService.dispatchEvent(n)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach((function(t){return t()})),this.dragEndFunctions.length=0},sl([$("mouseEventService")],e.prototype,"mouseEventService",void 0),sl([J],e.prototype,"removeAllListeners",null),e=sl([Q("dragService")],e)}(Ht);!function(t){t[t.Above=0]="Above",t[t.Below=1]="Below"}(ol||(ol={})),function(t){t.EVERYTHING="group",t.FILTER="filter",t.SORT="sort",t.MAP="map",t.AGGREGATE="aggregate",t.FILTER_AGGREGATES="filter_aggregates",t.PIVOT="pivot",t.NOTHING="nothing"}(rl||(rl={}));var ll=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};function ul(t){var e=t;return null!=e&&null!=e.getFrameworkComponentInstance?e.getFrameworkComponentInstance():t}var cl,pl=function(){function t(){this.detailGridInfoMap={},this.destroyCalled=!1}return t.prototype.registerOverlayWrapperComp=function(t){this.overlayWrapperComp=t},t.prototype.registerSideBarComp=function(t){this.sideBarComp=t},t.prototype.init=function(){var t=this;switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl()}))},t.prototype.__getAlignedGridService=function(){return this.alignedGridsService},t.prototype.__getContext=function(){return this.context},t.prototype.getSetterMethod=function(t){return"set"+t.charAt(0).toUpperCase()+t.substring(1)},t.prototype.__setProperty=function(t,e){this.gos.set(t,e);var n=this.getSetterMethod(t);this[n]&&this[n](e)},t.prototype.getGridId=function(){return this.context.getGridId()},t.prototype.addDetailGridInfo=function(t,e){this.detailGridInfoMap[t]=e},t.prototype.removeDetailGridInfo=function(t){this.detailGridInfoMap[t]=void 0},t.prototype.getDetailGridInfo=function(t){return this.detailGridInfoMap[t]},t.prototype.forEachDetailGridInfo=function(t){var e=0;g(this.detailGridInfoMap,(function(n,o){r(o)&&(t(o,e),e++)}))},t.prototype.getDataAsCsv=function(t){if(W.__assertRegistered(z.CsvExportModule,"api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(t)},t.prototype.exportDataAsCsv=function(t){W.__assertRegistered(z.CsvExportModule,"api.exportDataAsCSv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(t)},t.prototype.getExcelExportMode=function(t){var e=this.gos.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},e,t).exportMode},t.prototype.assertNotExcelMultiSheet=function(t,e){if(!W.__assertRegistered(z.ExcelExportModule,"api."+t,this.context.getGridId()))return!1;var n=this.getExcelExportMode(e);return this.excelCreator.getFactoryMode(n)!==Ws.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)},t.prototype.getDataAsExcel=function(t){if(this.assertNotExcelMultiSheet("getDataAsExcel",t))return this.excelCreator.getDataAsExcel(t)},t.prototype.exportDataAsExcel=function(t){this.assertNotExcelMultiSheet("exportDataAsExcel",t)&&this.excelCreator.exportDataAsExcel(t)},t.prototype.getSheetDataForExcel=function(t){if(W.__assertRegistered(z.ExcelExportModule,"api.getSheetDataForExcel",this.context.getGridId())){var e=this.getExcelExportMode(t);return this.excelCreator.setFactoryMode(Ws.MULTI_SHEET,e),this.excelCreator.getSheetDataForExcel(t)}},t.prototype.getMultipleSheetsAsExcel=function(t){if(W.__assertRegistered(z.ExcelExportModule,"api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(t)},t.prototype.exportMultipleSheetsAsExcel=function(t){if(W.__assertRegistered(z.ExcelExportModule,"api.exportMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.exportMultipleSheetsAsExcel(t)},t.prototype.setGridAriaProperty=function(t,e){if(t){var n=this.ctrlsService.getGridBodyCtrl().getGui(),o="aria-"+t;null===e?n.removeAttribute(o):n.setAttribute(o,e)}},t.prototype.logMissingRowModel=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];console.error("AG Grid: api."+t+" can only be called when gridOptions.rowModelType is "+e.join(" or "))},t.prototype.setServerSideDatasource=function(t){this.serverSideRowModel?this.serverSideRowModel.setDatasource(t):this.logMissingRowModel("setServerSideDatasource","serverSide")},t.prototype.setCacheBlockSize=function(t){this.serverSideRowModel?(this.gos.set("cacheBlockSize",t),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")},t.prototype.setDatasource=function(t){this.gos.isRowModelType("infinite")?this.rowModel.setDatasource(t):this.logMissingRowModel("setDatasource","infinite")},t.prototype.setViewportDatasource=function(t){this.gos.isRowModelType("viewport")?this.rowModel.setViewportDatasource(t):this.logMissingRowModel("setViewportDatasource","viewport")},t.prototype.setRowData=function(t){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(t):(this.selectionService.reset(),this.clientSideRowModel.setRowData(t))},t.prototype.setPinnedTopRowData=function(t){this.pinnedRowModel.setPinnedTopRowData(t)},t.prototype.setPinnedBottomRowData=function(t){this.pinnedRowModel.setPinnedBottomRowData(t)},t.prototype.getPinnedTopRowCount=function(){return this.pinnedRowModel.getPinnedTopRowCount()},t.prototype.getPinnedBottomRowCount=function(){return this.pinnedRowModel.getPinnedBottomRowCount()},t.prototype.getPinnedTopRow=function(t){return this.pinnedRowModel.getPinnedTopRow(t)},t.prototype.getPinnedBottomRow=function(t){return this.pinnedRowModel.getPinnedBottomRow(t)},t.prototype.setColumnDefs=function(t,e){void 0===e&&(e="api"),this.columnModel.setColumnDefs(t,e),this.gos.set("columnDefs",t,!0,{source:e})},t.prototype.setAutoGroupColumnDef=function(t,e){void 0===e&&(e="api"),this.gos.set("autoGroupColumnDef",t,!0,{source:e})},t.prototype.setDefaultColDef=function(t,e){void 0===e&&(e="api"),this.gos.set("defaultColDef",t,!0,{source:e})},t.prototype.setColumnTypes=function(t,e){void 0===e&&(e="api"),this.gos.set("columnTypes",t,!0,{source:e})},t.prototype.expireValueCache=function(){this.valueCache.expire()},t.prototype.getVerticalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()},t.prototype.getHorizontalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()},t.prototype.setAlwaysShowHorizontalScroll=function(t){this.gos.set("alwaysShowHorizontalScroll",t)},t.prototype.setAlwaysShowVerticalScroll=function(t){this.gos.set("alwaysShowVerticalScroll",t)},t.prototype.refreshCells=function(t){void 0===t&&(t={}),this.rowRenderer.refreshCells(t)},t.prototype.flashCells=function(t){void 0===t&&(t={}),this.rowRenderer.flashCells(t)},t.prototype.redrawRows=function(t){void 0===t&&(t={});var e=t?t.rowNodes:void 0;this.rowRenderer.redrawRows(e)},t.prototype.setFunctionsReadOnly=function(t){this.gos.set("functionsReadOnly",t)},t.prototype.refreshHeader=function(){this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(t){return t.refresh()}))},t.prototype.isAnyFilterPresent=function(){return this.filterManager.isAnyFilterPresent()},t.prototype.isColumnFilterPresent=function(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()},t.prototype.isQuickFilterPresent=function(){return this.filterManager.isQuickFilterPresent()},t.prototype.getModel=function(){return this.rowModel},t.prototype.setRowNodeExpanded=function(t,e,n){t&&(n&&t.parent&&-1!==t.parent.level&&this.setRowNodeExpanded(t.parent,e,n),t.setExpanded(e))},t.prototype.onGroupExpandedOrCollapsed=function(){i(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:rl.MAP})},t.prototype.refreshClientSideRowModel=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(t)},t.prototype.isAnimationFrameQueueEmpty=function(){return this.animationFrameService.isQueueEmpty()},t.prototype.flushAllAnimationFrames=function(){this.animationFrameService.flushAllFrames()},t.prototype.getRowNode=function(t){return this.rowModel.getRowNode(t)},t.prototype.getSizesForCurrentTheme=function(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}},t.prototype.expandAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")},t.prototype.collapseAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")},t.prototype.addRenderedRowListener=function(t,e,n){this.rowRenderer.addRenderedRowListener(t,e,n)},t.prototype.getQuickFilter=function(){return this.gos.get("quickFilterText")},t.prototype.setQuickFilter=function(t){this.gos.set("quickFilterText",t)},t.prototype.setExcludeHiddenColumnsFromQuickFilter=function(t){Se("30","setExcludeHiddenColumnsFromQuickFilter",void 0,"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `setIncludeHiddenColumnsInQuickFilter`"),this.setIncludeHiddenColumnsInQuickFilter(!t)},t.prototype.setIncludeHiddenColumnsInQuickFilter=function(t){this.gos.set("includeHiddenColumnsInQuickFilter",t)},t.prototype.getAdvancedFilterModel=function(){return W.__assertRegistered(z.AdvancedFilterModule,"api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null},t.prototype.setAdvancedFilterModel=function(t){W.__assertRegistered(z.AdvancedFilterModule,"api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.setAdvancedFilterModel(t)},t.prototype.setEnableAdvancedFilter=function(t){this.gos.set("enableAdvancedFilter",t)},t.prototype.setIncludeHiddenColumnsInAdvancedFilter=function(t){this.gos.set("includeHiddenColumnsInAdvancedFilter",t)},t.prototype.setAdvancedFilterParent=function(t){this.gos.set("advancedFilterParent",t)},t.prototype.setNodesSelected=function(t){if(t.nodes.every((function(t){return t.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):void 0!==t.id||(console.warn("AG Grid: cannot select node until id for node is known"),!1)}))){var e=t.nodes,n=t.source,o=t.newValue,r=e;this.selectionService.setNodesSelected({nodes:r,source:null!==n&&void 0!==n?n:"api",newValue:o})}},t.prototype.selectAll=function(t){void 0===t&&(t="apiSelectAll"),this.selectionService.selectAllRowNodes({source:t})},t.prototype.deselectAll=function(t){void 0===t&&(t="apiSelectAll"),this.selectionService.deselectAllRowNodes({source:t})},t.prototype.selectAllFiltered=function(t){void 0===t&&(t="apiSelectAllFiltered"),this.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},t.prototype.deselectAllFiltered=function(t){void 0===t&&(t="apiSelectAllFiltered"),this.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},t.prototype.getServerSideSelectionState=function(){return i(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()},t.prototype.setServerSideSelectionState=function(t){i(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(t)},t.prototype.selectAllOnCurrentPage=function(t){void 0===t&&(t="apiSelectAllCurrentPage"),this.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},t.prototype.deselectAllOnCurrentPage=function(t){void 0===t&&(t="apiSelectAllCurrentPage"),this.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},t.prototype.sizeColumnsToFit=function(t){this.gridBodyCtrl.sizeColumnsToFit(t)},t.prototype.showLoadingOverlay=function(){this.overlayWrapperComp.showLoadingOverlay()},t.prototype.showNoRowsOverlay=function(){this.overlayWrapperComp.showNoRowsOverlay()},t.prototype.hideOverlay=function(){this.overlayWrapperComp.hideOverlay()},t.prototype.getSelectedNodes=function(){return this.selectionService.getSelectedNodes()},t.prototype.getSelectedRows=function(){return this.selectionService.getSelectedRows()},t.prototype.getBestCostNodeSelection=function(){if(!i(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")},t.prototype.getRenderedNodes=function(){return this.rowRenderer.getRenderedNodes()},t.prototype.ensureColumnVisible=function(t,e){void 0===e&&(e="auto"),this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(t,e)},t.prototype.ensureIndexVisible=function(t,e){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t,e)},t.prototype.ensureNodeVisible=function(t,e){void 0===e&&(e=null),this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(t,e)},t.prototype.forEachLeafNode=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(t)},t.prototype.forEachNode=function(t,e){this.rowModel.forEachNode(t,e)},t.prototype.forEachNodeAfterFilter=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(t)},t.prototype.forEachNodeAfterFilterAndSort=function(t){i(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(t)},t.prototype.getFilterInstance=function(t,e){return this.filterManager.getFilterInstance(t,e)},t.prototype.destroyFilter=function(t){var e=this.columnModel.getPrimaryColumn(t);if(e)return this.filterManager.destroyFilter(e,"api")},t.prototype.getStatusPanel=function(t){if(W.__assertRegistered(z.StatusBarModule,"api.getStatusPanel",this.context.getGridId()))return ul(this.statusBarService.getStatusPanel(t))},t.prototype.getColumnDef=function(t){var e=this.columnModel.getPrimaryColumn(t);return e?e.getColDef():null},t.prototype.getColumnDefs=function(){return this.columnModel.getColumnDefs()},t.prototype.onFilterChanged=function(t){void 0===t&&(t="api"),this.filterManager.onFilterChanged({source:t})},t.prototype.onSortChanged=function(){this.sortController.onSortChanged("api")},t.prototype.setFilterModel=function(t){this.filterManager.setFilterModel(t)},t.prototype.getFilterModel=function(){return this.filterManager.getFilterModel()},t.prototype.getFocusedCell=function(){return this.focusService.getFocusedCell()},t.prototype.clearFocusedCell=function(){return this.focusService.clearFocusedCell()},t.prototype.setFocusedCell=function(t,e,n){this.focusService.setFocusedCell({rowIndex:t,column:e,rowPinned:n,forceBrowserFocus:!0})},t.prototype.setSuppressRowDrag=function(t){this.gos.set("suppressRowDrag",t)},t.prototype.setSuppressMoveWhenRowDragging=function(t){this.gos.set("suppressMoveWhenRowDragging",t)},t.prototype.setSuppressRowClickSelection=function(t){this.gos.set("suppressRowClickSelection",t)},t.prototype.addRowDropZone=function(t){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(t)},t.prototype.removeRowDropZone=function(t){var e=this.dragAndDropService.findExternalZone(t);e&&this.dragAndDropService.removeDropTarget(e)},t.prototype.getRowDropZoneParams=function(t){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(t)},t.prototype.setHeaderHeight=function(t){this.gos.set("headerHeight",t)},t.prototype.setDomLayout=function(t){this.gos.set("domLayout",t)},t.prototype.setEnableCellTextSelection=function(t){this.gridBodyCtrl.setCellTextSelection(t)},t.prototype.setFillHandleDirection=function(t){this.gos.set("fillHandleDirection",t)},t.prototype.setGroupHeaderHeight=function(t){this.gos.set("groupHeaderHeight",t)},t.prototype.setFloatingFiltersHeight=function(t){this.gos.set("floatingFiltersHeight",t)},t.prototype.setPivotHeaderHeight=function(t){this.gos.set("pivotHeaderHeight",t)},t.prototype.setPivotGroupHeaderHeight=function(t){this.gos.set("pivotGroupHeaderHeight",t)},t.prototype.setPivotMode=function(t){this.columnModel.setPivotMode(t)},t.prototype.setAnimateRows=function(t){this.gos.set("animateRows",t)},t.prototype.setIsExternalFilterPresent=function(t){this.gos.set("isExternalFilterPresent",t)},t.prototype.setDoesExternalFilterPass=function(t){this.gos.set("doesExternalFilterPass",t)},t.prototype.setNavigateToNextCell=function(t){this.gos.set("navigateToNextCell",t)},t.prototype.setTabToNextCell=function(t){this.gos.set("tabToNextCell",t)},t.prototype.setTabToNextHeader=function(t){this.gos.set("tabToNextHeader",t)},t.prototype.setNavigateToNextHeader=function(t){this.gos.set("navigateToNextHeader",t)},t.prototype.setRowGroupPanelShow=function(t){this.gos.set("rowGroupPanelShow",t)},t.prototype.setGetGroupRowAgg=function(t){this.gos.set("getGroupRowAgg",t)},t.prototype.setGetBusinessKeyForNode=function(t){this.gos.set("getBusinessKeyForNode",t)},t.prototype.setGetChildCount=function(t){this.gos.set("getChildCount",t)},t.prototype.setProcessRowPostCreate=function(t){this.gos.set("processRowPostCreate",t)},t.prototype.setGetRowId=function(t){this.gos.set("getRowId",t)},t.prototype.setGetRowClass=function(t){this.gos.set("getRowClass",t)},t.prototype.setIsFullWidthRow=function(t){this.gos.set("isFullWidthRow",t)},t.prototype.setIsRowSelectable=function(t){this.gos.set("isRowSelectable",t)},t.prototype.setIsRowMaster=function(t){this.gos.set("isRowMaster",t)},t.prototype.setPostSortRows=function(t){this.gos.set("postSortRows",t)},t.prototype.setGetDocument=function(t){this.gos.set("getDocument",t)},t.prototype.setGetContextMenuItems=function(t){this.gos.set("getContextMenuItems",t)},t.prototype.setGetMainMenuItems=function(t){this.gos.set("getMainMenuItems",t)},t.prototype.setProcessCellForClipboard=function(t){this.gos.set("processCellForClipboard",t)},t.prototype.setSendToClipboard=function(t){this.gos.set("sendToClipboard",t)},t.prototype.setProcessCellFromClipboard=function(t){this.gos.set("processCellFromClipboard",t)},t.prototype.setProcessSecondaryColDef=function(t){Se("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(t)},t.prototype.setProcessSecondaryColGroupDef=function(t){Se("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(t)},t.prototype.setProcessPivotResultColDef=function(t){this.gos.set("processPivotResultColDef",t)},t.prototype.setProcessPivotResultColGroupDef=function(t){this.gos.set("processPivotResultColGroupDef",t)},t.prototype.setPostProcessPopup=function(t){this.gos.set("postProcessPopup",t)},t.prototype.setInitialGroupOrderComparator=function(t){this.gos.set("initialGroupOrderComparator",t)},t.prototype.setGetChartToolbarItems=function(t){this.gos.set("getChartToolbarItems",t)},t.prototype.setPaginationNumberFormatter=function(t){this.gos.set("paginationNumberFormatter",t)},t.prototype.setGetServerSideStoreParams=function(t){Se("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(t)},t.prototype.setGetServerSideGroupLevelParams=function(t){this.gos.set("getServerSideGroupLevelParams",t)},t.prototype.setIsServerSideGroupOpenByDefault=function(t){this.gos.set("isServerSideGroupOpenByDefault",t)},t.prototype.setIsApplyServerSideTransaction=function(t){this.gos.set("isApplyServerSideTransaction",t)},t.prototype.setIsServerSideGroup=function(t){this.gos.set("isServerSideGroup",t)},t.prototype.setGetServerSideGroupKey=function(t){this.gos.set("getServerSideGroupKey",t)},t.prototype.setGetRowStyle=function(t){this.gos.set("getRowStyle",t)},t.prototype.setGetRowHeight=function(t){this.gos.set("getRowHeight",t)},t.prototype.assertSideBarLoaded=function(t){return W.__assertRegistered(z.SideBarModule,"api."+t,this.context.getGridId())},t.prototype.isSideBarVisible=function(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()},t.prototype.setSideBarVisible=function(t){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(t)},t.prototype.setSideBarPosition=function(t){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(t)},t.prototype.openToolPanel=function(t){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(t,"api")},t.prototype.closeToolPanel=function(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")},t.prototype.getOpenedToolPanel=function(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null},t.prototype.refreshToolPanel=function(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()},t.prototype.isToolPanelShowing=function(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()},t.prototype.getToolPanelInstance=function(t){if(this.assertSideBarLoaded("getToolPanelInstance"))return ul(this.sideBarComp.getToolPanelInstance(t))},t.prototype.getSideBar=function(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()},t.prototype.setSideBar=function(t){this.gos.set("sideBar",t)},t.prototype.setSuppressClipboardPaste=function(t){this.gos.set("suppressClipboardPaste",t)},t.prototype.resetRowHeights=function(){if(r(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}},t.prototype.setGroupRemoveSingleChildren=function(t){this.gos.set("groupRemoveSingleChildren",t)},t.prototype.setGroupRemoveLowestSingleChildren=function(t){this.gos.set("groupRemoveLowestSingleChildren",t)},t.prototype.setGroupDisplayType=function(t){this.gos.set("groupDisplayType",t)},t.prototype.setRowClass=function(t){this.gos.set("rowClass",t)},t.prototype.setDeltaSort=function(t){this.gos.set("deltaSort",t)},t.prototype.setRowCount=function(t,e){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(t,e):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(t,e):this.logMissingRowModel("setRowCount","infinite","serverSide")},t.prototype.onRowHeightChanged=function(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()},t.prototype.getValue=function(t,e){var n=this.columnModel.getPrimaryColumn(t);return i(n)&&(n=this.columnModel.getGridColumn(t)),i(n)?null:this.valueService.getValue(n,e)},t.prototype.addEventListener=function(t,e){var n=this.gos.useAsyncEvents();this.eventService.addEventListener(t,e,n)},t.prototype.addGlobalListener=function(t){var e=this.gos.useAsyncEvents();this.eventService.addGlobalListener(t,e)},t.prototype.removeEventListener=function(t,e){var n=this.gos.useAsyncEvents();this.eventService.removeEventListener(t,e,n)},t.prototype.removeGlobalListener=function(t){var e=this.gos.useAsyncEvents();this.eventService.removeGlobalListener(t,e)},t.prototype.dispatchEvent=function(t){this.eventService.dispatchEvent(t)},t.prototype.destroy=function(){if(!this.destroyCalled){this.destroyCalled=!0;var t=this.ctrlsService.getGridCtrl();t&&t.destroyGridUi(),this.context.destroy()}},t.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(S.bind(window,this,"Grid API"),100)},t.prototype.warnIfDestroyed=function(t){return this.destroyCalled&&console.warn("AG Grid: Grid API method "+t+" was called on a grid that was destroyed."),this.destroyCalled},t.prototype.resetQuickFilter=function(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()},t.prototype.getCellRanges=function(){return this.rangeService?this.rangeService.getCellRanges():(W.__assertRegistered(z.RangeSelectionModule,"api.getCellRanges",this.context.getGridId()),null)},t.prototype.addCellRange=function(t){this.rangeService?this.rangeService.addCellRange(t):W.__assertRegistered(z.RangeSelectionModule,"api.addCellRange",this.context.getGridId())},t.prototype.clearRangeSelection=function(){this.rangeService&&this.rangeService.removeAllCellRanges(),W.__assertRegistered(z.RangeSelectionModule,"gridApi.clearRangeSelection",this.context.getGridId())},t.prototype.undoCellEditing=function(){this.undoRedoService.undo("api")},t.prototype.redoCellEditing=function(){this.undoRedoService.redo("api")},t.prototype.getCurrentUndoSize=function(){return this.undoRedoService.getCurrentUndoStackSize()},t.prototype.getCurrentRedoSize=function(){return this.undoRedoService.getCurrentRedoStackSize()},t.prototype.getChartModels=function(){if(W.__assertRegistered(z.GridChartsModule,"api.getChartModels",this.context.getGridId()))return this.chartService.getChartModels()},t.prototype.getChartRef=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.getChartRef",this.context.getGridId()))return this.chartService.getChartRef(t)},t.prototype.getChartImageDataURL=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.getChartImageDataURL",this.context.getGridId()))return this.chartService.getChartImageDataURL(t)},t.prototype.downloadChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.downloadChart",this.context.getGridId()))return this.chartService.downloadChart(t)},t.prototype.openChartToolPanel=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.openChartToolPanel",this.context.getGridId()))return this.chartService.openChartToolPanel(t)},t.prototype.closeChartToolPanel=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.closeChartToolPanel",this.context.getGridId()))return this.chartService.closeChartToolPanel(t.chartId)},t.prototype.createRangeChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.createRangeChart",this.context.getGridId()))return this.chartService.createRangeChart(t)},t.prototype.createPivotChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.createPivotChart",this.context.getGridId()))return this.chartService.createPivotChart(t)},t.prototype.createCrossFilterChart=function(t){if(W.__assertRegistered(z.GridChartsModule,"api.createCrossFilterChart",this.context.getGridId()))return this.chartService.createCrossFilterChart(t)},t.prototype.updateChart=function(t){W.__assertRegistered(z.GridChartsModule,"api.updateChart",this.context.getGridId())&&this.chartService.updateChart(t)},t.prototype.restoreChart=function(t,e){if(W.__assertRegistered(z.GridChartsModule,"api.restoreChart",this.context.getGridId()))return this.chartService.restoreChart(t,e)},t.prototype.copyToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.copyToClipboard",this.context.getGridId())&&this.clipboardService.copyToClipboard(t)},t.prototype.cutToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.cutToClipboard",this.context.getGridId())&&this.clipboardService.cutToClipboard(t,"api")},t.prototype.copySelectedRowsToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.copySelectedRowsToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRowsToClipboard(t)},t.prototype.copySelectedRangeToClipboard=function(t){W.__assertRegistered(z.ClipboardModule,"api.copySelectedRangeToClipboard",this.context.getGridId())&&this.clipboardService.copySelectedRangeToClipboard(t)},t.prototype.copySelectedRangeDown=function(){W.__assertRegistered(z.ClipboardModule,"api.copySelectedRangeDown",this.context.getGridId())&&this.clipboardService.copyRangeDown()},t.prototype.pasteFromClipboard=function(){W.__assertRegistered(z.ClipboardModule,"api.pasteFromClipboard",this.context.getGridId())&&this.clipboardService.pasteFromClipboard()},t.prototype.showColumnMenuAfterButtonClick=function(t,e){var n=this.columnModel.getGridColumn(t);this.menuFactory.showMenuAfterButtonClick(n,e,"columnMenu")},t.prototype.showColumnMenuAfterMouseClick=function(t,e){var n=this.columnModel.getGridColumn(t);n||(n=this.columnModel.getPrimaryColumn(t)),n?this.menuFactory.showMenuAfterMouseEvent(n,e):console.error("AG Grid: column '"+t+"' not found")},t.prototype.hidePopupMenu=function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()},t.prototype.setPopupParent=function(t){this.gos.set("popupParent",t)},t.prototype.tabToNextCell=function(t){return this.navigationService.tabToNextCell(!1,t)},t.prototype.tabToPreviousCell=function(t){return this.navigationService.tabToNextCell(!0,t)},t.prototype.getCellRendererInstances=function(t){return void 0===t&&(t={}),this.rowRenderer.getCellRendererInstances(t).map(ul)},t.prototype.getCellEditorInstances=function(t){return void 0===t&&(t={}),this.rowRenderer.getCellEditorInstances(t).map(ul)},t.prototype.getEditingCells=function(){return this.rowRenderer.getEditingCells()},t.prototype.stopEditing=function(t){void 0===t&&(t=!1),this.rowRenderer.stopEditing(t)},t.prototype.startEditingCell=function(t){var e=this.columnModel.getGridColumn(t.colKey);if(e){var n={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:e};null==t.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(t.rowIndex);var o=this.navigationService.getCellByPosition(n);o&&(this.focusService.isCellFocused(n)||this.focusService.setFocusedCell(n),o.startRowOrCellEdit(t.key))}else console.warn("AG Grid: no column found for "+t.colKey)},t.prototype.addAggFunc=function(t,e){this.aggFuncService&&this.aggFuncService.addAggFunc(t,e)},t.prototype.addAggFuncs=function(t){this.aggFuncService&&this.aggFuncService.addAggFuncs(t)},t.prototype.clearAggFuncs=function(){this.aggFuncService&&this.aggFuncService.clear()},t.prototype.applyServerSideTransaction=function(t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(t);this.logMissingRowModel("applyServerSideTransaction","serverSide")},t.prototype.applyServerSideTransactionAsync=function(t,e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(t,e);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")},t.prototype.retryServerSideLoads=function(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")},t.prototype.flushServerSideAsyncTransactions=function(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")},t.prototype.applyTransaction=function(t){if(this.clientSideRowModel)return this.clientSideRowModel.updateRowData(t);this.logMissingRowModel("applyTransaction","clientSide")},t.prototype.applyTransactionAsync=function(t,e){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(t,e):this.logMissingRowModel("applyTransactionAsync","clientSide")},t.prototype.flushAsyncTransactions=function(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")},t.prototype.setSuppressModelUpdateAfterUpdateTransaction=function(t){this.gos.set("suppressModelUpdateAfterUpdateTransaction",t)},t.prototype.refreshInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")},t.prototype.purgeInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")},t.prototype.refreshServerSide=function(t){this.serverSideRowModel?this.serverSideRowModel.refreshStore(t):this.logMissingRowModel("refreshServerSide","serverSide")},t.prototype.refreshServerSideStore=function(t){return Se("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(t)},t.prototype.getServerSideStoreState=function(){return Se("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()},t.prototype.getServerSideGroupLevelState=function(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])},t.prototype.getInfiniteRowCount=function(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")},t.prototype.isLastRowIndexKnown=function(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")},t.prototype.getCacheBlockState=function(){return this.rowNodeBlockLoader.getBlockState()},t.prototype.getFirstDisplayedRow=function(){return this.rowRenderer.getFirstVirtualRenderedRow()},t.prototype.getLastDisplayedRow=function(){return this.rowRenderer.getLastVirtualRenderedRow()},t.prototype.getDisplayedRowAtIndex=function(t){return this.rowModel.getRow(t)},t.prototype.getDisplayedRowCount=function(){return this.rowModel.getRowCount()},t.prototype.setDataTypeDefinitions=function(t){this.gos.set("dataTypeDefinitions",t)},t.prototype.setPagination=function(t){this.gos.set("pagination",t)},t.prototype.paginationIsLastPageFound=function(){return this.paginationProxy.isLastPageFound()},t.prototype.paginationGetPageSize=function(){return this.paginationProxy.getPageSize()},t.prototype.paginationSetPageSize=function(t){this.gos.set("paginationPageSize",t)},t.prototype.paginationGetCurrentPage=function(){return this.paginationProxy.getCurrentPage()},t.prototype.paginationGetTotalPages=function(){return this.paginationProxy.getTotalPages()},t.prototype.paginationGetRowCount=function(){return this.paginationProxy.getMasterRowCount()},t.prototype.paginationGoToNextPage=function(){this.paginationProxy.goToNextPage()},t.prototype.paginationGoToPreviousPage=function(){this.paginationProxy.goToPreviousPage()},t.prototype.paginationGoToFirstPage=function(){this.paginationProxy.goToFirstPage()},t.prototype.paginationGoToLastPage=function(){this.paginationProxy.goToLastPage()},t.prototype.paginationGoToPage=function(t){this.paginationProxy.goToPage(t)},ll([tt("immutableService")],t.prototype,"immutableService",void 0),ll([tt("csvCreator")],t.prototype,"csvCreator",void 0),ll([tt("excelCreator")],t.prototype,"excelCreator",void 0),ll([$("rowRenderer")],t.prototype,"rowRenderer",void 0),ll([$("navigationService")],t.prototype,"navigationService",void 0),ll([$("filterManager")],t.prototype,"filterManager",void 0),ll([$("columnModel")],t.prototype,"columnModel",void 0),ll([$("selectionService")],t.prototype,"selectionService",void 0),ll([$("gridOptionsService")],t.prototype,"gos",void 0),ll([$("valueService")],t.prototype,"valueService",void 0),ll([$("alignedGridsService")],t.prototype,"alignedGridsService",void 0),ll([$("eventService")],t.prototype,"eventService",void 0),ll([$("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),ll([$("context")],t.prototype,"context",void 0),ll([$("rowModel")],t.prototype,"rowModel",void 0),ll([$("sortController")],t.prototype,"sortController",void 0),ll([$("paginationProxy")],t.prototype,"paginationProxy",void 0),ll([$("focusService")],t.prototype,"focusService",void 0),ll([$("dragAndDropService")],t.prototype,"dragAndDropService",void 0),ll([tt("rangeService")],t.prototype,"rangeService",void 0),ll([tt("clipboardService")],t.prototype,"clipboardService",void 0),ll([tt("aggFuncService")],t.prototype,"aggFuncService",void 0),ll([$("menuFactory")],t.prototype,"menuFactory",void 0),ll([tt("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),ll([$("valueCache")],t.prototype,"valueCache",void 0),ll([$("animationFrameService")],t.prototype,"animationFrameService",void 0),ll([tt("statusBarService")],t.prototype,"statusBarService",void 0),ll([tt("chartService")],t.prototype,"chartService",void 0),ll([tt("undoRedoService")],t.prototype,"undoRedoService",void 0),ll([tt("rowNodeBlockLoader")],t.prototype,"rowNodeBlockLoader",void 0),ll([tt("ssrmTransactionManager")],t.prototype,"serverSideTransactionManager",void 0),ll([$("ctrlsService")],t.prototype,"ctrlsService",void 0),ll([Z],t.prototype,"init",null),ll([J],t.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),t=ll([Q("gridApi")],t)}(),hl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dl=function(){return dl=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},dl.apply(this,arguments)},fl=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allColumnFilters=new Map,e.allColumnListeners=new Map,e.activeAggregateFilters=[],e.activeColumnFilters=[],e.quickFilter=null,e.quickFilterParts=null,e.processingFilterChange=!1,e.filterModelUpdateQueue=[],e}var n;return hl(e,t),n=e,e.prototype.init=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_GRID_COLUMNS_CHANGED,(function(){return t.onColumnsChanged()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VALUE_CHANGED,(function(){return t.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_CHANGED,(function(){return t.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(){t.refreshFiltersForAggregations(),t.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,(function(){t.resetQuickFilterCache(),t.updateAdvancedFilterColumns()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return t.resetQuickFilterCache()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VISIBLE,(function(){t.gridOptionsService.is("includeHiddenColumnsInQuickFilter")||t.resetQuickFilterCache(),t.updateAdvancedFilterColumns()})),this.addManagedPropertyListener("quickFilterText",(function(e){return t.setQuickFilter(e.currentValue)})),this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter",(function(){return t.onIncludeHiddenColumnsInQuickFilterChanged()})),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",(function(){return t.updateAggFiltering()})),this.addManagedPropertyListener("advancedFilterModel",(function(e){return t.setAdvancedFilterModel(e.currentValue)})),this.addManagedListener(this.eventService,Zt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,(function(e){var n=e.enabled;return t.onAdvancedFilterEnabledChanged(n)})),this.addManagedListener(this.eventService,Zt.EVENT_DATA_TYPES_INFERRED,(function(){return t.processFilterModelUpdateQueue()}))},e.prototype.isExternalFilterPresentCallback=function(){var t=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"===typeof t&&t({})},e.prototype.doesExternalFilterPass=function(t){var e=this.gridOptionsService.get("doesExternalFilterPass");return"function"===typeof e&&e(t)},e.prototype.setQuickFilterParts=function(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null},e.prototype.setFilterModel=function(t){var e=this;if(this.isAdvancedFilterEnabled())this.warnAdvancedFilters();else if(this.dataTypeService.isPendingInference())this.filterModelUpdateQueue.push(t);else{var n=[],o=this.getFilterModel();if(t){var r=lr(Object.keys(t));this.allColumnFilters.forEach((function(o,i){var s=t[i];n.push(e.setModelOnFilterWrapper(o.filterPromise,s)),r.delete(i)})),r.forEach((function(o){var r=e.columnModel.getPrimaryColumn(o)||e.columnModel.getGridColumn(o);if(r)if(r.isFilterAllowed()){var i=e.getOrCreateFilterWrapper(r,"NO_UI");i?n.push(e.setModelOnFilterWrapper(i.filterPromise,t[o])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+o)}else console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+o);else console.warn("AG Grid: setFilterModel() - no column found for colId: "+o)}))}else this.allColumnFilters.forEach((function(t){n.push(e.setModelOnFilterWrapper(t.filterPromise,null))}));mr.all(n).then((function(){var t=e.getFilterModel(),n=[];e.allColumnFilters.forEach((function(e,r){var i=o?o[r]:null,s=t?t[r]:null;hr.jsonEquals(i,s)||n.push(e.column)})),n.length>0&&e.onFilterChanged({columns:n,source:"api"})}))}},e.prototype.setModelOnFilterWrapper=function(t,e){return new mr((function(n){t.then((function(t){"function"!==typeof t.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),n()),(t.setModel(e)||mr.resolve()).then((function(){return n()}))}))}))},e.prototype.getFilterModel=function(){var t={};return this.allColumnFilters.forEach((function(e,n){var o=e.filterPromise.resolveNow(null,(function(t){return t}));if(null==o)return null;if("function"===typeof o.getModel){var i=o.getModel();r(i)&&(t[n]=i)}else console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel")})),t},e.prototype.isColumnFilterPresent=function(){return this.activeColumnFilters.length>0},e.prototype.isAggregateFilterPresent=function(){return!!this.activeAggregateFilters.length},e.prototype.isExternalFilterPresent=function(){return this.externalFilterPresent},e.prototype.isChildFilterPresent=function(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()},e.prototype.isAdvancedFilterPresent=function(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()},e.prototype.onAdvancedFilterEnabledChanged=function(t){var e,n=this;t?this.allColumnFilters.size&&(this.allColumnFilters.forEach((function(t){return n.disposeFilterWrapper(t,"advancedFilterEnabled")})),this.onFilterChanged({source:"advancedFilter"})):(null===(e=this.advancedFilterService)||void 0===e?void 0:e.isFilterPresent())&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))},e.prototype.isAdvancedFilterEnabled=function(){var t;return null===(t=this.advancedFilterService)||void 0===t?void 0:t.isEnabled()},e.prototype.isAdvancedFilterHeaderActive=function(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()},e.prototype.doAggregateFiltersPass=function(t,e){return this.doColumnFiltersPass(t,e,!0)},e.prototype.updateActiveFilters=function(){var t=this;this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;var e=function(t){return!!t&&(t.isFilterActive?t.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1))},n=!!this.gridOptionsService.getGroupAggFiltering();this.allColumnFilters.forEach((function(o){if(o.filterPromise.resolveNow(!1,e)){var r=o.filterPromise.resolveNow(null,(function(t){return t}));!function(e){if(!e.isPrimary())return!0;var o=!t.columnModel.isPivotActive();return!(!e.isValueActive()||!o)&&(!!t.columnModel.isPivotMode()||n)}(o.column)?t.activeColumnFilters.push(r):t.activeAggregateFilters.push(r)}}))},e.prototype.updateFilterFlagInColumns=function(t,e){this.allColumnFilters.forEach((function(n){var o=n.filterPromise.resolveNow(!1,(function(t){return t.isFilterActive()}));n.column.setFilterActive(o,t,e)}))},e.prototype.isAnyFilterPresent=function(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()},e.prototype.doColumnFiltersPass=function(t,e,n){for(var o=t.data,r=t.aggData,i=n?this.activeAggregateFilters:this.activeColumnFilters,s=n?r:o,a=0;a<i.length;a++){var l=i[a];if(null!=l&&l!==e){if("function"!==typeof l.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:t,data:s}))return!1}}return!0},e.prototype.parseQuickFilter=function(t){return r(t)?this.gridOptionsService.isRowModelType("clientSide")?t.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null},e.prototype.setQuickFilter=function(t){if(null==t||"string"===typeof t){var e=this.parseQuickFilter(t);this.quickFilter!==e&&(this.quickFilter=e,this.setQuickFilterParts(),this.onFilterChanged({source:"quickFilter"}))}else console.warn("AG Grid - setQuickFilter() only supports string inputs, received: "+typeof t)},e.prototype.resetQuickFilterCache=function(){this.rowModel.forEachNode((function(t){return t.quickFilterAggregateText=null}))},e.prototype.onIncludeHiddenColumnsInQuickFilterChanged=function(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged({source:"quickFilter"})},e.prototype.refreshFiltersForAggregations=function(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()},e.prototype.callOnFilterChangedOutsideRenderCycle=function(t){var e=this,n=function(){return e.onFilterChanged(t)};this.rowRenderer.isRefreshInProgress()?setTimeout(n,0):n()},e.prototype.onFilterChanged=function(t){void 0===t&&(t={});var e=t.source,n=t.filterInstance,o=t.additionalEventAttributes,r=t.columns;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",o),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach((function(t){t.filterPromise&&t.filterPromise.then((function(t){t&&t!==n&&t.onAnyFilterChanged&&t.onAnyFilterChanged()}))}));var i={source:e,type:Zt.EVENT_FILTER_CHANGED,columns:r||[]};o&&x(i,o),this.processingFilterChange=!0,this.eventService.dispatchEvent(i),this.processingFilterChange=!1},e.prototype.isSuppressFlashingCellsBecauseFiltering=function(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange},e.prototype.isQuickFilterPresent=function(){return null!==this.quickFilter},e.prototype.updateAggFiltering=function(){this.aggFiltering=!!this.gridOptionsService.getGroupAggFiltering()},e.prototype.isAggregateQuickFilterPresent=function(){return this.isQuickFilterPresent()&&(this.aggFiltering||this.columnModel.isPivotMode())},e.prototype.isNonAggregateQuickFilterPresent=function(){return this.isQuickFilterPresent()&&!(this.aggFiltering||this.columnModel.isPivotMode())},e.prototype.doesRowPassOtherFilters=function(t,e){return this.doesRowPassFilter({rowNode:e,filterInstanceToSkip:t})},e.prototype.doesRowPassQuickFilterNoCache=function(t,e){var n=this;return this.columnModel.getAllColumnsForQuickFilter().some((function(o){var i=n.getQuickFilterTextForColumn(o,t);return r(i)&&i.indexOf(e)>=0}))},e.prototype.doesRowPassQuickFilterCache=function(t,e){return t.quickFilterAggregateText||this.aggregateRowForQuickFilter(t),t.quickFilterAggregateText.indexOf(e)>=0},e.prototype.doesRowPassQuickFilter=function(t){var e=this,n=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every((function(o){return n?e.doesRowPassQuickFilterCache(t,o):e.doesRowPassQuickFilterNoCache(t,o)}))},e.prototype.doesRowPassAggregateFilters=function(t){return!(this.isAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(t.rowNode))&&!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(t.rowNode,t.filterInstanceToSkip))},e.prototype.doesRowPassFilter=function(t){return!(this.isNonAggregateQuickFilterPresent()&&!this.doesRowPassQuickFilter(t.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(t.rowNode))&&(!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(t.rowNode,t.filterInstanceToSkip))&&!(this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(t.rowNode))))},e.prototype.getQuickFilterTextForColumn=function(t,e){var n=this.valueService.getValue(t,e,!0),o=t.getColDef();if(o.getQuickFilterText){var i={value:n,node:e,data:e.data,column:t,colDef:o,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};n=o.getQuickFilterText(i)}return r(n)?n.toString().toUpperCase():null},e.prototype.aggregateRowForQuickFilter=function(t){var e=this,o=[];this.columnModel.getAllColumnsForQuickFilter().forEach((function(n){var i=e.getQuickFilterTextForColumn(n,t);r(i)&&o.push(i)})),t.quickFilterAggregateText=o.join(n.QUICK_FILTER_SEPARATOR)},e.prototype.onNewRowsLoaded=function(t){this.allColumnFilters.forEach((function(t){t.filterPromise.then((function(t){t.onNewRowsLoaded&&t.onNewRowsLoaded()}))})),this.updateFilterFlagInColumns(t,{afterDataChange:!0}),this.updateActiveFilters()},e.prototype.createValueGetter=function(t){var e=this;return function(n){var o=n.node;return e.valueService.getValue(t,o,!0)}},e.prototype.getFilterComponent=function(t,e,n){var o;if(void 0===n&&(n=!0),n)return(null===(o=this.getOrCreateFilterWrapper(t,e))||void 0===o?void 0:o.filterPromise)||null;var r=this.cachedFilter(t);return r?r.filterPromise:null},e.prototype.isFilterActive=function(t){var e=this.cachedFilter(t);return!!e&&e.filterPromise.resolveNow(!1,(function(t){return t.isFilterActive()}))},e.prototype.getOrCreateFilterWrapper=function(t,e){var n=this;if(!t.isFilterAllowed())return null;var o=this.cachedFilter(t);if(o)"NO_UI"!==e&&this.putIntoGui(o,e);else{o=this.createFilterWrapper(t,e);var r=t.getColId();this.allColumnFilters.set(r,o),this.allColumnListeners.set(r,this.addManagedListener(t,ht.EVENT_COL_DEF_CHANGED,(function(){return n.checkDestroyFilter(r)})))}return o},e.prototype.cachedFilter=function(t){return this.allColumnFilters.get(t.getColId())},e.prototype.getDefaultFilter=function(t){var e;if(W.__isRegistered(z.SetFilterModule,this.context.getGridId()))e="agSetColumnFilter";else{var n=t.getColDef().cellDataType;e="number"===n?"agNumberColumnFilter":"date"===n||"dateString"===n?"agDateColumnFilter":"agTextColumnFilter"}return e},e.prototype.getDefaultFloatingFilter=function(t){var e;if(W.__isRegistered(z.SetFilterModule,this.context.getGridId()))e="agSetColumnFloatingFilter";else{var n=t.getColDef().cellDataType;e="number"===n?"agNumberColumnFloatingFilter":"date"===n||"dateString"===n?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return e},e.prototype.createFilterInstance=function(t){var e,n=this,o=this.getDefaultFilter(t),r=t.getColDef(),i=dl(dl({},this.createFilterParams(t,r)),{filterModifiedCallback:function(){var o={type:Zt.EVENT_FILTER_MODIFIED,column:t,filterInstance:e};n.eventService.dispatchEvent(o)},filterChangedCallback:function(o){var r,i=null!==(r=null===o||void 0===o?void 0:o.source)&&void 0!==r?r:"api",s={filterInstance:e,additionalEventAttributes:o,columns:[t],source:i};n.callOnFilterChangedOutsideRenderCycle(s)},doesRowPassOtherFilter:function(t){return n.doesRowPassOtherFilters(e,t)}}),s=this.userComponentFactory.getFilterDetails(r,i,o);return s?{filterPromise:function(){var t=s.newAgStackInstance();return t&&t.then((function(t){return e=t})),t},compDetails:s}:{filterPromise:null,compDetails:null}},e.prototype.createFilterParams=function(t,e){return{column:t,colDef:m(e),rowModel:this.rowModel,filterChangedCallback:function(){},filterModifiedCallback:function(){},valueGetter:this.createValueGetter(t),doesRowPassOtherFilter:function(){return!0},api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},e.prototype.createFilterWrapper=function(t,e){var n,o={column:t,filterPromise:null,compiledElement:null,guiPromise:mr.resolve(null),compDetails:null},r=this.createFilterInstance(t),i=r.filterPromise,s=r.compDetails;return o.filterPromise=null!==(n=null===i||void 0===i?void 0:i())&&void 0!==n?n:null,o.compDetails=s,i&&this.putIntoGui(o,e),o},e.prototype.putIntoGui=function(t,e){var n=this,o=document.createElement("div");o.className="ag-filter",t.guiPromise=new mr((function(i){t.filterPromise.then((function(s){var a=s.getGui();r(a)||console.warn("AG Grid: getGui method from filter returned "+a+", it should be a DOM element or an HTML template string."),"string"===typeof a&&(a=Oo(a)),o.appendChild(a),i(o);var l={type:Zt.EVENT_FILTER_OPENED,column:t.column,source:e,eGui:o};n.eventService.dispatchEvent(l)}))}))},e.prototype.onColumnsChanged=function(){var t=this,e=[];this.allColumnFilters.forEach((function(n,o){(n.column.isPrimary()?t.columnModel.getPrimaryColumn(o):t.columnModel.getGridColumn(o))||(e.push(n.column),t.disposeFilterWrapper(n,"columnChanged"),t.disposeColumnListener(o))})),e.length>0?this.onFilterChanged({columns:e,source:"api"}):this.updateDependantFilters()},e.prototype.updateDependantFilters=function(){var t=this,e=this.columnModel.getGroupAutoColumns();null===e||void 0===e||e.forEach((function(e){"agGroupColumnFilter"===e.getColDef().filter&&t.getOrCreateFilterWrapper(e,"NO_UI")}))},e.prototype.isFilterAllowed=function(t){var e,n;if(this.isAdvancedFilterEnabled())return!1;if(!t.isFilterAllowed())return!1;var o=this.allColumnFilters.get(t.getColId());return null===(n=null===(e=null===o||void 0===o?void 0:o.filterPromise)||void 0===e?void 0:e.resolveNow(!0,(function(t){var e,n;return"function"!==typeof(null===(e=t)||void 0===e?void 0:e.isFilterAllowed)||(null===(n=t)||void 0===n?void 0:n.isFilterAllowed())})))||void 0===n||n},e.prototype.getFloatingFilterCompDetails=function(t,e){var n=this,o=t.getColDef(),r=this.createFilterParams(t,o),i=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(o,Wa,r),s=this.userComponentFactory.getDefaultFloatingFilterType(o,(function(){return n.getDefaultFloatingFilter(t)}));null==s&&(s="agReadOnlyFloatingFilter");var a={column:t,filterParams:i,currentParentModel:function(){return n.getCurrentFloatingFilterParentModel(t)},parentFilterInstance:function(e){var o=n.getFilterComponent(t,"NO_UI");null!=o&&o.then((function(t){e(ul(t))}))},showParentFilter:e,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(o,a,s)},e.prototype.getCurrentFloatingFilterParentModel=function(t){var e=this.getFilterComponent(t,"NO_UI",!1);return e?e.resolveNow(null,(function(t){return t&&t.getModel()})):null},e.prototype.destroyFilter=function(t,e){void 0===e&&(e="api");var n=t.getColId(),o=this.allColumnFilters.get(n);this.disposeColumnListener(n),o&&(this.disposeFilterWrapper(o,e),this.onFilterChanged({columns:[t],source:"api"}))},e.prototype.disposeColumnListener=function(t){var e=this.allColumnListeners.get(t);e&&(this.allColumnListeners.delete(t),e())},e.prototype.disposeFilterWrapper=function(t,e){var n=this;t.filterPromise.then((function(o){(o.setModel(null)||mr.resolve()).then((function(){n.getContext().destroyBean(o),t.column.setFilterActive(!1,"filterDestroyed"),n.allColumnFilters.delete(t.column.getColId());var r={type:Zt.EVENT_FILTER_DESTROYED,source:e,column:t.column};n.eventService.dispatchEvent(r)}))}))},e.prototype.checkDestroyFilter=function(t){var e=this.allColumnFilters.get(t);if(e){var n=e.column,o=(n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null}).compDetails;this.areFilterCompsDifferent(e.compDetails,o)&&this.destroyFilter(n,"columnChanged")}},e.prototype.areFilterCompsDifferent=function(t,e){if(!e||!t)return!0;var n=t.componentClass,o=e.componentClass;return!(n===o||(null===n||void 0===n?void 0:n.render)&&(null===o||void 0===o?void 0:o.render)&&n.render===o.render)},e.prototype.getAdvancedFilterModel=function(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null},e.prototype.setAdvancedFilterModel=function(t){this.isAdvancedFilterEnabled()&&(this.advancedFilterService.setModel(t),this.onFilterChanged({source:"advancedFilter"}))},e.prototype.updateAdvancedFilterColumns=function(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})},e.prototype.hasFloatingFilters=function(){if(this.isAdvancedFilterEnabled())return!1;var t=this.columnModel.getAllGridColumns();return!!t&&t.some((function(t){return t.getColDef().floatingFilter}))},e.prototype.getFilterInstance=function(t,e){if(!this.isAdvancedFilterEnabled()){var n=this.getFilterInstanceImpl(t,(function(t){if(e){var n=ul(t);e(n)}}));return ul(n)}this.warnAdvancedFilters()},e.prototype.getFilterInstanceImpl=function(t,e){var n=this.columnModel.getPrimaryColumn(t);if(n){var o=this.getFilterComponent(n,"NO_UI"),r=o&&o.resolveNow(null,(function(t){return t}));return r?setTimeout(e,0,r):o&&o.then((function(t){e(t)})),r}},e.prototype.warnAdvancedFilters=function(){P((function(){console.warn("AG Grid: Column Filter API methods have been disabled as Advanced Filters are enabled.")}),"advancedFiltersCompatibility")},e.prototype.setupAdvancedFilterHeaderComp=function(t){var e;null===(e=this.advancedFilterService)||void 0===e||e.getCtrl().setupHeaderComp(t)},e.prototype.getHeaderRowCount=function(){return this.isAdvancedFilterHeaderActive()?1:0},e.prototype.getHeaderHeight=function(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0},e.prototype.processFilterModelUpdateQueue=function(){var t=this;this.filterModelUpdateQueue.forEach((function(e){return t.setFilterModel(e)})),this.filterModelUpdateQueue=[]},e.prototype.destroy=function(){var e=this;t.prototype.destroy.call(this),this.allColumnFilters.forEach((function(t){return e.disposeFilterWrapper(t,"gridDestroyed")})),this.allColumnListeners.clear()},e.QUICK_FILTER_SEPARATOR="\n",fl([$("valueService")],e.prototype,"valueService",void 0),fl([$("columnModel")],e.prototype,"columnModel",void 0),fl([$("rowModel")],e.prototype,"rowModel",void 0),fl([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),fl([$("rowRenderer")],e.prototype,"rowRenderer",void 0),fl([$("dataTypeService")],e.prototype,"dataTypeService",void 0),fl([tt("advancedFilterService")],e.prototype,"advancedFilterService",void 0),fl([Z],e.prototype,"init",null),e=n=fl([Q("filterManager")],e)}(Ht),ml=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),yl=function(t){function e(e,n){var o=t.call(this,e)||this;return o.ctrl=n,o}return ml(e,t),e.prototype.getCtrl=function(){return this.ctrl},e}(Tr),vl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_l=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Cl=function(t){function e(n){return t.call(this,e.TEMPLATE,n)||this}return vl(e,t),e.prototype.postConstruct=function(){var t=this,e=this.getGui(),n={addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},addOrRemoveBodyCssClass:function(e,n){return t.eFloatingFilterBody.classList.toggle(e,n)},setButtonWrapperDisplayed:function(e){return po(t.eButtonWrapper,e)},setCompDetails:function(e){return t.setCompDetails(e)},getFloatingFilterComp:function(){return t.compPromise},setWidth:function(t){return e.style.width=t},setMenuIcon:function(e){return t.eButtonShowMainFilter.appendChild(e)}};this.ctrl.setComp(n,e,this.eButtonShowMainFilter,this.eFloatingFilterBody)},e.prototype.setCompDetails=function(t){var e=this;if(!t)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=t.newAgStackInstance(),this.compPromise.then((function(t){return e.afterCompCreated(t)}))},e.prototype.destroyFloatingFilterComp=function(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))},e.prototype.afterCompCreated=function(t){t&&(this.isAlive()?(this.destroyFloatingFilterComp(),this.floatingFilterComp=t,this.eFloatingFilterBody.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached()):this.destroyBean(t))},e.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',_l([Or("eFloatingFilterBody")],e.prototype,"eFloatingFilterBody",void 0),_l([Or("eButtonWrapper")],e.prototype,"eButtonWrapper",void 0),_l([Or("eButtonShowMainFilter")],e.prototype,"eButtonShowMainFilter",void 0),_l([Z],e.prototype,"postConstruct",null),_l([J],e.prototype,"destroyFloatingFilterComp",null),e}(yl),wl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),bl=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.AUTO_HEIGHT="ag-layout-auto-height",t.NORMAL="ag-layout-normal",t.PRINT="ag-layout-print"}(cl||(cl={}));var xl,El,Sl=function(t){function e(e){var n=t.call(this)||this;return n.view=e,n}return wl(e,t),e.prototype.postConstruct=function(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()},e.prototype.updateLayoutClasses=function(){var t=this.getDomLayout(),e={autoHeight:"autoHeight"===t,normal:"normal"===t,print:"print"===t},n=e.autoHeight?cl.AUTO_HEIGHT:e.print?cl.PRINT:cl.NORMAL;this.view.updateLayoutClasses(n,e)},e.prototype.getDomLayout=function(){var t,e=null!==(t=this.gridOptionsService.get("domLayout"))&&void 0!==t?t:"normal";return-1===["normal","print","autoHeight"].indexOf(e)?(P((function(){return console.warn("AG Grid: "+e+" is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.")}),"warn about dom layout values"),"normal"):e},bl([Z],e.prototype,"postConstruct",null),e}(Ht),Tl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Rl=function(){return Rl=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Rl.apply(this,arguments)},Ol=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal"}(xl||(xl={})),function(t){t[t.Container=0]="Container",t[t.FakeContainer=1]="FakeContainer"}(El||(El={}));var Pl,Il=function(t){function e(e){var n=t.call(this)||this;return n.lastScrollSource=[null,null],n.scrollLeft=-1,n.nextScrollTop=-1,n.scrollTop=-1,n.eBodyViewport=e,n.resetLastHScrollDebounced=k((function(){return n.lastScrollSource[xl.Horizontal]=null}),500),n.resetLastVScrollDebounced=k((function(){return n.lastScrollSource[xl.Vertical]=null}),500),n}return Tl(e,t),e.prototype.postConstruct=function(){var t=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady((function(e){t.centerRowContainerCtrl=e.centerRowContainerCtrl,t.onDisplayedColumnsWidthChanged(),t.addScrollListener()}))},e.prototype.addScrollListener=function(){var t=this.ctrlsService.getFakeHScrollComp(),e=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),t.onScrollCallback(this.onFakeHScroll.bind(this));var n=this.gridOptionsService.is("debounceVerticalScrollbar"),o=n?k(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=n?k(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",o),e.onScrollCallback(r)},e.prototype.onDisplayedColumnsWidthChanged=function(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()},e.prototype.horizontallyScrollHeaderCenterAndFloatingCenter=function(t){if(!(null==this.centerRowContainerCtrl)){void 0===t&&(t=this.centerRowContainerCtrl.getCenterViewportScrollLeft());var e=this.enableRtl?t:-t,n=this.ctrlsService.getTopCenterRowContainerCtrl(),o=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),r=this.ctrlsService.getBottomCenterRowContainerCtrl(),i=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-e),r.setContainerTranslateX(e),n.setContainerTranslateX(e),o.setContainerTranslateX(e);var s=this.centerRowContainerCtrl.getViewportElement(),a=this.lastScrollSource[xl.Horizontal]===El.Container;t=Math.abs(t),a?i.setScrollPosition(t):Eo(s,t,this.enableRtl)}},e.prototype.isControllingScroll=function(t,e){return null==this.lastScrollSource[e]?(this.lastScrollSource[e]=t,!0):this.lastScrollSource[e]===t},e.prototype.onFakeHScroll=function(){this.isControllingScroll(El.FakeContainer,xl.Horizontal)&&this.onHScrollCommon(El.FakeContainer)},e.prototype.onHScroll=function(){this.isControllingScroll(El.Container,xl.Horizontal)&&this.onHScrollCommon(El.Container)},e.prototype.onHScrollCommon=function(t){var e,n=this.centerRowContainerCtrl.getViewportElement(),o=n.scrollLeft;this.shouldBlockScrollUpdate(xl.Horizontal,o,!0)||(e=t===El.Container?xo(n,this.enableRtl):this.ctrlsService.getFakeHScrollComp().getScrollPosition(),this.doHorizontalScroll(Math.round(e)),this.resetLastHScrollDebounced())},e.prototype.onFakeVScroll=function(){this.isControllingScroll(El.FakeContainer,xl.Vertical)&&this.onVScrollCommon(El.FakeContainer)},e.prototype.onVScroll=function(){this.isControllingScroll(El.Container,xl.Vertical)&&this.onVScrollCommon(El.Container)},e.prototype.onVScrollCommon=function(t){var e;e=t===El.Container?this.eBodyViewport.scrollTop:this.ctrlsService.getFakeVScrollComp().getScrollPosition(),this.shouldBlockScrollUpdate(xl.Vertical,e,!0)||(this.animationFrameService.setScrollTop(e),this.nextScrollTop=e,t===El.Container?this.ctrlsService.getFakeVScrollComp().setScrollPosition(e):this.eBodyViewport.scrollTop=e,this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())},e.prototype.doHorizontalScroll=function(t){var e=this.ctrlsService.getFakeHScrollComp().getScrollPosition();this.scrollLeft===t&&t===e||(this.scrollLeft=t,this.fireScrollEvent(xl.Horizontal),this.horizontallyScrollHeaderCenterAndFloatingCenter(t),this.onHorizontalViewportChanged())},e.prototype.fireScrollEvent=function(t){var e=this,n={type:Zt.EVENT_BODY_SCROLL,direction:t===xl.Horizontal?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(n),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout((function(){var t=Rl(Rl({},n),{type:Zt.EVENT_BODY_SCROLL_END});e.eventService.dispatchEvent(t)}),100)},e.prototype.shouldBlockScrollUpdate=function(t,e,n){return void 0===n&&(n=!1),!(n&&!Bn())&&(t===xl.Vertical?this.shouldBlockVerticalScroll(e):this.shouldBlockHorizontalScroll(e))},e.prototype.shouldBlockVerticalScroll=function(t){var e=yo(this.eBodyViewport),n=this.eBodyViewport.scrollHeight;return t<0||t+e>n},e.prototype.shouldBlockHorizontalScroll=function(t){var e=this.centerRowContainerCtrl.getCenterWidth(),n=this.centerRowContainerCtrl.getViewportElement().scrollWidth;if(this.enableRtl&&bo()){if(t>0)return!0}else if(t<0)return!0;return Math.abs(t)+e>n},e.prototype.redrawRowsAfterScroll=function(){this.fireScrollEvent(xl.Vertical)},e.prototype.onHorizontalViewportChanged=function(){this.centerRowContainerCtrl.onHorizontalViewportChanged()},e.prototype.checkScrollLeft=function(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(El.Container)},e.prototype.scrollGridIfNeeded=function(){var t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),t},e.prototype.setHorizontalScrollPosition=function(t,e){void 0===e&&(e=!1);var n=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();!e&&this.shouldBlockScrollUpdate(xl.Horizontal,t)&&(t=this.enableRtl&&bo()?t>0?0:n:Math.min(Math.max(t,0),n)),Eo(this.centerRowContainerCtrl.getViewportElement(),Math.abs(t),this.enableRtl),this.doHorizontalScroll(t)},e.prototype.setVerticalScrollPosition=function(t){this.eBodyViewport.scrollTop=t},e.prototype.getVScrollPosition=function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}},e.prototype.getHScrollPosition=function(){return this.centerRowContainerCtrl.getHScrollPosition()},e.prototype.isHorizontalScrollShowing=function(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()},e.prototype.scrollHorizontally=function(t){var e=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(e+t),this.centerRowContainerCtrl.getViewportElement().scrollLeft-e},e.prototype.scrollToTop=function(){this.eBodyViewport.scrollTop=0},e.prototype.ensureNodeVisible=function(t,e){void 0===e&&(e=null);for(var n=this.rowModel.getRowCount(),o=-1,r=0;r<n;r++){var i=this.rowModel.getRow(r);if("function"===typeof t){if(i&&t(i)){o=r;break}}else if(t===i||t===i.data){o=r;break}}o>=0&&this.ensureIndexVisible(o,e)},e.prototype.ensureIndexVisible=function(t,e){if(!this.gridOptionsService.isDomLayout("print")){var n=this.paginationProxy.getRowCount();if("number"!==typeof t||t<0||t>=n)console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+t);else{this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(t);var o,r=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),i=this.paginationProxy.getRow(t);do{var s=i.rowTop,a=i.rowHeight,l=this.paginationProxy.getPixelOffset(),u=i.rowTop-l,c=u+i.rowHeight,p=this.getVScrollPosition(),h=this.heightScaler.getDivStretchOffset(),d=p.top+h,f=p.bottom+h,g=f-d,m=this.heightScaler.getScrollPositionForPixel(u),y=this.heightScaler.getScrollPositionForPixel(c-g),v=Math.min((m+y)/2,u),_=null;"top"===e?_=m:"bottom"===e?_=y:"middle"===e?_=v:d+r>u?_=m-r:f<c&&(_=y),null!==_&&(this.setVerticalScrollPosition(_),this.rowRenderer.redraw({afterScroll:!0})),o=s!==i.rowTop||a!==i.rowHeight}while(o);this.animationFrameService.flushAllFrames()}}},e.prototype.ensureColumnVisible=function(t,e){void 0===e&&(e="auto");var n=this.columnModel.getGridColumn(t);if(n&&!n.isPinned()&&this.columnModel.isColumnDisplayed(n)){var o=this.getPositionedHorizontalScroll(n,e);null!==o&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(o),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}},e.prototype.getPositionedHorizontalScroll=function(t,e){var n=this.isColumnOutsideViewport(t),o=n.columnBeforeStart,r=n.columnAfterEnd,i=this.centerRowContainerCtrl.getCenterWidth()<t.getActualWidth(),s=this.centerRowContainerCtrl.getCenterWidth(),a=this.enableRtl,l=(a?o:r)||i,u=a?r:o;"auto"!==e&&(l="start"===e,u="end"===e);var c="middle"===e;if(l||u||c){var p=this.getColumnBounds(t),h=p.colLeft,d=p.colMiddle,f=p.colRight;return c?d-s/2:l?a?f:h:a?h-s:f-s}return null},e.prototype.isColumnOutsideViewport=function(t){var e=this.getViewportBounds(),n=e.start,o=e.end,r=this.getColumnBounds(t),i=r.colLeft,s=r.colRight,a=this.enableRtl;return{columnBeforeStart:a?n>s:o<s,columnAfterEnd:a?o<i:n>i}},e.prototype.getColumnBounds=function(t){var e=this.enableRtl,n=this.columnModel.getBodyContainerWidth(),o=t.getActualWidth(),r=t.getLeft(),i=e?-1:1,s=e?n-r:r;return{colLeft:s,colMiddle:s+o/2*i,colRight:s+o*i}},e.prototype.getViewportBounds=function(){var t=this.centerRowContainerCtrl.getCenterWidth(),e=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:e,end:t+e,width:t}},Ol([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Ol([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Ol([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Ol([$("rowModel")],e.prototype,"rowModel",void 0),Ol([$("rowContainerHeightService")],e.prototype,"heightScaler",void 0),Ol([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Ol([$("columnModel")],e.prototype,"columnModel",void 0),Ol([Z],e.prototype,"postConstruct",null),e}(Ht),Al=function(){function t(t){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=t.scrollContainer,this.scrollHorizontally=-1!==t.scrollAxis.indexOf("x"),this.scrollVertically=-1!==t.scrollAxis.indexOf("y"),this.scrollByTick=null!=t.scrollByTick?t.scrollByTick:20,t.onScrollCallback&&(this.onScrollCallback=t.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=t.getVerticalPosition,this.setVerticalPosition=t.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=t.getHorizontalPosition,this.setHorizontalPosition=t.setHorizontalPosition),this.shouldSkipVerticalScroll=t.shouldSkipVerticalScroll||function(){return!1},this.shouldSkipHorizontalScroll=t.shouldSkipHorizontalScroll||function(){return!1}}return t.prototype.check=function(t,e){void 0===e&&(e=!1);var n=e||this.shouldSkipVerticalScroll();if(!n||!this.shouldSkipHorizontalScroll()){var o=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=t.clientX<o.left+r,this.tickRight=t.clientX>o.right-r,this.tickUp=t.clientY<o.top+r&&!n,this.tickDown=t.clientY>o.bottom-r&&!n,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}},t.prototype.ensureTickingStarted=function(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)},t.prototype.doTick=function(){var t;if(this.tickCount++,t=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){var e=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(e-t),this.tickDown&&this.setVerticalPosition(e+t)}if(this.scrollHorizontally){var n=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(n-t),this.tickRight&&this.setHorizontalPosition(n+t)}this.onScrollCallback&&this.onScrollCallback()},t.prototype.ensureCleared=function(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)},t}(),Dl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ml=function(){return Ml=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ml.apply(this,arguments)},Ll=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Nl=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Fl=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},kl=function(t){function e(e){var n=t.call(this)||this;return n.isMultiRowDrag=!1,n.isGridSorted=!1,n.isGridFiltered=!1,n.isRowGroupActive=!1,n.eContainer=e,n}return Dl(e,t),e.prototype.postConstruct=function(){var t=this;this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);var e=function(){t.onSortChanged(),t.onFilterChanged(),t.onRowGroupChanged()};this.addManagedListener(this.eventService,Zt.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_MODEL_UPDATED,(function(){e()})),e(),this.ctrlsService.whenReady((function(){var e=t.ctrlsService.getGridBodyCtrl();t.autoScrollService=new Al({scrollContainer:e.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:function(){return e.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(t){return e.getScrollFeature().setVerticalScrollPosition(t)},onScrollCallback:function(){t.onDragging(t.lastDraggingEvent)}})}))},e.prototype.onSortChanged=function(){this.isGridSorted=this.sortController.isSortActive()},e.prototype.onFilterChanged=function(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()},e.prototype.onRowGroupChanged=function(){var t=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!s(t)},e.prototype.getContainer=function(){return this.eContainer},e.prototype.isInterestedIn=function(t){return t===Hi.RowDrag},e.prototype.getIconName=function(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?qs.ICON_NOT_ALLOWED:qs.ICON_MOVE},e.prototype.shouldPreventRowMove=function(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive},e.prototype.getRowNodes=function(t){var e=this;if(!this.isFromThisGrid(t))return t.dragItem.rowNodes||[];var n=this.gridOptionsService.is("rowDragMultiRow"),o=Fl([],Nl(this.selectionService.getSelectedNodes())).sort((function(t,n){return null==t.rowIndex||null==n.rowIndex?0:e.getRowIndexNumber(t)-e.getRowIndexNumber(n)})),r=t.dragItem.rowNode;return n&&-1!==o.indexOf(r)?(this.isMultiRowDrag=!0,o):(this.isMultiRowDrag=!1,[r])},e.prototype.onDragEnter=function(t){t.dragItem.rowNodes=this.getRowNodes(t),this.dispatchGridEvent(Zt.EVENT_ROW_DRAG_ENTER,t),this.getRowNodes(t).forEach((function(t){t.setDragging(!0)})),this.onEnterOrDragging(t)},e.prototype.onDragging=function(t){this.onEnterOrDragging(t)},e.prototype.isFromThisGrid=function(t){return t.dragSource.dragSourceDomDataKey===this.gridOptionsService.getDomDataKey()},e.prototype.isDropZoneWithinThisGrid=function(t){var e=this.ctrlsService.getGridBodyCtrl().getGui(),n=t.dropZoneTarget;return!e.contains(n)},e.prototype.onEnterOrDragging=function(t){this.dispatchGridEvent(Zt.EVENT_ROW_DRAG_MOVE,t),this.lastDraggingEvent=t;var e=this.mouseEventService.getNormalisedPosition(t).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(t,e),this.autoScrollService.check(t.event)},e.prototype.doManagedDrag=function(t,e){var n=this.isFromThisGrid(t),o=this.gridOptionsService.is("rowDragManaged"),r=t.dragItem.rowNodes;o&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!n?this.isDropZoneWithinThisGrid(t)||this.clientSideRowModel.highlightRowAtPixel(r[0],e):this.moveRows(r,e))},e.prototype.getRowIndexNumber=function(t){return parseInt(yt(t.getRowIndexString().split("-")),10)},e.prototype.moveRowAndClearHighlight=function(t){var e=this,n=this.clientSideRowModel.getLastHighlightedRowNode(),o=n&&n.highlighted===ol.Below,r=this.mouseEventService.getNormalisedPosition(t).y,i=t.dragItem.rowNodes,s=o?1:0;if(this.isFromThisGrid(t))i.forEach((function(t){t.rowTop<r&&(s-=1)})),this.moveRows(i,r,s);else{var a=this.gridOptionsService.getCallback("getRowId"),l=this.clientSideRowModel.getRowIndexAtPixel(r)+1;this.clientSideRowModel.getHighlightPosition(r)===ol.Above&&l--,this.clientSideRowModel.updateRowData({add:i.map((function(t){return t.data})).filter((function(t){return!e.clientSideRowModel.getRowNode(a?a({data:t,level:0}):t.id)})),addIndex:l})}this.clearRowHighlight()},e.prototype.clearRowHighlight=function(){this.clientSideRowModel.highlightRowAtPixel(null)},e.prototype.moveRows=function(t,e,n){void 0===n&&(n=0),this.clientSideRowModel.ensureRowsAtPixel(t,e,n)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())},e.prototype.addRowDropZone=function(t){var e=this;if(t.getContainer())if(this.dragAndDropService.findExternalZone(t))console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");else{var n={getContainer:t.getContainer};t.fromGrid?(t.fromGrid=void 0,n=t):(t.onDragEnter&&(n.onDragEnter=function(n){t.onDragEnter(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_ENTER,n))}),t.onDragLeave&&(n.onDragLeave=function(n){t.onDragLeave(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_LEAVE,n))}),t.onDragging&&(n.onDragging=function(n){t.onDragging(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_MOVE,n))}),t.onDragStop&&(n.onDragStop=function(n){t.onDragStop(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_END,n))})),this.dragAndDropService.addDropTarget(Ml({isInterestedIn:function(t){return t===Hi.RowDrag},getIconName:function(){return qs.ICON_MOVE},external:!0},n))}else P((function(){return console.warn("AG Grid: addRowDropZone - A container target needs to be provided")}),"add-drop-zone-empty-target")},e.prototype.getRowDropZone=function(t){var e=this,n=this.getContainer.bind(this),o=this.onDragEnter.bind(this),r=this.onDragLeave.bind(this),i=this.onDragging.bind(this),s=this.onDragStop.bind(this);return t?{getContainer:n,onDragEnter:t.onDragEnter?function(n){o(n),t.onDragEnter(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_ENTER,n))}:o,onDragLeave:t.onDragLeave?function(n){r(n),t.onDragLeave(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_LEAVE,n))}:r,onDragging:t.onDragging?function(n){i(n),t.onDragging(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_MOVE,n))}:i,onDragStop:t.onDragStop?function(n){s(n),t.onDragStop(e.draggingToRowDragEvent(Zt.EVENT_ROW_DRAG_END,n))}:s,fromGrid:!0}:{getContainer:n,onDragEnter:o,onDragLeave:r,onDragging:i,onDragStop:s,fromGrid:!0}},e.prototype.draggingToRowDragEvent=function(t,e){var n,o,r=this.mouseEventService.getNormalisedPosition(e).y,i=-1;switch(r>this.paginationProxy.getCurrentPageHeight()||(i=this.rowModel.getRowIndexAtPixel(r),n=this.rowModel.getRow(i)),e.vDirection){case Ui.Down:o="down";break;case Ui.Up:o="up";break;default:o=null}return{type:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:e.event,node:e.dragItem.rowNode,nodes:e.dragItem.rowNodes,overIndex:i,overNode:n,y:r,vDirection:o}},e.prototype.dispatchGridEvent=function(t,e){var n=this.draggingToRowDragEvent(t,e);this.eventService.dispatchEvent(n)},e.prototype.onDragLeave=function(t){this.dispatchGridEvent(Zt.EVENT_ROW_DRAG_LEAVE,t),this.stopDragging(t),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(t)&&(this.isMultiRowDrag=!1)},e.prototype.onDragStop=function(t){this.dispatchGridEvent(Zt.EVENT_ROW_DRAG_END,t),this.stopDragging(t),!this.gridOptionsService.is("rowDragManaged")||!this.gridOptionsService.is("suppressMoveWhenRowDragging")&&this.isFromThisGrid(t)||this.isDropZoneWithinThisGrid(t)||this.moveRowAndClearHighlight(t)},e.prototype.stopDragging=function(t){this.autoScrollService.ensureCleared(),this.getRowNodes(t).forEach((function(t){t.setDragging(!1)}))},Ll([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Ll([$("rowModel")],e.prototype,"rowModel",void 0),Ll([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Ll([$("columnModel")],e.prototype,"columnModel",void 0),Ll([$("focusService")],e.prototype,"focusService",void 0),Ll([$("sortController")],e.prototype,"sortController",void 0),Ll([$("filterManager")],e.prototype,"filterManager",void 0),Ll([$("selectionService")],e.prototype,"selectionService",void 0),Ll([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Ll([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Ll([tt("rangeService")],e.prototype,"rangeService",void 0),Ll([Z],e.prototype,"postConstruct",null),e}(Ht),Gl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bl=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.ANIMATION_ON="ag-row-animation",t.ANIMATION_OFF="ag-row-no-animation"}(Pl||(Pl={}));var Vl,zl,jl="ag-force-vertical-scroll",Hl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stickyTopHeight=0,e}return Gl(e,t),e.prototype.getScrollFeature=function(){return this.bodyScrollFeature},e.prototype.getBodyViewportElement=function(){return this.eBodyViewport},e.prototype.setComp=function(t,e,n,o,r,i){this.comp=t,this.eGridBody=e,this.eBodyViewport=n,this.eTop=o,this.eBottom=r,this.eStickyTop=i,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new Sl(this.comp)),this.bodyScrollFeature=this.createManagedBean(new Il(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([o,n,r,i]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(o),this.ctrlsService.registerGridBodyCtrl(this)},e.prototype.getComp=function(){return this.comp},e.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Zt.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))},e.prototype.addFocusListeners=function(t){var e=this;t.forEach((function(t){e.addManagedListener(t,"focusin",(function(e){var n=go(e.target,"ag-root",t);t.classList.toggle("ag-has-focus",!n)})),e.addManagedListener(t,"focusout",(function(e){var n=e.target,o=e.relatedTarget,r=t.contains(o),i=go(o,"ag-root",t);go(n,"ag-root",t)||r&&!i||t.classList.remove("ag-has-focus")}))}))},e.prototype.setColumnMovingCss=function(t){this.comp.setColumnMovingCss("ag-column-moving",t)},e.prototype.setCellTextSelection=function(t){void 0===t&&(t=!1),this.comp.setCellSelectableCss("ag-selectable",t)},e.prototype.onScrollVisibilityChanged=function(){var t=this,e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyTopWidth(e);var n="calc(100% + "+((e&&this.gridOptionsService.getScrollbarWidth()||0)+(Xn()?16:0))+"px)";this.animationFrameService.requestAnimationFrame((function(){return t.comp.setBodyViewportWidth(n)}))},e.prototype.onGridColumnsChanged=function(){var t=this.columnModel.getAllGridColumns();this.comp.setColumnCount(t?t.length:0)},e.prototype.disableBrowserDragging=function(){this.addManagedListener(this.eGridBody,"dragstart",(function(t){if(t.target instanceof HTMLImageElement)return t.preventDefault(),!1}))},e.prototype.addStopEditingWhenGridLosesFocus=function(){var t=this;if(this.gridOptionsService.is("stopEditingWhenCellsLoseFocus")){var e=function(e){var o=e.relatedTarget;if(null!==zn(o)){var r=n.some((function(t){return t.contains(o)}))&&t.mouseEventService.isElementInThisGrid(o);if(!r){var i=t.popupService;r=i.getActivePopups().some((function(t){return t.contains(o)}))||i.isElementWithinCustomPopup(o)}r||t.rowRenderer.stopEditing()}else t.rowRenderer.stopEditing()},n=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];n.forEach((function(n){return t.addManagedListener(n,"focusout",e)}))}},e.prototype.updateRowCount=function(){var t=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),e=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,n=-1===e?-1:t+e;this.comp.setRowCount(n)},e.prototype.registerBodyViewportResizeListener=function(t){this.comp.registerBodyViewportResizeListener(t)},e.prototype.setVerticalScrollPaddingVisible=function(t){var e=t?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(e)},e.prototype.isVerticalScrollShowing=function(){var t=this.gridOptionsService.is("alwaysShowVerticalScroll"),e=t?jl:null,n=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(e,t),t||n&&Fo(this.eBodyViewport)},e.prototype.setupRowAnimationCssClass=function(){var t=this,e=function(){var e=t.gridOptionsService.isAnimateRows()&&!t.rowContainerHeightService.isStretching(),n=e?Pl.ANIMATION_ON:Pl.ANIMATION_OFF;t.comp.setRowAnimationCssOnBodyViewport(n,e)};e(),this.addManagedListener(this.eventService,Zt.EVENT_HEIGHT_SCALE_CHANGED,e),this.addManagedPropertyListener("animateRows",e)},e.prototype.getGridBodyElement=function(){return this.eGridBody},e.prototype.addBodyViewportListener=function(){var t=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",t),this.mockContextMenuForIPad(t),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()},e.prototype.addFullWidthContainerWheelListener=function(){var t=this,e=this.eBodyViewport.querySelector(".ag-full-width-container"),n=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&n&&this.addManagedListener(e,"wheel",(function(e){return t.onFullWidthContainerWheel(e,n)}))},e.prototype.onFullWidthContainerWheel=function(t,e){!t.deltaX||Math.abs(t.deltaY)>Math.abs(t.deltaX)||!this.mouseEventService.isEventFromThisGrid(t)||(t.preventDefault(),e.scrollBy({left:t.deltaX}))},e.prototype.onBodyViewportContextMenu=function(t,e,n){if(t||n){if(this.gridOptionsService.is("preventDefaultOnContextMenu"))(t||n).preventDefault();var o=(t||e).target;if(o===this.eBodyViewport||o===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;t?this.contextMenuFactory.onContextMenu(t,null,null,null,null,this.eGridBody):n&&this.contextMenuFactory.onContextMenu(null,n,null,null,null,this.eGridBody)}}},e.prototype.mockContextMenuForIPad=function(t){if(Bn()){var e=new ss(this.eBodyViewport);this.addManagedListener(e,ss.EVENT_LONG_TAP,(function(e){t(void 0,e.touchStart,e.touchEvent)})),this.addDestroyFunc((function(){return e.destroy()}))}},e.prototype.onBodyViewportWheel=function(t){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&t.preventDefault()},e.prototype.onStickyTopWheel=function(t){t.preventDefault(),t.offsetY&&this.scrollVertically(t.deltaY)},e.prototype.getGui=function(){return this.eGridBody},e.prototype.scrollVertically=function(t){var e=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(e+t),this.eBodyViewport.scrollTop-e},e.prototype.addRowDragListener=function(){this.rowDragFeature=this.createManagedBean(new kl(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)},e.prototype.getRowDragFeature=function(){return this.rowDragFeature},e.prototype.onPinnedRowDataChanged=function(){this.setFloatingHeights()},e.prototype.setFloatingHeights=function(){var t=this.pinnedRowModel,e=t.getPinnedTopTotalHeight();e&&(e+=1);var n=t.getPinnedBottomTotalHeight();n&&(n+=1),this.comp.setTopHeight(e),this.comp.setBottomHeight(n),this.comp.setTopDisplay(e?"inherit":"none"),this.comp.setBottomDisplay(n?"inherit":"none"),this.setStickyTopOffsetTop()},e.prototype.setStickyTopHeight=function(t){void 0===t&&(t=0),this.comp.setStickyTopHeight(t+"px"),this.stickyTopHeight=t},e.prototype.getStickyTopHeight=function(){return this.stickyTopHeight},e.prototype.setStickyTopWidth=function(t){if(t){var e=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth("calc(100% - "+e+"px)")}else this.comp.setStickyTopWidth("100%")},e.prototype.onHeaderHeightChanged=function(){this.setStickyTopOffsetTop()},e.prototype.setStickyTopOffsetTop=function(){var t=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight()+this.filterManager.getHeaderHeight(),e=this.pinnedRowModel.getPinnedTopTotalHeight(),n=0;t>0&&(n+=t+1),e>0&&(n+=e+1),this.comp.setStickyTopTop(n+"px")},e.prototype.sizeColumnsToFit=function(t,e){var n=this,o=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,r=vo(this.eGridBody)-o;r>0?this.columnModel.sizeColumnsToFit(r,"sizeColumnsToFit",!1,t):void 0===e?window.setTimeout((function(){n.sizeColumnsToFit(t,100)}),0):100===e?window.setTimeout((function(){n.sizeColumnsToFit(t,500)}),100):500===e?window.setTimeout((function(){n.sizeColumnsToFit(t,-1)}),500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")},e.prototype.addScrollEventListener=function(t){this.eBodyViewport.addEventListener("scroll",t,{passive:!0})},e.prototype.removeScrollEventListener=function(t){this.eBodyViewport.removeEventListener("scroll",t)},Bl([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Bl([$("rowContainerHeightService")],e.prototype,"rowContainerHeightService",void 0),Bl([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Bl([$("columnModel")],e.prototype,"columnModel",void 0),Bl([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Bl([tt("contextMenuFactory")],e.prototype,"contextMenuFactory",void 0),Bl([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),Bl([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Bl([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Bl([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Bl([$("popupService")],e.prototype,"popupService",void 0),Bl([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Bl([$("rowModel")],e.prototype,"rowModel",void 0),Bl([$("filterManager")],e.prototype,"filterManager",void 0),e}(Ht);!function(t){t[t.FILL=0]="FILL",t[t.RANGE=1]="RANGE"}(Vl||(Vl={})),function(t){t[t.VALUE=0]="VALUE",t[t.DIMENSION=1]="DIMENSION"}(zl||(zl={}));var Ul,Wl="ag-cell-range-selected",ql=function(){function t(t,e){this.beans=t,this.cellCtrl=e}return t.prototype.setComp=function(t,e){this.cellComp=t,this.eGui=e,this.onRangeSelectionChanged()},t.prototype.onRangeSelectionChanged=function(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(Wl,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(Wl+"-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass(Wl+"-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass(Wl+"-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass(Wl+"-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),wn(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())},t.prototype.updateRangeBorders=function(){var t=this.getRangeBorders(),e=this.isSingleCell(),n=!e&&t.top,o=!e&&t.right,r=!e&&t.bottom,i=!e&&t.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",o),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",i)},t.prototype.isSingleCell=function(){var t=this.beans.rangeService;return 1===this.rangeCount&&t&&!t.isMoreThanOneCell()},t.prototype.getHasChartRange=function(){var t=this.beans.rangeService;if(!this.rangeCount||!t)return!1;var e=t.getCellRanges();return e.length>0&&e.every((function(t){return Tt([zl.DIMENSION,zl.VALUE],t.type)}))},t.prototype.updateRangeBordersIfRangeCount=function(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())},t.prototype.getRangeBorders=function(){var t,e,n=this,o=this.beans.gridOptionsService.is("enableRtl"),r=!1,i=!1,s=!1,a=!1,l=this.cellCtrl.getCellPosition().column,u=this.beans,c=u.rangeService,p=u.columnModel;o?(t=p.getDisplayedColAfter(l),e=p.getDisplayedColBefore(l)):(t=p.getDisplayedColBefore(l),e=p.getDisplayedColAfter(l));var h=c.getCellRanges().filter((function(t){return c.isCellInSpecificRange(n.cellCtrl.getCellPosition(),t)}));t||(a=!0),e||(i=!0);for(var d=0;d<h.length&&!(r&&i&&s&&a);d++){var f=h[d],g=c.getRangeStartRow(f),m=c.getRangeEndRow(f);!r&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(r=!0),!s&&this.beans.rowPositionUtils.sameRow(m,this.cellCtrl.getCellPosition())&&(s=!0),!a&&t&&f.columns.indexOf(t)<0&&(a=!0),!i&&e&&f.columns.indexOf(e)<0&&(i=!0)}return{top:r,right:i,bottom:s,left:a}},t.prototype.refreshHandle=function(){if(this.beans.rangeService){var t=this.shouldHaveSelectionHandle();this.selectionHandle&&!t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),t&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}},t.prototype.shouldHaveSelectionHandle=function(){var t=this.beans,e=t.gridOptionsService,n=t.rangeService,o=n.getCellRanges(),r=o.length;if(this.rangeCount<1||r<1)return!1;var i=yt(o),s=this.cellCtrl.getCellPosition(),a=e.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),l=e.is("enableRangeHandle"),u=1===r&&!this.cellCtrl.isEditing()&&(a||l);if(this.hasChartRange){var c=o[0].type===zl.DIMENSION&&n.isCellInSpecificRange(s,o[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",c),u=i.type===zl.VALUE}return u&&null!=i.endRow&&n.isContiguousRange(i)&&n.isBottomRightCell(i,s)},t.prototype.addSelectionHandle=function(){var t=this.beans,e=t.gridOptionsService,n=yt(t.rangeService.getCellRanges()).type,o=e.is("enableFillHandle")&&i(n)?Vl.FILL:Vl.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==o&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(o)),this.selectionHandle.refresh(this.cellCtrl)},t.prototype.destroy=function(){this.beans.context.destroyBean(this.selectionHandle)},t}(),Xl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yl=function(t){function e(e,n){var o=t.call(this)||this;return o.cellCtrl=e,o.beans=n,o.column=e.getColumn(),o.rowNode=e.getRowNode(),o.setupColSpan(),o.setupRowSpan(),o}return Xl(e,t),e.prototype.setupRowSpan=function(){this.rowSpan=this.column.getRowSpan(this.rowNode)},e.prototype.setComp=function(t){this.eGui=t,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()},e.prototype.onDisplayColumnsChanged=function(){var t=this.getColSpanningList();vt(this.colsSpanning,t)||(this.colsSpanning=t,this.onWidthChanged(),this.onLeftChanged())},e.prototype.setupColSpan=function(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))},e.prototype.onWidthChanged=function(){if(this.eGui){var t=this.getCellWidth();this.eGui.style.width=t+"px"}},e.prototype.getCellWidth=function(){return this.colsSpanning?this.colsSpanning.reduce((function(t,e){return t+e.getActualWidth()}),0):this.column.getActualWidth()},e.prototype.getColSpanningList=function(){var t=this.column.getColSpan(this.rowNode),e=[];if(1===t)e.push(this.column);else for(var n=this.column,o=this.column.getPinned(),r=0;n&&r<t&&(e.push(n),(n=this.beans.columnModel.getDisplayedColAfter(n))&&!i(n))&&o===n.getPinned();r++);return e},e.prototype.onLeftChanged=function(){if(this.eGui){var t=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=t+"px"}},e.prototype.getCellLeft=function(){return(this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?yt(this.colsSpanning):this.column).getLeft()},e.prototype.modifyLeftForPrintLayout=function(t){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return t;var e=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===this.column.getPinned()?e+this.beans.columnModel.getBodyContainerWidth()+(t||0):e+(t||0)},e.prototype.applyRowSpan=function(){if(1!==this.rowSpan){var t=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=t+"px",this.eGui.style.zIndex="1"}},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Ht),Kl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Zl=function(t){function e(e,n){var o=t.call(this)||this;return o.staticClasses=[],o.cellCtrl=e,o.beans=n,o.column=e.getColumn(),o.rowNode=e.getRowNode(),o}return Kl(e,t),e.prototype.setComp=function(t){this.cellComp=t,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()},e.prototype.applyCellClassRules=function(){var t=this,e=this.column.getColDef(),n={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(e.cellClassRules,n,(function(e){return t.cellComp.addOrRemoveCssClass(e,!0)}),(function(e){return t.cellComp.addOrRemoveCssClass(e,!1)}))},e.prototype.applyUserStyles=function(){var t=this.column.getColDef();if(t.cellStyle){var e;if("function"===typeof t.cellStyle){var n={column:this.column,value:this.cellCtrl.getValue(),colDef:t,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};e=(0,t.cellStyle)(n)}else e=t.cellStyle;e&&this.cellComp.setUserStyles(e)}},e.prototype.applyClassesFromColDef=function(){var t=this,e=this.column.getColDef(),n={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach((function(e){return t.cellComp.addOrRemoveCssClass(e,!1)})),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,n),this.staticClasses.length&&this.staticClasses.forEach((function(e){return t.cellComp.addOrRemoveCssClass(e,!0)}))},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Ht),Jl=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ql=function(t){function e(e,n){var o=t.call(this)||this;return o.ctrl=e,o.beans=n,o}return Jl(e,t),e.prototype.setComp=function(t){this.eGui=t,this.setupTooltip()},e.prototype.setBrowserTooltip=function(t){var e="title";null!=t&&""!=t?this.eGui.setAttribute(e,t):this.eGui.removeAttribute(e)},e.prototype.setupTooltip=function(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.setBrowserTooltip(this.tooltip):this.createTooltipFeatureIfNeeded()},e.prototype.updateTooltipText=function(){this.tooltip=this.ctrl.getTooltipValue()},e.prototype.createTooltipFeatureIfNeeded=function(){var t=this;if(null==this.genericTooltipFeature){var e={getTooltipParams:function(){return t.getTooltipParams()},getGui:function(){return t.ctrl.getGui()}};this.genericTooltipFeature=this.createManagedBean(new wr(e),this.beans.context)}},e.prototype.refreshToolTip=function(){this.updateTooltipText(),this.browserTooltips&&this.setBrowserTooltip(this.tooltip)},e.prototype.getTooltipParams=function(){var t=this,e=this.ctrl,n=e.getColumn?e.getColumn():void 0,o=e.getColDef?e.getColDef():void 0,r=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:o,column:n,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:r,data:r?r.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0,hideTooltipCallback:function(){return t.genericTooltipFeature.hideTooltip(!0)}}},e.prototype.getTooltipText=function(){return this.tooltip},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Ht),$l=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},tu=function(){function t(){}return t.prototype.postConstruct=function(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)},$l([$("resizeObserverService")],t.prototype,"resizeObserverService",void 0),$l([$("paginationProxy")],t.prototype,"paginationProxy",void 0),$l([$("context")],t.prototype,"context",void 0),$l([$("columnApi")],t.prototype,"columnApi",void 0),$l([$("gridApi")],t.prototype,"gridApi",void 0),$l([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),$l([$("expressionService")],t.prototype,"expressionService",void 0),$l([$("environment")],t.prototype,"environment",void 0),$l([$("rowRenderer")],t.prototype,"rowRenderer",void 0),$l([$("templateService")],t.prototype,"templateService",void 0),$l([$("valueService")],t.prototype,"valueService",void 0),$l([$("eventService")],t.prototype,"eventService",void 0),$l([$("columnModel")],t.prototype,"columnModel",void 0),$l([$("headerNavigationService")],t.prototype,"headerNavigationService",void 0),$l([$("navigationService")],t.prototype,"navigationService",void 0),$l([$("columnAnimationService")],t.prototype,"columnAnimationService",void 0),$l([tt("rangeService")],t.prototype,"rangeService",void 0),$l([$("focusService")],t.prototype,"focusService",void 0),$l([tt("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),$l([$("popupService")],t.prototype,"popupService",void 0),$l([$("valueFormatterService")],t.prototype,"valueFormatterService",void 0),$l([$("stylingService")],t.prototype,"stylingService",void 0),$l([$("columnHoverService")],t.prototype,"columnHoverService",void 0),$l([$("userComponentFactory")],t.prototype,"userComponentFactory",void 0),$l([$("userComponentRegistry")],t.prototype,"userComponentRegistry",void 0),$l([$("animationFrameService")],t.prototype,"animationFrameService",void 0),$l([$("dragService")],t.prototype,"dragService",void 0),$l([$("dragAndDropService")],t.prototype,"dragAndDropService",void 0),$l([$("sortController")],t.prototype,"sortController",void 0),$l([$("filterManager")],t.prototype,"filterManager",void 0),$l([$("rowContainerHeightService")],t.prototype,"rowContainerHeightService",void 0),$l([$("frameworkOverrides")],t.prototype,"frameworkOverrides",void 0),$l([$("cellPositionUtils")],t.prototype,"cellPositionUtils",void 0),$l([$("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),$l([$("selectionService")],t.prototype,"selectionService",void 0),$l([tt("selectionHandleFactory")],t.prototype,"selectionHandleFactory",void 0),$l([$("rowCssClassCalculator")],t.prototype,"rowCssClassCalculator",void 0),$l([$("rowModel")],t.prototype,"rowModel",void 0),$l([$("ctrlsService")],t.prototype,"ctrlsService",void 0),$l([$("ctrlsFactory")],t.prototype,"ctrlsFactory",void 0),$l([$("agStackComponentsRegistry")],t.prototype,"agStackComponentsRegistry",void 0),$l([$("valueCache")],t.prototype,"valueCache",void 0),$l([$("rowNodeEventThrottle")],t.prototype,"rowNodeEventThrottle",void 0),$l([$("localeService")],t.prototype,"localeService",void 0),$l([$("valueParserService")],t.prototype,"valueParserService",void 0),$l([Z],t.prototype,"postConstruct",null),t=$l([Q("beans")],t)}(),eu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nu=function(t){function e(e,n,o){var r=t.call(this)||this;return r.cellCtrl=e,r.beans=n,r.column=o,r}return eu(e,t),e.prototype.onMouseEvent=function(t,e){if(!Lt(e))switch(t){case"click":this.onCellClicked(e);break;case"mousedown":case"touchstart":this.onMouseDown(e);break;case"dblclick":this.onCellDoubleClicked(e);break;case"mouseout":this.onMouseOut(e);break;case"mouseover":this.onMouseOver(e)}},e.prototype.onCellClicked=function(t){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(t),void t.preventDefault();var e=this.beans,n=e.eventService,o=e.rangeService,r=e.gridOptionsService,i=t.ctrlKey||t.metaKey;o&&i&&o.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&o.intersectLastRange(!0);var s=this.cellCtrl.createEvent(t,Zt.EVENT_CELL_CLICKED);n.dispatchEvent(s);var a=this.column.getColDef();a.onCellClicked&&window.setTimeout((function(){return a.onCellClicked(s)}),0),(r.is("singleClickEdit")||a.singleClickEdit)&&!r.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()},e.prototype.isDoubleClickOnIPad=function(){if(!Bn()||Nt("dblclick"))return!1;var t=(new Date).getTime(),e=t-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=t,e},e.prototype.onCellDoubleClicked=function(t){var e=this.column.getColDef(),n=this.cellCtrl.createEvent(t,Zt.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(n),"function"===typeof e.onCellDoubleClicked&&window.setTimeout((function(){return e.onCellDoubleClicked(n)}),0),!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,t)},e.prototype.onMouseDown=function(t){var e=t.ctrlKey,n=t.metaKey,o=t.shiftKey,r=t.target,i=this.beans,s=i.eventService,a=i.rangeService;if(!this.isRightClickInExistingRange(t)){var l=a&&0!=a.getCellRanges().length;if(!o||!l){var u=Ln()&&!this.cellCtrl.isEditing()&&!co(r);this.cellCtrl.focusCell(u)}if(o&&l&&t.preventDefault(),!this.containsWidget(r)){if(a){var c=this.cellCtrl.getCellPosition();if(o)a.extendLatestRangeToCell(c);else{var p=e||n;a.setRangeToCell(c,p)}}s.dispatchEvent(this.cellCtrl.createEvent(t,Zt.EVENT_CELL_MOUSE_DOWN))}}},e.prototype.isRightClickInExistingRange=function(t){var e=this.beans.rangeService;if(e&&(e.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===t.button))return!0;return!1},e.prototype.containsWidget=function(t){return go(t,"ag-selection-checkbox",3)},e.prototype.onMouseOut=function(t){if(!this.mouseStayingInsideCell(t)){var e=this.cellCtrl.createEvent(t,Zt.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(e),this.beans.columnHoverService.clearMouseOver()}},e.prototype.onMouseOver=function(t){if(!this.mouseStayingInsideCell(t)){var e=this.cellCtrl.createEvent(t,Zt.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(e),this.beans.columnHoverService.setMouseOver([this.column])}},e.prototype.mouseStayingInsideCell=function(t){if(!t.target||!t.relatedTarget)return!1;var e=this.cellCtrl.getGui(),n=e.contains(t.target),o=e.contains(t.relatedTarget);return n&&o},e.prototype.destroy=function(){},e}(tu),ou=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ru=function(t){function e(e,n,o,r,i){var s=t.call(this)||this;return s.cellCtrl=e,s.beans=n,s.rowNode=r,s.rowCtrl=i,s}return ou(e,t),e.prototype.setComp=function(t){this.eGui=t},e.prototype.onKeyDown=function(t){var e=t.key;switch(e){case Qo.ENTER:this.onEnterKeyDown(t);break;case Qo.F2:this.onF2KeyDown(t);break;case Qo.ESCAPE:this.onEscapeKeyDown(t);break;case Qo.TAB:this.onTabKeyDown(t);break;case Qo.BACKSPACE:case Qo.DELETE:this.onBackspaceOrDeleteKeyDown(e,t);break;case Qo.DOWN:case Qo.UP:case Qo.RIGHT:case Qo.LEFT:this.onNavigationKeyDown(t,e)}},e.prototype.onNavigationKeyDown=function(t,e){this.cellCtrl.isEditing()||(t.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(t):this.beans.navigationService.navigateToNextCell(t,e,this.cellCtrl.getCellPosition(),!0),t.preventDefault())},e.prototype.onShiftRangeSelect=function(t){if(this.beans.rangeService){var e=this.beans.rangeService.extendLatestRangeInDirection(t);e&&this.beans.navigationService.ensureCellVisible(e)}},e.prototype.onTabKeyDown=function(t){this.beans.navigationService.onTabKeyDown(this.cellCtrl,t)},e.prototype.onBackspaceOrDeleteKeyDown=function(t,e){var n=this,o=n.cellCtrl,r=n.beans,i=n.rowNode,s=r.gridOptionsService,a=r.rangeService,l=r.eventService;o.isEditing()||(l.dispatchEvent({type:Zt.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),or(t,s.is("enableCellEditingOnBackspace"))?a&&s.isEnableRangeSelection()?a.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"}):o.isCellEditable()&&i.setDataValue(o.getColumn(),null,"cellClear"):o.startRowOrCellEdit(t,e),l.dispatchEvent({type:Zt.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))},e.prototype.onEnterKeyDown=function(t){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,t.shiftKey);else if(this.beans.gridOptionsService.is("enterNavigatesVertically")){var e=t.shiftKey?Qo.UP:Qo.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(Qo.ENTER,t),this.cellCtrl.isEditing()&&t.preventDefault()},e.prototype.onF2KeyDown=function(t){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(Qo.F2,t)},e.prototype.onEscapeKeyDown=function(t){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))},e.prototype.processCharacter=function(t){if(!(t.target!==this.eGui)&&!this.cellCtrl.isEditing()){var e=t.key;" "===e?this.onSpaceKeyDown(t):(this.cellCtrl.startRowOrCellEdit(e,t),t.preventDefault())}},e.prototype.onSpaceKeyDown=function(t){var e=this.beans.gridOptionsService;if(!this.cellCtrl.isEditing()&&e.isRowSelection()){var n=this.rowNode.isSelected(),o=!n;if(o||!e.is("suppressRowDeselection")){var r=this.beans.gridOptionsService.is("groupSelectsFiltered"),i=this.rowNode.setSelectedParams({newValue:o,rangeSelect:t.shiftKey,groupSelectsFiltered:r,event:t,source:"spaceKey"});void 0===n&&0===i&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:t.shiftKey,groupSelectsFiltered:r,event:t,source:"spaceKey"})}}t.preventDefault()},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e}(Ht),iu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),su=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},au=function(t){function e(e,n,o){var r=t.call(this,'<div class="ag-drag-handle ag-row-drag" draggable="true"></div>')||this;return r.rowNode=e,r.column=n,r.eCell=o,r}return iu(e,t),e.prototype.postConstruct=function(){this.getGui().appendChild(Zo("rowDrag",this.gridOptionsService,null)),this.addGuiEventListener("mousedown",(function(t){t.stopPropagation()})),this.addDragSource(),this.checkVisibility()},e.prototype.addDragSource=function(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))},e.prototype.onDragStart=function(t){var e=this,n=this.column.getColDef().dndSourceOnRowDrag;t.dataTransfer.setDragImage(this.eCell,0,0);n?n({rowNode:this.rowNode,dragEvent:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):function(){try{var n=JSON.stringify(e.rowNode.data);t.dataTransfer.setData("application/json",n),t.dataTransfer.setData("text/plain",n)}catch(o){}}()},e.prototype.checkVisibility=function(){var t=this.column.isDndSource(this.rowNode);this.setDisplayed(t)},su([Z],e.prototype,"postConstruct",null),e}(Tr),lu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),uu=function(){return uu=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},uu.apply(this,arguments)},cu=0,pu=function(t){function e(e,n,o,r){var i=t.call(this)||this;i.cellRangeFeature=null,i.cellPositionFeature=null,i.cellCustomStyleFeature=null,i.tooltipFeature=null,i.cellMouseListenerFeature=null,i.cellKeyboardListenerFeature=null,i.suppressRefreshCell=!1,i.onCellCompAttachedFuncs=[],i.column=e,i.rowNode=n,i.beans=o,i.rowCtrl=r,i.instanceId=e.getId()+"-"+cu++;var s=i.column.getColDef();return i.colIdSanitised=re(i.column.getId()),i.beans.gridOptionsService.is("suppressCellFocus")||(i.tabIndex=-1),i.isCellRenderer=null!=s.cellRenderer||null!=s.cellRendererSelector,i.createCellPosition(),i.addFeatures(),i.updateAndFormatValue(!0),i}return lu(e,t),e.prototype.shouldRestoreFocus=function(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)},e.prototype.addFeatures=function(){var t=this;this.cellPositionFeature=new Yl(this,this.beans),this.addDestroyFunc((function(){var e;null===(e=t.cellPositionFeature)||void 0===e||e.destroy(),t.cellPositionFeature=null})),this.cellCustomStyleFeature=new Zl(this,this.beans),this.addDestroyFunc((function(){var e;null===(e=t.cellCustomStyleFeature)||void 0===e||e.destroy(),t.cellCustomStyleFeature=null})),this.cellMouseListenerFeature=new nu(this,this.beans,this.column),this.addDestroyFunc((function(){var e;null===(e=t.cellMouseListenerFeature)||void 0===e||e.destroy(),t.cellMouseListenerFeature=null})),this.cellKeyboardListenerFeature=new ru(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc((function(){var e;null===(e=t.cellKeyboardListenerFeature)||void 0===e||e.destroy(),t.cellKeyboardListenerFeature=null})),this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new ql(this.beans,this),this.addDestroyFunc((function(){var e;null===(e=t.cellRangeFeature)||void 0===e||e.destroy(),t.cellRangeFeature=null}))),this.column.isTooltipEnabled()&&this.addTooltipFeature()},e.prototype.addTooltipFeature=function(){var t=this,e={getColumn:function(){return t.column},getColDef:function(){return t.column.getColDef()},getRowIndex:function(){return t.cellPosition.rowIndex},getRowNode:function(){return t.rowNode},getGui:function(){return t.getGui()},getLocation:function(){return"cell"},getTooltipValue:function(){var e=t.column.getColDef(),n=t.rowNode.data;if(e.tooltipField&&r(n))return E(n,e.tooltipField,t.column.isTooltipFieldContainsDots());var o=e.tooltipValueGetter;return o?o({location:"cell",api:t.beans.gridOptionsService.api,columnApi:t.beans.gridOptionsService.columnApi,context:t.beans.gridOptionsService.context,colDef:t.column.getColDef(),column:t.column,rowIndex:t.cellPosition.rowIndex,node:t.rowNode,data:t.rowNode.data,value:t.value,valueFormatted:t.valueFormatted}):null},getValueFormatted:function(){return t.valueFormatted}};this.tooltipFeature=new Ql(e,this.beans),this.addDestroyFunc((function(){var e;null===(e=t.tooltipFeature)||void 0===e||e.destroy(),t.tooltipFeature=null}))},e.prototype.setComp=function(t,e,n,o,r){var i,s,a,l;this.cellComp=t,this.eGui=e,this.printLayout=o,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),n&&this.setupAutoHeight(n),this.setAriaColIndex(),null===(i=this.cellPositionFeature)||void 0===i||i.setComp(e),null===(s=this.cellCustomStyleFeature)||void 0===s||s.setComp(t),null===(a=this.tooltipFeature)||void 0===a||a.setComp(e),null===(l=this.cellKeyboardListenerFeature)||void 0===l||l.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t,e),r&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach((function(t){return t()})),this.onCellCompAttachedFuncs=[])},e.prototype.setupAutoHeight=function(t){var e=this;if(this.column.isAutoHeight()){var n=t.parentElement,o=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,r=function(i){if(!e.editing&&e.isAlive()){var s=mo(n),a=s.paddingTop+s.paddingBottom+s.borderBottomWidth+s.borderTopWidth,l=t.offsetHeight+a;if(i<5){var u=e.beans.gridOptionsService.getDocument();if(!u||!u.contains(t)||0==l)return void e.beans.frameworkOverrides.setTimeout((function(){return r(i+1)}),0)}var c=Math.max(l,o);e.rowNode.setRowAutoHeight(c,e.column)}},i=function(){return r(0)};i();var s=this.beans.resizeObserverService.observeResize(t,i);this.addDestroyFunc((function(){s(),e.rowNode.setRowAutoHeight(void 0,e.column)}))}},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.getIncludeSelection=function(){return this.includeSelection},e.prototype.getIncludeRowDrag=function(){return this.includeRowDrag},e.prototype.getIncludeDndSource=function(){return this.includeDndSource},e.prototype.getColumnIdSanitised=function(){return this.colIdSanitised},e.prototype.getTabIndex=function(){return this.tabIndex},e.prototype.getIsCellRenderer=function(){return this.isCellRenderer},e.prototype.getValueToDisplay=function(){return null!=this.valueFormatted?this.valueFormatted:this.value},e.prototype.showValue=function(t){void 0===t&&(t=!1);var e,n=this.getValueToDisplay();if(this.isCellRenderer){var o=this.createCellRendererParams();e=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),o)}this.cellComp.setRenderDetails(e,n,t),this.refreshHandle()},e.prototype.setupControlComps=function(){var t=this.column.getColDef();this.includeSelection=this.isIncludeControl(t.checkboxSelection),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)},e.prototype.isForceWrapper=function(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()},e.prototype.isIncludeControl=function(t){return!(null!=this.rowNode.rowPinned)&&("function"===typeof t||!0===t)},e.prototype.refreshShouldDestroy=function(){var t=this.column.getColDef(),e=this.includeSelection!=this.isIncludeControl(t.checkboxSelection),n=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),o=this.includeDndSource!=this.isIncludeControl(t.dndSource);return e||n||o},e.prototype.startEditing=function(t,e,n){var o=this;if(void 0===t&&(t=null),void 0===e&&(e=!1),void 0===n&&(n=null),this.isCellEditable()&&!this.editing)if(this.cellComp){var r=this.createCellEditorParams(t,e),i=this.column.getColDef(),s=this.beans.userComponentFactory.getCellEditorDetails(i,r),a=null!=(null===s||void 0===s?void 0:s.popupFromSelector)?s.popupFromSelector:!!i.cellEditorPopup,l=null!=(null===s||void 0===s?void 0:s.popupPositionFromSelector)?s.popupPositionFromSelector:i.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(s,a,l);var u=this.createEvent(n,Zt.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(u)}else this.onCellCompAttachedFuncs.push((function(){o.startEditing(t,e,n)}))},e.prototype.setEditing=function(t){this.editing!==t&&(this.editing=t,this.refreshHandle())},e.prototype.stopRowOrCellEdit=function(t){void 0===t&&(t=!1),"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(t):this.stopEditing(t)},e.prototype.onPopupEditorClosed=function(){this.isEditing()&&this.stopEditingAndFocus()},e.prototype.takeValueFromCellEditor=function(t){var e={newValueExists:!1};if(t)return e;var n=this.cellComp.getCellEditor();return n?n.isCancelAfterEnd&&n.isCancelAfterEnd()?e:{newValue:n.getValue(),newValueExists:!0}:e},e.prototype.saveNewValue=function(t,e){if(e===t)return!1;this.suppressRefreshCell=!0;var n=this.rowNode.setDataValue(this.column,e,"edit");return this.suppressRefreshCell=!1,n},e.prototype.stopEditing=function(t){if(void 0===t&&(t=!1),!this.editing)return!1;var e=this.takeValueFromCellEditor(t),n=e.newValue,o=e.newValueExists,r=this.rowNode.getValueFromValueService(this.column),i=!1;return o&&(i=this.saveNewValue(r,n)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(r,n,!t&&!!i),i},e.prototype.dispatchEditingStoppedEvent=function(t,e,n){var o=uu(uu({},this.createEvent(null,Zt.EVENT_CELL_EDITING_STOPPED)),{oldValue:t,newValue:e,valueChanged:n});this.beans.eventService.dispatchEvent(o)},e.prototype.createCellEditorParams=function(t,e){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:t,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:e,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}},e.prototype.createCellRendererParams=function(){var t=this;return{value:this.value,valueFormatted:this.valueFormatted,getValue:function(){return t.rowNode.getValueFromValueService(t.column)},setValue:function(e){return t.beans.valueService.setValue(t.rowNode,t.column,e)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:function(e,n,o,r){return t.registerRowDragger(e,n,r)}}},e.prototype.parseValue=function(t){return this.beans.valueParserService.parseValue(this.column,this.rowNode,t,this.getValue())},e.prototype.setFocusOutOnEditor=function(){if(this.editing){var t=this.cellComp.getCellEditor();t&&t.focusOut&&t.focusOut()}},e.prototype.setFocusInOnEditor=function(){if(this.editing){var t=this.cellComp.getCellEditor();t&&t.focusIn?t.focusIn():this.focusCell(!0)}},e.prototype.onCellChanged=function(t){this.cellComp&&(t.column===this.column&&this.refreshCell({}))},e.prototype.refreshCell=function(t){var e,n,o;if(!this.suppressRefreshCell&&!this.editing&&this.cellComp){var r=this.column.getColDef(),i=null!=t&&!!t.newData,s=null!=t&&!!t.suppressFlash||!!r.suppressCellFlash,a=null==r.field&&null==r.valueGetter&&null==r.showRowGroup,l=t&&t.forceRefresh||a||i,u=this.updateAndFormatValue();if(l||u){this.showValue(i);var c=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!s&&!c&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),null===(e=this.cellCustomStyleFeature)||void 0===e||e.applyUserStyles(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyClassesFromColDef()}this.refreshToolTip(),null===(o=this.cellCustomStyleFeature)||void 0===o||o.applyCellClassRules()}},e.prototype.stopEditingAndFocus=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.stopRowOrCellEdit(),this.focusCell(!0),t||this.navigateAfterEdit(e)},e.prototype.navigateAfterEdit=function(t){if(this.beans.gridOptionsService.is("enterNavigatesVerticallyAfterEdit")){var e=t?Qo.UP:Qo.DOWN;this.beans.navigationService.navigateToNextCell(null,e,this.getCellPosition(),!1)}},e.prototype.flashCell=function(t){var e=t&&t.flashDelay,n=t&&t.fadeDelay;this.animateCell("data-changed",e,n)},e.prototype.animateCell=function(t,e,n){var o,i,s=this;if(this.cellComp){var a="ag-cell-"+t,l="ag-cell-"+t+"-animation",u=this.beans.gridOptionsService;e||(e=null!==(o=u.getNum("cellFlashDelay"))&&void 0!==o?o:500),r(n)||(n=null!==(i=u.getNum("cellFadeDelay"))&&void 0!==i?i:1e3),this.cellComp.addOrRemoveCssClass(a,!0),this.cellComp.addOrRemoveCssClass(l,!1),window.setTimeout((function(){s.isAlive()&&(s.cellComp.addOrRemoveCssClass(a,!1),s.cellComp.addOrRemoveCssClass(l,!0),s.eGui.style.transition="background-color "+n+"ms",window.setTimeout((function(){s.isAlive()&&(s.cellComp.addOrRemoveCssClass(l,!1),s.eGui.style.transition="")}),n))}),e)}},e.prototype.onFlashCells=function(t){if(this.cellComp){var e=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[e]&&this.animateCell("highlight")}},e.prototype.isCellEditable=function(){return this.column.isCellEditable(this.rowNode)},e.prototype.isSuppressFillHandle=function(){return this.column.isSuppressFillHandle()},e.prototype.formatValue=function(t){var e;return null!==(e=this.callValueFormatter(t))&&void 0!==e?e:t},e.prototype.callValueFormatter=function(t){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,t)},e.prototype.updateAndFormatValue=function(t){void 0===t&&(t=!1);var e=this.value,n=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),!!t||(!this.valuesAreEqual(e,this.value)||this.valueFormatted!=n)},e.prototype.valuesAreEqual=function(t,e){var n=this.column.getColDef();return n.equals?n.equals(t,e):t===e},e.prototype.getComp=function(){return this.cellComp},e.prototype.getValue=function(){return this.value},e.prototype.getValueFormatted=function(){return this.valueFormatted},e.prototype.addDomData=function(){var t=this,n=this.getGui();this.beans.gridOptionsService.setDomData(n,e.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc((function(){return t.beans.gridOptionsService.setDomData(n,e.DOM_DATA_KEY_CELL_CTRL,null)}))},e.prototype.createEvent=function(t,e){return{type:e,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex}},e.prototype.processCharacter=function(t){var e;null===(e=this.cellKeyboardListenerFeature)||void 0===e||e.processCharacter(t)},e.prototype.onKeyDown=function(t){var e;null===(e=this.cellKeyboardListenerFeature)||void 0===e||e.onKeyDown(t)},e.prototype.onMouseEvent=function(t,e){var n;null===(n=this.cellMouseListenerFeature)||void 0===n||n.onMouseEvent(t,e)},e.prototype.getGui=function(){return this.eGui},e.prototype.refreshToolTip=function(){var t;null===(t=this.tooltipFeature)||void 0===t||t.refreshToolTip()},e.prototype.getColSpanningList=function(){return this.cellPositionFeature.getColSpanningList()},e.prototype.onLeftChanged=function(){var t;this.cellComp&&(null===(t=this.cellPositionFeature)||void 0===t||t.onLeftChanged())},e.prototype.onDisplayedColumnsChanged=function(){this.eGui&&this.setAriaColIndex()},e.prototype.setAriaColIndex=function(){var t=this.beans.columnModel.getAriaColumnIndex(this.column);yn(this.getGui(),t)},e.prototype.isSuppressNavigable=function(){return this.column.isSuppressNavigable(this.rowNode)},e.prototype.onWidthChanged=function(){var t;return null===(t=this.cellPositionFeature)||void 0===t?void 0:t.onWidthChanged()},e.prototype.getColumn=function(){return this.column},e.prototype.getRowNode=function(){return this.rowNode},e.prototype.getBeans=function(){return this.beans},e.prototype.isPrintLayout=function(){return this.printLayout},e.prototype.appendChild=function(t){this.eGui.appendChild(t)},e.prototype.refreshHandle=function(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()},e.prototype.getCellPosition=function(){return this.cellPosition},e.prototype.isEditing=function(){return this.editing},e.prototype.startRowOrCellEdit=function(t,e){void 0===e&&(e=null),this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(t,this):this.startEditing(t,!0,e))},e.prototype.getRowCtrl=function(){return this.rowCtrl},e.prototype.getRowPosition=function(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}},e.prototype.updateRangeBordersIfRangeCount=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()},e.prototype.onRangeSelectionChanged=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},e.prototype.isRangeSelectionEnabled=function(){return null!=this.cellRangeFeature},e.prototype.focusCell=function(t){void 0===t&&(t=!1),this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:t})},e.prototype.onRowIndexChanged=function(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},e.prototype.onFirstRightPinnedChanged=function(){if(this.cellComp){var t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",t)}},e.prototype.onLastLeftPinnedChanged=function(){if(this.cellComp){var t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",t)}},e.prototype.onCellFocused=function(t){if(!this.beans.gridOptionsService.is("suppressCellFocus")){var e=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp){if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",e),e&&t&&t.forceBrowserFocus)this.cellComp.getFocusableElement().focus({preventScroll:!!t.preventScrollOnBrowserFocus});var n="fullRow"===this.beans.gridOptionsService.get("editType");e||n||!this.editing||this.stopRowOrCellEdit()}else e&&(null===t||void 0===t?void 0:t.forceBrowserFocus)&&(this.focusEventToRestore=t)}},e.prototype.createCellPosition=function(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:o(this.rowNode.rowPinned),column:this.column}},e.prototype.applyStaticCssClasses=function(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);var t=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",t),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!t)},e.prototype.onColumnHover=function(){if(this.cellComp&&this.beans.gridOptionsService.is("columnHoverHighlight")){var t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",t)}},e.prototype.onColDefChanged=function(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))},e.prototype.setWrapText=function(){var t=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",t)},e.prototype.dispatchCellContextMenuEvent=function(t){var e=this.column.getColDef(),n=this.createEvent(t,Zt.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(n),e.onCellContextMenu&&window.setTimeout((function(){return e.onCellContextMenu(n)}),0)},e.prototype.getCellRenderer=function(){return this.cellComp?this.cellComp.getCellRenderer():null},e.prototype.getCellEditor=function(){return this.cellComp?this.cellComp.getCellEditor():null},e.prototype.destroy=function(){this.onCellCompAttachedFuncs=[],t.prototype.destroy.call(this)},e.prototype.createSelectionCheckbox=function(){var t=new zs;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t},e.prototype.createDndSource=function(){var t=new au(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(t),t},e.prototype.registerRowDragger=function(t,e,n){var o=this;if(this.customRowDragComp)this.customRowDragComp.setDragElement(t,e);else{var r=this.createRowDragComp(t,e,n);r&&(this.customRowDragComp=r,this.addDestroyFunc((function(){o.beans.context.destroyBean(r),o.customRowDragComp=null})))}},e.prototype.createRowDragComp=function(t,e,n){var o=this,r=this.beans.gridOptionsService.is("pagination"),i=this.beans.gridOptionsService.is("rowDragManaged"),s=this.beans.gridOptionsService.isRowModelType("clientSide");if(i){if(!s)return void P((function(){return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model")}),"CellComp.addRowDragging");if(r)return void P((function(){return console.warn("AG Grid: managed row dragging is not possible when doing pagination")}),"CellComp.addRowDragging")}var a=new Ks((function(){return o.value}),this.rowNode,this.column,t,e,n);return this.beans.context.createBean(a),a},e.DOM_DATA_KEY_CELL_CTRL="cellCtrl",e}(Ht),hu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),du=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fu=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},gu=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};!function(t){t.Normal="Normal",t.FullWidth="FullWidth",t.FullWidthLoading="FullWidthLoading",t.FullWidthGroup="FullWidthGroup",t.FullWidthDetail="FullWidthDetail"}(Ul||(Ul={}));var mu,yu,vu=0,_u=function(t){function e(e,n,o,r,i){var s=t.call(this)||this;return s.allRowGuis=[],s.active=!0,s.centerCellCtrls={list:[],map:{}},s.leftCellCtrls={list:[],map:{}},s.rightCellCtrls={list:[],map:{}},s.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},s.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},s.lastMouseDownOnDragger=!1,s.emptyStyle={},s.updateColumnListsPending=!1,s.rowId=null,s.businessKeySanitised=null,s.beans=n,s.gridOptionsService=n.gridOptionsService,s.rowNode=e,s.paginationPage=n.paginationProxy.getCurrentPage(),s.useAnimationFrameForCreate=r,s.printLayout=i,s.instanceId=e.id+"-"+vu++,s.rowId=re(e.id),s.isFullWidth()&&!s.gridOptionsService.is("suppressCellFocus")&&(s.tabIndex=-1),s.setAnimateFlags(o),s.initRowBusinessKey(),s.rowFocused=n.focusService.isRowFocused(s.rowNode.rowIndex,s.rowNode.rowPinned),s.rowLevel=n.rowCssClassCalculator.calculateRowLevel(s.rowNode),s.setRowType(),s.rowStyles=s.processStylesFromGridOptions(),s.addListeners(),s}return hu(e,t),e.prototype.initRowBusinessKey=function(){this.businessKeyForNodeFunc=this.gridOptionsService.get("getBusinessKeyForNode"),this.updateRowBusinessKey()},e.prototype.updateRowBusinessKey=function(){if("function"===typeof this.businessKeyForNodeFunc){var t=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=re(t)}},e.prototype.getRowId=function(){return this.rowId},e.prototype.getRowStyles=function(){return this.rowStyles},e.prototype.getTabIndex=function(){return this.tabIndex},e.prototype.isSticky=function(){return this.rowNode.sticky},e.prototype.getBeans=function(){return this.beans},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.setComp=function(t,e,n){var o={rowComp:t,element:e,containerType:n};this.allRowGuis.push(o),n===yu.LEFT?this.leftGui=o:n===yu.RIGHT?this.rightGui=o:n===yu.FULL_WIDTH?this.fullWidthGui=o:this.centerGui=o,this.initialiseRowComp(o),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()},e.prototype.unsetComp=function(t){this.allRowGuis=this.allRowGuis.filter((function(e){return e.containerType!==t})),t===yu.LEFT?this.leftGui=void 0:t===yu.RIGHT?this.rightGui=void 0:t===yu.FULL_WIDTH&&(this.fullWidthGui=void 0)},e.prototype.isCacheable=function(){return this.rowType===Ul.FullWidthDetail&&this.gridOptionsService.is("keepDetailRows")},e.prototype.setCached=function(t){var e=t?"none":"";this.allRowGuis.forEach((function(t){return t.element.style.display=e}))},e.prototype.initialiseRowComp=function(t){var n=this,o=this.gridOptionsService;this.listenOnDomOrder(t),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),o.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);var r=t.rowComp;this.getInitialRowClasses(t.containerType).forEach((function(t){return r.addOrRemoveCssClass(t,!0)})),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&un(t.element,1==this.rowNode.expanded),this.setRowCompRowId(r,!1),this.setRowCompRowBusinessKey(r),o.setDomData(t.element,e.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc((function(){return o.setDomData(t.element,e.DOM_DATA_KEY_ROW_CTRL,null)})),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t.element),this.isFullWidth()&&this.setupFullWidth(t),o.is("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask((function(){n.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()},e.prototype.setRowCompRowBusinessKey=function(t){null!=this.businessKeySanitised&&t.setRowBusinessKey(this.businessKeySanitised)},e.prototype.getBusinessKey=function(){return this.businessKeySanitised},e.prototype.setRowCompRowId=function(t,e){e&&(this.rowId=re(this.rowNode.id)),null!=this.rowId&&t.setRowId(this.rowId)},e.prototype.executeSlideAndFadeAnimations=function(t){var e=this,n=t.containerType;this.slideInAnimation[n]&&(N((function(){e.onTopChanged()})),this.slideInAnimation[n]=!1),this.fadeInAnimation[n]&&(N((function(){t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[n]=!1)},e.prototype.addRowDraggerToRow=function(t){if(this.gridOptionsService.isEnableRangeSelection())P((function(){console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")}),"rowDragAndRangeSelectionEnabled");else{var e=this.beans.localeService.getLocaleTextFunc(),n=new Ks((function(){return"1 "+e("rowDragRow","row")}),this.rowNode,void 0,t.element,void 0,!0);this.createManagedBean(n,this.beans.context)}},e.prototype.setupFullWidth=function(t){var e=this.getPinnedForContainer(t.containerType),n=this.createFullWidthParams(t.element,e);if(this.rowType!=Ul.FullWidthDetail||W.__assertRegistered(z.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId())){var o;switch(this.rowType){case Ul.FullWidthDetail:o=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(n);break;case Ul.FullWidthGroup:o=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(n);break;case Ul.FullWidthLoading:o=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(n);break;default:o=this.beans.userComponentFactory.getFullWidthCellRendererDetails(n)}t.rowComp.showFullWidth(o)}},e.prototype.isPrintLayout=function(){return this.printLayout},e.prototype.getFullWidthCellRenderer=function(){var t,e;return null===(e=null===(t=this.fullWidthGui)||void 0===t?void 0:t.rowComp)||void 0===e?void 0:e.getFullWidthCellRenderer()},e.prototype.getCellElement=function(t){var e=this.getCellCtrl(t);return e?e.getGui():null},e.prototype.executeProcessRowPostCreateFunc=function(){var t,e=this.gridOptionsService.getCallback("processRowPostCreate");e&&this.areAllContainersReady()&&e({eRow:null===(t=this.centerGui)||void 0===t?void 0:t.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})},e.prototype.areAllContainersReady=function(){var t=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),e=!!this.centerGui,n=!!this.rightGui||!this.beans.columnModel.isPinningRight();return t&&e&&n},e.prototype.setRowType=function(){var t=this.rowNode.stub,e=this.rowNode.isFullWidthCell(),n=this.beans.doingMasterDetail&&this.rowNode.detail,o=this.beans.columnModel.isPivotMode(),r=!!this.rowNode.group&&!this.rowNode.footer&&this.gridOptionsService.isGroupUseEntireRow(o);this.rowType=t?Ul.FullWidthLoading:n?Ul.FullWidthDetail:e?Ul.FullWidth:r?Ul.FullWidthGroup:Ul.Normal},e.prototype.updateColumnLists=function(t,e){var n=this;(void 0===t&&(t=!1),void 0===e&&(e=!1),this.isFullWidth())||(t||this.gridOptionsService.is("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(e):this.updateColumnListsPending||(this.beans.animationFrameService.createTask((function(){n.active&&n.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0))},e.prototype.createCellCtrls=function(t,e,n){var o=this;void 0===n&&(n=null);var r={list:[],map:{}},i=function(t,e){r.list.push(e),r.map[t]=e};return e.forEach((function(e){var n=e.getInstanceId(),r=t.map[n];r||(r=new pu(e,o.rowNode,o.beans,o)),i(n,r)})),t.list.forEach((function(t){null!=r.map[t.getColumn().getInstanceId()]||(!o.isCellEligibleToBeRemoved(t,n)?i(t.getColumn().getInstanceId(),t):t.destroy())})),r},e.prototype.updateColumnListsImpl=function(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)},e.prototype.setCellCtrls=function(t){var e=this;this.allRowGuis.forEach((function(n){var o=e.getCellCtrlsForContainer(n.containerType);n.rowComp.setCellCtrls(o,t)}))},e.prototype.getCellCtrlsForContainer=function(t){switch(t){case yu.LEFT:return this.leftCellCtrls.list;case yu.RIGHT:return this.rightCellCtrls.list;case yu.FULL_WIDTH:return[];case yu.CENTER:return this.centerCellCtrls.list;default:throw new Error("Unhandled case: "+t)}},e.prototype.createAllCellCtrls=function(){var t=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{var e=t.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,e);var n=t.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");var o=t.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,o,"right")}},e.prototype.isCellEligibleToBeRemoved=function(t,e){var n=!0;if(t.getColumn().getPinned()!=e)return n;var o=t.isEditing(),r=this.beans.focusService.isCellFocused(t.getCellPosition());if(o||r){var i=t.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(i)>=0)&&n}return n},e.prototype.getDomOrder=function(){return this.gridOptionsService.is("ensureDomOrder")||this.gridOptionsService.isDomLayout("print")},e.prototype.listenOnDomOrder=function(t){var e=this,n=function(){t.rowComp.setDomOrder(e.getDomOrder())};this.addManagedPropertyListener("domLayout",n),this.addManagedPropertyListener("ensureDomOrder",n)},e.prototype.setAnimateFlags=function(t){if(!this.isSticky()&&t){var e=r(this.rowNode.oldRowTop),n=this.beans.columnModel.isPinningLeft(),o=this.beans.columnModel.isPinningRight();e?(this.slideInAnimation.center=!0,this.slideInAnimation.left=n,this.slideInAnimation.right=o):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=n,this.fadeInAnimation.right=o)}},e.prototype.isEditing=function(){return this.editingRow},e.prototype.stopRowEditing=function(t){this.stopEditing(t)},e.prototype.isFullWidth=function(){return this.rowType!==Ul.Normal},e.prototype.getRowType=function(){return this.rowType},e.prototype.refreshFullWidth=function(){var t=this,e=function(e,n){if(!e)return!0;var o=e.rowComp.getFullWidthCellRenderer();if(!o)return!1;if(!o.refresh)return!1;var r=t.createFullWidthParams(e.element,n);return o.refresh(r)},n=e(this.fullWidthGui,null),o=e(this.centerGui,null),r=e(this.leftGui,"left"),i=e(this.rightGui,"right");return n&&o&&r&&i},e.prototype.addListeners=function(){var t=this;this.addManagedListener(this.rowNode,ks.EVENT_HEIGHT_CHANGED,(function(){return t.onRowHeightChanged()})),this.addManagedListener(this.rowNode,ks.EVENT_ROW_SELECTED,(function(){return t.onRowSelected()})),this.addManagedListener(this.rowNode,ks.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,ks.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,ks.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));var e=this.beans.eventService;this.addManagedListener(e,Zt.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(e,Zt.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(e,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(e,Zt.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(e,Zt.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(e,Zt.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(e,Zt.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(e,Zt.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(e,Zt.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()},e.prototype.onColumnMoved=function(){this.updateColumnLists()},e.prototype.addListenersForCellComps=function(){var t=this;this.addManagedListener(this.rowNode,ks.EVENT_ROW_INDEX_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onRowIndexChanged()}))})),this.addManagedListener(this.rowNode,ks.EVENT_CELL_CHANGED,(function(e){t.getAllCellCtrls().forEach((function(t){return t.onCellChanged(e)}))}))},e.prototype.onRowNodeDataChanged=function(t){var e=this;this.isFullWidth()?this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode):(this.getAllCellCtrls().forEach((function(e){return e.refreshCell({suppressFlash:!t.update,newData:!t.update})})),this.allRowGuis.forEach((function(t){e.setRowCompRowId(t.rowComp,!0),e.updateRowBusinessKey(),e.setRowCompRowBusinessKey(t.rowComp)})),this.onRowSelected(),this.postProcessCss())},e.prototype.onRowNodeCellChanged=function(){this.postProcessCss()},e.prototype.postProcessCss=function(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},e.prototype.onRowNodeHighlightChanged=function(){var t=this.rowNode.highlighted;this.allRowGuis.forEach((function(e){var n=t===ol.Above,o=t===ol.Below;e.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),e.rowComp.addOrRemoveCssClass("ag-row-highlight-below",o)}))},e.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},e.prototype.postProcessRowDragging=function(){var t=this.rowNode.dragging;this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-dragging",t)}))},e.prototype.updateExpandedCss=function(){var t=this.rowNode.isExpandable(),e=1==this.rowNode.expanded;this.allRowGuis.forEach((function(n){n.rowComp.addOrRemoveCssClass("ag-row-group",t),n.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&e),n.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!e),un(n.element,t&&e)}))},e.prototype.onDisplayedColumnsChanged=function(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()},e.prototype.onVirtualColumnsChanged=function(){this.updateColumnLists(!1,!0)},e.prototype.getRowPosition=function(){return{rowPinned:o(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}},e.prototype.onKeyboardNavigate=function(t){var e=this.allRowGuis.find((function(e){return e.element.contains(t.target)}));if((e?e.element:null)===t.target){var n=this.rowNode,o=this.beans.focusService.getFocusedCell(),r={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:o&&o.column};this.beans.navigationService.navigateToNextCell(t,t.key,r,!0),t.preventDefault()}},e.prototype.onTabKeyDown=function(t){if(!t.defaultPrevented&&!Lt(t)){var e=this.allRowGuis.find((function(e){return e.element.contains(t.target)})),n=e?e.element:null,o=n===t.target,r=null;o||(r=this.beans.focusService.findNextFocusableElement(n,!1,t.shiftKey)),(this.isFullWidth()&&o||!r)&&this.beans.navigationService.onTabKeyDown(this,t)}},e.prototype.onFullWidthRowFocused=function(t){var e,n=this.rowNode,o=!!t&&(this.isFullWidth()&&t.rowIndex===n.rowIndex&&t.rowPinned==n.rowPinned),r=this.fullWidthGui?this.fullWidthGui.element:null===(e=this.centerGui)||void 0===e?void 0:e.element;r&&(r.classList.toggle("ag-full-width-focus",o),o&&r.focus({preventScroll:!0}))},e.prototype.refreshCell=function(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),this.updateColumnLists()},e.prototype.removeCellCtrl=function(t,e){var n={list:[],map:{}};return t.list.forEach((function(t){t!==e&&(n.list.push(t),n.map[t.getInstanceId()]=t)})),n},e.prototype.onMouseEvent=function(t,e){switch(t){case"dblclick":this.onRowDblClick(e);break;case"click":this.onRowClick(e);break;case"touchstart":case"mousedown":this.onRowMouseDown(e)}},e.prototype.createRowEvent=function(t,e){return{type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,event:e}},e.prototype.createRowEventWithSource=function(t,e){var n=this.createRowEvent(t,e);return n.source=this,n},e.prototype.onRowDblClick=function(t){if(!Lt(t)){var e=this.createRowEventWithSource(Zt.EVENT_ROW_DOUBLE_CLICKED,t);this.beans.eventService.dispatchEvent(e)}},e.prototype.onRowMouseDown=function(t){if(this.lastMouseDownOnDragger=go(t.target,"ag-row-drag",3),this.isFullWidth()){var e=this.rowNode,n=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:e.rowIndex,column:n.getAllDisplayedColumns()[0],rowPinned:e.rowPinned,forceBrowserFocus:!0})}},e.prototype.onRowClick=function(t){if(!(Lt(t)||this.lastMouseDownOnDragger)){var e=this.createRowEventWithSource(Zt.EVENT_ROW_CLICKED,t);this.beans.eventService.dispatchEvent(e);var n=t.ctrlKey||t.metaKey,o=t.shiftKey;if(!(this.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.gridOptionsService.isRowSelection()||this.gridOptionsService.is("suppressRowClickSelection"))){var r=this.gridOptionsService.is("rowMultiSelectWithClick"),i=!this.gridOptionsService.is("suppressRowDeselection"),s="rowClicked";if(this.rowNode.isSelected())r?this.rowNode.setSelectedParams({newValue:!1,event:t,source:s}):n?i&&this.rowNode.setSelectedParams({newValue:!1,event:t,source:s}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!o,rangeSelect:o,event:t,source:s});else{var a=!r&&!n;this.rowNode.setSelectedParams({newValue:!0,clearSelection:a,rangeSelect:o,event:t,source:s})}}}},e.prototype.setupDetailRowAutoHeight=function(t){var e=this;if(this.rowType===Ul.FullWidthDetail&&this.gridOptionsService.is("detailRowAutoHeight")){var n=function(){var n=t.clientHeight;if(null!=n&&n>0){e.beans.frameworkOverrides.setTimeout((function(){e.rowNode.setRowHeight(n),e.beans.clientSideRowModel?e.beans.clientSideRowModel.onRowHeightChanged():e.beans.serverSideRowModel&&e.beans.serverSideRowModel.onRowHeightChanged()}),0)}},o=this.beans.resizeObserverService.observeResize(t,n);this.addDestroyFunc(o),n()}},e.prototype.createFullWidthParams=function(t,e){var n=this;return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,eGridCell:t,eParentOfValue:t,pinned:e,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:function(t,e,o,r){return n.addFullWidthRowDragging(t,e,o,r)}}},e.prototype.addFullWidthRowDragging=function(t,e,n,o){if(void 0===n&&(n=""),this.isFullWidth()){var r=new Ks((function(){return n}),this.rowNode,void 0,t,e,o);this.createManagedBean(r,this.beans.context)}},e.prototype.onUiLevelChanged=function(){var t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){var e="ag-row-level-"+t,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((function(t){t.rowComp.addOrRemoveCssClass(e,!0),t.rowComp.addOrRemoveCssClass(n,!1)}))}this.rowLevel=t},e.prototype.isFirstRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()},e.prototype.isLastRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()},e.prototype.onModelUpdated=function(){this.refreshFirstAndLastRowStyles()},e.prototype.refreshFirstAndLastRowStyles=function(){var t=this.isFirstRowOnPage(),e=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-first",t)}))),this.lastRowOnPage!==e&&(this.lastRowOnPage=e,this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-last",e)})))},e.prototype.stopEditing=function(t){var e,n;if(void 0===t&&(t=!1),!this.stoppingRowEdit){var o=this.getAllCellCtrls(),r=this.editingRow;this.stoppingRowEdit=!0;var i=!1;try{for(var s=du(o),a=s.next();!a.done;a=s.next()){var l=a.value.stopEditing(t);r&&!t&&!i&&l&&(i=!0)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}if(i){var u=this.createRowEvent(Zt.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(u)}r&&this.setEditingRow(!1),this.stoppingRowEdit=!1}},e.prototype.setInlineEditingCss=function(t){this.allRowGuis.forEach((function(e){e.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),e.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)}))},e.prototype.setEditingRow=function(t){this.editingRow=t,this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-editing",t)}));var e=t?this.createRowEvent(Zt.EVENT_ROW_EDITING_STARTED):this.createRowEvent(Zt.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(e)},e.prototype.startRowEditing=function(t,e,n){(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),this.editingRow)||this.getAllCellCtrls().reduce((function(o,r){var i=r===e;return i?r.startEditing(t,i,n):r.startEditing(null,i,n),!!o||r.isEditing()}),!1)&&this.setEditingRow(!0)},e.prototype.getAllCellCtrls=function(){return 0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length?this.centerCellCtrls.list:gu(gu(gu([],fu(this.centerCellCtrls.list)),fu(this.leftCellCtrls.list)),fu(this.rightCellCtrls.list))},e.prototype.postProcessClassesFromGridOptions=function(){var t=this,e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach((function(e){t.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass(e,!0)}))}))},e.prototype.postProcessRowClassRules=function(){var t=this;this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,(function(e){t.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass(e,!0)}))}),(function(e){t.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass(e,!1)}))}))},e.prototype.setStylesFromGridOptions=function(t,e){var n=this;t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(e,(function(t){return t.rowComp.setUserStyles(n.rowStyles)}))},e.prototype.getPinnedForContainer=function(t){return t===yu.LEFT?"left":t===yu.RIGHT?"right":null},e.prototype.getInitialRowClasses=function(t){var e=this.getPinnedForContainer(t),n={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[t],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:e};return this.beans.rowCssClassCalculator.getInitialRowClasses(n)},e.prototype.processStylesFromGridOptions=function(){var t=this.gridOptionsService.get("rowStyle");if(!t||"function"!==typeof t){var e,n=this.gridOptionsService.getCallback("getRowStyle");if(n)e=n({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});return e||t?Object.assign({},t,e):this.emptyStyle}console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},e.prototype.onRowSelected=function(t){var e=this,n=!!this.rowNode.isSelected();this.forEachGui(t,(function(t){t.rowComp.addOrRemoveCssClass("ag-row-selected",n),wn(t.element,!!n||void 0);var o=e.createAriaLabel();tn(t.element,null==o?"":o)}))},e.prototype.createAriaLabel=function(){var t=this.rowNode.isSelected();if(!t||!this.gridOptionsService.is("suppressRowDeselection"))return this.beans.localeService.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect","Press SPACE to "+(t?"deselect":"select")+" this row.")},e.prototype.isUseAnimationFrameForCreate=function(){return this.useAnimationFrameForCreate},e.prototype.addHoverFunctionality=function(t){var e=this;this.active&&(this.addManagedListener(t,"mouseenter",(function(){return e.rowNode.onMouseEnter()})),this.addManagedListener(t,"mouseleave",(function(){return e.rowNode.onMouseLeave()})),this.addManagedListener(this.rowNode,ks.EVENT_MOUSE_ENTER,(function(){e.beans.dragService.isDragging()||e.gridOptionsService.is("suppressRowHoverHighlight")||(t.classList.add("ag-row-hover"),e.rowNode.setHovered(!0))})),this.addManagedListener(this.rowNode,ks.EVENT_MOUSE_LEAVE,(function(){t.classList.remove("ag-row-hover"),e.rowNode.setHovered(!1)})))},e.prototype.roundRowTopToBounds=function(t){var e=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.applyPaginationOffset(e.top,!0)-100,o=this.applyPaginationOffset(e.bottom,!0)+100;return Math.min(Math.max(n,t),o)},e.prototype.getFrameworkOverrides=function(){return this.beans.frameworkOverrides},e.prototype.forEachGui=function(t,e){t?e(t):this.allRowGuis.forEach(e)},e.prototype.onRowHeightChanged=function(t){if(null!=this.rowNode.rowHeight){var e=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),o=this.gridOptionsService.isGetRowHeightFunction()?this.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,r=o?Math.min(n,o)-2+"px":void 0;this.forEachGui(t,(function(t){t.element.style.height=e+"px",r&&t.element.style.setProperty("--ag-line-height",r)}))}},e.prototype.addEventListener=function(e,n){t.prototype.addEventListener.call(this,e,n)},e.prototype.removeEventListener=function(e,n){t.prototype.removeEventListener.call(this,e,n)},e.prototype.destroyFirstPass=function(){this.active=!1,this.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);var e=this.createRowEvent(Zt.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e),t.prototype.destroy.call(this)},e.prototype.setupRemoveAnimation=function(){if(!this.isSticky())if(null!=this.rowNode.rowTop){var t=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(t)}else this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)}))},e.prototype.destroySecondPass=function(){this.allRowGuis.length=0;var t=function(t){return t.list.forEach((function(t){return t.destroy()})),{list:[],map:{}}};this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)},e.prototype.setFocusedClasses=function(t){var e=this;this.forEachGui(t,(function(t){t.rowComp.addOrRemoveCssClass("ag-row-focus",e.rowFocused),t.rowComp.addOrRemoveCssClass("ag-row-no-focus",!e.rowFocused)}))},e.prototype.onCellFocused=function(){this.onCellFocusChanged()},e.prototype.onCellFocusCleared=function(){this.onCellFocusChanged()},e.prototype.onCellFocusChanged=function(){var t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)},e.prototype.onPaginationChanged=function(){var t=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()},e.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},e.prototype.onPaginationPixelOffsetChanged=function(){this.onTopChanged()},e.prototype.applyPaginationOffset=function(t,e){return void 0===e&&(e=!1),this.rowNode.isRowPinned()||this.rowNode.sticky?t:t+this.beans.paginationProxy.getPixelOffset()*(e?1:-1)},e.prototype.setRowTop=function(t){if(!this.printLayout&&r(t)){var e=this.applyPaginationOffset(t),n=(this.rowNode.isRowPinned()||this.rowNode.sticky?e:this.beans.rowContainerHeightService.getRealPixelPosition(e))+"px";this.setRowTopStyle(n)}},e.prototype.getInitialRowTop=function(t){return this.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(t):void 0},e.prototype.getInitialTransform=function(t){return this.gridOptionsService.is("suppressRowTransform")?void 0:"translateY("+this.getInitialRowTopShared(t)+")"},e.prototype.getInitialRowTopShared=function(t){if(this.printLayout)return"";var e;if(this.isSticky())e=this.rowNode.stickyRowTop;else{var n=this.slideInAnimation[t]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,o=this.applyPaginationOffset(n);e=this.rowNode.isRowPinned()?o:this.beans.rowContainerHeightService.getRealPixelPosition(o)}return e+"px"},e.prototype.setRowTopStyle=function(t){var e=this.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach((function(n){return e?n.rowComp.setTop(t):n.rowComp.setTransform("translateY("+t+")")}))},e.prototype.getRowNode=function(){return this.rowNode},e.prototype.getCellCtrl=function(t){var e=null;return this.getAllCellCtrls().forEach((function(n){n.getColumn()==t&&(e=n)})),null!=e||this.getAllCellCtrls().forEach((function(n){n.getColSpanningList().indexOf(t)>=0&&(e=n)})),e},e.prototype.onRowIndexChanged=function(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())},e.prototype.getRowIndex=function(){return this.rowNode.getRowIndexString()},e.prototype.updateRowIndexes=function(t){var e=this.rowNode.getRowIndexString(),n=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),o=this.rowNode.rowIndex%2===0,r=n+this.rowNode.rowIndex+1;this.forEachGui(t,(function(t){t.rowComp.setRowIndex(e),t.rowComp.addOrRemoveCssClass("ag-row-even",o),t.rowComp.addOrRemoveCssClass("ag-row-odd",!o),gn(t.element,r)}))},e.prototype.getPinnedLeftRowElement=function(){return this.leftGui?this.leftGui.element:void 0},e.prototype.getPinnedRightRowElement=function(){return this.rightGui?this.rightGui.element:void 0},e.prototype.getBodyRowElement=function(){return this.centerGui?this.centerGui.element:void 0},e.prototype.getFullWidthRowElement=function(){return this.fullWidthGui?this.fullWidthGui.element:void 0},e.DOM_DATA_KEY_ROW_CTRL="renderedRow",e}(Ht),Cu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),wu=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},bu=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},xu=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return Cu(e,t),e.prototype.postConstruct=function(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()},e.prototype.addKeyboardListeners=function(){var t="keydown",e=this.processKeyboardEvent.bind(this,t);this.addManagedListener(this.element,t,e)},e.prototype.addMouseListeners=function(){var t=this;["dblclick","contextmenu","mouseover","mouseout","click",Nt("touchstart")?"touchstart":"mousedown"].forEach((function(e){var n=t.processMouseEvent.bind(t,e);t.addManagedListener(t.element,e,n)}))},e.prototype.processMouseEvent=function(t,e){if(this.mouseEventService.isEventFromThisGrid(e)&&!Lt(e)){var n=this.getRowForEvent(e),o=this.mouseEventService.getRenderedCellForEvent(e);"contextmenu"===t?this.handleContextMenuMouseEvent(e,null,n,o):(o&&o.onMouseEvent(t,e),n&&n.onMouseEvent(t,e))}},e.prototype.mockContextMenuForIPad=function(){var t=this;if(Bn()){var e=new ss(this.element);this.addManagedListener(e,ss.EVENT_LONG_TAP,(function(e){var n=t.getRowForEvent(e.touchEvent),o=t.mouseEventService.getRenderedCellForEvent(e.touchEvent);t.handleContextMenuMouseEvent(null,e.touchEvent,n,o)})),this.addDestroyFunc((function(){return e.destroy()}))}},e.prototype.getRowForEvent=function(t){for(var e=t.target;e;){var n=this.gridOptionsService.getDomData(e,_u.DOM_DATA_KEY_ROW_CTRL);if(n)return n;e=e.parentElement}return null},e.prototype.handleContextMenuMouseEvent=function(t,e,n,o){var r=n?n.getRowNode():null,i=o?o.getColumn():null,s=null;if(i){var a=t||e;o.dispatchCellContextMenuEvent(a),s=this.valueService.getValue(i,r)}var l=this.ctrlsService.getGridBodyCtrl(),u=o?o.getGui():l.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(t,e,r,i,s,u)},e.prototype.getControlsForEventTarget=function(t){return{cellCtrl:Ft(this.gridOptionsService,t,pu.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Ft(this.gridOptionsService,t,_u.DOM_DATA_KEY_ROW_CTRL)}},e.prototype.processKeyboardEvent=function(t,e){var n=this.getControlsForEventTarget(e.target),o=n.cellCtrl,r=n.rowCtrl;e.defaultPrevented||(o?this.processCellKeyboardEvent(o,t,e):r&&r.isFullWidth()&&this.processFullWidthRowKeyboardEvent(r,t,e))},e.prototype.processCellKeyboardEvent=function(t,e,n){var o=t.getRowNode(),r=t.getColumn(),i=t.isEditing();tr(this.gridOptionsService,n,o,r,i)||"keydown"===e&&(!i&&this.navigationService.handlePageScrollingKey(n)||t.onKeyDown(n),this.doGridOperations(n,t.isEditing()),$o(n)&&t.processCharacter(n));if("keydown"===e){var s=t.createEvent(n,Zt.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(s)}},e.prototype.processFullWidthRowKeyboardEvent=function(t,e,n){var o=t.getRowNode(),r=this.focusService.getFocusedCell(),i=r&&r.column;if(!tr(this.gridOptionsService,n,o,i,!1)){var s=n.key;if("keydown"===e)switch(s){case Qo.PAGE_HOME:case Qo.PAGE_END:case Qo.PAGE_UP:case Qo.PAGE_DOWN:this.navigationService.handlePageScrollingKey(n,!0);break;case Qo.UP:case Qo.DOWN:t.onKeyboardNavigate(n);break;case Qo.TAB:t.onTabKeyDown(n)}}if("keydown"===e){var a=t.createRowEvent(Zt.EVENT_CELL_KEY_DOWN,n);this.eventService.dispatchEvent(a)}},e.prototype.doGridOperations=function(t,e){if((t.ctrlKey||t.metaKey)&&!e&&this.mouseEventService.isEventFromThisGrid(t)){var n=nr(t);return n===Qo.A?this.onCtrlAndA(t):n===Qo.C?this.onCtrlAndC(t):n===Qo.D?this.onCtrlAndD(t):n===Qo.V?this.onCtrlAndV(t):n===Qo.X?this.onCtrlAndX(t):n===Qo.Y?this.onCtrlAndY():n===Qo.Z?this.onCtrlAndZ(t):void 0}},e.prototype.onCtrlAndA=function(t){var e=this,n=e.pinnedRowModel,o=e.paginationProxy,r=e.rangeService;if(r&&o.isRowsToRender()){var i=bu([n.isEmpty("top"),n.isEmpty("bottom")],2),a=i[0]?null:"top",l=void 0,u=void 0;i[1]?(l=null,u=this.paginationProxy.getRowCount()-1):(l="bottom",u=n.getPinnedBottomRowData().length-1);var c=this.columnModel.getAllDisplayedColumns();if(s(c))return;r.setCellRange({rowStartIndex:0,rowStartPinned:a,rowEndIndex:u,rowEndPinned:l,columnStart:c[0],columnEnd:yt(c)})}t.preventDefault()},e.prototype.onCtrlAndC=function(t){if(this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")){var e=this.getControlsForEventTarget(t.target),n=e.cellCtrl,o=e.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===o||void 0===o?void 0:o.isEditing())||(t.preventDefault(),this.clipboardService.copyToClipboard())}},e.prototype.onCtrlAndX=function(t){if(this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")&&!this.gridOptionsService.is("suppressCutToClipboard")){var e=this.getControlsForEventTarget(t.target),n=e.cellCtrl,o=e.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===o||void 0===o?void 0:o.isEditing())||(t.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}},e.prototype.onCtrlAndV=function(t){var e=this.getControlsForEventTarget(t.target),n=e.cellCtrl,o=e.rowCtrl;(null===n||void 0===n?void 0:n.isEditing())||(null===o||void 0===o?void 0:o.isEditing())||this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()},e.prototype.onCtrlAndD=function(t){this.clipboardService&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),t.preventDefault()},e.prototype.onCtrlAndZ=function(t){this.gridOptionsService.is("undoRedoCellEditing")&&(t.preventDefault(),t.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))},e.prototype.onCtrlAndY=function(){this.undoRedoService.redo("ui")},wu([$("mouseEventService")],e.prototype,"mouseEventService",void 0),wu([$("valueService")],e.prototype,"valueService",void 0),wu([tt("contextMenuFactory")],e.prototype,"contextMenuFactory",void 0),wu([$("ctrlsService")],e.prototype,"ctrlsService",void 0),wu([$("navigationService")],e.prototype,"navigationService",void 0),wu([$("focusService")],e.prototype,"focusService",void 0),wu([$("undoRedoService")],e.prototype,"undoRedoService",void 0),wu([$("columnModel")],e.prototype,"columnModel",void 0),wu([$("paginationProxy")],e.prototype,"paginationProxy",void 0),wu([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),wu([tt("rangeService")],e.prototype,"rangeService",void 0),wu([tt("clipboardService")],e.prototype,"clipboardService",void 0),wu([Z],e.prototype,"postConstruct",null),e}(Ht),Eu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Su=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tu=function(t){function e(e){var n=t.call(this)||this;return n.centerContainerCtrl=e,n}return Eu(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl(),t.listenForResize()})),this.addManagedListener(this.eventService,Zt.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))},e.prototype.listenForResize=function(){var t=this,e=function(){return t.onCenterViewportResized()};this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)},e.prototype.onScrollbarWidthChanged=function(){this.checkViewportAndScrolls()},e.prototype.onCenterViewportResized=function(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();var t=this.centerContainerCtrl.getCenterWidth();t!==this.centerWidth&&(this.centerWidth=t,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0},e.prototype.checkViewportAndScrolls=function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()},e.prototype.getBodyHeight=function(){return this.bodyHeight},e.prototype.checkBodyHeight=function(){var t=yo(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==t){this.bodyHeight=t;var e={type:Zt.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(e)}},e.prototype.updateScrollVisibleService=function(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)},e.prototype.updateScrollVisibleServiceImpl=function(){var t={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(t)},e.prototype.isHorizontalScrollShowing=function(){return this.centerContainerCtrl.isHorizontalScrollShowing()},e.prototype.onHorizontalViewportChanged=function(){var t=this.centerContainerCtrl.getCenterWidth(),e=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(t,e)},Su([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Su([$("columnModel")],e.prototype,"columnModel",void 0),Su([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Su([Z],e.prototype,"postConstruct",null),e}(Ht),Ru=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ou=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Pu=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return Ru(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))},e.prototype.onPinnedLeftWidthChanged=function(){var t=this.pinnedWidthService.getPinnedLeftWidth(),e=t>0;po(this.element,e),Go(this.element,t)},e.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedLeftWidth()},Ou([$("pinnedWidthService")],e.prototype,"pinnedWidthService",void 0),Ou([Z],e.prototype,"postConstruct",null),e}(Ht),Iu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Au=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Du=function(t){function e(e){var n=t.call(this)||this;return n.element=e,n}return Iu(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))},e.prototype.onPinnedRightWidthChanged=function(){var t=this.pinnedWidthService.getPinnedRightWidth(),e=t>0;po(this.element,e),Go(this.element,t)},e.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedRightWidth()},Au([$("pinnedWidthService")],e.prototype,"pinnedWidthService",void 0),Au([Z],e.prototype,"postConstruct",null),e}(Ht),Mu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Lu=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Nu=function(t){function e(e,n){var o=t.call(this)||this;return o.eContainer=e,o.eWrapper=n,o}return Mu(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Zt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))},e.prototype.onHeightChanged=function(){var t=this.maxDivHeightScaler.getUiContainerHeight(),e=null!=t?t+"px":"";this.eContainer.style.height=e,this.eWrapper&&(this.eWrapper.style.height=e)},Lu([$("rowContainerHeightService")],e.prototype,"maxDivHeightScaler",void 0),Lu([Z],e.prototype,"postConstruct",null),e}(Ht),Fu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ku=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Gu=function(t){function e(e){var n=t.call(this)||this;return n.eContainer=e,n}return Fu(e,t),e.prototype.postConstruct=function(){var t=this;if(this.gridOptionsService.isEnableRangeSelection()&&!i(this.rangeService)){var e={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(e),this.addDestroyFunc((function(){return t.dragService.removeDragSource(e)}))}},ku([tt("rangeService")],e.prototype,"rangeService",void 0),ku([$("dragService")],e.prototype,"dragService",void 0),ku([Z],e.prototype,"postConstruct",null),e}(Ht),Bu=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Vu=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},zu=function(t){function e(e,n){void 0===n&&(n=!1);var o=t.call(this)||this;return o.callback=e,o.addSpacer=n,o}return Bu(e,t),e.prototype.postConstruct=function(){var t=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",t),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED,t),this.addSpacer&&(this.addManagedListener(this.eventService,Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_SCROLLBAR_WIDTH_CHANGED,t)),this.setWidth()},e.prototype.setWidth=function(){var t,e=this.columnModel,n=this.gridOptionsService.isDomLayout("print"),o=e.getBodyContainerWidth(),r=e.getDisplayedColumnsLeftWidth(),i=e.getDisplayedColumnsRightWidth();n?t=o+r+i:(t=o,this.addSpacer&&0===(this.gridOptionsService.is("enableRtl")?r:i)&&this.scrollVisibleService.isVerticalScrollShowing()&&(t+=this.gridOptionsService.getScrollbarWidth()));this.callback(t)},Vu([$("columnModel")],e.prototype,"columnModel",void 0),Vu([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Vu([Z],e.prototype,"postConstruct",null),e}(Ht),ju=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hu=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Uu=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Wu=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};function qu(t){switch(t){case mu.CENTER:case mu.TOP_CENTER:case mu.STICKY_TOP_CENTER:case mu.BOTTOM_CENTER:return yu.CENTER;case mu.LEFT:case mu.TOP_LEFT:case mu.STICKY_TOP_LEFT:case mu.BOTTOM_LEFT:return yu.LEFT;case mu.RIGHT:case mu.TOP_RIGHT:case mu.STICKY_TOP_RIGHT:case mu.BOTTOM_RIGHT:return yu.RIGHT;case mu.FULL_WIDTH:case mu.TOP_FULL_WIDTH:case mu.STICKY_TOP_FULL_WIDTH:case mu.BOTTOM_FULL_WIDTH:return yu.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}!function(t){t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.FULL_WIDTH="fullWidth",t.TOP_LEFT="topLeft",t.TOP_RIGHT="topRight",t.TOP_CENTER="topCenter",t.TOP_FULL_WIDTH="topFullWidth",t.STICKY_TOP_LEFT="stickyTopLeft",t.STICKY_TOP_RIGHT="stickyTopRight",t.STICKY_TOP_CENTER="stickyTopCenter",t.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",t.BOTTOM_LEFT="bottomLeft",t.BOTTOM_RIGHT="bottomRight",t.BOTTOM_CENTER="bottomCenter",t.BOTTOM_FULL_WIDTH="bottomFullWidth"}(mu||(mu={})),function(t){t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.FULL_WIDTH="fullWidth"}(yu||(yu={}));var Xu=le([[mu.CENTER,"ag-center-cols-container"],[mu.LEFT,"ag-pinned-left-cols-container"],[mu.RIGHT,"ag-pinned-right-cols-container"],[mu.FULL_WIDTH,"ag-full-width-container"],[mu.TOP_CENTER,"ag-floating-top-container"],[mu.TOP_LEFT,"ag-pinned-left-floating-top"],[mu.TOP_RIGHT,"ag-pinned-right-floating-top"],[mu.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[mu.STICKY_TOP_CENTER,"ag-sticky-top-container"],[mu.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[mu.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[mu.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[mu.BOTTOM_CENTER,"ag-floating-bottom-container"],[mu.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[mu.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[mu.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),Yu=le([[mu.CENTER,"ag-center-cols-viewport"],[mu.TOP_CENTER,"ag-floating-top-viewport"],[mu.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[mu.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),Ku=le([[mu.CENTER,"ag-center-cols-clipper"]]),Zu=function(t){function e(e){var n=t.call(this)||this;return n.visible=!0,n.EMPTY_CTRLS=[],n.name=e,n.isFullWithContainer=n.name===mu.TOP_FULL_WIDTH||n.name===mu.STICKY_TOP_FULL_WIDTH||n.name===mu.BOTTOM_FULL_WIDTH||n.name===mu.FULL_WIDTH,n}return ju(e,t),e.getRowContainerCssClasses=function(t){return{container:Xu.get(t),viewport:Yu.get(t),wrapper:Ku.get(t)}},e.getPinned=function(t){switch(t){case mu.BOTTOM_LEFT:case mu.TOP_LEFT:case mu.STICKY_TOP_LEFT:case mu.LEFT:return"left";case mu.BOTTOM_RIGHT:case mu.TOP_RIGHT:case mu.STICKY_TOP_RIGHT:case mu.RIGHT:return"right";default:return null}},e.prototype.postConstruct=function(){var t=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([mu.CENTER],(function(){return t.viewportSizeFeature=t.createManagedBean(new Tu(t))}))},e.prototype.registerWithCtrlsService=function(){switch(this.name){case mu.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case mu.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case mu.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case mu.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case mu.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case mu.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case mu.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case mu.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case mu.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case mu.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case mu.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case mu.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}},e.prototype.forContainers=function(t,e){t.indexOf(this.name)>=0&&e()},e.prototype.getContainerElement=function(){return this.eContainer},e.prototype.getViewportSizeFeature=function(){return this.viewportSizeFeature},e.prototype.setComp=function(t,e,n,o){var r=this;this.comp=t,this.eContainer=e,this.eViewport=n,this.eWrapper=o,this.createManagedBean(new xu(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();var i=[mu.TOP_CENTER,mu.TOP_LEFT,mu.TOP_RIGHT],s=[mu.STICKY_TOP_CENTER,mu.STICKY_TOP_LEFT,mu.STICKY_TOP_RIGHT],a=[mu.BOTTOM_CENTER,mu.BOTTOM_LEFT,mu.BOTTOM_RIGHT],l=[mu.CENTER,mu.LEFT,mu.RIGHT],u=Wu(Wu(Wu(Wu([],Uu(i)),Uu(a)),Uu(l)),Uu(s)),c=[mu.CENTER,mu.LEFT,mu.RIGHT,mu.FULL_WIDTH],p=[mu.CENTER,mu.TOP_CENTER,mu.STICKY_TOP_CENTER,mu.BOTTOM_CENTER],h=[mu.LEFT,mu.BOTTOM_LEFT,mu.TOP_LEFT,mu.STICKY_TOP_LEFT],d=[mu.RIGHT,mu.BOTTOM_RIGHT,mu.TOP_RIGHT,mu.STICKY_TOP_RIGHT];this.forContainers(h,(function(){r.pinnedWidthFeature=r.createManagedBean(new Pu(r.eContainer)),r.addManagedListener(r.eventService,Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED,(function(){return r.onPinnedWidthChanged()}))})),this.forContainers(d,(function(){r.pinnedWidthFeature=r.createManagedBean(new Du(r.eContainer)),r.addManagedListener(r.eventService,Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,(function(){return r.onPinnedWidthChanged()}))})),this.forContainers(c,(function(){return r.createManagedBean(new Nu(r.eContainer,r.eWrapper))})),this.forContainers(u,(function(){return r.createManagedBean(new Gu(r.eContainer))})),this.forContainers(p,(function(){return r.createManagedBean(new zu((function(t){return r.comp.setContainerWidth(t+"px")})))})),Xn()&&(this.forContainers([mu.CENTER],(function(){var t=r.enableRtl?Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED:Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED;r.addManagedListener(r.eventService,t,(function(){return r.refreshPaddingForFakeScrollbar()}))})),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()},e.prototype.refreshPaddingForFakeScrollbar=function(){var t=this,e=t.enableRtl,n=t.columnModel,o=t.name,r=t.eWrapper,i=t.eContainer,s=e?mu.LEFT:mu.RIGHT;this.forContainers([mu.CENTER,s],(function(){var t=n.getContainerWidth(s),a=e?"marginLeft":"marginRight";o===mu.CENTER?r.style[a]=t?"0px":"16px":i.style[a]=t?"16px":"0px"}))},e.prototype.addListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,(function(){return t.onScrollVisibilityChanged()})),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){return t.onDisplayedColumnsChanged()})),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){return t.onDisplayedColumnsWidthChanged()})),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_ROWS_CHANGED,(function(e){return t.onDisplayedRowsChanged(e.afterScroll)})),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()},e.prototype.listenOnDomOrder=function(){var t=this;if([mu.STICKY_TOP_CENTER,mu.STICKY_TOP_LEFT,mu.STICKY_TOP_RIGHT,mu.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)this.comp.setDomOrder(!0);else{var e=function(){var e=t.gridOptionsService.is("ensureDomOrder"),n=t.gridOptionsService.isDomLayout("print");t.comp.setDomOrder(e||n)};this.addManagedPropertyListener("domLayout",e),e()}},e.prototype.stopHScrollOnPinnedRows=function(){var t=this;this.forContainers([mu.TOP_CENTER,mu.STICKY_TOP_CENTER,mu.BOTTOM_CENTER],(function(){t.addManagedListener(t.eViewport,"scroll",(function(){return t.eViewport.scrollLeft=0}))}))},e.prototype.onDisplayedColumnsChanged=function(){var t=this;this.forContainers([mu.CENTER],(function(){return t.onHorizontalViewportChanged()}))},e.prototype.onDisplayedColumnsWidthChanged=function(){var t=this;this.forContainers([mu.CENTER],(function(){return t.onHorizontalViewportChanged()}))},e.prototype.onScrollVisibilityChanged=function(){var t=this,e=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===mu.CENTER){var n=this.scrollVisibleService.isHorizontalScrollShowing()?e:0,o=0==n?"100%":"calc(100% + "+n+"px)";this.animationFrameService.requestAnimationFrame((function(){return t.comp.setViewportHeight(o)}))}if(this.name===mu.FULL_WIDTH){var r="calc(100% - "+(Xn()?16:0)+"px)";this.eContainer.style.setProperty("width",r)}},e.prototype.addPreventScrollWhileDragging=function(){var t=this,e=function(e){t.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc((function(){return t.eContainer.removeEventListener("touchmove",e)}))},e.prototype.onHorizontalViewportChanged=function(){var t=this.getCenterWidth(),e=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(t,e)},e.prototype.getCenterWidth=function(){return vo(this.eViewport)},e.prototype.getCenterViewportScrollLeft=function(){return xo(this.eViewport,this.enableRtl)},e.prototype.registerViewportResizeListener=function(t){var e=this.resizeObserverService.observeResize(this.eViewport,t);this.addDestroyFunc((function(){return e()}))},e.prototype.isViewportVisible=function(){return Ro(this.eViewport)},e.prototype.getViewportScrollLeft=function(){return xo(this.eViewport,this.enableRtl)},e.prototype.isHorizontalScrollShowing=function(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||No(this.eViewport)},e.prototype.getViewportElement=function(){return this.eViewport},e.prototype.setContainerTranslateX=function(t){this.eContainer.style.transform="translateX("+t+"px)"},e.prototype.getHScrollPosition=function(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}},e.prototype.setCenterViewportScrollLeft=function(t){Eo(this.eViewport,t,this.enableRtl)},e.prototype.isContainerVisible=function(){return!e.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0},e.prototype.onPinnedWidthChanged=function(){var t=this.isContainerVisible();this.visible!=t&&(this.visible=t,this.onDisplayedRowsChanged()),Xn()&&this.refreshPaddingForFakeScrollbar()},e.prototype.onDisplayedRowsChanged=function(t){var e=this;if(void 0===t&&(t=!1),this.visible){var n=this.gridOptionsService.isDomLayout("print"),o=this.getRowCtrls().filter((function(t){var o=t.isFullWidth(),r=e.embedFullWidthRows||n;return e.isFullWithContainer?!r&&o:r||!o}));this.comp.setRowCtrls(o,t)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)},e.prototype.getRowCtrls=function(){switch(this.name){case mu.TOP_CENTER:case mu.TOP_LEFT:case mu.TOP_RIGHT:case mu.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case mu.STICKY_TOP_CENTER:case mu.STICKY_TOP_LEFT:case mu.STICKY_TOP_RIGHT:case mu.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case mu.BOTTOM_CENTER:case mu.BOTTOM_LEFT:case mu.BOTTOM_RIGHT:case mu.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}},Hu([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Hu([$("dragService")],e.prototype,"dragService",void 0),Hu([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Hu([$("columnModel")],e.prototype,"columnModel",void 0),Hu([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Hu([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Hu([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Hu([Z],e.prototype,"postConstruct",null),e}(Ht),Ju=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qu=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$u='<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="'+mu.TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="'+mu.TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="'+mu.TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="'+mu.TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="'+mu.LEFT+'"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="'+mu.CENTER+'"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="'+mu.RIGHT+'"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="'+mu.FULL_WIDTH+'"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="'+mu.STICKY_TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="'+mu.STICKY_TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="'+mu.STICKY_TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="'+mu.STICKY_TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="'+mu.BOTTOM_LEFT+'"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="'+mu.BOTTOM_CENTER+'"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="'+mu.BOTTOM_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="'+mu.BOTTOM_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>',tc=function(t){function e(){return t.call(this,$u)||this}return Ju(e,t),e.prototype.init=function(){var t=this,e=function(t,e){var n=t+"px";e.style.minHeight=n,e.style.height=n},n={setRowAnimationCssOnBodyViewport:function(e,n){return t.setRowAnimationCssOnBodyViewport(e,n)},setColumnCount:function(e){return mn(t.getGui(),e)},setRowCount:function(e){return fn(t.getGui(),e)},setTopHeight:function(n){return e(n,t.eTop)},setBottomHeight:function(n){return e(n,t.eBottom)},setTopDisplay:function(e){return t.eTop.style.display=e},setBottomDisplay:function(e){return t.eBottom.style.display=e},setStickyTopHeight:function(e){return t.eStickyTop.style.height=e},setStickyTopTop:function(e){return t.eStickyTop.style.top=e},setStickyTopWidth:function(e){return t.eStickyTop.style.width=e},setColumnMovingCss:function(e,n){return t.addOrRemoveCssClass(e,n)},updateLayoutClasses:function(e,n){[t.eBodyViewport.classList,t.eBodyClipper.classList,t.eBody.classList].forEach((function(t){t.toggle(cl.AUTO_HEIGHT,n.autoHeight),t.toggle(cl.NORMAL,n.normal),t.toggle(cl.PRINT,n.print)})),t.addOrRemoveCssClass(cl.AUTO_HEIGHT,n.autoHeight),t.addOrRemoveCssClass(cl.NORMAL,n.normal),t.addOrRemoveCssClass(cl.PRINT,n.print)},setAlwaysVerticalScrollClass:function(e,n){return t.eBodyViewport.classList.toggle(jl,n)},registerBodyViewportResizeListener:function(e){var n=t.resizeObserverService.observeResize(t.eBodyViewport,e);t.addDestroyFunc((function(){return n()}))},setPinnedTopBottomOverflowY:function(e){return t.eTop.style.overflowY=t.eBottom.style.overflowY=e},setCellSelectableCss:function(e,n){[t.eTop,t.eBodyViewport,t.eBottom].forEach((function(t){return t.classList.toggle(e,n)}))},setBodyViewportWidth:function(e){return t.eBodyViewport.style.width=e}};this.ctrl=this.createManagedBean(new Hl),this.ctrl.setComp(n,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&dn(this.getGui(),!0)},e.prototype.setRowAnimationCssOnBodyViewport=function(t,e){var n=this.eBodyViewport.classList;n.toggle(Pl.ANIMATION_ON,e),n.toggle(Pl.ANIMATION_OFF,!e)},e.prototype.getFloatingTopBottom=function(){return[this.eTop,this.eBottom]},Qu([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Qu([tt("rangeService")],e.prototype,"rangeService",void 0),Qu([Or("eBodyViewport")],e.prototype,"eBodyViewport",void 0),Qu([Or("eStickyTop")],e.prototype,"eStickyTop",void 0),Qu([Or("eTop")],e.prototype,"eTop",void 0),Qu([Or("eBottom")],e.prototype,"eBottom",void 0),Qu([Or("gridHeader")],e.prototype,"headerRootComp",void 0),Qu([Or("eBodyClipper")],e.prototype,"eBodyClipper",void 0),Qu([Or("eBody")],e.prototype,"eBody",void 0),Qu([Z],e.prototype,"init",null),e}(Tr),ec=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ec(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))},e.prototype.onDisplayedColumnsChanged=function(){this.update()},e.prototype.onDisplayedColumnsWidthChanged=function(){this.update()},e.prototype.update=function(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)},e.prototype.updateImpl=function(){var t=this.ctrlsService.getCenterRowContainerCtrl();if(t){var e={horizontalScrollShowing:t.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(e)}},e.prototype.setScrollsVisible=function(t){if(this.horizontalScrollShowing!==t.horizontalScrollShowing||this.verticalScrollShowing!==t.verticalScrollShowing){this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing;var e={type:Zt.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(e)}},e.prototype.isHorizontalScrollShowing=function(){return this.horizontalScrollShowing},e.prototype.isVerticalScrollShowing=function(){return this.verticalScrollShowing},nc([$("ctrlsService")],e.prototype,"ctrlsService",void 0),nc([Z],e.prototype,"postConstruct",null),e=nc([Q("scrollVisibleService")],e)}(Ht),rc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ic=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},sc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridInstanceId=n.gridInstanceSequence.next(),e}var n;return rc(e,t),n=e,e.prototype.stampTopLevelGridCompWithGridInstance=function(t){t[n.GRID_DOM_KEY]=this.gridInstanceId},e.prototype.getRenderedCellForEvent=function(t){return Ft(this.gridOptionsService,t.target,pu.DOM_DATA_KEY_CELL_CTRL)},e.prototype.isEventFromThisGrid=function(t){return this.isElementInThisGrid(t.target)},e.prototype.isElementInThisGrid=function(t){for(var e=t;e;){var o=e[n.GRID_DOM_KEY];if(r(o))return o===this.gridInstanceId;e=e.parentElement}return!1},e.prototype.getCellPositionForEvent=function(t){var e=this.getRenderedCellForEvent(t);return e?e.getCellPosition():null},e.prototype.getNormalisedPosition=function(t){var e,n,o=this.gridOptionsService.isDomLayout("normal"),r=t;if(null!=r.clientX||null!=r.clientY?(e=r.clientX,n=r.clientY):(e=r.x,n=r.y),o){var i=this.ctrlsService.getGridBodyCtrl(),s=i.getScrollFeature().getVScrollPosition();e+=i.getScrollFeature().getHScrollPosition().left,n+=s.top}return{x:e,y:n}},e.gridInstanceSequence=new dr,e.GRID_DOM_KEY="__ag_grid_instance",ic([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=n=ic([Q("mouseEventService")],e)}(Ht),ac=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),lc=function(){return lc=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},lc.apply(this,arguments)},uc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},cc=function(t){function e(){var e=t.call(this)||this;return e.onPageDown=G(e.onPageDown,100),e.onPageUp=G(e.onPageUp,100),e}return ac(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.gridBodyCon=e.gridBodyCtrl}))},e.prototype.handlePageScrollingKey=function(t,e){void 0===e&&(e=!1);var n=t.key,o=t.altKey,r=t.ctrlKey||t.metaKey,i=!!this.rangeService&&t.shiftKey,s=this.mouseEventService.getCellPositionForEvent(t),a=!1;switch(n){case Qo.PAGE_HOME:case Qo.PAGE_END:r||o||(this.onHomeOrEndKey(n),a=!0);break;case Qo.LEFT:case Qo.RIGHT:case Qo.UP:case Qo.DOWN:if(!s)return!1;!r||o||i||(this.onCtrlUpDownLeftRight(n,s),a=!0);break;case Qo.PAGE_DOWN:case Qo.PAGE_UP:r||o||(a=this.handlePageUpDown(n,s,e))}return a&&t.preventDefault(),a},e.prototype.handlePageUpDown=function(t,e,n){return n&&(e=this.focusService.getFocusedCell()),!!e&&(t===Qo.PAGE_UP?this.onPageUp(e):this.onPageDown(e),!0)},e.prototype.navigateTo=function(t){var e=t.scrollIndex,n=t.scrollType,o=t.scrollColumn,i=t.focusIndex,s=t.focusColumn;if(r(o)&&!o.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(o),r(e)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e,n),t.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(i),this.focusService.setFocusedCell({rowIndex:i,column:s,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){var a={rowIndex:i,rowPinned:null,column:s};this.rangeService.setRangeToCell(a)}},e.prototype.onPageDown=function(t){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.getViewportHeight(),o=this.paginationProxy.getPixelOffset(),r=e.top+n,i=this.paginationProxy.getRowIndexAtPixel(r+o);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(t,i):this.navigateToNextPage(t,i)},e.prototype.onPageUp=function(t){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.paginationProxy.getPixelOffset(),o=e.top,r=this.paginationProxy.getRowIndexAtPixel(o+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(t,r,!0):this.navigateToNextPage(t,r,!0)},e.prototype.navigateToNextPage=function(t,e,n){void 0===n&&(n=!1);var o,r=this.getViewportHeight(),i=this.paginationProxy.getPageFirstRow(),s=this.paginationProxy.getPageLastRow(),a=this.paginationProxy.getPixelOffset(),l=this.paginationProxy.getRow(t.rowIndex),u=n?(null===l||void 0===l?void 0:l.rowHeight)-r-a:r-a,c=(null===l||void 0===l?void 0:l.rowTop)+u,p=this.paginationProxy.getRowIndexAtPixel(c+a);if(p===t.rowIndex){var h=n?-1:1;e=p=t.rowIndex+h}n?(o="bottom",p<i&&(p=i),e<i&&(e=i)):(o="top",p>s&&(p=s),e>s&&(e=s)),this.isRowTallerThanView(p)&&(e=p,o="top"),this.navigateTo({scrollIndex:e,scrollType:o,scrollColumn:null,focusIndex:p,focusColumn:t.column})},e.prototype.navigateToNextPageWithAutoHeight=function(t,e,n){var o=this;void 0===n&&(n=!1),this.navigateTo({scrollIndex:e,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:e,focusColumn:t.column}),setTimeout((function(){var r=o.getNextFocusIndexForAutoHeight(t,n);o.navigateTo({scrollIndex:e,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:r,focusColumn:t.column,isAsync:!0})}),50)},e.prototype.getNextFocusIndexForAutoHeight=function(t,e){var n;void 0===e&&(e=!1);for(var o=e?-1:1,r=this.getViewportHeight(),i=this.paginationProxy.getPageLastRow(),s=0,a=t.rowIndex;a>=0&&a<=i;){var l=this.paginationProxy.getRow(a);if(l){var u=null!==(n=l.rowHeight)&&void 0!==n?n:0;if(s+u>r)break;s+=u}a+=o}return Math.max(0,Math.min(a,i))},e.prototype.getViewportHeight=function(){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),e=this.gridOptionsService.getScrollbarWidth(),n=t.bottom-t.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(n-=e),n},e.prototype.isRowTallerThanView=function(t){var e=this.paginationProxy.getRow(t);if(!e)return!1;var n=e.rowHeight;return"number"===typeof n&&n>this.getViewportHeight()},e.prototype.onCtrlUpDownLeftRight=function(t,e){var n=this.cellNavigationService.getNextCellToFocus(t,e,!0),o=n.rowIndex,r=n.column;this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:r,focusIndex:o,focusColumn:r})},e.prototype.onHomeOrEndKey=function(t){var e=t===Qo.PAGE_HOME,n=this.columnModel.getAllDisplayedColumns(),o=e?n[0]:yt(n),r=e?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:o,focusIndex:r,focusColumn:o})},e.prototype.onTabKeyDown=function(t,e){var n=e.shiftKey;if(this.tabToNextCellCommon(t,n,e))e.preventDefault();else if(n){var o=t.getRowPosition(),r=o.rowIndex;(o.rowPinned?0===r:r===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(e.preventDefault(),this.focusService.focusPreviousFromFirstCell(e)))}else t instanceof pu&&t.focusCell(!0),this.focusService.focusNextGridCoreContainer(n)&&e.preventDefault()},e.prototype.tabToNextCell=function(t,e){var n=this.focusService.getFocusedCell();if(!n)return!1;var o=this.getCellByPosition(n);return!!(o||(o=this.rowRenderer.getRowByPosition(n))&&o.isFullWidth())&&this.tabToNextCellCommon(o,t,e)},e.prototype.tabToNextCellCommon=function(t,e,n){var o=t.isEditing();if(!o&&t instanceof pu){var r=t.getRowCtrl();r&&(o=r.isEditing())}return(o?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(t,e,n):this.moveToNextEditingCell(t,e,n):this.moveToNextCellNotEditing(t,e))||!!this.focusService.getFocusedHeader()},e.prototype.moveToNextEditingCell=function(t,e,n){void 0===n&&(n=null);var o=t.getCellPosition();t.getGui().focus(),t.stopEditing();var r=this.findNextCellToFocusOn(o,e,!0);return null!=r&&(r.startEditing(null,!0,n),r.focusCell(!1),!0)},e.prototype.moveToNextEditingRow=function(t,e,n){void 0===n&&(n=null);var o=t.getCellPosition(),r=this.findNextCellToFocusOn(o,e,!0);if(null==r)return!1;var i=r.getCellPosition(),s=this.isCellEditable(o),a=this.isCellEditable(i),l=i&&o.rowIndex===i.rowIndex&&o.rowPinned===i.rowPinned;(s&&t.setFocusOutOnEditor(),l)||(t.getRowCtrl().stopEditing(),r.getRowCtrl().startRowEditing(void 0,void 0,n));return a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0},e.prototype.moveToNextCellNotEditing=function(t,e){var n,o=this.columnModel.getAllDisplayedColumns();n=t instanceof _u?lc(lc({},t.getRowPosition()),{column:e?o[0]:yt(o)}):t.getCellPosition();var i=this.findNextCellToFocusOn(n,e,!1);if(i instanceof pu)i.focusCell(!0);else if(i)return this.tryToFocusFullWidthRow(i.getRowPosition(),e);return r(i)},e.prototype.findNextCellToFocusOn=function(t,e,n){for(var o=t;;){t!==o&&(t=o),e||(o=this.getLastCellOfColSpan(o)),o=this.cellNavigationService.getNextTabbedCell(o,e);var i=this.gridOptionsService.getCallback("tabToNextCell");if(r(i)){var s=i({backwards:e,editing:n,previousCellPosition:t,nextCellPosition:o||null});r(s)?(s.floating&&(P((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),s.rowPinned=s.floating),o={rowIndex:s.rowIndex,column:s.column,rowPinned:s.rowPinned}):o=null}if(!o)return null;if(o.rowIndex<0){var a=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+o.rowIndex,column:o.column},fromCell:!0}),null}var l="fullRow"===this.gridOptionsService.get("editType");if(n&&!l)if(!this.isCellEditable(o))continue;this.ensureCellVisible(o);var u=this.getCellByPosition(o);if(!u){var c=this.rowRenderer.getRowByPosition(o);if(!c||!c.isFullWidth()||n)continue;return c}if(!u.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(o),u}},e.prototype.isCellEditable=function(t){var e=this.lookupRowNodeForCell(t);return!!e&&t.column.isCellEditable(e)},e.prototype.getCellByPosition=function(t){var e=this.rowRenderer.getRowByPosition(t);return e?e.getCellCtrl(t.column):null},e.prototype.lookupRowNodeForCell=function(t){return"top"===t.rowPinned?this.pinnedRowModel.getPinnedTopRow(t.rowIndex):"bottom"===t.rowPinned?this.pinnedRowModel.getPinnedBottomRow(t.rowIndex):this.paginationProxy.getRow(t.rowIndex)},e.prototype.navigateToNextCell=function(t,e,n,o){for(var s=n,a=!1;s&&(s===n||!this.isValidNavigateCell(s));)this.gridOptionsService.is("enableRtl")?e===Qo.LEFT&&(s=this.getLastCellOfColSpan(s)):e===Qo.RIGHT&&(s=this.getLastCellOfColSpan(s)),a=i(s=this.cellNavigationService.getNextCellToFocus(e,s));if(a&&t&&t.key===Qo.UP&&(s={rowIndex:-1,rowPinned:null,column:n.column}),o){var l=this.gridOptionsService.getCallback("navigateToNextCell");if(r(l)){var u=l({key:e,previousCellPosition:n,nextCellPosition:s||null,event:t});r(u)?(u.floating&&(P((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),u.rowPinned=u.floating),s={rowPinned:u.rowPinned,rowIndex:u.rowIndex,column:u.column}):s=null}}if(s)if(s.rowIndex<0){var c=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:c+s.rowIndex,column:n.column},event:t||void 0,fromCell:!0})}else{var p=this.getNormalisedPosition(s);p?this.focusPosition(p):this.tryToFocusFullWidthRow(s)}},e.prototype.getNormalisedPosition=function(t){this.ensureCellVisible(t);var e=this.getCellByPosition(t);return e?(t=e.getCellPosition(),this.ensureCellVisible(t),t):null},e.prototype.tryToFocusFullWidthRow=function(t,e){void 0===e&&(e=!1);var n=this.columnModel.getAllDisplayedColumns(),o=this.rowRenderer.getRowByPosition(t);if(!o||!o.isFullWidth())return!1;var r=this.focusService.getFocusedCell(),i={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column||(e?yt(n):n[0])};this.focusPosition(i);var s=null!=r&&this.rowPositionUtils.before(i,r),a={type:Zt.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:i.rowIndex,rowPinned:i.rowPinned,column:i.column,isFullWidthCell:!0,floating:i.rowPinned,fromBelow:s};return this.eventService.dispatchEvent(a),!0},e.prototype.focusPosition=function(t){this.focusService.setFocusedCell({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(t)},e.prototype.isValidNavigateCell=function(t){return!!this.rowPositionUtils.getRowNode(t)},e.prototype.getLastCellOfColSpan=function(t){var e=this.getCellByPosition(t);if(!e)return t;var n=e.getColSpanningList();return 1===n.length?t:{rowIndex:t.rowIndex,column:yt(n),rowPinned:t.rowPinned}},e.prototype.ensureCellVisible=function(t){var e=this.gridOptionsService.isGroupRowsSticky(),n=this.rowModel.getRow(t.rowIndex);!(e&&(null===n||void 0===n?void 0:n.sticky))&&i(t.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t.rowIndex),t.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(t.column)},uc([$("mouseEventService")],e.prototype,"mouseEventService",void 0),uc([$("paginationProxy")],e.prototype,"paginationProxy",void 0),uc([$("focusService")],e.prototype,"focusService",void 0),uc([tt("rangeService")],e.prototype,"rangeService",void 0),uc([$("columnModel")],e.prototype,"columnModel",void 0),uc([$("rowModel")],e.prototype,"rowModel",void 0),uc([$("ctrlsService")],e.prototype,"ctrlsService",void 0),uc([$("rowRenderer")],e.prototype,"rowRenderer",void 0),uc([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),uc([$("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),uc([$("cellNavigationService")],e.prototype,"cellNavigationService",void 0),uc([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),uc([Z],e.prototype,"postConstruct",null),e=uc([Q("navigationService")],e)}(Ht),pc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),hc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},dc=function(t){function e(e){var n=t.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')||this;return n.params=e,n}return pc(e,t),e.prototype.postConstruct=function(){this.gridOptionsService.setDomData(this.getGui(),e.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()},e.prototype.addKeyDownListener=function(){var t=this,e=this.getGui(),n=this.params;this.addManagedListener(e,"keydown",(function(e){tr(t.gridOptionsService,e,n.node,n.column,!0)||n.onKeyDown(e)}))},e.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",hc([Z],e.prototype,"postConstruct",null),e}(ys),fc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gc=function(t){function e(e,n,o,r,i){var s=t.call(this)||this;s.rendererVersion=0,s.editorVersion=0,s.beans=e,s.column=n.getColumn(),s.rowNode=n.getRowNode(),s.rowCtrl=n.getRowCtrl(),s.eRow=r,s.cellCtrl=n,s.setTemplate('<div comp-id="'+s.getCompId()+'"/>');var a=s.getGui();s.forceWrapper=n.isForceWrapper(),s.refreshWrapper(!1);var l=function(t,e){null!=e&&""!=e?a.setAttribute(t,e):a.removeAttribute(t)};Ze(a,"gridcell"),l("col-id",n.getColumnIdSanitised());var u=n.getTabIndex();void 0!==u&&l("tabindex",u.toString());var c={addOrRemoveCssClass:function(t,e){return s.addOrRemoveCssClass(t,e)},setUserStyles:function(t){return Lo(a,t)},getFocusableElement:function(){return s.getFocusableElement()},setIncludeSelection:function(t){return s.includeSelection=t},setIncludeRowDrag:function(t){return s.includeRowDrag=t},setIncludeDndSource:function(t){return s.includeDndSource=t},setRenderDetails:function(t,e,n){return s.setRenderDetails(t,e,n)},setEditDetails:function(t,e,n){return s.setEditDetails(t,e,n)},getCellEditor:function(){return s.cellEditor||null},getCellRenderer:function(){return s.cellRenderer||null},getParentOfValue:function(){return s.getParentOfValue()}};return n.setComp(c,s.getGui(),s.eCellWrapper,o,i),s}return fc(e,t),e.prototype.getParentOfValue=function(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()},e.prototype.setRenderDetails=function(t,e,n){if(!(this.cellEditor&&!this.cellEditorPopupWrapper)){this.firstRender=null==this.firstRender;var o=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),t)!(n||o)&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t));else this.destroyRenderer(),this.insertValueWithoutCellRenderer(e)}},e.prototype.setEditDetails=function(t,e,n){t?this.createCellEditorInstance(t,e,n):this.destroyEditor()},e.prototype.removeControls=function(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)},e.prototype.refreshWrapper=function(t){var e=this.includeRowDrag||this.includeDndSource||this.includeSelection,n=e||this.forceWrapper,o=n&&null==this.eCellWrapper;o&&(this.eCellWrapper=Oo('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));var r=!n&&null!=this.eCellWrapper;r&&(To(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!n);var i=!t&&n,s=i&&null==this.eCellValue;s&&(this.eCellValue=Oo('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));var a=!i&&null!=this.eCellValue;a&&(To(this.eCellValue),this.eCellValue=void 0);var l=o||r||s||a;return l&&this.removeControls(),t||e&&this.addControls(),l},e.prototype.addControls=function(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))},e.prototype.createCellEditorInstance=function(t,e,n){var o=this,r=this.editorVersion,s=t.newAgStackInstance();if(s){var a=t.params;s.then((function(t){return o.afterCellEditorCreated(r,t,a,e,n)})),i(this.cellEditor)&&a.cellStartedEdit&&this.cellCtrl.focusCell(!0)}},e.prototype.insertValueWithoutCellRenderer=function(t){var e=this.getParentOfValue();So(e);var n=null!=t?re(t):null;null!=n&&(e.innerHTML=n)},e.prototype.destroyEditorAndRenderer=function(){this.destroyRenderer(),this.destroyEditor()},e.prototype.destroyRenderer=function(){var t=this.beans.context;this.cellRenderer=t.destroyBean(this.cellRenderer),To(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++},e.prototype.destroyEditor=function(){var t=this.beans.context;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),To(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++},e.prototype.refreshCellRenderer=function(t){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==t.componentClass)return!1;var e=this.cellRenderer.refresh(t.params);return!0===e||void 0===e},e.prototype.createCellRendererInstance=function(t){var e=this,n=!this.beans.gridOptionsService.is("suppressAnimationFrame"),o=this.rendererVersion,r=t.componentClass,i=function(){if(!(e.rendererVersion!==o||!e.isAlive())){var n=t.newAgStackInstance(),i=e.afterCellRendererCreated.bind(e,o,r);n&&n.then(i)}};n&&this.firstRender?this.beans.animationFrameService.createTask(i,this.rowNode.rowIndex,"createTasksP2"):i()},e.prototype.getCtrl=function(){return this.cellCtrl},e.prototype.getRowCtrl=function(){return this.rowCtrl},e.prototype.getCellRenderer=function(){return this.cellRenderer},e.prototype.getCellEditor=function(){return this.cellEditor},e.prototype.afterCellRendererCreated=function(t,e,n){if(!this.isAlive()||t!==this.rendererVersion)this.beans.context.destroyBean(n);else if(this.cellRenderer=n,this.cellRendererClass=e,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){var o=this.getParentOfValue();So(o),o.appendChild(this.cellRendererGui)}},e.prototype.afterCellEditorCreated=function(t,e,n,o,r){if(t!==this.editorVersion)this.beans.context.destroyBean(e);else{if(e.isCancelBeforeStart&&e.isCancelBeforeStart())return this.beans.context.destroyBean(e),void this.cellCtrl.stopEditing(!0);if(!e.getGui)return console.warn("AG Grid: cellEditor for column "+this.column.getId()+" is missing getGui() method"),void this.beans.context.destroyBean(e);this.cellEditor=e,this.cellEditorGui=e.getGui();var i=o||void 0!==e.isPopup&&e.isPopup();i?this.addPopupCellEditor(n,r):this.addInCellEditor(),this.refreshEditStyles(!0,i),e.afterGuiAttached&&e.afterGuiAttached()}},e.prototype.refreshEditStyles=function(t,e){var n;this.addOrRemoveCssClass("ag-cell-inline-editing",t&&!e),this.addOrRemoveCssClass("ag-cell-popup-editing",t&&!!e),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!t||!!e),null===(n=this.rowCtrl)||void 0===n||n.setInlineEditingCss(t)},e.prototype.addInCellEditor=function(){var t=this.getGui(),e=this.beans.gridOptionsService.getDocument();(t.contains(e.activeElement)&&t.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui)&&this.getParentOfValue().appendChild(this.cellEditorGui)},e.prototype.addPopupCellEditor=function(t,e){var n=this;"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var o=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new dc(t));var r=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&r.appendChild(this.cellEditorGui);var i=this.beans.popupService,s=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),a=null!=e?e:o.getPopupPosition?o.getPopupPosition():"over",l=this.beans.gridOptionsService.is("enableRtl"),u={ePopup:r,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:a,alignSide:l?"right":"left",keepWithinBounds:!0},c=i.positionPopupByComponent.bind(i,u),p=this.beans.localeService.getLocaleTextFunc(),h=i.addPopup({modal:s,eChild:r,closeOnEsc:!0,closedCallback:function(){n.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:c,ariaLabel:p("ariaLabelCellEditor","Cell Editor")});h&&(this.hideEditorPopup=h.hideFunc)},e.prototype.detach=function(){this.eRow.removeChild(this.getGui())},e.prototype.destroy=function(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),t.prototype.destroy.call(this)},e.prototype.clearParentOfValue=function(){var t=this.getGui(),e=this.beans.gridOptionsService.getDocument();t.contains(e.activeElement)&&Vn()&&t.focus({preventScroll:!0}),So(this.getParentOfValue())},e}(Tr),mc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),yc=function(t){function e(e,n,o){var r=t.call(this)||this;r.cellComps={},r.beans=n,r.rowCtrl=e,r.setTemplate('<div comp-id="'+r.getCompId()+'" style="'+r.getInitialStyle(o)+'"/>');var i=r.getGui(),s=i.style;r.domOrder=r.rowCtrl.getDomOrder(),Ze(i,"row");var a=r.rowCtrl.getTabIndex();null!=a&&i.setAttribute("tabindex",a.toString());var l={setDomOrder:function(t){return r.domOrder=t},setCellCtrls:function(t){return r.setCellCtrls(t)},showFullWidth:function(t){return r.showFullWidth(t)},getFullWidthCellRenderer:function(){return r.getFullWidthCellRenderer()},addOrRemoveCssClass:function(t,e){return r.addOrRemoveCssClass(t,e)},setUserStyles:function(t){return Lo(i,t)},setTop:function(t){return s.top=t},setTransform:function(t){return s.transform=t},setRowIndex:function(t){return i.setAttribute("row-index",t)},setRowId:function(t){return i.setAttribute("row-id",t)},setRowBusinessKey:function(t){return i.setAttribute("row-business-key",t)}};return e.setComp(l,r.getGui(),o),r.addDestroyFunc((function(){e.unsetComp(o)})),r}return mc(e,t),e.prototype.getInitialStyle=function(t){var e=this.rowCtrl.getInitialTransform(t),n=this.rowCtrl.getInitialRowTop(t);return e?"transform: "+e:"top: "+n},e.prototype.showFullWidth=function(t){var e=this,n=t.newAgStackInstance();n&&n.then((function(t){if(e.isAlive()){var n=t.getGui();e.getGui().appendChild(n),e.rowCtrl.setupDetailRowAutoHeight(n),e.setFullWidthRowComp(t)}else e.beans.context.destroyBean(t)}))},e.prototype.setCellCtrls=function(t){var e=this,n=Object.assign({},this.cellComps);t.forEach((function(t){var o=t.getInstanceId();null==e.cellComps[o]?e.newCellComp(t):n[o]=null}));var o=b(n).filter((function(t){return null!=t}));this.destroyCells(o),this.ensureDomOrder(t)},e.prototype.ensureDomOrder=function(t){var e=this;if(this.domOrder){var n=[];t.forEach((function(t){var o=e.cellComps[t.getInstanceId()];o&&n.push(o.getGui())})),Do(this.getGui(),n)}},e.prototype.newCellComp=function(t){var e=new gc(this.beans,t,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[t.getInstanceId()]=e,this.getGui().appendChild(e.getGui())},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.destroyAllCells()},e.prototype.destroyAllCells=function(){var t=b(this.cellComps).filter((function(t){return null!=t}));this.destroyCells(t)},e.prototype.setFullWidthRowComp=function(t){var e=this;this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=t,this.addDestroyFunc((function(){e.fullWidthCellRenderer=e.beans.context.destroyBean(e.fullWidthCellRenderer)}))},e.prototype.getFullWidthCellRenderer=function(){return this.fullWidthCellRenderer},e.prototype.destroyCells=function(t){var e=this;t.forEach((function(t){if(t){var n=t.getCtrl().getInstanceId();e.cellComps[n]===t&&(t.detach(),t.destroy(),e.cellComps[n]=null)}}))},e}(Tr),vc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_c=function(){return _c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},_c.apply(this,arguments)},Cc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};var wc,bc=function(t){function e(){var e=t.call(this,function(){var t=Tr.elementGettingCreated.getAttribute("name"),e=Zu.getRowContainerCssClasses(t),n=t===mu.CENTER,o=t===mu.TOP_CENTER||t===mu.STICKY_TOP_CENTER||t===mu.BOTTOM_CENTER;return n?'<div class="'+e.wrapper+'" ref="eWrapper" role="presentation">\n                <div class="'+e.viewport+'" ref="eViewport" role="presentation">\n                    <div class="'+e.container+'" ref="eContainer"></div>\n                </div>\n            </div>':o?'<div class="'+e.viewport+'" ref="eViewport" role="presentation">\n                <div class="'+e.container+'" ref="eContainer"></div>\n            </div>':'<div class="'+e.container+'" ref="eContainer"></div>'}())||this;return e.rowComps={},e.name=Tr.elementGettingCreated.getAttribute("name"),e.type=qu(e.name),e}return vc(e,t),e.prototype.postConstruct=function(){var t=this,e={setViewportHeight:function(e){return t.eViewport.style.height=e},setRowCtrls:function(e){return t.setRowCtrls(e)},setDomOrder:function(e){t.domOrder=e},setContainerWidth:function(e){return t.eContainer.style.width=e}};this.createManagedBean(new Zu(this.name)).setComp(e,this.eContainer,this.eViewport,this.eWrapper)},e.prototype.preDestroy=function(){this.setRowCtrls([])},e.prototype.setRowCtrls=function(t){var e=this,n=_c({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;t.forEach((function(t){var o=t.getInstanceId(),r=n[o];if(r)e.rowComps[o]=r,delete n[o],e.ensureDomOrder(r.getGui());else{if(!t.getRowNode().displayed)return;var i=new yc(t,e.beans,e.type);e.rowComps[o]=i,e.appendRow(i.getGui())}})),b(n).forEach((function(t){e.eContainer.removeChild(t.getGui()),t.destroy()})),Ze(this.eContainer,t.length?"rowgroup":"presentation")},e.prototype.appendRow=function(t){this.domOrder?Mo(this.eContainer,t,this.lastPlacedElement):this.eContainer.appendChild(t),this.lastPlacedElement=t},e.prototype.ensureDomOrder=function(t){this.domOrder&&(Ao(this.eContainer,t,this.lastPlacedElement),this.lastPlacedElement=t)},Cc([$("beans")],e.prototype,"beans",void 0),Cc([Or("eViewport")],e.prototype,"eViewport",void 0),Cc([Or("eContainer")],e.prototype,"eContainer",void 0),Cc([Or("eWrapper")],e.prototype,"eWrapper",void 0),Cc([Z],e.prototype,"postConstruct",null),Cc([J],e.prototype,"preDestroy",null),e}(Tr),xc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ec=function(){function t(t){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=t}return t.prototype.onDragEnter=function(t){var e=this;if(this.clearColumnsList(),!this.gridOptionsService.is("functionsReadOnly")){var n=t.dragItem.columns;n&&n.forEach((function(t){t.isPrimary()&&(t.isAnyFunctionActive()||(t.isAllowValue()?e.columnsToAggregate.push(t):t.isAllowRowGroup()?e.columnsToGroup.push(t):t.isAllowPivot()&&e.columnsToPivot.push(t)))}))}},t.prototype.getIconName=function(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?qs.ICON_PINNED:qs.ICON_MOVE:null},t.prototype.onDragLeave=function(t){this.clearColumnsList()},t.prototype.clearColumnsList=function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0},t.prototype.onDragging=function(t){},t.prototype.onDragStop=function(t){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")},xc([$("columnModel")],t.prototype,"columnModel",void 0),xc([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),t}(),Sc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tc=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Rc=function(){function t(t,e){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=t,this.eContainer=e,this.centerContainer=!r(t)}return t.prototype.init=function(){var t=this;this.ctrlsService.whenReady((function(){t.gridBodyCon=t.ctrlsService.getGridBodyCtrl()}))},t.prototype.getIconName=function(){return this.pinned?qs.ICON_PINNED:qs.ICON_MOVE},t.prototype.onDragEnter=function(t){var e=t.dragItem.columns;if(t.dragSource.type===Hi.ToolPanel)this.setColumnsVisible(e,!0,"uiColumnDragged");else{var n=t.dragItem.visibleState,o=(e||[]).filter((function(t){return n[t.getId()]}));this.setColumnsVisible(o,!0,"uiColumnDragged")}this.setColumnsPinned(e,this.pinned,"uiColumnDragged"),this.onDragging(t,!0,!0)},t.prototype.onDragLeave=function(){this.ensureIntervalCleared(),this.lastMovedInfo=null},t.prototype.setColumnsVisible=function(t,e,n){if(void 0===n&&(n="api"),t){var o=t.filter((function(t){return!t.getColDef().lockVisible}));this.columnModel.setColumnsVisible(o,e,n)}},t.prototype.setColumnsPinned=function(t,e,n){if(void 0===n&&(n="api"),t){var o=t.filter((function(t){return!t.getColDef().lockPinned}));this.columnModel.setColumnsPinned(o,e,n)}},t.prototype.onDragStop=function(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null},t.prototype.normaliseX=function(t){this.gridOptionsService.is("enableRtl")&&(t=this.eContainer.clientWidth-t);return this.centerContainer&&(t+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),t},t.prototype.checkCenterForScrolling=function(t){if(this.centerContainer){var e=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),n=e+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=t<e+50,this.needToMoveLeft=t>n-50):(this.needToMoveLeft=t<e+50,this.needToMoveRight=t>n-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}},t.prototype.onDragging=function(t,e,n,o){var r,s=this;if(void 0===t&&(t=this.lastDraggingEvent),void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),o){if(this.lastMovedInfo){var a=this.lastMovedInfo,l=a.columns,u=a.toIndex;this.moveColumns(l,u,"uiColumnMoved",!0)}}else if(this.lastDraggingEvent=t,!i(t.hDirection)){var c=this.normaliseX(t.x);e||this.checkCenterForScrolling(c);var p=this.normaliseDirection(t.hDirection),h=t.dragSource.type,d=(null===(r=t.dragSource.getDragItem().columns)||void 0===r?void 0:r.filter((function(t){return!t.getColDef().lockPinned||t.getPinned()==s.pinned})))||[];this.attemptMoveColumns({dragSourceType:h,allMovingColumns:d,hDirection:p,mouseX:c,fromEnter:e,fakeEvent:n})}},t.prototype.normaliseDirection=function(t){if(!this.gridOptionsService.is("enableRtl"))return t;switch(t){case Wi.Left:return Wi.Right;case Wi.Right:return Wi.Left;default:console.error("AG Grid: Unknown direction "+t)}},t.prototype.attemptMoveColumns=function(t){var e=t.dragSourceType,n=t.hDirection,o=t.mouseX,r=t.fromEnter,i=t.fakeEvent,s=n===Wi.Left,a=n===Wi.Right,l=t.allMovingColumns;if(e===Hi.HeaderCell){var u=[];l.forEach((function(t){for(var e,n=null,o=t.getParent();null!=o&&1===o.getDisplayedLeafColumns().length;)n=o,o=o.getParent();null!=n?(!!(null===(e=n.getColGroupDef())||void 0===e?void 0:e.marryChildren)?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns()).forEach((function(t){u.includes(t)||u.push(t)})):u.includes(t)||u.push(t)})),l=u}var c=l.slice();this.columnModel.sortColumnsLikeGridColumns(c);var p=this.calculateValidMoves(c,a,o),h=this.calculateOldIndex(c);if(0!==p.length){var d=p[0],f=null!==h&&!r;if(e==Hi.HeaderCell&&(f=null!==h),f&&!i){if(s&&d>=h)return;if(a&&d<=h)return}for(var g=this.columnModel.getAllDisplayedColumns(),m=[],y=null,v=0;v<p.length;v++){var _=p[v],C=this.columnModel.getProposedColumnOrder(c,_);if(this.columnModel.doesOrderPassRules(C)){var w=C.filter((function(t){return g.includes(t)}));if(null===y)y=w;else if(!hr.areEqual(w,y))break;var b=this.groupFragCount(C);m.push({move:_,fragCount:b})}}0!==m.length&&(m.sort((function(t,e){return t.fragCount-e.fragCount})),this.moveColumns(l,m[0].move,"uiColumnMoved",!1))}},t.prototype.calculateOldIndex=function(t){var e=this.columnModel.getAllGridColumns(),n=_t(t.map((function(t){return e.indexOf(t)}))),o=n[0];return yt(n)-o!==n.length-1?null:o},t.prototype.moveColumns=function(t,e,n,o){this.columnModel.moveColumns(t,e,n,o),this.lastMovedInfo=o?null:{columns:t,toIndex:e}},t.prototype.groupFragCount=function(t){function e(t){for(var e=[],n=t.getOriginalParent();null!=n;)e.push(n),n=n.getOriginalParent();return e}for(var n=0,o=function(o){var r,i=e(t[o]),s=e(t[o+1]);i=(r=Tc(i.length>s.length?[i,s]:[s,i],2))[0],s=r[1],i.forEach((function(t){-1===s.indexOf(t)&&n++}))},r=0;r<t.length-1;r++)o(r);return n},t.prototype.calculateValidMoves=function(t,e,n){var o=this.gridOptionsService.is("suppressMovableColumns")||t.some((function(t){return t.getColDef().suppressMovable}));if(o)return[];var r,i=this.columnModel.getDisplayedColumns(this.pinned),s=this.columnModel.getAllGridColumns(),a=i.filter((function(e){return Tt(t,e)})),l=i.filter((function(e){return!Tt(t,e)})),u=s.filter((function(e){return!Tt(t,e)})),c=0,p=n;if(e){var h=0;a.forEach((function(t){return h+=t.getActualWidth()})),p-=h}if(p>0){for(var d=0;d<l.length;d++){if((p-=l[d].getActualWidth())<0)break;c++}e&&c++}if(c>0){var f=l[c-1];r=u.indexOf(f)+1}else-1===(r=u.indexOf(l[0]))&&(r=0);var g=[r],m=function(t,e){return t-e};if(e){for(var y=r+1,v=s.length-1;y<=v;)g.push(y),y++;g.sort(m)}else{y=r,v=s.length-1;for(var _=s[y];y<=v&&this.isColumnHidden(i,_);)y++,g.push(y),_=s[y];y=r-1;for(;y>=0;)g.push(y),y--;g.sort(m).reverse()}return g},t.prototype.isColumnHidden=function(t,e){return t.indexOf(e)<0},t.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(qs.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(qs.ICON_RIGHT,!0))},t.prototype.ensureIntervalCleared=function(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(qs.ICON_MOVE))},t.prototype.moveInterval=function(){var t;this.intervalCount++,(t=10+5*this.intervalCount)>100&&(t=100);var e=null,n=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?e=n.scrollHorizontally(-t):this.needToMoveRight&&(e=n.scrollHorizontally(t)),0!==e)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var o=this.lastDraggingEvent.dragItem.columns.filter((function(t){return!t.getColDef().lockPinned}));if(o.length>0&&(this.dragAndDropService.setGhostIcon(qs.ICON_PINNED),this.failedMoveAttempts>7)){var r=this.needToMoveLeft?"left":"right";this.setColumnsPinned(o,r,"uiColumnDragged"),this.dragAndDropService.nudge()}}},Sc([$("columnModel")],t.prototype,"columnModel",void 0),Sc([$("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Sc([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),Sc([$("ctrlsService")],t.prototype,"ctrlsService",void 0),Sc([Z],t.prototype,"init",null),t}(),Oc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ic=function(t){function e(e,n){var o=t.call(this)||this;return o.pinned=e,o.eContainer=n,o}return Oc(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){switch(t.pinned){case"left":t.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.leftRowContainerCtrl.getContainerElement()],[e.bottomLeftRowContainerCtrl.getContainerElement()],[e.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":t.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.rightRowContainerCtrl.getContainerElement()],[e.bottomRightRowContainerCtrl.getContainerElement()],[e.topRightRowContainerCtrl.getContainerElement()]];break;default:t.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.centerRowContainerCtrl.getViewportElement()],[e.bottomCenterRowContainerCtrl.getViewportElement()],[e.topCenterRowContainerCtrl.getViewportElement()]]}}))},e.prototype.isInterestedIn=function(t){return t===Hi.HeaderCell||t===Hi.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")},e.prototype.getSecondaryContainers=function(){return this.eSecondaryContainers},e.prototype.getContainer=function(){return this.eContainer},e.prototype.init=function(){this.moveColumnFeature=this.createManagedBean(new Rc(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new Ec(this.pinned)),this.dragAndDropService.addDropTarget(this)},e.prototype.getIconName=function(){return this.currentDropListener.getIconName()},e.prototype.isDropColumnInPivotMode=function(t){return this.columnModel.isPivotMode()&&t.dragSource.type===Hi.ToolPanel},e.prototype.onDragEnter=function(t){this.currentDropListener=this.isDropColumnInPivotMode(t)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(t)},e.prototype.onDragLeave=function(t){this.currentDropListener.onDragLeave(t)},e.prototype.onDragging=function(t){this.currentDropListener.onDragging(t)},e.prototype.onDragStop=function(t){this.currentDropListener.onDragStop(t)},Pc([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Pc([$("columnModel")],e.prototype,"columnModel",void 0),Pc([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Pc([Z],e.prototype,"postConstruct",null),Pc([Z],e.prototype,"init",null),e}(Ht),Ac=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Dc=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Mc=function(){function t(){}return t.getHeaderClassesFromColDef=function(t,e,n,o){return i(t)?[]:this.getColumnClassesFromCollDef(t.headerClass,t,e,n,o)},t.getToolPanelClassesFromColDef=function(t,e,n,o){return i(t)?[]:this.getColumnClassesFromCollDef(t.toolPanelClass,t,e,n,o)},t.getClassParams=function(t,e,n,o){return{colDef:t,column:n,columnGroup:o,api:e.api,columnApi:e.columnApi,context:e.context}},t.getColumnClassesFromCollDef=function(t,e,n,o,r){if(i(t))return[];var s;"function"===typeof t?s=t(this.getClassParams(e,n,o,r)):s=t;return"string"===typeof s?[s]:Array.isArray(s)?Dc([],Ac(s)):[]},t}(),Lc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Nc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Fc=function(t){function e(n){var o=t.call(this,e.TEMPLATE,n)||this;return o.headerCompVersion=0,o.column=n.getColumnGroupChild(),o.pinned=n.getPinned(),o}return Lc(e,t),e.prototype.postConstruct=function(){var t,e,n=this,o=this.getGui();t="col-id",null!=(e=this.column.getColId())&&""!=e?o.setAttribute(t,e):o.removeAttribute(t);var r={setWidth:function(t){return o.style.width=t},addOrRemoveCssClass:function(t,e){return n.addOrRemoveCssClass(t,e)},setAriaDescription:function(t){return nn(o,t)},setAriaSort:function(t){return t?_n(o,t):Cn(o)},setUserCompDetails:function(t){return n.setUserCompDetails(t)},getUserCompInstance:function(){return n.headerComp}};this.ctrl.setComp(r,this.getGui(),this.eResize,this.eHeaderCompWrapper);var i=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",i)},e.prototype.destroyHeaderComp=function(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)},e.prototype.setUserCompDetails=function(t){var e=this;this.headerCompVersion++;var n=this.headerCompVersion;t.newAgStackInstance().then((function(t){return e.afterCompCreated(n,t)}))},e.prototype.afterCompCreated=function(t,e){t==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=e,this.headerCompGui=e.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(e)},e.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',Nc([Or("eResize")],e.prototype,"eResize",void 0),Nc([Or("eHeaderCompWrapper")],e.prototype,"eHeaderCompWrapper",void 0),Nc([Z],e.prototype,"postConstruct",null),Nc([J],e.prototype,"destroyHeaderComp",null),e}(yl),kc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Gc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Bc=function(t){function e(n){return t.call(this,e.TEMPLATE,n)||this}return kc(e,t),e.prototype.postConstruct=function(){var t=this,e=this.getGui();e.setAttribute("col-id",this.ctrl.getColId());var n={addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},setResizableDisplayed:function(e){return po(t.eResize,e)},setWidth:function(t){return e.style.width=t},setAriaExpanded:function(t){return n="aria-expanded",void 0!=(o=t)?e.setAttribute(n,o):e.removeAttribute(n);var n,o},setUserCompDetails:function(e){return t.setUserCompDetails(e)}};this.ctrl.setComp(n,e,this.eResize)},e.prototype.setUserCompDetails=function(t){var e=this;t.newAgStackInstance().then((function(t){return e.afterHeaderCompCreated(t)}))},e.prototype.afterHeaderCompCreated=function(t){var e=this,n=function(){return e.destroyBean(t)};if(this.isAlive()){var o=this.getGui(),r=t.getGui();o.appendChild(r),this.addDestroyFunc(n),this.ctrl.setDragSource(o)}else n()},e.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',Gc([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Gc([Or("eResize")],e.prototype,"eResize",void 0),Gc([Z],e.prototype,"postConstruct",null),e}(yl),Vc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.COLUMN_GROUP="group",t.COLUMN="column",t.FLOATING_FILTER="filter"}(wc||(wc={}));var jc,Hc=function(t){function e(e){var n=t.call(this)||this;return n.headerComps={},n.ctrl=e,n.setTemplate('<div class="'+n.ctrl.getHeaderRowClass()+'" role="row"></div>'),n}return Vc(e,t),e.prototype.init=function(){var t=this;this.getGui().style.transform=this.ctrl.getTransform(),gn(this.getGui(),this.ctrl.getAriaRowIndex());var e={setHeight:function(e){return t.getGui().style.height=e},setTop:function(e){return t.getGui().style.top=e},setHeaderCtrls:function(e,n){return t.setHeaderCtrls(e,n)},setWidth:function(e){return t.getGui().style.width=e}};this.ctrl.setComp(e)},e.prototype.destroyHeaderCtrls=function(){this.setHeaderCtrls([],!1)},e.prototype.setHeaderCtrls=function(t,e){var n=this;if(this.isAlive()){var o=this.headerComps;if(this.headerComps={},t.forEach((function(t){var e=t.getInstanceId(),r=o[e];delete o[e],null==r&&(r=n.createHeaderComp(t),n.getGui().appendChild(r.getGui())),n.headerComps[e]=r})),g(o,(function(t,e){n.getGui().removeChild(e.getGui()),n.destroyBean(e)})),e){var r=b(this.headerComps);r.sort((function(t,e){return t.getCtrl().getColumnGroupChild().getLeft()-e.getCtrl().getColumnGroupChild().getLeft()}));var i=r.map((function(t){return t.getGui()}));Do(this.getGui(),i)}}},e.prototype.createHeaderComp=function(t){var e;switch(this.ctrl.getType()){case wc.COLUMN_GROUP:e=new Bc(t);break;case wc.FLOATING_FILTER:e=new Cl(t);break;default:e=new Fc(t)}return this.createBean(e),e.setParentComponent(this),e},zc([Z],e.prototype,"init",null),zc([J],e.prototype,"destroyHeaderCtrls",null),e}(Tr),Uc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Wc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qc=0,Xc=function(t){function e(e,n){var o=t.call(this)||this;return o.lastFocusEvent=null,o.columnGroupChild=e,o.parentRowCtrl=n,o.instanceId=e.getUniqueId()+"-"+qc++,o}return Uc(e,t),e.prototype.shouldStopEventPropagation=function(t){var e=this.focusService.getFocusedHeader(),n=e.headerRowIndex,o=e.column;return er(this.gridOptionsService,t,n,o)},e.prototype.getWrapperHasFocus=function(){return this.gridOptionsService.getDocument().activeElement===this.eGui},e.prototype.setGui=function(t){this.eGui=t,this.addDomData()},e.prototype.handleKeyDown=function(t){var e=this.getWrapperHasFocus();switch(t.key){case Qo.PAGE_DOWN:case Qo.PAGE_UP:case Qo.PAGE_HOME:case Qo.PAGE_END:e&&t.preventDefault()}},e.prototype.addDomData=function(){var t=this,n=e.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,n,this),this.addDestroyFunc((function(){return t.gridOptionsService.setDomData(t.eGui,n,null)}))},e.prototype.getGui=function(){return this.eGui},e.prototype.focus=function(t){return!!this.eGui&&(this.lastFocusEvent=t||null,this.eGui.focus(),!0)},e.prototype.getRowIndex=function(){return this.parentRowCtrl.getRowIndex()},e.prototype.getParentRowCtrl=function(){return this.parentRowCtrl},e.prototype.getPinned=function(){return this.parentRowCtrl.getPinned()},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.getColumnGroupChild=function(){return this.columnGroupChild},e.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",Wc([$("focusService")],e.prototype,"focusService",void 0),Wc([$("beans")],e.prototype,"beans",void 0),Wc([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),e}(Ht),Yc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zc=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.columnOrGroup=e,i.eCell=n,i.ariaEl=i.eCell.querySelector("[role=columnheader]")||i.eCell,i.colsSpanning=r,i.beans=o,i}return Yc(e,t),e.prototype.setColsSpanning=function(t){this.colsSpanning=t,this.onLeftChanged()},e.prototype.getColumnOrGroup=function(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?yt(this.colsSpanning):this.columnOrGroup},e.prototype.postConstruct=function(){this.addManagedListener(this.columnOrGroup,ht.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))},e.prototype.setLeftFirstTime=function(){var t=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),e=r(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&e&&!t?this.animateInLeft():this.onLeftChanged()},e.prototype.animateInLeft=function(){var t=this,e=this.getColumnOrGroup(),n=e.getLeft(),o=e.getOldLeft(),r=this.modifyLeftForPrintLayout(e,o),i=this.modifyLeftForPrintLayout(e,n);this.setLeft(r),this.actualLeft=i,this.beans.columnAnimationService.executeNextVMTurn((function(){t.actualLeft===i&&t.setLeft(i)}))},e.prototype.onLeftChanged=function(){var t=this.getColumnOrGroup(),e=t.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(t,e),this.setLeft(this.actualLeft)},e.prototype.modifyLeftForPrintLayout=function(t,e){if(!this.beans.gridOptionsService.isDomLayout("print"))return e;if("left"===t.getPinned())return e;var n=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===t.getPinned()?n+this.beans.columnModel.getBodyContainerWidth()+e:n+e},e.prototype.setLeft=function(t){var e;if(r(t)&&(this.eCell.style.left=t+"px"),this.columnOrGroup instanceof ht)e=this.columnOrGroup;else{var n=this.columnOrGroup.getLeafColumns();if(!n.length)return;n.length>1&&vn(this.ariaEl,n.length),e=n[0]}var o=this.beans.columnModel.getAriaColumnIndex(e);yn(this.ariaEl,o)},Kc([Z],e.prototype,"postConstruct",null),e}(Ht),Jc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qc=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$c=function(t){function e(e,n){var o=t.call(this)||this;return o.columns=e,o.element=n,o}return Jc(e,t),e.prototype.postConstruct=function(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()},e.prototype.addMouseHoverListeners=function(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))},e.prototype.onMouseOut=function(){this.columnHoverService.clearMouseOver()},e.prototype.onMouseOver=function(){this.columnHoverService.setMouseOver(this.columns)},Qc([$("columnHoverService")],e.prototype,"columnHoverService",void 0),Qc([Z],e.prototype,"postConstruct",null),e}(Ht),tp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ep=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},np=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.iconCreated=!1,o.column=e,o}return tp(e,t),e.prototype.setComp=function(e,n,o,r){t.prototype.setGui.call(this,n),this.comp=e,this.eButtonShowMainFilter=o,this.eFloatingFilterBody=r,this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,ht.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))},e.prototype.setupActive=function(){var t=this.column.getColDef(),e=!!t.filter,n=!!t.floatingFilter;this.active=e&&n},e.prototype.setupUi=function(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),this.active&&!this.iconCreated){var t=Zo("filter",this.gridOptionsService,this.column);t&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(t))}},e.prototype.setupFocus=function(){this.createManagedBean(new Br(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},e.prototype.setupAria=function(){var t=this.localeService.getLocaleTextFunc();tn(this.eButtonShowMainFilter,t("ariaFilterMenuOpen","Open Filter Menu"))},e.prototype.onTabKeyDown=function(t){if(!(this.gridOptionsService.getDocument().activeElement===this.eGui)){var e=this.focusService.findNextFocusableElement(this.eGui,null,t.shiftKey);if(e)return this.beans.headerNavigationService.scrollToColumn(this.column),t.preventDefault(),void e.focus();var n=this.findNextColumnWithFloatingFilter(t.shiftKey);n&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:n},event:t})&&t.preventDefault()}},e.prototype.findNextColumnWithFloatingFilter=function(t){var e=this.beans.columnModel,n=this.column;do{if(!(n=t?e.getDisplayedColBefore(n):e.getDisplayedColAfter(n)))break}while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n},e.prototype.handleKeyDown=function(e){t.prototype.handleKeyDown.call(this,e);var n=this.getWrapperHasFocus();switch(e.key){case Qo.UP:case Qo.DOWN:n||e.preventDefault();case Qo.LEFT:case Qo.RIGHT:if(n)return;e.stopPropagation();case Qo.ENTER:n&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case Qo.ESCAPE:n||this.eGui.focus()}},e.prototype.onFocusIn=function(t){if(!this.eGui.contains(t.relatedTarget)){var e=!!t.relatedTarget&&!t.relatedTarget.classList.contains("ag-floating-filter"),n=!!t.relatedTarget&&go(t.relatedTarget,"ag-floating-filter");if(e&&n&&t.target===this.eGui){var o=this.lastFocusEvent,r=!(!o||o.key!==Qo.TAB);if(o&&r){var i=o.shiftKey;this.focusService.focusInto(this.eGui,i)}}var s=this.getRowIndex();this.beans.focusService.setFocusedHeader(s,this.column)}},e.prototype.setupHover=function(){var t=this;this.createManagedBean(new $c([this.column],this.eGui));var e=function(){if(t.gridOptionsService.is("columnHoverHighlight")){var e=t.columnHoverService.isHovered(t.column);t.comp.addOrRemoveCssClass("ag-column-hover",e)}};this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_HOVER_CHANGED,e),e()},e.prototype.setupLeft=function(){var t=new Zc(this.column,this.eGui,this.beans);this.createManagedBean(t)},e.prototype.setupFilterButton=function(){var t=this.column.getColDef();this.suppressFilterButton=!!t.floatingFilterComponentParams&&!!t.floatingFilterComponentParams.suppressFilterButton},e.prototype.setupUserComp=function(){var t=this;if(this.active){var e=this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return t.showParentFilter()}));e&&this.setCompDetails(e)}},e.prototype.setCompDetails=function(t){this.userCompDetails=t,this.comp.setCompDetails(t)},e.prototype.showParentFilter=function(){var t=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,t,"floatingFilter","filterMenuTab",["filterMenuTab"])},e.prototype.setupSyncWithFilter=function(){var t=this;if(this.active){var e=function(e){var n=t.comp.getFloatingFilterComp();n&&n.then((function(n){if(n){var o=t.filterManager.getCurrentFloatingFilterParentModel(t.column);n.onParentModelChanged(o,e)}}))};this.destroySyncListener=this.addManagedListener(this.column,ht.EVENT_FILTER_CHANGED,e),this.filterManager.isFilterActive(this.column)&&e(null)}},e.prototype.setupWidth=function(){var t=this,e=function(){var e=t.column.getActualWidth()+"px";t.comp.setWidth(e)};this.addManagedListener(this.column,ht.EVENT_WIDTH_CHANGED,e),e()},e.prototype.setupFilterChangedListener=function(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,ht.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)))},e.prototype.updateFilterButton=function(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))},e.prototype.onColDefChanged=function(){var t,e,n=this,o=this.active;this.setupActive();var r=!o&&this.active;o&&!this.active&&(null===(t=this.destroySyncListener)||void 0===t||t.call(this),null===(e=this.destroyFilterChangedListener)||void 0===e||e.call(this));var i=this.active?this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return n.showParentFilter()})):null,s=this.comp.getFloatingFilterComp();s&&i?s.then((function(t){var e;!t||n.filterManager.areFilterCompsDifferent(null!==(e=n.userCompDetails)&&void 0!==e?e:null,i)?n.updateCompDetails(i,r):n.updateFloatingFilterParams(i)})):this.updateCompDetails(i,r)},e.prototype.updateCompDetails=function(t,e){this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),e&&(this.setupSyncWithFilter(),this.setupFilterChangedListener())},e.prototype.updateFloatingFilterParams=function(t){var e;if(t){var n=t.params;null===(e=this.comp.getFloatingFilterComp())||void 0===e||e.then((function(t){(null===t||void 0===t?void 0:t.onParamsUpdated)&&"function"===typeof t.onParamsUpdated&&t.onParamsUpdated(n)}))}},ep([$("filterManager")],e.prototype,"filterManager",void 0),ep([$("columnHoverService")],e.prototype,"columnHoverService",void 0),ep([$("menuFactory")],e.prototype,"menuFactory",void 0),e}(Xc),op=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ip=function(t){function e(e,n,o,r,i){var s=t.call(this)||this;return s.pinned=e,s.column=n,s.eResize=o,s.comp=r,s.ctrl=i,s}return op(e,t),e.prototype.postConstruct=function(){var t,e,n=this,o=this.column.getColDef(),r=[],i=function(){r.forEach((function(t){return t()})),r.length=0},s=function(){var s=n.column.isResizable(),a=!n.gridOptionsService.is("suppressAutoSize")&&!o.suppressAutoSize;(s!==t||a!==e)&&(t=s,e=a,i(),function(){if(po(n.eResize,t),t){var o=n.horizontalResizeService.addResizeBar({eResizeBar:n.eResize,onResizeStart:n.onResizeStart.bind(n),onResizing:n.onResizing.bind(n,!1),onResizeEnd:n.onResizing.bind(n,!0)});if(r.push(o),e){var i=n.gridOptionsService.is("skipHeaderOnAutoSize"),s=function(){n.columnModel.autoSizeColumn(n.column,i,"uiColumnResized")};n.eResize.addEventListener("dblclick",s);var a=new ss(n.eResize);a.addEventListener(ss.EVENT_DOUBLE_TAP,s),n.addDestroyFunc((function(){n.eResize.removeEventListener("dblclick",s),a.removeEventListener(ss.EVENT_DOUBLE_TAP,s),a.destroy()}))}}}())};s(),this.addDestroyFunc(i),this.ctrl.addRefreshFunction(s)},e.prototype.onResizing=function(t,e){var n=this.normaliseResizeAmount(e),o=[{key:this.column,newWidth:this.resizeStartWidth+n}];this.columnModel.setColumnWidths(o,this.resizeWithShiftKey,t,"uiColumnResized"),t&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},e.prototype.onResizeStart=function(t){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=t,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},e.prototype.normaliseResizeAmount=function(t){var e=t,n="left"!==this.pinned,o="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?n&&(e*=-1):o&&(e*=-1),e},rp([$("horizontalResizeService")],e.prototype,"horizontalResizeService",void 0),rp([$("columnModel")],e.prototype,"columnModel",void 0),rp([Z],e.prototype,"postConstruct",null),e}(Ht),sp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ap=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},lp=function(t){function e(e){var n=t.call(this)||this;n.cbSelectAllVisible=!1,n.processingEventFromCheckbox=!1,n.column=e;var o=e.getColDef();return n.filteredOnly=!!(null===o||void 0===o?void 0:o.headerCheckboxSelectionFilteredOnly),n.currentPageOnly=!!(null===o||void 0===o?void 0:o.headerCheckboxSelectionCurrentPageOnly),n}return sp(e,t),e.prototype.onSpaceKeyDown=function(t){var e=this.cbSelectAll,n=this.gridOptionsService.getDocument();e.isDisplayed()&&!e.getGui().contains(n.activeElement)&&(t.preventDefault(),e.setValue(!e.getValue()))},e.prototype.getCheckboxGui=function(){return this.cbSelectAll.getGui()},e.prototype.setComp=function(t){this.headerCellCtrl=t,this.cbSelectAll=this.createManagedBean(new hi),this.cbSelectAll.addCssClass("ag-header-select-all"),Ze(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,Zt.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),ln(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()},e.prototype.showOrHideSelectAll=function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()},e.prototype.onModelChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},e.prototype.onSelectionChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},e.prototype.updateStateOfCheckbox=function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var t=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}},e.prototype.refreshSelectAllLabel=function(){var t=this.localeService.getLocaleTextFunc(),e=this.cbSelectAll.getValue()?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),n=t("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",n+" ("+e+")"):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(n+" ("+e+")"),this.headerCellCtrl.refreshAriaDescription()},e.prototype.checkRightRowModelType=function(t){var e=this.rowModel.getType();return!("clientSide"!==e&&"serverSide"!==e)||(console.warn("AG Grid: "+t+" is only available if using 'clientSide' or 'serverSide' rowModelType, you are using "+e+"."),!1)},e.prototype.onCbSelectAll=function(){if(!this.processingEventFromCheckbox&&this.cbSelectAllVisible){var t=this.cbSelectAll.getValue(),e="uiSelectAll";this.currentPageOnly?e="uiSelectAllCurrentPage":this.filteredOnly&&(e="uiSelectAllFiltered");var n={source:e,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};t?this.selectionService.selectAllRowNodes(n):this.selectionService.deselectAllRowNodes(n)}},e.prototype.isCheckboxSelection=function(){var t=this.column.getColDef().headerCheckboxSelection;"function"===typeof t&&(t=t({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context}));return!!t&&this.checkRightRowModelType("headerCheckboxSelection")},ap([$("gridApi")],e.prototype,"gridApi",void 0),ap([$("columnApi")],e.prototype,"columnApi",void 0),ap([$("rowModel")],e.prototype,"rowModel",void 0),ap([$("selectionService")],e.prototype,"selectionService",void 0),e}(Ht),up=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),cp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.TAB_GUARD="ag-tab-guard",t.TAB_GUARD_TOP="ag-tab-guard-top",t.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(jc||(jc={}));var pp,hp=function(t){function e(e){var n=t.call(this)||this;n.skipTabGuardFocus=!1;var o=e.comp,r=e.eTopGuard,i=e.eBottomGuard,s=e.focusInnerElement,a=e.onFocusIn,l=e.onFocusOut,u=e.shouldStopEventPropagation,c=e.onTabKeyDown,p=e.handleKeyDown,h=e.eFocusableElement;return n.comp=o,n.eTopGuard=r,n.eBottomGuard=i,n.providedFocusInnerElement=s,n.eFocusableElement=h,n.providedFocusIn=a,n.providedFocusOut=l,n.providedShouldStopEventPropagation=u,n.providedOnTabKeyDown=c,n.providedHandleKeyDown=p,n}return up(e,t),e.prototype.postConstruct=function(){var t=this;this.createManagedBean(new Br(this.eFocusableElement,{shouldStopEventPropagation:function(){return t.shouldStopEventPropagation()},onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)},onFocusIn:function(e){return t.onFocusIn(e)},onFocusOut:function(e){return t.onFocusOut(e)}})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((function(e){return t.addManagedListener(e,"focus",t.onFocus.bind(t))}))},e.prototype.handleKeyDown=function(t){this.providedHandleKeyDown&&this.providedHandleKeyDown(t)},e.prototype.tabGuardsAreActive=function(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")},e.prototype.shouldStopEventPropagation=function(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()},e.prototype.activateTabGuards=function(){var t=this.gridOptionsService.getNum("tabIndex")||0;this.comp.setTabIndex(t.toString())},e.prototype.deactivateTabGuards=function(){this.comp.setTabIndex()},e.prototype.onFocus=function(t){if(this.skipTabGuardFocus)this.skipTabGuardFocus=!1;else{var e=t.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(e):this.focusInnerElement(e)}},e.prototype.onFocusIn=function(t){this.providedFocusIn&&this.providedFocusIn(t)||this.deactivateTabGuards()},e.prototype.onFocusOut=function(t){this.providedFocusOut&&this.providedFocusOut(t)||this.eFocusableElement.contains(t.relatedTarget)||this.activateTabGuards()},e.prototype.onTabKeyDown=function(t){var e=this;if(this.providedOnTabKeyDown)this.providedOnTabKeyDown(t);else if(!t.defaultPrevented){var n=this.tabGuardsAreActive();n&&this.deactivateTabGuards();var o=this.getNextFocusableElement(t.shiftKey);n&&setTimeout((function(){return e.activateTabGuards()}),0),o&&(o.focus(),t.preventDefault())}},e.prototype.focusInnerElement=function(t){void 0===t&&(t=!1);var e=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(e.splice(0,1),e.splice(e.length-1,1)),e.length&&e[t?e.length-1:0].focus({preventScroll:!0})},e.prototype.getNextFocusableElement=function(t){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,t)},e.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1);var e=t?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,e.focus()},cp([$("focusService")],e.prototype,"focusService",void 0),cp([Z],e.prototype,"postConstruct",null),e}(Ht),dp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fp=function(){return fp=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},fp.apply(this,arguments)},gp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},mp=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},yp=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return dp(e,t),n=e,e.addKeyboardModeEvents=function(t,e){var o=n.instancesMonitored.get(t);o&&o.length>0?-1===o.indexOf(e)&&o.push(e):(n.instancesMonitored.set(t,[e]),t.addEventListener("keydown",n.toggleKeyboardMode),t.addEventListener("mousedown",n.toggleKeyboardMode))},e.removeKeyboardModeEvents=function(t,e){var o=n.instancesMonitored.get(t),r=[];o&&o.length&&(r=yp([],mp(o)).filter((function(t){return t!==e})),n.instancesMonitored.set(t,r)),0===r.length&&(t.removeEventListener("keydown",n.toggleKeyboardMode),t.removeEventListener("mousedown",n.toggleKeyboardMode))},e.toggleKeyboardMode=function(t){var e=n.keyboardModeActive,o="keydown"===t.type;if((!o||!(t.ctrlKey||t.metaKey||t.altKey))&&!(e&&o||!e&&!o)){n.keyboardModeActive=o;var r=t.target.ownerDocument;if(r){var i=n.instancesMonitored.get(r);i&&i.forEach((function(t){t.dispatchEvent({type:o?Zt.EVENT_KEYBOARD_FOCUS:Zt.EVENT_MOUSE_FOCUS})}))}}},e.prototype.init=function(){var t=this,e=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_GROUP_OPENED,e),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.ctrlsService.whenReady((function(e){t.gridCtrl=e.gridCtrl;var o=t.gridOptionsService.getDocument();n.addKeyboardModeEvents(o,t.gridCtrl),t.addDestroyFunc((function(){return t.unregisterGridCompController(t.gridCtrl)}))}))},e.prototype.unregisterGridCompController=function(t){var e=this.gridOptionsService.getDocument();n.removeKeyboardModeEvents(e,t)},e.prototype.onColumnEverythingChanged=function(){if(this.focusedCellPosition){var t=this.focusedCellPosition.column,e=this.columnModel.getGridColumn(t.getId());t!==e&&this.clearFocusedCell()}},e.prototype.isKeyboardMode=function(){return n.keyboardModeActive},e.prototype.getFocusCellToUseAfterRefresh=function(){var t=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(t.activeElement,_u.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition},e.prototype.getFocusHeaderToUseAfterRefresh=function(){var t=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(t.activeElement,Xc.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition},e.prototype.isDomDataMissingInHierarchy=function(t,e){for(var n=t;n;){if(this.gridOptionsService.getDomData(n,e))return!1;n=n.parentNode}return!0},e.prototype.getFocusedCell=function(){return this.focusedCellPosition},e.prototype.shouldRestoreFocus=function(t){var e=this;return!!this.isCellRestoreFocused(t)&&(setTimeout((function(){e.restoredFocusedCellPosition=null}),0),!0)},e.prototype.isCellRestoreFocused=function(t){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(t,this.restoredFocusedCellPosition)},e.prototype.setRestoreFocusedCell=function(t){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=t)},e.prototype.getFocusEventParams=function(){var t=this.focusedCellPosition,e=t.rowIndex,n=t.rowPinned,o={rowIndex:e,rowPinned:n,column:t.column,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:n});return r&&(o.isFullWidthCell=r.isFullWidth()),o},e.prototype.clearFocusedCell=function(){if(this.restoredFocusedCellPosition=null,null!=this.focusedCellPosition){var t=fp({type:Zt.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(t)}},e.prototype.setFocusedCell=function(t){var e=t.column,n=t.rowIndex,r=t.rowPinned,i=t.forceBrowserFocus,s=void 0!==i&&i,a=t.preventScrollOnBrowserFocus,l=void 0!==a&&a,u=this.columnModel.getGridColumn(e);if(u){this.focusedCellPosition=u?{rowIndex:n,rowPinned:o(r),column:u}:null;var c=fp(fp({type:Zt.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:s,preventScrollOnBrowserFocus:l,floating:null});this.eventService.dispatchEvent(c)}else this.focusedCellPosition=null},e.prototype.isCellFocused=function(t){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(t,this.focusedCellPosition)},e.prototype.isRowNodeFocused=function(t){return this.isRowFocused(t.rowIndex,t.rowPinned)},e.prototype.isHeaderWrapperFocused=function(t){if(null==this.focusedHeaderPosition)return!1;var e=t.getColumnGroupChild(),n=t.getRowIndex(),o=t.getPinned(),r=this.focusedHeaderPosition,i=r.column,s=r.headerRowIndex;return e===i&&n===s&&o==i.getPinned()},e.prototype.clearFocusedHeader=function(){this.focusedHeaderPosition=null},e.prototype.getFocusedHeader=function(){return this.focusedHeaderPosition},e.prototype.setFocusedHeader=function(t,e){this.focusedHeaderPosition={headerRowIndex:t,column:e}},e.prototype.focusHeaderPosition=function(t){var e=t.direction,n=t.fromTab,o=t.allowUserOverride,r=t.event,i=t.fromCell,s=t.headerPosition;if(i&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(s);if(o){var a,l=this.getFocusedHeader(),u=this.headerNavigationService.getHeaderRowCount();if(n){if(a=this.gridOptionsService.getCallback("tabToNextHeader"))s=a({backwards:"Before"===e,previousHeaderPosition:l,nextHeaderPosition:s,headerRowCount:u})}else if((a=this.gridOptionsService.getCallback("navigateToNextHeader"))&&r)s=a({key:r.key,previousHeaderPosition:l,nextHeaderPosition:s,headerRowCount:u,event:r})}return!!s&&(-1===s.headerRowIndex?this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(s):this.focusGridView(s.column):(this.headerNavigationService.scrollToColumn(s.column,e),this.ctrlsService.getHeaderRowContainerCtrl(s.column.getPinned()).focusHeader(s.headerRowIndex,s.column,r)))},e.prototype.focusFirstHeader=function(){var t=this.columnModel.getAllDisplayedColumns()[0];return!!t&&(t.getParent()&&(t=this.columnModel.getColumnGroupAtLevel(t,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:t}}))},e.prototype.focusLastHeader=function(t){var e=this.headerNavigationService.getHeaderRowCount()-1,n=yt(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:e,column:n},event:t})},e.prototype.focusPreviousFromFirstCell=function(t){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(t)},e.prototype.isAnyCellFocused=function(){return!!this.focusedCellPosition},e.prototype.isRowFocused=function(t,e){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===t&&this.focusedCellPosition.rowPinned===o(e))},e.prototype.findFocusableElements=function(t,e,n){void 0===n&&(n=!1);var o=lo,r=uo;e&&(r+=", "+e),n&&(r+=', [tabindex="-1"]');var i=Array.prototype.slice.apply(t.querySelectorAll(o)),s=Array.prototype.slice.apply(t.querySelectorAll(r));if(!s.length)return i;var a;return a=s,i.filter((function(t){return-1===a.indexOf(t)}))},e.prototype.focusInto=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var o=this.findFocusableElements(t,null,n),r=e?yt(o):o[0];return!!r&&(r.focus({preventScroll:!0}),!0)},e.prototype.findFocusableElementBeforeTabGuard=function(t,e){if(!e)return null;var n=this.findFocusableElements(t),o=n.indexOf(e);if(-1===o)return null;for(var r=-1,i=o-1;i>=0;i--)if(n[i].classList.contains(jc.TAB_GUARD_TOP)){r=i;break}return r<=0?null:n[r-1]},e.prototype.findNextFocusableElement=function(t,e,n){void 0===t&&(t=this.eGridDiv);var o=this.findFocusableElements(t,e?':not([tabindex="-1"])':null),r=this.gridOptionsService.getDocument().activeElement,i=(e?o.findIndex((function(t){return t.contains(r)})):o.indexOf(r))+(n?-1:1);return i<0||i>=o.length?null:o[i]},e.prototype.isTargetUnderManagedComponent=function(t,e){if(!e)return!1;var n=t.querySelectorAll("."+Br.FOCUS_MANAGED_CLASS);if(!n.length)return!1;for(var o=0;o<n.length;o++)if(n[o].contains(e))return!0;return!1},e.prototype.findTabbableParent=function(t,e){void 0===e&&(e=5);for(var n=0;t&&null===zn(t)&&++n<=e;)t=t.parentElement;return null===zn(t)?null:t},e.prototype.focusGridView=function(t,e){if(this.gridOptionsService.is("suppressCellFocus"))return e?this.focusLastHeader():this.focusNextGridCoreContainer(!1);var n=e?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!n)return!1;var r=n.rowIndex,i=n.rowPinned,s=this.getFocusedHeader();if(!t&&s&&(t=s.column),null==r||!t)return!1;if(this.navigationService.ensureCellVisible({rowIndex:r,column:t,rowPinned:i}),this.setFocusedCell({rowIndex:r,column:t,rowPinned:o(i),forceBrowserFocus:!0}),this.rangeService){var a={rowIndex:r,rowPinned:i,column:t};this.rangeService.setRangeToCell(a)}return!0},e.prototype.focusNextGridCoreContainer=function(t,e){return void 0===e&&(e=!1),!(e||!this.gridCtrl.focusNextInnerContainer(t))||((e||!t&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(t),!1)},e.prototype.focusAdvancedFilter=function(t){return this.advancedFilterFocusColumn=null===t||void 0===t?void 0:t.column,this.advancedFilterService.getCtrl().focusHeaderComp()},e.prototype.focusNextFromAdvancedFilter=function(t,e){var n,o,r=null!==(n=e?void 0:this.advancedFilterFocusColumn)&&void 0!==n?n:null===(o=this.columnModel.getAllDisplayedColumns())||void 0===o?void 0:o[0];return t?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(r)},e.prototype.clearAdvancedFilterColumn=function(){this.advancedFilterFocusColumn=void 0},e.AG_KEYBOARD_FOCUS="ag-keyboard-focus",e.keyboardModeActive=!1,e.instancesMonitored=new Map,gp([$("eGridDiv")],e.prototype,"eGridDiv",void 0),gp([$("columnModel")],e.prototype,"columnModel",void 0),gp([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),gp([$("rowRenderer")],e.prototype,"rowRenderer",void 0),gp([$("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),gp([$("cellPositionUtils")],e.prototype,"cellPositionUtils",void 0),gp([tt("rangeService")],e.prototype,"rangeService",void 0),gp([$("navigationService")],e.prototype,"navigationService",void 0),gp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),gp([$("filterManager")],e.prototype,"filterManager",void 0),gp([tt("advancedFilterService")],e.prototype,"advancedFilterService",void 0),gp([Z],e.prototype,"init",null),e=n=gp([Q("focusService")],e)}(Ht),_p=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Cp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},wp=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.refreshFunctions=[],o.userHeaderClasses=new Set,o.ariaDescriptionProperties=new Map,o.column=e,o}return _p(e,t),e.prototype.setComp=function(e,n,o,r){var i=this;t.prototype.setGui.call(this,n),this.comp=e,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(r),this.addColumnHoverListener(),this.setupFilterCss(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new ip(this.getPinned(),this.column,o,e,this)),this.createManagedBean(new $c([this.column],n)),this.createManagedBean(new Zc(this.column,n,this.beans)),this.createManagedBean(new Br(n,{shouldStopEventPropagation:function(t){return i.shouldStopEventPropagation(t)},onTabKeyDown:function(){return null},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addMouseDownListenerIfNeeded(n),this.addManagedListener(this.column,ht.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onHeaderHeightChanged.bind(this))},e.prototype.addMouseDownListenerIfNeeded=function(t){var e=this;if(Ln()){var n=this.gridOptionsService.getDocument();["mousedown","touchstart"].forEach((function(o){e.addManagedListener(t,o,(function(e){var o=n.activeElement;o===t||t.contains(o)||(t.focus(),vp.toggleKeyboardMode(e))}))}))}},e.prototype.setupUserComp=function(){var t=this.lookupUserCompDetails();this.setCompDetails(t)},e.prototype.setCompDetails=function(t){this.userCompDetails=t,this.comp.setUserCompDetails(t)},e.prototype.lookupUserCompDetails=function(){var t=this.createParams(),e=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(e,t)},e.prototype.createParams=function(){var t=this,e=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:e.sortable,enableMenu:this.menuEnabled,showColumnMenu:function(e){t.gridApi.showColumnMenuAfterButtonClick(t.column,e)},progressSort:function(e){t.sortController.progressSort(t.column,!!e,"uiColumnSorted")},setSort:function(e,n){t.sortController.setSortForColumn(t.column,e,!!n,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()}},e.prototype.setupSelectAll=function(){this.selectAllFeature=this.createManagedBean(new lp(this.column)),this.selectAllFeature.setComp(this)},e.prototype.getSelectAllGui=function(){return this.selectAllFeature.getCheckboxGui()},e.prototype.handleKeyDown=function(e){t.prototype.handleKeyDown.call(this,e),e.key===Qo.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===Qo.ENTER&&this.onEnterKeyDown(e)},e.prototype.onEnterKeyDown=function(t){var e=this.comp.getUserCompInstance();if(e)if(t.ctrlKey||t.metaKey)this.menuEnabled&&e.showMenu&&(t.preventDefault(),e.showMenu());else if(this.sortable){var n=t.shiftKey;this.sortController.progressSort(this.column,n,"uiColumnSorted")}},e.prototype.isMenuEnabled=function(){return this.menuEnabled},e.prototype.onFocusIn=function(t){if(!this.getGui().contains(t.relatedTarget)){var e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column)}this.setActiveHeader(!0)},e.prototype.onFocusOut=function(t){this.getGui().contains(t.relatedTarget)||this.setActiveHeader(!1)},e.prototype.setupTooltip=function(){var t=this,e={getColumn:function(){return t.column},getColDef:function(){return t.column.getColDef()},getGui:function(){return t.eGui},getLocation:function(){return"header"},getTooltipValue:function(){return t.column.getColDef().headerTooltip}},n=this.createManagedBean(new Ql(e,this.beans));n.setComp(this.eGui),this.refreshFunctions.push((function(){return n.refreshToolTip()}))},e.prototype.setupClassesFromColDef=function(){var t=this,e=function(){var e=t.column.getColDef(),n=Mc.getHeaderClassesFromColDef(e,t.gridOptionsService,t.column,null),o=t.userHeaderClasses;t.userHeaderClasses=new Set(n),n.forEach((function(e){o.has(e)?o.delete(e):t.comp.addOrRemoveCssClass(e,!0)})),o.forEach((function(e){return t.comp.addOrRemoveCssClass(e,!1)}))};this.refreshFunctions.push(e),e()},e.prototype.setDragSource=function(t){var e=this;if(this.dragSourceElement=t,this.removeDragSource(),t&&this.draggable){var n=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:Hi.HeaderCell,eElement:t,defaultIconName:n?qs.ICON_HIDE:qs.ICON_NOT_ALLOWED,getDragItem:function(){return e.createDragItem()},dragItemName:this.displayName,onDragStarted:function(){return e.column.setMoving(!0,"uiColumnMoved")},onDragStopped:function(){return e.column.setMoving(!1,"uiColumnMoved")},onGridEnter:function(t){var o;if(n){var r=(null===(o=null===t||void 0===t?void 0:t.columns)||void 0===o?void 0:o.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(r,!0,"uiColumnMoved")}},onGridExit:function(t){var o;if(n){var r=(null===(o=null===t||void 0===t?void 0:t.columns)||void 0===o?void 0:o.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(r,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}},e.prototype.createDragItem=function(){var t={};return t[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:t}},e.prototype.removeDragSource=function(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)},e.prototype.onColDefChanged=function(){this.refresh()},e.prototype.updateState=function(){var t=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!t.suppressMenu,this.sortable=t.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()},e.prototype.addRefreshFunction=function(t){this.refreshFunctions.push(t)},e.prototype.refresh=function(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach((function(t){return t()}))},e.prototype.refreshHeaderComp=function(){var t=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass)&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)},e.prototype.attemptHeaderCompRefresh=function(t){var e=this.comp.getUserCompInstance();return!!e&&(!!e.refresh&&e.refresh(t))},e.prototype.calculateDisplayName=function(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)},e.prototype.checkDisplayName=function(){this.displayName!==this.calculateDisplayName()&&this.refresh()},e.prototype.workOutDraggable=function(){var t=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!t.suppressMovable&&!t.lockPosition)||!!t.enableRowGroup||!!t.enablePivot},e.prototype.onColumnRowGroupChanged=function(){this.checkDisplayName()},e.prototype.onColumnPivotChanged=function(){this.checkDisplayName()},e.prototype.onColumnValueChanged=function(){this.checkDisplayName()},e.prototype.setupWidth=function(){var t=this,e=function(){var e=t.column.getActualWidth();t.comp.setWidth(e+"px")};this.addManagedListener(this.column,ht.EVENT_WIDTH_CHANGED,e),e()},e.prototype.setupMovingCss=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-header-cell-moving",t.column.isMoving())};this.addManagedListener(this.column,ht.EVENT_MOVING_CHANGED,e),e()},e.prototype.setupMenuClass=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-column-menu-visible",t.column.isMenuVisible())};this.addManagedListener(this.column,ht.EVENT_MENU_VISIBLE_CHANGED,e),e()},e.prototype.setupSortableClass=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!t.sortable)};e(),this.addRefreshFunction(e),this.addManagedListener(this.eventService,ht.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))},e.prototype.setupWrapTextClass=function(){var t=this,e=function(){var e=!!t.column.getColDef().wrapHeaderText;t.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.addRefreshFunction(e)},e.prototype.onHeaderHeightChanged=function(){this.refreshSpanHeaderHeight()},e.prototype.refreshSpanHeaderHeight=function(){var t=this,e=t.eGui,n=t.column,o=t.comp,r=t.columnModel,i=t.gridOptionsService;if(n.isSpanHeaderHeight()){var s=this.getColumnGroupPaddingInfo(),a=s.numberOfParents,l=s.isSpanningTotal;o.addOrRemoveCssClass("ag-header-span-height",a>0);var u=r.getColumnHeaderRowHeight();if(0===a)return o.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height",u+"px");o.addOrRemoveCssClass("ag-header-span-total",l);var c=a*(i.is("pivotMode")?r.getPivotGroupHeaderHeight():r.getGroupHeaderHeight());e.style.setProperty("top",-c+"px"),e.style.setProperty("height",u+c+"px")}},e.prototype.getColumnGroupPaddingInfo=function(){var t=this.column.getParent();if(!t||!t.isPadding())return{numberOfParents:0,isSpanningTotal:!1};for(var e=t.getPaddingLevel()+1,n=!0;t;){if(!t.isPadding()){n=!1;break}t=t.getParent()}return{numberOfParents:e,isSpanningTotal:n}},e.prototype.setupAutoHeight=function(t){var e,n=this,o=function(e){if(n.isAlive()){var r=mo(n.getGui()),i=r.paddingTop+r.paddingBottom+r.borderBottomWidth+r.borderTopWidth,s=t.offsetHeight+i;if(e<5){var a=n.beans.gridOptionsService.getDocument();if(!a||!a.contains(t)||0==s)return void n.beans.frameworkOverrides.setTimeout((function(){return o(e+1)}),0)}n.columnModel.setColumnHeaderHeight(n.column,s)}},r=!1,i=function(){var t=n.column.isAutoHeaderHeight();t&&!r&&s(),!t&&r&&a()},s=function(){r=!0,o(0),n.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),e=n.resizeObserverService.observeResize(t,(function(){return o(0)}))},a=function(){r=!1,e&&e(),n.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),e=void 0};i(),this.addDestroyFunc((function(){return a()})),this.addManagedListener(this.column,ht.EVENT_WIDTH_CHANGED,(function(){return r&&o(0)})),this.addManagedListener(this.eventService,ht.EVENT_SORT_CHANGED,(function(){r&&n.beans.frameworkOverrides.setTimeout((function(){return o(0)}))})),this.addRefreshFunction(i)},e.prototype.refreshAriaSort=function(){if(this.sortable){var t=this.localeService.getLocaleTextFunc(),e=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(Je(e)),this.setAriaDescriptionProperty("sort",t("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)},e.prototype.refreshAriaMenu=function(){if(this.menuEnabled){var t=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",t("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)},e.prototype.setAriaDescriptionProperty=function(t,e){null!=e?this.ariaDescriptionProperties.set(t,e):this.ariaDescriptionProperties.delete(t)},e.prototype.refreshAriaDescription=function(){var t=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(t.length?t.join(" "):void 0)},e.prototype.refreshAria=function(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()},e.prototype.addColumnHoverListener=function(){var t=this,e=function(){if(t.gridOptionsService.is("columnHoverHighlight")){var e=t.columnHoverService.isHovered(t.column);t.comp.addOrRemoveCssClass("ag-column-hover",e)}};this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_HOVER_CHANGED,e),e()},e.prototype.setupFilterCss=function(){var t=this,e=function(){t.comp.addOrRemoveCssClass("ag-header-cell-filtered",t.column.isFilterActive())};this.addManagedListener(this.column,ht.EVENT_FILTER_ACTIVE_CHANGED,e),e()},e.prototype.getColId=function(){return this.column.getColId()},e.prototype.addActiveHeaderMouseListeners=function(){var t=this,e=function(e){return t.setActiveHeader("mouseenter"===e.type)};this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e)},e.prototype.setActiveHeader=function(t){this.comp.addOrRemoveCssClass("ag-header-active",t)},Cp([$("columnModel")],e.prototype,"columnModel",void 0),Cp([$("columnHoverService")],e.prototype,"columnHoverService",void 0),Cp([$("sortController")],e.prototype,"sortController",void 0),Cp([$("menuFactory")],e.prototype,"menuFactory",void 0),Cp([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Cp([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Cp([$("gridApi")],e.prototype,"gridApi",void 0),Cp([$("columnApi")],e.prototype,"columnApi",void 0),Cp([J],e.prototype,"removeDragSource",null),e}(Xc),bp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ep=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.eResize=n,i.comp=e,i.pinned=o,i.columnGroup=r,i}return bp(e,t),e.prototype.postConstruct=function(){var t=this;if(this.columnGroup.isResizable()){var e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gridOptionsService.is("suppressAutoSize")){var n=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",(function(){var e=[];t.columnGroup.getDisplayedLeafColumns().forEach((function(t){t.getColDef().suppressAutoSize||e.push(t.getColId())})),e.length>0&&t.columnModel.autoSizeColumns({columns:e,skipHeader:n,stopAtGroup:t.columnGroup,source:"uiColumnResized"}),t.resizeLeafColumnsToFit("uiColumnResized")}))}}else this.comp.setResizableDisplayed(!1)},e.prototype.onResizeStart=function(t){var e=this;this.calculateInitialValues();var n=null;if(t&&(n=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),n){var o=n.getDisplayedLeafColumns();this.resizeTakeFromCols=o.filter((function(t){return t.isResizable()})),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach((function(t){return e.resizeTakeFromStartWidth+=t.getActualWidth()})),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach((function(t){return e.resizeTakeFromRatios.push(t.getActualWidth()/e.resizeTakeFromStartWidth)}))}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},e.prototype.onResizing=function(t,e,n){void 0===n&&(n="uiColumnResized");var o=this.normaliseDragChange(e),r=this.resizeStartWidth+o;this.resizeColumns(r,n,t)},e.prototype.resizeLeafColumnsToFit=function(t){var e=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),e>this.resizeStartWidth&&this.resizeColumns(e,t,!0)},e.prototype.resizeColumns=function(t,e,n){void 0===n&&(n=!0);var o=[];if(o.push({columns:this.resizeCols,ratios:this.resizeRatios,width:t}),this.resizeTakeFromCols){var r=t-this.resizeStartWidth;o.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-r})}this.columnModel.resizeColumnSets({resizeSets:o,finished:n,source:e}),n&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},e.prototype.calculateInitialValues=function(){var t=this,e=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=e.filter((function(t){return t.isResizable()})),this.resizeStartWidth=0,this.resizeCols.forEach((function(e){return t.resizeStartWidth+=e.getActualWidth()})),this.resizeRatios=[],this.resizeCols.forEach((function(e){return t.resizeRatios.push(e.getActualWidth()/t.resizeStartWidth)}))},e.prototype.normaliseDragChange=function(t){var e=t;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(e*=-1):"right"===this.pinned&&(e*=-1),e},xp([$("horizontalResizeService")],e.prototype,"horizontalResizeService",void 0),xp([$("autoWidthCalculator")],e.prototype,"autoWidthCalculator",void 0),xp([$("columnModel")],e.prototype,"columnModel",void 0),xp([Z],e.prototype,"postConstruct",null),e}(Ht),Sp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Tp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Rp=function(t){function e(e,n){var o=t.call(this)||this;return o.removeChildListenersFuncs=[],o.columnGroup=n,o.comp=e,o}return Sp(e,t),e.prototype.postConstruct=function(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,Kt.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))},e.prototype.addListenersToChildrenColumns=function(){var t=this;this.removeListenersOnChildrenColumns();var e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((function(n){n.addEventListener("widthChanged",e),n.addEventListener("visibleChanged",e),t.removeChildListenersFuncs.push((function(){n.removeEventListener("widthChanged",e),n.removeEventListener("visibleChanged",e)}))}))},e.prototype.removeListenersOnChildrenColumns=function(){this.removeChildListenersFuncs.forEach((function(t){return t()})),this.removeChildListenersFuncs=[]},e.prototype.onDisplayedChildrenChanged=function(){this.addListenersToChildrenColumns(),this.onWidthChanged()},e.prototype.onWidthChanged=function(){var t=this.columnGroup.getActualWidth();this.comp.setWidth(t+"px"),this.comp.addOrRemoveCssClass("ag-hidden",0===t)},Tp([Z],e.prototype,"postConstruct",null),e}(Ht),Op=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ip=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.columnGroup=e,o}return Op(e,t),e.prototype.setComp=function(e,n,o){t.prototype.setGui.call(this,n),this.comp=e,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();var r=this.getParentRowCtrl().getPinned(),i=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new $c(i,n)),this.createManagedBean(new Zc(this.columnGroup,n,this.beans)),this.createManagedBean(new Rp(e,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new Ep(e,o,r,this.columnGroup)),this.createManagedBean(new Br(n,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:function(){},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},e.prototype.resizeLeafColumnsToFit=function(t){this.groupResizeFeature&&this.groupResizeFeature.resizeLeafColumnsToFit(t)},e.prototype.setupUserComp=function(){var t=this,e=this.displayName,n={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:function(e){t.columnModel.setColumnGroupOpened(t.columnGroup.getProvidedColumnGroup(),e,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!e){for(var o=this.columnGroup,r=o.getLeafColumns();o.getParent()&&o.getParent().getLeafColumns().length===r.length;)o=o.getParent();var i=o.getColGroupDef();i&&(e=i.headerName),e||(e=r?this.columnModel.getDisplayNameForColumn(r[0],"header",!0):"")}var s=this.userComponentFactory.getHeaderGroupCompDetails(n);this.comp.setUserCompDetails(s)},e.prototype.setupTooltip=function(){var t=this,e=this.columnGroup.getColGroupDef(),n={getColumn:function(){return t.columnGroup},getGui:function(){return t.eGui},getLocation:function(){return"headerGroup"},getTooltipValue:function(){return e&&e.headerTooltip}};e&&(n.getColDef=function(){return e}),this.createManagedBean(new Ql(n,this.beans)).setComp(this.eGui)},e.prototype.setupExpandable=function(){var t=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(t,ft.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(t,ft.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))},e.prototype.refreshExpanded=function(){var t=this.columnGroup;this.expandable=t.isExpandable();var e=t.isExpanded();this.expandable?this.comp.setAriaExpanded(e?"true":"false"):this.comp.setAriaExpanded(void 0)},e.prototype.getColId=function(){return this.columnGroup.getUniqueId()},e.prototype.addClasses=function(){var t=this,e=this.columnGroup.getColGroupDef(),n=Mc.getHeaderClassesFromColDef(e,this.gridOptionsService,null,this.columnGroup);this.columnGroup.isPadding()?(n.push("ag-header-group-cell-no-group"),this.columnGroup.getLeafColumns().every((function(t){return t.isSpanHeaderHeight()}))&&n.push("ag-header-span-height")):n.push("ag-header-group-cell-with-group");n.forEach((function(e){return t.comp.addOrRemoveCssClass(e,!0)}))},e.prototype.setupMovingCss=function(){var t=this,e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),n=function(){return t.comp.addOrRemoveCssClass("ag-header-cell-moving",t.columnGroup.isMoving())};e.forEach((function(e){t.addManagedListener(e,ht.EVENT_MOVING_CHANGED,n)})),n()},e.prototype.onFocusIn=function(t){if(!this.eGui.contains(t.relatedTarget)){var e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.columnGroup)}},e.prototype.handleKeyDown=function(e){t.prototype.handleKeyDown.call(this,e);var n=this.getWrapperHasFocus();if(this.expandable&&n&&e.key===Qo.ENTER){var o=this.columnGroup,r=!o.isExpanded();this.columnModel.setColumnGroupOpened(o.getProvidedColumnGroup(),r,"uiColumnExpanded")}},e.prototype.setDragSource=function(t){var e=this;if(!this.isSuppressMoving()){var n=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),o=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),r={type:Hi.HeaderCell,eElement:t,defaultIconName:o?qs.ICON_HIDE:qs.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:function(){return n.forEach((function(t){return t.setMoving(!0,"uiColumnDragged")}))},onDragStopped:function(){return n.forEach((function(t){return t.setMoving(!1,"uiColumnDragged")}))},onGridEnter:function(t){var n;if(o){var r=(null===(n=null===t||void 0===t?void 0:t.columns)||void 0===n?void 0:n.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(r,!0,"uiColumnMoved")}},onGridExit:function(t){var n;if(o){var r=(null===(n=null===t||void 0===t?void 0:t.columns)||void 0===n?void 0:n.filter((function(t){return!t.getColDef().lockVisible})))||[];e.columnModel.setColumnsVisible(r,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(r,!0),this.addDestroyFunc((function(){return e.dragAndDropService.removeDragSource(r)}))}},e.prototype.getDragItemForGroup=function(){var t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),e={};t.forEach((function(t){return e[t.getId()]=t.isVisible()}));var n=[];return this.columnModel.getAllDisplayedColumns().forEach((function(e){t.indexOf(e)>=0&&(n.push(e),wt(t,e))})),t.forEach((function(t){return n.push(t)})),{columns:n,visibleState:e}},e.prototype.isSuppressMoving=function(){var t=!1;return this.columnGroup.getLeafColumns().forEach((function(e){(e.getColDef().suppressMovable||e.getColDef().lockPosition)&&(t=!0)})),t||this.gridOptionsService.is("suppressMovableColumns")},Pp([$("columnModel")],e.prototype,"columnModel",void 0),Pp([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Pp([$("gridApi")],e.prototype,"gridApi",void 0),Pp([$("columnApi")],e.prototype,"columnApi",void 0),e}(Xc),Ap=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Dp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Mp=0,Lp=function(t){function e(e,n,o){var r=t.call(this)||this;r.instanceId=Mp++,r.headerCellCtrls={},r.rowIndex=e,r.pinned=n,r.type=o;var i=o==wc.COLUMN_GROUP?"ag-header-row-column-group":o==wc.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";return r.headerRowClass="ag-header-row "+i,r}return Ap(e,t),e.prototype.postConstruct=function(){this.isPrintLayout=this.gridOptionsService.isDomLayout("print"),this.isEnsureDomOrder=this.gridOptionsService.is("ensureDomOrder")},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.setComp=function(t,e){void 0===e&&(e=!0),this.comp=t,e&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()},e.prototype.getHeaderRowClass=function(){return this.headerRowClass},e.prototype.getAriaRowIndex=function(){return this.rowIndex+1},e.prototype.getTransform=function(){if(Ln())return"translateZ(0)"},e.prototype.addEventListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",(function(e){return t.isEnsureDomOrder=e.currentValue})),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))},e.prototype.getHeaderCellCtrl=function(t){return c(this.headerCellCtrls).find((function(e){return e.getColumnGroupChild()===t}))},e.prototype.onDisplayedColumnsChanged=function(){this.isPrintLayout=this.gridOptionsService.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()},e.prototype.getType=function(){return this.type},e.prototype.onColumnResized=function(){this.setWidth()},e.prototype.setWidth=function(){var t=this.getWidthForRow();this.comp.setWidth(t+"px")},e.prototype.getWidthForRow=function(){return this.isPrintLayout?null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null):this.columnModel.getContainerWidth(this.pinned)},e.prototype.onRowHeightChanged=function(){var t=this.getTopAndHeight(),e=t.topOffset,n=t.rowHeight;this.comp.setTop(e+"px"),this.comp.setHeight(n+"px")},e.prototype.getTopAndHeight=function(){var t=this.columnModel.getHeaderRowCount(),e=[],n=0;this.filterManager.hasFloatingFilters()&&(t++,n=1);for(var o=this.columnModel.getColumnGroupHeaderRowHeight(),r=this.columnModel.getColumnHeaderRowHeight(),i=t-(1+n),s=0;s<i;s++)e.push(o);e.push(r);for(s=0;s<n;s++)e.push(this.columnModel.getFloatingFiltersHeight());var a=0;for(s=0;s<this.rowIndex;s++)a+=e[s];return{topOffset:a,rowHeight:e[this.rowIndex]}},e.prototype.getPinned=function(){return this.pinned},e.prototype.getRowIndex=function(){return this.rowIndex},e.prototype.onVirtualColumnsChanged=function(){var t=this.getHeaderCtrls(),e=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,e)},e.prototype.getHeaderCtrls=function(){var t=this,e=this.headerCellCtrls;this.headerCellCtrls={},this.getColumnsInViewport().forEach((function(n){if(!n.isEmptyGroup()){var o=n.getUniqueId(),r=e[o];if(delete e[o],r&&r.getColumnGroupChild()!=n&&(t.destroyBean(r),r=void 0),null==r)switch(t.type){case wc.FLOATING_FILTER:r=t.createBean(new np(n,t));break;case wc.COLUMN_GROUP:r=t.createBean(new Ip(n,t));break;default:r=t.createBean(new wp(n,t))}t.headerCellCtrls[o]=r}}));return g(e,(function(e,n){var o;(o=n,!!t.focusService.isHeaderWrapperFocused(o)&&t.columnModel.isDisplayed(o.getColumnGroupChild()))?t.headerCellCtrls[e]=n:t.destroyBean(n)})),b(this.headerCellCtrls)},e.prototype.getColumnsInViewport=function(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()},e.prototype.getColumnsInViewportPrintLayout=function(){var t=this;if(null!=this.pinned)return[];var e=[],n=this.getActualDepth();return["left",null,"right"].forEach((function(o){var r=t.columnModel.getVirtualHeaderGroupRow(o,n);e=e.concat(r)})),e},e.prototype.getActualDepth=function(){return this.type==wc.FLOATING_FILTER?this.rowIndex-1:this.rowIndex},e.prototype.getColumnsInViewportNormalLayout=function(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())},e.prototype.focusHeader=function(t,e){var n=b(this.headerCellCtrls).find((function(e){return e.getColumnGroupChild()==t}));return!!n&&(n.focus(e),!0)},e.prototype.destroy=function(){var e=this;g(this.headerCellCtrls,(function(t,n){e.destroyBean(n)})),this.headerCellCtrls={},t.prototype.destroy.call(this)},Dp([$("columnModel")],e.prototype,"columnModel",void 0),Dp([$("focusService")],e.prototype,"focusService",void 0),Dp([$("filterManager")],e.prototype,"filterManager",void 0),Dp([Z],e.prototype,"postConstruct",null),e}(Ht),Np=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},kp=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Gp=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Bp=function(t){function e(e){var n=t.call(this)||this;return n.hidden=!1,n.includeFloatingFilter=!1,n.groupsRowCtrls=[],n.pinned=e,n}return Np(e,t),e.prototype.setComp=function(t,e){this.comp=t,this.eViewport=e,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,Zt.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()},e.prototype.setupDragAndDrop=function(t){var e=new Ic(this.pinned,t);this.createManagedBean(e)},e.prototype.refresh=function(t){var e=this;void 0===t&&(t=!1);var n=new dr,o=this.focusService.getFocusHeaderToUseAfterRefresh();!function(){var t=e.columnModel.getHeaderRowCount()-1;e.groupsRowCtrls=e.destroyBeans(e.groupsRowCtrls);for(var o=0;o<t;o++){var r=e.createBean(new Lp(n.next(),e.pinned,wc.COLUMN_GROUP));e.groupsRowCtrls.push(r)}}(),function(){var o=n.next(),r=!e.hidden&&(null==e.columnsRowCtrl||!t||e.columnsRowCtrl.getRowIndex()!==o);(r||e.hidden)&&(e.columnsRowCtrl=e.destroyBean(e.columnsRowCtrl)),r&&(e.columnsRowCtrl=e.createBean(new Lp(o,e.pinned,wc.COLUMN)))}(),function(){e.includeFloatingFilter=e.filterManager.hasFloatingFilters()&&!e.hidden;var o=function(){e.filtersRowCtrl=e.destroyBean(e.filtersRowCtrl)};if(e.includeFloatingFilter){var r=n.next();if(e.filtersRowCtrl){var i=e.filtersRowCtrl.getRowIndex()!==r;t&&!i||o()}e.filtersRowCtrl||(e.filtersRowCtrl=e.createBean(new Lp(r,e.pinned,wc.FLOATING_FILTER)))}else o()}();var r=this.getAllCtrls();this.comp.setCtrls(r),this.restoreFocusOnHeader(o)},e.prototype.restoreFocusOnHeader=function(t){null!=t&&t.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:t})},e.prototype.getAllCtrls=function(){var t=Gp([],kp(this.groupsRowCtrls));return this.columnsRowCtrl&&t.push(this.columnsRowCtrl),this.filtersRowCtrl&&t.push(this.filtersRowCtrl),t},e.prototype.onGridColumnsChanged=function(){this.refresh(!0)},e.prototype.onDisplayedColumnsChanged=function(){var t=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)},e.prototype.setupCenterWidth=function(){var t=this;null==this.pinned&&this.createManagedBean(new zu((function(e){return t.comp.setCenterWidth(e+"px")}),!0))},e.prototype.setHorizontalScroll=function(t){this.comp.setViewportScrollLeft(t)},e.prototype.setupPinnedWidth=function(){var t=this;if(null!=this.pinned){var e="left"===this.pinned,n="right"===this.pinned;this.hidden=!0;var o=function(){var o=e?t.pinnedWidthService.getPinnedLeftWidth():t.pinnedWidthService.getPinnedRightWidth();if(null!=o){var r=0==o,i=t.hidden!==r,s=t.gridOptionsService.is("enableRtl"),a=t.gridOptionsService.getScrollbarWidth(),l=t.scrollVisibleService.isVerticalScrollShowing()&&(s&&e||!s&&n)?o+a:o;t.comp.setPinnedContainerWidth(l+"px"),t.comp.setDisplayed(!r),i&&(t.hidden=r,t.refresh())}};this.addManagedListener(this.eventService,Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED,o),this.addManagedListener(this.eventService,Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED,o),this.addManagedListener(this.eventService,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,o),this.addManagedListener(this.eventService,Zt.EVENT_SCROLLBAR_WIDTH_CHANGED,o)}},e.prototype.getHeaderCtrlForColumn=function(t){if(t instanceof ht){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(t)}if(0!==this.groupsRowCtrls.length)for(var e=0;e<this.groupsRowCtrls.length;e++){var n=this.groupsRowCtrls[e].getHeaderCellCtrl(t);if(n)return n}},e.prototype.getHtmlElementForColumnHeader=function(t){var e=this.getHeaderCtrlForColumn(t);return e?e.getGui():null},e.prototype.getRowType=function(t){var e=this.getAllCtrls()[t];return e?e.getType():void 0},e.prototype.focusHeader=function(t,e,n){var o=this.getAllCtrls()[t];return!!o&&o.focusHeader(e,n)},e.prototype.getRowCount=function(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)},e.prototype.destroy=function(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),t.prototype.destroy.call(this)},Fp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Fp([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),Fp([$("pinnedWidthService")],e.prototype,"pinnedWidthService",void 0),Fp([$("columnModel")],e.prototype,"columnModel",void 0),Fp([$("focusService")],e.prototype,"focusService",void 0),Fp([$("filterManager")],e.prototype,"filterManager",void 0),e}(Ht),Vp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jp=function(t){function e(e){var n=t.call(this)||this;return n.headerRowComps={},n.rowCompsList=[],n.pinned=e,n}return Vp(e,t),e.prototype.init=function(){var t=this;this.selectAndSetTemplate();var e={setDisplayed:function(e){return t.setDisplayed(e)},setCtrls:function(e){return t.setCtrls(e)},setCenterWidth:function(e){return t.eCenterContainer.style.width=e},setViewportScrollLeft:function(e){return t.getGui().scrollLeft=e},setPinnedContainerWidth:function(e){var n=t.getGui();n.style.width=e,n.style.maxWidth=e,n.style.minWidth=e}};this.createManagedBean(new Bp(this.pinned)).setComp(e,this.getGui())},e.prototype.selectAndSetTemplate=function(){var t="left"==this.pinned,n="right"==this.pinned,o=t?e.PINNED_LEFT_TEMPLATE:n?e.PINNED_RIGHT_TEMPLATE:e.CENTER_TEMPLATE;this.setTemplate(o),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()},e.prototype.destroyRowComps=function(){this.setCtrls([])},e.prototype.destroyRowComp=function(t){this.destroyBean(t),this.eRowContainer.removeChild(t.getGui())},e.prototype.setCtrls=function(t){var e,n=this,o=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];t.forEach((function(t){var r=t.getInstanceId(),i=o[r];delete o[r];var s=i||n.createBean(new Hc(t));n.headerRowComps[r]=s,n.rowCompsList.push(s),function(t){var o=t.getGui();o.parentElement!=n.eRowContainer&&n.eRowContainer.appendChild(o),e&&Ao(n.eRowContainer,o,e),e=o}(s)})),b(o).forEach((function(t){return n.destroyRowComp(t)}))},e.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',e.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',e.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',zp([Or("eCenterContainer")],e.prototype,"eCenterContainer",void 0),zp([Z],e.prototype,"init",null),zp([J],e.prototype,"destroyRowComps",null),e}(Tr),Hp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Up=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(pp||(pp={}));var Wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Hp(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.gridBodyCon=e.gridBodyCtrl}))},e.prototype.getHeaderRowCount=function(){var t=this.ctrlsService.getHeaderRowContainerCtrl();return t?t.getRowCount():0},e.prototype.navigateVertically=function(t,e,n){if(e||(e=this.focusService.getFocusedHeader()),!e)return!1;var o=e.headerRowIndex,r=e.column,i=this.getHeaderRowCount(),s=t===pp.UP?this.headerPositionUtils.getColumnVisibleParent(r,o):this.headerPositionUtils.getColumnVisibleChild(r,o),a=s.nextRow,l=s.nextFocusColumn,u=!1;return a<0&&(a=0,l=r,u=!0),a>=i&&(a=-1),!(!u&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:n})},e.prototype.navigateHorizontally=function(t,e,n){void 0===e&&(e=!1);var o,r,i=this.focusService.getFocusedHeader();return t===pp.LEFT!==this.gridOptionsService.is("enableRtl")?(r="Before",o=this.headerPositionUtils.findHeader(i,r)):(r="After",o=this.headerPositionUtils.findHeader(i,r)),o||!e?this.focusService.focusHeaderPosition({headerPosition:o,direction:r,fromTab:e,allowUserOverride:!0,event:n}):this.focusNextHeaderRow(i,r,n)},e.prototype.focusNextHeaderRow=function(t,e,n){var o,r=t.headerRowIndex,i=null;return"Before"===e?r>0&&(o=r-1,i=this.headerPositionUtils.findColAtEdgeForHeaderRow(o,"end")):(o=r+1,i=this.headerPositionUtils.findColAtEdgeForHeaderRow(o,"start")),this.focusService.focusHeaderPosition({headerPosition:i,direction:e,fromTab:!0,allowUserOverride:!0,event:n})},e.prototype.scrollToColumn=function(t,e){if(void 0===e&&(e="After"),!t.getPinned()){var n;if(t instanceof Kt){var o=t.getDisplayedLeafColumns();n="Before"===e?yt(o):o[0]}else n=t;this.gridBodyCon.getScrollFeature().ensureColumnVisible(n)}},Up([$("focusService")],e.prototype,"focusService",void 0),Up([$("headerPositionUtils")],e.prototype,"headerPositionUtils",void 0),Up([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Up([Z],e.prototype,"postConstruct",null),e=Up([Q("headerNavigationService")],e)}(Ht),qp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Xp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Yp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qp(e,t),e.prototype.setComp=function(t,e,n){this.comp=t,this.eGui=e,this.createManagedBean(new Br(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)},e.prototype.setupHeaderHeight=function(){var t=this.setHeaderHeight.bind(this);t(),this.addManagedPropertyListener("headerHeight",t),this.addManagedPropertyListener("pivotHeaderHeight",t),this.addManagedPropertyListener("groupHeaderHeight",t),this.addManagedPropertyListener("pivotGroupHeaderHeight",t),this.addManagedPropertyListener("floatingFiltersHeight",t),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_GRID_STYLES_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,t)},e.prototype.getHeaderHeight=function(){return this.headerHeight},e.prototype.setHeaderHeight=function(){var t,e=this.columnModel,n=0,o=e.getHeaderRowCount();this.filterManager.hasFloatingFilters()&&(o++,n=1);var r=this.columnModel.getColumnGroupHeaderRowHeight(),i=this.columnModel.getColumnHeaderRowHeight(),s=o-(1+n);if(t=n*e.getFloatingFiltersHeight(),t+=s*r,t+=i,this.headerHeight!==t){this.headerHeight=t;var a=t+1+"px";this.comp.setHeightAndMinHeight(a),this.eventService.dispatchEvent({type:Zt.EVENT_HEADER_HEIGHT_CHANGED})}},e.prototype.onPivotModeChanged=function(){var t=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)},e.prototype.onDisplayedColumnsChanged=function(){var t=this.columnModel.getAllDisplayedColumns().some((function(t){return t.isSpanHeaderHeight()}));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)},e.prototype.onTabKeyDown=function(t){var e=this.gridOptionsService.is("enableRtl"),n=t.shiftKey!==e?pp.LEFT:pp.RIGHT;(this.headerNavigationService.navigateHorizontally(n,!0,t)||this.focusService.focusNextGridCoreContainer(t.shiftKey))&&t.preventDefault()},e.prototype.handleKeyDown=function(t){var e=null;switch(t.key){case Qo.LEFT:e=pp.LEFT;case Qo.RIGHT:r(e)||(e=pp.RIGHT),this.headerNavigationService.navigateHorizontally(e,!1,t);break;case Qo.UP:e=pp.UP;case Qo.DOWN:r(e)||(e=pp.DOWN),this.headerNavigationService.navigateVertically(e,null,t)&&t.preventDefault();break;default:return}},e.prototype.onFocusOut=function(t){var e=this.gridOptionsService.getDocument(),n=t.relatedTarget;!n&&this.eGui.contains(e.activeElement)||this.eGui.contains(n)||this.focusService.clearFocusedHeader()},Xp([$("headerNavigationService")],e.prototype,"headerNavigationService",void 0),Xp([$("focusService")],e.prototype,"focusService",void 0),Xp([$("columnModel")],e.prototype,"columnModel",void 0),Xp([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Xp([$("filterManager")],e.prototype,"filterManager",void 0),e}(Ht),Kp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Zp=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Jp=function(t){function e(){return t.call(this,e.TEMPLATE)||this}return Kp(e,t),e.prototype.postConstruct=function(){var t=this,e={addOrRemoveCssClass:function(e,n){return t.addOrRemoveCssClass(e,n)},setHeightAndMinHeight:function(e){t.getGui().style.height=e,t.getGui().style.minHeight=e}};this.createManagedBean(new Yp).setComp(e,this.getGui(),this.getFocusableElement());var n=function(e){t.createManagedBean(e),t.appendChild(e)};n(new jp("left")),n(new jp(null)),n(new jp("right"))},e.TEMPLATE='<div class="ag-header" role="presentation"/>',Zp([Z],e.prototype,"postConstruct",null),e}(Tr),Qp=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$p=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},th=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qp(e,t),e.prototype.addResizeBar=function(t){var e=this,n={dragStartPixels:t.dragStartPixels||0,eElement:t.eResizeBar,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this,t),onDragging:this.onDragging.bind(this,t),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(n);return function(){return e.dragService.removeDragSource(n)}},e.prototype.onDragStart=function(t,e){this.dragStartX=e.clientX,this.setResizeIcons();var n=e instanceof MouseEvent&&!0===e.shiftKey;t.onResizeStart(n)},e.prototype.setResizeIcons=function(){var t=this.ctrlsService.getGridCtrl();t.setResizeCursor(!0),t.disableUserSelect(!0)},e.prototype.onDragStop=function(t,e){t.onResizeEnd(this.resizeAmount),this.resetIcons()},e.prototype.resetIcons=function(){var t=this.ctrlsService.getGridCtrl();t.setResizeCursor(!1),t.disableUserSelect(!1)},e.prototype.onDragging=function(t,e){this.resizeAmount=e.clientX-this.dragStartX,t.onResizing(this.resizeAmount)},$p([$("dragService")],e.prototype,"dragService",void 0),$p([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=$p([Q("horizontalResizeService")],e)}(Ht),eh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},oh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return eh(e,t),e.prototype.hideActiveMenu=function(){this.hidePopup&&this.hidePopup()},e.prototype.showMenuAfterMouseEvent=function(t,e){var n=this;this.showPopup(t,(function(o){n.popupService.positionPopupUnderMouseEvent({column:t,type:"columnMenu",mouseEvent:e,ePopup:o})}),"columnMenu",e.target)},e.prototype.showMenuAfterButtonClick=function(t,e,n){var o=this;this.showPopup(t,(function(r){o.popupService.positionPopupByComponent({type:n,eventSource:e,ePopup:r,keepWithinBounds:!0,position:"under",column:t})}),n,e)},e.prototype.showPopup=function(t,e,n,o){var r=this,i=this.filterManager.getOrCreateFilterWrapper(t,"COLUMN_MENU");if(!i)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");var s,a=document.createElement("div");Ze(a,"presentation"),a.classList.add("ag-menu"),this.tabListener=this.addManagedListener(a,"keydown",(function(t){return r.trapFocusWithin(t,a)})),i.guiPromise.then((function(t){return a.appendChild(t)}));var l=o||this.ctrlsService.getGridBodyCtrl().getGui(),u=this.localeService.getLocaleTextFunc(),c=this.popupService.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:function(e){t.setMenuVisible(!1,"contextMenu");var n=e instanceof KeyboardEvent;if(r.tabListener&&(r.tabListener=r.tabListener()),n&&o&&Ro(o)){var s=r.focusService.findTabbableParent(o);s&&s.focus()}!function(){var t;null===(t=i.filterPromise)||void 0===t||t.then((function(t){var e;return null===(e=null===t||void 0===t?void 0:t.afterGuiDetached)||void 0===e?void 0:e.call(t)}))}()},positionCallback:function(){return e(a)},anchorToElement:l,ariaLabel:u("ariaLabelColumnMenu","Column Menu")});c&&(this.hidePopup=s=c.hideFunc),i.filterPromise.then((function(t){e(a),t.afterGuiAttached&&t.afterGuiAttached({container:n,hidePopup:s})})),t.setMenuVisible(!0,"contextMenu")},e.prototype.trapFocusWithin=function(t,e){t.key!==Qo.TAB||t.defaultPrevented||this.focusService.findNextFocusableElement(e,!1,t.shiftKey)||(t.preventDefault(),this.focusService.focusInto(e,t.shiftKey))},e.prototype.isMenuEnabled=function(t){return t.isFilterAllowed()&&t.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")},nh([$("filterManager")],e.prototype,"filterManager",void 0),nh([$("popupService")],e.prototype,"popupService",void 0),nh([$("focusService")],e.prototype,"focusService",void 0),nh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=nh([Q("menuFactory")],e)}(Ht),rh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ih=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},sh=function(t){function e(n){var o=t.call(this,e.getTemplate(n.cssClass))||this;return o.items=[],o.tabbedItemScrollMap=new Map,o.params=n,n.items&&n.items.forEach((function(t){return o.addItem(t)})),o}return rh(e,t),e.prototype.postConstruct=function(){var t=this;this.createManagedBean(new Br(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc((function(){var e,n,o;return null===(o=null===(n=null===(e=t.activeItem)||void 0===e?void 0:e.tabbedItem)||void 0===n?void 0:n.afterDetachedCallback)||void 0===o?void 0:o.call(n)}))},e.getTemplate=function(t){return'<div class="ag-tabs '+t+'">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header '+(t?t+"-header":"")+'"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body '+(t?t+"-body":"")+'"></div>\n        </div>'},e.prototype.handleKeyDown=function(t){var e=this.gridOptionsService.getDocument();switch(t.key){case Qo.RIGHT:case Qo.LEFT:if(!this.eHeader.contains(e.activeElement))return;var n=t.key===Qo.RIGHT,o=this.gridOptionsService.is("enableRtl"),r=this.items.indexOf(this.activeItem),i=n!==o?Math.min(r+1,this.items.length-1):Math.max(r-1,0);if(r===i)return;t.preventDefault();var s=this.items[i];this.showItemWrapper(s),s.eHeaderButton.focus();break;case Qo.UP:case Qo.DOWN:t.stopPropagation()}},e.prototype.onTabKeyDown=function(t){if(!t.defaultPrevented){var e=this,n=e.focusService,o=e.eHeader,r=e.eBody,i=e.activeItem,s=this.gridOptionsService.getDocument().activeElement,a=t.target;if(t.preventDefault(),o.contains(s))n.focusInto(r,t.shiftKey);else{var l=null;n.isTargetUnderManagedComponent(r,a)&&(t.shiftKey&&(l=this.focusService.findFocusableElementBeforeTabGuard(r,a)),l||(l=i.eHeaderButton)),!l&&r.contains(s)&&((l=n.findNextFocusableElement(r,!1,t.shiftKey))||(l=i.eHeaderButton)),l&&l.focus()}}},e.prototype.setAfterAttachedParams=function(t){this.afterAttachedParams=t},e.prototype.showFirstItem=function(){this.items.length>0&&this.showItemWrapper(this.items[0])},e.prototype.addItem=function(t){var e=document.createElement("span");Ze(e,"tab"),e.setAttribute("tabindex","-1"),e.appendChild(t.title),e.classList.add("ag-tab"),this.eHeader.appendChild(e),tn(e,t.titleLabel);var n={tabbedItem:t,eHeaderButton:e};this.items.push(n),e.addEventListener("click",this.showItemWrapper.bind(this,n))},e.prototype.showItem=function(t){var e=this.items.find((function(e){return e.tabbedItem===t}));e&&this.showItemWrapper(e)},e.prototype.showItemWrapper=function(t){var e,n,o=this,r=t.tabbedItem,i=t.eHeaderButton;this.params.onItemClicked&&this.params.onItemClicked({item:r}),this.activeItem!==t?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),So(this.eBody),r.bodyPromise.then((function(t){o.eBody.appendChild(t);var e=!o.focusService.isKeyboardMode();if(o.focusService.focusInto(o.eBody,!1,e),r.afterAttachedCallback&&r.afterAttachedCallback(o.afterAttachedParams),o.params.keepScrollPosition){var n=r.getScrollableContainer&&r.getScrollableContainer()||t;o.lastScrollListener=o.addManagedListener(n,"scroll",(function(){o.tabbedItemScrollMap.set(r.name,n.scrollTop)}));var i=o.tabbedItemScrollMap.get(r.name);void 0!==i&&setTimeout((function(){n.scrollTop=i}),0)}})),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(n=(e=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===n||n.call(e)),i.classList.add("ag-tab-selected"),this.activeItem=t):V(this.params.onActiveItemClicked)},ih([$("focusService")],e.prototype,"focusService",void 0),ih([Or("eHeader")],e.prototype,"eHeader",void 0),ih([Or("eBody")],e.prototype,"eBody",void 0),ih([Z],e.prototype,"postConstruct",null),e}(Tr);function ah(t){return P((function(){return console.warn("AG Grid: Since v29 simpleHttpRequest has been deprecated as it was only meant for use in internal AG Grid documentation examples. Please use the browser fetch api directly.")}),"simpleHttpRequest"),new mr((function(e){var n=new XMLHttpRequest;n.open("GET",t.url),n.send(),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(JSON.parse(n.responseText))}}))}var lh,uh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ch=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ph=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.polyfillFunctions=[],e}return uh(e,t),e.prototype.observeResize=function(t,e){var n=this,o=this.gridOptionsService.getWindow(),r=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!o.ResizeObserver&&!r?function(){var n=new o.ResizeObserver(e);return n.observe(t),function(){return n.disconnect()}}():function(){var o=Io(t),r=Po(t),i=!0,s=function(){if(i){var a=Io(t),l=Po(t);(a!==o||l!==r)&&(o=a,r=l,e()),n.doNextPolyfillTurn(s)}};return s(),function(){return i=!1}}()},e.prototype.doNextPolyfillTurn=function(t){this.polyfillFunctions.push(t),this.schedulePolyfill()},e.prototype.schedulePolyfill=function(){var t=this;if(!this.polyfillScheduled){this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout((function(){var e=t.polyfillFunctions;t.polyfillScheduled=!1,t.polyfillFunctions=[],e.forEach((function(t){return t()}))}),50)}},e=ch([Q("resizeObserverService")],e)}(Ht),hh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},fh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.createTasksP1={list:[],sorted:!1},e.createTasksP2={list:[],sorted:!1},e.destroyTasks=[],e.ticking=!1,e.scrollGoingDown=!0,e.lastPage=0,e.lastScrollTop=0,e.taskCount=0,e.cancelledTasks=new Set,e}return hh(e,t),e.prototype.setScrollTop=function(t){var e=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=t>=this.lastScrollTop,e&&0===t){var n=this.paginationProxy.getCurrentPage();n!==this.lastPage&&(this.lastPage=n,this.scrollGoingDown=!0)}this.lastScrollTop=t},e.prototype.init=function(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")},e.prototype.isOn=function(){return this.useAnimationFrame},e.prototype.verifyAnimationFrameOn=function(t){!1===this.useAnimationFrame&&console.warn("AG Grid: AnimationFrameService."+t+" called but animation frames are off")},e.prototype.createTask=function(t,e,n){this.verifyAnimationFrameOn(n);var o={task:t,index:e,createOrder:++this.taskCount};this.addTaskToList(this[n],o),this.schedule()},e.prototype.cancelTask=function(t){this.cancelledTasks.add(t)},e.prototype.addTaskToList=function(t,e){t.list.push(e),t.sorted=!1},e.prototype.sortTaskList=function(t){if(!t.sorted){var e=this.scrollGoingDown?1:-1;t.list.sort((function(t,n){return t.index!==n.index?e*(n.index-t.index):n.createOrder-t.createOrder})),t.sorted=!0}},e.prototype.addDestroyTask=function(t){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(t),this.schedule()},e.prototype.executeFrame=function(t){this.verifyAnimationFrameOn("executeFrame");for(var e=this.createTasksP1,n=e.list,o=this.createTasksP2,r=o.list,i=this.destroyTasks,s=(new Date).getTime(),a=(new Date).getTime()-s,l=t<=0,u=this.ctrlsService.getGridBodyCtrl();l||a<t;){if(!u.getScrollFeature().scrollGridIfNeeded()){var c=void 0;if(n.length)this.sortTaskList(e),c=n.pop().task;else if(r.length)this.sortTaskList(o),c=r.pop().task;else{if(!i.length){this.cancelledTasks.clear();break}c=i.pop()}this.cancelledTasks.has(c)||c()}a=(new Date).getTime()-s}n.length||r.length||i.length?this.requestFrame():this.stopTicking()},e.prototype.stopTicking=function(){this.ticking=!1},e.prototype.flushAllFrames=function(){this.useAnimationFrame&&this.executeFrame(-1)},e.prototype.schedule=function(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))},e.prototype.requestFrame=function(){var t=this.executeFrame.bind(this,60);this.requestAnimationFrame(t)},e.prototype.requestAnimationFrame=function(t){var e=this.gridOptionsService.getWindow();e.requestAnimationFrame?e.requestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.setTimeout(t,0)},e.prototype.isQueueEmpty=function(){return!this.ticking},e.prototype.debounce=function(t){var e=this,n=!1;return function(){e.isOn()?n||(n=!0,e.addDestroyTask((function(){n=!1,t()}))):e.getFrameworkOverrides().setTimeout(t,0)}},dh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),dh([$("paginationProxy")],e.prototype,"paginationProxy",void 0),dh([Z],e.prototype,"init",null),e=dh([Q("animationFrameService")],e)}(Ht),gh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},yh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gh(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.centerRowContainerCtrl=e.centerRowContainerCtrl}))},e.prototype.getPreferredWidthForColumn=function(t,e){var n=this.getHeaderCellForColumn(t);if(!n)return-1;var o=this.rowRenderer.getAllCellsForColumn(t);return e||o.push(n),this.addElementsToContainerAndGetWidth(o)},e.prototype.getPreferredWidthForColumnGroup=function(t){var e=this.getHeaderCellForColumn(t);return e?this.addElementsToContainerAndGetWidth([e]):-1},e.prototype.addElementsToContainerAndGetWidth=function(t){var e=this,n=document.createElement("form");n.style.position="fixed";var o=this.centerRowContainerCtrl.getContainerElement();t.forEach((function(t){return e.cloneItemIntoDummy(t,n)})),o.appendChild(n);var r=n.offsetWidth;return o.removeChild(n),r+this.getAutoSizePadding()},e.prototype.getAutoSizePadding=function(){var t=this.gridOptionsService.getNum("autoSizePadding");return null!=t&&t>=0?t:20},e.prototype.getHeaderCellForColumn=function(t){var e=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(n){var o=n.getHtmlElementForColumnHeader(t);null!=o&&(e=o)})),e},e.prototype.cloneItemIntoDummy=function(t,e){var n=t.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";var o=document.createElement("div"),r=o.classList;["ag-header-cell","ag-header-group-cell"].some((function(t){return n.classList.contains(t)}))?(r.add("ag-header","ag-header-row"),o.style.position="static"):r.add("ag-row");for(var i=t.parentElement;i;){if(["ag-header-row","ag-row"].some((function(t){return i.classList.contains(t)}))){for(var s=0;s<i.classList.length;s++){var a=i.classList[s];"ag-row-position-absolute"!=a&&r.add(a)}break}i=i.parentElement}o.appendChild(n),e.appendChild(o)},mh([$("rowRenderer")],e.prototype,"rowRenderer",void 0),mh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),mh([$("rowCssClassCalculator")],e.prototype,"rowCssClassCalculator",void 0),mh([Z],e.prototype,"postConstruct",null),e=mh([Q("autoWidthCalculator")],e)}(Ht),vh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_h=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ch=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wh=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},bh=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},xh=function(t){function e(e,n){var o=t.call(this)||this;return o.createRowCon=e,o.destroyRowCtrls=n,o.stickyRowCtrls=[],o.containerHeight=0,o}return vh(e,t),e.prototype.postConstruct=function(){var t=this;this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady((function(e){t.gridBodyCtrl=e.gridBodyCtrl}))},e.prototype.getStickyRowCtrls=function(){return this.stickyRowCtrls},e.prototype.checkStickyRows=function(){var t=this,e=0;if(!this.gridOptionsService.isGroupRowsSticky())return this.refreshNodesAndContainerHeight([],e);for(var n=[],o=this.rowRenderer.getFirstVisibleVerticalPixel(),r=function(r){var i,s,a,l;if(n.push(r),t.isClientSide){for(var u=r;u.expanded;)if(u.master)u=u.detailNode;else if(u.childrenAfterSort){if(0===u.childrenAfterSort.length)break;u=yt(u.childrenAfterSort)}l=u.rowTop+u.rowHeight}else if(r.master)l=r.detailNode.rowTop+r.detailNode.rowHeight;else{var c=null===(i=r.childStore)||void 0===i?void 0:i.getStoreBounds();l=(null!==(s=null===c||void 0===c?void 0:c.heightPx)&&void 0!==s?s:0)+(null!==(a=null===c||void 0===c?void 0:c.topPx)&&void 0!==a?a:0)}var p=o+e+r.rowHeight;r.stickyRowTop=l<p?e+(l-p):e,e=0,n.forEach((function(t){var n=t.stickyRowTop+t.rowHeight;e<n&&(e=n)}))};;){var i=o+e,s=this.rowModel.getRowIndexAtPixel(i),a=this.rowModel.getRow(s);if(null==a)break;if(a.level<0)break;for(var l=[],u=a.parent;u.level>=0;)l.push(u),u=u.parent;var c=l.reverse().find((function(t){return n.indexOf(t)<0&&t.displayed}));if(c)r(c);else{if(!(a.isExpandable()&&a.expanded&&a.rowTop<i))break;r(a)}}return this.refreshNodesAndContainerHeight(n,e)},e.prototype.refreshStickyNode=function(t){for(var e=[],n=0;n<this.stickyRowCtrls.length;n++){var o=this.stickyRowCtrls[n].getRowNode();o!==t&&e.push(o)}this.refreshNodesAndContainerHeight(e,this.containerHeight)&&this.checkStickyRows()},e.prototype.refreshNodesAndContainerHeight=function(t,e){var n,o,r,i=this,s=!1,a=this.stickyRowCtrls.filter((function(e){return-1===t.indexOf(e.getRowNode())})),l=t.filter((function(t){return-1===i.stickyRowCtrls.findIndex((function(e){return e.getRowNode()===t}))}));(a.length||l.length)&&(s=!0);var u={};a.forEach((function(t){u[t.getRowNode().id]=t,i.stickyRowCtrls=i.stickyRowCtrls.filter((function(e){return e!==t}))}));try{for(var c=Ch(Object.values(u)),p=c.next();!p.done;p=c.next()){p.value.getRowNode().sticky=!1}}catch(d){n={error:d}}finally{try{p&&!p.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}this.destroyRowCtrls(u,!1);var h=l.map((function(t){return t.sticky=!0,i.createRowCon(t,!1,!1)}));return(r=this.stickyRowCtrls).push.apply(r,bh([],wh(h))),this.stickyRowCtrls.forEach((function(t){return t.setRowTop(t.getRowNode().stickyRowTop)})),this.stickyRowCtrls.sort((function(t,e){return e.getRowNode().rowIndex-t.getRowNode().rowIndex})),this.containerHeight!==e&&(this.containerHeight=e,this.gridBodyCtrl.setStickyTopHeight(e),s=!0),s},_h([$("rowModel")],e.prototype,"rowModel",void 0),_h([$("rowRenderer")],e.prototype,"rowRenderer",void 0),_h([$("ctrlsService")],e.prototype,"ctrlsService",void 0),_h([Z],e.prototype,"postConstruct",null),e}(Ht),Eh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Sh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Th=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Rh=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Oh=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ph=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.destroyFuncsForColumnListeners=[],e.rowCtrlsByRowIndex={},e.zombieRowCtrls={},e.allRowCtrls=[],e.topRowCtrls=[],e.bottomRowCtrls=[],e.refreshInProgress=!1,e.dataFirstRenderedFired=!1,e}return Eh(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl(),t.initialise()}))},e.prototype.initialise=function(){if(this.addManagedListener(this.eventService,Zt.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.isGroupRowsSticky()){var t=this.rowModel.getType();"clientSide"!==t&&"serverSide"!==t||(this.stickyRowFeature=this.createManagedBean(new xh(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()},e.prototype.initialiseCache=function(){if(this.gridOptionsService.is("keepDetailRows")){var t=this.getKeepDetailRowsCount(),e=null!=t?t:3;this.cachedRowCtrls=new Ih(e)}},e.prototype.getKeepDetailRowsCount=function(){var t=this.gridOptionsService.getNum("keepDetailRowsCount");return r(t)&&t>0?t:10},e.prototype.getStickyTopRowCtrls=function(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]},e.prototype.updateAllRowCtrls=function(){var t=b(this.rowCtrlsByRowIndex),e=this.gridOptionsService.is("ensureDomOrder"),n=this.gridOptionsService.isDomLayout("print");(e||n)&&t.sort((function(t,e){return t.getRowNode().rowIndex-e.getRowNode.rowIndex}));var o=b(this.zombieRowCtrls),r=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];o.length>0||r.length>0?this.allRowCtrls=Rh(Rh(Rh([],Th(t)),Th(o)),Th(r)):this.allRowCtrls=t},e.prototype.onCellFocusChanged=function(t){this.getAllCellCtrls().forEach((function(e){return e.onCellFocused(t)})),this.getFullWidthRowCtrls().forEach((function(e){return e.onFullWidthRowFocused(t)}))},e.prototype.registerCellEventListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_CELL_FOCUSED,(function(e){t.onCellFocusChanged(e)})),this.addManagedListener(this.eventService,Zt.EVENT_CELL_FOCUS_CLEARED,(function(){t.onCellFocusChanged()})),this.addManagedListener(this.eventService,Zt.EVENT_FLASH_CELLS,(function(e){t.getAllCellCtrls().forEach((function(t){return t.onFlashCells(e)}))})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_HOVER_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onColumnHover()}))})),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onDisplayedColumnsChanged()}))})),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){t.printLayout&&t.getAllCellCtrls().forEach((function(t){return t.onLeftChanged()}))})),this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,Zt.EVENT_RANGE_SELECTION_CHANGED,(function(){t.getAllCellCtrls().forEach((function(t){return t.onRangeSelectionChanged()}))})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_MOVED,(function(){t.getAllCellCtrls().forEach((function(t){return t.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PINNED,(function(){t.getAllCellCtrls().forEach((function(t){return t.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VISIBLE,(function(){t.getAllCellCtrls().forEach((function(t){return t.updateRangeBordersIfRangeCount()}))}))),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,Zt.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))},e.prototype.removeGridColumnListeners=function(){this.destroyFuncsForColumnListeners.forEach((function(t){return t()})),this.destroyFuncsForColumnListeners.length=0},e.prototype.refreshListenersToColumnsForCellComps=function(){var t=this;this.removeGridColumnListeners();var e=this.columnModel.getAllGridColumns();e&&e.forEach((function(e){var n=function(n){t.getAllCellCtrls().forEach((function(t){t.getColumn()===e&&n(t)}))},o=function(){n((function(t){return t.onLeftChanged()}))},r=function(){n((function(t){return t.onWidthChanged()}))},i=function(){n((function(t){return t.onFirstRightPinnedChanged()}))},s=function(){n((function(t){return t.onLastLeftPinnedChanged()}))},a=function(){n((function(t){return t.onColDefChanged()}))};e.addEventListener("leftChanged",o),e.addEventListener("widthChanged",r),e.addEventListener("firstRightPinnedChanged",i),e.addEventListener("lastLeftPinnedChanged",s),e.addEventListener("colDefChanged",a),t.destroyFuncsForColumnListeners.push((function(){e.removeEventListener("leftChanged",o),e.removeEventListener("widthChanged",r),e.removeEventListener("firstRightPinnedChanged",i),e.removeEventListener("lastLeftPinnedChanged",s),e.removeEventListener("colDefChanged",a)}))}))},e.prototype.onDomLayoutChanged=function(){var t=this.gridOptionsService.isDomLayout("print"),e=t||this.gridOptionsService.is("embedFullWidthRows"),n=e!==this.embedFullWidthRows||this.printLayout!==t;this.printLayout=t,this.embedFullWidthRows=e,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})},e.prototype.datasourceChanged=function(){this.firstRenderedRow=0,this.lastRenderedRow=-1;var t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)},e.prototype.onPageLoaded=function(t){var e={recycleRows:t.keepRenderedRows,animate:t.animate,newData:t.newData,newPage:t.newPage,onlyBody:!0};this.redrawAfterModelUpdate(e)},e.prototype.getAllCellsForColumn=function(t){var e=[];return this.getAllRowCtrls().forEach((function(n){var o=n.getCellElement(t);o&&e.push(o)})),e},e.prototype.refreshFloatingRowComps=function(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())},e.prototype.getTopRowCtrls=function(){return this.topRowCtrls},e.prototype.getCentreRowCtrls=function(){return this.allRowCtrls},e.prototype.getBottomRowCtrls=function(){return this.bottomRowCtrls},e.prototype.refreshFloatingRows=function(t,e){var n=this;t.forEach((function(t){t.destroyFirstPass(),t.destroySecondPass()})),t.length=0,e&&e.forEach((function(e){var o=new _u(e,n.beans,!1,!1,n.printLayout);t.push(o)}))},e.prototype.onPinnedRowDataChanged=function(){this.redrawAfterModelUpdate({recycleRows:!0})},e.prototype.redrawRow=function(t,e){var n=this;if(void 0===e&&(e=!1),t.sticky)this.stickyRowFeature.refreshStickyNode(t);else{var o=function(e){var o=e[t.rowIndex];o&&o.getRowNode()===t&&(o.destroyFirstPass(),o.destroySecondPass(),e[t.rowIndex]=n.createRowCon(t,!1,!1))};switch(t.rowPinned){case"top":o(this.topRowCtrls);case"bottom":o(this.bottomRowCtrls);default:o(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}e||this.dispatchDisplayedRowsChanged(!1)},e.prototype.redrawRows=function(t){var e=this;if(null!=t)return null===t||void 0===t||t.forEach((function(t){return e.redrawRow(t,!0)})),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()},e.prototype.getCellToRestoreFocusToAfterRefresh=function(t){var e=(null===t||void 0===t?void 0:t.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==e)return null;var n=this.gridOptionsService.getDocument().activeElement,o=this.gridOptionsService.getDomData(n,pu.DOM_DATA_KEY_CELL_CTRL),r=this.gridOptionsService.getDomData(n,_u.DOM_DATA_KEY_ROW_CTRL);return o||r?e:null},e.prototype.redrawAfterModelUpdate=function(t){void 0===t&&(t={}),this.getLockOnRefresh();var e=this.getCellToRestoreFocusToAfterRefresh(t);this.updateContainerHeights(),this.scrollToTopIfNewData(t);var n=!t.domLayoutChanged&&!!t.recycleRows,o=t.animate&&this.gridOptionsService.isAnimateRows(),r=n?this.getRowsToRecycle():null;n||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(r,o),this.gridBodyCtrl.updateRowCount(),t.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=e&&this.restoreFocusedCell(e),this.releaseLockOnRefresh()},e.prototype.scrollToTopIfNewData=function(t){var e=t.newData||t.newPage,n=this.gridOptionsService.is("suppressScrollOnNewData");e&&!n&&this.gridBodyCtrl.getScrollFeature().scrollToTop()},e.prototype.updateContainerHeights=function(){if(this.printLayout)this.rowContainerHeightService.setModelHeight(null);else{var t=this.paginationProxy.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t)}},e.prototype.getLockOnRefresh=function(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0},e.prototype.releaseLockOnRefresh=function(){this.refreshInProgress=!1},e.prototype.isRefreshInProgress=function(){return this.refreshInProgress},e.prototype.restoreFocusedCell=function(t){t&&(this.focusService.setRestoreFocusedCell(t),this.onCellFocusChanged({rowIndex:t.rowIndex,column:t.column,rowPinned:t.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"}))},e.prototype.stopEditing=function(t){void 0===t&&(t=!1),this.getAllRowCtrls().forEach((function(e){e.stopEditing(t)}))},e.prototype.getAllCellCtrls=function(){for(var t=[],e=this.getAllRowCtrls(),n=e.length,o=0;o<n;o++)for(var r=e[o].getAllCellCtrls(),i=r.length,s=0;s<i;s++)t.push(r[s]);return t},e.prototype.getAllRowCtrls=function(){var t,e,n=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],o=Rh(Rh(Rh([],Th(this.topRowCtrls)),Th(this.bottomRowCtrls)),Th(n));try{for(var r=Oh(Object.keys(this.rowCtrlsByRowIndex)),i=r.next();!i.done;i=r.next()){var s=i.value;o.push(this.rowCtrlsByRowIndex[s])}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return o},e.prototype.addRenderedRowListener=function(t,e,n){var o=this.rowCtrlsByRowIndex[e];o&&o.addEventListener(t,n)},e.prototype.flashCells=function(t){void 0===t&&(t={});var e=t.flashDelay,n=t.fadeDelay;this.getCellCtrls(t.rowNodes,t.columns).forEach((function(t){return t.flashCell({flashDelay:e,fadeDelay:n})}))},e.prototype.refreshCells=function(t){var e=this;void 0===t&&(t={});var n={forceRefresh:t.force,newData:!1,suppressFlash:t.suppressFlash};this.getCellCtrls(t.rowNodes,t.columns).forEach((function(t){if(t.refreshShouldDestroy()){var e=t.getRowCtrl();e&&e.refreshCell(t)}else t.refreshCell(n)})),t.rowNodes&&(this.getRowCtrls(t.rowNodes).forEach((function(t){t.isFullWidth()&&(t.refreshFullWidth()||e.redrawRow(t.getRowNode(),!0))})),this.dispatchDisplayedRowsChanged(!1))},e.prototype.getCellRendererInstances=function(t){var e,n=this,o=this.getCellCtrls(t.rowNodes,t.columns).map((function(t){return t.getCellRenderer()})).filter((function(t){return null!=t}));if(null===(e=t.columns)||void 0===e?void 0:e.length)return o;var r=[],i=this.mapRowNodes(t.rowNodes);return this.getAllRowCtrls().forEach((function(t){if((!i||n.isRowInMap(t.getRowNode(),i))&&t.isFullWidth()){var e=t.getFullWidthCellRenderer();e&&r.push(e)}})),Rh(Rh([],Th(r)),Th(o))},e.prototype.getCellEditorInstances=function(t){var e=[];return this.getCellCtrls(t.rowNodes,t.columns).forEach((function(t){var n=t.getCellEditor();n&&e.push(n)})),e},e.prototype.getEditingCells=function(){var t=[];return this.getAllCellCtrls().forEach((function(e){if(e.isEditing()){var n=e.getCellPosition();t.push(n)}})),t},e.prototype.mapRowNodes=function(t){if(t){var e={top:{},bottom:{},normal:{}};return t.forEach((function(t){var n=t.id;"top"===t.rowPinned?e.top[n]=t:"bottom"===t.rowPinned?e.bottom[n]=t:e.normal[n]=t})),e}},e.prototype.isRowInMap=function(t,e){var n=t.id,o=t.rowPinned;return"bottom"===o?null!=e.bottom[n]:"top"===o?null!=e.top[n]:null!=e.normal[n]},e.prototype.getRowCtrls=function(t){var e=this,n=this.mapRowNodes(t),o=this.getAllRowCtrls();return t&&n?o.filter((function(t){var o=t.getRowNode();return e.isRowInMap(o,n)})):o},e.prototype.getCellCtrls=function(t,e){var n,o=this;r(e)&&(n={},e.forEach((function(t){var e=o.columnModel.getGridColumn(t);r(e)&&(n[e.getId()]=!0)})));var i=[];return this.getRowCtrls(t).forEach((function(t){t.getAllCellCtrls().forEach((function(t){var e=t.getColumn().getId();n&&!n[e]||i.push(t)}))})),i},e.prototype.destroy=function(){this.removeAllRowComps(),t.prototype.destroy.call(this)},e.prototype.removeAllRowComps=function(){var t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)},e.prototype.getRowsToRecycle=function(){var t=[];g(this.rowCtrlsByRowIndex,(function(e,n){null==n.getRowNode().id&&t.push(e)})),this.removeRowCtrls(t);var e={};return g(this.rowCtrlsByRowIndex,(function(t,n){var o=n.getRowNode();e[o.id]=n})),this.rowCtrlsByRowIndex={},e},e.prototype.removeRowCtrls=function(t){var e=this;t.forEach((function(t){var n=e.rowCtrlsByRowIndex[t];n&&(n.destroyFirstPass(),n.destroySecondPass()),delete e.rowCtrlsByRowIndex[t]}))},e.prototype.onBodyScroll=function(t){"vertical"===t.direction&&this.redraw({afterScroll:!0})},e.prototype.redraw=function(t){void 0===t&&(t={});var e,n=t.afterScroll;this.stickyRowFeature&&Vn()&&(e=this.getCellToRestoreFocusToAfterRefresh()||void 0);var o=this.firstRenderedRow,r=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();var i=!1;this.stickyRowFeature&&(i=this.stickyRowFeature.checkStickyRows());var s=this.firstRenderedRow!==o||this.lastRenderedRow!==r;if((!n||i||s)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n),null!=e)){var a=this.getCellToRestoreFocusToAfterRefresh();null!=e&&null==a&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(e))}},e.prototype.removeRowCompsNotToDraw=function(t){var e={};t.forEach((function(t){return e[t]=!0}));var n=Object.keys(this.rowCtrlsByRowIndex).filter((function(t){return!e[t]}));this.removeRowCtrls(n)},e.prototype.calculateIndexesToDraw=function(t){var e=this,n=Zn(this.firstRenderedRow,this.lastRenderedRow),o=function(t,o){var r=o.getRowNode().rowIndex;null!=r&&(r<e.firstRenderedRow||r>e.lastRenderedRow)&&e.doNotUnVirtualiseRow(o)&&n.push(r)};g(this.rowCtrlsByRowIndex,o),g(t,o),n.sort((function(t,e){return t-e}));for(var r=[],i=0;i<n.length;i++){var s=n[i],a=this.paginationProxy.getRow(s);a&&!a.sticky&&r.push(s)}return r},e.prototype.recycleRows=function(t,e,n){var o=this;void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.calculateIndexesToDraw(t);(this.removeRowCompsNotToDraw(i),this.printLayout&&(e=!1),i.forEach((function(i){r(o.createOrUpdateRowCtrl(i,t,e,n))})),t)&&(n&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask((function(){o.destroyRowCtrls(t,e),o.updateAllRowCtrls(),o.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(t,e));this.updateAllRowCtrls()},e.prototype.dispatchDisplayedRowsChanged=function(t){void 0===t&&(t=!1);var e={type:Zt.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:t};this.eventService.dispatchEvent(e)},e.prototype.onDisplayedColumnsChanged=function(){var t=this.columnModel.isPinningLeft(),e=this.columnModel.isPinningRight();(this.pinningLeft!==t||e!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=e,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())},e.prototype.redrawFullWidthEmbeddedRows=function(){var t=[];this.getFullWidthRowCtrls().forEach((function(e){var n=e.getRowNode().rowIndex;t.push(n.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(t),this.redraw({afterScroll:!0})},e.prototype.getFullWidthRowCtrls=function(t){var e=this,n=this.mapRowNodes(t);return this.getAllRowCtrls().filter((function(t){if(!t.isFullWidth())return!1;var o=t.getRowNode();return!(null!=n&&!e.isRowInMap(o,n))}))},e.prototype.createOrUpdateRowCtrl=function(t,e,n,o){var i,s=this.rowCtrlsByRowIndex[t];if(s||r(i=this.paginationProxy.getRow(t))&&r(e)&&e[i.id]&&i.alreadyRendered&&(s=e[i.id],e[i.id]=null),!s){if(i||(i=this.paginationProxy.getRow(t)),!r(i))return;s=this.createRowCon(i,n,o)}return i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[t]=s,s},e.prototype.destroyRowCtrls=function(t,e){var n=this,o=[];g(t,(function(t,r){r&&(n.cachedRowCtrls&&r.isCacheable()?n.cachedRowCtrls.addRow(r):(r.destroyFirstPass(),e?(n.zombieRowCtrls[r.getInstanceId()]=r,o.push((function(){r.destroySecondPass(),delete n.zombieRowCtrls[r.getInstanceId()]}))):r.destroySecondPass()))})),e&&(o.push((function(){n.updateAllRowCtrls(),n.dispatchDisplayedRowsChanged()})),D(o))},e.prototype.getRowBuffer=function(){var t=this.gridOptionsService.getNum("rowBuffer");return"number"===typeof t?t<0&&(P((function(){return console.warn("AG Grid: rowBuffer should not be negative")}),"warn rowBuffer negative"),t=0,this.gridOptionsService.set("rowBuffer",0)):t=10,t},e.prototype.getRowBufferInPixels=function(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()},e.prototype.workOutFirstAndLastRowsToRender=function(){var t,e;if(this.rowContainerHeightService.updateOffset(),this.paginationProxy.isRowsToRender())if(this.printLayout)t=this.paginationProxy.getPageFirstRow(),e=this.paginationProxy.getPageLastRow();else{var n=this.getRowBufferInPixels(),o=this.ctrlsService.getGridBodyCtrl(),r=this.gridOptionsService.is("suppressRowVirtualisation"),i=!1,s=void 0,a=void 0;do{var l=this.paginationProxy.getPixelOffset(),u=this.paginationProxy.getCurrentPagePixelRange(),c=u.pageFirstPixel,p=u.pageLastPixel,h=this.rowContainerHeightService.getDivStretchOffset(),d=o.getScrollFeature().getVScrollPosition(),f=d.top,g=d.bottom;r?(s=c+h,a=p+h):(s=Math.max(f+l-n,c)+h,a=Math.min(g+l+n,p)+h),this.firstVisibleVPixel=Math.max(f+l,c)+h,i=this.ensureAllRowsInRangeHaveHeightsCalculated(s,a)}while(i);var m=this.paginationProxy.getRowIndexAtPixel(s),y=this.paginationProxy.getRowIndexAtPixel(a),v=this.paginationProxy.getPageFirstRow(),_=this.paginationProxy.getPageLastRow();m<v&&(m=v),y>_&&(y=_),t=m,e=y}else t=0,e=-1;var C=this.gridOptionsService.isDomLayout("normal"),w=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),b=Math.max(this.getRowBuffer(),500);C&&!w&&e-t>b&&(e=t+b);var x=t!==this.firstRenderedRow,E=e!==this.lastRenderedRow;if(x||E){this.firstRenderedRow=t,this.lastRenderedRow=e;var S={type:Zt.EVENT_VIEWPORT_CHANGED,firstRow:t,lastRow:e};this.eventService.dispatchEvent(S)}},e.prototype.dispatchFirstDataRenderedEvent=function(){var t=this;if(!this.dataFirstRenderedFired){this.dataFirstRenderedFired=!0;var e={type:Zt.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame((function(){t.beans.eventService.dispatchEvent(e)}))}},e.prototype.ensureAllRowsInRangeHaveHeightsCalculated=function(t,e){var n=this.paginationProxy.ensureRowHeightsValid(t,e,-1,-1);return n&&this.updateContainerHeights(),n},e.prototype.getFirstVisibleVerticalPixel=function(){return this.firstVisibleVPixel},e.prototype.getFirstVirtualRenderedRow=function(){return this.firstRenderedRow},e.prototype.getLastVirtualRenderedRow=function(){return this.lastRenderedRow},e.prototype.doNotUnVirtualiseRow=function(t){var e=t.getRowNode(),n=this.focusService.isRowNodeFocused(e),o=t.isEditing(),r=e.detail;return!!(n||o||r)&&!!this.paginationProxy.isRowPresent(e)},e.prototype.createRowCon=function(t,e,n){var o=this.cachedRowCtrls?this.cachedRowCtrls.getRow(t):null;if(o)return o;var r=this.gridOptionsService.is("suppressAnimationFrame"),i=n&&!r&&!this.printLayout;return new _u(t,this.beans,e,i,this.printLayout)},e.prototype.getRenderedNodes=function(){var t=this.rowCtrlsByRowIndex;return Object.keys(t).map((function(e){return t[e].getRowNode()}))},e.prototype.getRowByPosition=function(t){var e,n=t.rowIndex;switch(t.rowPinned){case"top":e=this.topRowCtrls[n];break;case"bottom":e=this.bottomRowCtrls[n];break;default:(e=this.rowCtrlsByRowIndex[n])||(e=this.getStickyTopRowCtrls().find((function(t){return t.getRowNode().rowIndex===n}))||null)}return e},e.prototype.getRowNode=function(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},e.prototype.isRangeInRenderedViewport=function(t,e){if(null==t||null==e)return!1;var n=t>this.lastRenderedRow;return!(e<this.firstRenderedRow)&&!n},Sh([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Sh([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Sh([$("columnModel")],e.prototype,"columnModel",void 0),Sh([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Sh([$("rowModel")],e.prototype,"rowModel",void 0),Sh([$("focusService")],e.prototype,"focusService",void 0),Sh([$("beans")],e.prototype,"beans",void 0),Sh([$("rowContainerHeightService")],e.prototype,"rowContainerHeightService",void 0),Sh([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Sh([Z],e.prototype,"postConstruct",null),e=Sh([Q("rowRenderer")],e)}(Ht),Ih=function(){function t(t){this.entriesMap={},this.entriesList=[],this.maxCount=t}return t.prototype.addRow=function(t){if(this.entriesMap[t.getRowNode().id]=t,this.entriesList.push(t),t.setCached(!0),this.entriesList.length>this.maxCount){var e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}},t.prototype.getRow=function(t){if(null==t||null==t.id)return null;var e=this.entriesMap[t.id];return e?(this.removeFromCache(e),e.setCached(!1),e.getRowNode()!=t?null:e):null},t.prototype.removeFromCache=function(t){var e=t.getRowNode().id;delete this.entriesMap[e],wt(this.entriesList,t)},t.prototype.getEntries=function(){return this.entriesList},t}(),Ah=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Dh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Mh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ah(e,t),e.prototype.formatValue=function(t,e,n,o,r){void 0===r&&(r=!0);var i,s=null,a=t.getColDef();if(o?i=o:r&&(i=a.valueFormatter),i){var l={value:n,node:e,data:e?e.data:null,colDef:a,column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};s="function"===typeof i?i(l):this.expressionService.evaluate(i,l)}else if(a.refData)return a.refData[n]||"";return null==s&&Array.isArray(n)&&(s=n.join(", ")),s},Dh([$("expressionService")],e.prototype,"expressionService",void 0),e=Dh([Q("valueFormatterService")],e)}(Ht),Lh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Nh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Fh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lh(e,t),e.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))},e.prototype.isEmpty=function(t){return s("top"===t?this.pinnedTopRows:this.pinnedBottomRows)},e.prototype.isRowsToRender=function(t){return!this.isEmpty(t)},e.prototype.getRowAtPixel=function(t,e){var n="top"===e?this.pinnedTopRows:this.pinnedBottomRows;if(s(n))return 0;for(var o=0;o<n.length;o++){var r=n[o];if(r.rowTop+r.rowHeight-1>=t)return o}return n.length-1},e.prototype.setPinnedTopRowData=function(t){this.pinnedTopRows=this.createNodesFromData(t,!0);var e={type:Zt.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.setPinnedBottomRowData=function(t){this.pinnedBottomRows=this.createNodesFromData(t,!1);var e={type:Zt.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.createNodesFromData=function(t,e){var n=this,o=[];if(t){var r=0;t.forEach((function(t,i){var s=new ks(n.beans);s.data=t;var a=e?ks.ID_PREFIX_TOP_PINNED:ks.ID_PREFIX_BOTTOM_PINNED;s.id=a+i,s.rowPinned=e?"top":"bottom",s.setRowTop(r),s.setRowHeight(n.gridOptionsService.getRowHeightForNode(s).height),s.setRowIndex(i),r+=s.rowHeight,o.push(s)}))}return o},e.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},e.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},e.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},e.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},e.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},e.prototype.getPinnedTopRow=function(t){return this.pinnedTopRows[t]},e.prototype.getPinnedBottomRow=function(t){return this.pinnedBottomRows[t]},e.prototype.forEachPinnedTopRow=function(t){s(this.pinnedTopRows)||this.pinnedTopRows.forEach(t)},e.prototype.forEachPinnedBottomRow=function(t){s(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(t)},e.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},e.prototype.getTotalHeight=function(t){if(!t||0===t.length)return 0;var e=yt(t);return e.rowTop+e.rowHeight},Nh([$("beans")],e.prototype,"beans",void 0),Nh([Z],e.prototype,"init",null),e=Nh([Q("pinnedRowModel")],e)}(Ht);!function(t){t.Applied="Applied",t.StoreNotFound="StoreNotFound",t.StoreLoading="StoreLoading",t.StoreWaitingToLoad="StoreWaitingToLoad",t.StoreLoadingFailed="StoreLoadingFailed",t.StoreWrongType="StoreWrongType",t.Cancelled="Cancelled"}(lh||(lh={}));var kh,Gh=function(){function t(t,e){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=t,this.pathRoot={rowNode:e,children:null},this.mapToItems[e.id]=this.pathRoot}return t.prototype.setInactive=function(){this.active=!1},t.prototype.isActive=function(){return this.active},t.prototype.depthFirstSearchChangedPath=function(t,e){if(t.children)for(var n=0;n<t.children.length;n++)this.depthFirstSearchChangedPath(t.children[n],e);e(t.rowNode)},t.prototype.depthFirstSearchEverything=function(t,e,n){if(t.childrenAfterGroup)for(var o=0;o<t.childrenAfterGroup.length;o++){var r=t.childrenAfterGroup[o];r.childrenAfterGroup?this.depthFirstSearchEverything(t.childrenAfterGroup[o],e,n):n&&e(r)}e(t)},t.prototype.forEachChangedNodeDepthFirst=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1),this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,t):this.depthFirstSearchEverything(this.pathRoot.rowNode,t,e)},t.prototype.executeFromRootNode=function(t){t(this.pathRoot.rowNode)},t.prototype.createPathItems=function(t){for(var e=t,n=0;!this.mapToItems[e.id];){var o={rowNode:e,children:null};this.mapToItems[e.id]=o,n++,e=e.parent}return n},t.prototype.populateColumnsMap=function(t,e){var n=this;if(this.keepingColumns&&e)for(var o=t;o;)this.nodeIdsToColumns[o.id]||(this.nodeIdsToColumns[o.id]={}),e.forEach((function(t){return n.nodeIdsToColumns[o.id][t.getId()]=!0})),o=o.parent},t.prototype.linkPathItems=function(t,e){for(var n=t,o=0;o<e;o++){var r=this.mapToItems[n.id],i=this.mapToItems[n.parent.id];i.children||(i.children=[]),i.children.push(r),n=n.parent}},t.prototype.addParentNode=function(t,e){if(t&&!t.isRowPinned()){var n=this.createPathItems(t);this.linkPathItems(t,n),this.populateColumnsMap(t,e)}},t.prototype.canSkip=function(t){return this.active&&!this.mapToItems[t.id]},t.prototype.getValueColumnsForNode=function(t,e){if(!this.keepingColumns)return e;var n=this.nodeIdsToColumns[t.id];return e.filter((function(t){return n[t.getId()]}))},t.prototype.getNotValueColumnsForNode=function(t,e){if(!this.keepingColumns)return null;var n=this.nodeIdsToColumns[t.id];return e.filter((function(t){return!n[t.getId()]}))},t}(),Bh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Vh=function(t){function e(n){var o=t.call(this)||this;return o.state=e.STATE_WAITING_TO_LOAD,o.version=0,o.id=n,o}return Bh(e,t),e.prototype.getId=function(){return this.id},e.prototype.load=function(){this.state=e.STATE_LOADING,this.loadFromDatasource()},e.prototype.getVersion=function(){return this.version},e.prototype.setStateWaitingToLoad=function(){this.version++,this.state=e.STATE_WAITING_TO_LOAD},e.prototype.getState=function(){return this.state},e.prototype.pageLoadFailed=function(t){this.isRequestMostRecentAndLive(t)&&(this.state=e.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)},e.prototype.success=function(t,e){this.successCommon(t,e)},e.prototype.pageLoaded=function(t,e,n){this.successCommon(t,{rowData:e,rowCount:n})},e.prototype.isRequestMostRecentAndLive=function(t){var e=t===this.version,n=this.isAlive();return e&&n},e.prototype.successCommon=function(t,n){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(t)&&(this.state=e.STATE_LOADED,this.processServerResult(n))},e.prototype.dispatchLoadCompleted=function(t){void 0===t&&(t=!0);var n={type:e.EVENT_LOAD_COMPLETE,success:t,block:this};this.dispatchEvent(n)},e.EVENT_LOAD_COMPLETE="loadComplete",e.STATE_WAITING_TO_LOAD="needsLoading",e.STATE_LOADING="loading",e.STATE_LOADED="loaded",e.STATE_FAILED="failed",e}(Ht),zh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),jh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Hh=function(t,e){return function(n,o){e(n,o,t)}},Uh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeBlockLoadsCount=0,e.blocks=[],e.active=!0,e}var n;return zh(e,t),n=e,e.prototype.postConstruct=function(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();var t=this.gridOptionsService.getNum("blockLoadDebounceMillis");t&&t>0&&(this.checkBlockToLoadDebounce=hr.debounce(this.performCheckBlocksToLoad.bind(this),t))},e.prototype.setBeans=function(t){this.logger=t.create("RowNodeBlockLoader")},e.prototype.getMaxConcurrentDatasourceRequests=function(){var t=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==t?2:t<=0?void 0:t},e.prototype.addBlock=function(t){this.blocks.push(t),t.addEventListener(Vh.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()},e.prototype.removeBlock=function(t){hr.removeFromArray(this.blocks,t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.active=!1},e.prototype.loadComplete=function(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:n.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:n.BLOCK_LOADER_FINISHED_EVENT})},e.prototype.checkBlockToLoad=function(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()},e.prototype.performCheckBlocksToLoad=function(){if(this.active)if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)this.logger.log("checkBlockToLoad: max loads exceeded");else{var t=this.getAvailableLoadingCount(),e=this.blocks.filter((function(t){return t.getState()===Vh.STATE_WAITING_TO_LOAD})).slice(0,t);this.registerLoads(e.length),e.forEach((function(t){return t.load()})),this.printCacheStatus()}},e.prototype.getBlockState=function(){if(this.gridOptionsService.isRowModelType("serverSide"))return this.rowModel.getBlockStates();var t={};return this.blocks.forEach((function(e){var n=e.getBlockStateJson(),o=n.id,r=n.state;t[o]=r})),t},e.prototype.printCacheStatus=function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = "+this.activeBlockLoadsCount+", blocks = "+JSON.stringify(this.getBlockState()))},e.prototype.isLoading=function(){return this.activeBlockLoadsCount>0},e.prototype.registerLoads=function(t){this.activeBlockLoadsCount+=t},e.prototype.getAvailableLoadingCount=function(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0},e.BLOCK_LOADED_EVENT="blockLoaded",e.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",jh([$("rowModel")],e.prototype,"rowModel",void 0),jh([Z],e.prototype,"postConstruct",null),jh([Hh(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=n=jh([Q("rowNodeBlockLoader")],e)}(Ht),Wh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Xh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentPage=0,e.topDisplayedRowIndex=0,e.bottomDisplayedRowIndex=0,e.pixelOffset=0,e.masterRowCount=0,e}return Wh(e,t),e.prototype.postConstruct=function(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,Zt.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()},e.prototype.ensureRowHeightsValid=function(t,e,n,o){var r=this.rowModel.ensureRowHeightsValid(t,e,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r},e.prototype.isPaginateChildRows=function(){return!(!this.gridOptionsService.is("groupRemoveSingleChildren")&&!this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")},e.prototype.onModelUpdated=function(t){this.calculatePages();var e={type:Zt.EVENT_PAGINATION_CHANGED,animate:!!t&&t.animate,newData:!!t&&t.newData,newPage:!!t&&t.newPage,keepRenderedRows:!!t&&t.keepRenderedRows};this.eventService.dispatchEvent(e)},e.prototype.onPaginationPageSizeChanged=function(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();var t={type:Zt.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(t)},e.prototype.goToPage=function(t){if(this.active&&this.currentPage!==t&&"number"===typeof this.currentPage){this.currentPage=t;var e={type:Zt.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(e)}},e.prototype.getPixelOffset=function(){return this.pixelOffset},e.prototype.getRow=function(t){return this.rowModel.getRow(t)},e.prototype.getRowNode=function(t){return this.rowModel.getRowNode(t)},e.prototype.getRowIndexAtPixel=function(t){return this.rowModel.getRowIndexAtPixel(t)},e.prototype.getCurrentPageHeight=function(){return i(this.topRowBounds)||i(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)},e.prototype.getCurrentPagePixelRange=function(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}},e.prototype.isRowPresent=function(t){return!!this.rowModel.isRowPresent(t)&&(t.rowIndex>=this.topDisplayedRowIndex&&t.rowIndex<=this.bottomDisplayedRowIndex)},e.prototype.isEmpty=function(){return this.rowModel.isEmpty()},e.prototype.isRowsToRender=function(){return this.rowModel.isRowsToRender()},e.prototype.forEachNode=function(t){return this.rowModel.forEachNode(t)},e.prototype.forEachNodeOnPage=function(t){for(var e=this.getPageFirstRow(),n=this.getPageLastRow(),o=e;o<=n;o++){var r=this.getRow(o);r&&t(r)}},e.prototype.getType=function(){return this.rowModel.getType()},e.prototype.getRowBounds=function(t){var e=this.rowModel.getRowBounds(t);return e.rowIndex=t,e},e.prototype.getPageFirstRow=function(){return this.topRowBounds?this.topRowBounds.rowIndex:-1},e.prototype.getPageLastRow=function(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1},e.prototype.getRowCount=function(){return this.rowModel.getRowCount()},e.prototype.getPageForIndex=function(t){return Math.floor(t/this.pageSize)},e.prototype.goToPageWithIndex=function(t){if(this.active){var e=this.getPageForIndex(t);this.goToPage(e)}},e.prototype.isRowInPage=function(t){return!this.active||this.getPageForIndex(t.rowIndex)===this.currentPage},e.prototype.isLastPageFound=function(){return this.rowModel.isLastRowIndexKnown()},e.prototype.getCurrentPage=function(){return this.currentPage},e.prototype.goToNextPage=function(){this.goToPage(this.currentPage+1)},e.prototype.goToPreviousPage=function(){this.goToPage(this.currentPage-1)},e.prototype.goToFirstPage=function(){this.goToPage(0)},e.prototype.goToLastPage=function(){var t=this.rowModel.getRowCount(),e=Math.floor(t/this.pageSize);this.goToPage(e)},e.prototype.getPageSize=function(){return this.pageSize},e.prototype.getTotalPages=function(){return this.totalPages},e.prototype.setPageSize=function(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)},e.prototype.calculatePages=function(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(r(this.topRowBounds)?this.topRowBounds.rowTop:0)},e.prototype.setPixelOffset=function(t){this.pixelOffset!==t&&(this.pixelOffset=t,this.eventService.dispatchEvent({type:Zt.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))},e.prototype.setZeroRows=function(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0},e.prototype.adjustCurrentPageIfInvalid=function(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)},e.prototype.calculatePagesMasterRowsOnly=function(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)this.setZeroRows();else{var t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.adjustCurrentPageIfInvalid();var e=this.pageSize*this.currentPage,n=this.pageSize*(this.currentPage+1)-1;if(n>t&&(n=t),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(e),n===t)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{var o=this.rowModel.getTopLevelRowDisplayedIndex(n+1);this.bottomDisplayedRowIndex=o-1}}},e.prototype.getMasterRowCount=function(){return this.masterRowCount},e.prototype.calculatePagesAllRows=function(){if(this.masterRowCount=this.rowModel.getRowCount(),0!==this.masterRowCount){var t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>t&&(this.bottomDisplayedRowIndex=t)}else this.setZeroRows()},e.prototype.calculatedPagesNotActive=function(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1},qh([$("rowModel")],e.prototype,"rowModel",void 0),qh([Z],e.prototype,"postConstruct",null),e=qh([Q("paginationProxy")],e)}(Ht),Yh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kh=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yh(e,t),e.prototype.processAllCellClasses=function(t,e,n,o){this.processClassRules(t.cellClassRules,e,n,o),this.processStaticCellClasses(t,e,n)},e.prototype.processClassRules=function(t,e,n,o){if(null!=t){for(var r=Object.keys(t),i={},s={},a=function(n){var o,a=r[n],u=t[a];"string"===typeof u?o=l.expressionService.evaluate(u,e):"function"===typeof u&&(o=u(e)),a.split(" ").forEach((function(t){null!=t&&""!=t.trim()&&(o?i[t]=!0:s[t]=!0)}))},l=this,u=0;u<r.length;u++)a(u);o&&Object.keys(s).forEach(o),Object.keys(i).forEach(n)}},e.prototype.getStaticCellClasses=function(t,e){var n,o=t.cellClass;if(!o)return[];"function"===typeof o?n=o(e):n=o;return"string"===typeof n&&(n=[n]),n||[]},e.prototype.processStaticCellClasses=function(t,e,n){this.getStaticCellClasses(t,e).forEach((function(t){n(t)}))},Kh([$("expressionService")],e.prototype,"expressionService",void 0),e=Kh([Q("stylingService")],e)}(Ht),Jh=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qh=function(t){function e(e){return t.call(this,e,"ag-toggle-button")||this}return Jh(e,t),e.prototype.setValue=function(e,n){return t.prototype.setValue.call(this,e,n),this.addOrRemoveCssClass("ag-selected",this.getValue()),this},e}(hi),$h=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),td=function(t){function e(e){return t.call(this,e,"ag-text-area",null,"textarea")||this}return $h(e,t),e.prototype.setValue=function(e,n){var o=t.prototype.setValue.call(this,e,n);return this.eInput.value=e,o},e.prototype.setCols=function(t){return this.eInput.cols=t,this},e.prototype.setRows=function(t){return this.eInput.rows=t,this},e}(ci),ed=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nd=function(t){function e(e){return t.call(this,e,"ag-date-field","date")||this}return ed(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));var n=Ln();this.addManagedListener(this.eInput,"mousedown",(function(){e.isDisabled()||n||e.eInput.focus()})),this.eInput.step="any"},e.prototype.onWheel=function(t){document.activeElement===this.eInput&&t.preventDefault()},e.prototype.setMin=function(t){var e,n=t instanceof Date?null!==(e=to(null!==t&&void 0!==t?t:null,!1))&&void 0!==e?e:void 0:t;return this.min===n||(this.min=n,Uo(this.eInput,"min",n)),this},e.prototype.setMax=function(t){var e,n=t instanceof Date?null!==(e=to(null!==t&&void 0!==t?t:null,!1))&&void 0!==e?e:void 0:t;return this.max===n||(this.max=n,Uo(this.eInput,"max",n)),this},e.prototype.setStep=function(t){return this.step===t||(this.step=t,Uo(this.eInput,"step",t)),this},e.prototype.getDate=function(){var t;if(this.eInput.validity.valid)return null!==(t=oo(this.getValue()))&&void 0!==t?t:void 0},e.prototype.setDate=function(t,e){this.setValue(to(null!==t&&void 0!==t?t:null,!1),e)},e}(ki),od=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rd=function(t){function e(e){return t.call(this,e,"ag-range-field","range")||this}return od(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this);var e=this.config,n=e.min,o=e.max,r=e.step;null!=n&&this.setMinValue(n),null!=o&&this.setMaxValue(o),this.setStep(r||1)},e.prototype.addInputListeners=function(){var t=this;this.addManagedListener(this.eInput,"input",(function(e){var n=e.target.value;t.setValue(n)}))},e.prototype.setMinValue=function(t){return this.min=t,this.eInput.setAttribute("min",t.toString()),this},e.prototype.setMaxValue=function(t){return this.max=t,this.eInput.setAttribute("max",t.toString()),this},e.prototype.setStep=function(t){return this.eInput.setAttribute("step",t.toString()),this},e.prototype.setValue=function(e,n){null!=this.min&&(e=Math.max(parseFloat(e),this.min).toString()),null!=this.max&&(e=Math.min(parseFloat(e),this.max).toString());var o=t.prototype.setValue.call(this,e,n);return this.eInput.value=e,o},e}(ci),id=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),sd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ad=function(t){function e(e,n){var o=t.call(this,'<div class="ag-rich-select-row" role="presentation"></div>')||this;return o.params=e,o.wrapperEl=n,o}return id(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.getGui(),"mouseup",this.onMouseUp.bind(this))},e.prototype.setState=function(t,e){var n="";this.params.valueFormatter&&(n=this.params.valueFormatter(t)),this.populateWithRenderer(t,n)||this.populateWithoutRenderer(t,n),this.value=t},e.prototype.updateHighlighted=function(t){var e,n=this.getGui(),o="ag-rich-select-row-"+this.getCompId();(null===(e=n.parentElement)||void 0===e||e.setAttribute("id",o),t)&&(this.getParentComponent().getAriaElement().setAttribute("aria-activedescendant",o),this.wrapperEl.setAttribute("data-active-option",o));wn(n.parentElement,t),this.addOrRemoveCssClass("ag-rich-select-row-selected",t)},e.prototype.populateWithoutRenderer=function(t,e){var n=this.gridOptionsService.getDocument(),o=this.getGui(),i=n.createElement("span");i.style.overflow="hidden",i.style.textOverflow="ellipsis";var s=re(r(e)?e:t);i.textContent=r(s)?s:"&nbsp;",o.appendChild(i)},e.prototype.populateWithRenderer=function(t,e){var n,o,r=this;return this.params.cellRenderer&&(o=this.userComponentFactory.getCellRendererDetails(this.params,{value:t,valueFormatted:e,api:this.gridOptionsService.api})),o&&(n=o.newAgStackInstance()),n&&qo(n,this.getGui()),!!n&&(n.then((function(t){r.addDestroyFunc((function(){r.getContext().destroyBean(t)}))})),!0)},e.prototype.onMouseUp=function(){var t=this.getParentComponent(),e={type:Zt.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};null===t||void 0===t||t.dispatchEvent(e)},sd([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),sd([Z],e.prototype,"postConstruct",null),e}(Tr),ld=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ud=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},cd=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},pd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ld(e,t),e.prototype.initialiseTabGuard=function(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();var e=[this.eTopGuard,this.eBottomGuard],n={setTabIndex:function(t){e.forEach((function(e){return null!=t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new hp({comp:n,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:t.onFocusIn,onFocusOut:t.onFocusOut,focusInnerElement:t.focusInnerElement,handleKeyDown:t.handleKeyDown,onTabKeyDown:t.onTabKeyDown,shouldStopEventPropagation:t.shouldStopEventPropagation}))},e.prototype.createTabGuard=function(t){var e=document.createElement("div"),n="top"===t?jc.TAB_GUARD_TOP:jc.TAB_GUARD_BOTTOM;return e.classList.add(jc.TAB_GUARD,n),Ze(e,"presentation"),e},e.prototype.addTabGuards=function(t,e){this.eFocusableElement.insertAdjacentElement("afterbegin",t),this.eFocusableElement.insertAdjacentElement("beforeend",e)},e.prototype.removeAllChildrenExceptTabGuards=function(){var t=[this.eTopGuard,this.eBottomGuard];So(this.getFocusableElement()),this.addTabGuards.apply(this,cd([],ud(t)))},e.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1),this.tabGuardCtrl.forceFocusOutOfContainer(t)},e.prototype.appendChild=function(e,n){zo(e)||(e=e.getGui());var o=this.eBottomGuard;o?o.insertAdjacentElement("beforebegin",e):t.prototype.appendChild.call(this,e,n)},e}(Tr),hd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},fd=function(t){function e(n){var o=t.call(this,e.getTemplate((null===n||void 0===n?void 0:n.cssIdentifier)||"default"))||this;o.renderedRows=new Map,o.rowHeight=20;var r=n||{},i=r.cssIdentifier,s=void 0===i?"default":i,a=r.ariaRole,l=void 0===a?"listbox":a,u=r.listName;return o.cssIdentifier=s,o.ariaRole=l,o.listName=u,o}return hd(e,t),e.prototype.postConstruct=function(){var t=this;this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:function(e){return t.onFocusIn(e)},onFocusOut:function(e){return t.onFocusOut(e)},focusInnerElement:function(e){return t.focusInnerElement(e)},onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)}}),this.setAriaProperties(),this.addManagedListener(this.eventService,Zt.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))},e.prototype.onGridStylesChanged=function(){this.rowHeight=this.getItemHeight(),this.refresh()},e.prototype.setAriaProperties=function(){var t=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),e=this.eContainer;Ze(e,this.ariaRole),tn(e,t)},e.prototype.addResizeObserver=function(){var t=this,e=this.resizeObserverService.observeResize(this.getGui(),(function(){return t.drawVirtualRows()}));this.addDestroyFunc(e)},e.prototype.focusInnerElement=function(t){this.focusRow(t?this.model.getRowCount()-1:0)},e.prototype.onFocusIn=function(t){var e=t.target;return e.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=$e(e)-1),!1},e.prototype.onFocusOut=function(t){return this.getFocusableElement().contains(t.relatedTarget)||(this.lastFocusedRowIndex=null),!1},e.prototype.handleKeyDown=function(t){switch(t.key){case Qo.UP:case Qo.DOWN:this.navigate(t.key===Qo.UP)&&t.preventDefault()}},e.prototype.onTabKeyDown=function(t){this.navigate(t.shiftKey)?t.preventDefault():(Mt(t),this.forceFocusOutOfContainer(t.shiftKey))},e.prototype.navigate=function(t){if(null==this.lastFocusedRowIndex)return!1;var e=this.lastFocusedRowIndex+(t?-1:1);return!(e<0||e>=this.model.getRowCount())&&(this.focusRow(e),!0)},e.prototype.getLastFocusedRow=function(){return this.lastFocusedRowIndex},e.prototype.focusRow=function(t){var e=this;this.ensureIndexVisible(t),window.setTimeout((function(){if(e.isAlive()){var n=e.renderedRows.get(t);n&&n.eDiv.focus()}}),10)},e.prototype.getComponentAt=function(t){var e=this.renderedRows.get(t);return e&&e.rowComponent},e.prototype.forEachRenderedRow=function(t){this.renderedRows.forEach((function(e,n){return t(e.rowComponent,n)}))},e.getTemplate=function(t){return'<div class="ag-virtual-list-viewport ag-'+t+'-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-'+t+'-virtual-list-container" ref="eContainer"></div>\n            </div>'},e.prototype.getItemHeight=function(){return this.environment.getListItemHeight()},e.prototype.ensureIndexVisible=function(t){var e=this.model.getRowCount();if("number"!==typeof t||t<0||t>=e)console.warn("AG Grid: invalid row index for ensureIndexVisible: "+t);else{var n=t*this.rowHeight,o=n+this.rowHeight,r=this.getGui(),i=r.scrollTop,s=r.offsetHeight,a=i+s<o;if(i>n)r.scrollTop=n;else if(a){var l=o-s;r.scrollTop=l}}},e.prototype.setComponentCreator=function(t){this.componentCreator=t},e.prototype.setComponentUpdater=function(t){this.componentUpdater=t},e.prototype.getRowHeight=function(){return this.rowHeight},e.prototype.getScrollTop=function(){return this.getGui().scrollTop},e.prototype.setRowHeight=function(t){this.rowHeight=t,this.refresh()},e.prototype.refresh=function(t){var e=this;if(null!=this.model&&this.isAlive()){var n=this.model.getRowCount();this.eContainer.style.height=n*this.rowHeight+"px",B((function(){return e.eContainer.clientHeight>=n*e.rowHeight}),(function(){e.isAlive()&&(e.canSoftRefresh(t)?e.drawVirtualRows(!0):(e.clearVirtualRows(),e.drawVirtualRows()))}))}},e.prototype.canSoftRefresh=function(t){return!!(t&&this.renderedRows.size&&"function"===typeof this.model.areRowsEqual&&this.componentUpdater)},e.prototype.clearVirtualRows=function(){var t=this;this.renderedRows.forEach((function(e,n){return t.removeRow(n)}))},e.prototype.drawVirtualRows=function(t){if(this.isAlive()&&this.model){var e=this.getGui(),n=e.scrollTop,o=n+e.offsetHeight,r=Math.floor(n/this.rowHeight),i=Math.floor(o/this.rowHeight);this.ensureRowsRendered(r,i,t)}},e.prototype.ensureRowsRendered=function(t,e,n){var o=this;this.renderedRows.forEach((function(n,r){(r<t||r>e)&&r!==o.lastFocusedRowIndex&&o.removeRow(r)})),n&&this.refreshRows();for(var r=t;r<=e;r++)this.renderedRows.has(r)||r<this.model.getRowCount()&&this.insertRow(r)},e.prototype.insertRow=function(t){var e=this,n=this.model.getRow(t),o=document.createElement("div");if(o.classList.add("ag-virtual-list-item","ag-"+this.cssIdentifier+"-virtual-list-item"),Ze(o,"tree"===this.ariaRole?"treeitem":"option"),pn(o,this.model.getRowCount()),hn(o,t+1),o.setAttribute("tabindex","-1"),"function"===typeof this.model.isRowSelected){var r=this.model.isRowSelected(t);wn(o,!!r),bn(o,r)}o.style.height=this.rowHeight+"px",o.style.top=this.rowHeight*t+"px";var i=this.componentCreator(n,o);i.addGuiEventListener("focusin",(function(){return e.lastFocusedRowIndex=t})),o.appendChild(i.getGui()),this.renderedRows.has(t-1)?this.renderedRows.get(t-1).eDiv.insertAdjacentElement("afterend",o):this.renderedRows.has(t+1)?this.renderedRows.get(t+1).eDiv.insertAdjacentElement("beforebegin",o):this.eContainer.appendChild(o),this.renderedRows.set(t,{rowComponent:i,eDiv:o,value:n})},e.prototype.removeRow=function(t){var e=this.renderedRows.get(t);this.eContainer.removeChild(e.eDiv),this.destroyBean(e.rowComponent),this.renderedRows.delete(t)},e.prototype.refreshRows=function(){var t=this,e=this.model.getRowCount();this.renderedRows.forEach((function(n,o){var r,i;if(o>=e)t.removeRow(o);else{var s=t.model.getRow(o);(null===(i=(r=t.model).areRowsEqual)||void 0===i?void 0:i.call(r,n.value,s))?t.componentUpdater(s,n.rowComponent):t.removeRow(o)}}))},e.prototype.addScrollListener=function(){var t=this;this.addGuiEventListener("scroll",(function(){return t.drawVirtualRows()}),{passive:!0})},e.prototype.setModel=function(t){this.model=t},e.prototype.getAriaElement=function(){return this.eContainer},e.prototype.destroy=function(){this.isAlive()&&(this.clearVirtualRows(),t.prototype.destroy.call(this))},dd([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),dd([Or("eContainer")],e.prototype,"eContainer",void 0),dd([Z],e.prototype,"postConstruct",null),e}(pd),gd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),md=function(){return md=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},md.apply(this,arguments)},yd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},vd=function(t){function e(e){var n=t.call(this,md({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list"},e),"ag-rich-select","smallDown","combobox")||this;n.searchString="",n.highlightedItem=-1;var o=e||{},r=o.cellRowHeight,i=o.value,s=o.valueList,a=o.searchDebounceDelay;return r&&(n.cellRowHeight=r),null!=i&&(n.value=i),null!=s&&n.setValueList(s),null!=a&&(n.searchDebounceDelay=a),n}return gd(e,t),e.prototype.postConstruct=function(){var e,n;t.prototype.postConstruct.call(this),this.createListComponent(),this.eWrapper.tabIndex=null!==(e=this.gridOptionsService.getNum("tabIndex"))&&void 0!==e?e:0,this.eWrapper.classList.add("ag-rich-select-value");var o=null!==(n=this.searchDebounceDelay)&&void 0!==n?n:300;this.clearSearchString=k(this.clearSearchString,o),this.renderSelectedValue()},e.prototype.createListComponent=function(){var t=this;this.listComponent=this.createManagedBean(new fd({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this)),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,Zt.EVENT_FIELD_PICKER_VALUE_SELECTED,(function(e){t.onListValueSelected(e.value,e.fromEnterKey)})),this.cellRowHeight&&this.listComponent.setRowHeight(this.cellRowHeight);var e=this.listComponent.getGui(),n=this.listComponent.getAriaElement();this.addManagedListener(e,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(e,"mousedown",(function(t){return t.preventDefault()})),e.classList.add("ag-rich-select-list");var o="ag-rich-select-list-"+this.listComponent.getCompId();n.setAttribute("id",o),xn(this.eWrapper,n)},e.prototype.renderSelectedValue=function(){var t,e,n=this,o=this,i=o.value,s=o.eDisplayField,a=o.config,l=this.config.valueFormatter?this.config.valueFormatter(i):i;a.cellRenderer&&(t=this.userComponentFactory.getCellRendererDetails(this.config,{value:i,valueFormatted:l,api:this.gridOptionsService.api})),t&&(e=t.newAgStackInstance()),e?(So(s),qo(e,s),e.then((function(t){n.addDestroyFunc((function(){return n.getContext().destroyBean(t)}))}))):r(this.value)?s.innerText=l:So(s)},e.prototype.setValueList=function(t){this.values=t,this.highlightSelectedValue()},e.prototype.getCurrentValueIndex=function(){var t=this.values,e=this.value;if(null==e)return-1;for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},e.prototype.highlightSelectedValue=function(t){var e=this;null==t&&(t=this.getCurrentValueIndex()),-1!==t&&(this.highlightedItem=t,this.listComponent&&this.listComponent.forEachRenderedRow((function(t,n){t.updateHighlighted(e.highlightedItem===n)})))},e.prototype.setRowHeight=function(t){t!==this.cellRowHeight&&(this.cellRowHeight=t),this.listComponent&&this.listComponent.setRowHeight(t)},e.prototype.createPickerComponent=function(){var t=this.values;return this.listComponent.setModel({getRowCount:function(){return t.length},getRow:function(e){return t[e]}}),this.listComponent},e.prototype.showPicker=function(){var e,n,o;t.prototype.showPicker.call(this);var r=this.getCurrentValueIndex();-1!==r?(null===(e=this.listComponent)||void 0===e||e.refresh(),null===(n=this.listComponent)||void 0===n||n.ensureIndexVisible(r),this.highlightSelectedValue(r)):null===(o=this.listComponent)||void 0===o||o.refresh()},e.prototype.beforeHidePicker=function(){this.highlightedItem=-1,t.prototype.beforeHidePicker.call(this)},e.prototype.searchText=function(t){if("string"!==typeof t){var e=t.key;if(e===Qo.BACKSPACE)this.searchString=this.searchString.slice(0,-1),e="";else if(!$o(t))return;return t.preventDefault(),void this.searchText(e)}this.searchString+=t,this.runSearch(),this.clearSearchString()},e.prototype.runSearch=function(){var t,e=this.values,n=this.config,o=n.valueFormatter,r=void 0===o?function(t){return t}:o,i=n.searchStringCreator;if("number"===typeof e[0]||"string"===typeof e[0]?t=e.map((function(t){return r(t)})):"object"===typeof e[0]&&i&&(t=i(e)),t){var s=_e(this.searchString,t,!0)[0];if(s){var a=t.indexOf(s);this.selectListItem(a)}}},e.prototype.clearSearchString=function(){this.searchString=""},e.prototype.selectListItem=function(t){!this.isPickerDisplayed||!this.listComponent||t<0||t>=this.values.length||(this.listComponent.ensureIndexVisible(t),this.highlightSelectedValue(t))},e.prototype.setValue=function(e,n,o){var r=this.values.indexOf(e);return-1===r?this:(this.value=e,o||this.selectListItem(r),this.renderSelectedValue(),t.prototype.setValue.call(this,e,n))},e.prototype.createRowComponent=function(t){var e=new ad(this.config,this.eWrapper);return e.setParentComponent(this.listComponent),this.getContext().createBean(e),e.setState(t,t===this.value),e},e.prototype.getRowForMouseEvent=function(t){var e=this.listComponent;if(!e)return-1;var n=(null===e||void 0===e?void 0:e.getGui()).getBoundingClientRect(),o=e.getScrollTop(),r=t.clientY-n.top+o;return Math.floor(r/e.getRowHeight())},e.prototype.onPickerMouseMove=function(t){if(this.listComponent){var e=this.getRowForMouseEvent(t);-1!==e&&this.selectListItem(e)}},e.prototype.onNavigationKeyDown=function(t,e){t.preventDefault();var n=e===Qo.DOWN;if(this.isPickerDisplayed||!n){var o=this.highlightedItem,r=-1===o?0:o+(n?1:-1);this.selectListItem(r)}else this.showPicker()},e.prototype.onEnterKeyDown=function(t){this.isPickerDisplayed&&(t.preventDefault(),this.onListValueSelected(this.values[this.highlightedItem],!0))},e.prototype.onListValueSelected=function(t,e){this.setValue(t,!1,!0),this.dispatchPickerEvent(t,e),this.hidePicker()},e.prototype.dispatchPickerEvent=function(t,e){var n={type:Zt.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:e,value:t};this.dispatchEvent(n)},e.prototype.onKeyDown=function(t){var e=t.key;switch(e){case Qo.LEFT:case Qo.RIGHT:t.preventDefault();break;case Qo.DOWN:case Qo.UP:this.onNavigationKeyDown(t,e);break;case Qo.ESCAPE:this.isPickerDisplayed&&this.hidePicker();break;case Qo.ENTER:this.onEnterKeyDown(t);break;default:this.searchText(t)}},yd([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),e}(ei),_d=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Cd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},wd=function(t){function e(n){var o=t.call(this,n,e.TEMPLATE)||this;return o.labelAlignment="top",o}return _d(e,t),e.prototype.init=function(){this.eSlider.addCssClass("ag-slider-field")},e.prototype.onValueChange=function(t){var e=this,n=Zt.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,n,(function(){var n=parseFloat(e.eText.getValue());e.eSlider.setValue(n.toString(),!0),t(n||0)})),this.addManagedListener(this.eSlider,n,(function(){var n=e.eSlider.getValue();e.eText.setValue(n,!0),t(parseFloat(n))})),this},e.prototype.setSliderWidth=function(t){return this.eSlider.setWidth(t),this},e.prototype.setTextFieldWidth=function(t){return this.eText.setWidth(t),this},e.prototype.setMinValue=function(t){return this.eSlider.setMinValue(t),this.eText.setMin(t),this},e.prototype.setMaxValue=function(t){return this.eSlider.setMaxValue(t),this.eText.setMax(t),this},e.prototype.getValue=function(){return this.eText.getValue()},e.prototype.setValue=function(t){return this.getValue()===t||(this.eText.setValue(t,!0),this.eSlider.setValue(t,!0),this.dispatchEvent({type:Zt.EVENT_FIELD_VALUE_CHANGED})),this},e.prototype.setStep=function(t){return this.eSlider.setStep(t),this.eText.setStep(t),this},e.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',Cd([Or("eLabel")],e.prototype,"eLabel",void 0),Cd([Or("eSlider")],e.prototype,"eSlider",void 0),Cd([Or("eText")],e.prototype,"eText",void 0),Cd([Z],e.prototype,"init",null),e}(Zr),bd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ed=function(t){function e(n){void 0===n&&(n={});var o=t.call(this,e.getTemplate(n))||this;o.suppressEnabledCheckbox=!0,o.suppressOpenCloseIcons=!1;var r=n.title,i=n.enabled,s=n.items,a=n.suppressEnabledCheckbox,l=n.suppressOpenCloseIcons;return o.title=r,o.cssIdentifier=n.cssIdentifier||"default",o.enabled=null==i||i,o.items=s||[],o.alignItems=n.alignItems||"center",null!=a&&(o.suppressEnabledCheckbox=a),null!=l&&(o.suppressOpenCloseIcons=l),o}return bd(e,t),e.getTemplate=function(t){var e=t.cssIdentifier||"default";return'<div class="ag-group ag-'+e+'-group" role="presentation">\n            <div class="ag-group-title-bar ag-'+e+'-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-'+e+'-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-'+e+'-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-'+e+'-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-'+e+'-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-'+(t.direction||"vertical")+" ag-"+e+'-group-container"></div>\n        </div>'},e.prototype.postConstruct=function(){if(this.items.length){var t=this.items;this.items=[],this.addItems(t)}var e=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(e("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()},e.prototype.setupExpandContract=function(){var t=this;this.eGroupClosedIcon.appendChild(Ko("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(Ko("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",(function(){return t.toggleGroupExpand()})),this.addManagedListener(this.eTitleBar,"keydown",(function(e){switch(e.key){case Qo.ENTER:case Qo.SPACE:e.preventDefault(),t.toggleGroupExpand();break;case Qo.RIGHT:case Qo.LEFT:e.preventDefault(),t.toggleGroupExpand(e.key===Qo.RIGHT)}}))},e.prototype.refreshAriaStatus=function(){this.suppressOpenCloseIcons||un(this.eTitleBar,this.expanded)},e.prototype.refreshChildDisplay=function(){var t=!this.suppressOpenCloseIcons;po(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),po(this.eGroupOpenedIcon,t&&this.expanded),po(this.eGroupClosedIcon,t&&!this.expanded)},e.prototype.isExpanded=function(){return this.expanded},e.prototype.setAlignItems=function(t){this.alignItems!==t&&this.removeCssClass("ag-group-item-alignment-"+this.alignItems),this.alignItems=t;var e="ag-group-item-alignment-"+this.alignItems;return this.addCssClass(e),this},e.prototype.toggleGroupExpand=function(t){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),po(this.eContainer,!0),this):(t=null!=t?t:!this.expanded,this.expanded===t||(this.expanded=t,this.refreshAriaStatus(),this.refreshChildDisplay(),po(this.eContainer,t),this.dispatchEvent({type:this.expanded?e.EVENT_EXPANDED:e.EVENT_COLLAPSED})),this)},e.prototype.addItems=function(t){var e=this;t.forEach((function(t){return e.addItem(t)}))},e.prototype.addItem=function(t){var e=this.eContainer,n=t instanceof Tr?t.getGui():t;n.classList.add("ag-group-item","ag-"+this.cssIdentifier+"-group-item"),e.appendChild(n),this.items.push(n)},e.prototype.hideItem=function(t,e){po(this.items[e],!t)},e.prototype.setTitle=function(t){return this.eTitle.innerText=t,this},e.prototype.addCssClassToTitleBar=function(t){this.eTitleBar.classList.add(t)},e.prototype.setEnabled=function(t,e){return this.enabled=t,this.refreshDisabledStyles(),this.toggleGroupExpand(t),e||this.cbGroupEnabled.setValue(t),this},e.prototype.isEnabled=function(){return this.enabled},e.prototype.onEnableChange=function(t){var e=this;return this.cbGroupEnabled.onValueChange((function(n){e.setEnabled(n,!0),t(n)})),this},e.prototype.hideEnabledCheckbox=function(t){return this.suppressEnabledCheckbox=t,this.refreshChildDisplay(),this.refreshDisabledStyles(),this},e.prototype.hideOpenCloseIcons=function(t){return this.suppressOpenCloseIcons=t,t&&this.toggleGroupExpand(!0),this},e.prototype.refreshDisabledStyles=function(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)},e.EVENT_EXPANDED="expanded",e.EVENT_COLLAPSED="collapsed",xd([Or("eTitleBar")],e.prototype,"eTitleBar",void 0),xd([Or("eGroupOpenedIcon")],e.prototype,"eGroupOpenedIcon",void 0),xd([Or("eGroupClosedIcon")],e.prototype,"eGroupClosedIcon",void 0),xd([Or("eToolbar")],e.prototype,"eToolbar",void 0),xd([Or("cbGroupEnabled")],e.prototype,"cbGroupEnabled",void 0),xd([Or("eTitle")],e.prototype,"eTitle",void 0),xd([Or("eContainer")],e.prototype,"eContainer",void 0),xd([Z],e.prototype,"postConstruct",null),e}(Tr),Sd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Td=function(){return Td=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Td.apply(this,arguments)},Rd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Od=function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,'<div class="ag-menu-list" role="tree"></div>')||this;return n.level=e,n.menuItems=[],n}return Sd(e,t),e.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)}})},e.prototype.onTabKeyDown=function(t){var e=this.getParentComponent(),n=e&&e.getGui();n&&n.classList.contains("ag-focus-managed")||t.preventDefault(),t.shiftKey&&this.closeIfIsChild(t)},e.prototype.handleKeyDown=function(t){switch(t.key){case Qo.UP:case Qo.RIGHT:case Qo.DOWN:case Qo.LEFT:t.preventDefault(),this.handleNavKey(t.key);break;case Qo.ESCAPE:var e=this.findTopMenu();e&&this.focusService.focusInto(e.getGui())}},e.prototype.clearActiveItem=function(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)},e.prototype.addMenuItems=function(t){var e=this;null!=t&&t.forEach((function(t){"separator"===t?e.addSeparator():"string"===typeof t?console.warn("AG Grid: unrecognised menu item "+t):e.addItem(t)}))},e.prototype.addItem=function(t){var e=this,n=this.createManagedBean(new Ld(Td(Td({},t),{isAnotherSubMenuOpen:function(){return e.menuItems.some((function(t){return t.isSubMenuOpen()}))}})));n.setParentComponent(this),sn(n.getGui(),this.level),this.menuItems.push(n),this.appendChild(n.getGui()),this.addManagedListener(n,Ld.EVENT_MENU_ITEM_SELECTED,(function(t){e.dispatchEvent(t)})),this.addManagedListener(n,Ld.EVENT_MENU_ITEM_ACTIVATED,(function(t){e.activeMenuItem&&e.activeMenuItem!==t.menuItem&&e.activeMenuItem.deactivate(),e.activeMenuItem=t.menuItem}))},e.prototype.activateFirstItem=function(){var t=this.menuItems.filter((function(t){return!t.isDisabled()}))[0];t&&t.activate()},e.prototype.addSeparator=function(){this.appendChild(Oo('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))},e.prototype.findTopMenu=function(){var t=this.getParentComponent();if(!t&&this instanceof e)return this;for(;;){var n=t&&t.getParentComponent&&t.getParentComponent();if(!n||!(n instanceof e||n instanceof Ld))break;t=n}return t instanceof e?t:void 0},e.prototype.handleNavKey=function(t){switch(t){case Qo.UP:case Qo.DOWN:var e=this.findNextItem(t===Qo.UP);return void(e&&e!==this.activeMenuItem&&e.activate())}t===(this.gridOptionsService.is("enableRtl")?Qo.RIGHT:Qo.LEFT)?this.closeIfIsChild():this.openChild()},e.prototype.closeIfIsChild=function(t){var e=this.getParentComponent();e&&e instanceof Ld&&(t&&t.preventDefault(),e.closeSubMenu(),e.getGui().focus())},e.prototype.openChild=function(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)},e.prototype.findNextItem=function(t){var e=this.menuItems.filter((function(t){return!t.isDisabled()}));if(e.length){if(!this.activeMenuItem)return t?yt(e):e[0];var n;t&&e.reverse();for(var o=!1,r=0;r<e.length;r++){var i=e[r];if(o){n=i;break}i===this.activeMenuItem&&(o=!0)}return n||this.activeMenuItem}},e.prototype.destroy=function(){this.clearActiveItem(),t.prototype.destroy.call(this)},Rd([$("focusService")],e.prototype,"focusService",void 0),Rd([Z],e.prototype,"postConstruct",null),e}(pd),Pd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Id=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ad=function(t){function e(e){var n=t.call(this)||this;return n.wrappedComponent=e,n.setTemplateFromElement(e.getGui()),n}return Pd(e,t),e.prototype.postConstruct=function(){var t=this;this.initialiseTabGuard({onTabKeyDown:function(e){return t.onTabKeyDown(e)},handleKeyDown:function(e){return t.handleKeyDown(e)}})},e.prototype.handleKeyDown=function(t){t.key===Qo.ESCAPE&&this.closePanel()},e.prototype.onTabKeyDown=function(t){t.defaultPrevented||(this.closePanel(),t.preventDefault())},e.prototype.closePanel=function(){var t=this.parentComponent;t.closeSubMenu(),setTimeout((function(){return t.getGui().focus()}),0)},Id([Z],e.prototype,"postConstruct",null),e}(pd),Dd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Md=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ld=function(t){function e(e){var n=t.call(this)||this;return n.params=e,n.isActive=!1,n.subMenuIsOpen=!1,n.setTemplate('<div class="'+n.getClassName()+'" tabindex="-1" role="treeitem"></div>'),n}return Dd(e,t),e.prototype.init=function(){var t=this;this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();var e=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),an(e,!0)):(this.addGuiEventListener("click",(function(e){return t.onItemSelected(e)})),this.addGuiEventListener("keydown",(function(e){e.key!==Qo.ENTER&&e.key!==Qo.SPACE||(e.preventDefault(),t.onItemSelected(e))})),this.addGuiEventListener("mousedown",(function(t){t.stopPropagation(),t.preventDefault()})),this.addGuiEventListener("mouseenter",(function(){return t.onMouseEnter()})),this.addGuiEventListener("mouseleave",(function(){return t.onMouseLeave()}))),this.params.cssClasses&&this.params.cssClasses.forEach((function(e){return t.addCssClass(e)}))},e.prototype.isDisabled=function(){return!!this.params.disabled},e.prototype.openSubMenu=function(t){var n=this;if(void 0===t&&(t=!1),this.closeSubMenu(),this.params.subMenu){var o,r=Oo('<div class="ag-menu" role="presentation"></div>');if(this.params.subMenu instanceof Array){var i=Qe(this.getGui()),s=isNaN(i)?1:i+1,a=this.createBean(new Od(s));a.setParentComponent(this),a.addMenuItems(this.params.subMenu),r.appendChild(a.getGui()),this.addManagedListener(a,e.EVENT_MENU_ITEM_SELECTED,(function(t){return n.dispatchEvent(t)})),a.addGuiEventListener("mouseenter",(function(){return n.cancelDeactivate()})),o=function(){return n.destroyBean(a)},t&&setTimeout((function(){return a.activateFirstItem()}),0)}else{var l=this.params.subMenu,u=this.createBean(new Ad(l));u.setParentComponent(this);var c=u.getGui(),p="mouseenter",h=function(){return n.cancelDeactivate()};c.addEventListener(p,h),o=function(){return c.removeEventListener(p,h)},r.appendChild(c),l.afterGuiAttached&&setTimeout((function(){return l.afterGuiAttached()}),0)}var d=this.getGui(),f=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:d,ePopup:r}),g=this.localeService.getLocaleTextFunc(),m=this.popupService.addPopup({modal:!0,eChild:r,positionCallback:f,anchorToElement:d,ariaLabel:g("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,un(d,!0),this.hideSubMenu=function(){m&&m.hideFunc(),n.subMenuIsOpen=!1,un(d,!1),o()}}},e.prototype.closeSubMenu=function(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,un(this.getGui(),!1))},e.prototype.isSubMenuOpen=function(){return this.subMenuIsOpen},e.prototype.activate=function(t){var e=this;this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),t&&this.params.subMenu&&window.setTimeout((function(){e.isAlive()&&e.isActive&&e.openSubMenu()}),300),this.onItemActivated())},e.prototype.deactivate=function(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()},e.prototype.addIcon=function(){if(this.params.checked||this.params.icon||!this.params.isCompact){var t=Oo('<span ref="eIcon" class="'+this.getClassName("part")+" "+this.getClassName("icon")+'" role="presentation"></span>');this.params.checked?t.appendChild(Zo("check",this.gridOptionsService)):this.params.icon&&(zo(this.params.icon)?t.appendChild(this.params.icon):"string"===typeof this.params.icon?t.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(t)}},e.prototype.addName=function(){if(this.params.name||!this.params.isCompact){var t=Oo('<span ref="eName" class="'+this.getClassName("part")+" "+this.getClassName("text")+'">'+(this.params.name||"")+"</span>");this.getGui().appendChild(t)}},e.prototype.addTooltip=function(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new wr(this)))},e.prototype.getTooltipParams=function(){return{location:"menu",value:this.tooltip}},e.prototype.addShortcut=function(){if(this.params.shortcut||!this.params.isCompact){var t=Oo('<span ref="eShortcut" class="'+this.getClassName("part")+" "+this.getClassName("shortcut")+'">'+(this.params.shortcut||"")+"</span>");this.getGui().appendChild(t)}},e.prototype.addSubMenu=function(){if(this.params.subMenu||!this.params.isCompact){var t=Oo('<span ref="ePopupPointer" class="'+this.getClassName("part")+" "+this.getClassName("popup-pointer")+'"></span>'),e=this.getGui();if(this.params.subMenu){var n=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";un(e,!1),t.appendChild(Zo(n,this.gridOptionsService))}e.appendChild(t)}},e.prototype.onItemSelected=function(t){if(this.params.action?this.params.action():this.openSubMenu(t&&"keydown"===t.type),!this.params.subMenu||this.params.action){var n={type:e.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:t};this.dispatchEvent(n)}},e.prototype.onItemActivated=function(){var t={type:e.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(t)},e.prototype.cancelActivate=function(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)},e.prototype.cancelDeactivate=function(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)},e.prototype.onMouseEnter=function(){var t=this;this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout((function(){return t.activate(!0)}),e.ACTIVATION_DELAY):this.activate(!0)},e.prototype.onMouseLeave=function(){var t=this;this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout((function(){return t.deactivate()}),e.ACTIVATION_DELAY):this.deactivate()},e.prototype.getClassName=function(t){var e=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return t?e+"-"+t:e},e.EVENT_MENU_ITEM_SELECTED="menuItemSelected",e.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",e.ACTIVATION_DELAY=80,Md([$("popupService")],e.prototype,"popupService",void 0),Md([Z],e.prototype,"init",null),e}(Tr),Nd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},kd=function(t){function e(n){var o=t.call(this,e.getTemplate(n))||this;return o.closable=!0,o.config=n,o}return Nd(e,t),e.getTemplate=function(t){var e=t&&t.cssIdentifier||"default";return'<div class="ag-panel ag-'+e+'-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-'+e+'-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-'+e+'-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-'+e+'-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-'+e+'-panel-content-wrapper"></div>\n        </div>'},e.prototype.postConstruct=function(){var t=this,e=this.config,n=e.component,o=e.closable,r=e.hideTitleBar,i=e.title,s=e.minWidth,a=void 0===s?250:s,l=e.width,u=e.minHeight,c=void 0===u?250:u,p=e.height,h=e.centered,d=e.popup,f=e.x,g=e.y;this.positionableFeature=new Ur(this.getGui(),{minWidth:a,width:l,minHeight:c,height:p,centered:h,x:f,y:g,popup:d,calculateTopBuffer:function(){return t.positionableFeature.getHeight()-t.getBodyHeight()}}),this.createManagedBean(this.positionableFeature);var m=this.getGui();n&&this.setBodyComponent(n),r?po(this.eTitleBar,!1):(i&&this.setTitle(i),this.setClosable(null!=o?o:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",(function(e){var n=t.gridOptionsService.getDocument();if(m.contains(e.relatedTarget)||m.contains(n.activeElement)||t.eTitleBarButtons.contains(e.target))e.preventDefault();else{var o=t.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");o&&o.focus()}})),d&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")},e.prototype.renderComponent=function(){var t=this,e=this.getGui();e.focus(),this.close=function(){e.parentElement.removeChild(e),t.destroy()}},e.prototype.getHeight=function(){return this.positionableFeature.getHeight()},e.prototype.setHeight=function(t){this.positionableFeature.setHeight(t)},e.prototype.getWidth=function(){return this.positionableFeature.getWidth()},e.prototype.setWidth=function(t){this.positionableFeature.setWidth(t)},e.prototype.setClosable=function(t){if(t!==this.closable&&(this.closable=t),t){var n=this.closeButtonComp=new Tr(e.CLOSE_BTN_TEMPLATE);this.getContext().createBean(n);var o=n.getGui(),r=Zo("close",this.gridOptionsService);r.classList.add("ag-panel-title-bar-button-icon"),o.appendChild(r),this.addTitleBarButton(n),n.addManagedListener(o,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){(o=this.closeButtonComp.getGui()).parentElement.removeChild(o),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}},e.prototype.setBodyComponent=function(t){t.setParentComponent(this),this.eContentWrapper.appendChild(t.getGui())},e.prototype.addTitleBarButton=function(t,e){var n=this.eTitleBarButtons,o=n.children,r=o.length;null==e&&(e=r),e=Math.max(0,Math.min(e,r)),t.addCssClass("ag-panel-title-bar-button");var i=t.getGui();0===e?n.insertAdjacentElement("afterbegin",i):e===r?n.insertAdjacentElement("beforeend",i):o[e-1].insertAdjacentElement("afterend",i),t.setParentComponent(this)},e.prototype.getBodyHeight=function(){return yo(this.eContentWrapper)},e.prototype.getBodyWidth=function(){return vo(this.eContentWrapper)},e.prototype.setTitle=function(t){this.eTitle.innerText=t},e.prototype.onBtClose=function(){this.close()},e.prototype.destroy=function(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));var e=this.getGui();e&&e.offsetParent&&this.close(),t.prototype.destroy.call(this)},e.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',Fd([Or("eContentWrapper")],e.prototype,"eContentWrapper",void 0),Fd([Or("eTitleBar")],e.prototype,"eTitleBar",void 0),Fd([Or("eTitleBarButtons")],e.prototype,"eTitleBarButtons",void 0),Fd([Or("eTitle")],e.prototype,"eTitle",void 0),Fd([Z],e.prototype,"postConstruct",null),e}(Tr),Gd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bd=function(){return Bd=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Bd.apply(this,arguments)},Vd=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},zd=function(t){function e(e){var n=t.call(this,Bd(Bd({},e),{popup:!0}))||this;return n.isMaximizable=!1,n.isMaximized=!1,n.maximizeListeners=[],n.resizeListenerDestroy=null,n.lastPosition={x:0,y:0,width:0,height:0},n}return Gd(e,t),e.prototype.postConstruct=function(){var e=this,n=this.getGui(),o=this.config,r=o.movable,i=o.resizable,s=o.maximizable;this.addCssClass("ag-dialog"),t.prototype.postConstruct.call(this),this.addManagedListener(n,"focusin",(function(t){n.contains(t.relatedTarget)||e.popupService.bringPopupToFront(n)})),r&&this.setMovable(r),s&&this.setMaximizable(s),i&&this.setResizable(i)},e.prototype.renderComponent=function(){var t=this.getGui(),e=this.config,n=e.alwaysOnTop,o=e.modal,r=e.title,i=this.localeService.getLocaleTextFunc(),s=this.popupService.addPopup({modal:o,eChild:t,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:n,ariaLabel:r||i("ariaLabelDialog","Dialog")});s&&(this.close=s.hideFunc)},e.prototype.toggleMaximize=function(){var t=this.positionableFeature.getPosition();if(this.isMaximized){var e=this.lastPosition,n=e.x,o=e.y,r=e.width,i=e.height;this.setWidth(r),this.setHeight(i),this.positionableFeature.offsetElement(n,o)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=t.x,this.lastPosition.y=t.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()},e.prototype.refreshMaximizeIcon=function(){po(this.maximizeIcon,!this.isMaximized),po(this.minimizeIcon,this.isMaximized)},e.prototype.clearMaximizebleListeners=function(){this.maximizeListeners.length&&(this.maximizeListeners.forEach((function(t){return t()})),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)},e.prototype.destroy=function(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),t.prototype.destroy.call(this)},e.prototype.setResizable=function(t){this.positionableFeature.setResizable(t)},e.prototype.setMovable=function(t){this.positionableFeature.setMovable(t,this.eTitleBar)},e.prototype.setMaximizable=function(t){var e=this;if(!t)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));var n=this.eTitleBar;if(n&&t!==this.isMaximizable){var o=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),o.addManagedListener(o.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(o,0),this.maximizeListeners.push(this.addManagedListener(n,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",(function(){e.isMaximized=!1,e.refreshMaximizeIcon()}))}},e.prototype.buildMaximizeAndMinimizeElements=function(){var t=this.maximizeButtonComp=this.createBean(new Tr('<div class="ag-dialog-button"></span>')),e=t.getGui();return this.maximizeIcon=Zo("maximize",this.gridOptionsService),e.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=Zo("minimize",this.gridOptionsService),e.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),t},Vd([$("popupService")],e.prototype,"popupService",void 0),e}(kd),jd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hd=function(){return Hd=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Hd.apply(this,arguments)},Ud=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Wd=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},qd=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};!function(t){t[t.vertical=0]="vertical",t[t.horizontal=1]="horizontal"}(kh||(kh={}));var Xd,Yd=0,Kd=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.popupList=[],e}var n;return jd(e,t),n=e,e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.gridCtrl=e.gridCtrl,t.addManagedListener(t.gridCtrl,Zt.EVENT_KEYBOARD_FOCUS,(function(){t.popupList.forEach((function(t){return t.element.classList.add(vp.AG_KEYBOARD_FOCUS)}))})),t.addManagedListener(t.gridCtrl,Zt.EVENT_MOUSE_FOCUS,(function(){t.popupList.forEach((function(t){return t.element.classList.remove(vp.AG_KEYBOARD_FOCUS)}))}))}))},e.prototype.getPopupParent=function(){var t=this.gridOptionsService.get("popupParent");return t||this.gridCtrl.getGui()},e.prototype.positionPopupForMenu=function(t){var e=t.eventSource,n=t.ePopup,o=this.getPopupIndex(n);-1!==o&&(this.popupList[o].alignedToElement=e);var r=e.getBoundingClientRect(),i=this.getParentRect(),s=this.keepXYWithinBounds(n,r.top-i.top,kh.vertical),a=n.clientWidth>0?n.clientWidth:200;n.style.minWidth=a+"px";var l,u=i.right-i.left-a;function c(){return r.right-i.left-2}function p(){return r.left-i.left-a}this.gridOptionsService.is("enableRtl")?((l=p())<0&&(l=c(),this.setAlignedStyles(n,"left")),l>u&&(l=0,this.setAlignedStyles(n,"right"))):((l=c())>u&&(l=p(),this.setAlignedStyles(n,"right")),l<0&&(l=0,this.setAlignedStyles(n,"left"))),n.style.left=l+"px",n.style.top=s+"px"},e.prototype.positionPopupUnderMouseEvent=function(t){var e=this,n=t.ePopup,o=t.nudgeX,r=t.nudgeY,i=t.skipObserver;this.positionPopup({ePopup:n,nudgeX:o,nudgeY:r,keepWithinBounds:!0,skipObserver:i,updatePosition:function(){return e.calculatePointerAlign(t.mouseEvent)},postProcessCallback:function(){return e.callPostProcessPopup(t.type,t.ePopup,null,t.mouseEvent,t.column,t.rowNode)}})},e.prototype.calculatePointerAlign=function(t){var e=this.getParentRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},e.prototype.positionPopupByComponent=function(t){var e=this,n=t.ePopup,o=t.nudgeX,r=t.nudgeY,i=t.keepWithinBounds,s=t.eventSource,a=t.alignSide,l=void 0===a?"left":a,u=t.position,c=void 0===u?"over":u,p=t.column,h=t.rowNode,d=t.type,f=s.getBoundingClientRect(),g=this.getParentRect(),m=this.getPopupIndex(n);-1!==m&&(this.popupList[m].alignedToElement=s);this.positionPopup({ePopup:n,nudgeX:o,nudgeY:r,keepWithinBounds:i,updatePosition:function(){var o,i=f.left-g.left;("right"===l&&(i-=n.offsetWidth-f.width),"over"===c)?(o=f.top-g.top,e.setAlignedStyles(n,"over")):(e.setAlignedStyles(n,"under"),o="under"===e.shouldRenderUnderOrAbove(n,f,g,t.nudgeY||0)?f.top-g.top+f.height:f.top-n.offsetHeight-2*(r||0)-g.top);return{x:i,y:o}},postProcessCallback:function(){return e.callPostProcessPopup(d,n,s,null,p,h)}})},e.prototype.shouldRenderUnderOrAbove=function(t,e,n,o){var r=n.bottom-e.bottom,i=e.top-n.top,s=t.offsetHeight+o;return r>s?"under":i>s||i>r?"above":"under"},e.prototype.setAlignedStyles=function(t,e){var n=this.getPopupIndex(t);if(-1!==n){var o=this.popupList[n].alignedToElement;if(o){["right","left","over","above","under"].forEach((function(e){o.classList.remove("ag-has-popup-positioned-"+e),t.classList.remove("ag-popup-positioned-"+e)})),e&&(o.classList.add("ag-has-popup-positioned-"+e),t.classList.add("ag-popup-positioned-"+e))}}},e.prototype.callPostProcessPopup=function(t,e,n,o,r,i){var s=this.gridOptionsService.getCallback("postProcessPopup");s&&s({column:r,rowNode:i,ePopup:e,type:t,eventSource:n,mouseEvent:o})},e.prototype.positionPopup=function(t){var e=this,o=t.ePopup,r=t.keepWithinBounds,i=t.nudgeX,s=t.nudgeY,a=t.skipObserver,l=t.updatePosition,u={width:0,height:0},c=function(n){void 0===n&&(n=!1);var a=l(),c=a.x,p=a.y;n&&o.clientWidth===u.width&&o.clientHeight===u.height||(u.width=o.clientWidth,u.height=o.clientHeight,i&&(c+=i),s&&(p+=s),r&&(c=e.keepXYWithinBounds(o,c,kh.horizontal),p=e.keepXYWithinBounds(o,p,kh.vertical)),o.style.left=c+"px",o.style.top=p+"px",t.postProcessCallback&&t.postProcessCallback())};if(c(),!a){var p=this.resizeObserverService.observeResize(o,(function(){return c(!0)}));setTimeout((function(){return p()}),n.WAIT_FOR_POPUP_CONTENT_RESIZE)}},e.prototype.getActivePopups=function(){return this.popupList.map((function(t){return t.element}))},e.prototype.getPopupList=function(){return this.popupList},e.prototype.getParentRect=function(){var t=this.gridOptionsService.getDocument(),e=this.getPopupParent();return e===t.body?e=t.documentElement:"static"===getComputedStyle(e).position&&(e=e.offsetParent),wo(e)},e.prototype.keepXYWithinBounds=function(t,e,n){var o=n===kh.vertical,r=o?"clientHeight":"clientWidth",i=o?"top":"left",s=o?"offsetHeight":"offsetWidth",a=o?"scrollTop":"scrollLeft",l=this.gridOptionsService.getDocument(),u=l.documentElement,c=this.getPopupParent(),p=c.getBoundingClientRect(),h=l.documentElement.getBoundingClientRect(),d=c===l.body,f=t[s],g=d?(o?_o:Co)(u)+u[a]:c[r];d&&(g-=Math.abs(h[i]-p[i]));var m=g-f;return Math.min(Math.max(e,0),Math.abs(m))},e.prototype.addPopup=function(t){var e=this.gridOptionsService.getDocument(),n=t.eChild,o=t.ariaLabel,r=t.alwaysOnTop,i=t.positionCallback,s=t.anchorToElement;if(!e)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:function(){}};var a=this.getPopupIndex(n);if(-1!==a)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(n);var l=this.createPopupWrapper(n,o,!!r),u=this.addEventListenersToPopup(Hd(Hd({},t),{wrapperEl:l}));return i&&i(),this.addPopupToPopupList(n,l,u,s),{hideFunc:u}},e.prototype.initialisePopupPosition=function(t){var e=this.getPopupParent().getBoundingClientRect();r(t.style.top)||(t.style.top=-1*e.top+"px"),r(t.style.left)||(t.style.left=-1*e.left+"px")},e.prototype.createPopupWrapper=function(t,e,n){var o,r=this.getPopupParent(),i=document.createElement("div"),s=this.environment.getTheme().allThemes;return s.length&&(o=i.classList).add.apply(o,qd([],Wd(s))),i.classList.add("ag-popup"),t.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),t.hasAttribute("role")||Ze(t,"dialog"),tn(t,e),this.focusService.isKeyboardMode()&&t.classList.add(vp.AG_KEYBOARD_FOCUS),i.appendChild(t),r.appendChild(i),n?this.setAlwaysOnTop(t,!0):this.bringPopupToFront(t),i},e.prototype.addEventListenersToPopup=function(t){var e=this,n=this.gridOptionsService.getDocument(),o=this.getPopupParent(),r=t.wrapperEl,i=t.eChild,s=t.click,a=t.closedCallback,l=t.afterGuiAttached,u=t.closeOnEsc,c=t.modal,p=!1,h=function(t){r.contains(n.activeElement)&&(t.key===Qo.ESCAPE&&g({keyboardEvent:t}))},d=function(t){return g({mouseEvent:t})},f=function(t){return g({touchEvent:t})},g=function(t){void 0===t&&(t={});var l=t.mouseEvent,u=t.touchEvent,c=t.keyboardEvent;e.isEventFromCurrentPopup({mouseEvent:l,touchEvent:u},i)||e.isEventSameChainAsOriginalEvent({originalMouseEvent:s,mouseEvent:l,touchEvent:u})||p||(p=!0,o.removeChild(r),n.removeEventListener("keydown",h),n.removeEventListener("mousedown",d),n.removeEventListener("touchstart",f),n.removeEventListener("contextmenu",d),e.eventService.removeEventListener(Zt.EVENT_DRAG_STARTED,d),a&&a(l||u||c),e.removePopupFromPopupList(i))};return l&&l({hidePopup:g}),window.setTimeout((function(){u&&n.addEventListener("keydown",h),c&&(n.addEventListener("mousedown",d),e.eventService.addEventListener(Zt.EVENT_DRAG_STARTED,d),n.addEventListener("touchstart",f),n.addEventListener("contextmenu",d))}),0),g},e.prototype.addPopupToPopupList=function(t,e,n,o){this.popupList.push({element:t,wrapper:e,hideFunc:n,instanceId:Yd++,isAnchored:!!o}),o&&this.setPopupPositionRelatedToElement(t,o)},e.prototype.getPopupIndex=function(t){return this.popupList.findIndex((function(e){return e.element===t}))},e.prototype.setPopupPositionRelatedToElement=function(t,e){var n=this.getPopupIndex(t);if(-1!==n){var o=this.popupList[n];if(o.stopAnchoringPromise&&o.stopAnchoringPromise.then((function(t){return t&&t()})),o.stopAnchoringPromise=void 0,o.isAnchored=!1,e){var r=this.keepPopupPositionedRelativeTo({element:e,ePopup:t,hidePopup:o.hideFunc});return o.stopAnchoringPromise=r,o.isAnchored=!0,r}}},e.prototype.removePopupFromPopupList=function(t){this.setAlignedStyles(t,null),this.setPopupPositionRelatedToElement(t,null),this.popupList=this.popupList.filter((function(e){return e.element!==t}))},e.prototype.keepPopupPositionedRelativeTo=function(t){var e=this,n=this.getPopupParent(),o=n.getBoundingClientRect(),r=t.element,i=t.ePopup,s=r.getBoundingClientRect(),a=o.top-s.top,l=o.left-s.left,u=a,c=l,p=i.style.top,h=parseInt(p.substring(0,p.length-1),10),d=i.style.left,f=parseInt(d.substring(0,d.length-1),10);return new mr((function(o){e.getFrameworkOverrides().setInterval((function(){var o=n.getBoundingClientRect(),s=r.getBoundingClientRect();if(0==s.top&&0==s.left&&0==s.height&&0==s.width)t.hidePopup();else{var p=o.top-s.top;if(p!=u){var d=e.keepXYWithinBounds(i,h+a-p,kh.vertical);i.style.top=d+"px"}u=p;var g=o.left-s.left;if(g!=c){var m=e.keepXYWithinBounds(i,f+l-g,kh.horizontal);i.style.left=m+"px"}c=g}}),200).then((function(t){o((function(){null!=t&&window.clearInterval(t)}))}))}))},e.prototype.hasAnchoredPopup=function(){return this.popupList.some((function(t){return t.isAnchored}))},e.prototype.isEventFromCurrentPopup=function(t,e){var n=t.mouseEvent,o=t.touchEvent,r=n||o;if(!r)return!1;var i=this.getPopupIndex(e);if(-1===i)return!1;for(var s=i;s<this.popupList.length;s++){if(kt(this.popupList[s].element,r))return!0}return this.isElementWithinCustomPopup(r.target)},e.prototype.isElementWithinCustomPopup=function(t){for(var e=this.gridOptionsService.getDocument();t&&t!==e.body;){if(t.classList.contains("ag-custom-component-popup")||null===t.parentElement)return!0;t=t.parentElement}return!1},e.prototype.isEventSameChainAsOriginalEvent=function(t){var e=t.originalMouseEvent,n=t.mouseEvent,o=t.touchEvent,r=null;if(n?r=n:o&&(r=o.touches[0]),r&&e){var i=n?n.screenX:0,s=n?n.screenY:0,a=Math.abs(e.screenX-i)<5,l=Math.abs(e.screenY-s)<5;if(a&&l)return!0}return!1},e.prototype.getWrapper=function(t){for(;!t.classList.contains("ag-popup")&&t.parentElement;)t=t.parentElement;return t.classList.contains("ag-popup")?t:null},e.prototype.setAlwaysOnTop=function(t,e){var n=this.getWrapper(t);n&&(n.classList.toggle("ag-always-on-top",!!e),e&&this.bringPopupToFront(n))},e.prototype.bringPopupToFront=function(t){var e=this.getPopupParent(),n=Array.prototype.slice.call(e.querySelectorAll(".ag-popup")),o=n.length,r=Array.prototype.slice.call(e.querySelectorAll(".ag-popup.ag-always-on-top")),i=r.length,s=this.getWrapper(t);if(s&&!(o<=1)&&e.contains(t)){var a=n.indexOf(s),l=s.querySelectorAll("div"),u=[];if(l.forEach((function(t){0!==t.scrollTop&&u.push([t,t.scrollTop])})),i)s.classList.contains("ag-always-on-top")?a!==o-1&&yt(r).insertAdjacentElement("afterend",s):a!==o-i-1&&r[0].insertAdjacentElement("beforebegin",s);else a!==o-1&&yt(n).insertAdjacentElement("afterend",s);for(;u.length;){var c=u.pop();c[0].scrollTop=c[1]}var p={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:s};this.eventService.dispatchEvent(p)}},e.WAIT_FOR_POPUP_CONTENT_RESIZE=200,Ud([$("focusService")],e.prototype,"focusService",void 0),Ud([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Ud([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Ud([Z],e.prototype,"postConstruct",null),e=n=Ud([Q("popupService")],e)}(Ht),Zd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Jd=function(t){function e(){var e=t.call(this,'\n        <div class="ag-autocomplete-row" role="presentation">\n            <div class="ag-autocomplete-row-label"></div>\n        </div>')||this;return e.hasHighlighting=!1,e}return Zd(e,t),e.prototype.setState=function(t,e){this.value=t,this.render(),this.updateSelected(e)},e.prototype.updateSelected=function(t){this.addOrRemoveCssClass("ag-autocomplete-row-selected",t)},e.prototype.setSearchString=function(t){var e,n=!1;if(r(t)){var o=null===(e=this.value)||void 0===e?void 0:e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase());if(o>=0){n=!0,this.hasHighlighting=!0;var i=o+t.length,s=re(this.value.slice(0,o)),a=re(this.value.slice(o,i)),l=re(this.value.slice(i));this.getGui().lastElementChild.innerHTML=s+"<b>"+a+"</b>"+l}}!n&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())},e.prototype.render=function(){var t;this.getGui().lastElementChild.innerHTML=null!==(t=re(this.value))&&void 0!==t?t:"&nbsp;"},e}(Tr),Qd=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$d=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},tf=function(t){function e(n){var o=t.call(this,e.TEMPLATE)||this;return o.params=n,o.searchString="",o}return Qd(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.init=function(){var t=this;this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new fd({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:function(){return t.autocompleteEntries.length},getRow:function(e){return t.autocompleteEntries[e]}});var e=this.virtualList.getGui();this.addManagedListener(e,"click",(function(){return t.params.onConfirmed()})),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",(function(t){return t.preventDefault()})),this.setSelectedValue(0)},e.prototype.onNavigationKeyDown=function(t,e){t.preventDefault();var n=this.autocompleteEntries.indexOf(this.selectedValue),o=e===Qo.UP?n-1:n+1;this.checkSetSelectedValue(o)},e.prototype.setSearch=function(t){this.searchString=t,r(t)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()},e.prototype.runContainsSearch=function(t,e){var n,o=!1,r=t.toLocaleLowerCase(),i=e.filter((function(t){var e=t.toLocaleLowerCase().indexOf(r),i=0===e,s=e>=0;return s&&(!n||!o&&i||o===i&&t.length<n.length)&&(n=t,o=i),s}));return!n&&i.length&&(n=i[0]),{topMatch:n,allMatches:i}},e.prototype.runSearch=function(){var t,e,n,o,r=this.params.autocompleteEntries,i=r.map((function(t){var e;return null!==(e=t.displayValue)&&void 0!==e?e:t.key}));if(this.params.useFuzzySearch)o=(n=_e(this.searchString,i,!0)).length?n[0]:void 0;else{var s=this.runContainsSearch(this.searchString,i);n=s.allMatches,o=s.topMatch}var a=r.filter((function(t){var e=t.key,o=t.displayValue;return n.includes(null!==o&&void 0!==o?o:e)}));if(!a.length&&this.selectedValue&&(null===(e=null===(t=this.params)||void 0===t?void 0:t.forceLastSelection)||void 0===e?void 0:e.call(t,this.selectedValue,this.searchString))&&(a=[this.selectedValue]),this.autocompleteEntries=a,this.virtualList.refresh(),o){var l=n.indexOf(o);this.checkSetSelectedValue(l)}},e.prototype.updateSearchInList=function(){var t=this;this.virtualList.forEachRenderedRow((function(e){return e.setSearchString(t.searchString)}))},e.prototype.checkSetSelectedValue=function(t){t>=0&&t<this.autocompleteEntries.length&&this.setSelectedValue(t)},e.prototype.setSelectedValue=function(t){var e=this.autocompleteEntries[t];this.selectedValue!==e&&(this.selectedValue=e,this.virtualList.ensureIndexVisible(t),this.virtualList.forEachRenderedRow((function(e,n){e.updateSelected(t===n)})))},e.prototype.createRowComponent=function(t){var e,n=new Jd;return this.getContext().createBean(n),n.setState(null!==(e=t.displayValue)&&void 0!==e?e:t.key,t===this.selectedValue),n},e.prototype.onMouseMove=function(t){var e=this.virtualList.getGui().getBoundingClientRect(),n=this.virtualList.getScrollTop(),o=t.clientY-e.top+n,r=Math.floor(o/this.virtualList.getRowHeight());this.checkSetSelectedValue(r)},e.prototype.afterGuiAttached=function(){this.virtualList.refresh()},e.prototype.getSelectedValue=function(){var t;return this.autocompleteEntries.length&&null!==(t=this.selectedValue)&&void 0!==t?t:null},e.TEMPLATE='<div class="ag-autocomplete-list-popup">\n            <div ref="eList" class="ag-autocomplete-list"></div>\n        <div>',$d([Or("eList")],e.prototype,"eList",void 0),$d([Z],e.prototype,"init",null),e}(ys),ef=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},of=function(t){function e(){var e=t.call(this,'\n            <div class="ag-autocomplete" role="presentation">\n                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>\n            </div>')||this;return e.isListOpen=!1,e.lastPosition=0,e.valid=!0,e}return ef(e,t),e.prototype.postConstruct=function(){var t=this;this.eAutocompleteInput.onValueChange((function(e){return t.onValueChanged(e)})),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc((function(){t.destroyBean(t.autocompleteList)})),this.addGuiEventListener("focusout",(function(){return t.onFocusOut()}))},e.prototype.onValueChanged=function(t){var e=o(t);this.updateValue(e),this.updateAutocompleteList(e)},e.prototype.updateValue=function(t){this.updateLastPosition(),this.dispatchEvent({type:e.EVENT_VALUE_CHANGED,value:t}),this.validate(t)},e.prototype.updateAutocompleteList=function(t){var e,n,o,r,i=null!==(n=null===(e=this.listGenerator)||void 0===e?void 0:e.call(this,t,this.lastPosition))&&void 0!==n?n:{enabled:!1};if(i.type&&i.type===(null===(o=this.autocompleteListParams)||void 0===o?void 0:o.type)||this.isListOpen&&this.closeList(),this.autocompleteListParams=i,null===(r=this.autocompleteListParams)||void 0===r?void 0:r.enabled){this.isListOpen||this.openList();var s=this.autocompleteListParams.searchString;this.autocompleteList.setSearch(null!==s&&void 0!==s?s:"")}else this.isListOpen&&this.closeList()},e.prototype.onKeyDown=function(t){var e=this,n=t.key;switch(this.updateLastPosition(),n){case Qo.ENTER:this.onEnterKeyDown(t);break;case Qo.TAB:this.onTabKeyDown(t);break;case Qo.DOWN:case Qo.UP:this.onUpDownKeyDown(t,n);break;case Qo.LEFT:case Qo.RIGHT:case Qo.PAGE_HOME:case Qo.PAGE_END:setTimeout((function(){e.updatePositionAndList()}));break;case Qo.ESCAPE:this.onEscapeKeyDown(t);break;case Qo.SPACE:t.ctrlKey&&!this.isListOpen&&(t.preventDefault(),this.forceOpenList())}},e.prototype.confirmSelection=function(){var t,n=null===(t=this.autocompleteList)||void 0===t?void 0:t.getSelectedValue();n&&(this.closeList(),this.dispatchEvent({type:e.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:n,autocompleteType:this.autocompleteListParams.type}))},e.prototype.onTabKeyDown=function(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.confirmSelection())},e.prototype.onEnterKeyDown=function(t){t.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()},e.prototype.onUpDownKeyDown=function(t,e){var n;t.preventDefault(),this.isListOpen?null===(n=this.autocompleteList)||void 0===n||n.onNavigationKeyDown(t,e):this.forceOpenList()},e.prototype.onEscapeKeyDown=function(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))},e.prototype.onFocusOut=function(){this.isListOpen&&this.closeList()},e.prototype.updatePositionAndList=function(){var t;this.updateLastPosition(),this.updateAutocompleteList(null!==(t=this.eAutocompleteInput.getValue())&&void 0!==t?t:null)},e.prototype.setCaret=function(t,e){var n=this.gridOptionsService.getDocument();e&&n.activeElement===n.body&&this.eAutocompleteInput.getFocusableElement().focus(),this.eAutocompleteInput.getInputElement().setSelectionRange(t,t)},e.prototype.forceOpenList=function(){this.onValueChanged(this.eAutocompleteInput.getValue())},e.prototype.updateLastPosition=function(){var t;this.lastPosition=null!==(t=this.eAutocompleteInput.getInputElement().selectionStart)&&void 0!==t?t:0},e.prototype.validate=function(t){var n;this.validator&&(this.validationMessage=this.validator(t),this.eAutocompleteInput.getInputElement().setCustomValidity(null!==(n=this.validationMessage)&&void 0!==n?n:""),this.valid=!this.validationMessage,this.dispatchEvent({type:e.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))},e.prototype.openList=function(){var t=this;this.isListOpen=!0,this.autocompleteList=this.createBean(new tf({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:function(){return t.confirmSelection()},forceLastSelection:this.forceLastSelection}));var e=this.autocompleteList.getGui(),n={ePopup:e,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gridOptionsService.is("enableRtl")?"right":"left",keepWithinBounds:!0},o=this.popupService.addPopup({eChild:e,anchorToElement:this.getGui(),positionCallback:function(){return t.popupService.positionPopupByComponent(n)},ariaLabel:this.listAriaLabel});this.hidePopup=o.hideFunc,this.autocompleteList.afterGuiAttached()},e.prototype.closeList=function(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null},e.prototype.onCompleted=function(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:e.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})},e.prototype.getValue=function(){return o(this.eAutocompleteInput.getValue())},e.prototype.setInputPlaceholder=function(t){return this.eAutocompleteInput.setInputPlaceholder(t),this},e.prototype.setInputAriaLabel=function(t){return this.eAutocompleteInput.setInputAriaLabel(t),this},e.prototype.setListAriaLabel=function(t){return this.listAriaLabel=t,this},e.prototype.setListGenerator=function(t){return this.listGenerator=t,this},e.prototype.setValidator=function(t){return this.validator=t,this},e.prototype.isValid=function(){return this.valid},e.prototype.setValue=function(t){var e=t.value,n=t.position,o=t.silent,r=t.updateListOnlyIfOpen,i=t.restoreFocus;this.eAutocompleteInput.setValue(e,!0),this.setCaret(null!==n&&void 0!==n?n:this.lastPosition,i),o||this.updateValue(e),r&&!this.isListOpen||this.updateAutocompleteList(e)},e.prototype.setForceLastSelection=function(t){return this.forceLastSelection=t,this},e.prototype.setInputDisabled=function(t){return this.eAutocompleteInput.setDisabled(t),this},e.EVENT_VALUE_CHANGED="eventValueChanged",e.EVENT_VALUE_CONFIRMED="eventValueConfirmed",e.EVENT_OPTION_SELECTED="eventOptionSelected",e.EVENT_VALID_CHANGED="eventValidChanged",nf([$("popupService")],e.prototype,"popupService",void 0),nf([Or("eAutocompleteInput")],e.prototype,"eAutocompleteInput",void 0),nf([Z],e.prototype,"postConstruct",null),e}(Tr),rf=["mouseover","mouseout","mouseenter","mouseleave","mousemove"],sf=["touchstart","touchend","touchmove","touchcancel"],af=function(){function t(){this.renderingEngine="vanilla",this.isOutsideAngular=function(t){return Tt(rf,t)}}return t.prototype.setTimeout=function(t,e){window.setTimeout(t,e)},t.prototype.setInterval=function(t,e){return new mr((function(n){n(window.setInterval(t,e))}))},t.prototype.addEventListener=function(t,e,n,o){var r=Tt(sf,e);t.addEventListener(e,n,{capture:!!o,passive:r})},t.prototype.dispatchEvent=function(t,e,n){e()},t.prototype.frameworkComponent=function(t){return null},t.prototype.isFrameworkComponent=function(t){return!1},t}(),lf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),uf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},cf=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},pf=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},hf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lf(e,t),e.prototype.getNextCellToFocus=function(t,e,n){return void 0===n&&(n=!1),n?this.getNextCellToFocusWithCtrlPressed(t,e):this.getNextCellToFocusWithoutCtrlPressed(t,e)},e.prototype.getNextCellToFocusWithCtrlPressed=function(t,e){var n,o,r=t===Qo.UP,i=t===Qo.DOWN,s=t===Qo.LEFT;if(r||i)o=r?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),n=e.column;else{var a=this.columnModel.getAllDisplayedColumns(),l=this.gridOptionsService.is("enableRtl");o=e.rowIndex,n=s!==l?a[0]:yt(a)}return{rowIndex:o,rowPinned:null,column:n}},e.prototype.getNextCellToFocusWithoutCtrlPressed=function(t,e){for(var n=e,o=!1;!o;){switch(t){case Qo.UP:n=this.getCellAbove(n);break;case Qo.DOWN:n=this.getCellBelow(n);break;case Qo.RIGHT:n=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case Qo.LEFT:n=this.gridOptionsService.is("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,console.warn("AG Grid: unknown key for navigation "+t)}o=!n||this.isCellGoodToFocusOn(n)}return n},e.prototype.isCellGoodToFocusOn=function(t){var e,n=t.column;switch(t.rowPinned){case"top":e=this.pinnedRowModel.getPinnedTopRow(t.rowIndex);break;case"bottom":e=this.pinnedRowModel.getPinnedBottomRow(t.rowIndex);break;default:e=this.rowModel.getRow(t.rowIndex)}return!!e&&!n.isSuppressNavigable(e)},e.prototype.getCellToLeft=function(t){if(!t)return null;var e=this.columnModel.getDisplayedColBefore(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null},e.prototype.getCellToRight=function(t){if(!t)return null;var e=this.columnModel.getDisplayedColAfter(t.column);return e?{rowIndex:t.rowIndex,column:e,rowPinned:t.rowPinned}:null},e.prototype.getRowBelow=function(t){var e=t.rowIndex,n=t.rowPinned;if(this.isLastRowInContainer(t))switch(n){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}var o=this.rowModel.getRow(t.rowIndex),r=this.getNextStickyPosition(o);return r||{rowIndex:e+1,rowPinned:n}},e.prototype.getNextStickyPosition=function(t,e){if(this.gridOptionsService.isGroupRowsSticky()&&t&&t.sticky){var n=pf([],cf(this.rowRenderer.getStickyTopRowCtrls())).sort((function(t,e){return t.getRowNode().rowIndex-e.getRowNode().rowIndex})),o=e?-1:1,r=n.findIndex((function(e){return e.getRowNode().rowIndex===t.rowIndex})),i=n[r+o];return i?{rowIndex:i.getRowNode().rowIndex,rowPinned:null}:void 0}},e.prototype.getCellBelow=function(t){if(!t)return null;var e=this.getRowBelow(t);return e?{rowIndex:e.rowIndex,column:t.column,rowPinned:e.rowPinned}:null},e.prototype.isLastRowInContainer=function(t){var e=t.rowPinned,n=t.rowIndex;return"top"===e?this.pinnedRowModel.getPinnedTopRowData().length-1<=n:"bottom"===e?this.pinnedRowModel.getPinnedBottomRowData().length-1<=n:this.paginationProxy.getPageLastRow()<=n},e.prototype.getRowAbove=function(t){var e=t.rowIndex,n=t.rowPinned;if(n?0===e:e===this.paginationProxy.getPageFirstRow())return"top"===n?null:n&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;var o=this.rowModel.getRow(t.rowIndex),r=this.getNextStickyPosition(o,!0);return r||{rowIndex:e-1,rowPinned:n}},e.prototype.getCellAbove=function(t){if(!t)return null;var e=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});return e?{rowIndex:e.rowIndex,column:t.column,rowPinned:e.rowPinned}:null},e.prototype.getLastBodyCell=function(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}},e.prototype.getLastFloatingTopRow=function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}},e.prototype.getNextTabbedCell=function(t,e){return e?this.getNextTabbedCellBackwards(t):this.getNextTabbedCellForwards(t)},e.prototype.getNextTabbedCellForwards=function(t){var e=this.columnModel.getAllDisplayedColumns(),n=t.rowIndex,o=t.rowPinned,r=this.columnModel.getDisplayedColAfter(t.column);if(!r){r=e[0];var s=this.getRowBelow(t);if(i(s))return null;if(!s.rowPinned&&!this.paginationProxy.isRowInPage(s))return null;n=s?s.rowIndex:null,o=s?s.rowPinned:null}return{rowIndex:n,column:r,rowPinned:o}},e.prototype.getNextTabbedCellBackwards=function(t){var e=this.columnModel.getAllDisplayedColumns(),n=t.rowIndex,o=t.rowPinned,r=this.columnModel.getDisplayedColBefore(t.column);if(!r){r=yt(e);var s=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});if(i(s))return null;if(!s.rowPinned&&!this.paginationProxy.isRowInPage(s))return null;n=s?s.rowIndex:null,o=s?s.rowPinned:null}return{rowIndex:n,column:r,rowPinned:o}},uf([$("columnModel")],e.prototype,"columnModel",void 0),uf([$("rowModel")],e.prototype,"rowModel",void 0),uf([$("rowRenderer")],e.prototype,"rowRenderer",void 0),uf([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),uf([$("paginationProxy")],e.prototype,"paginationProxy",void 0),e=uf([Q("cellNavigationService")],e)}(Ht),df=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ff=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},gf=function(t,e){return function(n,o){e(n,o,t)}},mf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.consuming=!1,e}return df(e,t),e.prototype.setBeans=function(t){this.logger=t.create("AlignedGridsService")},e.prototype.init=function(){this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))},e.prototype.fireEvent=function(t){if(!this.consuming){var e=this.gridOptionsService.get("alignedGrids");e&&e.forEach((function(e){if(e.api){var n=e.api.__getAlignedGridService();t(n)}}))}},e.prototype.onEvent=function(t){this.consuming=!0,t(),this.consuming=!1},e.prototype.fireColumnEvent=function(t){this.fireEvent((function(e){e.onColumnEvent(t)}))},e.prototype.fireScrollEvent=function(t){"horizontal"===t.direction&&this.fireEvent((function(e){e.onScrollEvent(t)}))},e.prototype.onScrollEvent=function(t){var e=this;this.onEvent((function(){e.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(t.left,!0)}))},e.prototype.getMasterColumns=function(t){var e=[];return t.columns?t.columns.forEach((function(t){e.push(t)})):t.column&&e.push(t.column),e},e.prototype.getColumnIds=function(t){var e=[];return t.columns?t.columns.forEach((function(t){e.push(t.getColId())})):t.column&&e.push(t.column.getColId()),e},e.prototype.onColumnEvent=function(t){var e=this;this.onEvent((function(){switch(t.type){case Zt.EVENT_COLUMN_MOVED:case Zt.EVENT_COLUMN_VISIBLE:case Zt.EVENT_COLUMN_PINNED:case Zt.EVENT_COLUMN_RESIZED:var n=t;e.processColumnEvent(n);break;case Zt.EVENT_COLUMN_GROUP_OPENED:var o=t;e.processGroupOpenedEvent(o);break;case Zt.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}}))},e.prototype.processGroupOpenedEvent=function(t){var e=t.columnGroup,n=null;if(e){var o=e.getGroupId();n=this.columnModel.getProvidedColumnGroup(o)}e&&!n||(this.logger.log("onColumnEvent-> processing "+t+" expanded = "+e.isExpanded()),this.columnModel.setColumnGroupOpened(n,e.isExpanded(),"alignedGridChanged"))},e.prototype.processColumnEvent=function(t){var e,n=this,o=t.column,r=null;if(o&&(r=this.columnModel.getPrimaryColumn(o.getColId())),!o||r){var i=this.getMasterColumns(t);switch(t.type){case Zt.EVENT_COLUMN_MOVED:var s=t,a=t.columnApi.getColumnState().map((function(t){return{colId:t.colId}}));this.columnModel.applyColumnState({state:a,applyOrder:!0},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" toIndex = "+s.toIndex);break;case Zt.EVENT_COLUMN_VISIBLE:var l=t;a=t.columnApi.getColumnState().map((function(t){return{colId:t.colId,hide:t.hide}}));this.columnModel.applyColumnState({state:a},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" visible = "+l.visible);break;case Zt.EVENT_COLUMN_PINNED:var u=t;a=t.columnApi.getColumnState().map((function(t){return{colId:t.colId,pinned:t.pinned}}));this.columnModel.applyColumnState({state:a},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" pinned = "+u.pinned);break;case Zt.EVENT_COLUMN_RESIZED:var c=t,p={};i.forEach((function(e){n.logger.log("onColumnEvent-> processing "+t.type+" actualWidth = "+e.getActualWidth()),p[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}})),null===(e=c.flexColumns)||void 0===e||e.forEach((function(t){p[t.getId()]&&delete p[t.getId()]})),this.columnModel.setColumnWidths(Object.values(p),!1,c.finished,"alignedGridChanged")}var h=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),d=this.gridOptionsService.get("alignedGrids");d&&d.forEach((function(t){t.api&&t.api.setAlwaysShowVerticalScroll(h)}))}},ff([$("columnModel")],e.prototype,"columnModel",void 0),ff([$("ctrlsService")],e.prototype,"ctrlsService",void 0),ff([gf(0,nt("loggerFactory"))],e.prototype,"setBeans",null),ff([Z],e.prototype,"init",null),e=ff([Q("alignedGridsService")],e)}(Ht),yf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_f=function(t,e){return function(n,o){e(n,o,t)}},Cf=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yf(e,t),e.prototype.setBeans=function(t){this.logger=t.create("selectionService"),this.reset()},e.prototype.init=function(){var t=this;this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",(function(e){return t.groupSelectsChildren=e.currentValue})),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(function(e){return t.rowSelection=e.currentValue})),this.addManagedListener(this.eventService,Zt.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))},e.prototype.isMultiselect=function(){return"multiple"===this.rowSelection},e.prototype.setNodesSelected=function(t){var e;if(0===t.nodes.length)return 0;var n=t.newValue,o=t.clearSelection,r=t.suppressFinishActions,i=t.rangeSelect;t.event;var s=t.source,a=void 0===s?"api":s;if(t.nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;var l=this.groupSelectsChildren&&!0===t.groupSelectsFiltered,u=t.nodes.map((function(t){return t.footer?t.sibling:t}));if(i){if(t.nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;var c=this.getLastSelectedNode();if(c)if(c!==(f=u[0])&&this.isMultiselect()){var p=this.selectRange(f,c,t.newValue,a);return this.setLastSelectedNode(f),p}}for(var h=0,d=0;d<u.length;d++){var f=u[d];if(!(l&&f.group))f.selectThisNode(n,t.event,a)&&h++;this.groupSelectsChildren&&(null===(e=f.childrenAfterGroup)||void 0===e?void 0:e.length)&&(h+=this.selectChildren(f,n,l,a))}if(!r){if(n&&(o||!this.isMultiselect())&&(h+=this.clearOtherNodes(u[0],a)),h>0){this.updateGroupsFromChildrenSelections(a);var g={type:Zt.EVENT_SELECTION_CHANGED,source:a};this.eventService.dispatchEvent(g)}n&&this.setLastSelectedNode(u[u.length-1])}return h},e.prototype.selectRange=function(t,e,n,o){var r=this;void 0===n&&(n=!0);var i=this.rowModel.getNodesInRangeForSelection(t,e),s=0;i.forEach((function(e){e.group&&r.groupSelectsChildren||!1===n&&t===e||e.selectThisNode(n,void 0,o)&&s++})),this.updateGroupsFromChildrenSelections(o);var a={type:Zt.EVENT_SELECTION_CHANGED,source:o};return this.eventService.dispatchEvent(a),s},e.prototype.selectChildren=function(t,e,n,o){var r=n?t.childrenAfterAggFilter:t.childrenAfterGroup;return hr.missing(r)?0:this.setNodesSelected({newValue:e,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:n,source:o,nodes:r})},e.prototype.setLastSelectedNode=function(t){this.lastSelectedNode=t},e.prototype.getLastSelectedNode=function(){return this.lastSelectedNode},e.prototype.getSelectedNodes=function(){var t=[];return g(this.selectedNodes,(function(e,n){n&&t.push(n)})),t},e.prototype.getSelectedRows=function(){var t=[];return g(this.selectedNodes,(function(e,n){n&&n.data&&t.push(n.data)})),t},e.prototype.getSelectionCount=function(){return Object.values(this.selectedNodes).length},e.prototype.filterFromSelection=function(t){var e={};Object.entries(this.selectedNodes).forEach((function(n){var o=Cf(n,2),r=o[0],i=o[1];i&&t(i)&&(e[r]=i)})),this.selectedNodes=e},e.prototype.updateGroupsFromChildrenSelections=function(t,e){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;var n=this.rowModel.getRootNode();e||(e=new Gh(!0,n)).setInactive();var o=!1;return e.forEachChangedNodeDepthFirst((function(e){if(e!==n){var r=e.calculateSelectedFromChildren();o=e.selectThisNode(null!==r&&r,void 0,t)||o}})),o},e.prototype.clearOtherNodes=function(t,e){var n=this,o={},r=0;return g(this.selectedNodes,(function(i,s){if(s&&s.id!==t.id){var a=n.selectedNodes[s.id];r+=a.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:e}),n.groupSelectsChildren&&s.parent&&(o[s.parent.id]=s.parent)}})),g(o,(function(t,n){var o=n.calculateSelectedFromChildren();n.selectThisNode(null!==o&&o,void 0,e)})),r},e.prototype.onRowSelected=function(t){var e=t.node;this.groupSelectsChildren&&e.group||(e.isSelected()?this.selectedNodes[e.id]=e:delete this.selectedNodes[e.id])},e.prototype.syncInRowNode=function(t,e){this.syncInOldRowNode(t,e),this.syncInNewRowNode(t)},e.prototype.syncInOldRowNode=function(t,e){if(r(e)&&t.id!==e.id&&e){var n=e.id;this.selectedNodes[n]==t&&(this.selectedNodes[e.id]=e)}},e.prototype.syncInNewRowNode=function(t){r(this.selectedNodes[t.id])?(t.setSelectedInitialValue(!0),this.selectedNodes[t.id]=t):t.setSelectedInitialValue(!1)},e.prototype.reset=function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null},e.prototype.getBestCostNodeSelection=function(){if("clientSide"===this.rowModel.getType()){var t=this.rowModel.getTopLevelNodes();if(null!==t){var e=[];return function t(n){for(var o=0,r=n.length;o<r;o++){var i=n[o];if(i.isSelected())e.push(i);else{var s=i;s.group&&s.children&&t(s.children)}}}(t),e}}},e.prototype.isEmpty=function(){var t=0;return g(this.selectedNodes,(function(e,n){n&&t++})),0===t},e.prototype.deselectAllRowNodes=function(t){var e=function(t){return t.selectThisNode(!1,void 0,o)},n="clientSide"===this.rowModel.getType(),o=t.source,r=t.justFiltered,i=t.justCurrentPage;if(i||r){if(!n)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(r,i).forEach(e)}else g(this.selectedNodes,(function(t,n){n&&e(n)})),this.reset();n&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(o);var s={type:Zt.EVENT_SELECTION_CHANGED,source:o};this.eventService.dispatchEvent(s)},e.prototype.getSelectAllState=function(t,e){var n=this,o=0,r=0;return this.getNodesToSelect(t,e).forEach((function(t){n.groupSelectsChildren&&t.group||(t.isSelected()?o++:t.selectable&&r++)})),(0!==o||0!==r)&&(o>0&&r>0?null:o>0)},e.prototype.getNodesToSelect=function(t,e){var n=this;if(void 0===t&&(t=!1),void 0===e&&(e=!1),"clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var o=[];if(e)return this.paginationProxy.forEachNodeOnPage((function(t){if(t.group)if(t.expanded)n.groupSelectsChildren||o.push(t);else{var e=function(t){var n;o.push(t),(null===(n=t.childrenAfterFilter)||void 0===n?void 0:n.length)&&t.childrenAfterFilter.forEach(e)};e(t)}else o.push(t)})),o;var r=this.rowModel;return t?(r.forEachNodeAfterFilter((function(t){o.push(t)})),o):(r.forEachNode((function(t){o.push(t)})),o)},e.prototype.selectAllRowNodes=function(t){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var e=t.source,n=t.justFiltered,o=t.justCurrentPage;this.getNodesToSelect(n,o).forEach((function(t){return t.selectThisNode(!0,void 0,e)})),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(e);var r={type:Zt.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(r)},e.prototype.getServerSideSelectionState=function(){return null},e.prototype.setServerSideSelectionState=function(t){},vf([$("rowModel")],e.prototype,"rowModel",void 0),vf([$("paginationProxy")],e.prototype,"paginationProxy",void 0),vf([_f(0,nt("loggerFactory"))],e.prototype,"setBeans",null),vf([Z],e.prototype,"init",null),e=vf([Q("selectionService")],e)}(Ht),bf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xf=function(){function t(){}return t.prototype.sizeColumnsToFit=function(t){"undefined"===typeof t&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(t,"api")},t.prototype.setColumnGroupOpened=function(t,e){this.columnModel.setColumnGroupOpened(t,e,"api")},t.prototype.getColumnGroup=function(t,e){return this.columnModel.getColumnGroup(t,e)},t.prototype.getProvidedColumnGroup=function(t){return this.columnModel.getProvidedColumnGroup(t)},t.prototype.getDisplayNameForColumn=function(t,e){return this.columnModel.getDisplayNameForColumn(t,e)||""},t.prototype.getDisplayNameForColumnGroup=function(t,e){return this.columnModel.getDisplayNameForColumnGroup(t,e)||""},t.prototype.getColumn=function(t){return this.columnModel.getPrimaryColumn(t)},t.prototype.getColumns=function(){return this.columnModel.getAllPrimaryColumns()},t.prototype.applyColumnState=function(t){return this.columnModel.applyColumnState(t,"api")},t.prototype.getColumnState=function(){return this.columnModel.getColumnState()},t.prototype.resetColumnState=function(){this.columnModel.resetColumnState("api")},t.prototype.getColumnGroupState=function(){return this.columnModel.getColumnGroupState()},t.prototype.setColumnGroupState=function(t){this.columnModel.setColumnGroupState(t,"api")},t.prototype.resetColumnGroupState=function(){this.columnModel.resetColumnGroupState("api")},t.prototype.isPinning=function(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()},t.prototype.isPinningLeft=function(){return this.columnModel.isPinningLeft()},t.prototype.isPinningRight=function(){return this.columnModel.isPinningRight()},t.prototype.getDisplayedColAfter=function(t){return this.columnModel.getDisplayedColAfter(t)},t.prototype.getDisplayedColBefore=function(t){return this.columnModel.getDisplayedColBefore(t)},t.prototype.setColumnVisible=function(t,e){this.columnModel.setColumnVisible(t,e,"api")},t.prototype.setColumnsVisible=function(t,e){this.columnModel.setColumnsVisible(t,e,"api")},t.prototype.setColumnPinned=function(t,e){this.columnModel.setColumnPinned(t,e,"api")},t.prototype.setColumnsPinned=function(t,e){this.columnModel.setColumnsPinned(t,e,"api")},t.prototype.getAllGridColumns=function(){return this.columnModel.getAllGridColumns()},t.prototype.getDisplayedLeftColumns=function(){return this.columnModel.getDisplayedLeftColumns()},t.prototype.getDisplayedCenterColumns=function(){return this.columnModel.getDisplayedCenterColumns()},t.prototype.getDisplayedRightColumns=function(){return this.columnModel.getDisplayedRightColumns()},t.prototype.getAllDisplayedColumns=function(){return this.columnModel.getAllDisplayedColumns()},t.prototype.getAllDisplayedVirtualColumns=function(){return this.columnModel.getViewportColumns()},t.prototype.moveColumn=function(t,e){this.columnModel.moveColumn(t,e,"api")},t.prototype.moveColumnByIndex=function(t,e){this.columnModel.moveColumnByIndex(t,e,"api")},t.prototype.moveColumns=function(t,e){this.columnModel.moveColumns(t,e,"api")},t.prototype.moveRowGroupColumn=function(t,e){this.columnModel.moveRowGroupColumn(t,e)},t.prototype.setColumnAggFunc=function(t,e){this.columnModel.setColumnAggFunc(t,e)},t.prototype.setColumnWidth=function(t,e,n,o){void 0===n&&(n=!0),this.columnModel.setColumnWidths([{key:t,newWidth:e}],!1,n,o)},t.prototype.setColumnWidths=function(t,e,n){void 0===e&&(e=!0),this.columnModel.setColumnWidths(t,!1,e,n)},t.prototype.setPivotMode=function(t){this.columnModel.setPivotMode(t)},t.prototype.isPivotMode=function(){return this.columnModel.isPivotMode()},t.prototype.getPivotResultColumn=function(t,e){return this.columnModel.getSecondaryPivotColumn(t,e)},t.prototype.setValueColumns=function(t){this.columnModel.setValueColumns(t,"api")},t.prototype.getValueColumns=function(){return this.columnModel.getValueColumns()},t.prototype.removeValueColumn=function(t){this.columnModel.removeValueColumn(t,"api")},t.prototype.removeValueColumns=function(t){this.columnModel.removeValueColumns(t,"api")},t.prototype.addValueColumn=function(t){this.columnModel.addValueColumn(t,"api")},t.prototype.addValueColumns=function(t){this.columnModel.addValueColumns(t,"api")},t.prototype.setRowGroupColumns=function(t){this.columnModel.setRowGroupColumns(t,"api")},t.prototype.removeRowGroupColumn=function(t){this.columnModel.removeRowGroupColumn(t,"api")},t.prototype.removeRowGroupColumns=function(t){this.columnModel.removeRowGroupColumns(t,"api")},t.prototype.addRowGroupColumn=function(t){this.columnModel.addRowGroupColumn(t,"api")},t.prototype.addRowGroupColumns=function(t){this.columnModel.addRowGroupColumns(t,"api")},t.prototype.getRowGroupColumns=function(){return this.columnModel.getRowGroupColumns()},t.prototype.setPivotColumns=function(t){this.columnModel.setPivotColumns(t,"api")},t.prototype.removePivotColumn=function(t){this.columnModel.removePivotColumn(t,"api")},t.prototype.removePivotColumns=function(t){this.columnModel.removePivotColumns(t,"api")},t.prototype.addPivotColumn=function(t){this.columnModel.addPivotColumn(t,"api")},t.prototype.addPivotColumns=function(t){this.columnModel.addPivotColumns(t,"api")},t.prototype.getPivotColumns=function(){return this.columnModel.getPivotColumns()},t.prototype.getLeftDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeLeft()},t.prototype.getCenterDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeCentre()},t.prototype.getRightDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeRight()},t.prototype.getAllDisplayedColumnGroups=function(){return this.columnModel.getAllDisplayedTrees()},t.prototype.autoSizeColumn=function(t,e){return this.columnModel.autoSizeColumn(t,e,"api")},t.prototype.autoSizeColumns=function(t,e){this.columnModel.autoSizeColumns({columns:t,skipHeader:e})},t.prototype.autoSizeAllColumns=function(t){this.columnModel.autoSizeAllColumns(t,"api")},t.prototype.setPivotResultColumns=function(t){this.columnModel.setSecondaryColumns(t,"api")},t.prototype.getPivotResultColumns=function(){return this.columnModel.getSecondaryColumns()},t.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(hr.removeAllReferences.bind(window,this,"Column API"),100)},t.prototype.getAllColumns=function(){return Se("28.0","getAllColumns","getColumns"),this.getColumns()},t.prototype.getPrimaryColumns=function(){return Se("28.0","getPrimaryColumns","getColumns"),this.getColumns()},t.prototype.getSecondaryColumns=function(){return Se("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()},t.prototype.setSecondaryColumns=function(t){Se("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(t)},t.prototype.getSecondaryPivotColumn=function(t,e){return Se("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(t,e)},bf([$("columnModel")],t.prototype,"columnModel",void 0),bf([J],t.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),t=bf([Q("columnApi")],t)}(),Ef=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Sf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.initialised=!1,e.isSsrm=!1,e}return Ef(e,t),e.prototype.init=function(){var t=this;this.isSsrm=this.gridOptionsService.isRowModelType("serverSide"),this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener(Zt.EVENT_CELL_VALUE_CHANGED,(function(e){return t.callColumnCellValueChangedHandler(e)}),this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",(function(e){return t.isTreeData=e.currentValue}))},e.prototype.getValue=function(t,e,n,o){if(void 0===n&&(n=!1),void 0===o&&(o=!1),this.initialised||this.init(),e){var r,i=t.getColDef(),s=i.field,a=t.getColId(),l=e.data,u=e.groupData&&void 0!==e.groupData[a],c=!o&&e.aggData&&void 0!==e.aggData[a],p=this.isSsrm&&o&&!!t.getColDef().aggFunc,h=this.isSsrm&&e.footer&&e.field&&(!0===t.getColDef().showRowGroup||t.getColDef().showRowGroup===e.field);if(n&&i.filterValueGetter?r=this.executeFilterValueGetter(i.filterValueGetter,l,t,e):this.isTreeData&&c?r=e.aggData[a]:this.isTreeData&&i.valueGetter?r=this.executeValueGetter(i.valueGetter,l,t,e):this.isTreeData&&s&&l?r=E(l,s,t.isFieldContainsDots()):u?r=e.groupData[a]:c?r=e.aggData[a]:i.valueGetter?r=this.executeValueGetter(i.valueGetter,l,t,e):h?r=E(l,e.field,t.isFieldContainsDots()):s&&l&&!p&&(r=E(l,s,t.isFieldContainsDots())),this.cellExpressions&&"string"===typeof r&&0===r.indexOf("=")){var d=r.substring(1);r=this.executeValueGetter(d,l,t,e)}if(null==r){var f=this.getOpenedGroup(e,t);if(null!=f)return f}return r}},e.prototype.getOpenedGroup=function(t,e){if(this.gridOptionsService.is("showOpenedGroup")&&e.getColDef().showRowGroup)for(var n=e.getColDef().showRowGroup,o=t.parent;null!=o;){if(o.rowGroupColumn&&(!0===n||n===o.rowGroupColumn.getColId()))return o.key;o=o.parent}},e.prototype.setValue=function(t,e,n,o){var s=this.columnModel.getPrimaryColumn(e);if(!t||!s)return!1;i(t.data)&&(t.data={});var a=s.getColDef(),l=a.field,u=a.valueSetter;if(i(l)&&i(u))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(s,n))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;var c,p={node:t,data:t.data,oldValue:this.getValue(s,t),newValue:n,colDef:s.getColDef(),column:s,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};if(p.newValue=n,void 0===(c=r(u)?"function"===typeof u?u(p):this.expressionService.evaluate(u,p):this.setValueUsingField(t.data,l,n,s.isFieldContainsDots()))&&(c=!0),!c)return!1;t.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),p.newValue=this.getValue(s,t);var h={type:Zt.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:p.column,api:p.api,columnApi:p.columnApi,colDef:p.colDef,context:p.context,data:t.data,node:t,oldValue:p.oldValue,newValue:p.newValue,value:p.newValue,source:o};return this.eventService.dispatchEvent(h),!0},e.prototype.callColumnCellValueChangedHandler=function(t){var e=t.colDef.onCellValueChanged;"function"===typeof e&&e({node:t.node,data:t.data,oldValue:t.oldValue,newValue:t.newValue,colDef:t.colDef,column:t.column,api:t.api,columnApi:t.columnApi,context:t.context})},e.prototype.setValueUsingField=function(t,e,n,o){if(!e)return!1;var r=!1;if(o)for(var i=e.split("."),s=t;i.length>0&&s;){var a=i.shift();0===i.length?(r=s[a]==n)||(s[a]=n):s=s[a]}else(r=t[e]==n)||(t[e]=n);return!r},e.prototype.executeFilterValueGetter=function(t,e,n,o){var r={data:e,node:o,column:n,colDef:n.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,o)};return"function"===typeof t?t(r):this.expressionService.evaluate(t,r)},e.prototype.executeValueGetter=function(t,e,n,o){var r=n.getColId(),i=this.valueCache.getValue(o,r);if(void 0!==i)return i;var s,a={data:e,node:o,column:n,colDef:n.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,o)};return s="function"===typeof t?t(a):this.expressionService.evaluate(t,a),this.valueCache.setValue(o,r,s),s},e.prototype.getValueCallback=function(t,e){var n=this.columnModel.getPrimaryColumn(e);return n?this.getValue(n,t):null},e.prototype.getKeyForNode=function(t,e){var n=this.getValue(t,e),o=t.getColDef().keyCreator,r=n;o&&(r=o({value:n,colDef:t.getColDef(),column:t,node:e,data:e.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}));return"string"===typeof r||null==r||"[object Object]"===(r=String(r))&&P((function(){console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")}),"getKeyForNode - warn about [object,object]"),r},Sf([$("expressionService")],e.prototype,"expressionService",void 0),Sf([$("columnModel")],e.prototype,"columnModel",void 0),Sf([$("valueCache")],e.prototype,"valueCache",void 0),Sf([$("dataTypeService")],e.prototype,"dataTypeService",void 0),Sf([Z],e.prototype,"init",null),e=Sf([Q("valueService")],e)}(Ht),Rf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Of=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Pf=function(t,e){return function(n,o){e(n,o,t)}},If=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.expressionToFunctionCache={},e}return Rf(e,t),e.prototype.setBeans=function(t){this.logger=t.create("ExpressionService")},e.prototype.evaluate=function(t,e){if("string"===typeof t)return this.evaluateExpression(t,e);console.error("AG Grid: value should be either a string or a function",t)},e.prototype.evaluateExpression=function(t,e){try{return this.createExpressionFunction(t)(e.value,e.context,e.oldValue,e.newValue,e.value,e.node,e.data,e.colDef,e.rowIndex,e.api,e.columnApi,e.getValue,e.column,e.columnGroup)}catch(n){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Params =",e),console.log("Exception = "+n),null}},e.prototype.createExpressionFunction=function(t){if(this.expressionToFunctionCache[t])return this.expressionToFunctionCache[t];var e=this.createFunctionBody(t),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",e);return this.expressionToFunctionCache[t]=n,n},e.prototype.createFunctionBody=function(t){return t.indexOf("return")>=0?t:"return "+t+";"},Of([Pf(0,nt("loggerFactory"))],e.prototype,"setBeans",null),e=Of([Q("expressionService")],e)}(Ht),Af=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Df=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Mf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateCache={},e.waitingCallbacks={},e}return Af(e,t),e.prototype.getTemplate=function(t,e){var n=this.templateCache[t];if(n)return n;var o=this.waitingCallbacks[t],r=this;if(!o){o=[],this.waitingCallbacks[t]=o;var i=new XMLHttpRequest;i.onload=function(){r.handleHttpResult(this,t)},i.open("GET",t),i.send()}return e&&o.push(e),null},e.prototype.handleHttpResult=function(t,e){if(200===t.status&&null!==t.response){this.templateCache[e]=t.response||t.responseText;for(var n=this.waitingCallbacks[e],o=0;o<n.length;o++){(0,n[o])()}}else console.warn("AG Grid: Unable to get template error "+t.status+" - "+e)},e=Df([Q("templateService")],e)}(Ht),Lf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Nf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ff=function(t,e){return function(n,o){e(n,o,t)}},kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lf(e,t),e.prototype.setBeans=function(t){this.logging=t.is("debug")},e.prototype.create=function(t){return new Gf(t,this.isLogging.bind(this))},e.prototype.isLogging=function(){return this.logging},Nf([Ff(0,nt("gridOptionsService"))],e.prototype,"setBeans",null),e=Nf([Q("loggerFactory")],e)}(Ht),Gf=function(){function t(t,e){this.name=t,this.isLoggingFunc=e}return t.prototype.isLogging=function(){return this.isLoggingFunc()},t.prototype.log=function(t){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+t)},t}(),Bf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Vf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},zf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Bf(e,t),e.prototype.setComp=function(t,e,n){var o=this;this.view=t,this.eGridHostDiv=e,this.eGui=n,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:function(){return o.eGui},isInterestedIn:function(t){return t===Hi.HeaderCell||t===Hi.ToolPanel},getIconName:function(){return qs.ICON_NOT_ALLOWED}}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(e),this.createManagedBean(new Sl(this.view)),this.addRtlSupport(),this.addManagedListener(this,Zt.EVENT_KEYBOARD_FOCUS,(function(){o.view.addOrRemoveKeyboardFocusClass(!0)})),this.addManagedListener(this,Zt.EVENT_MOUSE_FOCUS,(function(){o.view.addOrRemoveKeyboardFocusClass(!1)}));var r=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((function(){return r()})),this.ctrlsService.registerGridCtrl(this)},e.prototype.isDetailGrid=function(){var t,e=this.focusService.findTabbableParent(this.getGui());return(null===(t=null===e||void 0===e?void 0:e.getAttribute("row-id"))||void 0===t?void 0:t.startsWith("detail"))||!1},e.prototype.showDropZones=function(){return W.__isRegistered(z.RowGroupingModule,this.context.getGridId())},e.prototype.showSideBar=function(){return W.__isRegistered(z.SideBarModule,this.context.getGridId())},e.prototype.showStatusBar=function(){return W.__isRegistered(z.StatusBarModule,this.context.getGridId())},e.prototype.showWatermark=function(){return W.__isRegistered(z.EnterpriseCoreModule,this.context.getGridId())},e.prototype.onGridSizeChanged=function(){var t={type:Zt.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(t)},e.prototype.addRtlSupport=function(){var t=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(t)},e.prototype.destroyGridUi=function(){this.view.destroyGridUi()},e.prototype.getGui=function(){return this.eGui},e.prototype.setResizeCursor=function(t){this.view.setCursor(t?"ew-resize":null)},e.prototype.disableUserSelect=function(t){this.view.setUserSelect(t?"none":null)},e.prototype.focusNextInnerContainer=function(t){var e=this.gridOptionsService.getDocument(),n=this.view.getFocusableContainers(),o=n.findIndex((function(t){return t.contains(e.activeElement)}))+(t?-1:1);return!(o<=0||o>=n.length)&&this.focusService.focusInto(n[o])},e.prototype.focusInnerElement=function(t){var e=this.view.getFocusableContainers(),n=this.columnModel.getAllDisplayedColumns();if(t){if(e.length>1)return this.focusService.focusInto(yt(e),!0);var o=yt(n);if(this.focusService.focusGridView(o,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(n[0]):this.focusService.focusFirstHeader()},e.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1),this.view.forceFocusOutOfContainer(t)},Vf([$("focusService")],e.prototype,"focusService",void 0),Vf([$("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Vf([$("columnModel")],e.prototype,"columnModel",void 0),Vf([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Vf([$("mouseEventService")],e.prototype,"mouseEventService",void 0),Vf([$("dragAndDropService")],e.prototype,"dragAndDropService",void 0),e}(Ht),jf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Uf=function(t){function e(e){var n=t.call(this)||this;return n.eGridDiv=e,n}return jf(e,t),e.prototype.postConstruct=function(){var t=this;this.logger=this.loggerFactory.create("GridComp");var e={destroyGridUi:function(){return t.destroyBean(t)},setRtlClass:function(e){return t.addCssClass(e)},addOrRemoveKeyboardFocusClass:function(e){return t.addOrRemoveCssClass(vp.AG_KEYBOARD_FOCUS,e)},forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:function(e){t.getGui().style.userSelect=null!=e?e:"",t.getGui().style.webkitUserSelect=null!=e?e:""},setCursor:function(e){t.getGui().style.cursor=null!=e?e:""}};this.ctrl=this.createManagedBean(new zf);var n=this.createTemplate();this.setTemplate(n),this.ctrl.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:function(){},focusInnerElement:function(e){return t.ctrl.focusInnerElement(e)}})},e.prototype.insertGridIntoDom=function(){var t=this,e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc((function(){t.eGridDiv.removeChild(e),t.logger.log("Grid removed from DOM")}))},e.prototype.updateLayoutClasses=function(t,e){var n=this.eRootWrapperBody.classList;n.toggle(cl.AUTO_HEIGHT,e.autoHeight),n.toggle(cl.NORMAL,e.normal),n.toggle(cl.PRINT,e.print),this.addOrRemoveCssClass(cl.AUTO_HEIGHT,e.autoHeight),this.addOrRemoveCssClass(cl.NORMAL,e.normal),this.addOrRemoveCssClass(cl.PRINT,e.print)},e.prototype.createTemplate=function(){return'<div class="ag-root-wrapper" role="presentation">\n                '+(this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"")+'\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    '+(this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"")+"\n                </div>\n                "+(this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"")+"\n                <ag-pagination></ag-pagination>\n                "+(this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"")+"\n            </div>"},e.prototype.getFocusableElement=function(){return this.eRootWrapperBody},e.prototype.getFocusableContainers=function(){var t=[this.gridBodyComp.getGui()];return this.sideBarComp&&t.push(this.sideBarComp.getGui()),t.filter((function(t){return Ro(t)}))},Hf([$("loggerFactory")],e.prototype,"loggerFactory",void 0),Hf([Or("gridBody")],e.prototype,"gridBodyComp",void 0),Hf([Or("sideBar")],e.prototype,"sideBarComp",void 0),Hf([Or("rootWrapperBody")],e.prototype,"eRootWrapperBody",void 0),Hf([Z],e.prototype,"postConstruct",null),e}(pd),Wf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Xf=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Yf=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return Wf(e,t),n=e,e.prototype.progressSort=function(t,e,n){var o=this.getNextSortDirection(t);this.setSortForColumn(t,o,e,n)},e.prototype.setSortForColumn=function(t,e,n,o){"asc"!==e&&"desc"!==e&&(e=null);var r=[t];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&t.getColDef().showRowGroup){var i=this.columnModel.getSourceColumnsForGroupColumn(t),s=null===i||void 0===i?void 0:i.filter((function(t){return t.getColDef().sortable}));s&&(r=Yf([t],Xf(s)))}r.forEach((function(t){return t.setSort(e,o)})),(n||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(r,o),this.updateSortIndex(t),this.dispatchSortChangedEvents(o)},e.prototype.updateSortIndex=function(t){var e=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=this.columnModel.getGroupDisplayColumnForGroup(t.getId()),o=e&&n||t,r=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(t){return t.setSortIndex(null)}));var i=r.filter((function(t){return t!==o}));(o.getSort()?Yf(Yf([],Xf(i)),[o]):i).forEach((function(t,e){return t.setSortIndex(e)}))},e.prototype.onSortChanged=function(t){this.dispatchSortChangedEvents(t)},e.prototype.isSortActive=function(){var t=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(t){return!!t.getSort()}));return t&&t.length>0},e.prototype.dispatchSortChangedEvents=function(t){var e={type:Zt.EVENT_SORT_CHANGED,source:t};this.eventService.dispatchEvent(e)},e.prototype.clearSortBarTheseColumns=function(t,e){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(n){t.includes(n)||n.setSort(void 0,e)}))},e.prototype.getNextSortDirection=function(t){var e;if(e=t.getColDef().sortingOrder?t.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):n.DEFAULT_SORTING_ORDER,!Array.isArray(e)||e.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's "+e),null;var o,r=e.indexOf(t.getSort()),i=r<0,s=r==e.length-1;return o=i||s?e[0]:e[r+1],n.DEFAULT_SORTING_ORDER.indexOf(o)<0?(console.warn("AG Grid: invalid sort type "+o),null):o},e.prototype.getIndexedSortMap=function(){var t=this,e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(t){return!!t.getSort()}));if(this.columnModel.isPivotMode()){var n=this.gridOptionsService.isColumnsSortingCoupledToGroup();e=e.filter((function(e){var o=!!e.getAggFunc(),r=!e.isPrimary(),i=n?t.columnModel.getGroupDisplayColumnForGroup(e.getId()):e.getColDef().showRowGroup;return o||r||i}))}var o=this.columnModel.getRowGroupColumns().filter((function(t){return!!t.getSort()})),r=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!o.length;r&&(e=Yf([],Xf(new Set(e.map((function(e){var n;return null!==(n=t.columnModel.getGroupDisplayColumnForGroup(e.getId()))&&void 0!==n?n:e}))))));var i={};e.forEach((function(t,e){return i[t.getId()]=e})),e.sort((function(t,e){var n=t.getSortIndex(),o=e.getSortIndex();return null!=n&&null!=o?n-o:null==n&&null==o?i[t.getId()]>i[e.getId()]?1:-1:null==o?-1:1}));var s=new Map;return e.forEach((function(t,e){return s.set(t,e)})),r&&o.forEach((function(e){var n=t.columnModel.getGroupDisplayColumnForGroup(e.getId());s.set(e,s.get(n))})),s},e.prototype.getColumnsWithSortingOrdered=function(){return Yf([],Xf(this.getIndexedSortMap().entries())).sort((function(t,e){var n=Xf(t,2);n[0];var o=n[1],r=Xf(e,2);return r[0],o-r[1]})).map((function(t){return Xf(t,1)[0]}))},e.prototype.getSortModel=function(){return this.getColumnsWithSortingOrdered().map((function(t){return{sort:t.getSort(),colId:t.getId()}}))},e.prototype.getSortOptions=function(){return this.getColumnsWithSortingOrdered().map((function(t){return{sort:t.getSort(),column:t}}))},e.prototype.canColumnDisplayMixedSort=function(t){var e=this.gridOptionsService.isColumnsSortingCoupledToGroup(),n=!!t.getColDef().showRowGroup;return e&&n},e.prototype.getDisplaySortForColumn=function(t){var e=this.columnModel.getSourceColumnsForGroupColumn(t);if(!this.canColumnDisplayMixedSort(t)||!(null===e||void 0===e?void 0:e.length))return t.getSort();var n=null!=t.getColDef().field||!!t.getColDef().valueGetter?Yf([t],Xf(e)):e,o=n[0].getSort();return n.every((function(t){return t.getSort()==o}))?o:"mixed"},e.prototype.getDisplaySortIndexForColumn=function(t){return this.getIndexedSortMap().get(t)},e.DEFAULT_SORTING_ORDER=["asc","desc",null],qf([$("columnModel")],e.prototype,"columnModel",void 0),e=n=qf([Q("sortController")],e)}(Ht),Zf=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Jf=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zf(e,t),e.prototype.setMouseOver=function(t){this.selectedColumns=t;var e={type:Zt.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)},e.prototype.clearMouseOver=function(){this.selectedColumns=null;var t={type:Zt.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)},e.prototype.isHovered=function(t){return!!this.selectedColumns&&this.selectedColumns.indexOf(t)>=0},e=Jf([Q("columnHoverService")],e)}(Ht),$f=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),tg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},eg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.executeNextFuncs=[],e.executeLaterFuncs=[],e.active=!1,e.animationThreadCount=0,e}return $f(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){return t.gridBodyCtrl=e.gridBodyCtrl}))},e.prototype.isActive=function(){return this.active},e.prototype.start=function(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)},e.prototype.finish=function(){this.active&&(this.flush(),this.active=!1)},e.prototype.executeNextVMTurn=function(t){this.active?this.executeNextFuncs.push(t):t()},e.prototype.executeLaterVMTurn=function(t){this.active?this.executeLaterFuncs.push(t):t()},e.prototype.ensureAnimationCssClassPresent=function(){var t=this;this.animationThreadCount++;var e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push((function(){t.animationThreadCount===e&&t.gridBodyCtrl.setColumnMovingCss(!1)}))},e.prototype.flush=function(){var t=this.executeNextFuncs;this.executeNextFuncs=[];var e=this.executeLaterFuncs;this.executeLaterFuncs=[],0===t.length&&0===e.length||(window.setTimeout((function(){return t.forEach((function(t){return t()}))}),0),window.setTimeout((function(){return e.forEach((function(t){return t()}))}),300))},tg([$("ctrlsService")],e.prototype,"ctrlsService",void 0),tg([Z],e.prototype,"postConstruct",null),e=tg([Q("columnAnimationService")],e)}(Ht),ng=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),og=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},rg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ng(e,t),e.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady((function(e){t.centerRowContainerCon=e.centerRowContainerCtrl,t.addManagedListener(t.eventService,Zt.EVENT_BODY_HEIGHT_CHANGED,t.checkPageSize.bind(t)),t.addManagedListener(t.eventService,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,t.checkPageSize.bind(t)),t.checkPageSize()}))},e.prototype.notActive=function(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon},e.prototype.checkPageSize=function(){var t=this;if(!this.notActive()){var e=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(e>0){var n=function(){var n=t.gridOptionsService.getRowHeightAsNumber(),o=Math.floor(e/n);t.gridOptionsService.set("paginationPageSize",o)};this.isBodyRendered?k((function(){return n()}),50)():(n(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},og([$("ctrlsService")],e.prototype,"ctrlsService",void 0),og([Z],e.prototype,"postConstruct",null),e=og([Q("paginationAutoPageSizeService")],e)}(Ht),ig=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),sg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ag=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cacheVersion=0,e}return ig(e,t),e.prototype.init=function(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")},e.prototype.onDataChanged=function(){this.neverExpires||this.expire()},e.prototype.expire=function(){this.cacheVersion++},e.prototype.setValue=function(t,e,n){this.active&&(t.__cacheVersion!==this.cacheVersion&&(t.__cacheVersion=this.cacheVersion,t.__cacheData={}),t.__cacheData[e]=n)},e.prototype.getValue=function(t,e){if(this.active&&t.__cacheVersion===this.cacheVersion)return t.__cacheData[e]},sg([Z],e.prototype,"init",null),e=sg([Q("valueCache")],e)}(Ht),lg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ug=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},cg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lg(e,t),e.prototype.init=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,Zt.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))},e.prototype.onCellValueChanged=function(t){"paste"!==t.source&&this.doChangeDetection(t.node,t.column)},e.prototype.doChangeDetection=function(t,e){if(!this.gridOptionsService.is("suppressChangeDetection")){var n=[t];if(this.clientSideRowModel&&!t.isRowPinned()){var o=this.gridOptionsService.is("aggregateOnlyChangedColumns"),r=new Gh(o,this.clientSideRowModel.getRootNode());r.addParentNode(t.parent,[e]),this.clientSideRowModel.doAggregate(r),r.forEachChangedNodeDepthFirst((function(t){n.push(t)}))}this.rowRenderer.refreshCells({rowNodes:n})}},ug([$("rowModel")],e.prototype,"rowModel",void 0),ug([$("rowRenderer")],e.prototype,"rowRenderer",void 0),ug([Z],e.prototype,"init",null),e=ug([Q("changeDetectionService")],e)}(Ht),pg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),hg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},dg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pg(e,t),e.prototype.adaptFunction=function(t,e){var n=this.componentMetadataProvider.retrieve(t);return n&&n.functionAdapter?n.functionAdapter(e):null},e.prototype.adaptCellRendererFunction=function(t){return function(){function e(){}return e.prototype.refresh=function(t){return!1},e.prototype.getGui=function(){return this.eGui},e.prototype.init=function(e){var n=t(e),o=typeof n;this.eGui="string"!==o&&"number"!==o&&"boolean"!==o?null!=n?n:Oo("<span></span>"):Oo("<span>"+n+"</span>")},e}()},e.prototype.doesImplementIComponent=function(t){return!!t&&(t.prototype&&"getGui"in t.prototype)},hg([$("componentMetadataProvider")],e.prototype,"componentMetadataProvider",void 0),e=hg([Q("agComponentUtils")],e)}(Ht),fg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},mg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fg(e,t),e.prototype.postConstruct=function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}},e.prototype.retrieve=function(t){return this.componentMetaData[t]},gg([$("agComponentUtils")],e.prototype,"agComponentUtils",void 0),gg([Z],e.prototype,"postConstruct",null),e=gg([Q("componentMetadataProvider")],e)}(Ht),yg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_g=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Cg=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},wg={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},bg={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},xg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.calculatedSizes={},e}return yg(e,t),e.prototype.postConstruct=function(){var t,e=this,n=null!==(t=this.getTheme().el)&&void 0!==t?t:this.eGridDiv;this.mutationObserver=new MutationObserver((function(){e.calculatedSizes={},e.fireGridStylesChangedEvent()})),this.mutationObserver.observe(n||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})},e.prototype.fireGridStylesChangedEvent=function(){var t={type:Zt.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(t)},e.prototype.getSassVariable=function(t){var e=this.getTheme(),n=e.themeFamily,o=e.el;if(n&&0===n.indexOf("ag-theme")){this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[n]||(this.calculatedSizes[n]={});var r=this.calculatedSizes[n][t];return null!=r?r:(this.calculatedSizes[n][t]=this.calculateValueForSassProperty(t,n,o),this.calculatedSizes[n][t])}},e.prototype.calculateValueForSassProperty=function(t,e,n){var o,r="ag-theme-"+(e.match("material")?"material":e.match("balham")?"balham":e.match("alpine")?"alpine":"custom"),i=wg[r][t],s=this.gridOptionsService.getDocument();if(n||(n=this.eGridDiv),!bg[t])return i;var a=bg[t],l=s.createElement("div"),u=Array.from(n.classList);(o=l.classList).add.apply(o,Cg([e],_g(u))),l.style.position="absolute";var c=a.reduce((function(t,e){var n=s.createElement("div");return n.style.position="static",n.classList.add(e),t.appendChild(n),n}),l),p=0;if(s.body){s.body.appendChild(l);var h=-1!==t.toLowerCase().indexOf("height")?"height":"width";p=parseInt(window.getComputedStyle(c)[h],10),s.body.removeChild(l)}return p||i},e.prototype.isThemeDark=function(){var t=this.getTheme().theme;return!!t&&t.indexOf("dark")>=0},e.prototype.chartMenuPanelWidth=function(){return this.getSassVariable("chartMenuPanelWidth")},e.prototype.getTheme=function(){for(var t=/\bag-(material|(?:theme-([\w\-]*)))\b/g,e=this.eGridDiv,n=null,o=[];e;){if(n=t.exec(e.className)){var r=e.className.match(t);r&&(o=r);break}e=e.parentElement||void 0}if(!n)return{allThemes:o};var i=n[0];return{theme:i,el:e,themeFamily:i.replace(/-dark$/,""),allThemes:o}},e.prototype.getFromTheme=function(t,e){var n;return null!==(n=this.getSassVariable(e))&&void 0!==n?n:t},e.prototype.getDefaultRowHeight=function(){return this.getFromTheme(25,"rowHeight")},e.prototype.getListItemHeight=function(){return this.getFromTheme(20,"listItemHeight")},e.prototype.setRowHeightVariable=function(t){var e=t+"px";this.eGridDiv.style.getPropertyValue("--ag-line-height").trim()!=e&&this.eGridDiv.style.setProperty("--ag-line-height",e)},e.prototype.getMinColWidth=function(){var t=this.getFromTheme(null,"headerCellMinWidth");return r(t)?Math.max(t,10):10},e.prototype.destroy=function(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),t.prototype.destroy.call(this)},vg([$("eGridDiv")],e.prototype,"eGridDiv",void 0),vg([Z],e.prototype,"postConstruct",null),e=vg([Q("environment")],e)}(Ht),Eg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Sg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tg=function(t,e){return function(n,o){e(n,o,t)}},Rg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollY=0,e.uiBodyHeight=0,e}return Eg(e,t),e.prototype.agWire=function(t){this.logger=t.create("RowContainerHeightService")},e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Zt.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=jn(),this.logger.log("maxDivHeight = "+this.maxDivHeight)},e.prototype.isStretching=function(){return this.stretching},e.prototype.getDivStretchOffset=function(){return this.divStretchOffset},e.prototype.updateOffset=function(){if(this.stretching){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,e=this.getUiBodyHeight();(t!==this.scrollY||e!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=e,this.calculateOffset())}},e.prototype.calculateOffset=function(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var t=this.scrollY/this.maxScrollY,e=t*this.pixelsToShave;this.logger.log("Div Stretch Offset = "+e+" ("+this.pixelsToShave+" * "+t+")"),this.setDivStretchOffset(e)},e.prototype.setUiContainerHeight=function(t){t!==this.uiContainerHeight&&(this.uiContainerHeight=t,this.eventService.dispatchEvent({type:Zt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))},e.prototype.clearOffset=function(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)},e.prototype.setDivStretchOffset=function(t){var e="number"===typeof t?Math.floor(t):null;this.divStretchOffset!==e&&(this.divStretchOffset=e,this.eventService.dispatchEvent({type:Zt.EVENT_HEIGHT_SCALE_CHANGED}))},e.prototype.setModelHeight=function(t){this.modelHeight=t,this.stretching=null!=t&&this.maxDivHeight>0&&t>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()},e.prototype.getUiContainerHeight=function(){return this.uiContainerHeight},e.prototype.getRealPixelPosition=function(t){return t-this.divStretchOffset},e.prototype.getUiBodyHeight=function(){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return t.bottom-t.top},e.prototype.getScrollPositionForPixel=function(t){if(this.pixelsToShave<=0)return t;var e=t/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*e},Sg([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Sg([Tg(0,nt("loggerFactory"))],e.prototype,"agWire",null),Sg([Z],e.prototype,"postConstruct",null),e=Sg([Q("rowContainerHeightService")],e)}(Ht),Og=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ig=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Og(e,t),e.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")},e.prototype.updateSelectableAfterGrouping=function(t){if(this.isRowSelectableFunc){this.recurseDown(t.childrenAfterGroup,(function(t){return t.childrenAfterGroup}))}},e.prototype.recurseDown=function(t,e){var n=this;t&&t.forEach((function(t){if(t.group){var o;if(t.hasChildren()&&n.recurseDown(e(t),e),n.groupSelectsChildren)o=r((e(t)||[]).find((function(t){return!0===t.selectable})));else o=!!n.isRowSelectableFunc&&n.isRowSelectableFunc(t);t.setRowSelectable(o)}}))},Pg([Z],e.prototype,"init",null),e=Pg([Q("selectableService")],e)}(Ht),Ag=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Dg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Mg=function(t){function e(){var e=t.call(this)||this;return e.previousAndFirstButtonsDisabled=!1,e.nextButtonDisabled=!1,e.lastButtonDisabled=!1,e.areListenersSetup=!1,e}return Ag(e,t),e.prototype.postConstruct=function(){var t=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate());var e=this,n=e.btFirst,o=e.btPrevious,r=e.btNext,i=e.btLast;this.activateTabIndex([n,o,r,i]),n.insertAdjacentElement("afterbegin",Zo(t?"last":"first",this.gridOptionsService)),o.insertAdjacentElement("afterbegin",Zo(t?"next":"previous",this.gridOptionsService)),r.insertAdjacentElement("afterbegin",Zo(t?"previous":"next",this.gridOptionsService)),i.insertAdjacentElement("afterbegin",Zo(t?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()},e.prototype.onPaginationChanged=function(){var t=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())},e.prototype.setupListeners=function(){var t=this;this.areListenersSetup||(this.addManagedListener(this.eventService,Zt.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((function(e){var n=e.el,o=e.fn;t.addManagedListener(n,"click",o),t.addManagedListener(n,"keydown",(function(t){t.key!==Qo.ENTER&&t.key!==Qo.SPACE||(t.preventDefault(),o())}))})),this.areListenersSetup=!0)},e.prototype.onBtFirst=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()},e.prototype.setCurrentPageLabel=function(){var t=this.paginationProxy.getTotalPages()>0,e=this.paginationProxy.getCurrentPage(),n=t?e+1:0;this.lbCurrent.innerHTML=this.formatNumber(n)},e.prototype.formatNumber=function(t){var e=this.gridOptionsService.getCallback("paginationNumberFormatter");if(e)return e({value:t});var n=this.localeService.getLocaleTextFunc();return Jn(t,n("thousandSeparator",","),n("decimalSeparator","."))},e.prototype.getTemplate=function(){var t=this.localeService.getLocaleTextFunc(),e=t("page","Page"),n=t("to","to"),o=t("of","of"),r=t("firstPage","First Page"),i=t("previousPage","Previous Page"),s=t("nextPage","Next Page"),a=t("lastPage","Last Page"),l=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'+l+'">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-'+l+'-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+l+'-to">'+n+'</span>\n                    <span id="ag-'+l+'-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+l+'-of">'+o+'</span>\n                    <span id="ag-'+l+'-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="'+r+'"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="'+i+'"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-'+l+'-start-page">'+e+'</span>\n                        <span id="ag-'+l+'-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-'+l+'-of-page">'+o+'</span>\n                        <span id="ag-'+l+'-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="'+s+'"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="'+a+'"></div>\n                </span>\n            </div>'},e.prototype.onBtNext=function(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()},e.prototype.onBtPrevious=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()},e.prototype.onBtLast=function(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()},e.prototype.enableOrDisableButtons=function(){var t=this.paginationProxy.getCurrentPage(),e=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===t,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);var o=this.isZeroPagesToDisplay(),r=e&&t===n-1;this.nextButtonDisabled=r||o,this.lastButtonDisabled=!e||o||t===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)},e.prototype.toggleButtonDisabled=function(t,e){an(t,e),t.classList.toggle("ag-disabled",e)},e.prototype.updateRowLabels=function(){var t,e,n=this.paginationProxy.getCurrentPage(),o=this.paginationProxy.getPageSize(),r=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;if(this.isZeroPagesToDisplay()?t=e=0:(e=(t=o*n+1)+o-1,r&&e>i&&(e=i)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(t),this.rowNodeBlockLoader.isLoading()){var s=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=s("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(e)},e.prototype.isZeroPagesToDisplay=function(){var t=this.paginationProxy.isLastPageFound(),e=this.paginationProxy.getTotalPages();return t&&0===e},e.prototype.setTotalLabels=function(){var t=this.paginationProxy.isLastPageFound(),e=this.paginationProxy.getTotalPages(),n=t?this.paginationProxy.getMasterRowCount():null;if(1===n){var o=this.paginationProxy.getRow(0);if(o&&o.group&&!(o.groupData||o.aggData))return void this.setTotalLabelsToZero()}if(t)this.lbTotal.innerHTML=this.formatNumber(e),this.lbRecordCount.innerHTML=this.formatNumber(n);else{var r=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=r,this.lbRecordCount.innerHTML=r}},e.prototype.setTotalLabelsToZero=function(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)},Dg([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Dg([$("rowNodeBlockLoader")],e.prototype,"rowNodeBlockLoader",void 0),Dg([Or("btFirst")],e.prototype,"btFirst",void 0),Dg([Or("btPrevious")],e.prototype,"btPrevious",void 0),Dg([Or("btNext")],e.prototype,"btNext",void 0),Dg([Or("btLast")],e.prototype,"btLast",void 0),Dg([Or("lbRecordCount")],e.prototype,"lbRecordCount",void 0),Dg([Or("lbFirstRowOnPage")],e.prototype,"lbFirstRowOnPage",void 0),Dg([Or("lbLastRowOnPage")],e.prototype,"lbLastRowOnPage",void 0),Dg([Or("lbCurrent")],e.prototype,"lbCurrent",void 0),Dg([Or("lbTotal")],e.prototype,"lbTotal",void 0),Dg([Z],e.prototype,"postConstruct",null),e}(Tr),Lg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ng=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.Loading=0]="Loading",t[t.NoRows=1]="NoRows"}(Xd||(Xd={}));var Fg=function(t){function e(){var n=t.call(this,e.TEMPLATE)||this;return n.inProgress=!1,n.destroyRequested=!1,n.manuallyDisplayed=!1,n}return Lg(e,t),e.prototype.updateLayoutClasses=function(t,e){var n=this.eOverlayWrapper.classList;n.toggle(cl.AUTO_HEIGHT,e.autoHeight),n.toggle(cl.NORMAL,e.normal),n.toggle(cl.PRINT,e.print)},e.prototype.postConstruct=function(){this.createManagedBean(new Sl(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,Zt.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)},e.prototype.setWrapperTypeClass=function(t){var e=this.eOverlayWrapper.classList;e.toggle("ag-overlay-loading-wrapper",t===Xd.Loading),e.toggle("ag-overlay-no-rows-wrapper",t===Xd.NoRows)},e.prototype.showLoadingOverlay=function(){if(!this.gridOptionsService.is("suppressLoadingOverlay")){var t=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(t,Xd.Loading)}},e.prototype.showNoRowsOverlay=function(){if(!this.gridOptionsService.is("suppressNoRowsOverlay")){var t=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(t,Xd.NoRows)}},e.prototype.showOverlay=function(t,e){var n=this;this.inProgress||(this.setWrapperTypeClass(e),this.destroyActiveOverlay(),this.inProgress=!0,t&&t.then((function(t){n.inProgress=!1,n.eOverlayWrapper.appendChild(t.getGui()),n.activeOverlay=t,n.destroyRequested&&(n.destroyRequested=!1,n.destroyActiveOverlay())})),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))},e.prototype.destroyActiveOverlay=function(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),So(this.eOverlayWrapper))},e.prototype.hideOverlay=function(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})},e.prototype.destroy=function(){this.destroyActiveOverlay(),t.prototype.destroy.call(this)},e.prototype.showOrHideOverlay=function(){var t=this.paginationProxy.isEmpty(),e=this.gridOptionsService.is("suppressNoRowsOverlay");t&&!e?this.showNoRowsOverlay():this.hideOverlay()},e.prototype.onRowDataUpdated=function(){this.showOrHideOverlay()},e.prototype.onNewColumnsLoaded=function(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()},e.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',Ng([$("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Ng([$("paginationProxy")],e.prototype,"paginationProxy",void 0),Ng([$("gridApi")],e.prototype,"gridApi",void 0),Ng([$("columnModel")],e.prototype,"columnModel",void 0),Ng([Or("eOverlayWrapper")],e.prototype,"eOverlayWrapper",void 0),Ng([Z],e.prototype,"postConstruct",null),e}(Tr),kg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Gg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Bg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kg(e,t),e.prototype.getFirstRow=function(){var t,e=0;return this.pinnedRowModel.getPinnedTopRowCount()?t="top":this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(t="bottom"),void 0===t?null:{rowIndex:e,rowPinned:t}},e.prototype.getLastRow=function(){var t,e=null,n=this.pinnedRowModel.getPinnedBottomRowCount(),o=this.pinnedRowModel.getPinnedTopRowCount();return n?(e="bottom",t=n-1):this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageLastRow()):o&&(e="top",t=o-1),void 0===t?null:{rowIndex:t,rowPinned:e}},e.prototype.getRowNode=function(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},e.prototype.sameRow=function(t,e){return!t&&!e||!(t&&!e||!t&&e)&&(t.rowIndex===e.rowIndex&&t.rowPinned==e.rowPinned)},e.prototype.before=function(t,e){switch(t.rowPinned){case"top":if("top"!==e.rowPinned)return!0;break;case"bottom":if("bottom"!==e.rowPinned)return!1;break;default:if(r(e.rowPinned))return"top"!==e.rowPinned}return t.rowIndex<e.rowIndex},e.prototype.rowMax=function(t){var e,n=this;return t.forEach((function(t){(void 0===e||n.before(e,t))&&(e=t)})),e},e.prototype.rowMin=function(t){var e,n=this;return t.forEach((function(t){(void 0===e||n.before(t,e))&&(e=t)})),e},Gg([$("rowModel")],e.prototype,"rowModel",void 0),Gg([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Gg([$("paginationProxy")],e.prototype,"paginationProxy",void 0),e=Gg([Q("rowPositionUtils")],e)}(Ht),Vg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vg(e,t),e.prototype.createId=function(t){var e=t.rowIndex,n=t.rowPinned,o=t.column;return this.createIdFromValues({rowIndex:e,column:o,rowPinned:n})},e.prototype.createIdFromValues=function(t){var e=t.rowIndex,n=t.rowPinned;return e+"."+(null==n?"null":n)+"."+t.column.getId()},e.prototype.equals=function(t,e){var n=t.column===e.column,o=t.rowPinned===e.rowPinned,r=t.rowIndex===e.rowIndex;return n&&o&&r},e=zg([Q("cellPositionUtils")],e)}(Ht),Hg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ug=function(t){this.cellValueChanges=t},Wg=function(t){function e(e,n,o,r){var i=t.call(this,e)||this;return i.initialRange=n,i.finalRange=o,i.ranges=r,i}return Hg(e,t),e}(Ug),qg=function(){function t(e){this.actionStack=[],this.maxStackSize=e||t.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}return t.prototype.pop=function(){return this.actionStack.pop()},t.prototype.push=function(t){t.cellValueChanges&&t.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(t))},t.prototype.clear=function(){this.actionStack=[]},t.prototype.getCurrentStackSize=function(){return this.actionStack.length},t.DEFAULT_STACK_SIZE=10,t}(),Xg=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yg=function(){return Yg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Yg.apply(this,arguments)},Kg=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Zg=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Jg=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},Qg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cellValueChanges=[],e.activeCellEdit=null,e.activeRowEdit=null,e.isPasting=!1,e.isRangeInAction=!1,e.onCellValueChanged=function(t){var n={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned},o=null!==e.activeCellEdit&&e.cellPositionUtils.equals(e.activeCellEdit,n),r=null!==e.activeRowEdit&&e.rowPositionUtils.sameRow(e.activeRowEdit,n);if(o||r||e.isPasting||e.isRangeInAction){var i=t.rowPinned,s=t.rowIndex,a=t.column,l=t.oldValue,u=t.value,c={rowPinned:i,rowIndex:s,columnId:a.getColId(),newValue:u,oldValue:l};e.cellValueChanges.push(c)}},e.clearStacks=function(){e.undoStack.clear(),e.redoStack.clear()},e}return Xg(e,t),e.prototype.init=function(){var t=this;if(this.gridOptionsService.is("undoRedoCellEditing")){var e=this.gridOptionsService.getNum("undoRedoCellEditingLimit");e<=0||(this.undoStack=new qg(e),this.redoStack=new qg(e),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,Zt.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,Zt.EVENT_MODEL_UPDATED,(function(e){e.keepUndoRedoStack||t.clearStacks()})),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,Zt.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady((function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl()})))}},e.prototype.getCurrentUndoStackSize=function(){return this.undoStack?this.undoStack.getCurrentStackSize():0},e.prototype.getCurrentRedoStackSize=function(){return this.redoStack?this.redoStack.getCurrentStackSize():0},e.prototype.undo=function(t){var e={type:Zt.EVENT_UNDO_STARTED,source:t};this.eventService.dispatchEvent(e);var n=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),o={type:Zt.EVENT_UNDO_ENDED,source:t,operationPerformed:n};this.eventService.dispatchEvent(o)},e.prototype.redo=function(t){var e={type:Zt.EVENT_REDO_STARTED,source:t};this.eventService.dispatchEvent(e);var n=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),o={type:Zt.EVENT_REDO_ENDED,source:t,operationPerformed:n};this.eventService.dispatchEvent(o)},e.prototype.undoRedo=function(t,e,n,o,r){if(!t)return!1;var i=t.pop();return!(!i||!i.cellValueChanges)&&(this.processAction(i,(function(t){return t[o]}),r),i instanceof Wg?this.processRange(i.ranges||[i[n]]):this.processCell(i.cellValueChanges),e.push(i),!0)},e.prototype.processAction=function(t,e,n){var o=this;t.cellValueChanges.forEach((function(t){var r=t.rowIndex,i=t.rowPinned,s=t.columnId,a={rowIndex:r,rowPinned:i},l=o.getRowNode(a);l.displayed&&l.setDataValue(s,e(t),n)}))},e.prototype.processRange=function(t){var e,n=this;this.rangeService.removeAllCellRanges(!0),t.forEach((function(o,r){if(o){var i=o.startRow,s=o.endRow;r===t.length-1&&(e={rowPinned:i.rowPinned,rowIndex:i.rowIndex,columnId:o.startColumn.getColId()},n.setLastFocusedCell(e));var a={rowStartIndex:i.rowIndex,rowStartPinned:i.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:o.startColumn,columns:o.columns};n.rangeService.addCellRange(a)}}))},e.prototype.processCell=function(t){var e=t[0],n={rowIndex:e.rowIndex,rowPinned:e.rowPinned},o=this.getRowNode(n),r={rowPinned:e.rowPinned,rowIndex:o.rowIndex,columnId:e.columnId};this.setLastFocusedCell(r,!!this.rangeService)},e.prototype.setLastFocusedCell=function(t,e){var n=t.rowIndex,o=t.columnId,r=t.rowPinned,i=this.gridBodyCtrl.getScrollFeature(),s=this.columnModel.getGridColumn(o);if(s){i.ensureIndexVisible(n),i.ensureColumnVisible(s);var a={rowIndex:n,column:s,rowPinned:r};this.focusService.setFocusedCell(Yg(Yg({},a),{forceBrowserFocus:!0})),e&&this.rangeService.setRangeToCell(a)}},e.prototype.addRowEditingListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_ROW_EDITING_STARTED,(function(e){t.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}})),this.addManagedListener(this.eventService,Zt.EVENT_ROW_EDITING_STOPPED,(function(){var e=new Ug(t.cellValueChanges);t.pushActionsToUndoStack(e),t.activeRowEdit=null}))},e.prototype.addCellEditingListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_CELL_EDITING_STARTED,(function(e){t.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}})),this.addManagedListener(this.eventService,Zt.EVENT_CELL_EDITING_STOPPED,(function(e){if(t.activeCellEdit=null,e.valueChanged&&!t.activeRowEdit&&!t.isPasting&&!t.isRangeInAction){var n=new Ug(t.cellValueChanges);t.pushActionsToUndoStack(n)}}))},e.prototype.addPasteListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_PASTE_START,(function(){t.isPasting=!0})),this.addManagedListener(this.eventService,Zt.EVENT_PASTE_END,(function(){var e=new Ug(t.cellValueChanges);t.pushActionsToUndoStack(e),t.isPasting=!1}))},e.prototype.addFillListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_FILL_START,(function(){t.isRangeInAction=!0})),this.addManagedListener(this.eventService,Zt.EVENT_FILL_END,(function(e){var n=new Wg(t.cellValueChanges,e.initialRange,e.finalRange);t.pushActionsToUndoStack(n),t.isRangeInAction=!1}))},e.prototype.addCellKeyListeners=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,(function(){t.isRangeInAction=!0})),this.addManagedListener(this.eventService,Zt.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,(function(){var e;e=t.rangeService&&t.gridOptionsService.isEnableRangeSelection()?new Wg(t.cellValueChanges,void 0,void 0,Jg([],Zg(t.rangeService.getCellRanges()))):new Ug(t.cellValueChanges),t.pushActionsToUndoStack(e),t.isRangeInAction=!1}))},e.prototype.pushActionsToUndoStack=function(t){this.undoStack.push(t),this.cellValueChanges=[],this.redoStack.clear()},e.prototype.getRowNode=function(t){switch(t.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},Kg([$("focusService")],e.prototype,"focusService",void 0),Kg([$("ctrlsService")],e.prototype,"ctrlsService",void 0),Kg([$("rowModel")],e.prototype,"rowModel",void 0),Kg([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Kg([$("cellPositionUtils")],e.prototype,"cellPositionUtils",void 0),Kg([$("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),Kg([$("columnModel")],e.prototype,"columnModel",void 0),Kg([tt("rangeService")],e.prototype,"rangeService",void 0),Kg([Z],e.prototype,"init",null),e=Kg([Q("undoRedoService")],e)}(Ht),$g=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),tm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},em=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $g(e,t),e.prototype.findHeader=function(t,e){var n,o,r;if(t.column instanceof Kt?(o="getDisplayedGroup"+e,n=this.columnModel[o](t.column)):(r="getDisplayedCol"+e,n=this.columnModel[r](t.column)),n){var i=t.headerRowIndex;if(this.getHeaderRowType(i)===wc.COLUMN_GROUP){var s=n;if(s.isPadding()&&this.isAnyChildSpanningHeaderHeight(s)){var a=this.getColumnVisibleChild(s,i,e),l=a.nextFocusColumn,u=a.nextRow;l&&(n=l,i=u)}}return{column:n,headerRowIndex:i}}},e.prototype.isAnyChildSpanningHeaderHeight=function(t){return!!t&&t.getLeafColumns().some((function(t){return t.isSpanHeaderHeight()}))},e.prototype.getColumnVisibleParent=function(t,e){var n=this.getHeaderRowType(e),o=n===wc.FLOATING_FILTER,r=n===wc.COLUMN,i=o?t:t.getParent(),s=e-1;if(r&&this.isAnyChildSpanningHeaderHeight(t.getParent())){for(;i&&i.isPadding();)i=i.getParent(),s--;s<0&&(i=t,s=e)}return{nextFocusColumn:i,nextRow:s}},e.prototype.getColumnVisibleChild=function(t,e,n){void 0===n&&(n="After");var o=t,r=e+1;if(this.getHeaderRowType(e)===wc.COLUMN_GROUP){var i=t.getLeafColumns(),s="After"===n?i[0]:yt(i);if(this.isAnyChildSpanningHeaderHeight(s.getParent())){o=s;for(var a=s.getParent();a&&a!==t;)a=a.getParent(),r++}else o=t.getDisplayedChildren()[0]}return{nextFocusColumn:o,nextRow:r}},e.prototype.getHeaderRowType=function(t){var e=this.ctrlsService.getHeaderRowContainerCtrl();if(e)return e.getRowType(t)},e.prototype.findColAtEdgeForHeaderRow=function(t,e){var n=this.columnModel.getAllDisplayedColumns(),o=n["start"===e?0:n.length-1];if(o){var r=this.ctrlsService.getHeaderRowContainerCtrl(o.getPinned()).getRowType(t);return r==wc.COLUMN_GROUP?{headerRowIndex:t,column:this.columnModel.getColumnGroupAtLevel(o,t)}:{headerRowIndex:null==r?-1:t,column:o}}},tm([$("columnModel")],e.prototype,"columnModel",void 0),tm([$("ctrlsService")],e.prototype,"ctrlsService",void 0),e=tm([Q("headerPositionUtils")],e)}(Ht),nm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},om=function(){function t(){}return t.prototype.buildColumnDefs=function(t,e,n){var o=this,r=[],i={};return t.forEach((function(t){for(var s=!0,a=o.createDefFromColumn(t,e,n),l=t.getOriginalParent(),u=null;l;){var c=null;if(l.isPadding())l=l.getOriginalParent();else{var p=i[l.getGroupId()];if(p){p.children.push(a),s=!1;break}if((c=o.createDefFromGroup(l))&&(c.children=[a],i[c.groupId]=c,a=c,l=l.getOriginalParent()),null!=l&&u===l){s=!1;break}u=l}}s&&r.push(a)})),r},t.prototype.createDefFromGroup=function(t){var e=y(t.getColGroupDef(),["children"]);return e&&(e.groupId=t.getGroupId()),e},t.prototype.createDefFromColumn=function(t,e,n){var o=y(t.getColDef());return o.colId=t.getColId(),o.width=t.getActualWidth(),o.rowGroup=t.isRowGroupActive(),o.rowGroupIndex=t.isRowGroupActive()?e.indexOf(t):null,o.pivot=t.isPivotActive(),o.pivotIndex=t.isPivotActive()?n.indexOf(t):null,o.aggFunc=t.isValueActive()?t.getAggFunc():null,o.hide=!t.isVisible()||void 0,o.pinned=t.isPinned()?t.getPinned():null,o.sort=t.getSort()?t.getSort():null,o.sortIndex=null!=t.getSortIndex()?t.getSortIndex():null,o},t=nm([Q("columnDefFactory")],t)}(),rm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},im=function(){function t(){}return t.prototype.getInitialRowClasses=function(t){var e=[];return r(t.extraCssClass)&&e.push(t.extraCssClass),e.push("ag-row"),e.push(t.rowFocused?"ag-row-focus":"ag-row-no-focus"),t.fadeRowIn&&e.push("ag-opacity-zero"),e.push(t.rowIsEven?"ag-row-even":"ag-row-odd"),t.rowNode.isRowPinned()&&e.push("ag-row-pinned"),t.rowNode.isSelected()&&e.push("ag-row-selected"),t.rowNode.footer&&e.push("ag-row-footer"),e.push("ag-row-level-"+t.rowLevel),t.rowNode.stub&&e.push("ag-row-loading"),t.fullWidthRow&&e.push("ag-full-width-row"),t.expandable&&(e.push("ag-row-group"),e.push(t.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),t.rowNode.dragging&&e.push("ag-row-dragging"),Ot(e,this.processClassesFromGridOptions(t.rowNode)),Ot(e,this.preProcessRowClassRules(t.rowNode)),e.push(t.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),t.firstRowOnPage&&e.push("ag-row-first"),t.lastRowOnPage&&e.push("ag-row-last"),t.fullWidthRow&&("left"===t.pinned&&e.push("ag-cell-last-left-pinned"),"right"===t.pinned&&e.push("ag-cell-first-right-pinned")),e},t.prototype.processClassesFromGridOptions=function(t){var e=[],n=function(t){"string"===typeof t?e.push(t):Array.isArray(t)&&t.forEach((function(t){return e.push(t)}))},o=this.gridOptionsService.get("rowClass");if(o){if("function"===typeof o)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];n(o)}var r=this.gridOptionsService.getCallback("getRowClass");r&&n(r({data:t.data,node:t,rowIndex:t.rowIndex}));return e},t.prototype.preProcessRowClassRules=function(t){var e=[];return this.processRowClassRules(t,(function(t){e.push(t)}),(function(t){})),e},t.prototype.processRowClassRules=function(t,e,n){var o={data:t.data,node:t,rowIndex:t.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),o,e,n)},t.prototype.calculateRowLevel=function(t){return t.group?t.level:t.parent?t.parent.level+1:0},rm([$("stylingService")],t.prototype,"stylingService",void 0),rm([$("gridOptionsService")],t.prototype,"gridOptionsService",void 0),t=rm([Q("rowCssClassCalculator")],t)}(),sm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),am=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},lm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return sm(e,t),e.prototype.init=function(){var t=this;this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",(function(e){return t.isAccentedSort=e.currentValue})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return t.primaryColumnsSortGroups=t.gridOptionsService.isColumnsSortingCoupledToGroup()}))},e.prototype.doFullSort=function(t,e){var n=t.map((function(t,e){return{currentPos:e,rowNode:t}}));return n.sort(this.compareRowNodes.bind(this,e)),n.map((function(t){return t.rowNode}))},e.prototype.compareRowNodes=function(t,e,n){for(var o=e.rowNode,r=n.rowNode,i=0,s=t.length;i<s;i++){var a=t[i],l="desc"===a.sort,u=this.getValue(o,a.column),c=this.getValue(r,a.column),p=void 0,h=this.getComparator(a,o);if(p=h?h(u,c,o,r,l):hr.defaultComparator(u,c,this.isAccentedSort),!isNaN(p)&&0!==p)return"asc"===a.sort?p:-1*p}return e.currentPos-n.currentPos},e.prototype.getComparator=function(t,e){var n=t.column,o=n.getColDef().comparator;if(null!=o)return o;if(n.getColDef().showRowGroup){var r=!e.group&&n.getColDef().field;if(r){var i=this.columnModel.getPrimaryColumn(r);if(i)return i.getColDef().comparator}}},e.prototype.getValue=function(t,e){var n,o;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(e,t,!1,!1);if(t.rowGroupColumn===e){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(e.getColDef().keyCreator)return t.key;var r=null===(n=t.allLeafChildren)||void 0===n?void 0:n[0];return r?this.valueService.getValue(e,r,!1,!1):void 0}var i=this.columnModel.getGroupDisplayColumnForGroup(e.getId());if(!i)return;return null===(o=t.groupData)||void 0===o?void 0:o[i.getId()]}return t.group&&e.getColDef().showRowGroup?void 0:this.valueService.getValue(e,t,!1,!1)},am([$("valueService")],e.prototype,"valueService",void 0),am([$("columnModel")],e.prototype,"columnModel",void 0),am([Z],e.prototype,"init",null),e=am([Q("rowNodeSorter")],e)}(Ht),um=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),cm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},pm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ready=!1,e.readyCallbacks=[],e}var n;return um(e,t),n=e,e.prototype.checkReady=function(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){var t=this.createReadyParams();this.readyCallbacks.forEach((function(e){return e(t)})),this.readyCallbacks.length=0}},e.prototype.whenReady=function(t){this.ready?t(this.createReadyParams()):this.readyCallbacks.push(t)},e.prototype.createReadyParams=function(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}},e.prototype.registerFakeHScrollComp=function(t){this.fakeHScrollComp=t,this.checkReady()},e.prototype.registerFakeVScrollComp=function(t){this.fakeVScrollComp=t,this.checkReady()},e.prototype.registerGridHeaderCtrl=function(t){this.gridHeaderCtrl=t,this.checkReady()},e.prototype.registerCenterRowContainerCtrl=function(t){this.centerRowContainerCtrl=t,this.checkReady()},e.prototype.registerLeftRowContainerCtrl=function(t){this.leftRowContainerCtrl=t,this.checkReady()},e.prototype.registerRightRowContainerCtrl=function(t){this.rightRowContainerCtrl=t,this.checkReady()},e.prototype.registerTopCenterRowContainerCtrl=function(t){this.topCenterRowContainerCtrl=t,this.checkReady()},e.prototype.registerTopLeftRowContainerCon=function(t){this.topLeftRowContainerCtrl=t,this.checkReady()},e.prototype.registerTopRightRowContainerCtrl=function(t){this.topRightRowContainerCtrl=t,this.checkReady()},e.prototype.registerStickyTopCenterRowContainerCtrl=function(t){this.stickyTopCenterRowContainerCtrl=t,this.checkReady()},e.prototype.registerStickyTopLeftRowContainerCon=function(t){this.stickyTopLeftRowContainerCtrl=t,this.checkReady()},e.prototype.registerStickyTopRightRowContainerCtrl=function(t){this.stickyTopRightRowContainerCtrl=t,this.checkReady()},e.prototype.registerBottomCenterRowContainerCtrl=function(t){this.bottomCenterRowContainerCtrl=t,this.checkReady()},e.prototype.registerBottomLeftRowContainerCtrl=function(t){this.bottomLeftRowContainerCtrl=t,this.checkReady()},e.prototype.registerBottomRightRowContainerCtrl=function(t){this.bottomRightRowContainerCtrl=t,this.checkReady()},e.prototype.registerHeaderContainer=function(t,e){switch(e){case"left":this.leftHeaderRowContainerCtrl=t;break;case"right":this.rightHeaderRowContainerCtrl=t;break;default:this.centerHeaderRowContainerCtrl=t}this.checkReady()},e.prototype.registerGridBodyCtrl=function(t){this.gridBodyCtrl=t,this.checkReady()},e.prototype.registerGridCtrl=function(t){this.gridCtrl=t,this.checkReady()},e.prototype.getFakeHScrollComp=function(){return this.fakeHScrollComp},e.prototype.getFakeVScrollComp=function(){return this.fakeVScrollComp},e.prototype.getGridHeaderCtrl=function(){return this.gridHeaderCtrl},e.prototype.getGridCtrl=function(){return this.gridCtrl},e.prototype.getCenterRowContainerCtrl=function(){return this.centerRowContainerCtrl},e.prototype.getTopCenterRowContainerCtrl=function(){return this.topCenterRowContainerCtrl},e.prototype.getBottomCenterRowContainerCtrl=function(){return this.bottomCenterRowContainerCtrl},e.prototype.getStickyTopCenterRowContainerCtrl=function(){return this.stickyTopCenterRowContainerCtrl},e.prototype.getGridBodyCtrl=function(){return this.gridBodyCtrl},e.prototype.getHeaderRowContainerCtrls=function(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]},e.prototype.getHeaderRowContainerCtrl=function(t){switch(t){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}},e.NAME="ctrlsService",e=n=cm([Q(n.NAME)],e)}(Ht),hm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},fm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registry={},e}return hm(e,t),e.prototype.register=function(t){this.registry[t.controllerName]=t.controllerClass},e.prototype.getInstance=function(t){var e=this.registry[t];if(null!=e)return new e},e=dm([Q("ctrlsFactory")],e)}(Ht),gm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ym=function(t){function e(e,n){var o=t.call(this,e)||this;return o.direction=n,o.hideTimeout=null,o}return gm(e,t),e.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Zt.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Gn()||Bn())},e.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=Xn(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))},e.prototype.addActiveListenerToggles=function(){var t=this,e=this.getGui();["mouseenter","mousedown","touchstart"].forEach((function(n){return t.addManagedListener(e,n,(function(){return t.addOrRemoveCssClass("ag-scrollbar-active",!0)}))})),["mouseleave","touchend"].forEach((function(n){return t.addManagedListener(e,n,(function(){return t.addOrRemoveCssClass("ag-scrollbar-active",!1)}))}))},e.prototype.onScrollVisibilityChanged=function(){var t=this;void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame((function(){return t.setScrollVisible()}))},e.prototype.hideAndShowInvisibleScrollAsNeeded=function(){var t=this;this.addManagedListener(this.eventService,Zt.EVENT_BODY_SCROLL,(function(e){e.direction===t.direction&&(null!==t.hideTimeout&&(window.clearTimeout(t.hideTimeout),t.hideTimeout=null),t.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))})),this.addManagedListener(this.eventService,Zt.EVENT_BODY_SCROLL_END,(function(){t.hideTimeout=window.setTimeout((function(){t.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),t.hideTimeout=null}),400)}))},e.prototype.attemptSettingScrollPosition=function(t){var e=this,n=this.getViewport();B((function(){return Ro(n)}),(function(){return e.setScrollPosition(t)}),100)},e.prototype.getViewport=function(){return this.eViewport},e.prototype.getContainer=function(){return this.eContainer},e.prototype.onScrollCallback=function(t){this.addManagedListener(this.getViewport(),"scroll",t)},mm([Or("eViewport")],e.prototype,"eViewport",void 0),mm([Or("eContainer")],e.prototype,"eContainer",void 0),mm([$("scrollVisibleService")],e.prototype,"scrollVisibleService",void 0),mm([$("ctrlsService")],e.prototype,"ctrlsService",void 0),mm([$("animationFrameService")],e.prototype,"animationFrameService",void 0),e}(Tr),vm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_m=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Cm=function(t){function e(){return t.call(this,e.TEMPLATE,"horizontal")||this}return vm(e,t),e.prototype.postConstruct=function(){var e=this;t.prototype.postConstruct.call(this);var n=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,n),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,n),this.addManagedListener(this.eventService,Zt.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",n),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new zu((function(t){return e.eContainer.style.width=t+"px"})))},e.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),t.prototype.initialiseInvisibleScrollbar.call(this),this.invisibleScrollbar&&this.refreshCompBottom())},e.prototype.onPinnedRowDataChanged=function(){this.refreshCompBottom()},e.prototype.refreshCompBottom=function(){if(this.invisibleScrollbar){var t=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=t+"px"}},e.prototype.onScrollVisibilityChanged=function(){t.prototype.onScrollVisibilityChanged.call(this),this.setFakeHScrollSpacerWidths()},e.prototype.setFakeHScrollSpacerWidths=function(){var t=this.scrollVisibleService.isVerticalScrollShowing(),e=this.columnModel.getDisplayedColumnsRightWidth(),n=!this.enableRtl&&t,o=this.gridOptionsService.getScrollbarWidth();n&&(e+=o),Go(this.eRightSpacer,e),this.eRightSpacer.classList.toggle("ag-scroller-corner",e<=o);var r=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&t&&(r+=o),Go(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=o)},e.prototype.setScrollVisible=function(){var t=this.scrollVisibleService.isHorizontalScrollShowing(),e=this.invisibleScrollbar,n=this.gridOptionsService.is("suppressHorizontalScroll"),o=t&&this.gridOptionsService.getScrollbarWidth()||0,r=n?0:0===o&&e?16:o;this.addOrRemoveCssClass("ag-scrollbar-invisible",e),Bo(this.getGui(),r),Bo(this.eViewport,r),Bo(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})},e.prototype.getScrollPosition=function(){return xo(this.getViewport(),this.enableRtl)},e.prototype.setScrollPosition=function(t){Ro(this.getViewport())||this.attemptSettingScrollPosition(t),Eo(this.getViewport(),t,this.enableRtl)},e.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',_m([Or("eLeftSpacer")],e.prototype,"eLeftSpacer",void 0),_m([Or("eRightSpacer")],e.prototype,"eRightSpacer",void 0),_m([$("columnModel")],e.prototype,"columnModel",void 0),_m([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),_m([Z],e.prototype,"postConstruct",null),e}(ym),wm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),bm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wm(e,t),e.prototype.postConstruct=function(){var t=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedPropertyListener("domLayout",t)},e.prototype.checkContainerWidths=function(){var t=this.gridOptionsService.isDomLayout("print"),e=t?0:this.columnModel.getDisplayedColumnsLeftWidth(),n=t?0:this.columnModel.getDisplayedColumnsRightWidth();e!=this.leftWidth&&(this.leftWidth=e,this.eventService.dispatchEvent({type:Zt.EVENT_LEFT_PINNED_WIDTH_CHANGED})),n!=this.rightWidth&&(this.rightWidth=n,this.eventService.dispatchEvent({type:Zt.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))},e.prototype.getPinnedRightWidth=function(){return this.rightWidth},e.prototype.getPinnedLeftWidth=function(){return this.leftWidth},bm([$("columnModel")],e.prototype,"columnModel",void 0),bm([Z],e.prototype,"postConstruct",null),e=bm([Q("pinnedWidthService")],e)}(Ht),Em=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Sm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Tm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events=[],e}return Em(e,t),e.prototype.postConstruct=function(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},e.prototype.dispatchExpanded=function(t){var e=this;if(null!=this.clientSideRowModel){this.events.push(t);null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce((function(){e.clientSideRowModel&&e.clientSideRowModel.onRowGroupOpened(),e.events.forEach((function(t){return e.eventService.dispatchEvent(t)})),e.events=[]}))),this.dispatchExpandedDebounced()}else this.eventService.dispatchEvent(t)},Sm([$("animationFrameService")],e.prototype,"animationFrameService",void 0),Sm([$("rowModel")],e.prototype,"rowModel",void 0),Sm([Z],e.prototype,"postConstruct",null),e=Sm([Q("rowNodeEventThrottle")],e)}(Ht),Rm=function(){return Rm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Rm.apply(this,arguments)},Om=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Pm=function(t,e){return function(n,o){e(n,o,t)}},Im=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Am=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};function Dm(t){return!0===t||"true"===t}var Mm,Lm=function(){function t(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new st}return Object.defineProperty(t.prototype,"context",{get:function(){return this.gridOptions.context},enumerable:!1,configurable:!0}),t.prototype.agWire=function(t,e){this.gridOptions.api=t,this.gridOptions.columnApi=e,this.api=t,this.columnApi=e},t.prototype.init=function(){this.gridOptionLookup=new Set(Am(Am([],Im(ye.ALL_PROPERTIES)),Im(ye.EVENT_CALLBACKS)));var t=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),t),this.getScrollbarWidth()},t.prototype.destroy=function(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0},t.prototype.is=function(t){return Dm(this.gridOptions[t])},t.prototype.get=function(t){return this.gridOptions[t]},t.prototype.getNum=function(t){return"number"==typeof(e=this.gridOptions[t])?e:"string"==typeof e?parseInt(e,10):void 0;var e},t.prototype.getCallback=function(t){return this.mergeGridCommonParams(this.gridOptions[t])},t.prototype.exists=function(t){return r(this.gridOptions[t])},t.prototype.mergeGridCommonParams=function(t){var e=this;if(t){return function(n){var o=n;return o.api=e.api,o.columnApi=e.columnApi,o.context=e.context,t(o)}}return t},t.prototype.set=function(t,e,n,o){if(void 0===n&&(n=!1),void 0===o&&(o={}),this.gridOptionLookup.has(t)){var r=this.gridOptions[t];if(n||r!==e){this.gridOptions[t]=e;var i=Rm({type:t,currentValue:e,previousValue:r},o);this.propertyEventService.dispatchEvent(i)}}},t.prototype.addEventListener=function(t,e){this.propertyEventService.addEventListener(t,e)},t.prototype.removeEventListener=function(t,e){this.propertyEventService.removeEventListener(t,e)},t.prototype.globalEventHandler=function(t,e){if(!this.destroyed){var n=ye.getCallbackForEvent(t);"function"===typeof this.gridOptions[n]&&this.gridOptions[n](e)}},t.prototype.getGridId=function(){return this.api.getGridId()},t.prototype.getScrollbarWidth=function(){if(null==this.scrollbarWidth){var t="number"===typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:Wn();null!=t&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:Zt.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth},t.prototype.isRowModelType=function(t){return this.gridOptions.rowModelType===t||"clientSide"===t&&i(this.gridOptions.rowModelType)},t.prototype.isDomLayout=function(t){var e;return(null!==(e=this.gridOptions.domLayout)&&void 0!==e?e:"normal")===t},t.prototype.isRowSelection=function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection},t.prototype.useAsyncEvents=function(){return!this.is("suppressAsyncEvents")},t.prototype.isGetRowHeightFunction=function(){return"function"===typeof this.gridOptions.getRowHeight},t.prototype.getRowHeightForNode=function(t,e,n){if(void 0===e&&(e=!1),null==n&&(n=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(e)return{height:n,estimated:!0};var o={node:t,data:t.data},r=this.getCallback("getRowHeight")(o);if(this.isNumeric(r))return 0===r&&P((function(){return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.")}),"invalidRowHeight"),{height:Math.max(1,r),estimated:!1}}return t.detail&&this.is("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:n,estimated:!1}},t.prototype.getMasterDetailRowHeight=function(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}},t.prototype.getRowHeightAsNumber=function(){if(!this.gridOptions.rowHeight||i(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();var t=this.gridOptions.rowHeight;return t&&this.isNumeric(t)?(this.environment.setRowHeightVariable(t),t):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())},t.prototype.isNumeric=function(t){return!isNaN(t)&&"number"===typeof t&&isFinite(t)},t.prototype.getDomDataKey=function(){return this.domDataKey},t.prototype.getDomData=function(t,e){var n=t[this.getDomDataKey()];return n?n[e]:void 0},t.prototype.setDomData=function(t,e,n){var o=this.getDomDataKey(),r=t[o];i(r)&&(r={},t[o]=r),r[e]=n},t.prototype.getDocument=function(){var t=null;return this.gridOptions.getDocument&&r(this.gridOptions.getDocument)?t=this.gridOptions.getDocument():this.eGridDiv&&(t=this.eGridDiv.ownerDocument),t&&r(t)?t:document},t.prototype.getWindow=function(){return this.getDocument().defaultView||window},t.prototype.getRootNode=function(){return this.eGridDiv.getRootNode()},t.prototype.getAsyncTransactionWaitMillis=function(){return r(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50},t.prototype.isAnimateRows=function(){return!this.is("ensureDomOrder")&&this.is("animateRows")},t.prototype.isGroupRowsSticky=function(){return!(this.is("suppressGroupRowsSticky")||this.is("paginateChildRows")||this.is("groupHideOpenParents"))},t.prototype.isTreeData=function(){return this.is("treeData")&&W.__assertRegistered(z.RowGroupingModule,"Tree Data",this.api.getGridId())},t.prototype.isMasterDetail=function(){return this.is("masterDetail")&&W.__assertRegistered(z.MasterDetailModule,"masterDetail",this.api.getGridId())},t.prototype.isEnableRangeSelection=function(){return this.is("enableRangeSelection")&&W.__isRegistered(z.RangeSelectionModule,this.api.getGridId())},t.prototype.isColumnsSortingCoupledToGroup=function(){var t=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!(null===t||void 0===t?void 0:t.comparator)&&!this.isTreeData()},t.prototype.getGroupAggFiltering=function(){var t=this.gridOptions.groupAggFiltering;return"function"===typeof t?this.getCallback("groupAggFiltering"):Dm(t)?function(){return!0}:void 0},t.prototype.isGroupMultiAutoColumn=function(){return this.gridOptions.groupDisplayType?Oe("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")},t.prototype.isGroupUseEntireRow=function(t){return!t&&(!!this.gridOptions.groupDisplayType&&Oe("groupRows",this.gridOptions.groupDisplayType))},Om([$("gridOptions")],t.prototype,"gridOptions",void 0),Om([$("eventService")],t.prototype,"eventService",void 0),Om([$("environment")],t.prototype,"environment",void 0),Om([$("eGridDiv")],t.prototype,"eGridDiv",void 0),Om([Pm(0,nt("gridApi")),Pm(1,nt("columnApi"))],t.prototype,"agWire",null),Om([Z],t.prototype,"init",null),Om([J],t.prototype,"destroy",null),t=Om([Q("gridOptionsService")],t)}(),Nm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},km=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Nm(e,t),e.prototype.getLocaleTextFunc=function(){var t=this.gridOptionsService.getCallback("getLocaleText");if(t)return function(e,n,o){return t({key:e,defaultValue:n,variableValues:o})};var e=this.gridOptionsService.get("localeText");return function(t,n,o){var r=e&&e[t];if(r&&o&&o.length)for(var i=0;!(i>=o.length);){if(-1===r.indexOf("${variable}"))break;r=r.replace("${variable}",o[i++])}return null!==r&&void 0!==r?r:n}},e=Fm([Q("localeService")],e)}(Ht),Gm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Vm=function(t){function e(){return t.call(this,e.TEMPLATE,"vertical")||this}return Gm(e,t),e.prototype.postConstruct=function(){t.prototype.postConstruct.call(this),this.createManagedBean(new Nu(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this),this.addManagedListener(this.eventService,Zt.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))},e.prototype.setScrollVisible=function(){var t=this.scrollVisibleService.isVerticalScrollShowing(),e=this.invisibleScrollbar,n=t&&this.gridOptionsService.getScrollbarWidth()||0,o=0===n&&e?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",e),Go(this.getGui(),o),Go(this.eViewport,o),Go(this.eContainer,o),this.setDisplayed(t,{skipAriaHidden:!0})},e.prototype.onRowContainerHeightChanged=function(){var t=this.ctrlsService.getGridBodyCtrl().getBodyViewportElement();this.eViewport.scrollTop!=t.scrollTop&&(this.eViewport.scrollTop=t.scrollTop)},e.prototype.getScrollPosition=function(){return this.getViewport().scrollTop},e.prototype.setScrollPosition=function(t){Ro(this.getViewport())||this.attemptSettingScrollPosition(t),this.getViewport().scrollTop=t},e.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',Bm([Z],e.prototype,"postConstruct",null),e}(ym),zm=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),jm=function(){return jm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},jm.apply(this,arguments)},Hm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Um=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Wm=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},qm={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},Xm=["january","february","march","april","may","june","july","august","september","october","november","december"],Ym=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataTypeDefinitions={},e.isWaitingForRowData=!1,e.isColumnTypeOverrideInDataTypeDefinitions=!1,e.columnStateUpdatesPendingInference={},e.columnStateUpdateListenerDestroyFuncs=[],e}return zm(e,t),e.prototype.init=function(){var t=this;this.groupHideOpenParents=this.gridOptionsService.is("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",(function(){t.groupHideOpenParents=t.gridOptionsService.is("groupHideOpenParents")})),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",(function(){t.processDataTypeDefinitions(),t.columnModel.recreateColumnDefs("gridOptionsChanged")}))},e.prototype.processDataTypeDefinitions=function(){var t,e=this,n=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(n).forEach((function(t){var n=Um(t,2),o=n[0],r=n[1];e.dataTypeDefinitions[o]=jm(jm({},r),{groupSafeValueFormatter:e.createGroupSafeValueFormatter(r)})}));var o=null!==(t=this.gridOptionsService.get("dataTypeDefinitions"))&&void 0!==t?t:{};this.dataTypeMatchers={},Object.entries(o).forEach((function(t){var r=Um(t,2),i=r[0],s=r[1],a=e.processDataTypeDefinition(s,o,[i],n);a&&(e.dataTypeDefinitions[i]=a,s.dataTypeMatcher&&(e.dataTypeMatchers[i]=s.dataTypeMatcher))})),this.checkObjectValueHandlers(n),["dateString","text","number","boolean","date"].forEach((function(t){var o=e.dataTypeMatchers[t];o&&delete e.dataTypeMatchers[t],e.dataTypeMatchers[t]=null!==o&&void 0!==o?o:n[t].dataTypeMatcher}))},e.prototype.mergeDataTypeDefinitions=function(t,e){var n=jm(jm({},t),e);return t.columnTypes&&e.columnTypes&&e.appendColumnTypes&&(n.columnTypes=Wm(Wm([],Um(this.convertColumnTypes(t.columnTypes))),Um(this.convertColumnTypes(e.columnTypes)))),n},e.prototype.processDataTypeDefinition=function(t,e,n,o){var r,i=t.extendsDataType;if(t.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),t.extendsDataType===t.baseDataType){var s=o[i];if(!this.validateDataTypeDefinition(t,s,i))return;r=this.mergeDataTypeDefinitions(s,t)}else{if(n.includes(i))return void P((function(){return console.warn('AG Grid: Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.')}),"dataTypeExtendsCircularRef");var a=e[i];if(!this.validateDataTypeDefinition(t,a,i))return;var l=this.processDataTypeDefinition(a,e,Wm(Wm([],Um(n)),[i]),o);if(!l)return;r=this.mergeDataTypeDefinitions(l,t)}return jm(jm({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})},e.prototype.validateDataTypeDefinition=function(t,e,n){return e?e.baseDataType===t.baseDataType||(P((function(){return console.warn('AG Grid: The "baseDataType" property of a data type definition must match that of its parent.')}),"dataTypeBaseTypesMatch"),!1):(P((function(){return console.warn("AG Grid: The data type definition "+n+" does not exist.")}),"dataTypeDefMissing"+n),!1)},e.prototype.createGroupSafeValueFormatter=function(t){var e=this;if(t.valueFormatter)return function(n){var o,r;if(!(null===(o=n.node)||void 0===o?void 0:o.group))return e.groupHideOpenParents&&n.column.isRowGroupActive()?"string"!==typeof n.value||(null===(r=t.dataTypeMatcher)||void 0===r?void 0:r.call(t,n.value))?t.valueFormatter(n):void 0:t.valueFormatter(n);var i=n.column.getAggFunc();if(i){if("first"===i||"last"===i)return t.valueFormatter(n);if("number"===t.baseDataType&&"count"!==i){if("number"===typeof n.value)return t.valueFormatter(n);if("object"===typeof n.value){if(!n.value)return;if("toNumber"in n.value)return t.valueFormatter(jm(jm({},n),{value:n.value.toNumber()}));if("value"in n.value)return t.valueFormatter(jm(jm({},n),{value:n.value.value}))}}}}},e.prototype.updateColDefAndGetDataTypeDefinitionColumnType=function(t,e,n){var o=e.cellDataType,r=e.field;if(void 0===o&&(o=t.cellDataType),null!=o&&!0!==o||(o=!!this.canInferCellDataType(t,e)&&this.inferCellDataType(r,n)),o){var i=this.dataTypeDefinitions[o];if(i)return t.cellDataType=o,i.groupSafeValueFormatter&&(t.valueFormatter=i.groupSafeValueFormatter),i.valueParser&&(t.valueParser=i.valueParser),i.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(t,i,n),i.columnTypes;P((function(){return console.warn('AG Grid: Missing data type definition - "'+o+'"')}),"dataTypeMissing"+o)}else t.cellDataType=!1},e.prototype.updateColDefAndGetColumnType=function(t,e,n){var o,r,i=this.updateColDefAndGetDataTypeDefinitionColumnType(t,e,n),s=null!==(r=null!==(o=e.type)&&void 0!==o?o:i)&&void 0!==r?r:t.type;return t.type=s,s?this.convertColumnTypes(s):void 0},e.prototype.addColumnListeners=function(t){if(this.isWaitingForRowData){var e=this.columnStateUpdatesPendingInference[t.getColId()];if(e){var n=function(t){e.add(t.key)};t.addEventListener(ht.EVENT_STATE_UPDATED,n),this.columnStateUpdateListenerDestroyFuncs.push((function(){return t.removeEventListener(ht.EVENT_STATE_UPDATED,n)}))}}},e.prototype.canInferCellDataType=function(t,e){var n,o=this;if("clientSide"!==this.rowModel.getType())return!1;var r={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(e,r))return!1;var i=null===e.type?t.type:e.type;if(i){var s=null!==(n=this.gridOptionsService.get("columnTypes"))&&void 0!==n?n:{};if(this.convertColumnTypes(i).some((function(t){var e=s[t.trim()];return e&&o.doColDefPropsPreventInference(e,r)})))return!1}return!this.doColDefPropsPreventInference(t,r)},e.prototype.doColDefPropsPreventInference=function(t,e){var n=this;return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some((function(o){var r=Um(o,2),i=r[0],s=r[1];return n.doesColDefPropPreventInference(t,e,i,s)}))},e.prototype.doesColDefPropPreventInference=function(t,e,n,o){if(!e[n])return!1;var r=t[n];return null===r?(e[n]=!1,!1):void 0===o?!!r:r===o},e.prototype.inferCellDataType=function(t,e){var n;if(t){var o,r=this.getInitialData();if(r){var i=t.indexOf(".")>=0&&!this.gridOptionsService.is("suppressFieldDotNotation");o=E(r,t,i)}else this.initWaitForRowData(e);if(null!=o)return Um(null!==(n=Object.entries(this.dataTypeMatchers).find((function(t){var e=Um(t,2);return e[0],(0,e[1])(o)})))&&void 0!==n?n:["object"],1)[0]}},e.prototype.getInitialData=function(){var t=this.gridOptionsService.get("rowData");if(null===t||void 0===t?void 0:t.length)return t[0];if(this.initialData)return this.initialData;var e=this.rowModel.getRootNode().allLeafChildren;return(null===e||void 0===e?void 0:e.length)?e[0].data:null},e.prototype.initWaitForRowData=function(t){var e=this;if(this.columnStateUpdatesPendingInference[t]=new Set,!this.isWaitingForRowData){this.isWaitingForRowData=!0;var n=this.isColumnTypeOverrideInDataTypeDefinitions;n&&this.columnModel.queueResizeOperations();var o=this.addManagedListener(this.eventService,Zt.EVENT_ROW_DATA_UPDATE_STARTED,(function(t){var r=t.firstRowData;if(r){null===o||void 0===o||o(),e.isWaitingForRowData=!1,e.processColumnsPendingInference(r,n),e.columnStateUpdatesPendingInference={},n&&e.columnModel.processResizeOperations();var i={type:Zt.EVENT_DATA_TYPES_INFERRED};e.eventService.dispatchEvent(i)}}))}},e.prototype.isPendingInference=function(){return this.isWaitingForRowData},e.prototype.processColumnsPendingInference=function(t,e){var n=this;this.initialData=t;var o=[];this.columnStateUpdateListenerDestroyFuncs.forEach((function(t){return t()})),this.columnStateUpdateListenerDestroyFuncs=[];var r={},i={};Object.entries(this.columnStateUpdatesPendingInference).forEach((function(t){var s=Um(t,2),a=s[0],l=s[1],u=n.columnModel.getGridColumn(a);if(u){var c=u.getColDef();if(n.columnModel.resetColumnDefIntoColumn(u)){var p=u.getColDef();if(e&&p.type&&p.type!==c.type){var h=n.getUpdatedColumnState(u,l);h.rowGroup&&null==h.rowGroupIndex&&(r[a]=h),h.pivot&&null==h.pivotIndex&&(i[a]=h),o.push(h)}}}})),e&&o.push.apply(o,Wm([],Um(this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(r,i)))),o.length&&this.columnModel.applyColumnState({state:o},"cellDataTypeInferred"),this.initialData=null},e.prototype.getUpdatedColumnState=function(t,e){var n=this.columnModel.getColumnStateFromColDef(t);return e.forEach((function(t){delete n[t],"rowGroup"===t?delete n.rowGroupIndex:"pivot"===t&&delete n.pivotIndex})),n},e.prototype.checkObjectValueHandlers=function(t){var e=this.dataTypeDefinitions.object,n=t.object;this.hasObjectValueParser=e.valueParser!==n.valueParser,this.hasObjectValueFormatter=e.valueFormatter!==n.valueFormatter},e.prototype.convertColumnTypes=function(t){var e=[];t instanceof Array?t.some((function(t){return"string"!==typeof t}))?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):e=t:"string"===typeof t?e=t.split(","):console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");return e},e.prototype.getDateStringTypeDefinition=function(){return this.dataTypeDefinitions.dateString},e.prototype.getDateParserFunction=function(){return this.getDateStringTypeDefinition().dateParser},e.prototype.getDateFormatterFunction=function(){return this.getDateStringTypeDefinition().dateFormatter},e.prototype.getDataTypeDefinition=function(t){var e=t.getColDef();if(e.cellDataType)return this.dataTypeDefinitions[e.cellDataType]},e.prototype.getBaseDataType=function(t){var e;return null===(e=this.getDataTypeDefinition(t))||void 0===e?void 0:e.baseDataType},e.prototype.checkType=function(t,e){var n;if(null==e)return!0;var o=null===(n=this.getDataTypeDefinition(t))||void 0===n?void 0:n.dataTypeMatcher;return!o||o(e)},e.prototype.validateColDef=function(t){"object"===t.cellDataType&&(t.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||P((function(){return console.warn('AG Grid: Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"')}),"dataTypeObjectValueFormatter"),t.editable&&t.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&P((function(){return console.warn('AG Grid: Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"')}),"dataTypeObjectValueParser"))},e.prototype.setColDefPropertiesForBaseDataType=function(t,e,n){var o=this,i=function(t,n,r){var i=t.getColDef().valueFormatter;return i===e.groupSafeValueFormatter&&(i=e.valueFormatter),o.valueFormatterService.formatValue(t,n,r,i)},s=W.__isRegistered(z.SetFilterModule,this.context.getGridId()),a=this.localeService.getLocaleTextFunc(),l=function(e){var n=t.filterParams;t.filterParams="object"===typeof n?jm(jm({},n),e):e};switch(t.useValueFormatterForExport=!0,t.useValueParserForImport=!0,e.baseDataType){case"number":t.cellEditor="agNumberCellEditor",s&&l({comparator:function(t,e){var n=null==t?0:parseInt(t),o=null==e?0:parseInt(e);return n===o?0:n>o?1:-1}});break;case"boolean":t.cellEditor="agCheckboxCellEditor",t.cellRenderer="agCheckboxCellRenderer",t.suppressKeyboardEvent=function(t){return!!t.colDef.editable&&t.event.key===Qo.SPACE},l(s?{valueFormatter:function(t){return r(t.value)?a(String(t.value),t.value?"True":"False"):a("blanks","(Blanks)")}}:{maxNumConditions:1,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:function(t,e){return e},numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:function(t,e){return!1===e},numberOfInputs:0}]});break;case"date":t.cellEditor="agDateCellEditor",t.keyCreator=function(t){return i(t.column,t.node,t.value)},s&&l({valueFormatter:function(t){var e=i(t.column,t.node,t.value);return r(e)?e:a("blanks","(Blanks)")},treeList:!0,treeListFormatter:function(t,e){if(1===e&&null!=t){var n=Xm[Number(t)-1];return a(n,qm[n])}return null!==t&&void 0!==t?t:a("blanks","(Blanks)")}});break;case"dateString":t.cellEditor="agDateStringCellEditor",t.keyCreator=function(t){return i(t.column,t.node,t.value)};var u=this.getDateParserFunction();l(s?{valueFormatter:function(t){var e=i(t.column,t.node,t.value);return r(e)?e:a("blanks","(Blanks)")},treeList:!0,treeListPathGetter:function(t){var e=u(null!==t&&void 0!==t?t:void 0);return e?[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())]:null},treeListFormatter:function(t,e){if(1===e&&null!=t){var n=Xm[Number(t)-1];return a(n,qm[n])}return null!==t&&void 0!==t?t:a("blanks","(Blanks)")}}:{comparator:function(t,e){var n=u(e);return null==e||n<t?-1:n>t?1:0}});break;case"object":t.cellEditorParams={useFormatter:!0},t.comparator=function(t,e){var r=o.columnModel.getPrimaryColumn(n),s=null===r||void 0===r?void 0:r.getColDef();if(!r||!s)return 0;var a=null==t?"":i(r,null,t),l=null==e?"":i(r,null,e);return a===l?0:a>l?1:-1},t.keyCreator=function(t){return i(t.column,t.node,t.value)},s?l({valueFormatter:function(t){var e=i(t.column,t.node,t.value);return r(e)?e:a("blanks","(Blanks)")}}):t.filterValueGetter=function(t){return i(t.column,t.node,o.valueService.getValue(t.column,t.node))}}},e.prototype.getDefaultDataTypes=function(){var t=function(t){return!!t.match("^\\d{4}-\\d{2}-\\d{2}$")},e=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:function(t){return""===t.newValue?null:Number(t.newValue)},valueFormatter:function(t){return null==t.value?"":"number"!==typeof t.value||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value)},dataTypeMatcher:function(t){return"number"===typeof t}},text:{baseDataType:"text",valueParser:function(t){return""===t.newValue?null:a(t.newValue)},dataTypeMatcher:function(t){return"string"===typeof t}},boolean:{baseDataType:"boolean",valueParser:function(t){return""===t.newValue?null:"true"===String(t.newValue).toLowerCase()},valueFormatter:function(t){return null==t.value?"":String(t.value)},dataTypeMatcher:function(t){return"boolean"===typeof t}},date:{baseDataType:"date",valueParser:function(t){return oo(null==t.newValue?null:String(t.newValue))},valueFormatter:function(t){var n;return null==t.value?"":t.value instanceof Date&&!isNaN(t.value.getTime())?null!==(n=to(t.value,!1))&&void 0!==n?n:"":e("invalidDate","Invalid Date")},dataTypeMatcher:function(t){return t instanceof Date}},dateString:{baseDataType:"dateString",dateParser:function(t){var e;return null!==(e=oo(t))&&void 0!==e?e:void 0},dateFormatter:function(t){var e;return null!==(e=to(null!==t&&void 0!==t?t:null,!1))&&void 0!==e?e:void 0},valueParser:function(e){return t(String(e.newValue))?e.newValue:null},valueFormatter:function(e){return t(String(e.value))?e.value:""},dataTypeMatcher:function(e){return"string"===typeof e&&t(e)}},object:{baseDataType:"object",valueParser:function(){return null},valueFormatter:function(t){var e;return null!==(e=a(t.value))&&void 0!==e?e:""}}}},Hm([$("rowModel")],e.prototype,"rowModel",void 0),Hm([$("columnModel")],e.prototype,"columnModel",void 0),Hm([$("columnUtils")],e.prototype,"columnUtils",void 0),Hm([$("valueService")],e.prototype,"valueService",void 0),Hm([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),Hm([Z],e.prototype,"init",null),e=Hm([Q("dataTypeService")],e)}(Ht),Km=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Zm=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Jm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Km(e,t),e.prototype.parseValue=function(t,e,n,o){var i=t.getColDef(),s={node:e,data:null===e||void 0===e?void 0:e.data,oldValue:o,newValue:n,colDef:i,column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},a=i.valueParser;return r(a)?"function"===typeof a?a(s):this.expressionService.evaluate(a,s):n},Zm([$("expressionService")],e.prototype,"expressionService",void 0),e=Zm([Q("valueParserService")],e)}(Ht),Qm=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},$m=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},ty=function(){function t(t,e,n){e?(this.gridOptions=e,(new ny).create(t,e,(function(e){var n=new Uf(t);e.createBean(n)}),void 0,n)):console.error("AG Grid: no gridOptions provided to the grid")}return t.prototype.destroy=function(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()},t}(),ey=1,ny=function(){function t(){}return t.prototype.create=function(t,e,n,o,r){var i,s=this,a=!!e.debug,l=null!==(i=e.gridId)&&void 0!==i?i:String(ey++),u=this.getRegisteredModules(r,l),c=this.createBeansList(e.rowModelType,u,l),p=this.createProvidedBeans(t,e,r);if(c){var h={providedBeanInstances:p,beanClasses:c,debug:a,gridId:l},d=new Gf("AG Grid",(function(){return e.debug})),f=new Gf("Context",(function(){return h.debug})),g=new Y(h,f),m=g.getBean("beans");this.registerModuleUserComponents(m,u),this.registerStackComponents(m,u),this.registerControllers(m,u),n(g),m.ctrlsService.whenReady((function(){s.setColumnsAndData(m),s.dispatchGridReadyEvent(m);var t=W.__isRegistered(z.EnterpriseCoreModule,l);d.log("initialised successfully, enterprise = "+t)})),o&&o(g)}},t.prototype.registerControllers=function(t,e){e.forEach((function(e){e.controllers&&e.controllers.forEach((function(e){return t.ctrlsFactory.register(e)}))}))},t.prototype.registerStackComponents=function(t,e){var n=this.createAgStackComponentsList(e);t.agStackComponentsRegistry.setupComponents(n)},t.prototype.getRegisteredModules=function(t,e){var n=t?t.modules:null,o=W.__getRegisteredModules(e),r=[],i={},s=function(t,e,n){var o;i[(o=e).moduleName]||(i[o.moduleName]=!0,r.push(o),W.__register(o,t,n)),e.dependantModules&&e.dependantModules.forEach((function(e){return s(t,e,n)}))};return n&&n.forEach((function(t){return s(!0,t,e)})),o&&o.forEach((function(t){return s(!W.__isPackageBased(),t,void 0)})),r},t.prototype.registerModuleUserComponents=function(t,e){this.extractModuleEntity(e,(function(t){return t.userComponents?t.userComponents:[]})).forEach((function(e){t.userComponentRegistry.registerDefaultComponent(e.componentName,e.componentClass)}))},t.prototype.createProvidedBeans=function(t,e,n){var o=n?n.frameworkOverrides:null;i(o)&&(o=new af);var r={gridOptions:e,eGridDiv:t,globalEventListener:n?n.globalEventListener:null,frameworkOverrides:o};return n&&n.providedBeanInstances&&Object.assign(r,n.providedBeanInstances),r},t.prototype.createAgStackComponentsList=function(t){var e=[{componentName:"AgCheckbox",componentClass:hi},{componentName:"AgRadioButton",componentClass:fi},{componentName:"AgToggleButton",componentClass:Qh},{componentName:"AgInputTextField",componentClass:ki},{componentName:"AgInputTextArea",componentClass:td},{componentName:"AgInputNumberField",componentClass:Bi},{componentName:"AgInputDateField",componentClass:nd},{componentName:"AgInputRange",componentClass:rd},{componentName:"AgRichSelect",componentClass:vd},{componentName:"AgSelect",componentClass:ai},{componentName:"AgSlider",componentClass:wd},{componentName:"AgGridBody",componentClass:tc},{componentName:"AgHeaderRoot",componentClass:Jp},{componentName:"AgSortIndicator",componentClass:us},{componentName:"AgPagination",componentClass:Mg},{componentName:"AgOverlayWrapper",componentClass:Fg},{componentName:"AgGroupComponent",componentClass:Ed},{componentName:"AgPanel",componentClass:kd},{componentName:"AgDialog",componentClass:zd},{componentName:"AgRowContainer",componentClass:bc},{componentName:"AgFakeHorizontalScroll",componentClass:Cm},{componentName:"AgFakeVerticalScroll",componentClass:Vm},{componentName:"AgAutocomplete",componentClass:of}],n=this.extractModuleEntity(t,(function(t){return t.agStackComponents?t.agStackComponents:[]}));return e=e.concat(n)},t.prototype.createBeansList=function(t,e,n){void 0===t&&(t="clientSide");var o=e.filter((function(e){return!e.rowModel||e.rowModel===t})),r={clientSide:z.ClientSideRowModelModule,infinite:z.InfiniteRowModelModule,serverSide:z.ServerSideRowModelModule,viewport:z.ViewportRowModelModule};if(r[t]){if(W.__assertRegistered(r[t],"rowModelType = '"+t+"'",n)){var i=[tu,Bg,jg,em,rg,pl,Na,dg,mg,ph,nl,Rg,th,km,Re,Fh,al,je,st,Lm,Kd,wf,gl,Fe,Wp,Xh,Ph,If,Xt,Mf,mf,cc,ag,Tf,kf,Be,yh,oh,qs,xf,vp,sc,xg,hf,Mh,Zh,oc,Kf,Qf,eg,Ig,ee,cg,fh,Qg,We,om,im,Uh,lm,pm,xm,Tm,fm,Ym,Jm],s=this.extractModuleEntity(o,(function(t){return t.beans?t.beans:[]}));i.push.apply(i,$m([],Qm(s)));var a=[];return i.forEach((function(t){a.indexOf(t)<0&&a.push(t)})),a}}else console.error("AG Grid: could not find row model for rowModelType = "+t)},t.prototype.extractModuleEntity=function(t,e){return[].concat.apply([],$m([],Qm(t.map(e))))},t.prototype.setColumnsAndData=function(t){var e=t.gridOptionsService.get("columnDefs");t.columnModel.setColumnDefs(e||[],"gridInitializing"),t.rowModel.start()},t.prototype.dispatchGridReadyEvent=function(t){var e={type:Zt.EVENT_GRID_READY};t.eventService.dispatchEvent(e)},t}(),oy=function(){function t(){}return t.prototype.wrap=function(t,e,n,o){var r=this;void 0===n&&(n=[]);var i=this.createWrapper(t,o);return e.forEach((function(t){r.createMethod(i,t,!0)})),n.forEach((function(t){r.createMethod(i,t,!1)})),i},t.prototype.unwrap=function(t){return t},t.prototype.createMethod=function(t,e,n){t.addMethod(e,this.createMethodProxy(t,e,n))},t.prototype.createMethodProxy=function(t,e,n){return function(){return t.hasMethod(e)?t.callMethod(e,arguments):(n&&console.warn("AG Grid: Framework component is missing the method "+e+"()"),null)}},t}(),ry={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","doughnut"],lineGroup:["line"],scatterGroup:["scatter","bubble"],areaGroup:["area","stackedArea","normalizedArea"],histogramGroup:["histogram"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},iy=["chartSettings","chartData","chartFormat"],sy=["chartUnlink","chartLink","chartDownload"],ay={settings:"chartSettings",data:"chartData",format:"chartFormat"},ly=0;!function(t){t.InsideBase="insideBase",t.InsideEnd="insideEnd",t.Center="center",t.OutsideEnd="outsideEnd"}(Mm||(Mm={}));var uy="undefined"===typeof n.g?{}:n.g;uy.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,uy.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,uy.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,uy.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,uy.Node="undefined"===typeof Node?{}:Node,uy.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var cy,py=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},hy=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},dy=function(){function t(e,n,o,r,i,s){this.nextId=0,this.allNodesMap={},this.rootNode=e,this.gridOptionsService=n,this.eventService=o,this.columnModel=r,this.beans=s,this.selectionService=i,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=t.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return t.prototype.postConstruct=function(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()},t.prototype.getCopyOfNodesMap=function(){return hr.cloneObject(this.allNodesMap)},t.prototype.getRowNode=function(t){return this.allNodesMap[t]},t.prototype.setRowData=function(e){var n=this;if("string"!==typeof e){this.dispatchRowDataUpdateStartedEvent(e);var o=this.rootNode,r=this.rootNode.sibling;o.childrenAfterFilter=null,o.childrenAfterGroup=null,o.childrenAfterAggFilter=null,o.childrenAfterSort=null,o.childrenMapped=null,o.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?o.allLeafChildren=e.map((function(e){return n.createNode(e,n.rootNode,t.TOP_LEVEL)})):(o.allLeafChildren=[],o.childrenAfterGroup=[]),r&&(r.childrenAfterFilter=o.childrenAfterFilter,r.childrenAfterGroup=o.childrenAfterGroup,r.childrenAfterAggFilter=o.childrenAfterAggFilter,r.childrenAfterSort=o.childrenAfterSort,r.childrenMapped=o.childrenMapped,r.allLeafChildren=o.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},t.prototype.updateRowData=function(t,e){this.dispatchRowDataUpdateStartedEvent(t.add);var n={remove:[],update:[],add:[]},o=[];return this.executeRemove(t,n,o),this.executeUpdate(t,n,o),this.executeAdd(t,n),this.updateSelection(o,"rowDataChanged"),e&&hr.sortRowNodesByOrder(this.rootNode.allLeafChildren,e),n},t.prototype.dispatchRowDataUpdateStartedEvent=function(t){var e={type:Zt.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:(null===t||void 0===t?void 0:t.length)?t[0]:null};this.eventService.dispatchEvent(e)},t.prototype.updateSelection=function(t,e){var n=t.length>0;if(n&&this.selectionService.setNodesSelected({newValue:!1,nodes:t,suppressFinishActions:!0,source:e}),this.selectionService.updateGroupsFromChildrenSelections(e),n){var o={type:Zt.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(o)}},t.prototype.executeAdd=function(e,n){var o,r=this,i=e.add,s=e.addIndex;if(!hr.missingOrEmpty(i)){var a=i.map((function(e){return r.createNode(e,r.rootNode,t.TOP_LEVEL)}));if("number"===typeof s&&s>=0){var l=this.rootNode.allLeafChildren,u=l.length,c=s;if(this.doingTreeData&&s>0&&u>0)for(var p=0;p<u;p++)if((null===(o=l[p])||void 0===o?void 0:o.rowIndex)==s-1){c=p+1;break}var h=l.slice(0,c),d=l.slice(c,l.length);this.rootNode.allLeafChildren=hy(hy(hy([],py(h)),py(a)),py(d))}else this.rootNode.allLeafChildren=hy(hy([],py(this.rootNode.allLeafChildren)),py(a));this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),n.add=a}},t.prototype.executeRemove=function(t,e,n){var o=this,r=t.remove;if(!hr.missingOrEmpty(r)){var i={};r.forEach((function(t){var r=o.lookupRowNode(t);r&&(r.isSelected()&&n.push(r),r.clearRowTopAndRowIndex(),i[r.id]=!0,delete o.allNodesMap[r.id],e.remove.push(r))})),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter((function(t){return!i[t.id]})),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}},t.prototype.executeUpdate=function(e,n,o){var r=this,i=e.update;hr.missingOrEmpty(i)||i.forEach((function(e){var i=r.lookupRowNode(e);i&&(i.updateData(e),!i.selectable&&i.isSelected()&&o.push(i),r.setMasterForRow(i,e,t.TOP_LEVEL,!1),n.update.push(i))}))},t.prototype.lookupRowNode=function(t){var e,n=this.gridOptionsService.getCallback("getRowId");if(n){var o=n({data:t,level:0});if(!(e=this.allNodesMap[o]))return console.error("AG Grid: could not find row id="+o+", data item was not found for this id"),null}else if(!(e=this.rootNode.allLeafChildren.find((function(e){return e.data===t}))))return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return e||null},t.prototype.createNode=function(t,e,n){var o=new ks(this.beans);return o.group=!1,this.setMasterForRow(o,t,n,!0),e&&!this.suppressParentsInRowNodes&&(o.parent=e),o.level=n,o.setDataAndId(t,this.nextId.toString()),this.allNodesMap[o.id]&&console.warn("AG Grid: duplicate node id '"+o.id+"' detected from getRowId callback, this could cause issues in your grid."),this.allNodesMap[o.id]=o,this.nextId++,o},t.prototype.setMasterForRow=function(t,e,n,o){if(this.doingTreeData)t.setMaster(!1),o&&(t.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?t.setMaster(this.isRowMasterFunc(e)):t.setMaster(!0):t.setMaster(!1),o){var r=this.columnModel.getRowGroupColumns(),i=n+(r?r.length:0);t.expanded=!!t.master&&this.isExpanded(i)}},t.prototype.isExpanded=function(t){var e=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===e||t<e},t.TOP_LEVEL=0,t.ROOT_NODE_ID="ROOT_NODE_ID",t}(),fy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},my=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},yy=function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};!function(t){t[t.Normal=0]="Normal",t[t.AfterFilter=1]="AfterFilter",t[t.AfterFilterAndSort=2]="AfterFilterAndSort",t[t.PivotNodes=3]="PivotNodes"}(cy||(cy={}));var vy,_y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onRowHeightChanged_debounced=hr.debounce(e.onRowHeightChanged.bind(e),100),e.rowsToDisplay=[],e}return fy(e,t),e.prototype.init=function(){var t=this.refreshModel.bind(this,{step:rl.EVERYTHING}),e=!this.gridOptionsService.is("suppressAnimationFrame"),n=this.refreshModel.bind(this,{step:rl.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:e});this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,n),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:rl.PIVOT})),this.addManagedListener(this.eventService,Zt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_COLUMN_PIVOT_MODE_CHANGED,t),this.addManagedListener(this.eventService,Zt.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));var o=this.refreshModel.bind(this,{step:rl.MAP,keepRenderedRows:!0,animate:e});this.addManagedPropertyListener("groupRemoveSingleChildren",o),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",o),this.rootNode=new ks(this.beans),this.nodeManager=new dy(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)},e.prototype.start=function(){var t=this.gridOptionsService.get("rowData");t&&this.setRowData(t)},e.prototype.ensureRowHeightsValid=function(t,e,n,o){var r,i=!1;do{r=!1;for(var s=this.getRowIndexAtPixel(t),a=this.getRowIndexAtPixel(e),l=Math.max(s,n),u=Math.min(a,o),c=l;c<=u;c++){var p=this.getRow(c);if(p.rowHeightEstimated){var h=this.gridOptionsService.getRowHeightForNode(p);p.setRowHeight(h.height),r=!0,i=!0}}r&&this.setRowTopAndRowIndex()}while(r);return i},e.prototype.setRowTopAndRowIndex=function(){for(var t=this.environment.getDefaultRowHeight(),e=0,n=new Set,o=this.gridOptionsService.isDomLayout("normal"),r=0;r<this.rowsToDisplay.length;r++){var i=this.rowsToDisplay[r];if(null!=i.id&&n.add(i.id),null==i.rowHeight){var s=this.gridOptionsService.getRowHeightForNode(i,o,t);i.setRowHeight(s.height,s.estimated)}i.setRowTop(e),i.setRowIndex(r),e+=i.rowHeight}return n},e.prototype.clearRowTopAndRowIndex=function(t,e){var n=t.isActive(),o=function(t){t&&null!=t.id&&!e.has(t.id)&&t.clearRowTopAndRowIndex()},r=function(t){if(o(t),o(t.detailNode),o(t.sibling),t.hasChildren()&&t.childrenAfterGroup){var e=-1==t.level;n&&!e&&!t.expanded||t.childrenAfterGroup.forEach(r)}};r(this.rootNode)},e.prototype.ensureRowsAtPixel=function(t,e,n){var o=this;void 0===n&&(n=0);var r=this.getRowIndexAtPixel(e),i=this.getRow(r),s=!this.gridOptionsService.is("suppressAnimationFrame");return i!==t[0]&&(t.forEach((function(t){hr.removeFromArray(o.rootNode.allLeafChildren,t)})),t.forEach((function(t,e){hr.insertIntoArray(o.rootNode.allLeafChildren,t,Math.max(r+n,0)+e)})),this.refreshModel({step:rl.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:s}),!0)},e.prototype.highlightRowAtPixel=function(t,e){var n=null!=e?this.getRowIndexAtPixel(e):null,o=null!=n?this.getRow(n):null;if(o&&t&&o!==t&&null!=e){var r=this.getHighlightPosition(e,o);this.lastHighlightedRow&&this.lastHighlightedRow!==o&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),o.setHighlighted(r),this.lastHighlightedRow=o}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)},e.prototype.getHighlightPosition=function(t,e){if(!e){var n=this.getRowIndexAtPixel(t);if(!(e=this.getRow(n||0)))return ol.Below}return t-e.rowTop<e.rowHeight/2?ol.Above:ol.Below},e.prototype.getLastHighlightedRowNode=function(){return this.lastHighlightedRow},e.prototype.isLastRowIndexKnown=function(){return!0},e.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},e.prototype.getTopLevelRowCount=function(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;var t=this.rootNode.childrenAfterAggFilter;return t?t.length:0},e.prototype.getTopLevelRowDisplayedIndex=function(t){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return t;var e=this.rootNode.childrenAfterSort[t];if(this.gridOptionsService.is("groupHideOpenParents"))for(;e.expanded&&e.childrenAfterSort&&e.childrenAfterSort.length>0;)e=e.childrenAfterSort[0];return e.rowIndex},e.prototype.getRowBounds=function(t){if(hr.missing(this.rowsToDisplay))return null;var e=this.rowsToDisplay[t];return e?{rowTop:e.rowTop,rowHeight:e.rowHeight}:null},e.prototype.onRowGroupOpened=function(){var t=this.gridOptionsService.isAnimateRows();this.refreshModel({step:rl.MAP,keepRenderedRows:!0,animate:t})},e.prototype.onFilterChanged=function(t){if(!t.afterDataChange){var e=this.gridOptionsService.isAnimateRows(),n=0===t.columns.length||t.columns.some((function(t){return t.isPrimary()}))?rl.FILTER:rl.FILTER_AGGREGATES;this.refreshModel({step:n,keepRenderedRows:!0,animate:e})}},e.prototype.onSortChanged=function(){var t=this.gridOptionsService.isAnimateRows();this.refreshModel({step:rl.SORT,keepRenderedRows:!0,animate:t,keepEditingRows:!0})},e.prototype.getType=function(){return"clientSide"},e.prototype.onValueChanged=function(){this.columnModel.isPivotActive()?this.refreshModel({step:rl.PIVOT}):this.refreshModel({step:rl.AGGREGATE})},e.prototype.createChangePath=function(t){var e=hr.missingOrEmpty(t),n=new Gh(!1,this.rootNode);return(e||this.gridOptionsService.isTreeData())&&n.setInactive(),n},e.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(t){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==t.rowNodeTransactions)return!1;var e=t.rowNodeTransactions.filter((function(t){return null!=t.add&&t.add.length>0||null!=t.remove&&t.remove.length>0}));return null==e||0==e.length},e.prototype.buildRefreshModelParams=function(t){var e=rl.EVERYTHING,n={everything:rl.EVERYTHING,group:rl.EVERYTHING,filter:rl.FILTER,map:rl.MAP,aggregate:rl.AGGREGATE,sort:rl.SORT,pivot:rl.PIVOT};if(hr.exists(t)&&(e=n[t]),!hr.missing(e))return{step:e,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")};console.error("AG Grid: invalid step "+t+", available steps are "+Object.keys(n).join(", "))},e.prototype.refreshModel=function(t){var e="object"===typeof t&&"step"in t?t:this.buildRefreshModelParams(t);if(e&&!this.isSuppressModelUpdateAfterUpdateTransaction(e)){var n=this.createChangePath(e.rowNodeTransactions);switch(e.step){case rl.EVERYTHING:this.doRowGrouping(e.groupState,e.rowNodeTransactions,e.rowNodeOrder,n,!!e.afterColumnsChanged);case rl.FILTER:this.doFilter(n);case rl.PIVOT:this.doPivot(n);case rl.AGGREGATE:this.doAggregate(n);case rl.FILTER_AGGREGATES:this.doFilterAggregates(n);case rl.SORT:this.doSort(e.rowNodeTransactions,n);case rl.MAP:this.doRowsToDisplay()}var o=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(n,o);var r={type:Zt.EVENT_MODEL_UPDATED,animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack};this.eventService.dispatchEvent(r)}},e.prototype.isEmpty=function(){var t=hr.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return hr.missing(this.rootNode)||t||!this.columnModel.isReady()},e.prototype.isRowsToRender=function(){return hr.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0},e.prototype.getNodesInRangeForSelection=function(t,e){var n=!e,o=!1,r=[],i=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort((function(s){if(!o)if(n&&(s===e||s===t)&&(o=!0,s.group&&i))r.push.apply(r,yy([],my(s.allLeafChildren)));else{if(!n){if(s!==e&&s!==t)return;n=!0}(!s.group||!i)&&r.push(s)}})),r},e.prototype.setDatasource=function(t){console.error("AG Grid: should never call setDatasource on clientSideRowController")},e.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},e.prototype.getRootNode=function(){return this.rootNode},e.prototype.getRow=function(t){return this.rowsToDisplay[t]},e.prototype.isRowPresent=function(t){return this.rowsToDisplay.indexOf(t)>=0},e.prototype.getRowIndexAtPixel=function(t){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;var e=0,n=this.rowsToDisplay.length-1;if(t<=0)return 0;if(hr.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;for(var o=-1,r=-1;;){var i=Math.floor((e+n)/2),s=this.rowsToDisplay[i];if(this.isRowInPixel(s,t))return i;if(s.rowTop<t?e=i+1:s.rowTop>t&&(n=i-1),o===e&&r===n)return i;o=e,r=n}},e.prototype.isRowInPixel=function(t,e){var n=t.rowTop,o=t.rowTop+t.rowHeight;return n<=e&&o>e},e.prototype.forEachLeafNode=function(t){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((function(e,n){return t(e,n)}))},e.prototype.forEachNode=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:yy([],my(this.rootNode.childrenAfterGroup||[])),callback:t,recursionType:cy.Normal,index:0,includeFooterNodes:e})},e.prototype.forEachNodeAfterFilter=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:yy([],my(this.rootNode.childrenAfterAggFilter||[])),callback:t,recursionType:cy.AfterFilter,index:0,includeFooterNodes:e})},e.prototype.forEachNodeAfterFilterAndSort=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:yy([],my(this.rootNode.childrenAfterSort||[])),callback:t,recursionType:cy.AfterFilterAndSort,index:0,includeFooterNodes:e})},e.prototype.forEachPivotNode=function(t,e){void 0===e&&(e=!1),this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:t,recursionType:cy.PivotNodes,index:0,includeFooterNodes:e})},e.prototype.recursivelyWalkNodesAndCallback=function(t){var e,n=t.nodes,o=t.callback,r=t.recursionType,i=t.includeFooterNodes,s=t.index,a=n[0];i&&(null===(e=null===a||void 0===a?void 0:a.parent)||void 0===e?void 0:e.sibling)&&n.push(a.parent.sibling);for(var l=0;l<n.length;l++){var u=n[l];if(o(u,s++),u.hasChildren()&&!u.footer){var c=null;switch(r){case cy.Normal:c=u.childrenAfterGroup;break;case cy.AfterFilter:c=u.childrenAfterAggFilter;break;case cy.AfterFilterAndSort:c=u.childrenAfterSort;break;case cy.PivotNodes:c=u.leafGroup?null:u.childrenAfterSort}c&&(s=this.recursivelyWalkNodesAndCallback({nodes:yy([],my(c)),callback:o,recursionType:r,index:s,includeFooterNodes:i}))}}return s},e.prototype.doAggregate=function(t){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:t})},e.prototype.doFilterAggregates=function(t){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:t}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter},e.prototype.expandOrCollapseAll=function(t){var e=this.gridOptionsService.isTreeData(),n=this.columnModel.isPivotActive(),o=function(r){r&&r.forEach((function(r){var i=function(){r.expanded=t,o(r.childrenAfterGroup)};e?hr.exists(r.childrenAfterGroup)&&i():n?!r.leafGroup&&i():r.group&&i()}))};this.rootNode&&o(this.rootNode.childrenAfterGroup),this.refreshModel({step:rl.MAP});var r=t?"expandAll":"collapseAll",i={type:Zt.EVENT_EXPAND_COLLAPSE_ALL,source:r};this.eventService.dispatchEvent(i)},e.prototype.doSort=function(t,e){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,changedPath:e})},e.prototype.doRowGrouping=function(t,e,n,o,r){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodeOrder:n,changedPath:o}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:o,afterColumnsChanged:r}),this.restoreGroupState(t)),this.gridOptionsService.is("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",o)){var i={type:Zt.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(i)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()},e.prototype.restoreGroupState=function(t){t&&hr.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(e,n){"boolean"===typeof t[n]&&(e.expanded=t[n])}))},e.prototype.doFilter=function(t){this.filterStage.execute({rowNode:this.rootNode,changedPath:t})},e.prototype.doPivot=function(t){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:t})},e.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;var t={};return hr.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(e,n){return t[n]=e.expanded})),t},e.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},e.prototype.getRowNode=function(t){if("string"==typeof t&&0==t.indexOf(ks.ID_PREFIX_ROW_GROUP)){var e=void 0;return this.forEachNode((function(n){n.id===t&&(e=n)})),e}return this.nodeManager.getRowNode(t)},e.prototype.setRowData=function(t){var e=this.getGroupState();this.nodeManager.setRowData(t),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");var n={type:Zt.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(n),this.refreshModel({step:rl.EVERYTHING,groupState:e,newData:!0})},e.prototype.batchUpdateRowData=function(t,e){var n=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var o=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout((function(){n.executeBatchUpdateRowData()}),o)}this.rowDataTransactionBatch.push({rowDataTransaction:t,callback:e})},e.prototype.flushAsyncTransactions=function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())},e.prototype.executeBatchUpdateRowData=function(){var t=this;this.valueCache.onDataChanged();var e=[],n=[],o=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach((function(r){var i=t.nodeManager.updateRowData(r.rowDataTransaction,void 0);n.push(i),r.callback&&e.push(r.callback.bind(null,i)),"number"===typeof r.rowDataTransaction.addIndex&&(o=!0)})),this.commonUpdateRowData(n,void 0,o),e.length>0&&window.setTimeout((function(){e.forEach((function(t){return t()}))}),0),n.length>0){var r={type:Zt.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:n};this.eventService.dispatchEvent(r)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0},e.prototype.updateRowData=function(t,e){this.valueCache.onDataChanged();var n=this.nodeManager.updateRowData(t,e),o="number"===typeof t.addIndex;return this.commonUpdateRowData([n],e,o),n},e.prototype.createRowNodeOrder=function(){if(!this.gridOptionsService.is("suppressMaintainUnsortedOrder")){var t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var e=0;e<this.rootNode.allLeafChildren.length;e++){t[this.rootNode.allLeafChildren[e].id]=e}return t}},e.prototype.commonUpdateRowData=function(t,e,n){var o=!this.gridOptionsService.is("suppressAnimationFrame");n&&(e=this.createRowNodeOrder()),this.refreshModel({step:rl.EVERYTHING,rowNodeTransactions:t,rowNodeOrder:e,keepRenderedRows:!0,keepEditingRows:!0,animate:o}),this.filterManager.onNewRowsLoaded("rowDataUpdated");var r={type:Zt.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r)},e.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},e.prototype.onRowHeightChanged=function(){this.refreshModel({step:rl.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})},e.prototype.onRowHeightChangedDebounced=function(){this.onRowHeightChanged_debounced()},e.prototype.resetRowHeights=function(){var t=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),t&&this.onRowHeightChanged()},e.prototype.resetRowHeightsForAllRowNodes=function(){var t=!1;return this.forEachNode((function(e){e.setRowHeight(e.rowHeight,!0);var n=e.detailNode;n&&n.setRowHeight(n.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t=!0})),t},e.prototype.onGridStylesChanges=function(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()},gy([$("columnModel")],e.prototype,"columnModel",void 0),gy([$("selectionService")],e.prototype,"selectionService",void 0),gy([$("filterManager")],e.prototype,"filterManager",void 0),gy([$("valueCache")],e.prototype,"valueCache",void 0),gy([$("beans")],e.prototype,"beans",void 0),gy([$("filterStage")],e.prototype,"filterStage",void 0),gy([$("sortStage")],e.prototype,"sortStage",void 0),gy([$("flattenStage")],e.prototype,"flattenStage",void 0),gy([tt("groupStage")],e.prototype,"groupStage",void 0),gy([tt("aggregationStage")],e.prototype,"aggregationStage",void 0),gy([tt("pivotStage")],e.prototype,"pivotStage",void 0),gy([tt("filterAggregatesStage")],e.prototype,"filterAggregatesStage",void 0),gy([Z],e.prototype,"init",null),e=gy([Q("rowModel")],e)}(Ht),Cy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),wy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},by=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Cy(e,t),e.prototype.execute=function(t){var e=t.changedPath;this.filterService.filter(e)},wy([$("filterService")],e.prototype,"filterService",void 0),e=wy([Q("filterStage")],e)}(Ht),xy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ey=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Sy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xy(e,t),e.prototype.execute=function(t){var e=this,n=this.sortController.getSortOptions(),o=hr.exists(n)&&n.length>0,r=o&&hr.exists(t.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),i=n.some((function(t){return!!e.columnModel.getGroupDisplayColumnForGroup(t.column.getId())}));this.sortService.sort(n,o,r,t.rowNodeTransactions,t.changedPath,i)},Ey([$("sortService")],e.prototype,"sortService",void 0),Ey([$("sortController")],e.prototype,"sortController",void 0),Ey([$("columnModel")],e.prototype,"columnModel",void 0),e=Ey([Q("sortStage")],e)}(Ht),Ty=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ry=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Oy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ty(e,t),e.prototype.execute=function(t){var e=t.rowNode,n=[],o={value:0},r=this.columnModel.isPivotMode(),i=r&&e.leafGroup,s=i?[e]:e.childrenAfterSort;return this.recursivelyAddToRowsToDisplay(s,n,o,r,0),!i&&n.length>0&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(e.createFooter(),this.addRowNodeToRowsToDisplay(e.sibling,n,o,0)),n},e.prototype.recursivelyAddToRowsToDisplay=function(t,e,n,o,r){if(!hr.missingOrEmpty(t))for(var i=this.gridOptionsService.is("groupHideOpenParents"),s=this.gridOptionsService.is("groupRemoveSingleChildren"),a=!s&&this.gridOptionsService.is("groupRemoveLowestSingleChildren"),l=0;l<t.length;l++){var u=t[l],c=u.hasChildren(),p=o&&!c,h=s&&c&&1===u.childrenAfterGroup.length,d=a&&c&&u.leafGroup&&1===u.childrenAfterGroup.length,f=o&&u.leafGroup,g=i&&u.expanded&&!u.master&&!f;if(!p&&!g&&!h&&!d&&this.addRowNodeToRowsToDisplay(u,e,n,r),!o||!u.leafGroup)if(c){var m=h||d;if(u.expanded||m){var y=m?r:r+1;this.recursivelyAddToRowsToDisplay(u.childrenAfterSort,e,n,o,y),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(u.sibling,e,n,y)}}else if(u.master&&u.expanded){var v=this.createDetailNode(u);this.addRowNodeToRowsToDisplay(v,e,n,r)}}},e.prototype.addRowNodeToRowsToDisplay=function(t,e,n,o){var r=this.gridOptionsService.isGroupMultiAutoColumn();e.push(t),t.setUiLevel(r?0:o)},e.prototype.createDetailNode=function(t){if(hr.exists(t.detailNode))return t.detailNode;var e=new ks(this.beans);return e.detail=!0,e.selectable=!1,e.parent=t,hr.exists(t.id)&&(e.id="detail_"+t.id),e.data=t.data,e.level=t.level+1,t.detailNode=e,e},Ry([$("columnModel")],e.prototype,"columnModel",void 0),Ry([$("beans")],e.prototype,"beans",void 0),e=Ry([Q("flattenStage")],e)}(Ht),Py=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Iy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ay=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Py(e,t),e.prototype.init=function(){this.postSortFunc=this.gridOptionsService.getCallback("postSortRows")},e.prototype.sort=function(t,e,n,o,r,i){var s=this,a=this.gridOptionsService.is("groupMaintainOrder"),l=this.columnModel.getAllGridColumns().some((function(t){return t.isRowGroupActive()})),u={};n&&o&&(u=this.calculateDirtyNodes(o));var c=this.columnModel.isPivotMode();r&&r.forEachChangedNodeDepthFirst((function(o){s.pullDownGroupDataForHideOpenParents(o.childrenAfterAggFilter,!0);var p=c&&o.leafGroup;if(a&&l&&!o.leafGroup&&!i){var h=o.childrenAfterAggFilter.slice(0);if(o.childrenAfterSort){var d={};o.childrenAfterSort.forEach((function(t,e){d[t.id]=e})),h.sort((function(t,e){var n,o;return(null!==(n=d[t.id])&&void 0!==n?n:0)-(null!==(o=d[e.id])&&void 0!==o?o:0)}))}o.childrenAfterSort=h}else o.childrenAfterSort=!e||p?o.childrenAfterAggFilter.slice(0):n?s.doDeltaSort(o,u,r,t):s.rowNodeSorter.doFullSort(o.childrenAfterAggFilter,t);if(o.sibling&&(o.sibling.childrenAfterSort=o.childrenAfterSort),s.updateChildIndexes(o),s.postSortFunc){var f={nodes:o.childrenAfterSort};s.postSortFunc(f)}})),this.updateGroupDataForHideOpenParents(r)},e.prototype.calculateDirtyNodes=function(t){var e={},n=function(t){t&&t.forEach((function(t){return e[t.id]=!0}))};return t&&t.forEach((function(t){n(t.add),n(t.update),n(t.remove)})),e},e.prototype.doDeltaSort=function(t,e,n,o){var r=this,i=t.childrenAfterAggFilter,s=t.childrenAfterSort;if(!s)return this.rowNodeSorter.doFullSort(i,o);var a={},l=[];i.forEach((function(t){e[t.id]||!n.canSkip(t)?l.push(t):a[t.id]=!0}));var u=s.filter((function(t){return a[t.id]})),c=function(t,e){return{currentPos:e,rowNode:t}},p=l.map(c).sort((function(t,e){return r.rowNodeSorter.compareRowNodes(o,t,e)}));return this.mergeSortedArrays(o,p,u.map(c)).map((function(t){return t.rowNode}))},e.prototype.mergeSortedArrays=function(t,e,n){for(var o=[],r=0,i=0;r<e.length&&i<n.length;){this.rowNodeSorter.compareRowNodes(t,e[r],n[i])<0?o.push(e[r++]):o.push(n[i++])}for(;r<e.length;)o.push(e[r++]);for(;i<n.length;)o.push(n[i++]);return o},e.prototype.updateChildIndexes=function(t){if(!hr.missing(t.childrenAfterSort))for(var e=t.childrenAfterSort,n=0;n<e.length;n++){var o=e[n],r=0===n,i=n===t.childrenAfterSort.length-1;o.setFirstChild(r),o.setLastChild(i),o.setChildIndex(n)}},e.prototype.updateGroupDataForHideOpenParents=function(t){var e=this;if(this.gridOptionsService.is("groupHideOpenParents")){if(this.gridOptionsService.isTreeData()){return hr.doOnce((function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")}),"sortService.hideOpenParentsWithTreeData"),!1}var n=function(t){e.pullDownGroupDataForHideOpenParents(t.childrenAfterSort,!1),t.childrenAfterSort.forEach((function(t){t.hasChildren()&&n(t)}))};t&&t.executeFromRootNode((function(t){return n(t)}))}},e.prototype.pullDownGroupDataForHideOpenParents=function(t,e){var n=this;this.gridOptionsService.is("groupHideOpenParents")&&!hr.missing(t)&&t.forEach((function(t){n.columnModel.getGroupDisplayColumns().forEach((function(o){var r=o.getColDef().showRowGroup;if("string"===typeof r){var i=r,s=n.columnModel.getPrimaryColumn(i);if(!(s===t.rowGroupColumn))if(e)t.setGroupValue(o.getId(),void 0);else{var a=t.getFirstChildOfFirstChild(s);a&&t.setGroupValue(o.getId(),a.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")}))}))},Iy([$("columnModel")],e.prototype,"columnModel",void 0),Iy([$("rowNodeSorter")],e.prototype,"rowNodeSorter",void 0),Iy([Z],e.prototype,"init",null),e=Iy([Q("sortService")],e)}(Ht),Dy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),My=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ly=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dy(e,t),e.prototype.filter=function(t){var e=this.filterManager.isChildFilterPresent();this.filterNodes(e,t)},e.prototype.filterNodes=function(t,e){var n=this,o=function(e,o){e.hasChildren()?e.childrenAfterFilter=t&&!o?e.childrenAfterGroup.filter((function(t){var e=t.childrenAfterFilter&&t.childrenAfterFilter.length>0,o=t.data&&n.filterManager.doesRowPassFilter({rowNode:t});return e||o})):e.childrenAfterGroup:e.childrenAfterFilter=e.childrenAfterGroup,e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var r=function(t,e){if(t.childrenAfterGroup)for(var i=0;i<t.childrenAfterGroup.length;i++){var s=t.childrenAfterGroup[i],a=e||n.filterManager.doesRowPassFilter({rowNode:s});s.childrenAfterGroup?r(t.childrenAfterGroup[i],a):o(s,a)}o(t,e)};e.executeFromRootNode((function(t){return r(t,!1)}))}else{e.forEachChangedNodeDepthFirst((function(t){return o(t,!1)}),!0)}},e.prototype.doingTreeDataFiltering=function(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")},My([$("filterManager")],e.prototype,"filterManager",void 0),e=My([Q("filterService")],e)}(Ht),Ny=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ky=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s},Gy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ny(e,t),e.prototype.postConstruct=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},e.prototype.isActive=function(){var t=this.gridOptionsService.exists("getRowId");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&t},e.prototype.setRowData=function(t){var e=this.createTransactionForRowData(t);if(e){var n=ky(e,2),o=n[0],r=n[1];this.clientSideRowModel.updateRowData(o,r)}},e.prototype.createTransactionForRowData=function(t){if(hr.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var e=this.gridOptionsService.getCallback("getRowId");if(null!=e){var n={remove:[],update:[],add:[]},o=this.clientSideRowModel.getCopyOfNodesMap(),r=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return hr.exists(t)&&t.forEach((function(t,i){var s=e({data:t,level:0}),a=o[s];(r&&(r[s]=i),a)?(a.data!==t&&n.update.push(t),o[s]=void 0):n.add.push(t)})),hr.iterateObject(o,(function(t,e){e&&n.remove.push(e.data)})),[n,r]}console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!")}},Fy([$("rowModel")],e.prototype,"rowModel",void 0),Fy([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Fy([Z],e.prototype,"postConstruct",null),e=Fy([Q("immutableService")],e)}(Ht),By={version:"30.1.0",moduleName:z.ClientSideRowModelModule,rowModel:"clientSide",beans:[_y,by,Sy,Oy,Ay,Ly,Gy]},Vy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),zy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jy=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.parentCache=n,r.params=o,r.startRow=e*o.blockSize,r.endRow=r.startRow+o.blockSize,r}return Vy(e,t),e.prototype.postConstruct=function(){this.createRowNodes()},e.prototype.getBlockStateJson=function(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}},e.prototype.setDataAndId=function(t,e,n){hr.exists(e)?t.setDataAndId(e,n.toString()):t.setDataAndId(void 0,void 0)},e.prototype.loadFromDatasource=function(){var t=this,e=this.createLoadParams();hr.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout((function(){t.params.datasource.getRows(e)}),0)},e.prototype.processServerFail=function(){},e.prototype.createLoadParams=function(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}},e.prototype.forEachNode=function(t,e,n){var o=this;this.rowNodes.forEach((function(r,i){o.startRow+i<n&&t(r,e.next())}))},e.prototype.getLastAccessed=function(){return this.lastAccessed},e.prototype.getRow=function(t,e){void 0===e&&(e=!1),e||(this.lastAccessed=this.params.lastAccessedSequence.next());var n=t-this.startRow;return this.rowNodes[n]},e.prototype.getStartRow=function(){return this.startRow},e.prototype.getEndRow=function(){return this.endRow},e.prototype.createRowNodes=function(){this.rowNodes=[];for(var t=0;t<this.params.blockSize;t++){var e=this.startRow+t,n=new ks(this.beans);n.setRowHeight(this.params.rowHeight),n.uiLevel=0,n.setRowIndex(e),n.setRowTop(this.params.rowHeight*e),this.rowNodes.push(n)}},e.prototype.processServerResult=function(t){var e=this;this.rowNodes.forEach((function(n,o){var r=t.rowData?t.rowData[o]:void 0;!n.id&&n.alreadyRendered&&r&&(e.rowNodes[o]=new ks(e.beans),e.rowNodes[o].setRowIndex(n.rowIndex),e.rowNodes[o].setRowTop(n.rowTop),n.clearRowTopAndRowIndex()),e.setDataAndId(e.rowNodes[o],r,e.startRow+o)}));var n=null!=t.rowCount&&t.rowCount>=0?t.rowCount:void 0;this.parentCache.pageLoaded(this,n)},e.prototype.destroyRowNodes=function(){this.rowNodes.forEach((function(t){t.clearRowTopAndRowIndex()}))},zy([$("beans")],e.prototype,"beans",void 0),zy([Z],e.prototype,"postConstruct",null),zy([J],e.prototype,"destroyRowNodes",null),e}(Vh),Hy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Uy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Wy=function(t,e){return function(n,o){e(n,o,t)}},qy=function(t){function e(e){var n=t.call(this)||this;return n.lastRowIndexKnown=!1,n.blocks={},n.blockCount=0,n.rowCount=e.initialRowCount,n.params=e,n}return Hy(e,t),e.prototype.setBeans=function(t){this.logger=t.create("InfiniteCache")},e.prototype.getRow=function(t,e){void 0===e&&(e=!1);var n=Math.floor(t/this.params.blockSize),o=this.blocks[n];if(!o){if(e)return;o=this.createBlock(n)}return o.getRow(t)},e.prototype.createBlock=function(t){var e=this.createBean(new jy(t,this,this.params));return this.blocks[e.getId()]=e,this.blockCount++,this.purgeBlocksIfNeeded(e),this.params.rowNodeBlockLoader.addBlock(e),e},e.prototype.refreshCache=function(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach((function(t){return t.setStateWaitingToLoad()})),this.params.rowNodeBlockLoader.checkBlockToLoad())},e.prototype.destroyAllBlocks=function(){var t=this;this.getBlocksInOrder().forEach((function(e){return t.destroyBlock(e)}))},e.prototype.getRowCount=function(){return this.rowCount},e.prototype.isLastRowIndexKnown=function(){return this.lastRowIndexKnown},e.prototype.pageLoaded=function(t,e){this.isAlive()&&(this.logger.log("onPageLoaded: page = "+t.getId()+", lastRow = "+e),this.checkRowCount(t,e),this.onCacheUpdated())},e.prototype.purgeBlocksIfNeeded=function(t){var n=this,o=this.getBlocksInOrder().filter((function(e){return e!=t}));o.sort((function(t,e){return e.getLastAccessed()-t.getLastAccessed()}));var r=this.params.maxBlocksInCache>0,i=r?this.params.maxBlocksInCache-1:null,s=e.MAX_EMPTY_BLOCKS_TO_KEEP-1;o.forEach((function(t,e){if(t.getState()===jy.STATE_WAITING_TO_LOAD&&e>=s||!!r&&e>=i){if(n.isBlockCurrentlyDisplayed(t))return;if(n.isBlockFocused(t))return;n.removeBlockFromCache(t)}}))},e.prototype.isBlockFocused=function(t){var e=this.focusService.getFocusCellToUseAfterRefresh();if(!e)return!1;if(null!=e.rowPinned)return!1;var n=t.getStartRow(),o=t.getEndRow();return e.rowIndex>=n&&e.rowIndex<o},e.prototype.isBlockCurrentlyDisplayed=function(t){var e=t.getStartRow(),n=t.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(e,n)},e.prototype.removeBlockFromCache=function(t){t&&this.destroyBlock(t)},e.prototype.checkRowCount=function(t,e){if("number"===typeof e&&e>=0)this.rowCount=e,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){var n=(t.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<n&&(this.rowCount=n)}},e.prototype.setRowCount=function(t,e){this.rowCount=t,hr.exists(e)&&(this.lastRowIndexKnown=e),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()},e.prototype.forEachNodeDeep=function(t){var e=this,n=new dr;this.getBlocksInOrder().forEach((function(o){return o.forEachNode(t,n,e.rowCount)}))},e.prototype.getBlocksInOrder=function(){return hr.getAllValuesInObject(this.blocks).sort((function(t,e){return t.getId()-e.getId()}))},e.prototype.destroyBlock=function(t){delete this.blocks[t.getId()],this.destroyBean(t),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(t)},e.prototype.onCacheUpdated=function(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();var t={type:Zt.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(t)}},e.prototype.destroyAllBlocksPastVirtualRowCount=function(){var t=this,e=[];this.getBlocksInOrder().forEach((function(n){n.getId()*t.params.blockSize>=t.rowCount&&e.push(n)})),e.length>0&&e.forEach((function(e){return t.destroyBlock(e)}))},e.prototype.purgeCache=function(){var t=this;this.getBlocksInOrder().forEach((function(e){return t.removeBlockFromCache(e)})),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()},e.prototype.getRowNodesInRange=function(t,e){var n=this,o=[],r=-1,i=!1,s=new dr;hr.missing(t)&&(i=!0);var a=!1;return this.getBlocksInOrder().forEach((function(l){a||(i&&r+1!==l.getId()?a=!0:(r=l.getId(),l.forEachNode((function(n){var r=n===t||n===e;(i||r)&&o.push(n),r&&(i=!i)}),s,n.rowCount)))})),a||i?[]:o},e.MAX_EMPTY_BLOCKS_TO_KEEP=2,Uy([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Uy([$("focusService")],e.prototype,"focusService",void 0),Uy([Wy(0,nt("loggerFactory"))],e.prototype,"setBeans",null),Uy([J],e.prototype,"destroyAllBlocks",null),e}(Ht),Xy=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yy=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ky=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xy(e,t),e.prototype.getRowBounds=function(t){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*t}},e.prototype.ensureRowHeightsValid=function(t,e,n,o){return!1},e.prototype.init=function(){var t=this;this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc((function(){return t.destroyCache()})),this.verifyProps())},e.prototype.verifyProps=function(){if(this.gridOptionsService.exists("initialGroupOrderComparator")){hr.doOnce((function(){return console.warn("AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.")}),"IRM.InitialGroupOrderComparator")}},e.prototype.start=function(){this.setDatasource(this.gridOptionsService.get("datasource"))},e.prototype.destroyDatasource=function(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)},e.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Zt.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,Zt.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))},e.prototype.onFilterChanged=function(){this.reset()},e.prototype.onSortChanged=function(){this.reset()},e.prototype.onColumnEverything=function(){(!this.cacheParams||this.isSortModelDifferent())&&this.reset()},e.prototype.isSortModelDifferent=function(){return!hr.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())},e.prototype.getType=function(){return"infinite"},e.prototype.setDatasource=function(t){this.destroyDatasource(),this.datasource=t,t&&this.reset()},e.prototype.isEmpty=function(){return!this.infiniteCache},e.prototype.isRowsToRender=function(){return!!this.infiniteCache},e.prototype.getNodesInRangeForSelection=function(t,e){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(t,e):[]},e.prototype.reset=function(){if(this.datasource){null!=this.gridOptionsService.getCallback("getRowId")||this.selectionService.reset(),this.resetCache();var t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)}},e.prototype.createModelUpdatedEvent=function(){return{type:Zt.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}},e.prototype.resetCache=function(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new dr},this.infiniteCache=this.createBean(new qy(this.cacheParams))},e.prototype.defaultIfInvalid=function(t,e){return t>0?t:e},e.prototype.destroyCache=function(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))},e.prototype.onCacheUpdated=function(){var t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)},e.prototype.getRow=function(t){if(this.infiniteCache&&!(t>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(t)},e.prototype.getRowNode=function(t){var e;return this.forEachNode((function(n){n.id===t&&(e=n)})),e},e.prototype.forEachNode=function(t){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(t)},e.prototype.getTopLevelRowCount=function(){return this.getRowCount()},e.prototype.getTopLevelRowDisplayedIndex=function(t){return t},e.prototype.getRowIndexAtPixel=function(t){if(0!==this.rowHeight){var e=Math.floor(t/this.rowHeight),n=this.getRowCount()-1;return e>n?n:e}return 0},e.prototype.getRowCount=function(){return this.infiniteCache?this.infiniteCache.getRowCount():0},e.prototype.isRowPresent=function(t){return!!this.getRowNode(t.id)},e.prototype.refreshCache=function(){this.infiniteCache&&this.infiniteCache.refreshCache()},e.prototype.purgeCache=function(){this.infiniteCache&&this.infiniteCache.purgeCache()},e.prototype.isLastRowIndexKnown=function(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()},e.prototype.setRowCount=function(t,e){this.infiniteCache&&this.infiniteCache.setRowCount(t,e)},Yy([$("filterManager")],e.prototype,"filterManager",void 0),Yy([$("sortController")],e.prototype,"sortController",void 0),Yy([$("selectionService")],e.prototype,"selectionService",void 0),Yy([$("rowRenderer")],e.prototype,"rowRenderer",void 0),Yy([$("rowNodeBlockLoader")],e.prototype,"rowNodeBlockLoader",void 0),Yy([Z],e.prototype,"init",null),Yy([J],e.prototype,"destroyDatasource",null),e=Yy([Q("rowModel")],e)}(Ht),Zy={version:"30.1.0",moduleName:z.InfiniteRowModelModule,rowModel:"infinite",beans:[Ky]},Jy=function(){function t(){}return t.prototype.setBeans=function(t){this.beans=t},t.prototype.getFileName=function(t){var e=this.getDefaultFileExtension();return null!=t&&t.length||(t=this.getDefaultFileName()),-1===t.indexOf(".")?t+"."+e:t},t.prototype.getData=function(t){var e=this.createSerializingSession(t);return this.beans.gridSerializer.serialize(e,t)},t}(),Qy=function(){function t(t){this.groupColumns=[];var e=t.columnModel,n=t.valueService,o=t.gridOptionsService,r=t.valueFormatterService,i=t.valueParserService,s=t.processCellCallback,a=t.processHeaderCallback,l=t.processGroupHeaderCallback,u=t.processRowGroupCallback;this.columnModel=e,this.valueService=n,this.gridOptionsService=o,this.valueFormatterService=r,this.valueParserService=i,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=u}return t.prototype.prepare=function(t){this.groupColumns=t.filter((function(t){return!!t.getColDef().showRowGroup}))},t.prototype.extractHeaderValue=function(t){var e=this.getHeaderName(this.processHeaderCallback,t);return null!=e?e:""},t.prototype.extractRowCellValue=function(t,e,n,o,r){var i=this.gridOptionsService.is("groupHideOpenParents")&&!r.footer||!this.shouldRenderGroupSummaryCell(r,t,e)?this.valueService.getValue(t,r):this.createValueForGroupNode(r);return this.processCell({accumulatedRowIndex:n,rowNode:r,column:t,value:i,processCellCallback:this.processCellCallback,type:o})},t.prototype.shouldRenderGroupSummaryCell=function(t,e,n){var o;if(!(t&&t.group))return!1;if(-1!==this.groupColumns.indexOf(e)){if(null!=(null===(o=t.groupData)||void 0===o?void 0:o[e.getId()]))return!0;if(t.footer&&-1===t.level){var r=e.getColDef();return null==r||!0===r.showRowGroup||r.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}var i=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===n&&i},t.prototype.getHeaderName=function(t,e){return t?t({column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(e,"csv",!0)},t.prototype.createValueForGroupNode=function(t){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});var e=t.footer,n=[t.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;t.parent;)t=t.parent,n.push(t.key);var o=n.reverse().join(" -> ");return e?"Total "+o:o},t.prototype.processCell=function(t){var e,n=this,o=t.accumulatedRowIndex,r=t.rowNode,i=t.column,s=t.value,a=t.processCellCallback,l=t.type;return a?{value:null!==(e=a({accumulatedRowIndex:o,column:i,node:r,value:s,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:l,parseValue:function(t){return n.valueParserService.parseValue(i,r,t,n.valueService.getValue(i,r))},formatValue:function(t){var e;return null!==(e=n.valueFormatterService.formatValue(i,r,t))&&void 0!==e?e:t}}))&&void 0!==e?e:""}:i.getColDef().useValueFormatterForExport?{value:null!==s&&void 0!==s?s:"",valueFormatted:this.valueFormatterService.formatValue(i,r,s)}:{value:null!==s&&void 0!==s?s:""}},t}(),$y=function(){function t(){}return t.download=function(t,e){var n=document.defaultView||window;if(n){var o=document.createElement("a"),r=n.URL.createObjectURL(e);o.setAttribute("href",r),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(o),n.setTimeout((function(){n.URL.revokeObjectURL(r)}),0)}else console.warn("AG Grid: There is no `window` associated with the current `document`")},t}(),tv=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ev=function(t){function e(e){var n=t.call(this,e)||this;n.isFirstLine=!0,n.result="";var o=e.suppressQuotes,r=e.columnSeparator;return n.suppressQuotes=o,n.columnSeparator=r,n}return tv(e,t),e.prototype.addCustomContent=function(t){var e=this;t&&("string"===typeof t?(/^\s*\n/.test(t)||this.beginNewLine(),t=t.replace(/\r?\n/g,"\r\n"),this.result+=t):t.forEach((function(t){e.beginNewLine(),t.forEach((function(t,n){0!==n&&(e.result+=e.columnSeparator),e.result+=e.putInQuotes(t.data.value||""),t.mergeAcross&&e.appendEmptyCells(t.mergeAcross)}))})))},e.prototype.onNewHeaderGroupingRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}},e.prototype.onNewHeaderGroupingRowColumn=function(t,e,n,o){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e),this.appendEmptyCells(o)},e.prototype.appendEmptyCells=function(t){for(var e=1;e<=t;e++)this.result+=this.columnSeparator+this.putInQuotes("")},e.prototype.onNewHeaderRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}},e.prototype.onNewHeaderRowColumn=function(t,e){0!=e&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(t))},e.prototype.onNewBodyRow=function(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}},e.prototype.onNewBodyRowColumn=function(t,e,n){var o;0!=e&&(this.result+=this.columnSeparator);var r=this.extractRowCellValue(t,e,e,"csv",n);this.result+=this.putInQuotes(null!==(o=r.valueFormatted)&&void 0!==o?o:r.value)},e.prototype.putInQuotes=function(t){return this.suppressQuotes?t:null===t||void 0===t?'""':("string"===typeof t?e=t:"function"===typeof t.toString?e=t.toString():(console.warn("AG Grid: unknown value type during csv conversion"),e=""),'"'+e.replace(/"/g,'""')+'"');var e},e.prototype.parse=function(){return this.result},e.prototype.beginNewLine=function(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1},e}(Qy),nv=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ov=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},rv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return nv(e,t),e.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})},e.prototype.getMergedParams=function(t){var e=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},e,t)},e.prototype.export=function(t){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var e=this.getMergedParams(t),n=this.getData(e),o=new Blob(["\ufeff",n],{type:"text/plain"});return $y.download(this.getFileName(e.fileName),o),n},e.prototype.exportDataAsCsv=function(t){return this.export(t)},e.prototype.getDataAsCsv=function(t,e){void 0===e&&(e=!1);var n=e?Object.assign({},t):this.getMergedParams(t);return this.getData(n)},e.prototype.getDefaultFileName=function(){return"export.csv"},e.prototype.getDefaultFileExtension=function(){return"csv"},e.prototype.createSerializingSession=function(t){var e=this,n=e.columnModel,o=e.valueService,r=e.gridOptionsService,i=e.valueFormatterService,s=e.valueParserService,a=t,l=a.processCellCallback,u=a.processHeaderCallback,c=a.processGroupHeaderCallback,p=a.processRowGroupCallback,h=a.suppressQuotes,d=a.columnSeparator;return new ev({columnModel:n,valueService:o,gridOptionsService:r,valueFormatterService:i,valueParserService:s,processCellCallback:l||void 0,processHeaderCallback:u||void 0,processGroupHeaderCallback:c||void 0,processRowGroupCallback:p||void 0,suppressQuotes:h||!1,columnSeparator:d||","})},e.prototype.isExportSuppressed=function(){return this.gridOptionsService.is("suppressCsvExport")},ov([$("columnModel")],e.prototype,"columnModel",void 0),ov([$("valueService")],e.prototype,"valueService",void 0),ov([$("gridSerializer")],e.prototype,"gridSerializer",void 0),ov([$("gridOptionsService")],e.prototype,"gridOptionsService",void 0),ov([$("valueFormatterService")],e.prototype,"valueFormatterService",void 0),ov([$("valueParserService")],e.prototype,"valueParserService",void 0),ov([Z],e.prototype,"postConstruct",null),e=ov([Q("csvCreator")],e)}(Jy),iv=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),sv=function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t[t.HEADER_GROUPING=0]="HEADER_GROUPING",t[t.HEADER=1]="HEADER",t[t.BODY=2]="BODY"}(vy||(vy={}));var av=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return iv(e,t),e.prototype.serialize=function(t,e){void 0===e&&(e={});var n=this.getColumnsToExport(e.allColumns,e.columnKeys);return hr.compose(this.prepareSession(n),this.prependContent(e),this.exportColumnGroups(e,n),this.exportHeaders(e,n),this.processPinnedTopRows(e,n),this.processRows(e,n),this.processPinnedBottomRows(e,n),this.appendContent(e))(t).parse()},e.prototype.processRow=function(t,e,n,o){var r=e.shouldRowBeSkipped||function(){return!1},i=this.gridOptionsService.context,s=this.gridOptionsService.api,a=this.gridOptionsService.columnApi,l=this.gridOptionsService.is("groupRemoveSingleChildren"),u=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),c=null!=e.rowPositions||!!e.onlySelected,p=this.gridOptionsService.is("groupHideOpenParents")&&!c,h=this.columnModel.isPivotMode()?o.leafGroup:!o.group,d=!!o.footer,f=e.skipGroups||e.skipRowGroups,g=u&&o.leafGroup,m=1===o.allChildrenCount&&(l||g);if((f&&e.skipGroups&&hr.doOnce((function(){return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.")}),"gridSerializer-skipGroups"),!(!h&&!d&&(e.skipRowGroups||m||p)||e.onlySelected&&!o.isSelected()||e.skipPinnedTop&&"top"===o.rowPinned||e.skipPinnedBottom&&"bottom"===o.rowPinned))&&((!(-1===o.level)||h||d)&&!r({node:o,api:s,columnApi:a,context:i}))){var y=t.onNewBodyRow(o);if(n.forEach((function(t,e){y.onColumn(t,e,o)})),e.getCustomContentBelowRow){var v=e.getCustomContentBelowRow({node:o,api:s,columnApi:a,context:i});v&&t.addCustomContent(v)}}},e.prototype.appendContent=function(t){return function(e){var n=t.customFooter||t.appendContent;return n&&(t.customFooter&&hr.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.")}),"gridSerializer-customFooter"),e.addCustomContent(n)),e}},e.prototype.prependContent=function(t){return function(e){var n=t.customHeader||t.prependContent;return n&&(t.customHeader&&hr.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.")}),"gridSerializer-customHeader"),e.addCustomContent(n)),e}},e.prototype.prepareSession=function(t){return function(e){return e.prepare(t),e}},e.prototype.exportColumnGroups=function(t,e){var n=this;return function(o){if(t.skipColumnGroupHeaders)t.columnGroups&&hr.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.")}),"gridSerializer-columnGroups");else{var r=new Jt,i=n.displayedGroupCreator.createDisplayedGroups(e,r,null);n.recursivelyAddHeaderGroups(i,o,t.processGroupHeaderCallback)}return o}},e.prototype.exportHeaders=function(t,e){return function(n){if(t.skipHeader||t.skipColumnHeaders)t.skipHeader&&hr.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.")}),"gridSerializer-skipHeader");else{var o=n.onNewHeaderRow();e.forEach((function(t,e){o.onColumn(t,e,void 0)}))}return n}},e.prototype.processPinnedTopRows=function(t,e){var n=this;return function(o){var r=n.processRow.bind(n,o,t,e);return t.rowPositions?t.rowPositions.filter((function(t){return"top"===t.rowPinned})).sort((function(t,e){return t.rowIndex-e.rowIndex})).map((function(t){return n.pinnedRowModel.getPinnedTopRow(t.rowIndex)})).forEach(r):n.pinnedRowModel.forEachPinnedTopRow(r),o}},e.prototype.processRows=function(t,e){var n=this;return function(o){var r=n.rowModel,i=r.getType(),s="clientSide"===i,a="serverSide"===i,l=!s&&t.onlySelected,u=n.processRow.bind(n,o,t,e),c=t.exportedRows,p=void 0===c?"filteredAndSorted":c;if(t.rowPositions)t.rowPositions.filter((function(t){return null==t.rowPinned})).sort((function(t,e){return t.rowIndex-e.rowIndex})).map((function(t){return r.getRow(t.rowIndex)})).forEach(u);else if(n.columnModel.isPivotMode())s?r.forEachPivotNode(u,!0):r.forEachNode(u);else if(t.onlySelectedAllPages||l){var h=n.selectionService.getSelectedNodes();n.replicateSortedOrder(h),h.forEach(u)}else"all"===p?r.forEachNode(u):s?r.forEachNodeAfterFilterAndSort(u,!0):a?r.forEachNodeAfterFilterAndSort(u):r.forEachNode(u);return o}},e.prototype.replicateSortedOrder=function(t){var e=this,n=this.sortController.getSortOptions(),o=function(t,r){var i,s,a,l;return null!=t.rowIndex&&null!=r.rowIndex?t.rowIndex-r.rowIndex:t.level===r.level?(null===(i=t.parent)||void 0===i?void 0:i.id)===(null===(s=r.parent)||void 0===s?void 0:s.id)?e.rowNodeSorter.compareRowNodes(n,{rowNode:t,currentPos:null!==(a=t.rowIndex)&&void 0!==a?a:-1},{rowNode:r,currentPos:null!==(l=r.rowIndex)&&void 0!==l?l:-1}):o(t.parent,r.parent):t.level>r.level?o(t.parent,r):o(t,r.parent)};t.sort(o)},e.prototype.processPinnedBottomRows=function(t,e){var n=this;return function(o){var r=n.processRow.bind(n,o,t,e);return t.rowPositions?t.rowPositions.filter((function(t){return"bottom"===t.rowPinned})).sort((function(t,e){return t.rowIndex-e.rowIndex})).map((function(t){return n.pinnedRowModel.getPinnedBottomRow(t.rowIndex)})).forEach(r):n.pinnedRowModel.forEachPinnedBottomRow(r),o}},e.prototype.getColumnsToExport=function(t,e){void 0===t&&(t=!1);var n=this.columnModel.isPivotMode();return e&&e.length?this.columnModel.getGridColumns(e):t&&!n?(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([te]):[]).concat(this.columnModel.getAllGridColumns()||[]):this.columnModel.getAllDisplayedColumns()},e.prototype.recursivelyAddHeaderGroups=function(t,e,n){var o=[];t.forEach((function(t){var e=t;e.getChildren&&e.getChildren().forEach((function(t){return o.push(t)}))})),t.length>0&&t[0]instanceof Kt&&this.doAddHeaderHeader(e,t,n),o&&o.length>0&&this.recursivelyAddHeaderGroups(o,e,n)},e.prototype.doAddHeaderHeader=function(t,e,n){var o=this,r=t.onNewHeaderGroupingRow(),i=0;e.forEach((function(t){var e,s=t;e=n?n({columnGroup:s,api:o.gridOptionsService.api,columnApi:o.gridOptionsService.columnApi,context:o.gridOptionsService.context}):o.columnModel.getDisplayNameForColumnGroup(s,"header");var a=s.getLeafColumns().reduce((function(t,e,n,o){var r=hr.last(t);return"open"===e.getColumnGroupShow()?r&&null==r[1]||(r=[n],t.push(r)):r&&null==r[1]&&(r[1]=n-1),n===o.length-1&&r&&null==r[1]&&(r[1]=n),t}),[]);r.onColumn(s,e||"",i++,s.getLeafColumns().length-1,a)}))},sv([$("displayedGroupCreator")],e.prototype,"displayedGroupCreator",void 0),sv([$("columnModel")],e.prototype,"columnModel",void 0),sv([$("rowModel")],e.prototype,"rowModel",void 0),sv([$("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),sv([$("selectionService")],e.prototype,"selectionService",void 0),sv([$("rowNodeSorter")],e.prototype,"rowNodeSorter",void 0),sv([$("sortController")],e.prototype,"sortController",void 0),e=sv([Q("gridSerializer")],e)}(Ht),lv={version:"30.1.0",moduleName:z.CsvExportModule,beans:[rv,av]},uv="\r\n",cv=function(){function t(){}return t.createHeader=function(t){void 0===t&&(t={});var e=["version"];return t.version||(t.version="1.0"),t.encoding&&e.push("encoding"),t.standalone&&e.push("standalone"),"<?xml "+e.map((function(e){return e+'="'+t[e]+'"'})).join(" ")+" ?>"},t.createXml=function(t,e){var n=this,o="";t.properties&&(t.properties.prefixedAttributes&&t.properties.prefixedAttributes.forEach((function(t){Object.keys(t.map).forEach((function(r){o+=n.returnAttributeIfPopulated(t.prefix+r,t.map[r],e)}))})),t.properties.rawMap&&Object.keys(t.properties.rawMap).forEach((function(r){o+=n.returnAttributeIfPopulated(r,t.properties.rawMap[r],e)})));var r="<"+t.name+o;return t.children||null!=t.textNode?null!=t.textNode?r+">"+t.textNode+"</"+t.name+">"+uv:(r+=">\r\n",t.children&&t.children.forEach((function(t){r+=n.createXml(t,e)})),r+"</"+t.name+">"+uv):r+"/>"+uv},t.returnAttributeIfPopulated=function(t,e,n){if(!e&&""!==e&&0!==e)return"";var o=e;return"boolean"===typeof e&&n&&(o=n(e))," "+t+'="'+o+'"'},t}(),pv=function(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},hv=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),dv=function(){function t(){}return t.addFolders=function(t){t.forEach(this.addFolder.bind(this))},t.addFolder=function(t){this.folders.push({path:t,created:new Date,isBase64:!1})},t.addFile=function(t,e,n){void 0===n&&(n=!1),this.files.push({path:t,created:new Date,content:e,isBase64:n})},t.getContent=function(t){void 0===t&&(t="application/zip");var e=this.buildFileStream(),n=this.buildUint8Array(e);return this.clearStream(),new Blob([n],{type:t})},t.clearStream=function(){this.folders=[],this.files=[]},t.buildFileStream=function(t){var e,n;void 0===t&&(t="");var o=this.folders.concat(this.files),r=o.length,i="",s=0,a=0;try{for(var l=pv(o),u=l.next();!u.done;u=l.next()){var c=u.value,p=this.getHeader(c,s),h=p.fileHeader,d=p.folderHeader,f=p.content;s+=h.length+f.length,a+=d.length,t+=h+f,i+=d}}catch(g){e={error:g}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return t+i+this.buildFolderEnd(r,a,s)},t.getHeader=function(t,e){var n=t.content,o=t.path,r=t.created,i=t.isBase64,s=hr.utf8_encode,a=hr.decToHex,l=s(o),u=l!==o,c=this.convertTime(r),p=this.convertDate(r),h="";if(u){var d=a(1,1)+a(this.getFromCrc32Table(l),4)+l;h="up"+a(d.length,2)+d}var f=n?this.getConvertedContent(n,i):{size:0,content:""},g=f.size,m=f.content,y="\n\0"+(u?"\0\b":"\0\0")+"\0\0"+a(c,2)+a(p,2)+a(g?this.getFromCrc32Table(m):0,4)+a(g,4)+a(g,4)+a(l.length,2)+a(h.length,2);return{fileHeader:"PK\x03\x04"+y+l+h,folderHeader:"PK\x01\x02\x14\0"+y+"\0\0\0\0\0\0"+(n?"\0\0\0\0":"\x10\0\0\0")+a(e,4)+l+h,content:m||""}},t.getConvertedContent=function(t,e){return void 0===e&&(e=!1),e&&(t=t.split(";base64,")[1]),{size:(t=e?atob(t):t).length,content:t}},t.buildFolderEnd=function(t,e,n){var o=hr.decToHex;return"PK\x05\x06\0\0\0\0"+o(t,2)+o(t,2)+o(e,4)+o(n,4)+"\0\0"},t.buildUint8Array=function(t){for(var e=new Uint8Array(t.length),n=0;n<e.length;n++)e[n]=t.charCodeAt(n);return e},t.getFromCrc32Table=function(t){if(!t.length)return 0;for(var e=t.length,n=new Uint8Array(e),o=0;o<e;o++)n[o]=t.charCodeAt(o);var r=-1,i=0;for(o=0;o<e;o++)i=n[o],r=r>>>8^hv[255&(r^i)];return-1^r},t.convertTime=function(t){var e=t.getHours();return e<<=6,e|=t.getMinutes(),e<<=5,e|=t.getSeconds()/2},t.convertDate=function(t){var e=t.getFullYear()-1980;return e<<=4,e|=t.getMonth()+1,e<<=5,e|=t.getDate()},t.folders=[],t.files=[],t}(),fv=[By,Zy,lv];W.registerModules(fv)},7945:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReact=void 0;var l=a(n(2791)),u=n(4282),c=n(2553),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setGridApi=function(t,n){e.api=t,e.columnApi=n},e}return o(e,t),e.prototype.render=function(){return this.props.suppressReactUi?l.default.createElement(u.AgGridReactLegacy,r({},this.props,{setGridApi:this.setGridApi})):l.default.createElement(c.AgGridReactUi,r({},this.props,{setGridApi:this.setGridApi}))},e}(l.Component);e.AgGridReact=p},4282:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReactLegacy=void 0;var u=n(7520),c=l(n(2007)),p=a(n(2791)),h=n(4619),d=n(8665),f=n(3365),g=n(9575),m=function(t){function e(e){var n=t.call(this,e)||this;return n.props=e,n.api=null,n.destroyed=!1,n.SYNCHRONOUS_CHANGE_PROPERTIES=["context"],n.portalManager=new f.LegacyPortalManager(n,e.componentWrappingElement,e.maxComponentCreationTimeMs),n}return o(e,t),e.prototype.render=function(){var t=this;return p.default.createElement("div",{style:this.createStyleForDiv(),className:this.props.className,ref:function(e){t.eGridDiv=e}},this.portalManager.getPortals())},e.prototype.createStyleForDiv=function(){return r({height:"100%"},this.props.containerStyle||{})},e.prototype.componentDidMount=function(){var t=this.props.modules||[],e={providedBeanInstances:{agGridReact:this,frameworkComponentWrapper:new v(this,this.portalManager)},modules:t,frameworkOverrides:new g.ReactFrameworkOverrides(!1)},n=this.props.gridOptions||{};this.gridOptions=u.ComponentUtil.copyAttributesToGridOptions(n,this.props),this.checkForDeprecations(this.props),new u.Grid(this.eGridDiv,this.gridOptions,e),this.api=this.gridOptions.api,this.columnApi=this.gridOptions.columnApi,this.props.setGridApi(this.api,this.columnApi)},e.prototype.checkForDeprecations=function(t){t.rowDataChangeDetectionStrategy&&u._.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")},e.prototype.shouldComponentUpdate=function(t){return this.processPropsChanges(this.props,t),!1},e.prototype.componentDidUpdate=function(t){this.processPropsChanges(t,this.props)},e.prototype.processPropsChanges=function(t,e){var n={};this.extractGridPropertyChanges(t,e,n),this.processSynchronousChanges(n),this.processAsynchronousChanges(n)},e.prototype.extractGridPropertyChanges=function(t,e,n){var o=!!e.debug;Object.keys(e).forEach((function(r){u.ComponentUtil.ALL_PROPERTIES_SET.has(r)&&t[r]!==e[r]&&(o&&console.log("agGridReact: ["+r+"] property changed"),n[r]={previousValue:t[r],currentValue:e[r]})})),u.ComponentUtil.EVENT_CALLBACKS.forEach((function(r){t[r]!==e[r]&&(o&&console.log("agGridReact: ["+r+"] event callback changed"),n[r]={previousValue:t[r],currentValue:e[r]})}))},e.prototype.componentWillUnmount=function(){this.api&&(this.api.destroy(),this.api=null),this.destroyed=!0,this.portalManager.destroy()},e.prototype.isDisableStaticMarkup=function(){return!0===this.props.disableStaticMarkup},e.prototype.isLegacyComponentRendering=function(){return!0===this.props.legacyComponentRendering},e.prototype.processSynchronousChanges=function(t){var e=r({},t);if(Object.keys(e).length>0){var n={};this.SYNCHRONOUS_CHANGE_PROPERTIES.forEach((function(t){e[t]&&(n[t]=e[t],delete e[t])})),Object.keys(n).length>0&&this.api&&u.ComponentUtil.processOnChange(n,this.api)}return e},e.prototype.processAsynchronousChanges=function(t){var e=this;Object.keys(t).length>0&&window.setTimeout((function(){e.api&&u.ComponentUtil.processOnChange(t,e.api)}))},e.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,e.defaultProps={legacyComponentRendering:!1,disableStaticMarkup:!1,maxComponentCreationTimeMs:e.MAX_COMPONENT_CREATION_TIME_IN_MS},e}(p.Component);function y(t,e){t.forEach((function(t){m[t]=e}))}e.AgGridReactLegacy=m,m.propTypes={gridOptions:c.default.object},y(u.ComponentUtil.EVENT_CALLBACKS,c.default.func),y(u.ComponentUtil.BOOLEAN_PROPERTIES,c.default.bool),y(u.ComponentUtil.STRING_PROPERTIES,c.default.string),y(u.ComponentUtil.OBJECT_PROPERTIES,c.default.object),y(u.ComponentUtil.ARRAY_PROPERTIES,c.default.array),y(u.ComponentUtil.NUMBER_PROPERTIES,c.default.number),y(u.ComponentUtil.FUNCTION_PROPERTIES,c.default.func);var v=function(t){function e(e,n){var o=t.call(this)||this;return o.agGridReact=e,o.portalManager=n,o}return o(e,t),e.prototype.createWrapper=function(t,e){return this.agGridReact.isLegacyComponentRendering()?new h.LegacyReactComponent(t,this.agGridReact,this.portalManager,e):new d.NewReactComponent(t,this.portalManager,e)},e}(u.BaseComponentWrapper)},4619:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LegacyReactComponent=void 0;var i=n(2791),s=n(4164),a=n(7520),l=n(294),u=n(8340),c=r(n(3507)),p=function(t){function e(e,n,o,r){var i=t.call(this,e,o,r)||this;return i.staticMarkup=null,i.staticRenderTime=0,i.parentComponent=n,i}return o(e,t),e.prototype.init=function(t){var e=this;return this.eParentElement=this.createParentElement(t),this.renderStaticMarkup(t),new a.AgPromise((function(n){return e.createReactComponent(t,n)}))},e.prototype.createReactComponent=function(t,e){var n=this;this.isStatelessComponent()||(t.ref=function(t){n.componentInstance=t,n.addParentContainerStyleAndClasses(),n.removeStaticMarkup()});var o=i.createElement(this.reactComponent,t),r=s.createPortal(o,this.eParentElement,c.default());this.portal=r,this.portalManager.mountReactPortal(r,this,(function(t){e(t),n.isStatelessComponent()&&(n.isSlowRenderer()&&n.removeStaticMarkup(),setTimeout((function(){n.removeStaticMarkup()})))}))},e.prototype.fallbackMethodAvailable=function(t){return!1},e.prototype.fallbackMethod=function(t,e){},e.prototype.isSlowRenderer=function(){return this.staticRenderTime>=e.SLOW_RENDERING_THRESHOLD},e.prototype.isNullValue=function(){return""===this.staticMarkup},e.prototype.renderStaticMarkup=function(t){if(!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer){var e=console.error,n=i.createElement(this.reactComponent,t);try{console.error=function(){};var o=Date.now(),r=u.renderToStaticMarkup(n);this.staticRenderTime=Date.now()-o,console.error=e,""===r?this.staticMarkup=r:r&&(this.staticMarkup=document.createElement("span"),this.staticMarkup.innerHTML=r,this.eParentElement.appendChild(this.staticMarkup))}catch(s){}finally{console.error=e}}},e.prototype.removeStaticMarkup=function(){!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer&&this.staticMarkup&&(this.staticMarkup.remove?(this.staticMarkup.remove(),this.staticMarkup=null):this.eParentElement.removeChild&&(this.eParentElement.removeChild(this.staticMarkup),this.staticMarkup=null))},e.prototype.rendered=function(){return this.isNullValue()||!!this.staticMarkup||this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())},e.SLOW_RENDERING_THRESHOLD=3,e}(l.ReactComponent);e.LegacyReactComponent=p},4340:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||o(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReactFire=e.AgGridReactLegacy=e.AgGridReact=void 0;var i=n(7945);Object.defineProperty(e,"AgGridReact",{enumerable:!0,get:function(){return i.AgGridReact}});var s=n(4282);Object.defineProperty(e,"AgGridReactLegacy",{enumerable:!0,get:function(){return s.AgGridReactLegacy}});var a=n(2553);Object.defineProperty(e,"AgGridReactFire",{enumerable:!0,get:function(){return a.AgGridReactUi}}),r(n(7736),e)},2553:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return s(e,t),e},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AgGridReactUi=void 0;var u=n(7520),c=a(n(2791)),p=n(8665),h=n(3365),d=n(9575),f=l(n(3970));e.AgGridReactUi=function(t){var e,n,o=c.useRef(null),i=c.useRef(null),s=c.useRef(null),a=c.useRef([]),l=c.useRef([]),p=c.useRef(t),m=c.useRef(!1),y=c.useState(void 0),v=y[0],_=y[1],C=c.useCallback((function(t){t.rowDataChangeDetectionStrategy&&u._.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")}),[]),w=c.useState(0)[1],b=c.useCallback((function(e){if(i.current=e,!i.current)return a.current.forEach((function(t){return t()})),void(a.current.length=0);var n=t.modules||[];s.current||(s.current=new h.PortalManager((function(){return w((function(t){return t+1}))}),t.componentWrappingElement,t.maxComponentCreationTimeMs),a.current.push((function(){var t;null===(t=s.current)||void 0===t||t.destroy(),s.current=null})));var r={providedBeanInstances:{frameworkComponentWrapper:new g(s.current)},modules:n,frameworkOverrides:new d.ReactFrameworkOverrides(!0)};o.current=t.gridOptions||{},o.current=u.ComponentUtil.copyAttributesToGridOptions(o.current,t),C(t);(new u.GridCoreCreator).create(i.current,o.current,(function(e){_(e),a.current.push((function(){e.destroy()})),e.getBean(u.CtrlsService.NAME).whenReady((function(){if(!e.isDestroyed()&&o.current){var n=o.current.api;n&&t.setGridApi&&t.setGridApi(n,o.current.columnApi)}}))}),(function(t){t.getBean(u.CtrlsService.NAME).whenReady((function(){l.current.forEach((function(t){return t()})),l.current.length=0,m.current=!0}))}),r)}),[]),x=c.useMemo((function(){return r({height:"100%"},t.containerStyle||{})}),[t.containerStyle]),E=c.useCallback((function(t){m.current?t():l.current.push(t)}),[]);return c.useEffect((function(){var e={};!function(t,e,n){var o=!!e.debug;Object.keys(e).forEach((function(r){u.ComponentUtil.ALL_PROPERTIES_SET.has(r)&&t[r]!==e[r]&&(o&&console.log(" agGridReact: ["+r+"] property changed"),n[r]={previousValue:t[r],currentValue:e[r]})})),u.ComponentUtil.EVENT_CALLBACKS.forEach((function(r){t[r]!==e[r]&&(o&&console.log("agGridReact: ["+r+"] event callback changed"),n[r]={previousValue:t[r],currentValue:e[r]})}))}(p.current,t,e),p.current=t,E((function(){var t;(null===(t=o.current)||void 0===t?void 0:t.api)&&u.ComponentUtil.processOnChange(e,o.current.api)}))}),[t]),c.default.createElement("div",{style:x,className:t.className,ref:b},v&&!v.isDestroyed()?c.default.createElement(f.default,{context:v}):null,null!==(n=null===(e=s.current)||void 0===e?void 0:e.getPortals())&&void 0!==n?n:null)};var g=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return o(e,t),e.prototype.createWrapper=function(t,e){return new p.NewReactComponent(t,this.parent,e)},e}(u.BaseComponentWrapper)},2724:function(t,e,n){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BeansContext=void 0;var r=o(n(2791));e.BeansContext=r.default.createContext({})},7627:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(2791)),l=n(6817),u=n(7520),c=n(2724),p=n(2553);e.default=a.forwardRef((function(t,e){var n=a.useContext(c.BeansContext),r=n.ctrlsFactory,i=n.context,s=n.gridOptionsService,h=n.resizeObserverService,d=n.clientSideRowModel,f=n.serverSideRowModel,g=a.useState((function(){return new l.CssClasses})),m=g[0],y=g[1],v=a.useState((function(){return new l.CssClasses})),_=v[0],C=v[1],w=a.useState(),b=w[0],x=w[1],E=a.useState(),S=E[0],T=E[1],R=a.useRef(),O=a.useRef(null),P=a.useRef(),I=a.useMemo((function(){return u.ModuleRegistry.__getGridRegisteredModules(t.api.getGridId())}),[t]),A=a.useMemo((function(){return m.toString()+" ag-details-row"}),[m]),D=a.useMemo((function(){return _.toString()+" ag-details-grid"}),[_]);e&&a.useImperativeHandle(e,(function(){return{refresh:function(){var t,e;return null!==(e=null===(t=R.current)||void 0===t?void 0:t.refresh())&&void 0!==e&&e}}})),t.template&&u._.doOnce((function(){return console.warn("AG Grid: detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/")}),"React_detailCellRenderer.template");var M=a.useCallback((function(e){if(O.current=e,!O.current)return i.destroyBean(R.current),void(P.current&&P.current());var n={addOrRemoveCssClass:function(t,e){return y((function(n){return n.setClass(t,e)}))},addOrRemoveDetailGridCssClass:function(t,e){return C((function(n){return n.setClass(t,e)}))},setDetailGrid:function(t){return x(t)},setRowData:function(t){return T(t)},getGui:function(){return O.current}},o=r.getInstance("detailCellRenderer");if(o&&(i.createBean(o),o.init(n,t),R.current=o,s.is("detailRowAutoHeight"))){var a=function(){if(null!=O.current){var e=O.current.clientHeight;if(null!=e&&e>0){setTimeout((function(){t.node.setRowHeight(e),d?d.onRowHeightChanged():f&&f.onRowHeightChanged()}),0)}}};P.current=h.observeResize(O.current,a),a()}}),[]),L=a.useCallback((function(t,e){var n;null===(n=R.current)||void 0===n||n.registerDetailWithMaster(t,e)}),[]);return a.default.createElement("div",{className:A,ref:M},b&&a.default.createElement(p.AgGridReactUi,o({className:D},b,{modules:I,rowData:S,setGridApi:L})))}))},5728:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=n(7520),l=s(n(2791)),u=n(2724),c=n(8285),p=n(6817),h=l.forwardRef((function(t,e){var n=l.useContext(u.BeansContext).context,r=l.useRef(null),i=l.useRef(null),s=l.useRef(null),d=l.useRef(null),f=l.useRef(null),g=l.useRef(),m=l.useState(),y=m[0],v=m[1],_=l.useState(),C=_[0],w=_[1],b=l.useState(),x=b[0],E=b[1],S=l.useState((function(){return new p.CssClasses})),T=S[0],R=S[1],O=l.useState((function(){return new p.CssClasses("ag-hidden")})),P=O[0],I=O[1],A=l.useState((function(){return new p.CssClasses("ag-hidden")})),D=A[0],M=A[1],L=l.useState((function(){return new p.CssClasses("ag-invisible")})),N=L[0],F=L[1];l.useImperativeHandle(e,(function(){return{refresh:function(){return!1}}})),l.useLayoutEffect((function(){return c.showJsComp(y,n,i.current)}),[y]);var k=l.useCallback((function(e){if(r.current=e,!r.current)return n.destroyBean(g.current),void(g.current=null);var o={setInnerRenderer:function(t,e){v(t),E(e)},setChildCount:function(t){return w(t)},addOrRemoveCssClass:function(t,e){return R((function(n){return n.setClass(t,e)}))},setContractedDisplayed:function(t){return M((function(e){return e.setClass("ag-hidden",!t)}))},setExpandedDisplayed:function(t){return I((function(e){return e.setClass("ag-hidden",!t)}))},setCheckboxVisible:function(t){return F((function(e){return e.setClass("ag-invisible",!t)}))}};g.current=n.createBean(new a.GroupCellRendererCtrl),g.current.init(o,r.current,s.current,d.current,f.current,h,t)}),[]),G=l.useMemo((function(){return"ag-cell-wrapper "+T.toString()}),[T]),B=l.useMemo((function(){return"ag-group-expanded "+P.toString()}),[P]),V=l.useMemo((function(){return"ag-group-contracted "+D.toString()}),[D]),z=l.useMemo((function(){return"ag-group-checkbox "+N.toString()}),[N]),j=y&&y.componentFromFramework,H=j?y.componentClass:void 0,U=null==y&&null!=x,W=a._.escapeString(x,!0);return l.default.createElement("span",o({className:G,ref:k},t.colDef?{}:{role:"gridcell"}),l.default.createElement("span",{className:B,ref:d}),l.default.createElement("span",{className:V,ref:f}),l.default.createElement("span",{className:z,ref:s}),l.default.createElement("span",{className:"ag-group-value",ref:i},U&&l.default.createElement(l.default.Fragment,null,W),j&&l.default.createElement(H,o({},y.params))),l.default.createElement("span",{className:"ag-group-child-count"},C))}));e.default=h},4148:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.CellCompState=void 0;var l=n(7520),u=s(n(2791)),c=n(6817),p=a(n(7664)),h=a(n(3930)),d=n(2724),f=n(8285);!function(t){t[t.ShowValue=0]="ShowValue",t[t.EditValue=1]="EditValue"}(e.CellCompState||(e.CellCompState={}));e.default=u.memo((function(t){var e=u.useContext(d.BeansContext).context,n=t.cellCtrl,r=t.printLayout,i=t.editingRow,s=n.getTabIndex(),a=n.getColumnIdSanitised(),g=n.getInstanceId(),m=u.useState((function(){return n.getIsCellRenderer()?void 0:{compDetails:void 0,value:n.getValueToDisplay(),force:!1}})),y=m[0],v=m[1],_=u.useState(),C=_[0],w=_[1],b=u.useState(1),x=b[0],E=b[1],S=u.useState(),T=S[0],R=S[1],O=u.useState(!1),P=O[0],I=O[1],A=u.useState(!1),D=A[0],M=A[1],L=u.useState(!1),N=L[0],F=L[1],k=u.useState(),G=k[0],B=k[1],V=u.useMemo((function(){return n.isForceWrapper()}),[n]),z=u.useRef(null),j=u.useRef(null),H=u.useRef(),U=u.useRef(),W=u.useRef(),q=u.useRef([]),X=u.useRef(),Y=u.useState(0),K=Y[0],Z=Y[1],J=u.useCallback((function(t){X.current=t,Z((function(t){return t+1}))}),[]),Q=V||null!=y&&(P||N||D),$=u.useCallback((function(t,e){(U.current=e,e)&&(!function(t,e,n){var o=n.getColumn();if(!t&&e.isPopup&&e.isPopup()){var r="AG Grid: Found an issue in column "+o.getColId()+". If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.";l._.doOnce((function(){return console.warn(r)}),"jsEditorComp-isPopup-"+n.getColumn().getColId())}if(t&&e.getPopupPosition&&null!=e.getPopupPosition()){var i="AG Grid: Found an issue in column "+o.getColId()+". If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.";l._.doOnce((function(){return console.warn(i)}),"jsEditorComp-getPopupPosition-"+n.getColumn().getColId())}}(t,e,n),e.isCancelBeforeStart&&e.isCancelBeforeStart()&&setTimeout((function(){n.stopEditing(!0),n.focusCell(!0)})))}),[n]),tt=u.useCallback((function(t){return $(!0,t)}),[$]),et=u.useCallback((function(t){return $(!1,t)}),[$]),nt=u.useRef();nt.current||(nt.current=new l.CssClassManager((function(){return z.current}))),h.default(y,Q,X.current,K,H,z);var ot=u.useRef();u.useLayoutEffect((function(){var t=ot.current,e=y;if(ot.current=y,null!=t&&null!=t.compDetails&&null!=e&&null!=e.compDetails){var n=t.compDetails,o=e.compDetails;if(n.componentClass==o.componentClass)if(null!=j.current&&null!=j.current.refresh)1!=j.current.refresh(o.params)&&E((function(t){return t+1}))}}),[y]),u.useLayoutEffect((function(){if(C&&!C.compDetails.componentFromFramework){var t=C.compDetails,n=!0===C.popup,o=f.createSyncJsComp(t);if(o){var r=o.getGui();if($(n,o),!n){var i=(V?W:z).current;null===i||void 0===i||i.appendChild(r),o.afterGuiAttached&&o.afterGuiAttached()}return B(o),function(){e.destroyBean(o),$(n,void 0),B(void 0),r&&r.parentElement&&r.parentElement.removeChild(r)}}}}),[C]);var rt=u.useCallback((function(t){if(W.current=t,!W.current)return q.current.forEach((function(t){return t()})),void(q.current=[]);var o=function(t){var n;if(t){var o=t.getGui();null===(n=W.current)||void 0===n||n.insertAdjacentElement("afterbegin",o),q.current.push((function(){e.destroyBean(t),l._.removeFromParent(o)}))}return t};P&&o(n.createSelectionCheckbox());N&&o(n.createDndSource()),D&&o(n.createRowDragComp())}),[n,e,N,D,P]),it=u.useCallback((function(t){if(z.current=t,z.current&&n){var e={addOrRemoveCssClass:function(t,e){return nt.current.addOrRemoveCssClass(t,e)},setUserStyles:function(t){return R(t)},getFocusableElement:function(){return z.current},setIncludeSelection:function(t){return I(t)},setIncludeRowDrag:function(t){return M(t)},setIncludeDndSource:function(t){return F(t)},getCellEditor:function(){return U.current||null},getCellRenderer:function(){return j.current?j.current:H.current},getParentOfValue:function(){return X.current?X.current:W.current?W.current:z.current},setRenderDetails:function(t,e,n){v((function(o){return(null===o||void 0===o?void 0:o.compDetails)!==t||(null===o||void 0===o?void 0:o.value)!==e||(null===o||void 0===o?void 0:o.force)!==n?{value:e,compDetails:t,force:n}:o}))},setEditDetails:function(t,e,n){t?(w({compDetails:t,popup:e,popupPosition:n}),e||v(void 0)):w(void 0)}},o=W.current||void 0;n.setComp(e,z.current,o,r,i)}}),[]),st=u.useMemo((function(){return!!(y&&y.compDetails&&y.compDetails.componentFromFramework&&c.isComponentStateless(y.compDetails.componentClass))}),[y]);u.useLayoutEffect((function(){var t;z.current&&(nt.current.addOrRemoveCssClass("ag-cell-value",!Q),nt.current.addOrRemoveCssClass("ag-cell-inline-editing",!!C&&!C.popup),nt.current.addOrRemoveCssClass("ag-cell-popup-editing",!!C&&!!C.popup),nt.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!C||!!C.popup),null===(t=n.getRowCtrl())||void 0===t||t.setInlineEditingCss(!!C),n.shouldRestoreFocus()&&!n.isEditing()&&z.current.focus({preventScroll:!0}))}));var at=function(){return u.default.createElement(u.default.Fragment,null,null!=y&&function(t,e,n,r,i,s,a){var l=t.compDetails,c=t.value,p=!l,h=l&&l.componentFromFramework,d=l&&l.componentClass,f=(null===c||void 0===c?void 0:c.toString)?c.toString():c,g=function(){return u.default.createElement(u.default.Fragment,null,p&&u.default.createElement(u.default.Fragment,null,f),h&&!s&&u.default.createElement(d,o({},l.params,{key:e,ref:r})),h&&s&&u.default.createElement(d,o({},l.params,{key:e})))};return u.default.createElement(u.default.Fragment,null,i?u.default.createElement("span",{role:"presentation",id:"cell-"+n,className:"ag-cell-value",ref:a},g()):g())}(y,x,g,j,Q,st,J),null!=C&&function(t,e,n,r,i,s){var a=t.compDetails,l=a.componentClass,c=a.componentFromFramework&&!t.popup,h=a.componentFromFramework&&t.popup,d=!a.componentFromFramework&&t.popup;return u.default.createElement(u.default.Fragment,null,c&&u.default.createElement(l,o({},t.compDetails.params,{ref:e})),h&&u.default.createElement(p.default,{editDetails:t,cellCtrl:i,eParentCell:r,wrappedContent:u.default.createElement(l,o({},t.compDetails.params,{ref:n}))}),d&&s&&u.default.createElement(p.default,{editDetails:t,cellCtrl:i,eParentCell:r,jsChildComp:s}))}(C,et,tt,z.current,n,G))};return u.default.createElement("div",{ref:it,style:T,tabIndex:s,role:"gridcell","col-id":a},Q?u.default.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:rt},at()):at())}))},7664:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var s=n(7520),a=i(n(2791)),l=n(4164),u=n(2724),c=n(1622);e.default=a.memo((function(t){var e=a.useState(),n=e[0],o=e[1],r=a.useContext(u.BeansContext),i=r.context,p=r.popupService,h=r.localeService,d=r.gridOptionsService;return c.useEffectOnce((function(){var e=t.editDetails,n=t.cellCtrl,r=t.eParentCell,a=e.compDetails,l=d.is("stopEditingWhenCellsLoseFocus"),u=i.createBean(new s.PopupEditorWrapper(a.params)),c=u.getGui();if(t.jsChildComp){var f=t.jsChildComp.getGui();f&&c.appendChild(f)}var g={column:n.getColumn(),rowNode:n.getRowNode(),type:"popupCellEditor",eventSource:r,ePopup:c,position:e.popupPosition,keepWithinBounds:!0},m=p.positionPopupByComponent.bind(p,g),y=h.getLocaleTextFunc(),v=p.addPopup({modal:l,eChild:c,closeOnEsc:!0,closedCallback:function(){n.onPopupEditorClosed()},anchorToElement:r,positionCallback:m,ariaLabel:y("ariaLabelCellEditor","Cell Editor")}),_=v?v.hideFunc:void 0;return o(u),t.jsChildComp&&t.jsChildComp.afterGuiAttached&&t.jsChildComp.afterGuiAttached(),function(){null!=_&&_(),i.destroyBean(u)}})),a.default.createElement(a.default.Fragment,null,n&&t.wrappedContent&&l.createPortal(t.wrappedContent,n.getGui()))}))},3930:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2791),r=n(2724);e.default=function(t,e,n,i,s,a){var l=o.useContext(r.BeansContext).context,u=o.useCallback((function(){var t=s.current;if(t){var e=t.getGui();e&&e.parentElement&&e.parentElement.removeChild(e),l.destroyBean(t),s.current=void 0}}),[]);o.useEffect((function(){var o=null!=t,r=t&&t.compDetails&&!t.compDetails.componentFromFramework;if(o&&r&&!(e&&null==n)){var i=t.compDetails;if(s.current){var l=s.current,c=!!(null!=l.refresh&&0==t.force)&&l.refresh(i.params);if(!0===c||void 0===c)return;u()}var p=i.newAgStackInstance();if(p){var h=p.resolveNow(null,(function(t){return t}));if(h){var d=h.getGui();if(d)(e?n:a.current).appendChild(d),s.current=h}}}else u()}),[t,e,i]),o.useEffect((function(){return u}),[])}},6556:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(7520),l=i(n(2791)),u=n(2724),c=s(n(332)),p=s(n(1008)),h=s(n(961)),d=n(6817);e.default=l.memo((function(){var t=l.useContext(u.BeansContext),e=t.context,n=t.agStackComponentsRegistry,o=t.resizeObserverService,r=l.useState(""),i=r[0],s=r[1],f=l.useState(0),g=f[0],m=f[1],y=l.useState(0),v=y[0],_=y[1],C=l.useState("0px"),w=C[0],b=C[1],x=l.useState("0px"),E=x[0],S=x[1],T=l.useState("100%"),R=T[0],O=T[1],P=l.useState(""),I=P[0],A=P[1],D=l.useState(""),M=D[0],L=D[1],N=l.useState(null),F=N[0],k=N[1],G=l.useState(""),B=G[0],V=G[1],z=l.useState(null),j=z[0],H=z[1],U=l.useState("ag-layout-normal"),W=U[0],q=U[1],X=l.useRef();X.current||(X.current=new a.CssClassManager((function(){return Y.current})));var Y=l.useRef(null),K=l.useRef(null),Z=l.useRef(null),J=l.useRef(null),Q=l.useRef(null),$=l.useRef(null),tt=l.useRef([]),et=l.useRef([]);p.default(" AG Grid Body ",Y),p.default(" AG Pinned Top ",K),p.default(" AG Sticky Top ",Z),p.default(" AG Middle ",Q),p.default(" AG Pinned Bottom ",$);var nt=l.useCallback((function(t){if(Y.current=t,!Y.current)return e.destroyBeans(tt.current),et.current.forEach((function(t){return t()})),tt.current=[],void(et.current=[]);if(e){var r=function(t){var o=n.getComponentClass(t),r=e.createBean(new o);return tt.current.push(r),r},i=function(t,e){t.appendChild(e),et.current.push((function(){return t.removeChild(e)}))};i(Y.current,document.createComment(" AG Fake Horizontal Scroll ")),i(Y.current,r("AG-FAKE-HORIZONTAL-SCROLL").getGui()),i(Y.current,document.createComment(" AG Overlay Wrapper ")),i(Y.current,r("AG-OVERLAY-WRAPPER").getGui()),J.current&&(i(J.current,document.createComment(" AG Fake Vertical Scroll ")),i(J.current,r("AG-FAKE-VERTICAL-SCROLL").getGui()));var l={setRowAnimationCssOnBodyViewport:s,setColumnCount:function(t){Y.current&&a._.setAriaColCount(Y.current,t)},setRowCount:function(t){Y.current&&a._.setAriaRowCount(Y.current,t)},setTopHeight:m,setBottomHeight:_,setStickyTopHeight:b,setStickyTopTop:S,setStickyTopWidth:O,setTopDisplay:A,setBottomDisplay:L,setColumnMovingCss:function(t,e){return X.current.addOrRemoveCssClass(t,e)},updateLayoutClasses:q,setAlwaysVerticalScrollClass:k,setPinnedTopBottomOverflowY:V,setCellSelectableCss:function(t,e){return H(e?t:null)},setBodyViewportWidth:function(t){Q.current&&(Q.current.style.width=t)},registerBodyViewportResizeListener:function(t){if(Q.current){var e=o.observeResize(Q.current,t);et.current.push((function(){return e()}))}}},u=e.createBean(new a.GridBodyCtrl);tt.current.push(u),u.setComp(l,Y.current,Q.current,K.current,$.current,Z.current)}}),[]),ot=l.useMemo((function(){return d.classesList("ag-root","ag-unselectable",W)}),[W]),rt=l.useMemo((function(){return d.classesList("ag-body-viewport",i,W,F,j)}),[i,W,F,j]),it=l.useMemo((function(){return d.classesList("ag-body",W)}),[W]),st=l.useMemo((function(){return d.classesList("ag-body-clipper",W)}),[W]),at=l.useMemo((function(){return d.classesList("ag-floating-top",j)}),[j]),lt=l.useMemo((function(){return d.classesList("ag-sticky-top",j)}),[j]),ut=l.useMemo((function(){return d.classesList("ag-floating-bottom",j)}),[j]),ct=l.useMemo((function(){return{height:g,minHeight:g,display:I,overflowY:B}}),[g,I,B]),pt=l.useMemo((function(){return{height:w,top:E,width:R}}),[w,E,R]),ht=l.useMemo((function(){return{height:v,minHeight:v,display:M,overflowY:B}}),[v,M,B]),dt=function(t){return l.default.createElement(h.default,{name:t,key:t+"-container"})},ft=function(t){var e=t.section,n=t.children,o=t.className,r=t.style;return l.default.createElement("div",{ref:e,className:o,role:"presentation",style:r},n.map(dt))};return l.default.createElement("div",{ref:nt,className:ot,role:"treegrid"},l.default.createElement(c.default,null),ft({section:K,className:at,style:ct,children:[a.RowContainerName.TOP_LEFT,a.RowContainerName.TOP_CENTER,a.RowContainerName.TOP_RIGHT,a.RowContainerName.TOP_FULL_WIDTH]}),l.default.createElement("div",{className:it,ref:J,role:"presentation"},l.default.createElement("div",{className:st,role:"presentation"},ft({section:Q,className:rt,children:[a.RowContainerName.LEFT,a.RowContainerName.CENTER,a.RowContainerName.RIGHT,a.RowContainerName.FULL_WIDTH]}))),ft({section:Z,className:lt,style:pt,children:[a.RowContainerName.STICKY_TOP_LEFT,a.RowContainerName.STICKY_TOP_CENTER,a.RowContainerName.STICKY_TOP_RIGHT,a.RowContainerName.STICKY_TOP_FULL_WIDTH]}),ft({section:$,className:ut,style:ht,children:[a.RowContainerName.BOTTOM_LEFT,a.RowContainerName.BOTTOM_CENTER,a.RowContainerName.BOTTOM_RIGHT,a.RowContainerName.BOTTOM_FULL_WIDTH]}))}))},3970:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(7520),l=i(n(2791)),u=n(2724),c=s(n(6556)),p=s(n(1008)),h=s(n(2051)),d=n(6817);e.default=l.memo((function(t){var e=t.context,n=l.useState(""),o=n[0],r=n[1],i=l.useState(""),s=i[0],f=i[1],g=l.useState(""),m=g[0],y=g[1],v=l.useState(null),_=v[0],C=v[1],w=l.useState(null),b=w[0],x=w[1],E=l.useState(!1),S=E[0],T=E[1],R=l.useState(),O=R[0],P=R[1],I=l.useRef(null),A=l.useRef(null),D=l.useRef(),M=l.useState(null),L=M[0],N=M[1],F=l.useRef((function(){})),k=l.useCallback((function(){}),[]),G=l.useMemo((function(){return e.isDestroyed()?null:e.getBean("beans")}),[e]);p.default(" AG Grid ",A);var B=l.useCallback((function(t){if(A.current=t,!A.current)return e.destroyBean(I.current),void(I.current=null);if(!e.isDestroyed()){I.current=e.createBean(new a.GridCtrl);var n=I.current;F.current=n.focusInnerElement.bind(n);var o={destroyGridUi:function(){},setRtlClass:r,addOrRemoveKeyboardFocusClass:function(t){return f(t?a.FocusService.AG_KEYBOARD_FOCUS:"")},forceFocusOutOfContainer:function(){var t;null===(t=D.current)||void 0===t||t.forceFocusOutOfContainer()},updateLayoutClasses:y,getFocusableContainers:function(){var t,e,n=[],o=null===(t=A.current)||void 0===t?void 0:t.querySelector(".ag-root"),r=null===(e=A.current)||void 0===e?void 0:e.querySelector(".ag-side-bar:not(.ag-hidden)");return o&&n.push(o),r&&n.push(r),n},setCursor:C,setUserSelect:x};n.setComp(o,A.current,A.current),T(!0)}}),[]);l.useEffect((function(){if(O&&G&&I.current&&L&&A.current){var t=I.current,n=[],o=G.agStackComponentsRegistry,r=o.getComponentClass("AG-GRID-HEADER-DROP-ZONES"),i=o.getComponentClass("AG-SIDE-BAR"),s=o.getComponentClass("AG-STATUS-BAR"),a=o.getComponentClass("AG-WATERMARK"),l=o.getComponentClass("AG-PAGINATION"),u=[],c=A.current;if(t.showDropZones()&&r){var p=e.createBean(new r),h=p.getGui();c.insertAdjacentElement("afterbegin",h),u.push(h),n.push(p)}if(t.showSideBar()&&i){var d=e.createBean(new i),f=(h=d.getGui(),L.querySelector(".ag-tab-guard-bottom"));f&&(f.insertAdjacentElement("beforebegin",h),u.push(h)),n.push(d)}if(t.showStatusBar()&&s){var g=e.createBean(new s);h=g.getGui();c.insertAdjacentElement("beforeend",h),u.push(h),n.push(g)}if(l){var m=e.createBean(new l);h=m.getGui();c.insertAdjacentElement("beforeend",h),u.push(h),n.push(m)}if(t.showWatermark()&&a){var y=e.createBean(new a);h=y.getGui();c.insertAdjacentElement("beforeend",h),u.push(h),n.push(y)}return function(){e.destroyBeans(n),u.forEach((function(t){t.parentElement&&t.parentElement.removeChild(t)}))}}}),[O,L,G]);var V=l.useMemo((function(){return d.classesList("ag-root-wrapper",o,s,m)}),[o,s,m]),z=l.useMemo((function(){return d.classesList("ag-root-wrapper-body","ag-focus-managed",m)}),[m]),j=l.useMemo((function(){return{userSelect:null!=b?b:"",WebkitUserSelect:null!=b?b:"",cursor:null!=_?_:""}}),[b,_]),H=l.useCallback((function(t){D.current=t,P(null!==t)}),[]);return l.default.createElement("div",{ref:B,className:V,style:j,role:"presentation"},l.default.createElement("div",{className:z,ref:N,role:"presentation"},S&&L&&G&&l.default.createElement(u.BeansContext.Provider,{value:G},l.default.createElement(h.default,{ref:H,eFocusableElement:L,onTabKeyDown:k,gridCtrl:I.current},l.default.createElement(c.default,null)))))}))},332:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(2791)),l=n(2724),u=n(7520),c=n(6817),p=s(n(1212));e.default=a.memo((function(){var t=a.useState((function(){return new c.CssClasses})),e=t[0],n=t[1],o=a.useState(),r=o[0],i=o[1],s=a.useContext(l.BeansContext).context,h=a.useRef(null),d=a.useRef(null),f=a.useCallback((function(t){if(h.current=t,!t)return s.destroyBean(d.current),void(d.current=null);var e={addOrRemoveCssClass:function(t,e){return n((function(n){return n.setClass(t,e)}))},setHeightAndMinHeight:function(t){return i(t)}};d.current=s.createBean(new u.GridHeaderCtrl),d.current.setComp(e,h.current,h.current)}),[]),g=a.useMemo((function(){return"ag-header "+e.toString()}),[e]),m=a.useMemo((function(){return{height:r,minHeight:r}}),[r]);return a.default.createElement("div",{ref:f,className:g,style:m,role:"presentation"},a.default.createElement(p.default,{pinned:"left"}),a.default.createElement(p.default,{pinned:null}),a.default.createElement(p.default,{pinned:"right"}))}))},273:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(2791)),l=n(2724),u=n(7520),c=n(6817),p=n(8285);e.default=a.memo((function(t){var e=t.ctrl,n=a.useContext(l.BeansContext).context,r=e.getColId(),i=a.useState(),s=i[0],h=i[1],d=a.useRef(null),f=a.useRef(null),g=a.useRef(null),m=a.useRef(),y=a.useRef();y.current||(y.current=new u.CssClassManager((function(){return d.current})));var v=a.useCallback((function(t){var n;if(d.current=t,d.current){var o={setWidth:function(t){d.current&&(d.current.style.width=t)},addOrRemoveCssClass:function(t,e){return y.current.addOrRemoveCssClass(t,e)},setAriaDescription:function(t){d.current&&u._.setAriaDescription(d.current,t)},setAriaSort:function(t){d.current&&(t?u._.setAriaSort(d.current,t):u._.removeAriaSort(d.current))},setUserCompDetails:function(t){return h(t)},getUserCompInstance:function(){return m.current||void 0}};e.setComp(o,d.current,f.current,g.current);var r=e.getSelectAllGui();null===(n=f.current)||void 0===n||n.insertAdjacentElement("afterend",r)}}),[]);a.useLayoutEffect((function(){return p.showJsComp(s,n,g.current,m)}),[s]),a.useEffect((function(){e.setDragSource(d.current)}),[s]);var _=a.useMemo((function(){return!!((null===s||void 0===s?void 0:s.componentFromFramework)&&c.isComponentStateless(s.componentClass))}),[s]),C=s&&s.componentFromFramework,w=s&&s.componentClass;return a.default.createElement("div",{ref:v,className:"ag-header-cell","col-id":r,role:"columnheader",tabIndex:-1},a.default.createElement("div",{ref:f,className:"ag-header-cell-resize",role:"presentation"}),a.default.createElement("div",{ref:g,className:"ag-header-cell-comp-wrapper",role:"presentation"},C&&_&&a.default.createElement(w,o({},s.params)),C&&!_&&a.default.createElement(w,o({},s.params,{ref:m}))))}))},1478:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(2791)),l=n(2724),u=n(7520),c=n(6817),p=n(8285);e.default=a.memo((function(t){var e=a.useContext(l.BeansContext).context,n=a.useState((function(){return new c.CssClasses("ag-header-cell","ag-floating-filter")})),r=n[0],i=n[1],s=a.useState((function(){return new c.CssClasses})),h=s[0],d=s[1],f=a.useState((function(){return new c.CssClasses("ag-floating-filter-button","ag-hidden")})),g=f[0],m=f[1],y=a.useState("false"),v=y[0],_=y[1],C=a.useState(),w=C[0],b=C[1],x=a.useRef(null),E=a.useRef(null),S=a.useRef(null),T=a.useRef(null),R=a.useRef(),O=a.useRef(),P=function(t){null!=t&&R.current&&R.current(t)},I=t.ctrl,A=a.useCallback((function(t){if(x.current=t,x.current){O.current=new u.AgPromise((function(t){R.current=t}));var e={addOrRemoveCssClass:function(t,e){return i((function(n){return n.setClass(t,e)}))},addOrRemoveBodyCssClass:function(t,e){return d((function(n){return n.setClass(t,e)}))},setButtonWrapperDisplayed:function(t){m((function(e){return e.setClass("ag-hidden",!t)})),_(t?"false":"true")},setWidth:function(t){x.current&&(x.current.style.width=t)},setCompDetails:function(t){return b(t)},getFloatingFilterComp:function(){return O.current?O.current:null},setMenuIcon:function(t){var e;return null===(e=T.current)||void 0===e?void 0:e.appendChild(t)}};I.setComp(e,x.current,T.current,E.current)}}),[]);a.useLayoutEffect((function(){return p.showJsComp(w,e,E.current,P)}),[w]);var D=a.useMemo((function(){return r.toString()}),[r]),M=a.useMemo((function(){return h.toString()}),[h]),L=a.useMemo((function(){return g.toString()}),[g]),N=a.useMemo((function(){return!!(w&&w.componentFromFramework&&c.isComponentStateless(w.componentClass))}),[w]),F=w&&w.componentFromFramework,k=w&&w.componentClass;return a.default.createElement("div",{ref:A,className:D,role:"gridcell",tabIndex:-1},a.default.createElement("div",{ref:E,className:M,role:"presentation"},F&&N&&a.default.createElement(k,o({},w.params)),F&&!N&&a.default.createElement(k,o({},w.params,{ref:P}))),a.default.createElement("div",{ref:S,"aria-hidden":v,className:L,role:"presentation"},a.default.createElement("button",{ref:T,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))}))},5267:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var a=s(n(2791)),l=n(2724),u=n(8285),c=n(6817);e.default=a.memo((function(t){var e=a.useContext(l.BeansContext).context,n=t.ctrl,r=a.useState((function(){return new c.CssClasses})),i=r[0],s=r[1],p=a.useState((function(){return new c.CssClasses})),h=p[0],d=p[1],f=a.useState("false"),g=f[0],m=f[1],y=a.useState(),v=y[0],_=y[1],C=a.useState(),w=C[0],b=C[1],x=a.useMemo((function(){return n.getColId()}),[]),E=a.useRef(null),S=a.useRef(null),T=a.useCallback((function(t){if(E.current=t,E.current){var e={setWidth:function(t){E.current&&(E.current.style.width=t)},addOrRemoveCssClass:function(t,e){return s((function(n){return n.setClass(t,e)}))},setUserCompDetails:function(t){return b(t)},setResizableDisplayed:function(t){d((function(e){return e.setClass("ag-hidden",!t)})),m(t?"false":"true")},setAriaExpanded:function(t){return _(t)}};n.setComp(e,E.current,S.current)}}),[]);a.useLayoutEffect((function(){return u.showJsComp(w,e,E.current)}),[w]),a.useEffect((function(){E.current&&n.setDragSource(E.current)}),[w]);var R=a.useMemo((function(){return"ag-header-group-cell "+i.toString()}),[i]),O=a.useMemo((function(){return"ag-header-cell-resize "+h.toString()}),[h]),P=w&&w.componentFromFramework,I=w&&w.componentClass;return a.default.createElement("div",{ref:T,className:R,"col-id":x,role:"columnheader",tabIndex:-1,"aria-expanded":v},P&&a.default.createElement(I,o({},w.params)),a.default.createElement("div",{ref:S,"aria-hidden":g,className:O}))}))},9979:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(7520),l=i(n(2791)),u=s(n(273)),c=s(n(5267)),p=s(n(1478)),h=n(6817);e.default=l.memo((function(t){var e=t.ctrl,n=l.useMemo((function(){return e.getTopAndHeight()}),[]),o=n.topOffset,r=n.rowHeight,i=e.getAriaRowIndex(),s=e.getHeaderRowClass(),d=l.useMemo((function(){return e.getTransform()}),[]),f=l.useState((function(){return r+"px"})),g=f[0],m=f[1],y=l.useState((function(){return o+"px"})),v=y[0],_=y[1],C=l.useState((function(){return e.getHeaderCtrls()})),w=C[0],b=C[1],x=l.useRef(null),E=l.useCallback((function(t){if(x.current=t,t){var n={setHeight:function(t){return m(t)},setTop:function(t){return _(t)},setHeaderCtrls:function(t,e){return b((function(n){return h.getNextValueIfDifferent(n,t,e)}))},setWidth:function(t){x.current&&(x.current.style.width=t)}};e.setComp(n,!1)}}),[]),S=l.useMemo((function(){return{transform:d,height:g,top:v}}),[d,g,v]),T=l.useCallback((function(t){switch(e.getType()){case a.HeaderRowType.COLUMN_GROUP:return l.default.createElement(c.default,{ctrl:t,key:t.getInstanceId()});case a.HeaderRowType.FLOATING_FILTER:return l.default.createElement(p.default,{ctrl:t,key:t.getInstanceId()});default:return l.default.createElement(u.default,{ctrl:t,key:t.getInstanceId()})}}),[]);return l.default.createElement("div",{ref:E,className:s,role:"row",style:S,"aria-rowindex":i},w.map(T))}))},1212:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(2791)),l=n(2724),u=n(7520),c=n(6817),p=s(n(9979));e.default=a.memo((function(t){var e=a.useState((function(){return new c.CssClasses})),n=e[0],o=e[1],r=a.useState(!1),i=r[0],s=r[1],h=a.useState([]),d=h[0],f=h[1],g=a.useContext(l.BeansContext).context,m=a.useRef(null),y=a.useRef(null),v=a.useRef(null),_="left"===t.pinned,C="right"===t.pinned,w=!_&&!C,b=a.useCallback((function(e){if(m.current=e,!m.current)return g.destroyBean(v.current),void(v.current=null);var n={setDisplayed:function(t){o((function(e){return e.setClass("ag-hidden",!t)})),s(!t)},setCtrls:function(t){return f(t)},setCenterWidth:function(t){y.current&&(y.current.style.width=t)},setViewportScrollLeft:function(t){m.current&&(m.current.scrollLeft=t)},setPinnedContainerWidth:function(t){m.current&&(m.current.style.width=t,m.current.style.minWidth=t,m.current.style.maxWidth=t)}};v.current=g.createBean(new u.HeaderRowContainerCtrl(t.pinned)),v.current.setComp(n,m.current)}),[]),x=a.useMemo((function(){return n.toString()}),[n]),E=function(){return d.map((function(t){return a.default.createElement(p.default,{ctrl:t,key:t.getInstanceId()})}))};return a.default.createElement(a.default.Fragment,null,_&&a.default.createElement("div",{ref:b,className:"ag-pinned-left-header "+x,"aria-hidden":i,role:"presentation"},E()),C&&a.default.createElement("div",{ref:b,className:"ag-pinned-right-header "+x,"aria-hidden":i,role:"presentation"},E()),w&&a.default.createElement("div",{ref:b,className:"ag-header-viewport "+x,role:"presentation"},a.default.createElement("div",{ref:y,className:"ag-header-container",role:"rowgroup"},E())))}))},8285:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createSyncJsComp=e.showJsComp=void 0;e.showJsComp=function(t,e,o,r){if(!(!t||t.componentFromFramework||e.isDestroyed())){var i=t.newAgStackInstance();if(i){var s,a,l=!1;return i.then((function(t){l?e.destroyBean(t):(a=(s=t).getGui(),o.appendChild(a),n(r,s))})),function(){l=!0,s&&(a&&a.parentElement&&a.parentElement.removeChild(a),e.destroyBean(s),r&&n(r,void 0))}}}};var n=function(t,e){t&&(t instanceof Function?t(e):t.current=e)};e.createSyncJsComp=function(t){var e=t.newAgStackInstance();if(e)return e.resolveNow(null,(function(t){return t}))}},1008:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2791);e.default=function(t,e){o.useEffect((function(){var n=e.current;if(n){var o=n.parentElement;if(o){var r=document.createComment(t);return o.insertBefore(r,n),function(){o.removeChild(r)}}}}),[t])}},2939:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var l=s(n(2791)),u=n(7520),c=n(8285),p=n(6817),h=n(2724),d=a(n(4148));e.default=l.memo((function(t){var e=l.useContext(h.BeansContext).context,n=t.rowCtrl,r=t.containerType,i=n.getTabIndex(),s=l.useRef(n.getDomOrder()),a=n.isFullWidth(),f=l.useState((function(){return n.getRowIndex()})),g=f[0],m=f[1],y=l.useState((function(){return n.getRowId()})),v=y[0],_=y[1],C=l.useState((function(){return n.getBusinessKey()})),w=C[0],b=C[1],x=l.useState((function(){return n.getRowStyles()})),E=x[0],S=x[1],T=l.useState((function(){return null})),R=T[0],O=T[1],P=l.useState(),I=P[0],A=P[1],D=l.useState((function(){return n.getInitialRowTop(r)})),M=D[0],L=D[1],N=l.useState((function(){return n.getInitialTransform(r)})),F=N[0],k=N[1],G=l.useRef(null),B=l.useRef(),V=l.useRef(!1),z=l.useState(0),j=z[0],H=z[1];l.useEffect((function(){var t;if(!V.current&&I&&!(j>10)){var e=null===(t=G.current)||void 0===t?void 0:t.firstChild;e?(n.setupDetailRowAutoHeight(e),V.current=!0):H((function(t){return t+1}))}}),[I,j]);var U=l.useRef();U.current||(U.current=new u.CssClassManager((function(){return G.current})));var W=l.useCallback((function(t){if(G.current=t,n.isAlive())if(G.current){var e={setTop:L,setTransform:k,addOrRemoveCssClass:function(t,e){return U.current.addOrRemoveCssClass(t,e)},setDomOrder:function(t){return s.current=t},setRowIndex:m,setRowId:_,setRowBusinessKey:b,setUserStyles:S,setCellCtrls:function(t,e){p.agFlushSync(e,(function(){O((function(e){return p.getNextValueIfDifferent(e,t,s.current)}))}))},showFullWidth:function(t){return A(t)},getFullWidthCellRenderer:function(){return B.current}};n.setComp(e,G.current,r)}else n.unsetComp(r)}),[]);l.useLayoutEffect((function(){return c.showJsComp(I,e,G.current,B)}),[I]);var q=l.useMemo((function(){var t={top:M,transform:F};return Object.assign(t,E),t}),[M,F,E]),X=a&&I&&I.componentFromFramework,Y=!a&&null!=R,K=l.useMemo((function(){return!!((null===I||void 0===I?void 0:I.componentFromFramework)&&p.isComponentStateless(I.componentClass))}),[I]);return l.default.createElement("div",{ref:W,role:"row",style:q,"row-index":g,"row-id":v,"row-business-key":w,tabIndex:i},Y&&(null===R||void 0===R?void 0:R.map((function(t){return l.default.createElement(d.default,{cellCtrl:t,editingRow:n.isEditing(),printLayout:n.isPrintLayout(),key:t.getInstanceId()})}))),X&&function(){var t=I.componentClass;return l.default.createElement(l.default.Fragment,null,K&&l.default.createElement(t,o({},I.params)),!K&&l.default.createElement(t,o({},I.params,{ref:B})))}())}))},961:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(7520),l=i(n(2791)),u=n(6817),c=s(n(1008)),p=s(n(2939)),h=n(2724);e.default=l.memo((function(t){var e=l.useContext(h.BeansContext).context,n=t.name,o=l.useMemo((function(){return a.getRowContainerTypeForName(n)}),[n]),r=l.useRef(null),i=l.useRef(null),s=l.useRef(null),d=l.useRef([]),f=l.useState((function(){return[]})),g=f[0],m=f[1],y=l.useRef(!1),v=l.useRef(),_=l.useMemo((function(){return a.RowContainerCtrl.getRowContainerCssClasses(n)}),[n]),C=l.useMemo((function(){return u.classesList(_.wrapper)}),[_]),w=l.useMemo((function(){return u.classesList(_.viewport)}),[_]),b=l.useMemo((function(){return u.classesList(_.container)}),[_]),x=n===a.RowContainerName.CENTER,E=n===a.RowContainerName.TOP_CENTER||n===a.RowContainerName.BOTTOM_CENTER||n===a.RowContainerName.STICKY_TOP_CENTER,S=!x&&!E,T=x?r:E?i:s;c.default(" AG Row Container "+n+" ",T);var R=l.useCallback((function(){return x?null!=r.current&&null!=i.current&&null!=s.current:E?null!=i.current&&null!=s.current:S?null!=s.current:void 0}),[]),O=l.useCallback((function(){return x?null==r.current&&null==i.current&&null==s.current:E?null==i.current&&null==s.current:S?null==s.current:void 0}),[]),P=l.useCallback((function(){if(O()&&(e.destroyBean(v.current),v.current=null),R()){var t=function(t){u.agFlushSync(t,(function(){m((function(t){return u.getNextValueIfDifferent(t,d.current,y.current)}))}))},o={setViewportHeight:function(t){i.current&&(i.current.style.height=t)},setRowCtrls:function(e,n){var o=n&&d.current.length>0&&e.length>0;d.current=e,t(o)},setDomOrder:function(e){y.current!=e&&(y.current=e,t(!1))},setContainerWidth:function(t){s.current&&(s.current.style.width=t)}};v.current=e.createBean(new a.RowContainerCtrl(n)),v.current.setComp(o,s.current,i.current,r.current)}}),[R,O]),I=l.useCallback((function(t){s.current=t,P()}),[P]),A=l.useCallback((function(t){i.current=t,P()}),[P]),D=l.useCallback((function(t){r.current=t,P()}),[P]),M=function(){return l.default.createElement("div",{className:b,ref:I,role:g.length?"rowgroup":"presentation"},g.map((function(t){return l.default.createElement(p.default,{rowCtrl:t,containerType:o,key:t.getInstanceId()})})))};return l.default.createElement(l.default.Fragment,null,x&&l.default.createElement("div",{className:C,ref:D,role:"presentation"},l.default.createElement("div",{className:w,ref:A,role:"presentation"},M())),E&&l.default.createElement("div",{className:w,ref:A,role:"presentation"},M()),S&&M())}))},2051:function(t,e,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});var s=i(n(2791)),a=n(7520),l=n(2724),u=s.forwardRef((function(t,e){var n=t.children,o=t.eFocusableElement,r=t.onTabKeyDown,i=t.gridCtrl,u=s.useContext(l.BeansContext).context,c=s.useRef(null),p=s.useRef(null),h=s.useRef(),d=function(t){var e=null==t?void 0:parseInt(t,10).toString();[c,p].forEach((function(t){var n,o;void 0===e?null===(n=t.current)||void 0===n||n.removeAttribute("tabindex"):null===(o=t.current)||void 0===o||o.setAttribute("tabindex",e)}))};s.useImperativeHandle(e,(function(){return{forceFocusOutOfContainer:function(){var t;null===(t=h.current)||void 0===t||t.forceFocusOutOfContainer()}}}));var f=s.useCallback((function(){if(!c.current&&!p.current)return u.destroyBean(h.current),void(h.current=null);if(c.current&&p.current){var t={setTabIndex:d};h.current=u.createBean(new a.TabGuardCtrl({comp:t,eTopGuard:c.current,eBottomGuard:p.current,eFocusableElement:o,onTabKeyDown:r,focusInnerElement:function(t){return i.focusInnerElement(t)}}))}}),[]),g=s.useCallback((function(t){c.current=t,f()}),[f]),m=s.useCallback((function(t){p.current=t,f()}),[f]),y=function(t){var e="top"===t?a.TabGuardClassNames.TAB_GUARD_TOP:a.TabGuardClassNames.TAB_GUARD_BOTTOM;return s.default.createElement("div",{className:a.TabGuardClassNames.TAB_GUARD+" "+e,role:"presentation",ref:"top"===t?g:m})};return s.default.createElement(s.default.Fragment,null,y("top"),n,y("bottom"))}));e.default=s.memo(u)},1622:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useEffectOnce=void 0;var o=n(2791);e.useEffectOnce=function(t){var e=o.useRef(t),n=o.useRef(),r=o.useRef(!1),i=o.useRef(!1),s=o.useState(0)[1];r.current&&(i.current=!0),o.useEffect((function(){return r.current||(n.current=e.current(),r.current=!0),s((function(t){return t+1})),function(){i.current&&n.current&&n.current()}}),[])}},6817:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)},r=this&&this.__spreadArray||function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.getNextValueIfDifferent=e.agFlushSync=e.isComponentStateless=e.CssClasses=e.classesList=void 0;var s=i(n(4164));e.classesList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.filter((function(t){return null!=t&&""!==t})).join(" ")};var a=function(){function t(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.classesMap={},e.forEach((function(e){t.classesMap[e]=!0}))}return t.prototype.setClass=function(e,n){if(!!this.classesMap[e]==n)return this;var r=new t;return r.classesMap=o({},this.classesMap),r.classesMap[e]=n,r},t.prototype.toString=function(){var t=this;return Object.keys(this.classesMap).filter((function(e){return t.classesMap[e]})).join(" ")},t}();e.CssClasses=a;e.isComponentStateless=function(t){return"function"===typeof t&&!(t.prototype&&t.prototype.isReactComponent)||"object"===typeof t&&t.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115)};var l=null!=s.default.createRoot&&null!=s.default.flushSync;e.agFlushSync=function(t,e){l&&t?s.default.flushSync(e):e()},e.getNextValueIfDifferent=function(t,e,n){if(null==e||null==t)return e;if(t===e||0===e.length&&0===t.length)return t;if(n||0===t.length&&e.length>0||t.length>0&&0===e.length)return e;for(var o=[],i=[],s=new Map,a=new Map,l=0;l<e.length;l++){var u=e[l];a.set(u.getInstanceId(),u)}for(l=0;l<t.length;l++){u=t[l];s.set(u.getInstanceId(),u),a.has(u.getInstanceId())&&o.push(u)}for(l=0;l<e.length;l++){var c=(u=e[l]).getInstanceId();s.has(c)||i.push(u)}return o.length===t.length&&0===i.length?t:0===o.length&&i.length===e.length?e:r(r([],o),i)}},7736:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeDetectionStrategyType=void 0,function(t){t.IdentityCheck="IdentityCheck",t.DeepValueCheck="DeepValueCheck",t.NoCheck="NoCheck"}(e.ChangeDetectionStrategyType||(e.ChangeDetectionStrategyType={}))},3507:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=0;e.default=function(){return"agPortalKey_"+ ++n}},8665:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r.apply(this,arguments)},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.NewReactComponent=void 0;var s=n(2791),a=n(4164),l=n(7520),u=n(294),c=n(8340),p=i(n(3507)),h=function(t){function e(e,n,o){var r=t.call(this,e,n,o)||this;return r.oldPortal=null,r.key=p.default(),r.portalKey=p.default(),r}return o(e,t),e.prototype.init=function(t){var e=this;return this.eParentElement=this.createParentElement(t),this.params=t,this.createOrUpdatePortal(t),new l.AgPromise((function(t){return e.createReactComponent(t)}))},e.prototype.createOrUpdatePortal=function(t){var e=this;this.isStatelessComponent()||(t.ref=function(t){e.componentInstance=t,e.addParentContainerStyleAndClasses()}),this.reactElement=s.createElement(this.reactComponent,r(r({},t),{key:this.key})),this.portal=a.createPortal(this.reactElement,this.eParentElement,this.portalKey)},e.prototype.createReactComponent=function(t){this.portalManager.mountReactPortal(this.portal,this,(function(e){t(e)}))},e.prototype.isNullValue=function(){return this.valueRenderedIsNull(this.params)},e.prototype.rendered=function(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())},e.prototype.valueRenderedIsNull=function(t){if(!this.componentType.cellRenderer)return!1;var e=console.error;try{return console.error=function(){},""===c.renderToStaticMarkup(s.createElement(this.reactComponent,t))}catch(n){}finally{console.error=e}return!1},e.prototype.refreshComponent=function(t){this.oldPortal=this.portal,this.createOrUpdatePortal(t),this.portalManager.updateReactPortal(this.oldPortal,this.portal)},e.prototype.fallbackMethod=function(t,e){var n=this[t+"Component"];if(n)return n.bind(this)(e)},e.prototype.fallbackMethodAvailable=function(t){return!!this[t+"Component"]},e}(u.ReactComponent);e.NewReactComponent=h},3365:function(t,e){"use strict";var n=this&&this.__spreadArray||function(t,e){for(var n=0,o=e.length,r=t.length;n<o;n++,r++)t[r]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.PortalManager=e.LegacyPortalManager=void 0;var o=function(){function t(e,n,o){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=n||"div",this.parent=e,this.maxComponentCreationTimeMs=o||t.MAX_COMPONENT_CREATION_TIME_IN_MS}return t.prototype.getPortals=function(){return this.portals},t.prototype.destroy=function(){this.destroyed=!0},t.prototype.destroyPortal=function(t){this.portals=this.portals.filter((function(e){return e!==t})),this.batchUpdate()},t.prototype.getComponentWrappingElement=function(){return this.wrappingElement},t.prototype.mountReactPortal=function(t,e,o){this.portals=n(n([],this.portals),[t]),this.waitForInstance(e,o),this.batchUpdate()},t.prototype.updateReactPortal=function(t,e){this.portals[this.portals.indexOf(t)]=e,this.batchUpdate()},t.prototype.batchUpdate=function(){var t=this;this.hasPendingPortalUpdate||(setTimeout((function(){t.destroyed||t.parent.forceUpdate((function(){t.hasPendingPortalUpdate=!1}))})),this.hasPendingPortalUpdate=!0)},t.prototype.waitForInstance=function(t,e,n){var o=this;if(void 0===n&&(n=Date.now()),this.destroyed)e(null);else if(t.rendered())e(t);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return t.isNullValue()?void e(t):void console.error("AG Grid: React Component '"+t.getReactComponentName()+"' not created within "+this.maxComponentCreationTimeMs+"ms");window.setTimeout((function(){o.waitForInstance(t,e,n)}))}},t.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,t}();e.LegacyPortalManager=o;var r=function(){function t(e,n,o){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=n||"div",this.refresher=e,this.maxComponentCreationTimeMs=o||t.MAX_COMPONENT_CREATION_TIME_IN_MS}return t.prototype.getPortals=function(){return this.portals},t.prototype.destroy=function(){this.destroyed=!0},t.prototype.destroyPortal=function(t){this.portals=this.portals.filter((function(e){return e!==t})),this.batchUpdate()},t.prototype.getComponentWrappingElement=function(){return this.wrappingElement},t.prototype.mountReactPortal=function(t,e,o){this.portals=n(n([],this.portals),[t]),this.waitForInstance(e,o),this.batchUpdate()},t.prototype.updateReactPortal=function(t,e){this.portals[this.portals.indexOf(t)]=e,this.batchUpdate()},t.prototype.batchUpdate=function(){var t=this;this.hasPendingPortalUpdate||(setTimeout((function(){t.destroyed||(t.refresher(),t.hasPendingPortalUpdate=!1)})),this.hasPendingPortalUpdate=!0)},t.prototype.waitForInstance=function(t,e,n){var o=this;if(void 0===n&&(n=Date.now()),this.destroyed)e(null);else if(t.rendered())e(t);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return t.isNullValue()?void e(t):void console.error("AG Grid: React Component '"+t.getReactComponentName()+"' not created within "+this.maxComponentCreationTimeMs+"ms");window.setTimeout((function(){o.waitForInstance(t,e,n)}))}},t.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,t}();e.PortalManager=r},294:function(t,e){"use strict";var n=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ReactComponent=void 0;var o=function(t){function e(e,n,o){var r=t.call(this)||this;return r.portal=null,r.reactComponent=e,r.portalManager=n,r.componentType=o,r.statelessComponent=r.isStateless(r.reactComponent),r}return n(e,t),e.prototype.getGui=function(){return this.eParentElement},e.prototype.destroy=function(){return this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy(),this.portalManager.destroyPortal(this.portal)},e.prototype.createParentElement=function(t){var e=this.portalManager.getComponentWrappingElement(),n=document.createElement(e||"div");return n.classList.add("ag-react-container"),t.reactContainer=n,n},e.prototype.addParentContainerStyleAndClasses=function(){var t=this;this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle()),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses()&&this.componentInstance.getReactContainerClasses().forEach((function(e){return t.eParentElement.classList.add(e)})))},e.prototype.statelessComponentRendered=function(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0},e.prototype.getFrameworkComponentInstance=function(){return this.componentInstance},e.prototype.isStatelessComponent=function(){return this.statelessComponent},e.prototype.getReactComponentName=function(){return this.reactComponent.name},e.prototype.getMemoType=function(){return this.hasSymbol()?Symbol.for("react.memo"):60115},e.prototype.hasSymbol=function(){return"function"===typeof Symbol&&Symbol.for},e.prototype.isStateless=function(t){return"function"===typeof t&&!(t.prototype&&t.prototype.isReactComponent)||"object"===typeof t&&t.$$typeof===this.getMemoType()},e.prototype.hasMethod=function(t){var e=this.getFrameworkComponentInstance();return!!e&&null!==e[t]||this.fallbackMethodAvailable(t)},e.prototype.callMethod=function(t,e){var n=this,o=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(t,e&&e[0]?e[0]:{});if(o){var r=o[t];return r?r.apply(o,e):this.fallbackMethodAvailable(t)?this.fallbackMethod(t,e&&e[0]?e[0]:{}):void 0}setTimeout((function(){return n.callMethod(t,e)}))},e.prototype.addMethod=function(t,e){this[t]=e},e}((function(){}));e.ReactComponent=o},9575:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ReactFrameworkOverrides=void 0;var i=n(7520),s=r(n(5728)),a=r(n(7627)),l=function(t){function e(e){var n=t.call(this)||this;return n.frameworkComponents={agGroupCellRenderer:s.default,agGroupRowRenderer:s.default,agDetailCellRenderer:a.default},n.reactUi=e,n.renderingEngine=e?"react":"vanilla",n}return o(e,t),e.prototype.frameworkComponent=function(t){if(this.reactUi)return this.frameworkComponents[t]},e.prototype.isFrameworkComponent=function(t){if(!t)return!1;var e=t.prototype;return!(e&&"getGui"in e)},e}(i.VanillaFrameworkOverrides);e.ReactFrameworkOverrides=l},4037:(t,e,n)=>{"use strict";var o=n(2506),r=n(9722),i=r(o("String.prototype.indexOf"));t.exports=function(t,e){var n=o(t,!!e);return"function"===typeof n&&i(t,".prototype.")>-1?r(n):n}},9722:(t,e,n)=>{"use strict";var o=n(3350),r=n(2506),i=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||o.call(s,i),l=r("%Object.getOwnPropertyDescriptor%",!0),u=r("%Object.defineProperty%",!0),c=r("%Math.max%");if(u)try{u({},"a",{value:1})}catch(h){u=null}t.exports=function(t){var e=a(o,s,arguments);l&&u&&(l(e,"length").configurable&&u(e,"length",{value:1+c(0,t.length-(arguments.length-1))}));return e};var p=function(){return a(o,i,arguments)};u?u(t.exports,"apply",{value:p}):t.exports.apply=p},4161:(t,e,n)=>{"use strict";var o=n(2110),r=n(4613),i=n(5021),s=n(4460).orient2d;function a(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;var r=function(t){for(var e=t[0],n=t[0],o=t[0],r=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>o[0]&&(o=a),a[1]<n[1]&&(n=a),a[1]>r[1]&&(r=a)}var l=[e,n,o,r],u=l.slice();for(s=0;s<t.length;s++)i(t[s],l)||u.push(t[s]);return function(t){t.sort(_);for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&d(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}for(var o=[],r=t.length-1;r>=0;r--){for(;o.length>=2&&d(o[o.length-2],o[o.length-1],t[r])<=0;)o.pop();o.push(t[r])}return o.pop(),e.pop(),e.concat(o)}(u)}(t),s=new o(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,u=[],c=0;c<r.length;c++){var p=r[c];s.remove(p),a=g(p,a),u.push(a)}var h=new o(16);for(c=0;c<u.length;c++)h.insert(f(u[c]));for(var y=e*e,v=n*n;u.length;){var C=u.shift(),w=C.p,b=C.next.p,x=m(w,b);if(!(x<v)){var E=x/y;(p=l(s,C.prev.p,w,b,C.next.next.p,E,h))&&Math.min(m(p,w),m(p,b))<=E&&(u.push(C),u.push(g(p,C)),s.remove(p),h.remove(C),h.insert(f(C)),h.insert(f(C.next)))}}C=a;var S=[];do{S.push(C.p),C=C.next}while(C!==a);return S.push(C.p),S}function l(t,e,n,o,i,s,a){for(var l=new r([],u),p=t.data;p;){for(var d=0;d<p.children.length;d++){var f=p.children[d],g=p.leaf?y(f,n,o):c(n,o,f);g>s||l.push({node:f,dist:g})}for(;l.length&&!l.peek().node.children;){var m=l.pop(),v=m.node,_=y(v,e,n),C=y(v,o,i);if(m.dist<_&&m.dist<C&&h(n,v,a)&&h(o,v,a))return v}(p=l.pop())&&(p=p.node)}return null}function u(t,e){return t.dist-e.dist}function c(t,e,n){if(p(t,n)||p(e,n))return 0;var o=v(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===o)return 0;var r=v(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var i=v(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===i)return 0;var s=v(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(o,r,i,s)}function p(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function h(t,e,n){for(var o,r,i,s,a=Math.min(t[0],e[0]),l=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),p=n.search({minX:a,minY:l,maxX:u,maxY:c}),h=0;h<p.length;h++)if(o=p[h].p,r=p[h].next.p,i=t,o!==(s=e)&&r!==i&&d(o,r,i)>0!==d(o,r,s)>0&&d(i,s,o)>0!==d(i,s,r)>0)return!1;return!0}function d(t,e,n){return s(t[0],t[1],e[0],e[1],n[0],n[1])}function f(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function g(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function m(t,e){var n=t[0]-e[0],o=t[1]-e[1];return n*n+o*o}function y(t,e,n){var o=e[0],r=e[1],i=n[0]-o,s=n[1]-r;if(0!==i||0!==s){var a=((t[0]-o)*i+(t[1]-r)*s)/(i*i+s*s);a>1?(o=n[0],r=n[1]):a>0&&(o+=i*a,r+=s*a)}return(i=t[0]-o)*i+(s=t[1]-r)*s}function v(t,e,n,o,r,i,s,a){var l,u,c,p,h=n-t,d=o-e,f=s-r,g=a-i,m=t-r,y=e-i,v=h*h+d*d,_=h*f+d*g,C=f*f+g*g,w=h*m+d*y,b=f*m+g*y,x=v*C-_*_,E=x,S=x;0===x?(u=0,E=1,p=b,S=C):(p=v*b-_*w,(u=_*b-C*w)<0?(u=0,p=b,S=C):u>E&&(u=E,p=b+_,S=C)),p<0?(p=0,-w<0?u=0:-w>v?u=E:(u=-w,E=v)):p>S&&(p=S,-w+_<0?u=0:-w+_>v?u=E:(u=-w+_,E=v));var T=(1-(c=0===p?0:p/S))*r+c*s-((1-(l=0===u?0:u/E))*t+l*n),R=(1-c)*i+c*a-((1-l)*e+l*o);return T*T+R*R}function _(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}r.default&&(r=r.default),t.exports=a,t.exports.default=a},2110:function(t){t.exports=function(){"use strict";function t(t,o,r,i,s){!function t(n,o,r,i,s){for(;i>r;){if(i-r>600){var a=i-r+1,l=o-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,o,Math.max(r,Math.floor(o-l*c/a+p)),Math.min(i,Math.floor(o+(a-l)*c/a+p)),s)}var h=n[o],d=r,f=i;for(e(n,r,o),s(n[i],h)>0&&e(n,r,i);d<f;){for(e(n,d,f),d++,f--;s(n[d],h)<0;)d++;for(;s(n[f],h)>0;)f--}0===s(n[r],h)?e(n,r,f):e(n,++f,i),f<=o&&(r=f+1),o<=f&&(i=f-1)}}(t,o,r||0,i||t.length-1,s||n)}function e(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function n(t,e){return t<e?-1:t>e?1:0}var o=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var o=0;o<e.length;o++)if(n(t,e[o]))return o;return-1}function i(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,o,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var i=e;i<n;i++){var s=t.children[i];a(r,t.leaf?o(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,o,r,i){for(var s=[n,o];s.length;)if(!((o=s.pop())-(n=s.pop())<=r)){var a=n+Math.ceil((o-n)/r/2)*r;t(e,a,n,o,i),s.push(n,a,a,o)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var o=this.toBBox,r=[];e;){for(var i=0;i<e.children.length;i++){var s=e.children[i],a=e.leaf?o(s):s;d(t,a)&&(e.leaf?n.push(s):h(t,a)?this._all(s,n):r.push(s))}e=r.pop()}return n},o.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var o=0;o<e.children.length;o++){var r=e.children[o],i=e.leaf?this.toBBox(r):r;if(d(t,i)){if(e.leaf||h(t,i))return!0;n.push(r)}}e=n.pop()}return!1},o.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var o=this.data;this.data=n,n=o}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},o.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},o.prototype.clear=function(){return this.data=f([]),this},o.prototype.remove=function(t,e){if(!t)return this;for(var n,o,i,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),o=l[l.length-1],n=u.pop(),i=!0),s.leaf){var c=r(t,s.children,e);if(-1!==c)return s.children.splice(c,1),l.push(s),this._condense(l),this}i||s.leaf||!h(s,a)?o?(n++,s=o.children[n],i=!1):s=null:(l.push(s),u.push(n),n=0,o=s,s=s.children[0])}return this},o.prototype.toBBox=function(t){return t},o.prototype.compareMinX=function(t,e){return t.minX-e.minX},o.prototype.compareMinY=function(t,e){return t.minY-e.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(t){return this.data=t,this},o.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},o.prototype._build=function(t,e,n,o){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return i(r=f(t.slice(e,n+1)),this.toBBox),r;o||(o=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,o-1))),(r=f([])).leaf=!1,r.height=o;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var p=Math.min(c+u-1,n);g(t,c,p,l,this.compareMinY);for(var h=c;h<=p;h+=l){var d=Math.min(h+l-1,p);r.children.push(this._build(t,h,d,o-1))}}return i(r,this.toBBox),r},o.prototype._chooseSubtree=function(t,e,n,o){for(;o.push(e),!e.leaf&&o.length-1!==n;){for(var r=1/0,i=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=c(l),p=(h=t,d=l,(Math.max(d.maxX,h.maxX)-Math.min(d.minX,h.minX))*(Math.max(d.maxY,h.maxY)-Math.min(d.minY,h.minY))-u);p<i?(i=p,r=u<r?u:r,s=l):p===i&&u<r&&(r=u,s=l)}e=s||e.children[0]}var h,d;return e},o.prototype._insert=function(t,e,n){var o=n?t:this.toBBox(t),r=[],i=this._chooseSubtree(o,this.data,e,r);for(i.children.push(t),a(i,o);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(o,r,e)},o.prototype._split=function(t,e){var n=t[e],o=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,o);var s=this._chooseSplitIndex(n,r,o),a=f(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,i(n,this.toBBox),i(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},o.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(t,e,n){for(var o,r,i,a,l,u,p,h=1/0,d=1/0,f=e;f<=n-e;f++){var g=s(t,0,f,this.toBBox),m=s(t,f,n,this.toBBox),y=(r=g,i=m,a=void 0,l=void 0,u=void 0,p=void 0,a=Math.max(r.minX,i.minX),l=Math.max(r.minY,i.minY),u=Math.min(r.maxX,i.maxX),p=Math.min(r.maxY,i.maxY),Math.max(0,u-a)*Math.max(0,p-l)),v=c(g)+c(m);y<h?(h=y,o=f,d=v<d?v:d):y===h&&v<d&&(d=v,o=f)}return o||n-e},o.prototype._chooseSplitAxis=function(t,e,n){var o=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,o)<this._allDistMargin(t,e,n,r)&&t.children.sort(o)},o.prototype._allDistMargin=function(t,e,n,o){t.children.sort(o);for(var r=this.toBBox,i=s(t,0,e,r),l=s(t,n-e,n,r),u=p(i)+p(l),c=e;c<n-e;c++){var h=t.children[c];a(i,t.leaf?r(h):h),u+=p(i)}for(var d=n-e-1;d>=e;d--){var f=t.children[d];a(l,t.leaf?r(f):f),u+=p(l)}return u},o.prototype._adjustParentBBoxes=function(t,e,n){for(var o=n;o>=0;o--)a(e[o],t)},o.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():i(t[e],this.toBBox)},o}()},4058:(t,e,n)=>{var o=n(4892),r=n(5450),i=n(3454),s=n(1146),a=n(3535),l=n(2833),u=Date.prototype.getTime;function c(t,e,n){var d=n||{};return!!(d.strict?i(t,e):t===e)||(!t||!e||"object"!==typeof t&&"object"!==typeof e?d.strict?i(t,e):t==e:function(t,e,n){var i,d;if(typeof t!==typeof e)return!1;if(p(t)||p(e))return!1;if(t.prototype!==e.prototype)return!1;if(r(t)!==r(e))return!1;var f=s(t),g=s(e);if(f!==g)return!1;if(f||g)return t.source===e.source&&a(t)===a(e);if(l(t)&&l(e))return u.call(t)===u.call(e);var m=h(t),y=h(e);if(m!==y)return!1;if(m||y){if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}if(typeof t!==typeof e)return!1;try{var v=o(t),_=o(e)}catch(C){return!1}if(v.length!==_.length)return!1;for(v.sort(),_.sort(),i=v.length-1;i>=0;i--)if(v[i]!=_[i])return!1;for(i=v.length-1;i>=0;i--)if(!c(t[d=v[i]],e[d],n))return!1;return!0}(t,e,d))}function p(t){return null===t||void 0===t}function h(t){return!(!t||"object"!==typeof t||"number"!==typeof t.length)&&("function"===typeof t.copy&&"function"===typeof t.slice&&!(t.length>0&&"number"!==typeof t[0]))}t.exports=c},2651:(t,e,n)=>{"use strict";var o=n(4510)(),r=n(2506),i=o&&r("%Object.defineProperty%",!0),s=r("%SyntaxError%"),a=r("%TypeError%"),l=n(3347);t.exports=function(t,e,n){if(!t||"object"!==typeof t&&"function"!==typeof t)throw new a("`obj` must be an object or a function`");if("string"!==typeof e&&"symbol"!==typeof e)throw new a("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!==typeof arguments[3]&&null!==arguments[3])throw new a("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!==typeof arguments[4]&&null!==arguments[4])throw new a("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!==typeof arguments[5]&&null!==arguments[5])throw new a("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!==typeof arguments[6])throw new a("`loose`, if provided, must be a boolean");var o=arguments.length>3?arguments[3]:null,r=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,c=arguments.length>6&&arguments[6],p=!!l&&l(t,e);if(i)i(t,e,{configurable:null===u&&p?p.configurable:!u,enumerable:null===o&&p?p.enumerable:!o,value:n,writable:null===r&&p?p.writable:!r});else{if(!c&&(o||r||u))throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=n}}},9396:(t,e,n)=>{"use strict";var o=n(4892),r="function"===typeof Symbol&&"symbol"===typeof Symbol("foo"),i=Object.prototype.toString,s=Array.prototype.concat,a=n(2651),l=n(4510)(),u=function(t,e,n,o){if(e in t)if(!0===o){if(t[e]===n)return}else if("function"!==typeof(r=o)||"[object Function]"!==i.call(r)||!o())return;var r;l?a(t,e,n,!0):a(t,e,n)},c=function(t,e){var n=arguments.length>2?arguments[2]:{},i=o(e);r&&(i=s.call(i,Object.getOwnPropertySymbols(e)));for(var a=0;a<i.length;a+=1)u(t,i[a],e[i[a]],n[i[a]])};c.supportsDescriptors=!!l,t.exports=c},7861:t=>{function e(t,e,n,o){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,o)}e.prototype.run=function(t,e,n,o){this._init(t,e,n,o);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var i=this._regionQuery(r);if(i.length<this.minPts)this.noise.push(r);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(r,s),this._expandCluster(s,i)}}return this.clusters},e.prototype._init=function(t,e,n,o){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),o&&(this.distance=o)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var o=e[n];if(1!==this._visited[o]){this._visited[o]=1;var r=this._regionQuery(o);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[o]&&this._addToCluster(o,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++){this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n)}return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,o=0;o<n;o++){var r=e[o];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,o=Math.min(t.length,e.length);o--;)n+=(t[o]-e[o])*(t[o]-e[o]);return Math.sqrt(n)},t.exports&&(t.exports=e)},2601:t=>{function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],"undefined"!==typeof t&&(this.dataset=t),"undefined"!==typeof e&&(this.k=e),"undefined"!==typeof n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,o=0;o<this.k;o++)this.centroids[o]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var i=0;i<this.k;i++){for(var s=new Array(c),a=0,l=0;l<c;l++)s[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(i===this.assignments[u]){for(l=0;l<c;l++)s[l]+=this.dataset[u][l];a++}}if(a>0){for(l=0;l<c;l++)s[l]/=a;this.centroids[i]=s}else this.centroids[i]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,o=0;o<n;o++)(t=this.argmin(this.dataset[o],this.centroids,this.distance))!=this.assignments[o]&&(this.assignments[o]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)"undefined"===typeof e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var o,r=Number.MAX_VALUE,i=0,s=e.length,a=0;a<s;a++)(o=n(t,e[a]))<r&&(r=o,i=a);return i},e.prototype.distance=function(t,e){for(var n=0,o=Math.min(t.length,e.length);o--;){var r=t[o]-e[o];n+=r*r}return Math.sqrt(n)},t.exports&&(t.exports=e)},3163:(t,e,n)=>{if(t.exports)var o=n(5047);function r(t,e,n,o){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,o)}r.prototype.run=function(t,e,n,r){this._init(t,e,n,r);for(var i=0,s=this.dataset.length;i<s;i++)if(1!==this._processed[i]){this._processed[i]=1,this.clusters.push([i]);var a=this.clusters.length-1;this._orderedList.push(i);var l=new o(null,null,"asc"),u=this._regionQuery(i);void 0!==this._distanceToCore(i)&&(this._updateQueue(i,u,l),this._expandCluster(a,l))}return this.clusters},r.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var o=this._orderedList[e],r=this._reachability[o];t.push([o,r])}return t},r.prototype._init=function(t,e,n,o){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),o&&(this.distance=o)},r.prototype._updateQueue=function(t,e,n){var o=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===o._processed[e]){var r=o.distance(o.dataset[t],o.dataset[e]),i=Math.max(o._coreDistance,r);void 0===o._reachability[e]?(o._reachability[e]=i,n.insert(e,i)):i<o._reachability[e]&&(o._reachability[e]=i,n.remove(e),n.insert(e,i))}}))},r.prototype._expandCluster=function(t,e){for(var n=e.getElements(),o=0,r=n.length;o<r;o++){var i=n[o];if(void 0===this._processed[i]){var s=this._regionQuery(i);this._processed[i]=1,this.clusters[t].push(i),this._orderedList.push(i),void 0!==this._distanceToCore(i)&&(this._updateQueue(i,s,e),this._expandCluster(t,e))}}},r.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++){if(this._regionQuery(t,n).length>=this.minPts)return n}},r.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],o=0,r=this.dataset.length;o<r;o++)this.distance(this.dataset[t],this.dataset[o])<e&&n.push(o);return n},r.prototype._euclideanDistance=function(t,e){for(var n=0,o=Math.min(t.length,e.length);o--;)n+=(t[o]-e[o])*(t[o]-e[o]);return Math.sqrt(n)},t.exports&&(t.exports=r)},5047:t=>{function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,o=n;o--;){var r=this._priorities[o];"desc"===this._sorting?e>r&&(n=o):e<r&&(n=o)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;){if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var o=0;o<t.length;o++)this.insert(t[o],e[o])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)},5107:(t,e,n)=>{t.exports&&(t.exports={DBSCAN:n(7861),KMEANS:n(2601),OPTICS:n(3163),PriorityQueue:n(5047)})},7089:t=>{"use strict";function e(t,e,o){o=o||2;var i,s,a,l,p,h,f,g=e&&e.length,m=g?e[0]*o:t.length,y=n(t,0,m,o,!0),v=[];if(!y||y.next===y.prev)return v;if(g&&(y=function(t,e,o,r){var i,s,a,l=[];for(i=0,s=e.length;i<s;i++)(a=n(t,e[i]*r,i<s-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),l.push(d(a));for(l.sort(u),i=0;i<l.length;i++)o=c(l[i],o);return o}(t,e,y,o)),t.length>80*o){i=a=t[0],s=l=t[1];for(var _=o;_<m;_+=o)(p=t[_])<i&&(i=p),(h=t[_+1])<s&&(s=h),p>a&&(a=p),h>l&&(l=h);f=0!==(f=Math.max(a-i,l-s))?32767/f:0}return r(y,v,o,i,s,f,0),v}function n(t,e,n,o,r){var i,s;if(r===T(t,e,n,o)>0)for(i=e;i<n;i+=o)s=x(i,t[i],t[i+1],s);else for(i=n-o;i>=e;i-=o)s=x(i,t[i],t[i+1],s);return s&&y(s,s.next)&&(E(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,o=t;do{if(n=!1,o.steiner||!y(o,o.next)&&0!==m(o.prev,o,o.next))o=o.next;else{if(E(o),(o=e=o.prev)===o.next)break;n=!0}}while(n||o!==e);return e}function r(t,e,n,u,c,p,d){if(t){!d&&p&&function(t,e,n,o){var r=t;do{0===r.z&&(r.z=h(r.x,r.y,e,n,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,o,r,i,s,a,l,u=1;do{for(n=t,t=null,i=null,s=0;n;){for(s++,o=n,a=0,e=0;e<u&&(a++,o=o.nextZ);e++);for(l=u;a>0||l>0&&o;)0!==a&&(0===l||!o||n.z<=o.z)?(r=n,n=n.nextZ,a--):(r=o,o=o.nextZ,l--),i?i.nextZ=r:t=r,r.prevZ=i,i=r;n=o}i.nextZ=null,u*=2}while(s>1)}(r)}(t,u,c,p);for(var f,g,m=t;t.prev!==t.next;)if(f=t.prev,g=t.next,p?s(t,u,c,p):i(t))e.push(f.i/n|0),e.push(t.i/n|0),e.push(g.i/n|0),E(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?r(t=a(o(t),e,n),e,n,u,c,p,2):2===d&&l(t,e,n,u,c,p):r(o(t),e,n,u,c,p,1);break}}}function i(t){var e=t.prev,n=t,o=t.next;if(m(e,n,o)>=0)return!1;for(var r=e.x,i=n.x,s=o.x,a=e.y,l=n.y,u=o.y,c=r<i?r<s?r:s:i<s?i:s,p=a<l?a<u?a:u:l<u?l:u,h=r>i?r>s?r:s:i>s?i:s,d=a>l?a>u?a:u:l>u?l:u,g=o.next;g!==e;){if(g.x>=c&&g.x<=h&&g.y>=p&&g.y<=d&&f(r,a,i,l,s,u,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function s(t,e,n,o){var r=t.prev,i=t,s=t.next;if(m(r,i,s)>=0)return!1;for(var a=r.x,l=i.x,u=s.x,c=r.y,p=i.y,d=s.y,g=a<l?a<u?a:u:l<u?l:u,y=c<p?c<d?c:d:p<d?p:d,v=a>l?a>u?a:u:l>u?l:u,_=c>p?c>d?c:d:p>d?p:d,C=h(g,y,e,n,o),w=h(v,_,e,n,o),b=t.prevZ,x=t.nextZ;b&&b.z>=C&&x&&x.z<=w;){if(b.x>=g&&b.x<=v&&b.y>=y&&b.y<=_&&b!==r&&b!==s&&f(a,c,l,p,u,d,b.x,b.y)&&m(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=g&&x.x<=v&&x.y>=y&&x.y<=_&&x!==r&&x!==s&&f(a,c,l,p,u,d,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=C;){if(b.x>=g&&b.x<=v&&b.y>=y&&b.y<=_&&b!==r&&b!==s&&f(a,c,l,p,u,d,b.x,b.y)&&m(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=w;){if(x.x>=g&&x.x<=v&&x.y>=y&&x.y<=_&&x!==r&&x!==s&&f(a,c,l,p,u,d,x.x,x.y)&&m(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function a(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!y(i,s)&&v(i,r,r.next,s)&&w(i,s)&&w(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),E(r),E(r.next),r=t=s),r=r.next}while(r!==t);return o(r)}function l(t,e,n,i,s,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var c=b(l,u);return l=o(l,l.next),c=o(c,c.next),r(l,e,n,i,s,a,0),void r(c,e,n,i,s,a,0)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function c(t,e){var n=function(t,e){var n,o=e,r=t.x,i=t.y,s=-1/0;do{if(i<=o.y&&i>=o.next.y&&o.next.y!==o.y){var a=o.x+(i-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(a<=r&&a>s&&(s=a,n=o.x<o.next.x?o:o.next,a===r))return n}o=o.next}while(o!==e);if(!n)return null;var l,u=n,c=n.x,h=n.y,d=1/0;o=n;do{r>=o.x&&o.x>=c&&r!==o.x&&f(i<h?r:s,i,c,h,i<h?s:r,i,o.x,o.y)&&(l=Math.abs(i-o.y)/(r-o.x),w(o,t)&&(l<d||l===d&&(o.x>n.x||o.x===n.x&&p(n,o)))&&(n=o,d=l)),o=o.next}while(o!==u);return n}(t,e);if(!n)return e;var r=b(n,t);return o(r,r.next),o(n,n.next)}function p(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function h(t,e,n,o,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function f(t,e,n,o,r,i,s,a){return(r-s)*(e-a)>=(t-s)*(i-a)&&(t-s)*(o-a)>=(n-s)*(e-a)&&(n-s)*(i-a)>=(r-s)*(o-a)}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,o=!1,r=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!==n.next.y>i&&n.next.y!==n.y&&r<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(o=!o),n=n.next}while(n!==t);return o}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,o){var r=C(m(t,e,n)),i=C(m(t,e,o)),s=C(m(n,o,t)),a=C(m(n,o,e));return r!==i&&s!==a||(!(0!==r||!_(t,n,e))||(!(0!==i||!_(t,o,e))||(!(0!==s||!_(n,t,o))||!(0!==a||!_(n,e,o)))))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function C(t){return t>0?1:t<0?-1:0}function w(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function b(t,e){var n=new S(t.i,t.x,t.y),o=new S(e.i,e.x,e.y),r=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,o.next=n,n.prev=o,i.next=o,o.prev=i,o}function x(t,e,n,o){var r=new S(t,e,n);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,o){for(var r=0,i=e,s=n-o;i<n;i+=o)r+=(t[s]-t[i])*(t[i+1]+t[s+1]),s=i;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,o){var r=e&&e.length,i=r?e[0]*n:t.length,s=Math.abs(T(t,0,i,n));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(T(t,u,c,n))}var p=0;for(a=0;a<o.length;a+=3){var h=o[a]*n,d=o[a+1]*n,f=o[a+2]*n;p+=Math.abs((t[h]-t[f])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[f+1]-t[h+1]))}return 0===s&&0===p?0:Math.abs((p-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,r=0;r<t.length;r++){for(var i=0;i<t[r].length;i++)for(var s=0;s<e;s++)n.vertices.push(t[r][i][s]);r>0&&(o+=t[r-1].length,n.holes.push(o))}return n}},222:t=>{"use strict";var e=Array.prototype.slice,n=Object.prototype.toString;t.exports=function(t){var o=this;if("function"!==typeof o||"[object Function]"!==n.call(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var r,i=e.call(arguments,1),s=Math.max(0,o.length-i.length),a=[],l=0;l<s;l++)a.push("$"+l);if(r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof r){var n=o.apply(this,i.concat(e.call(arguments)));return Object(n)===n?n:this}return o.apply(t,i.concat(e.call(arguments)))})),o.prototype){var u=function(){};u.prototype=o.prototype,r.prototype=new u,u.prototype=null}return r}},3350:(t,e,n)=>{"use strict";var o=n(222);t.exports=Function.prototype.bind||o},4583:t=>{"use strict";var e=function(){return"string"===typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(r){n=null}e.functionsHaveConfigurableNames=function(){if(!e()||!n)return!1;var t=n((function(){}),"name");return!!t&&!!t.configurable};var o=Function.prototype.bind;e.boundFunctionsHaveNames=function(){return e()&&"function"===typeof o&&""!==function(){}.bind().name},t.exports=e},4042:(t,e,n)=>{var o=n(4058),r=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function i(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return o(t,e,{strict:!0})}r.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,o=i(t),r=i(e);return o.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),r)}}return!1},r.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},r.prototype.compareLine=function(t,e,n,o){if(!s(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),i=this.pseudoNode?e:this.removePseudo(e);if(!o||this.compareCoord(r[0],i[0])||(i=this.fixStartIndex(i,r))){var a=this.compareCoord(r[n],i[n]);return this.direction||a?this.comparePath(r,i):!!this.compareCoord(r[n],i[i.length-(1+n)])&&this.comparePath(r.slice().reverse(),i)}},r.prototype.fixStartIndex=function(t,e){for(var n,o=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){o=r;break}return o>=0&&(n=[].concat(t.slice(o,t.length),t.slice(1,o+1))),n},r.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},r.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),o=e.coordinates.slice(1,e.coordinates.length),r=this;return n.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),o)}return!1},r.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},r.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},r.prototype.removePseudo=function(t){return t},t.exports=r},9234:(t,e,n)=>{var o=n(2968),r=n(7872),i=n(2538),s=n(2127).Z,a=i.featureEach,l=(i.coordEach,r.polygon,r.featureCollection);function u(t){var e=new o(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),o.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),o.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),o.prototype.remove.call(this,t,e)},e.clear=function(){return o.prototype.clear.call(this)},e.search=function(t){var e=o.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return o.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=o.prototype.all.call(this);return l(t)},e.toJSON=function(){return o.prototype.toJSON.call(this)},e.fromJSON=function(t){return o.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},2968:function(t){t.exports=function(){"use strict";function t(t,o,r,i,s){!function t(n,o,r,i,s){for(;i>r;){if(i-r>600){var a=i-r+1,l=o-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,o,Math.max(r,Math.floor(o-l*c/a+p)),Math.min(i,Math.floor(o+(a-l)*c/a+p)),s)}var h=n[o],d=r,f=i;for(e(n,r,o),s(n[i],h)>0&&e(n,r,i);d<f;){for(e(n,d,f),d++,f--;s(n[d],h)<0;)d++;for(;s(n[f],h)>0;)f--}0===s(n[r],h)?e(n,r,f):e(n,++f,i),f<=o&&(r=f+1),o<=f&&(i=f-1)}}(t,o,r||0,i||t.length-1,s||n)}function e(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function n(t,e){return t<e?-1:t>e?1:0}var o=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var o=0;o<e.length;o++)if(n(t,e[o]))return o;return-1}function i(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,o,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var i=e;i<n;i++){var s=t.children[i];a(r,t.leaf?o(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,o,r,i){for(var s=[n,o];s.length;)if(!((o=s.pop())-(n=s.pop())<=r)){var a=n+Math.ceil((o-n)/r/2)*r;t(e,a,n,o,i),s.push(n,a,a,o)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var o=this.toBBox,r=[];e;){for(var i=0;i<e.children.length;i++){var s=e.children[i],a=e.leaf?o(s):s;d(t,a)&&(e.leaf?n.push(s):h(t,a)?this._all(s,n):r.push(s))}e=r.pop()}return n},o.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var o=0;o<e.children.length;o++){var r=e.children[o],i=e.leaf?this.toBBox(r):r;if(d(t,i)){if(e.leaf||h(t,i))return!0;n.push(r)}}e=n.pop()}return!1},o.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var o=this.data;this.data=n,n=o}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},o.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},o.prototype.clear=function(){return this.data=f([]),this},o.prototype.remove=function(t,e){if(!t)return this;for(var n,o,i,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),o=l[l.length-1],n=u.pop(),i=!0),s.leaf){var c=r(t,s.children,e);if(-1!==c)return s.children.splice(c,1),l.push(s),this._condense(l),this}i||s.leaf||!h(s,a)?o?(n++,s=o.children[n],i=!1):s=null:(l.push(s),u.push(n),n=0,o=s,s=s.children[0])}return this},o.prototype.toBBox=function(t){return t},o.prototype.compareMinX=function(t,e){return t.minX-e.minX},o.prototype.compareMinY=function(t,e){return t.minY-e.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(t){return this.data=t,this},o.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},o.prototype._build=function(t,e,n,o){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return i(r=f(t.slice(e,n+1)),this.toBBox),r;o||(o=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,o-1))),(r=f([])).leaf=!1,r.height=o;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var p=Math.min(c+u-1,n);g(t,c,p,l,this.compareMinY);for(var h=c;h<=p;h+=l){var d=Math.min(h+l-1,p);r.children.push(this._build(t,h,d,o-1))}}return i(r,this.toBBox),r},o.prototype._chooseSubtree=function(t,e,n,o){for(;o.push(e),!e.leaf&&o.length-1!==n;){for(var r=1/0,i=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=c(l),p=(h=t,d=l,(Math.max(d.maxX,h.maxX)-Math.min(d.minX,h.minX))*(Math.max(d.maxY,h.maxY)-Math.min(d.minY,h.minY))-u);p<i?(i=p,r=u<r?u:r,s=l):p===i&&u<r&&(r=u,s=l)}e=s||e.children[0]}var h,d;return e},o.prototype._insert=function(t,e,n){var o=n?t:this.toBBox(t),r=[],i=this._chooseSubtree(o,this.data,e,r);for(i.children.push(t),a(i,o);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(o,r,e)},o.prototype._split=function(t,e){var n=t[e],o=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,o);var s=this._chooseSplitIndex(n,r,o),a=f(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,i(n,this.toBBox),i(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},o.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(t,e,n){for(var o,r,i,a,l,u,p,h=1/0,d=1/0,f=e;f<=n-e;f++){var g=s(t,0,f,this.toBBox),m=s(t,f,n,this.toBBox),y=(r=g,i=m,a=void 0,l=void 0,u=void 0,p=void 0,a=Math.max(r.minX,i.minX),l=Math.max(r.minY,i.minY),u=Math.min(r.maxX,i.maxX),p=Math.min(r.maxY,i.maxY),Math.max(0,u-a)*Math.max(0,p-l)),v=c(g)+c(m);y<h?(h=y,o=f,d=v<d?v:d):y===h&&v<d&&(d=v,o=f)}return o||n-e},o.prototype._chooseSplitAxis=function(t,e,n){var o=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,o)<this._allDistMargin(t,e,n,r)&&t.children.sort(o)},o.prototype._allDistMargin=function(t,e,n,o){t.children.sort(o);for(var r=this.toBBox,i=s(t,0,e,r),l=s(t,n-e,n,r),u=p(i)+p(l),c=e;c<n-e;c++){var h=t.children[c];a(i,t.leaf?r(h):h),u+=p(i)}for(var d=n-e-1;d>=e;d--){var f=t.children[d];a(l,t.leaf?r(f):f),u+=p(l)}return u},o.prototype._adjustParentBBoxes=function(t,e,n){for(var o=n;o>=0;o--)a(e[o],t)},o.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():i(t[e],this.toBBox)},o}()},2506:(t,e,n)=>{"use strict";var o,r=SyntaxError,i=Function,s=TypeError,a=function(t){try{return i('"use strict"; return ('+t+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(I){l=null}var u=function(){throw new s},c=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(e){return u}}}():u,p=n(697)(),h=n(2203)(),d=Object.getPrototypeOf||(h?function(t){return t.__proto__}:null),f={},g="undefined"!==typeof Uint8Array&&d?d(Uint8Array):o,m={"%AggregateError%":"undefined"===typeof AggregateError?o:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?o:ArrayBuffer,"%ArrayIteratorPrototype%":p&&d?d([][Symbol.iterator]()):o,"%AsyncFromSyncIteratorPrototype%":o,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"===typeof Atomics?o:Atomics,"%BigInt%":"undefined"===typeof BigInt?o:BigInt,"%BigInt64Array%":"undefined"===typeof BigInt64Array?o:BigInt64Array,"%BigUint64Array%":"undefined"===typeof BigUint64Array?o:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?o:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"===typeof Float32Array?o:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?o:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?o:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":f,"%Int8Array%":"undefined"===typeof Int8Array?o:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?o:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?o:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":p&&d?d(d([][Symbol.iterator]())):o,"%JSON%":"object"===typeof JSON?JSON:o,"%Map%":"undefined"===typeof Map?o:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&p&&d?d((new Map)[Symbol.iterator]()):o,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?o:Promise,"%Proxy%":"undefined"===typeof Proxy?o:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"===typeof Reflect?o:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?o:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&p&&d?d((new Set)[Symbol.iterator]()):o,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?o:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":p&&d?d(""[Symbol.iterator]()):o,"%Symbol%":p?Symbol:o,"%SyntaxError%":r,"%ThrowTypeError%":c,"%TypedArray%":g,"%TypeError%":s,"%Uint8Array%":"undefined"===typeof Uint8Array?o:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?o:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?o:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?o:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"===typeof WeakMap?o:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?o:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?o:WeakSet};if(d)try{null.error}catch(I){var y=d(d(I));m["%Error.prototype%"]=y}var v=function t(e){var n;if("%AsyncFunction%"===e)n=a("async function () {}");else if("%GeneratorFunction%"===e)n=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=a("async function* () {}");else if("%AsyncGenerator%"===e){var o=t("%AsyncGeneratorFunction%");o&&(n=o.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&d&&(n=d(r.prototype))}return m[e]=n,n},_={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},C=n(3350),w=n(8316),b=C.call(Function.call,Array.prototype.concat),x=C.call(Function.apply,Array.prototype.splice),E=C.call(Function.call,String.prototype.replace),S=C.call(Function.call,String.prototype.slice),T=C.call(Function.call,RegExp.prototype.exec),R=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,O=/\\(\\)?/g,P=function(t,e){var n,o=t;if(w(_,o)&&(o="%"+(n=_[o])[0]+"%"),w(m,o)){var i=m[o];if(i===f&&(i=v(o)),"undefined"===typeof i&&!e)throw new s("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:o,value:i}}throw new r("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!==typeof t||0===t.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof e)throw new s('"allowMissing" argument must be a boolean');if(null===T(/^%?[^%]*%?$/,t))throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=S(t,0,1),n=S(t,-1);if("%"===e&&"%"!==n)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new r("invalid intrinsic syntax, expected opening `%`");var o=[];return E(t,R,(function(t,e,n,r){o[o.length]=n?E(r,O,"$1"):e||t})),o}(t),o=n.length>0?n[0]:"",i=P("%"+o+"%",e),a=i.name,u=i.value,c=!1,p=i.alias;p&&(o=p[0],x(n,b([0,1],p)));for(var h=1,d=!0;h<n.length;h+=1){var f=n[h],g=S(f,0,1),y=S(f,-1);if(('"'===g||"'"===g||"`"===g||'"'===y||"'"===y||"`"===y)&&g!==y)throw new r("property names with quotes must have matching quotes");if("constructor"!==f&&d||(c=!0),w(m,a="%"+(o+="."+f)+"%"))u=m[a];else if(null!=u){if(!(f in u)){if(!e)throw new s("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&h+1>=n.length){var v=l(u,f);u=(d=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:u[f]}else d=w(u,f),u=u[f];d&&!c&&(m[a]=u)}}return u}},3347:(t,e,n)=>{"use strict";var o=n(2506)("%Object.getOwnPropertyDescriptor%",!0);if(o)try{o([],"length")}catch(r){o=null}t.exports=o},4510:(t,e,n)=>{"use strict";var o=n(2506)("%Object.defineProperty%",!0),r=function(){if(o)try{return o({},"a",{value:1}),!0}catch(t){return!1}return!1};r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return 1!==o([],"length",{value:1}).length}catch(t){return!0}},t.exports=r},2203:t=>{"use strict";var e={foo:{}},n=Object;t.exports=function(){return{__proto__:e}.foo===e.foo&&!({__proto__:null}instanceof n)}},697:(t,e,n)=>{"use strict";var o="undefined"!==typeof Symbol&&Symbol,r=n(3297);t.exports=function(){return"function"===typeof o&&("function"===typeof Symbol&&("symbol"===typeof o("foo")&&("symbol"===typeof Symbol("bar")&&r())))}},3297:t=>{"use strict";t.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"===typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"===typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var o=Object.getOwnPropertySymbols(t);if(1!==o.length||o[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},4707:(t,e,n)=>{"use strict";var o=n(3297);t.exports=function(){return o()&&!!Symbol.toStringTag}},8316:(t,e,n)=>{"use strict";var o=n(3350);t.exports=o.call(Function.call,Object.prototype.hasOwnProperty)},5450:(t,e,n)=>{"use strict";var o=n(4707)(),r=n(4037)("Object.prototype.toString"),i=function(t){return!(o&&t&&"object"===typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===r(t)},s=function(t){return!!i(t)||null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Array]"!==r(t)&&"[object Function]"===r(t.callee)},a=function(){return i(arguments)}();i.isLegacyArguments=s,t.exports=a?i:s},2833:(t,e,n)=>{"use strict";var o=Date.prototype.getDay,r=Object.prototype.toString,i=n(4707)();t.exports=function(t){return"object"===typeof t&&null!==t&&(i?function(t){try{return o.call(t),!0}catch(e){return!1}}(t):"[object Date]"===r.call(t))}},1146:(t,e,n)=>{"use strict";var o,r,i,s,a=n(4037),l=n(4707)();if(l){o=a("Object.prototype.hasOwnProperty"),r=a("RegExp.prototype.exec"),i={};var u=function(){throw i};s={toString:u,valueOf:u},"symbol"===typeof Symbol.toPrimitive&&(s[Symbol.toPrimitive]=u)}var c=a("Object.prototype.toString"),p=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!==typeof t)return!1;var e=p(t,"lastIndex");if(!(e&&o(e,"value")))return!1;try{r(t,s)}catch(n){return n===i}}:function(t){return!(!t||"object"!==typeof t&&"function"!==typeof t)&&"[object RegExp]"===c(t)}},5483:function(t){t.exports=function(){"use strict";var t,e,n;function o(o,r){if(t)if(e){var i="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",s={};t(s),n=r(s),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(n.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"})))}else e=r;else t=r}return o(["exports"],(function(t){var e="undefined"!=typeof self?self:{},n="2.15.0";let o;const r={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==o){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{o=null!={NODE_ENV:"production",PUBLIC_URL:"/food-security2",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX?new RegExp({NODE_ENV:"production",PUBLIC_URL:"/food-security2",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX):t}catch(e){o=t}}return o},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!r.API_URL)return null;try{const t=new URL(r.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch(t){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},i={supported:!1,testSupport:function(t){!l&&a&&(u?c(t):s=t)}};let s,a,l=!1,u=!1;function c(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.isContextLost())return;i.supported=!0}catch(t){}t.deleteTexture(e),l=!0}e.document&&(a=e.document.createElement("img"),a.onload=function(){s&&c(s),s=null,u=!0},a.onerror=function(){l=!0,s=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const p="01";function h(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var d=f;function f(t,e,n,o){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=o}f.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,o=0;o<8;o++){var r=this.sampleCurveX(n)-t;if(Math.abs(r)<e)return n;var i=this.sampleCurveDerivativeX(n);if(Math.abs(i)<1e-6)break;n-=r/i}var s=0,a=1;for(n=t,o=0;o<20&&(r=this.sampleCurveX(n),!(Math.abs(r-t)<e));o++)t>r?s=n:a=n,n=.5*(a-s)+s;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var g=h(d),m=y;function y(t,e){this.x=t,this.y=e}y.prototype={clone:function(){return new y(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),o=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=o,this},_rotateAround:function(t,e){var n=Math.cos(t),o=Math.sin(t),r=e.y+o*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-o*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},y.convert=function(t){return t instanceof y?t:Array.isArray(t)?new y(t[0],t[1]):t};var v=h(m);const _=Math.PI/180,C=180/Math.PI;function w(t){return t*_}function b(t){return t*C}const x=[[0,0],[1,0],[1,1],[0,1]];function E(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function S(t,e,n,o){const r=new g(t,e,n,o);return function(t){return r.solve(t)}}const T=S(.25,.1,.25,1);function R(t,e,n){return Math.min(n,Math.max(e,t))}function O(t,e,n){return(n=R((n-t)/(e-t),0,1))*n*(3-2*n)}function P(t,e,n){const o=n-e,r=((t-e)%o+o)%o+e;return r===e?n:r}function I(t,e,n){if(!t.length)return n(null,[]);let o=t.length;const r=new Array(t.length);let i=null;t.forEach(((t,s)=>{e(t,((t,e)=>{t&&(i=t),r[s]=e,0==--o&&n(i,r)}))}))}function A(t){const e=[];for(const n in t)e.push(t[n]);return e}function D(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];for(const r of n)for(const e in r)t[e]=r[e];return t}let M=1;function L(){return M++}function N(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function F(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function k(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function G(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e))}))}function B(t,e){return-1!==t.indexOf(e,t.length-e.length)}function V(t,e,n){const o={};for(const r in t)o[r]=e.call(n||this,t[r],r,t);return o}function z(t,e,n){const o={};for(const r in t)e.call(n||this,t[r],r,t)&&(o[r]=t[r]);return o}function j(t){return Array.isArray(t)?t.map(j):"object"==typeof t&&t?V(t,j):t}const H={};function U(t){H[t]||("undefined"!=typeof console&&console.warn(t),H[t]=!0)}function W(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function q(t){let e=0;for(let n,o,r=0,i=t.length,s=i-1;r<i;s=r++)n=t[r],o=t[s],e+=(o.x-n.x)*(n.y+o.y);return e}function X(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Y(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,n,o,r)=>{const i=o||r;return e[n]=!i||i.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let K=null;function Z(t){if(null==K){const e=t.navigator?t.navigator.userAgent:null;K=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return K}function J(t){try{const n=e[t];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch(t){return!1}}function Q(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const $="mapbox-tiles";let tt,et,nt=500,ot=50;function rt(){try{return e.caches}catch(t){}}function it(){rt()&&!tt&&(tt=e.caches.open($))}function st(t){const e=t.indexOf("?");if(e<0)return t;const n=function(t){const e=t.indexOf("?");return e>0?t.slice(e+1).split("&"):[]}(t),o=n.filter((t=>{const e=t.split("=");return"language"===e[0]||"worldview"===e[0]}));return o.length?"".concat(t.slice(0,e),"?").concat(o.join("&")):t.slice(0,e)}let at=1/0;const lt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(lt);class ut extends Error{constructor(t,e,n){401===e&&Ct(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=n}toString(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}const ct=X()?()=>self.worker&&self.worker.referrer:()=>("blob:"===e.location.protocol?e.parent:e).location.href,pt=function(t,n){if(!(/^file:/.test(o=t.url)||/^file:/.test(ct())&&!/^\w+:/.test(o))){if(e.fetch&&e.Request&&e.AbortController&&e.Request.prototype.hasOwnProperty("signal"))return function(t,n){const o=new e.AbortController,r=new e.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:ct(),referrerPolicy:t.referrerPolicy,signal:o.signal});let i=!1,s=!1;const a=(l=r.url).indexOf("sku=")>0&&Ct(l);var l;"json"===t.type&&r.headers.set("Accept","application/json");const u=(o,i,l)=>{if(s)return;if(o&&"SecurityError"!==o.message&&U(o.toString()),i&&l)return c(i);const u=Date.now();e.fetch(r).then((e=>{if(e.ok){const t=a?e.clone():null;return c(e,t,u)}return n(new ut(e.statusText,e.status,t.url))})).catch((e=>{"AbortError"!==e.name&&n(new Error("".concat(e.message," ").concat(t.url)))}))},c=(o,a,l)=>{("arrayBuffer"===t.type?o.arrayBuffer():"json"===t.type?o.json():o.text()).then((t=>{s||(a&&l&&function(t,n,o){if(it(),!tt)return;const r={status:n.status,statusText:n.statusText,headers:new e.Headers};n.headers.forEach(((t,e)=>r.headers.set(e,t)));const i=Y(n.headers.get("Cache-Control")||"");if(i["no-store"])return;i["max-age"]&&r.headers.set("Expires",new Date(o+1e3*i["max-age"]).toUTCString());const s=r.headers.get("Expires");s&&(new Date(s).getTime()-o<42e4||function(t,e){if(void 0===et)try{new Response(new ReadableStream),et=!0}catch(t){et=!1}et?e(t.body):t.blob().then(e)}(n,(n=>{const o=new e.Response(n,r);it(),tt&&tt.then((e=>e.put(st(t.url),o))).catch((t=>U(t.message)))})))}(r,a,l),i=!0,n(null,t,o.headers.get("Cache-Control"),o.headers.get("Expires")))})).catch((t=>{s||n(new Error(t.message))}))};return a?function(t,e){if(it(),!tt)return e(null);const n=st(t.url);tt.then((t=>{t.match(n).then((o=>{const r=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),n=Y(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(o);t.delete(n),r&&t.put(n,o.clone()),e(null,o,r)})).catch(e)})).catch(e)}(r,u):u(null,null),{cancel:()=>{s=!0,i||o.abort()}}}(t,n);if(X()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,n,void 0,!0)}var o;return function(t,n){const o=new e.XMLHttpRequest;o.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(o.responseType="arraybuffer");for(const e in t.headers)o.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(o.responseType="text",o.setRequestHeader("Accept","application/json")),o.withCredentials="include"===t.credentials,o.onerror=()=>{n(new Error(o.statusText))},o.onload=()=>{if((o.status>=200&&o.status<300||0===o.status)&&null!==o.response){let e=o.response;if("json"===t.type)try{e=JSON.parse(o.response)}catch(t){return n(t)}n(null,e,o.getResponseHeader("Cache-Control"),o.getResponseHeader("Expires"))}else n(new ut(o.statusText,o.status,t.url))},o.send(t.body),{cancel:()=>o.abort()}}(t,n)},ht=function(t,e){return pt(D(t,{type:"arrayBuffer"}),e)};function dt(t){const n=e.document.createElement("a");return n.href=t,n.protocol===e.document.location.protocol&&n.host===e.document.location.host}const ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let gt,mt;gt=[],mt=0;const yt=function(t,n){if(i.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),mt>=r.MAX_PARALLEL_IMAGE_REQUESTS){const e={requestParameters:t,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return gt.push(e),e}mt++;let o=!1;const s=()=>{if(!o)for(o=!0,mt--;gt.length&&mt<r.MAX_PARALLEL_IMAGE_REQUESTS;){const t=gt.shift(),{requestParameters:e,callback:n,cancelled:o}=t;o||(t.cancel=yt(e,n).cancel)}},a=ht(t,((t,o,r,i)=>{s(),t?n(t):o&&(e.createImageBitmap?function(t,n){const o=new e.Blob([new Uint8Array(t)],{type:"image/png"});e.createImageBitmap(o).then((t=>{n(null,t)})).catch((t=>{n(new Error("Could not load image because of ".concat(t.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(o,((t,e)=>n(t,e,r,i))):function(t,n){const o=new e.Image,r=e.URL;o.onload=()=>{n(null,o),r.revokeObjectURL(o.src),o.onload=null,e.requestAnimationFrame((()=>{o.src=ft}))},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new e.Blob([new Uint8Array(t)],{type:"image/png"});o.src=t.byteLength?r.createObjectURL(i):ft}(o,((t,e)=>n(t,e,r,i))))}));return{cancel:()=>{a.cancel(),s()}}},vt="NO_ACCESS_TOKEN";function _t(t){return 0===t.indexOf("mapbox:")}function Ct(t){return r.API_URL_REGEX.test(t)}function wt(t){return r.API_CDN_URL_REGEX.test(t)}function bt(t){return r.API_STYLE_REGEX.test(t)&&!xt(t)}function xt(t){return r.API_SPRITE_REGEX.test(t)}const Et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function St(t){const e=t.match(Et);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Tt(t){const e=t.params.length?"?".concat(t.params.join("&")):"";return"".concat(t.protocol,"://").concat(t.authority).concat(t.path).concat(e)}const Rt="mapbox.eventData";function Ot(t){if(!t)return null;const n=t.split(".");if(!n||3!==n.length)return null;try{return JSON.parse(decodeURIComponent(e.atob(n[1]).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(t){return null}}class Pt{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const n=Ot(r.ACCESS_TOKEN);let o="";return o=n&&n.u?e.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,((t,e)=>String.fromCharCode(Number("0x"+e))))):r.ACCESS_TOKEN||"",t?"".concat(Rt,".").concat(t,":").concat(o):"".concat(Rt,":").concat(o)}fetchEventData(){const t=J("localStorage"),n=this.getStorageKey(),o=this.getStorageKey("uuid");if(t)try{const t=e.localStorage.getItem(n);t&&(this.eventData=JSON.parse(t));const r=e.localStorage.getItem(o);r&&(this.anonId=r)}catch(t){U("Unable to read from LocalStorage")}}saveEventData(){const t=J("localStorage"),n=this.getStorageKey(),o=this.getStorageKey("uuid");if(t)try{e.localStorage.setItem(o,this.anonId),Object.keys(this.eventData).length>=1&&e.localStorage.setItem(n,JSON.stringify(this.eventData))}catch(t){U("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,e,n,o){if(!r.EVENTS_URL)return;const i=St(r.EVENTS_URL);i.params.push("access_token=".concat(o||r.ACCESS_TOKEN||""));const s={event:this.type,created:new Date(t).toISOString()},a=e?D(s,e):s,l={url:Tt(i),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=function(t,e){return pt(D(t,{method:"POST"}),e)}(l,(t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(o)}))}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const It=new class extends Pt{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){r.EVENTS_URL&&r.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>_t(t)||Ct(t)))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Ot(r.ACCESS_TOKEN),o=e?e.u:r.ACCESS_TOKEN;let i=o!==this.eventData.tokenU;k(this.anonId)||(this.anonId=N(),i=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(s),n=(s-this.eventData.lastSuccess)/864e5;i=i||n>=1||n<-1||t.getDate()!==e.getDate()}else i=!0;i?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:p,"enabled.telemetry":!1,userId:this.anonId},(t=>{t||(this.eventData.lastSuccess=s,this.eventData.tokenU=o)}),t):this.processRequests()}},At=It.postTurnstileEvent.bind(It),Dt=new class extends Pt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,o){this.skuToken=e,this.errorCb=o,r.EVENTS_URL&&(n||r.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(vt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),k(this.anonId)||(this.anonId=N()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:p,skuToken:this.skuToken,userId:this.anonId},(t=>{t?this.errorCb(t):e&&(this.success[e]=!0)}),t))}},Mt=Dt.postMapLoadEvent.bind(Dt),Lt=new class extends Pt{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){r.EVENTS_URL&&(t||r.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:r}=this.queue.shift(),i=function(t){const o=e.performance.getEntriesByType("resource"),r=e.performance.getEntriesByType("mark"),i=function(t){const e={};if(t)for(const n in t)if("other"!==n)for(const o of t[n]){const t="".concat(n,"ResolveRangeMin"),r="".concat(n,"ResolveRangeMax"),i="".concat(n,"RequestCount"),s="".concat(n,"RequestCachedCount");e[t]=Math.min(e[t]||1/0,o.startTime),e[r]=Math.max(e[r]||-1/0,o.responseEnd);const a=t=>{void 0===e[t]&&(e[t]=0),++e[t]};void 0!==o.transferSize&&0===o.transferSize&&a(s),a(i)}return e}(function(t,e){const n={};if(t)for(const o of t){const t=e(o);void 0===n[t]&&(n[t]=[]),n[t].push(o)}return n}(o,zt)),s=e.devicePixelRatio,a=e.navigator.connection||e.navigator.mozConnection||e.navigator.webkitConnection,l={counters:[],metadata:[],attributes:[]},u=(t,e,n)=>{null!=n&&t.push({name:e,value:n.toString()})};for(const e in i)u(l.counters,e,i[e]);if(t.interactionRange[0]!==1/0&&t.interactionRange[1]!==-1/0&&(u(l.counters,"interactionRangeMin",t.interactionRange[0]),u(l.counters,"interactionRangeMax",t.interactionRange[1])),r)for(const e of Object.keys(Bt)){const t=Bt[e],n=r.find((e=>e.name===t));n&&u(l.counters,t,n.startTime)}return u(l.counters,"visibilityHidden",t.visibilityHidden),u(l.attributes,"style",function(t){if(t)for(const e of t){const t=e.name.split("?")[0];if(bt(t)){const e=t.split("/").slice(-2);if(2===e.length)return"mapbox://styles/".concat(e[0],"/").concat(e[1])}}}(o)),u(l.attributes,"terrainEnabled",t.terrainEnabled?"true":"false"),u(l.attributes,"fogEnabled",t.fogEnabled?"true":"false"),u(l.attributes,"projection",t.projection),u(l.attributes,"zoom",t.zoom),u(l.metadata,"devicePixelRatio",s),u(l.metadata,"connectionEffectiveType",a?a.effectiveType:void 0),u(l.metadata,"navigatorUserAgent",e.navigator.userAgent),u(l.metadata,"screenWidth",e.screen.width),u(l.metadata,"screenHeight",e.screen.height),u(l.metadata,"windowWidth",e.innerWidth),u(l.metadata,"windowHeight",e.innerHeight),u(l.metadata,"mapWidth",t.width/s),u(l.metadata,"mapHeight",t.height/s),u(l.metadata,"webglRenderer",t.renderer),u(l.metadata,"webglVendor",t.vendor),u(l.metadata,"sdkVersion",n),u(l.metadata,"sdkIdentifier","mapbox-gl-js"),l}(r);for(const e of i.metadata);for(const e of i.counters);for(const e of i.attributes);this.postEvent(o,i,(()=>{}),t)}},Nt=Lt.postPerformanceEvent.bind(Lt),Ft=new class extends Pt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,o){if(!r.API_URL||!r.SESSION_PATH)return;const i=St(r.API_URL+r.SESSION_PATH);i.params.push("sku=".concat(e||"")),i.params.push("access_token=".concat(o||r.ACCESS_TOKEN||""));const s={url:Tt(i),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(t,e){return pt(D(t,{method:"GET"}),e)}(s,(t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(o)}))}getSessionAPI(t,e,n,o){this.skuToken=e,this.errorCb=o,r.SESSION_PATH&&r.API_URL&&(n||r.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(vt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,(t=>{t?this.errorCb(t):e&&(this.success[e]=!0)}),t)}},kt=Ft.getSessionAPI.bind(Ft),Gt=new Set,Bt={create:"create",load:"load",fullLoad:"fullLoad"},Vt={mark(t){e.performance.mark(t)},measure(t,n,o){e.performance.measure(t,n,o)}};function zt(t){const e=t.name.split("?")[0];return wt(e)&&e.includes("mapbox-gl.js")?"javascript":wt(e)&&e.includes("mapbox-gl.css")?"css":function(t){return r.API_FONTS_REGEX.test(t)}(e)?"fontRange":xt(e)?"sprite":bt(e)?"style":function(t){return r.API_TILEJSON_REGEX.test(t)}(e)?"tilejson":"other"}const jt=e.performance;function Ht(t){const e=t?t.url.toString():void 0;return jt.getEntriesByName(e)}let Ut,Wt,qt,Xt;const Yt={now:()=>void 0!==qt?qt:e.performance.now(),setNow(t){qt=t},restoreNow(){qt=void 0},frame(t){const n=e.requestAnimationFrame(t);return{cancel:()=>e.cancelAnimationFrame(n)}},getImageData(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:o,height:r}=t;Xt||(Xt=e.document.createElement("canvas"));const i=Xt.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return(o>Xt.width||r>Xt.height)&&(Xt.width=o,Xt.height=r),i.clearRect(-n,-n,o+2*n,r+2*n),i.drawImage(t,0,0,o,r),i.getImageData(-n,-n,o+2*n,r+2*n)},resolveURL:t=>(Ut||(Ut=e.document.createElement("a")),Ut.href=t,Ut.href),get devicePixelRatio(){return e.devicePixelRatio},get prefersReducedMotion(){return!!e.matchMedia&&(null==Wt&&(Wt=e.matchMedia("(prefers-reduced-motion: reduce)")),Wt.matches)}};function Kt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Zt(t,e,n){if(n&&n[t]){const o=n[t].indexOf(e);-1!==o&&n[t].splice(o,1)}}class Jt{constructor(t){D(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=t}}class Qt extends Jt{constructor(t){super("error",D({error:t},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class $t{on(t,e){return this._listeners=this._listeners||{},Kt(t,e,this._listeners),this}off(t,e){return Zt(t,e,this._listeners),Zt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Kt(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new Jt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const i of o)Zt(n,i,this._oneTimeListeners),i.call(this,t);const r=this._eventedParent;r&&(D(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof Qt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var te=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ee(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];for(const r of n)for(const e in r)t[e]=r[e];return t}function ne(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function oe(t){if(Array.isArray(t))return t.map(oe);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=oe(t[n]);return e}return ne(t)}class re extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}var ie=re;class se{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=t,this.bindings={};for(const[n,o]of e)this.bindings[n]=o}concat(t){return new se(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error("".concat(t," not found in scope."))}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var ae=se;const le={kind:"null"},ue={kind:"number"},ce={kind:"string"},pe={kind:"boolean"},he={kind:"color"},de={kind:"object"},fe={kind:"value"},ge={kind:"collator"},me={kind:"formatted"},ye={kind:"resolvedImage"};function ve(t,e){return{kind:"array",itemType:t,N:e}}function _e(t){if("array"===t.kind){const e=_e(t.itemType);return"number"==typeof t.N?"array<".concat(e,", ").concat(t.N,">"):"value"===t.itemType.kind?"array":"array<".concat(e,">")}return t.kind}const Ce=[le,ue,ce,pe,he,me,de,ve(fe),ye];function we(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!we(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of Ce)if(!we(t,e))return null}return"Expected ".concat(_e(t)," but found ").concat(_e(e)," instead.")}function be(t,e){return e.some((e=>e.kind===t.kind))}function xe(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}var Ee,Se={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Te(t){return(t=Math.round(t))<0?0:t>255?255:t}function Re(t){return Te("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Oe(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Pe(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Ee={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Se)return Se[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var o=n.indexOf("("),r=n.indexOf(")");if(-1!==o&&r+1===n.length){var i=n.substr(0,o),s=n.substr(o+1,r-(o+1)).split(","),a=1;switch(i){case"rgba":if(4!==s.length)return null;a=Oe(s.pop());case"rgb":return 3!==s.length?null:[Re(s[0]),Re(s[1]),Re(s[2]),a];case"hsla":if(4!==s.length)return null;a=Oe(s.pop());case"hsl":if(3!==s.length)return null;var l=(parseFloat(s[0])%360+360)%360/360,u=Oe(s[1]),c=Oe(s[2]),p=c<=.5?c*(u+1):c+u-c*u,h=2*c-p;return[Te(255*Pe(h,p,l+1/3)),Te(255*Pe(h,p,l)),Te(255*Pe(h,p,l-1/3)),a];default:return null}}return null}}catch(t){}class Ie{constructor(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.r=t,this.g=e,this.b=n,this.a=o}static parse(t){if(!t)return;if(t instanceof Ie)return t;if("string"!=typeof t)return;const e=Ee(t);return e?new Ie(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,o]=this.toArray();return"rgba(".concat(Math.round(t),",").concat(Math.round(e),",").concat(Math.round(n),",").concat(o,")")}toArray(){const{r:t,g:e,b:n,a:o}=this;return 0===o?[0,0,0,0]:[255*t/o,255*e/o,255*n/o,o]}toArray01(){const{r:t,g:e,b:n,a:o}=this;return 0===o?[0,0,0,0]:[t/o,e/o,n/o,o]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:n,a:o}=this;return[t,e,n,o]}}Ie.black=new Ie(0,0,0,1),Ie.white=new Ie(1,1,1,1),Ie.transparent=new Ie(0,0,0,0),Ie.red=new Ie(1,0,0,1),Ie.blue=new Ie(0,0,1,1);var Ae=Ie;class De{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Me{constructor(t,e,n,o,r){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=n,this.fontStack=o,this.textColor=r}}class Le{constructor(t){this.sections=t}static fromString(t){return new Le([new Me(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof Le?t:Le.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class Ne{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ne({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Fe(t,e,n,o){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===o||"number"==typeof o&&o>=0&&o<=1?null:"Invalid rgba value [".concat([t,e,n,o].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof o?[t,e,n,o]:[t,e,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function ke(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Ae)return!0;if(t instanceof De)return!0;if(t instanceof Le)return!0;if(t instanceof Ne)return!0;if(Array.isArray(t)){for(const e of t)if(!ke(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ke(t[e]))return!1;return!0}return!1}function Ge(t){if(null===t)return le;if("string"==typeof t)return ce;if("boolean"==typeof t)return pe;if("number"==typeof t)return ue;if(t instanceof Ae)return he;if(t instanceof De)return ge;if(t instanceof Le)return me;if(t instanceof Ne)return ye;if(Array.isArray(t)){const e=t.length;let n;for(const o of t){const t=Ge(o);if(n){if(n===t)continue;n=fe;break}n=t}return ve(n||fe,e)}return de}function Be(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Ae||t instanceof Le||t instanceof Ne?t.toString():JSON.stringify(t)}class Ve{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!ke(t[1]))return e.error("invalid value");const n=t[1];let o=Ge(n);const r=e.expectedType;return"array"!==o.kind||0!==o.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(o=r),new Ve(o,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Ae?["rgba"].concat(this.value.toArray()):this.value instanceof Le?this.value.serialize():this.value}}var ze=Ve,je=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const He={string:ce,number:ue,boolean:pe,object:de};class Ue{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,o=1;const r=t[0];if("array"===r){let r,i;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in He)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=He[n],o++}else r=fe;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);i=t[2],o++}n=ve(r,i)}else n=He[r];const i=[];for(;o<t.length;o++){const n=e.parse(t[o],o,fe);if(!n)return null;i.push(n)}return new Ue(n,i)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!we(this.type,Ge(n)))return n;if(e===this.args.length-1)throw new je("Expected value to be of type ".concat(_e(this.type),", but found ").concat(_e(Ge(n))," instead."))}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const o=t.N;("number"==typeof o||this.args.length>1)&&e.push(o)}}return e.concat(this.args.map((t=>t.serialize())))}}var We=Ue;class qe{constructor(t){this.type=me,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const o=[];let r=!1;for(let i=1;i<=t.length-1;++i){const n=t[i];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,ue),!t))return null;let i=null;if(n["text-font"]&&(i=e.parse(n["text-font"],1,ve(ce)),!i))return null;let s=null;if(n["text-color"]&&(s=e.parse(n["text-color"],1,he),!s))return null;const a=o[o.length-1];a.scale=t,a.font=i,a.textColor=s}else{const n=e.parse(t[i],1,fe);if(!n)return null;const s=n.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,o.push({content:n,scale:null,font:null,textColor:null})}}return new qe(o)}evaluate(t){return new Le(this.sections.map((e=>{const n=e.content.evaluate(t);return Ge(n)===ye?new Me("",n,null,null,null):new Me(Be(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Xe{constructor(t){this.type=ye,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ce);return n?new Xe(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=Ne.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ye={"to-boolean":pe,"to-color":he,"to-number":ue,"to-string":ce};class Ke{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const o=Ye[n],r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],i,fe);if(!n)return null;r.push(n)}return new Ke(o,r)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const o of this.args){if(e=o.evaluate(t),n=null,e instanceof Ae)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?"Invalid rbga value ".concat(JSON.stringify(e),": expected an array containing either three or four numeric values."):Fe(e[0],e[1],e[2],e[3]),!n))return new Ae(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new je(n||"Could not parse color from value '".concat("string"==typeof e?e:String(JSON.stringify(e)),"'"))}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const o=Number(e);if(!isNaN(o))return o}throw new je("Could not convert ".concat(JSON.stringify(e)," to number."))}return"formatted"===this.type.kind?Le.fromString(Be(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Ne.fromString(Be(this.args[0].evaluate(t))):Be(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new qe([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Xe(this.args[0]).serialize();const t=["to-".concat(this.type.kind)];return this.eachChild((e=>{t.push(e.serialize())})),t}}var Ze=Ke;const Je=["Unknown","Point","LineString","Polygon"];var Qe=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Je[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(o*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Ae.parse(t)),e}};class $e{constructor(t,e,n,o){this.name=t,this.type=e,this._evaluate=n,this.args=o}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const n=t[0],o=$e.definitions[n];if(!o)return e.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);const r=Array.isArray(o)?o[0]:o.type,i=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,s=i.filter((e=>{let[n]=e;return!Array.isArray(n)||n.length===t.length-1}));let a=null;for(const[l,u]of s){a=new Rn(e.registry,e.path,null,e.scope);const o=[];let i=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(l)?l[e-1]:l.type,s=a.parse(n,1+o.length,r);if(!s){i=!0;break}o.push(s)}if(!i)if(Array.isArray(l)&&l.length!==o.length)a.error("Expected ".concat(l.length," arguments, but found ").concat(o.length," instead."));else{for(let t=0;t<o.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=o[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new $e(n,r,u,o)}}if(1===s.length)e.errors.push(...a.errors);else{const n=(s.length?s:i).map((t=>{let[e]=t;return n=e,Array.isArray(n)?"(".concat(n.map(_e).join(", "),")"):"(".concat(_e(n.type),"...)");var n})).join(" | "),o=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],1+o.length);if(!n)return null;o.push(_e(n.type))}e.error("Expected arguments of type ".concat(n,", but found (").concat(o.join(", "),") instead."))}return null}static register(t,e){$e.definitions=e;for(const n in e)t[n]=$e}}var tn=$e;class en{constructor(t,e,n){this.type=ge,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const o=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,pe);if(!o)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,pe);if(!r)return null;let i=null;return n.locale&&(i=e.parse(n.locale,1,ce),!i)?null:new en(o,r,i)}evaluate(t){return new De(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const nn=8192;function on(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function rn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function sn(t,e){const n=(180+t[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*nn),Math.round(o*r*nn)]}function an(t,e,n){const o=t[0]-e[0],r=t[1]-e[1],i=t[0]-n[0],s=t[1]-n[1];return o*s-i*r==0&&o*i<=0&&r*s<=0}function ln(t,e){let n=!1;for(let s=0,a=e.length;s<a;s++){const a=e[s];for(let e=0,s=a.length;e<s-1;e++){if(an(t,a[e],a[e+1]))return!1;(r=a[e])[1]>(o=t)[1]!=(i=a[e+1])[1]>o[1]&&o[0]<(i[0]-r[0])*(o[1]-r[1])/(i[1]-r[1])+r[0]&&(n=!n)}}var o,r,i;return n}function un(t,e){for(let n=0;n<e.length;n++)if(ln(t,e[n]))return!0;return!1}function cn(t,e,n,o){const r=o[0]-n[0],i=o[1]-n[1],s=(t[0]-n[0])*i-r*(t[1]-n[1]),a=(e[0]-n[0])*i-r*(e[1]-n[1]);return s>0&&a<0||s<0&&a>0}function pn(t,e,n){for(const u of n)for(let n=0;n<u.length-1;++n)if(0!=(a=[(s=u[n+1])[0]-(i=u[n])[0],s[1]-i[1]])[0]*(l=[(r=e)[0]-(o=t)[0],r[1]-o[1]])[1]-a[1]*l[0]&&cn(o,r,i,s)&&cn(i,s,o,r))return!0;var o,r,i,s,a,l;return!1}function hn(t,e){for(let n=0;n<t.length;++n)if(!ln(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(pn(t[n],t[n+1],e))return!1;return!0}function dn(t,e){for(let n=0;n<e.length;n++)if(hn(t,e[n]))return!0;return!1}function fn(t,e,n){const o=[];for(let r=0;r<t.length;r++){const i=[];for(let o=0;o<t[r].length;o++){const s=sn(t[r][o],n);on(e,s),i.push(s)}o.push(i)}return o}function gn(t,e,n){const o=[];for(let r=0;r<t.length;r++){const i=fn(t[r],e,n);o.push(i)}return o}function mn(t,e,n,o){if(t[0]<n[0]||t[0]>n[2]){const e=.5*o;let r=t[0]-n[0]>e?-o:n[0]-t[0]>e?o:0;0===r&&(r=t[0]-n[2]>e?-o:n[2]-t[0]>e?o:0),t[0]+=r}on(e,t)}function yn(t,e,n,o){const r=Math.pow(2,o.z)*nn,i=[o.x*nn,o.y*nn],s=[];if(!t)return s;for(const a of t)for(const t of a){const o=[t.x+i[0],t.y+i[1]];mn(o,e,n,r),s.push(o)}return s}function vn(t,e,n,o){const r=Math.pow(2,o.z)*nn,i=[o.x*nn,o.y*nn],s=[];if(!t)return s;for(const l of t){const t=[];for(const n of l){const o=[n.x+i[0],n.y+i[1]];on(e,o),t.push(o)}s.push(t)}if(e[2]-e[0]<=r/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const o of t)mn(o,e,n,r)}var a;return s}class _n{constructor(t,e){this.type=pe,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(ke(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new _n(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new _n(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new _n(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){const i=fn(e.coordinates,o,r),s=yn(t.geometry(),n,o,r);if(!rn(n,o))return!1;for(const t of s)if(!ln(t,i))return!1}if("MultiPolygon"===e.type){const i=gn(e.coordinates,o,r),s=yn(t.geometry(),n,o,r);if(!rn(n,o))return!1;for(const t of s)if(!un(t,i))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){const i=fn(e.coordinates,o,r),s=vn(t.geometry(),n,o,r);if(!rn(n,o))return!1;for(const t of s)if(!hn(t,i))return!1}if("MultiPolygon"===e.type){const i=gn(e.coordinates,o,r),s=vn(t.geometry(),n,o,r);if(!rn(n,o))return!1;for(const t of s)if(!dn(t,i))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Cn=_n;function wn(t){if(t instanceof tn){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Cn)return!1;let e=!0;return t.eachChild((t=>{e&&!wn(t)&&(e=!1)})),e}function bn(t){if(t instanceof tn&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!bn(t)&&(e=!1)})),e}function xn(t,e){if(t instanceof tn&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!xn(t,e)&&(n=!1)})),n}class En{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new En(n,e.scope.get(n)):e.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Sn=En;class Tn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ae,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.registry=t,this.path=e,this.key=e.map((t=>"[".concat(t,"]"))).join(""),this.scope=o,this.errors=r,this.expectedType=n}parse(t,e,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e?this.concat(e,n,o)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new We(e,[t]):"coerce"===n?new Ze(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const o=t[0];if("string"!=typeof o)return this.error("Expression name must be a string, but found ".concat(typeof o,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;const r=this.registry[o];if(r){let o=r.parse(t,this);if(!o)return null;if(this.expectedType){const t=this.expectedType,r=o.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(t,r))return null}else o=n(o,t,e.typeAnnotation||"coerce");else o=n(o,t,e.typeAnnotation||"assert")}if(!(o instanceof ze)&&"resolvedImage"!==o.type.kind&&On(o)){const e=new Qe;try{o=new ze(o.type,o.evaluate(e))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'.concat(o,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof t," instead."))}concat(t,e,n){const o="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Tn(this.registry,o,e||null,r,this.errors)}error(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];const r="".concat(this.key).concat(n.map((t=>"[".concat(t,"]"))).join(""));this.errors.push(new ie(r,t))}checkSubtype(t,e){const n=we(t,e);return n&&this.error(n),n}}var Rn=Tn;function On(t){if(t instanceof Sn)return On(t.boundExpression);if(t instanceof tn&&"error"===t.name)return!1;if(t instanceof en)return!1;if(t instanceof Cn)return!1;const e=t instanceof Ze||t instanceof We;let n=!0;return t.eachChild((t=>{n=e?n&&On(t):n&&t instanceof ze})),!!n&&wn(t)&&xn(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Pn(t,e){const n=t.length-1;let o,r,i=0,s=n,a=0;for(;i<=s;)if(a=Math.floor((i+s)/2),o=t[a],r=t[a+1],o<=e){if(a===n||e<r)return a;i=a+1}else{if(!(o>e))throw new je("Input is not a number.");s=a-1}return 0}class In{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[o,r]of n)this.labels.push(o),this.outputs.push(r)}static parse(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,ue);if(!n)return null;const o=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let i=1;i<t.length;i+=2){const n=1===i?-1/0:t[i],s=t[i+1],a=i,l=i+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(o.length&&o[o.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const u=e.parse(s,l,r);if(!u)return null;r=r||u.type,o.push([n,u])}return new In(r,n,o)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const o=this.input.evaluate(t);if(o<=e[0])return n[0].evaluate(t);const r=e.length;return o>=e[r-1]?n[r-1].evaluate(t):n[Pn(e,o)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var An=In;function Dn(t,e,n){return t*(1-n)+e*n}var Mn=Object.freeze({__proto__:null,array:function(t,e,n){return t.map(((t,o)=>Dn(t,e[o],n)))},color:function(t,e,n){return new Ae(Dn(t.r,e.r,n),Dn(t.g,e.g,n),Dn(t.b,e.b,n),Dn(t.a,e.a,n))},number:Dn});const Ln=.95047,Nn=1.08883,Fn=4/29,kn=6/29,Gn=3*kn*kn,Bn=kn*kn*kn,Vn=Math.PI/180,zn=180/Math.PI;function jn(t){return t>Bn?Math.pow(t,1/3):t/Gn+Fn}function Hn(t){return t>kn?t*t*t:Gn*(t-Fn)}function Un(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Wn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function qn(t){const e=Wn(t.r),n=Wn(t.g),o=Wn(t.b),r=jn((.4124564*e+.3575761*n+.1804375*o)/Ln),i=jn((.2126729*e+.7151522*n+.072175*o)/1);return{l:116*i-16,a:500*(r-i),b:200*(i-jn((.0193339*e+.119192*n+.9503041*o)/Nn)),alpha:t.a}}function Xn(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,o=isNaN(t.b)?e:e-t.b/200;return e=1*Hn(e),n=Ln*Hn(n),o=Nn*Hn(o),new Ae(Un(3.2404542*n-1.5371385*e-.4985314*o),Un(-.969266*n+1.8760108*e+.041556*o),Un(.0556434*n-.2040259*e+1.0572252*o),t.alpha)}function Yn(t,e,n){const o=e-t;return t+n*(o>180||o<-180?o-360*Math.round(o/360):o)}const Kn={forward:qn,reverse:Xn,interpolate:function(t,e,n){return{l:Dn(t.l,e.l,n),a:Dn(t.a,e.a,n),b:Dn(t.b,e.b,n),alpha:Dn(t.alpha,e.alpha,n)}}},Zn={forward:function(t){const{l:e,a:n,b:o}=qn(t),r=Math.atan2(o,n)*zn;return{h:r<0?r+360:r,c:Math.sqrt(n*n+o*o),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Vn,n=t.c;return Xn({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Yn(t.h,e.h,n),c:Dn(t.c,e.c,n),l:Dn(t.l,e.l,n),alpha:Dn(t.alpha,e.alpha,n)}}};var Jn=Object.freeze({__proto__:null,hcl:Zn,lab:Kn});class Qn{constructor(t,e,n,o,r){this.type=t,this.operator=e,this.interpolation=n,this.input=o,this.labels=[],this.outputs=[];for(const[i,s]of r)this.labels.push(i),this.outputs.push(s)}static interpolationFactor(t,e,n,o){let r=0;if("exponential"===t.name)r=$n(e,t.base,n,o);else if("linear"===t.name)r=$n(e,1,n,o);else if("cubic-bezier"===t.name){const i=t.controlPoints;r=new g(i[0],i[1],i[2],i[3]).solve($n(e,1,n,o))}return r}static parse(t,e){let[n,o,r,...i]=t;if(!Array.isArray(o)||0===o.length)return e.error("Expected an interpolation type expression.",1);if("linear"===o[0])o={name:"linear"};else if("exponential"===o[0]){const t=o[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:t}}else{if("cubic-bezier"!==o[0])return e.error("Unknown interpolation type ".concat(String(o[0])),1,0);{const t=o.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,ue),!r)return null;const s=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=he:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let l=0;l<i.length;l+=2){const t=i[l],n=i[l+1],o=l+3,r=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(s.length&&s[s.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',o);const u=e.parse(n,r,a);if(!u)return null;a=a||u.type,s.push([t,u])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Qn(a,n,o,r,s):e.error("Type ".concat(_e(a)," is not interpolatable."))}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const o=this.input.evaluate(t);if(o<=e[0])return n[0].evaluate(t);const r=e.length;if(o>=e[r-1])return n[r-1].evaluate(t);const i=Pn(e,o),s=Qn.interpolationFactor(this.interpolation,o,e[i],e[i+1]),a=n[i].evaluate(t),l=n[i+1].evaluate(t);return"interpolate"===this.operator?Mn[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?Zn.reverse(Zn.interpolate(Zn.forward(a),Zn.forward(l),s)):Kn.reverse(Kn.interpolate(Kn.forward(a),Kn.forward(l),s))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e}}function $n(t,e,n,o){const r=o-n,i=t-n;return 0===r?0:1===e?i/r:(Math.pow(e,i)-1)/(Math.pow(e,r)-1)}var to=Qn;class eo{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const o=e.expectedType;o&&"value"!==o.kind&&(n=o);const r=[];for(const s of t.slice(1)){const t=e.parse(s,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}const i=o&&r.some((t=>we(o,t.type)));return new eo(i?fe:n,r)}evaluate(t){let e,n=null,o=0;for(const r of this.args){if(o++,n=r.evaluate(t),n&&n instanceof Ne&&!n.available&&(e||(e=n),n=null,o===this.args.length))return e;if(null!==n)break}return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize())})),t}}var no=eo;class oo{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));const n=[];for(let r=1;r<t.length-1;r+=2){const o=t[r];if("string"!=typeof o)return e.error("Expected string, but found ".concat(typeof o," instead."),r);if(/[^a-zA-Z0-9_]/.test(o))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const i=e.parse(t[r+1],r+1);if(!i)return null;n.push([o,i])}const o=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return o?new oo(n,o):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}var ro=oo;class io{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,ue),o=e.parse(t[2],2,ve(e.expectedType||fe));return n&&o?new io(o.type.itemType,n,o):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new je("Array index out of bounds: ".concat(e," < 0."));if(e>=n.length)throw new je("Array index out of bounds: ".concat(e," > ").concat(n.length-1,"."));if(e!==Math.floor(e))throw new je("Array index must be an integer, but found ".concat(e," instead."));return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var so=io;class ao{constructor(t,e){this.type=pe,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,fe),o=e.parse(t[2],2,fe);return n&&o?be(n.type,[pe,ce,ue,le,fe])?new ao(n,o):e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(n.type)," instead")):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(null==n)return!1;if(!xe(e,["boolean","string","number","null"]))throw new je("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(Ge(e))," instead."));if(!xe(n,["string","array"]))throw new je("Expected second argument to be of type array or string, but found ".concat(_e(Ge(n))," instead."));return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var lo=ao;class uo{constructor(t,e,n){this.type=ue,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,fe),o=e.parse(t[2],2,fe);if(!n||!o)return null;if(!be(n.type,[pe,ce,ue,le,fe]))return e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(n.type)," instead"));if(4===t.length){const r=e.parse(t[3],3,ue);return r?new uo(n,o,r):null}return new uo(n,o)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!xe(e,["boolean","string","number","null"]))throw new je("Expected first argument to be of type boolean, string, number or null, but found ".concat(_e(Ge(e))," instead."));if(!xe(n,["string","array"]))throw new je("Expected second argument to be of type array or string, but found ".concat(_e(Ge(n))," instead."));if(this.fromIndex){const o=this.fromIndex.evaluate(t);return n.indexOf(e,o)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var co=uo;class po{constructor(t,e,n,o,r,i){this.inputType=t,this.type=e,this.input=n,this.cases=o,this.outputs=r,this.otherwise=i}static parse(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,o;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType);const r={},i=[];for(let l=2;l<t.length-1;l+=2){let s=t[l];const a=t[l+1];Array.isArray(s)||(s=[s]);const u=e.concat(l);if(0===s.length)return u.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,Ge(t)))return null}else n=Ge(t);if(void 0!==r[String(t)])return u.error("Branch labels must be unique.");r[String(t)]=i.length}const c=e.parse(a,l,o);if(!c)return null;o=o||c.type,i.push(c)}const s=e.parse(t[1],1,fe);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,o);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(n,s.type)?null:new po(n,o,s,r,i,a):null}evaluate(t){const e=this.input.evaluate(t);return(Ge(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],o={};for(const i of e){const t=o[this.cases[i]];void 0===t?(o[this.cases[i]]=n.length,n.push([this.cases[i],[i]])):n[t][1].push(i)}const r=t=>"number"===this.inputType.kind?Number(t):t;for(const[i,s]of n)t.push(1===s.length?r(s[0]):s.map(r)),t.push(this.outputs[i].serialize());return t.push(this.otherwise.serialize()),t}}var ho=po;class fo{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const o=[];for(let i=1;i<t.length-1;i+=2){const r=e.parse(t[i],i,pe);if(!r)return null;const s=e.parse(t[i+1],i+1,n);if(!s)return null;o.push([r,s]),n=n||s.type}const r=e.parse(t[t.length-1],t.length-1,n);return r?new fo(n,o,r):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((t=>{let[e,n]=t;return n.outputDefined()}))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize())})),t}}var go=fo;class mo{constructor(t,e,n,o){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=o}static parse(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,fe),o=e.parse(t[2],2,ue);if(!n||!o)return null;if(!be(n.type,[ve(fe),ce,fe]))return e.error("Expected first argument to be of type array or string, but found ".concat(_e(n.type)," instead"));if(4===t.length){const r=e.parse(t[3],3,ue);return r?new mo(n.type,n,o,r):null}return new mo(n.type,n,o)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!xe(e,["string","array"]))throw new je("Expected first argument to be of type array or string, but found ".concat(_e(Ge(e))," instead."));if(this.endIndex){const o=this.endIndex.evaluate(t);return e.slice(n,o)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var yo=mo;function vo(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function _o(t,e,n,o){return 0===o.compare(e,n)}function Co(t,e,n){const o="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=pe,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let i=e.parse(t[1],1,fe);if(!i)return null;if(!vo(n,i.type))return e.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(_e(i.type),"'."));let s=e.parse(t[2],2,fe);if(!s)return null;if(!vo(n,s.type))return e.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(_e(s.type),"'."));if(i.type.kind!==s.type.kind&&"value"!==i.type.kind&&"value"!==s.type.kind)return e.error("Cannot compare types '".concat(_e(i.type),"' and '").concat(_e(s.type),"'."));o&&("value"===i.type.kind&&"value"!==s.type.kind?i=new We(s.type,[i]):"value"!==i.type.kind&&"value"===s.type.kind&&(s=new We(i.type,[s])));let a=null;if(4===t.length){if("string"!==i.type.kind&&"string"!==s.type.kind&&"value"!==i.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,ge),!a)return null}return new r(i,s,a)}evaluate(r){const i=this.lhs.evaluate(r),s=this.rhs.evaluate(r);if(o&&this.hasUntypedArgument){const e=Ge(i),n=Ge(s);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new je('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(e.kind,", ").concat(n.kind,") instead."))}if(this.collator&&!o&&this.hasUntypedArgument){const t=Ge(i),n=Ge(s);if("string"!==t.kind||"string"!==n.kind)return e(r,i,s)}return this.collator?n(r,i,s,this.collator.evaluate(r)):e(r,i,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize())})),e}}}const wo=Co("==",(function(t,e,n){return e===n}),_o),bo=Co("!=",(function(t,e,n){return e!==n}),(function(t,e,n,o){return!_o(0,e,n,o)})),xo=Co("<",(function(t,e,n){return e<n}),(function(t,e,n,o){return o.compare(e,n)<0})),Eo=Co(">",(function(t,e,n){return e>n}),(function(t,e,n,o){return o.compare(e,n)>0})),So=Co("<=",(function(t,e,n){return e<=n}),(function(t,e,n,o){return o.compare(e,n)<=0})),To=Co(">=",(function(t,e,n){return e>=n}),(function(t,e,n,o){return o.compare(e,n)>=0}));class Ro{constructor(t,e,n,o,r,i){this.type=ce,this.number=t,this.locale=e,this.currency=n,this.unit=o,this.minFractionDigits=r,this.maxFractionDigits=i}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ue);if(!n)return null;const o=t[2];if("object"!=typeof o||Array.isArray(o))return e.error("NumberFormat options argument must be an object.");let r=null;if(o.locale&&(r=e.parse(o.locale,1,ce),!r))return null;let i=null;if(o.currency&&(i=e.parse(o.currency,1,ce),!i))return null;let s=null;if(o.unit&&(s=e.parse(o.unit,1,ce),!s))return null;let a=null;if(o["min-fraction-digits"]&&(a=e.parse(o["min-fraction-digits"],1,ue),!a))return null;let l=null;return o["max-fraction-digits"]&&(l=e.parse(o["max-fraction-digits"],1,ue),!l)?null:new Ro(n,r,i,s,a,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Oo{constructor(t){this.type=ue,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found ".concat(_e(n.type)," instead.")):new Oo(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new je("Expected value to be of type string or array, but found ".concat(_e(Ge(e))," instead."))}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize())})),t}}const Po={"==":wo,"!=":bo,">":Eo,"<":xo,">=":To,"<=":So,array:We,at:so,boolean:We,case:go,coalesce:no,collator:en,format:qe,image:Xe,in:lo,"index-of":co,interpolate:to,"interpolate-hcl":to,"interpolate-lab":to,length:Oo,let:ro,literal:ze,match:ho,number:We,"number-format":Ro,object:We,slice:yo,step:An,string:We,"to-boolean":Ze,"to-color":Ze,"to-number":Ze,"to-string":Ze,var:Sn,within:Cn};function Io(t,e){let[n,o,r,i]=e;n=n.evaluate(t),o=o.evaluate(t),r=r.evaluate(t);const s=i?i.evaluate(t):1,a=Fe(n,o,r,s);if(a)throw new je(a);return new Ae(n/255*s,o/255*s,r/255*s,s)}function Ao(t,e){return t in e}function Do(t,e){const n=e[t];return void 0===n?null:n}function Mo(t){return{type:t}}tn.register(Po,{error:[{kind:"error"},[ce],(t,e)=>{let[n]=e;throw new je(n.evaluate(t))}],typeof:[ce,[fe],(t,e)=>{let[n]=e;return _e(Ge(n.evaluate(t)))}],"to-rgba":[ve(ue,4),[he],(t,e)=>{let[n]=e;return n.evaluate(t).toArray()}],rgb:[he,[ue,ue,ue],Io],rgba:[he,[ue,ue,ue,ue],Io],has:{type:pe,overloads:[[[ce],(t,e)=>{let[n]=e;return Ao(n.evaluate(t),t.properties())}],[[ce,de],(t,e)=>{let[n,o]=e;return Ao(n.evaluate(t),o.evaluate(t))}]]},get:{type:fe,overloads:[[[ce],(t,e)=>{let[n]=e;return Do(n.evaluate(t),t.properties())}],[[ce,de],(t,e)=>{let[n,o]=e;return Do(n.evaluate(t),o.evaluate(t))}]]},"feature-state":[fe,[ce],(t,e)=>{let[n]=e;return Do(n.evaluate(t),t.featureState||{})}],properties:[de,[],t=>t.properties()],"geometry-type":[ce,[],t=>t.geometryType()],id:[fe,[],t=>t.id()],zoom:[ue,[],t=>t.globals.zoom],pitch:[ue,[],t=>t.globals.pitch||0],"distance-from-center":[ue,[],t=>t.distanceFromCenter()],"heatmap-density":[ue,[],t=>t.globals.heatmapDensity||0],"line-progress":[ue,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[ue,[],t=>t.globals.skyRadialProgress||0],accumulated:[fe,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[ue,Mo(ue),(t,e)=>{let n=0;for(const o of e)n+=o.evaluate(t);return n}],"*":[ue,Mo(ue),(t,e)=>{let n=1;for(const o of e)n*=o.evaluate(t);return n}],"-":{type:ue,overloads:[[[ue,ue],(t,e)=>{let[n,o]=e;return n.evaluate(t)-o.evaluate(t)}],[[ue],(t,e)=>{let[n]=e;return-n.evaluate(t)}]]},"/":[ue,[ue,ue],(t,e)=>{let[n,o]=e;return n.evaluate(t)/o.evaluate(t)}],"%":[ue,[ue,ue],(t,e)=>{let[n,o]=e;return n.evaluate(t)%o.evaluate(t)}],ln2:[ue,[],()=>Math.LN2],pi:[ue,[],()=>Math.PI],e:[ue,[],()=>Math.E],"^":[ue,[ue,ue],(t,e)=>{let[n,o]=e;return Math.pow(n.evaluate(t),o.evaluate(t))}],sqrt:[ue,[ue],(t,e)=>{let[n]=e;return Math.sqrt(n.evaluate(t))}],log10:[ue,[ue],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))/Math.LN10}],ln:[ue,[ue],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))}],log2:[ue,[ue],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))/Math.LN2}],sin:[ue,[ue],(t,e)=>{let[n]=e;return Math.sin(n.evaluate(t))}],cos:[ue,[ue],(t,e)=>{let[n]=e;return Math.cos(n.evaluate(t))}],tan:[ue,[ue],(t,e)=>{let[n]=e;return Math.tan(n.evaluate(t))}],asin:[ue,[ue],(t,e)=>{let[n]=e;return Math.asin(n.evaluate(t))}],acos:[ue,[ue],(t,e)=>{let[n]=e;return Math.acos(n.evaluate(t))}],atan:[ue,[ue],(t,e)=>{let[n]=e;return Math.atan(n.evaluate(t))}],min:[ue,Mo(ue),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[ue,Mo(ue),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[ue,[ue],(t,e)=>{let[n]=e;return Math.abs(n.evaluate(t))}],round:[ue,[ue],(t,e)=>{let[n]=e;const o=n.evaluate(t);return o<0?-Math.round(-o):Math.round(o)}],floor:[ue,[ue],(t,e)=>{let[n]=e;return Math.floor(n.evaluate(t))}],ceil:[ue,[ue],(t,e)=>{let[n]=e;return Math.ceil(n.evaluate(t))}],"filter-==":[pe,[ce,fe],(t,e)=>{let[n,o]=e;return t.properties()[n.value]===o.value}],"filter-id-==":[pe,[fe],(t,e)=>{let[n]=e;return t.id()===n.value}],"filter-type-==":[pe,[ce],(t,e)=>{let[n]=e;return t.geometryType()===n.value}],"filter-<":[pe,[ce,fe],(t,e)=>{let[n,o]=e;const r=t.properties()[n.value],i=o.value;return typeof r==typeof i&&r<i}],"filter-id-<":[pe,[fe],(t,e)=>{let[n]=e;const o=t.id(),r=n.value;return typeof o==typeof r&&o<r}],"filter->":[pe,[ce,fe],(t,e)=>{let[n,o]=e;const r=t.properties()[n.value],i=o.value;return typeof r==typeof i&&r>i}],"filter-id->":[pe,[fe],(t,e)=>{let[n]=e;const o=t.id(),r=n.value;return typeof o==typeof r&&o>r}],"filter-<=":[pe,[ce,fe],(t,e)=>{let[n,o]=e;const r=t.properties()[n.value],i=o.value;return typeof r==typeof i&&r<=i}],"filter-id-<=":[pe,[fe],(t,e)=>{let[n]=e;const o=t.id(),r=n.value;return typeof o==typeof r&&o<=r}],"filter->=":[pe,[ce,fe],(t,e)=>{let[n,o]=e;const r=t.properties()[n.value],i=o.value;return typeof r==typeof i&&r>=i}],"filter-id->=":[pe,[fe],(t,e)=>{let[n]=e;const o=t.id(),r=n.value;return typeof o==typeof r&&o>=r}],"filter-has":[pe,[fe],(t,e)=>{let[n]=e;return n.value in t.properties()}],"filter-has-id":[pe,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[pe,[ve(ce)],(t,e)=>{let[n]=e;return n.value.indexOf(t.geometryType())>=0}],"filter-id-in":[pe,[ve(fe)],(t,e)=>{let[n]=e;return n.value.indexOf(t.id())>=0}],"filter-in-small":[pe,[ce,ve(fe)],(t,e)=>{let[n,o]=e;return o.value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[pe,[ce,ve(fe)],(t,e)=>{let[n,o]=e;return function(t,e,n,o){for(;n<=o;){const r=n+o>>1;if(e[r]===t)return!0;e[r]>t?o=r-1:n=r+1}return!1}(t.properties()[n.value],o.value,0,o.value.length-1)}],all:{type:pe,overloads:[[[pe,pe],(t,e)=>{let[n,o]=e;return n.evaluate(t)&&o.evaluate(t)}],[Mo(pe),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:pe,overloads:[[[pe,pe],(t,e)=>{let[n,o]=e;return n.evaluate(t)||o.evaluate(t)}],[Mo(pe),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[pe,[pe],(t,e)=>{let[n]=e;return!n.evaluate(t)}],"is-supported-script":[pe,[ce],(t,e)=>{let[n]=e;const o=t.globals&&t.globals.isSupportedScript;return!o||o(n.evaluate(t))}],upcase:[ce,[ce],(t,e)=>{let[n]=e;return n.evaluate(t).toUpperCase()}],downcase:[ce,[ce],(t,e)=>{let[n]=e;return n.evaluate(t).toLowerCase()}],concat:[ce,Mo(fe),(t,e)=>e.map((e=>Be(e.evaluate(t)))).join("")],"resolved-locale":[ce,[ge],(t,e)=>{let[n]=e;return n.evaluate(t).resolvedLocale()}]});var Lo=Po;function No(t){return{result:"success",value:t}}function Fo(t){return{result:"error",value:t}}function ko(t){return"data-driven"===t["property-type"]}function Go(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Bo(t){return!!t.expression&&t.expression.interpolated}function Vo(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function zo(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function jo(t){return t}function Ho(t,e){const n="color"===e.type,o=t.stops&&"object"==typeof t.stops[0][0],r=o||!(o||void 0!==t.property),i=t.type||(Bo(e)?"exponential":"interval");if(n&&((t=ee({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],Ae.parse(t[1])]))),t.default=Ae.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!Jn[t.colorSpace])throw new Error("Unknown color space: ".concat(t.colorSpace));let s,a,l;if("exponential"===i)s=Xo;else if("interval"===i)s=qo;else if("categorical"===i){s=Wo,a=Object.create(null);for(const e of t.stops)a[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==i)throw new Error('Unknown function type "'.concat(i,'"'));s=Yo}if(o){const n={},o=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],i=r[0].zoom;void 0===n[i]&&(n[i]={zoom:i,type:t.type,property:t.property,default:t.default,stops:[]},o.push(i)),n[i].stops.push([r[0].value,r[1]])}const r=[];for(const t of o)r.push([n[t].zoom,Ho(n[t],e)]);const i={name:"linear"};return{kind:"composite",interpolationType:i,interpolationFactor:to.interpolationFactor.bind(void 0,i),zoomStops:r.map((t=>t[0])),evaluate:(n,o)=>{let{zoom:i}=n;return Xo({stops:r,base:t.base},e,i).evaluate(i,o)}}}if(r){const n="exponential"===i?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:to.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map((t=>t[0])),evaluate:n=>{let{zoom:o}=n;return s(t,e,o,a,l)}}}return{kind:"source",evaluate(n,o){const r=o&&o.properties?o.properties[t.property]:void 0;return void 0===r?Uo(t.default,e.default):s(t,e,r,a,l)}}}function Uo(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Wo(t,e,n,o,r){return Uo(typeof n===r?o[n]:void 0,t.default,e.default)}function qo(t,e,n){if("number"!==Vo(n))return Uo(t.default,e.default);const o=t.stops.length;if(1===o)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[o-1][0])return t.stops[o-1][1];const r=Pn(t.stops.map((t=>t[0])),n);return t.stops[r][1]}function Xo(t,e,n){const o=void 0!==t.base?t.base:1;if("number"!==Vo(n))return Uo(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const i=Pn(t.stops.map((t=>t[0])),n),s=function(t,e,n,o){const r=o-n,i=t-n;return 0===r?0:1===e?i/r:(Math.pow(e,i)-1)/(Math.pow(e,r)-1)}(n,o,t.stops[i][0],t.stops[i+1][0]),a=t.stops[i][1],l=t.stops[i+1][1];let u=Mn[e.type]||jo;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=Jn[t.colorSpace];u=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),s))}return"function"==typeof a.evaluate?{evaluate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const o=a.evaluate.apply(void 0,e),r=l.evaluate.apply(void 0,e);if(void 0!==o&&void 0!==r)return u(o,r,s)}}:u(a,l,s)}function Yo(t,e,n){return"color"===e.type?n=Ae.parse(n):"formatted"===e.type?n=Le.fromString(n.toString()):"resolvedImage"===e.type?n=Ne.fromString(n.toString()):Vo(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Uo(n,t.default,e.default)}class Ko{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Qe,this._defaultValue=e?function(t){return"color"===t.type&&(zo(t.default)||Array.isArray(t.default))?new Ae(0,0,0,0):"color"===t.type?Ae.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,o,r,i,s,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=o||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=i,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,o,r,i,s,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=o||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=i||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new je("Expected value to be one of ".concat(Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", "),", but found ").concat(JSON.stringify(t)," instead."));return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function Zo(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Lo}function Jo(t,e){const n=new Rn(Lo,[],e?function(t){const e={color:he,string:ce,number:ue,enum:ce,boolean:pe,formatted:me,resolvedImage:ye};return"array"===t.type?ve(e[t.value]||fe,t.length):e[t.type]}(e):void 0),o=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return o?No(new Ko(o,e)):Fo(n.errors)}class Qo{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!bn(e.expression)}evaluateWithoutErrorHandling(t,e,n,o,r,i){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,o,r,i)}evaluate(t,e,n,o,r,i){return this._styleExpression.evaluate(t,e,n,o,r,i)}}class $o{constructor(t,e,n,o){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!bn(e.expression),this.interpolationType=o}evaluateWithoutErrorHandling(t,e,n,o,r,i){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,o,r,i)}evaluate(t,e,n,o,r,i){return this._styleExpression.evaluate(t,e,n,o,r,i)}interpolationFactor(t,e,n){return this.interpolationType?to.interpolationFactor(this.interpolationType,t,e,n):0}}function tr(t,e){if("error"===(t=Jo(t,e)).result)return t;const n=t.value.expression,o=wn(n);if(!o&&!ko(e))return Fo([new ie("","data expressions not supported")]);const r=xn(n,["zoom","pitch","distance-from-center"]);if(!r&&!Go(e))return Fo([new ie("","zoom expressions not supported")]);const i=nr(n);return i||r?i instanceof ie?Fo([i]):i instanceof to&&!Bo(e)?Fo([new ie("",'"interpolate" expressions cannot be used with this property')]):No(i?new $o(o?"camera":"composite",t.value,i.labels,i instanceof to?i.interpolation:void 0):new Qo(o?"constant":"source",t.value)):Fo([new ie("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class er{constructor(t,e){this._parameters=t,this._specification=e,ee(this,Ho(this._parameters,this._specification))}static deserialize(t){return new er(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function nr(t){let e=null;if(t instanceof ro)e=nr(t.result);else if(t instanceof no){for(const n of t.args)if(e=nr(n),e)break}else(t instanceof An||t instanceof to)&&t.input instanceof tn&&"zoom"===t.input.name&&(e=t);return e instanceof ie||t.eachChild((t=>{const n=nr(t);n instanceof ie?e=n:!e&&n?e=new ie("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new ie("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}class or{constructor(t,e,n,o){this.message=(t?"".concat(t,": "):"")+n,o&&(this.identifier=o),null!=e&&e.__line__&&(this.line=e.__line__)}}function rr(t){const e=t.key,n=t.value,o=t.valueSpec||{},r=t.objectElementValidators||{},i=t.style,s=t.styleSpec;let a=[];const l=Vo(n);if("object"!==l)return[new or(e,n,"object expected, ".concat(l," found"))];for(const u in n){const t=u.split(".")[0];let l;r[t]?l=r[t]:o[t]?l=Gr:r["*"]?l=r["*"]:o["*"]&&(l=Gr),l?a=a.concat(l({key:(e?"".concat(e,"."):e)+u,value:n[u],valueSpec:o[t]||o["*"],style:i,styleSpec:s,object:n,objectKey:u},n)):a.push(new or(e,n[u],'unknown property "'.concat(u,'"')))}for(const u in o)r[u]||o[u].required&&void 0===o[u].default&&void 0===n[u]&&a.push(new or(e,n,'missing required property "'.concat(u,'"')));return a}function ir(t){const e=t.value,n=t.valueSpec,o=t.style,r=t.styleSpec,i=t.key,s=t.arrayElementValidator||Gr;if("array"!==Vo(e))return[new or(i,e,"array expected, ".concat(Vo(e)," found"))];if(n.length&&e.length!==n.length)return[new or(i,e,"array length ".concat(n.length," expected, length ").concat(e.length," found"))];if(n["min-length"]&&e.length<n["min-length"])return[new or(i,e,"array length at least ".concat(n["min-length"]," expected, length ").concat(e.length," found"))];let a={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};r.$version<7&&(a.function=n.function),"object"===Vo(n.value)&&(a=n.value);let l=[];for(let u=0;u<e.length;u++)l=l.concat(s({array:e,arrayIndex:u,value:e[u],valueSpec:a,style:o,styleSpec:r,key:"".concat(i,"[").concat(u,"]")}));return l}function sr(t){const e=t.key,n=t.value,o=t.valueSpec;let r=Vo(n);if("number"===r&&n!=n&&(r="NaN"),"number"!==r)return[new or(e,n,"number expected, ".concat(r," found"))];if("minimum"in o){let r=o.minimum;if("array"===Vo(o.minimum)&&(r=o.minimum[t.arrayIndex]),n<r)return[new or(e,n,"".concat(n," is less than the minimum value ").concat(r))]}if("maximum"in o){let r=o.maximum;if("array"===Vo(o.maximum)&&(r=o.maximum[t.arrayIndex]),n>r)return[new or(e,n,"".concat(n," is greater than the maximum value ").concat(r))]}return[]}function ar(t){const e=t.valueSpec,n=ne(t.value.type);let o,r,i,s={};const a="categorical"!==n&&void 0===t.value.property,l=!a,u="array"===Vo(t.value.stops)&&"array"===Vo(t.value.stops[0])&&"object"===Vo(t.value.stops[0][0]),c=rr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new or(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const o=t.value;return e=e.concat(ir({key:t.key,value:o,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===Vo(o)&&0===o.length&&e.push(new or(t.key,o,"array must have at least one stop")),e},default:function(t){return Gr({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&a&&c.push(new or(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||c.push(new or(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Bo(t.valueSpec)&&c.push(new or(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!ko(t.valueSpec)?c.push(new or(t.key,t.value,"property functions not supported")):a&&!Go(t.valueSpec)&&c.push(new or(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!u||void 0!==t.value.property||c.push(new or(t.key,t.value,'"property" property is required')),c;function p(t){let n=[];const o=t.value,a=t.key;if("array"!==Vo(o))return[new or(a,o,"array expected, ".concat(Vo(o)," found"))];if(2!==o.length)return[new or(a,o,"array length 2 expected, length ".concat(o.length," found"))];if(u){if("object"!==Vo(o[0]))return[new or(a,o,"object expected, ".concat(Vo(o[0])," found"))];if(void 0===o[0].zoom)return[new or(a,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new or(a,o,"object stop key must have value")];const e=ne(o[0].zoom);if("number"!=typeof e)return[new or(a,o[0].zoom,"stop zoom values must be numbers")];if(i&&i>e)return[new or(a,o[0].zoom,"stop zoom values must appear in ascending order")];e!==i&&(i=e,r=void 0,s={}),n=n.concat(rr({key:"".concat(a,"[0]"),value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:sr,value:h}}))}else n=n.concat(h({key:"".concat(a,"[0]"),value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return Zo(oe(o[1]))?n.concat([new or("".concat(a,"[1]"),o[1],"expressions are not allowed in function stops.")]):n.concat(Gr({key:"".concat(a,"[1]"),value:o[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function h(t,i){const a=Vo(t.value),l=ne(t.value),u=null!==t.value?t.value:i;if(o){if(a!==o)return[new or(t.key,u,"".concat(a," stop domain type must match previous stop domain type ").concat(o))]}else o=a;if("number"!==a&&"string"!==a&&"boolean"!==a&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new or(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==n){let o="number expected, ".concat(a," found");return ko(e)&&void 0===n&&(o+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new or(t.key,u,o)]}return"categorical"!==n||"number"!==a||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===a&&"number"==typeof l&&"number"==typeof r&&void 0!==r&&l<r?[new or(t.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in s?[new or(t.key,u,"stop domain values must be unique")]:(s[l]=!0,[])):[new or(t.key,u,"integer expected, found ".concat(String(l)))]}}function lr(t){const e=("property"===t.expressionContext?tr:Jo)(oe(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new or("".concat(t.key).concat(e.key),t.value,e.message)));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new or(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===t.expressionContext&&"layout"===t.propertyType&&!bn(n))return[new or(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return ur(n,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!xn(n,["zoom","feature-state"]))return[new or(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!wn(n))return[new or(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ur(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const r of e.valueSpec.expression.parameters)n.delete(r);if(0===n.size)return[];const o=[];return t instanceof tn&&n.has(t.name)?[new or(e.key,e.value,'["'.concat(t.name,'"] expression is not supported in a filter for a ').concat(e.object.type," layer with id: ").concat(e.object.id))]:(t.eachChild((t=>{o.push(...ur(t,e))})),o)}function cr(t){const e=t.key,n=t.value,o=t.valueSpec,r=[];return Array.isArray(o.values)?-1===o.values.indexOf(ne(n))&&r.push(new or(e,n,"expected one of [".concat(o.values.join(", "),"], ").concat(JSON.stringify(n)," found"))):-1===Object.keys(o.values).indexOf(ne(n))&&r.push(new or(e,n,"expected one of [".concat(Object.keys(o.values).join(", "),"], ").concat(JSON.stringify(n)," found"))),r}function pr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!pr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function hr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill";if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};pr(t)||(t=_r(t));const n=t;let o=!0;try{o=function(t){if(!gr(t))return t;let e=oe(t);return fr(e),e=dr(e),e}(n)}catch(t){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(n,null,2),"\n        "))}const r=te["filter_".concat(e)],i=Jo(o,r);let s=null;if("error"===i.result)throw new Error(i.value.map((t=>"".concat(t.key,": ").concat(t.message))).join(", "));s=(t,e,n)=>i.value.evaluate(t,e,{},n);let a=null,l=null;if(o!==n){const t=Jo(n,r);if("error"===t.result)throw new Error(t.value.map((t=>"".concat(t.key,": ").concat(t.message))).join(", "));a=(e,n,o,r,i)=>t.value.evaluate(e,n,{},o,void 0,void 0,r,i),l=!wn(t.value.expression)}return{filter:s,dynamicFilter:a||void 0,needGeometry:vr(o),needFeature:!!l}}function dr(t){if(!Array.isArray(t))return t;const e=function(t){if(mr.has(t[0]))for(let e=1;e<t.length;e++)if(gr(t[e]))return!0;return t}(t);return!0===e?e:e.map((t=>dr(t)))}function fr(t){let e=!1;const n=[];if("case"===t[0]){for(let o=1;o<t.length-1;o+=2)e=e||gr(t[o]),n.push(t[o+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||gr(t[1]);for(let e=2;e<t.length-1;e+=2)n.push(t[e+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||gr(t[1]);for(let e=1;e<t.length-1;e+=2)n.push(t[e+1])}e&&(t.length=0,t.push("any",...n));for(let o=1;o<t.length;o++)fr(t[o])}function gr(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let n=1;n<t.length;n++)if(gr(t[n]))return!0;return!1}const mr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function yr(t,e){return t<e?-1:t>e?1:0}function vr(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(vr(t[e]))return!0;return!1}function _r(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Cr(t[1],t[2],"=="):"!="===e?xr(Cr(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Cr(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(_r))):"all"===e?["all"].concat(t.slice(1).map(_r)):"none"===e?["all"].concat(t.slice(1).map(_r).map(xr)):"in"===e?wr(t[1],t.slice(2)):"!in"===e?xr(wr(t[1],t.slice(2))):"has"===e?br(t[1]):"!has"===e?xr(br(t[1])):"within"!==e||t;var n}function Cr(t,e,n){switch(t){case"$type":return["filter-type-".concat(n),e];case"$id":return["filter-id-".concat(n),e];default:return["filter-".concat(n),t,e]}}function wr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(yr)]]:["filter-in-small",t,["literal",e]]}}function br(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function xr(t){return["!",t]}function Er(t){return pr(oe(t.value))?lr(ee({},t,{expressionContext:"filter",valueSpec:t.styleSpec["filter_".concat(t.layerType||"fill")]})):Sr(t)}function Sr(t){const e=t.value,n=t.key;if("array"!==Vo(e))return[new or(n,e,"array expected, ".concat(Vo(e)," found"))];const o=t.styleSpec;let r,i=[];if(e.length<1)return[new or(n,e,"filter array must have at least 1 element")];switch(i=i.concat(cr({key:"".concat(n,"[0]"),value:e[0],valueSpec:o.filter_operator,style:t.style,styleSpec:t.styleSpec})),ne(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===ne(e[1])&&i.push(new or(n,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":3!==e.length&&i.push(new or(n,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(r=Vo(e[1]),"string"!==r&&i.push(new or("".concat(n,"[1]"),e[1],"string expected, ".concat(r," found"))));for(let s=2;s<e.length;s++)r=Vo(e[s]),"$type"===ne(e[1])?i=i.concat(cr({key:"".concat(n,"[").concat(s,"]"),value:e[s],valueSpec:o.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&i.push(new or("".concat(n,"[").concat(s,"]"),e[s],"string, number, or boolean expected, ".concat(r," found")));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)i=i.concat(Sr({key:"".concat(n,"[").concat(o,"]"),value:e[o],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=Vo(e[1]),2!==e.length?i.push(new or(n,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):"string"!==r&&i.push(new or("".concat(n,"[1]"),e[1],"string expected, ".concat(r," found")));break;case"within":r=Vo(e[1]),2!==e.length?i.push(new or(n,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):"object"!==r&&i.push(new or("".concat(n,"[1]"),e[1],"object expected, ".concat(r," found")))}return i}function Tr(t,e){const n=t.key,o=t.style,r=t.styleSpec,i=t.value,s=t.objectKey,a=r["".concat(e,"_").concat(t.layerType)];if(!a)return[];const l=s.match(/^(.*)-transition$/);if("paint"===e&&l&&a[l[1]]&&a[l[1]].transition)return Gr({key:n,value:i,valueSpec:r.transition,style:o,styleSpec:r});const u=t.valueSpec||a[s];if(!u)return[new or(n,i,'unknown property "'.concat(s,'"'))];let c;if("string"===Vo(i)&&ko(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(i))){const t='`{ "type": "identity", "property": '.concat(c?JSON.stringify(c[1]):'"_"'," }`");return[new or(n,i,'"'.concat(s,'" does not support interpolation syntax\nUse an identity property function instead: ').concat(t,"."))]}const p=[];return"symbol"===t.layerType&&("text-field"===s&&o&&!o.glyphs&&p.push(new or(n,i,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&zo(oe(i))&&"identity"===ne(i.type)&&p.push(new or(n,i,'"text-font" does not support identity functions'))),p.concat(Gr({key:t.key,value:i,valueSpec:u,style:o,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:s}))}function Rr(t){return Tr(t,"paint")}function Or(t){return Tr(t,"layout")}function Pr(t){let e=[];const n=t.value,o=t.key,r=t.style,i=t.styleSpec;n.type||n.ref||e.push(new or(o,n,'either "type" or "ref" is required'));let s=ne(n.type);const a=ne(n.ref);if(n.id){const i=ne(n.id);for(let s=0;s<t.arrayIndex;s++){const t=r.layers[s];ne(t.id)===i&&e.push(new or(o,n.id,'duplicate layer id "'.concat(n.id,'", previously used at line ').concat(t.id.__line__)))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in n&&e.push(new or(o,n[t],'"'.concat(t,'" is prohibited for ref layers')))})),r.layers.forEach((e=>{ne(e.id)===a&&(t=e)})),t?t.ref?e.push(new or(o,n.ref,"ref cannot reference another ref layer")):s=ne(t.type):"string"==typeof a&&e.push(new or(o,n.ref,'ref layer "'.concat(a,'" not found')))}else if("background"!==s&&"sky"!==s)if(n.source){const t=r.sources&&r.sources[n.source],i=t&&ne(t.type);t?"vector"===i&&"raster"===s?e.push(new or(o,n.source,'layer "'.concat(n.id,'" requires a raster source'))):"raster"===i&&"raster"!==s?e.push(new or(o,n.source,'layer "'.concat(n.id,'" requires a vector source'))):"vector"!==i||n["source-layer"]?"raster-dem"===i&&"hillshade"!==s?e.push(new or(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===i&&t.lineMetrics||e.push(new or(o,n,'layer "'.concat(n.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new or(o,n,'layer "'.concat(n.id,'" must specify a "source-layer"'))):e.push(new or(o,n.source,'source "'.concat(n.source,'" not found')))}else e.push(new or(o,n,'missing required property "source"'));return e=e.concat(rr({key:o,value:n,valueSpec:i.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Gr({key:"".concat(o,".type"),value:n.type,valueSpec:i.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:t=>Er(ee({layerType:s},t)),layout:t=>rr({layer:n,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Or(ee({layerType:s},t))}}),paint:t=>rr({layer:n,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Rr(ee({layerType:s},t))}})}})),e}function Ir(t){const e=t.value,n=t.key,o=Vo(e);return"string"!==o?[new or(n,e,"string expected, ".concat(o," found"))]:[]}const Ar={promoteId:function(t){let{key:e,value:n}=t;if("string"===Vo(n))return Ir({key:e,value:n});{const t=[];for(const o in n)t.push(...Ir({key:"".concat(e,".").concat(o),value:n[o]}));return t}}};function Dr(t){const e=t.value,n=t.key,o=t.styleSpec,r=t.style;if(!e.type)return[new or(n,e,'"type" is required')];const i=ne(e.type);let s;switch(i){case"vector":case"raster":case"raster-dem":return s=rr({key:n,value:e,valueSpec:o["source_".concat(i.replace("-","_"))],style:t.style,styleSpec:o,objectElementValidators:Ar}),s;case"geojson":if(s=rr({key:n,value:e,valueSpec:o.source_geojson,style:r,styleSpec:o,objectElementValidators:Ar}),e.cluster)for(const t in e.clusterProperties){const[o,r]=e.clusterProperties[t],i="string"==typeof o?[o,["accumulated"],["get",t]]:o;s.push(...lr({key:"".concat(n,".").concat(t,".map"),value:r,expressionContext:"cluster-map"})),s.push(...lr({key:"".concat(n,".").concat(t,".reduce"),value:i,expressionContext:"cluster-reduce"}))}return s;case"video":return rr({key:n,value:e,valueSpec:o.source_video,style:r,styleSpec:o});case"image":return rr({key:n,value:e,valueSpec:o.source_image,style:r,styleSpec:o});case"canvas":return[new or(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cr({key:"".concat(n,".type"),value:e.type,valueSpec:{values:Mr(o)},style:r,styleSpec:o})}}function Mr(t){return t.source.reduce(((e,n)=>{const o=t[n];return"enum"===o.type.type&&(e=e.concat(Object.keys(o.type.values))),e}),[])}function Lr(t){const e=t.value,n=t.styleSpec,o=n.light,r=t.style;let i=[];const s=Vo(e);if(void 0===e)return i;if("object"!==s)return i=i.concat([new or("light",e,"object expected, ".concat(s," found"))]),i;for(const a in e){const t=a.match(/^(.*)-transition$/);i=i.concat(t&&o[t[1]]&&o[t[1]].transition?Gr({key:a,value:e[a],valueSpec:n.transition,style:r,styleSpec:n}):o[a]?Gr({key:a,value:e[a],valueSpec:o[a],style:r,styleSpec:n}):[new or(a,e[a],'unknown property "'.concat(a,'"'))])}return i}function Nr(t){const e=t.value,n=t.key,o=t.style,r=t.styleSpec,i=r.terrain;let s=[];const a=Vo(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new or("terrain",e,"object expected, ".concat(a," found"))]),s;for(const l in e){const t=l.match(/^(.*)-transition$/);s=s.concat(t&&i[t[1]]&&i[t[1]].transition?Gr({key:l,value:e[l],valueSpec:r.transition,style:o,styleSpec:r}):i[l]?Gr({key:l,value:e[l],valueSpec:i[l],style:o,styleSpec:r}):[new or(l,e[l],'unknown property "'.concat(l,'"'))])}if(e.source){const t=o.sources&&o.sources[e.source],r=t&&ne(t.type);t?"raster-dem"!==r&&s.push(new or(n,e.source,"terrain cannot be used with a source of type ".concat(String(r),', it only be used with a "raster-dem" source type'))):s.push(new or(n,e.source,'source "'.concat(e.source,'" not found')))}else s.push(new or(n,e,'terrain is missing required property "source"'));return s}function Fr(t){const e=t.value,n=t.style,o=t.styleSpec,r=o.fog;let i=[];const s=Vo(e);if(void 0===e)return i;if("object"!==s)return i=i.concat([new or("fog",e,"object expected, ".concat(s," found"))]),i;for(const a in e){const t=a.match(/^(.*)-transition$/);i=i.concat(t&&r[t[1]]&&r[t[1]].transition?Gr({key:a,value:e[a],valueSpec:o.transition,style:n,styleSpec:o}):r[a]?Gr({key:a,value:e[a],valueSpec:r[a],style:n,styleSpec:o}):[new or(a,e[a],'unknown property "'.concat(a,'"'))])}return i}const kr={"*":()=>[],array:ir,boolean:function(t){const e=t.value,n=t.key,o=Vo(e);return"boolean"!==o?[new or(n,e,"boolean expected, ".concat(o," found"))]:[]},number:sr,color:function(t){const e=t.key,n=t.value,o=Vo(n);return"string"!==o?[new or(e,n,"color expected, ".concat(o," found"))]:null===Ee(n)?[new or(e,n,'color expected, "'.concat(n,'" found'))]:[]},enum:cr,filter:Er,function:ar,layer:Pr,object:rr,source:Dr,light:Lr,terrain:Nr,fog:Fr,string:Ir,formatted:function(t){return 0===Ir(t).length?[]:lr(t)},resolvedImage:function(t){return 0===Ir(t).length?[]:lr(t)},projection:function(t){const e=t.value,n=t.styleSpec,o=n.projection,r=t.style;let i=[];const s=Vo(e);if("object"===s)for(const a in e)i=i.concat(Gr({key:a,value:e[a],valueSpec:o[a],style:r,styleSpec:n}));else"string"!==s&&(i=i.concat([new or("projection",e,"object or string expected, ".concat(s," found"))]));return i}};function Gr(t){const e=t.value,n=t.valueSpec,o=t.styleSpec;return n.expression&&zo(ne(e))?ar(t):n.expression&&Zo(oe(e))?lr(t):n.type&&kr[n.type]?kr[n.type](t):rr(ee({},t,{valueSpec:n.type?o[n.type]:n}))}function Br(t){const e=t.value,n=t.key,o=Ir(t);return o.length||(-1===e.indexOf("{fontstack}")&&o.push(new or(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&o.push(new or(n,e,'"glyphs" url must include a "{range}" token'))),o}function Vr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te;return Hr(Gr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Br,"*":()=>[]}}))}const zr=t=>Hr(Rr(t)),jr=t=>Hr(Or(t));function Hr(t){return t.slice().sort(((t,e)=>t.line&&e.line?t.line-e.line:0))}function Ur(t,e){let n=!1;if(e&&e.length)for(const o of e)t.fire(new Qt(new Error(o.message))),n=!0;return n}var Wr=Xr,qr=3;function Xr(t,e,n){var o=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(var i=0;i<this.d*this.d;i++){var s=r[qr+i],a=r[qr+i+1];o.push(s===a?null:r.subarray(s,a))}var l=r[qr+o.length+1];this.keys=r.subarray(r[qr+o.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var u=0;u<this.d*this.d;u++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var c=n/e*t;this.min=-c,this.max=t+c}Xr.prototype.insert=function(t,e,n,o,r){this._forEachCell(e,n,o,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(r)},Xr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xr.prototype._insertCell=function(t,e,n,o,r,i){this.cells[r].push(i)},Xr.prototype.query=function(t,e,n,o,r){var i=this.min,s=this.max;if(t<=i&&e<=i&&s<=n&&s<=o&&!r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,o,this._queryCell,a,{},r),a},Xr.prototype._queryCell=function(t,e,n,o,r,i,s,a){var l=this.cells[r];if(null!==l)for(var u=this.keys,c=this.bboxes,p=0;p<l.length;p++){var h=l[p];if(void 0===s[h]){var d=4*h;(a?a(c[d+0],c[d+1],c[d+2],c[d+3]):t<=c[d+2]&&e<=c[d+3]&&n>=c[d+0]&&o>=c[d+1])?(s[h]=!0,i.push(u[h])):s[h]=!1}}},Xr.prototype._forEachCell=function(t,e,n,o,r,i,s,a){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),p=this._convertToCellCoord(o),h=l;h<=c;h++)for(var d=u;d<=p;d++){var f=this.d*d+h;if((!a||a(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&r.call(this,t,e,n,o,f,i,s,a))return}},Xr.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Xr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Xr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=qr+this.cells.length+1+1,n=0,o=0;o<this.cells.length;o++)n+=this.cells[o].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var i=e,s=0;s<t.length;s++){var a=t[s];r[qr+s]=i,r.set(a,i),i+=a.length}return r[qr+t.length]=i,r.set(this.keys,i),r[qr+t.length+1]=i+=this.keys.length,r.set(this.bboxes,i),i+=this.bboxes.length,r.buffer};var Yr=h(Wr);const Kr={};function Zr(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Kr[e]={klass:t,omit:n.omit||[]}}Zr(Object,"Object"),Yr.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Yr.deserialize=function(t){return new Yr(t.buffer)},Object.defineProperty(Yr,"name",{value:"Grid"}),Zr(Yr,"Grid"),Zr(Ae,"Color"),Zr(Error,"Error"),Zr(ut,"AJAXError"),Zr(Ne,"ResolvedImage"),Zr(er,"StylePropertyFunction"),Zr(Ko,"StyleExpression",{omit:["_evaluator"]}),Zr($o,"ZoomDependentExpression"),Zr(Qo,"ZoomConstantExpression"),Zr(tn,"CompoundExpression",{omit:["_evaluate"]});for(const xg in Lo)Kr[Lo[xg]._classRegistryKey]||Zr(Lo[xg],"Expression".concat(xg));function Jr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Qr(t){return e.ImageBitmap&&t instanceof e.ImageBitmap}function $r(t,n){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Jr(t)||Qr(t))return n&&n.push(t),t;if(ArrayBuffer.isView(t)){const e=t;return n&&n.push(e.buffer),e}if(t instanceof e.ImageData)return n&&n.push(t.data.buffer),t;if(Array.isArray(t)){const e=[];for(const o of t)e.push($r(o,n));return e}if("object"==typeof t){const e=t.constructor,o=e._classRegistryKey;if(!o)throw new Error("can't serialize object of unregistered class ".concat(o));const r=e.serialize?e.serialize(t,n):{};if(!e.serialize){for(const e in t)t.hasOwnProperty(e)&&(Kr[o].omit.indexOf(e)>=0||(r[e]=$r(t[e],n)));t instanceof Error&&(r.message=t.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==o&&(r.$name=o),r}throw new Error("can't serialize object of type "+typeof t)}function ti(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Jr(t)||Qr(t)||ArrayBuffer.isView(t)||t instanceof e.ImageData)return t;if(Array.isArray(t))return t.map(ti);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=Kr[e];if(!n)throw new Error("can't deserialize unregistered class ".concat(e));if(n.deserialize)return n.deserialize(t);const o=Object.create(n.prototype);for(const r of Object.keys(t))"$name"!==r&&(o[r]=ti(t[r]));return o}throw new Error("can't deserialize object of type "+typeof t)}const ei={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function ni(t){for(const e of t)if(ii(e.charCodeAt(0)))return!0;return!1}function oi(t){for(const e of t)if(!ri(e.charCodeAt(0)))return!1;return!0}function ri(t){return!(ei.Arabic(t)||ei["Arabic Supplement"](t)||ei["Arabic Extended-A"](t)||ei["Arabic Presentation Forms-A"](t)||ei["Arabic Presentation Forms-B"](t))}function ii(t){return!(746!==t&&747!==t&&(t<4352||!(ei["Bopomofo Extended"](t)||ei.Bopomofo(t)||ei["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||ei["CJK Compatibility Ideographs"](t)||ei["CJK Compatibility"](t)||ei["CJK Radicals Supplement"](t)||ei["CJK Strokes"](t)||!(!ei["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||ei["CJK Unified Ideographs Extension A"](t)||ei["CJK Unified Ideographs"](t)||ei["Enclosed CJK Letters and Months"](t)||ei["Hangul Compatibility Jamo"](t)||ei["Hangul Jamo Extended-A"](t)||ei["Hangul Jamo Extended-B"](t)||ei["Hangul Jamo"](t)||ei["Hangul Syllables"](t)||ei.Hiragana(t)||ei["Ideographic Description Characters"](t)||ei.Kanbun(t)||ei["Kangxi Radicals"](t)||ei["Katakana Phonetic Extensions"](t)||ei.Katakana(t)&&12540!==t||!(!ei["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!ei["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||ei["Unified Canadian Aboriginal Syllabics"](t)||ei["Unified Canadian Aboriginal Syllabics Extended"](t)||ei["Vertical Forms"](t)||ei["Yijing Hexagram Symbols"](t)||ei["Yi Syllables"](t)||ei["Yi Radicals"](t))))}function si(t){return!(ii(t)||function(t){return!!(ei["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||ei["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||ei["Letterlike Symbols"](t)||ei["Number Forms"](t)||ei["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||ei["Control Pictures"](t)&&9251!==t||ei["Optical Character Recognition"](t)||ei["Enclosed Alphanumerics"](t)||ei["Geometric Shapes"](t)||ei["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ei["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ei["CJK Symbols and Punctuation"](t)||ei.Katakana(t)||ei["Private Use Area"](t)||ei["CJK Compatibility Forms"](t)||ei["Small Form Variants"](t)||ei["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function ai(t){return t>=1424&&t<=2303||ei["Arabic Presentation Forms-A"](t)||ei["Arabic Presentation Forms-B"](t)}function li(t,e){return!(!e&&ai(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||ei.Khmer(t))}function ui(t){for(const e of t)if(ai(e.charCodeAt(0)))return!0;return!1}const ci="deferred",pi="loading",hi="loaded";let di=null,fi="unavailable",gi=null;const mi=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(fi="error"),di&&di(t)};function yi(){vi.fire(new Jt("pluginStateChange",{pluginStatus:fi,pluginURL:gi}))}const vi=new $t,_i=function(){return fi},Ci=function(){if(fi!==ci||!gi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fi=pi,yi(),gi&&ht({url:gi},(t=>{t?mi(t):(fi=hi,yi())}))},wi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>fi===hi||null!=wi.applyArabicShaping,isLoading:()=>fi===pi,setState(t){fi=t.pluginStatus,gi=t.pluginURL},isParsed:()=>null!=wi.applyArabicShaping&&null!=wi.processBidirectionalText&&null!=wi.processStyledBidirectionalText,getPluginURL:()=>gi};class bi{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.transition=e.transition,this.pitch=e.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(t,e){for(const n of t)if(!li(n.charCodeAt(0),e))return!1;return!0}(t,wi.isLoaded())}}class xi{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(zo(t))return new er(t,e);if(Zo(t)){const n=tr(t,e);if("error"===n.result)throw new Error(n.value.map((t=>"".concat(t.key,": ").concat(t.message))).join(", "));return n.value}{let n=t;return"string"==typeof t&&"color"===e.type&&(n=Ae.parse(t)),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class Ei{constructor(t){this.property=t,this.value=new xi(t,void 0)}transitioned(t,e){return new Ti(this.property,this.value,e,D({},t.transition,this.transition),t.now)}untransitioned(){return new Ti(this.property,this.value,null,{},0)}}class Si{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return j(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Ei(this._values[t].property)),this._values[t].value=new xi(this._values[t].property,null===e?void 0:j(e))}getTransition(t){return j(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Ei(this._values[t].property)),this._values[t].transition=j(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const o=this.getTransition(e);void 0!==o&&(t["".concat(e,"-transition")]=o)}return t}transitioned(t,e){const n=new Ri(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].transitioned(t,e._values[o]);return n}untransitioned(){const t=new Ri(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class Ti{constructor(t,e,n,o,r){const i=o.delay||0,s=o.duration||0;r=r||0,this.property=t,this.value=e,this.begin=r+i,this.end=this.begin+s,t.specification.transition&&(o.delay||o.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const o=t.now||0,r=this.value.possiblyEvaluate(t,e,n),i=this.prior;if(i){if(o>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(o<this.begin)return i.possiblyEvaluate(t,e,n);{const s=(o-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(t,e,n),r,E(s))}}return r}}class Ri{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const o=new Ii(this._properties);for(const r of Object.keys(this._values))o._values[r]=this._values[r].possiblyEvaluate(t,e,n);return o}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Oi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return j(this._values[t].value)}setValue(t,e){this._values[t]=new xi(this._values[t].property,null===e?void 0:j(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const o=new Ii(this._properties);for(const r of Object.keys(this._values))o._values[r]=this._values[r].possiblyEvaluate(t,e,n);return o}}class Pi{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,o){return this.property.evaluate(this.value,this.parameters,t,e,n,o)}}class Ii{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ai{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,n){const o=Mn[this.specification.type];return o?o(t,e,n):t}}class Di{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,o){return new Pi(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,o)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Pi(this,{kind:"constant",value:void 0},t.parameters);const o=Mn[this.specification.type];return o?new Pi(this,{kind:"constant",value:o(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,o,r,i){return"constant"===t.kind?t.value:t.evaluate(e,n,o,r,i)}}class Mi{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,o){return!!t.expression.evaluate(e,null,{},n,o)}interpolate(){return!1}}class Li{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const e=new bi(0,{});for(const n in t){const o=t[n];o.specification.overridable&&this.overridableProperties.push(n);const r=this.defaultPropertyValues[n]=new xi(o,void 0),i=this.defaultTransitionablePropertyValues[n]=new Ei(o);this.defaultTransitioningPropertyValues[n]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=r.possiblyEvaluate(e)}}}function Ni(t,e){return 256*(t=R(Math.floor(t),0,255))+R(Math.floor(e),0,255)}Zr(Di,"DataDrivenProperty"),Zr(Ai,"DataConstantProperty"),Zr(Mi,"ColorRampProperty");const Fi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ki{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Gi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Bi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,o=0;return{members:t.map((t=>{const r=Fi[t.type].BYTES_PER_ELEMENT,i=n=Vi(n,Math.max(e,r)),s=t.components||1;return o=Math.max(o,r),n+=r*s,{name:t.name,type:t.type,components:s,offset:i}})),size:Vi(n,Math.max(o,e)),alignment:e}}function Vi(t,e){return Math.ceil(t/e)*e}class zi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const o=2*t;return this.int16[o+0]=e,this.int16[o+1]=n,t}}zi.prototype.bytesPerElement=4,Zr(zi,"StructArrayLayout2i4");class ji extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n)}emplace(t,e,n,o){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=o,t}}ji.prototype.bytesPerElement=6,Zr(ji,"StructArrayLayout3i6");class Hi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,o){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,o)}emplace(t,e,n,o,r){const i=4*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=o,this.int16[i+3]=r,t}}Hi.prototype.bytesPerElement=8,Zr(Hi,"StructArrayLayout4i8");class Ui extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,o,r,i,s)}emplace(t,e,n,o,r,i,s,a){const l=6*t,u=12*t,c=3*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[u+4]=o,this.uint8[u+5]=r,this.uint8[u+6]=i,this.uint8[u+7]=s,this.float32[c+2]=a,t}}Ui.prototype.bytesPerElement=12,Zr(Ui,"StructArrayLayout2i4ub1f12");class Wi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,o){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,o)}emplace(t,e,n,o,r){const i=4*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=o,this.float32[i+3]=r,t}}Wi.prototype.bytesPerElement=16,Zr(Wi,"StructArrayLayout4f16");class qi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,o,r)}emplace(t,e,n,o,r,i){const s=6*t,a=3*t;return this.uint16[s+0]=e,this.uint16[s+1]=n,this.uint16[s+2]=o,this.uint16[s+3]=r,this.float32[a+2]=i,t}}qi.prototype.bytesPerElement=12,Zr(qi,"StructArrayLayout4ui1f12");class Xi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,o){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,o)}emplace(t,e,n,o,r){const i=4*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=o,this.uint16[i+3]=r,t}}Xi.prototype.bytesPerElement=8,Zr(Xi,"StructArrayLayout4ui8");class Yi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,o,r,i)}emplace(t,e,n,o,r,i,s){const a=6*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=o,this.int16[a+3]=r,this.int16[a+4]=i,this.int16[a+5]=s,t}}Yi.prototype.bytesPerElement=12,Zr(Yi,"StructArrayLayout6i12");class Ki extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i,s,a,l,u,c,p){const h=this.length;return this.resize(h+1),this.emplace(h,t,e,n,o,r,i,s,a,l,u,c,p)}emplace(t,e,n,o,r,i,s,a,l,u,c,p,h){const d=12*t;return this.int16[d+0]=e,this.int16[d+1]=n,this.int16[d+2]=o,this.int16[d+3]=r,this.uint16[d+4]=i,this.uint16[d+5]=s,this.uint16[d+6]=a,this.uint16[d+7]=l,this.int16[d+8]=u,this.int16[d+9]=c,this.int16[d+10]=p,this.int16[d+11]=h,t}}Ki.prototype.bytesPerElement=24,Zr(Ki,"StructArrayLayout4i4ui4i24");class Zi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,o,r,i)}emplace(t,e,n,o,r,i,s){const a=10*t,l=5*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=o,this.float32[l+2]=r,this.float32[l+3]=i,this.float32[l+4]=s,t}}Zi.prototype.bytesPerElement=20,Zr(Zi,"StructArrayLayout3i3f20");class Ji extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Ji.prototype.bytesPerElement=4,Zr(Ji,"StructArrayLayout1ul4");class Qi extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i,s,a,l,u,c,p,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,o,r,i,s,a,l,u,c,p,h)}emplace(t,e,n,o,r,i,s,a,l,u,c,p,h,d){const f=20*t,g=10*t;return this.int16[f+0]=e,this.int16[f+1]=n,this.int16[f+2]=o,this.int16[f+3]=r,this.int16[f+4]=i,this.float32[g+3]=s,this.float32[g+4]=a,this.float32[g+5]=l,this.float32[g+6]=u,this.int16[f+14]=c,this.uint32[g+8]=p,this.uint16[f+18]=h,this.uint16[f+19]=d,t}}Qi.prototype.bytesPerElement=40,Zr(Qi,"StructArrayLayout5i4f1i1ul2ui40");class $i extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,o,r,i,s)}emplace(t,e,n,o,r,i,s,a){const l=8*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=o,this.int16[l+4]=r,this.int16[l+5]=i,this.int16[l+6]=s,this.int16[l+7]=a,t}}$i.prototype.bytesPerElement=16,Zr($i,"StructArrayLayout3i2i2i16");class ts extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,o,r)}emplace(t,e,n,o,r,i){const s=4*t,a=8*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=o,this.int16[a+6]=r,this.int16[a+7]=i,t}}ts.prototype.bytesPerElement=16,Zr(ts,"StructArrayLayout2f1f2i16");class es extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,o){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,o)}emplace(t,e,n,o,r){const i=12*t,s=3*t;return this.uint8[i+0]=e,this.uint8[i+1]=n,this.float32[s+1]=o,this.float32[s+2]=r,t}}es.prototype.bytesPerElement=12,Zr(es,"StructArrayLayout2ub2f12");class ns extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n)}emplace(t,e,n,o){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=o,t}}ns.prototype.bytesPerElement=12,Zr(ns,"StructArrayLayout3f12");class os extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n)}emplace(t,e,n,o){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=o,t}}os.prototype.bytesPerElement=6,Zr(os,"StructArrayLayout3ui6");class rs extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C){const w=this.length;return this.resize(w+1),this.emplace(w,t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C)}emplace(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C,w){const b=30*t,x=15*t,E=60*t;return this.int16[b+0]=e,this.int16[b+1]=n,this.int16[b+2]=o,this.float32[x+2]=r,this.float32[x+3]=i,this.uint16[b+8]=s,this.uint16[b+9]=a,this.uint32[x+5]=l,this.uint32[x+6]=u,this.uint32[x+7]=c,this.uint16[b+16]=p,this.uint16[b+17]=h,this.uint16[b+18]=d,this.float32[x+10]=f,this.float32[x+11]=g,this.uint8[E+48]=m,this.uint8[E+49]=y,this.uint8[E+50]=v,this.uint32[x+13]=_,this.int16[b+28]=C,this.uint8[E+58]=w,t}}rs.prototype.bytesPerElement=60,Zr(rs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class is extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C,w,b,x,E,S,T,R,O,P){const I=this.length;return this.resize(I+1),this.emplace(I,t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C,w,b,x,E,S,T,R,O,P)}emplace(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C,w,b,x,E,S,T,R,O,P,I){const A=38*t,D=19*t;return this.int16[A+0]=e,this.int16[A+1]=n,this.int16[A+2]=o,this.float32[D+2]=r,this.float32[D+3]=i,this.int16[A+8]=s,this.int16[A+9]=a,this.int16[A+10]=l,this.int16[A+11]=u,this.int16[A+12]=c,this.int16[A+13]=p,this.uint16[A+14]=h,this.uint16[A+15]=d,this.uint16[A+16]=f,this.uint16[A+17]=g,this.uint16[A+18]=m,this.uint16[A+19]=y,this.uint16[A+20]=v,this.uint16[A+21]=_,this.uint16[A+22]=C,this.uint16[A+23]=w,this.uint16[A+24]=b,this.uint16[A+25]=x,this.uint16[A+26]=E,this.uint16[A+27]=S,this.uint16[A+28]=T,this.uint32[D+15]=R,this.float32[D+16]=O,this.float32[D+17]=P,this.float32[D+18]=I,t}}is.prototype.bytesPerElement=76,Zr(is,"StructArrayLayout3i2f6i15ui1ul3f76");class ss extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}ss.prototype.bytesPerElement=4,Zr(ss,"StructArrayLayout1f4");class as extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,o,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,o,r)}emplace(t,e,n,o,r,i){const s=5*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=o,this.float32[s+3]=r,this.float32[s+4]=i,t}}as.prototype.bytesPerElement=20,Zr(as,"StructArrayLayout5f20");class ls extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,o){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,o)}emplace(t,e,n,o,r){const i=6*t;return this.uint32[3*t+0]=e,this.uint16[i+2]=n,this.uint16[i+3]=o,this.uint16[i+4]=r,t}}ls.prototype.bytesPerElement=12,Zr(ls,"StructArrayLayout1ul3ui12");class us extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const o=2*t;return this.uint16[o+0]=e,this.uint16[o+1]=n,t}}us.prototype.bytesPerElement=4,Zr(us,"StructArrayLayout2ui4");class cs extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}cs.prototype.bytesPerElement=2,Zr(cs,"StructArrayLayout1ui2");class ps extends Gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const o=2*t;return this.float32[o+0]=e,this.float32[o+1]=n,t}}ps.prototype.bytesPerElement=8,Zr(ps,"StructArrayLayout2f8");class hs extends ki{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}hs.prototype.size=40;class ds extends Qi{get(t){return new hs(this,t)}}Zr(ds,"CollisionBoxArray");class fs extends ki{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}fs.prototype.size=60;class gs extends rs{get(t){return new fs(this,t)}}Zr(gs,"PlacedSymbolArray");class ms extends ki{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ms.prototype.size=76;class ys extends is{get(t){return new ms(this,t)}}Zr(ys,"SymbolInstanceArray");class vs extends ss{getoffsetX(t){return this.float32[1*t+0]}}Zr(vs,"GlyphOffsetArray");class _s extends zi{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Zr(_s,"SymbolLineVertexArray");class Cs extends ki{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Cs.prototype.size=12;class ws extends ls{get(t){return new Cs(this,t)}}Zr(ws,"FeatureIndexArray");class bs extends us{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Zr(bs,"FillExtrusionCentroidArray");const xs=Bi([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Es=Bi([{name:"a_dash",components:4,type:"Uint16"}]);var Ss={exports:{}},Ts={exports:{}};Ts.exports=function(t,e){var n,o,r,i,s,a,l,u;for(o=t.length-(n=3&t.length),r=e,s=3432918353,a=461845907,u=0;u<o;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,r=27492+(65535&(i=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var Rs=Ts.exports,Os={exports:{}};Os.exports=function(t,e){for(var n,o=t.length,r=e^o,i=0;o>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(i)|(255&t.charCodeAt(++i))<<8|(255&t.charCodeAt(++i))<<16|(255&t.charCodeAt(++i))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),o-=4,++i;switch(o){case 3:r^=(255&t.charCodeAt(i+2))<<16;case 2:r^=(255&t.charCodeAt(i+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(i)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var Ps=Rs,Is=Os.exports;Ss.exports=Ps,Ss.exports.murmur3=Ps,Ss.exports.murmur2=Is;var As=h(Ss.exports);class Ds{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,o){this.ids.push(Ms(t)),this.positions.push(e,n,o)}getPositions(t){const e=Ms(t);let n=0,o=this.ids.length-1;for(;n<o;){const t=n+o>>1;this.ids[t]>=e?o=t:n=t+1}const r=[];for(;this.ids[n]===e;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(t,e){const n=new Float64Array(t.ids),o=new Uint32Array(t.positions);return Ls(n,o,0,n.length-1),e&&e.push(n.buffer,o.buffer),{ids:n,positions:o}}static deserialize(t){const e=new Ds;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function Ms(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:As(String(t))}function Ls(t,e,n,o){for(;n<o;){const r=t[n+o>>1];let i=n-1,s=o+1;for(;;){do{i++}while(t[i]<r);do{s--}while(t[s]>r);if(i>=s)break;Ns(t,i,s),Ns(e,3*i,3*s),Ns(e,3*i+1,3*s+1),Ns(e,3*i+2,3*s+2)}s-n<o-s?(Ls(t,e,n,s),n=s+1):(Ls(t,e,s+1,o),o=s)}}function Ns(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}Zr(Ds,"FeaturePositionMap");class Fs{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,e){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,e),this.initialized=!0),!!this.location}}class ks extends Fs{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Gs extends Fs{constructor(t){super(t),this.current=[0,0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}class Bs extends Fs{constructor(t){super(t),this.current=Ae.transparent}set(t,e,n){this.fetchUniformLocation(t,e)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}const Vs=new Float32Array(16),zs=new Float32Array(9),js=new Float32Array(4);function Hs(t){return[Ni(255*t.r,255*t.g),Ni(255*t.b,255*t.a)]}class Us{constructor(t,e,n){this.value=t,this.uniformNames=e.map((t=>"u_".concat(t))),this.type=n}setUniform(t,e,n,o,r){e.set(t,r,o.constantOr(this.value))}getBinding(t,e){return"color"===this.type?new Bs(t):new ks(t)}}class Ws{constructor(t,e){this.uniformNames=e.map((t=>"u_".concat(t))),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,e,n,o,r){const i="u_pattern"===r||"u_dash"===r?this.pattern:"u_pixel_ratio"===r?this.pixelRatio:null;i&&e.set(t,r,i)}getBinding(t,e){return"u_pattern"===e||"u_dash"===e?new Gs(t):new ks(t)}}class qs{constructor(t,e,n,o){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:"a_".concat(t),type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new o}populatePaintArray(t,e,n,o,r,i){const s=this.paintVertexArray.length,a=this.expression.evaluate(new bi(0),e,{},r,o,i);this.paintVertexArray.resize(t),this._setPaintValue(s,t,a)}updatePaintArray(t,e,n,o,r){const i=this.expression.evaluate({zoom:0},n,o,void 0,r);this._setPaintValue(t,e,i)}_setPaintValue(t,e,n){if("color"===this.type){const o=Hs(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,o[0],o[1])}else{for(let o=t;o<e;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xs{constructor(t,e,n,o,r,i){this.expression=t,this.uniformNames=e.map((t=>"u_".concat(t,"_t"))),this.type=n,this.useIntegerZoom=o,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:"a_".concat(t),type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new i}populatePaintArray(t,e,n,o,r,i){const s=this.expression.evaluate(new bi(this.zoom),e,{},r,o,i),a=this.expression.evaluate(new bi(this.zoom+1),e,{},r,o,i),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,s,a)}updatePaintArray(t,e,n,o,r){const i=this.expression.evaluate({zoom:this.zoom},n,o,void 0,r),s=this.expression.evaluate({zoom:this.zoom+1},n,o,void 0,r);this._setPaintValue(t,e,i,s)}_setPaintValue(t,e,n,o){if("color"===this.type){const r=Hs(n),i=Hs(o);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1],i[0],i[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n,o);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e,n,o,r){const i=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,s=R(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(t,r,s)}getBinding(t,e){return new ks(t)}}class Ys{constructor(t,e,n,o,r){this.expression=t,this.layerId=r,this.paintVertexAttributes=("array"===n?Es:xs).members;for(let i=0;i<e.length;++i);this.paintVertexArray=new o}populatePaintArray(t,e,n){const o=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(o,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,o,r,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)}_setPaintValues(t,e,n,o){if(!o||!n)return;const r=o[n];if(!r)return;const{tl:i,br:s,pixelRatio:a}=r;for(let l=t;l<e;l++)this.paintVertexArray.emplace(l,i[0],i[1],s[0],s[1],a)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ks{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.binders={},this._buffers=[];const o=[];for(const r in t.paint._values){if(!n(r))continue;const i=t.paint.get(r);if(!(i instanceof Pi&&ko(i.property.specification)))continue;const s=Qs(r,t.type),a=i.value,l=i.property.specification.type,u=!!i.property.useIntegerZoom,c="line-dasharray"===r||r.endsWith("pattern"),p="line-dasharray"===r&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==a.kind||p)if("source"===a.kind||p||c){const e=ea(r,l,"source");this.binders[r]=c?new Ys(a,s,l,e,t.id):new qs(a,s,l,e),o.push("/a_".concat(r))}else{const t=ea(r,l,"composite");this.binders[r]=new Xs(a,s,l,u,e,t),o.push("/z_".concat(r))}else this.binders[r]=c?new Ws(a.value,s):new Us(a.value,s,l),o.push("/u_".concat(r))}this.cacheKey=o.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof qs||e instanceof Xs?e.maxValue:0}populatePaintArrays(t,e,n,o,r,i){for(const s in this.binders){const a=this.binders[s];(a instanceof qs||a instanceof Xs||a instanceof Ys)&&a.populatePaintArray(t,e,n,o,r,i)}}setConstantPatternPositions(t){for(const e in this.binders){const n=this.binders[e];n instanceof Ws&&n.setConstantPatternPositions(t)}}updatePaintArrays(t,e,n,o,r,i){let s=!1;for(const a in t){const l=e.getPositions(a);for(const e of l){const l=n.feature(e.index);for(const n in this.binders){const u=this.binders[n];if((u instanceof qs||u instanceof Xs||u instanceof Ys)&&!0===u.expression.isStateDependent){const c=o.paint.get(n);u.expression=c.value,u.updatePaintArray(e.start,e.end,l,t[a],r,i),s=!0}}}}return s}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Us||n instanceof Ws)&&t.push(...n.uniformNames.map((t=>"#define HAS_UNIFORM_".concat(t))))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof qs||n instanceof Xs||n instanceof Ys)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Us||n instanceof Ws||n instanceof Xs)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof Us||o instanceof Ws||o instanceof Xs)for(const r of o.uniformNames)e.push({name:r,property:n,binding:o.getBinding(t,r)})}return e}setUniforms(t,e,n,o,r){for(const{name:i,property:s,binding:a}of n)this.binders[s].setUniform(t,a,r,o.get(s),i)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const e=this.binders[t];(e instanceof qs||e instanceof Xs||e instanceof Ys)&&e.paintVertexBuffer&&this._buffers.push(e.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof qs||n instanceof Xs||n instanceof Ys)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof qs||e instanceof Xs||e instanceof Ys)&&e.destroy()}}}class Zs{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const o of t)this.programConfigurations[o.id]=new Ks(o,e,n);this.needsUpload=!1,this._featureMap=new Ds,this._bufferOffset=0}populatePaintArrays(t,e,n,o,r,i,s){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,o,r,i,s);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,o,r){for(const i of n)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(t,this._featureMap,e,i,o,r)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Js={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Qs(t,e){return Js[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}const $s={"line-pattern":{source:qi,composite:qi},"fill-pattern":{source:qi,composite:qi},"fill-extrusion-pattern":{source:qi,composite:qi},"line-dasharray":{source:Xi,composite:Xi}},ta={color:{source:ps,composite:Wi},number:{source:ss,composite:ps}};function ea(t,e,n){const o=$s[t];return o&&o[n]||ta[e][n]}Zr(Us,"ConstantBinder"),Zr(Ws,"PatternConstantBinder"),Zr(qs,"SourceExpressionBinder"),Zr(Ys,"PatternCompositeBinder"),Zr(Xs,"CompositeExpressionBinder"),Zr(Ks,"ProgramConfiguration",{omit:["_buffers"]}),Zr(Zs,"ProgramConfigurationSet");const na="-transition";class oa extends $t{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new Oi(e.layout)),e.paint)){this._transitionablePaint=new Si(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ii(e.paint)}}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=e&&this._validate(jr,"layers.".concat(this.id,".layout.").concat(t),t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return B(t,na)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&this._validate(zr,"layers.".concat(this.id,".paint.").concat(t),t,e,n))return!1;if(B(t,na))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const n=this._transitionablePaint._values[t],o=n.value.isDataDriven(),r=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const i=this._transitionablePaint._values[t].value,s=i.isDataDriven(),a=B(t,"pattern")||"line-dasharray"===t;return s||o||a||this._handleOverridablePaintPropertyUpdate(t,r,i)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),z(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&Ur(this,t.call(Vr,{key:e,layerType:this.type,objectKey:n,value:o,styleSpec:te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof Pi&&ko(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=hr(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ra=Bi([{name:"a_pos",components:2,type:"Int16"}],4),ia=Bi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class sa{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=t}prepareSegment(t,e,n,o){let r=this.segments[this.segments.length-1];return t>sa.MAX_VERTEX_ARRAY_LENGTH&&U("Max vertices per segment is ".concat(sa.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t)),(!r||r.vertexLength+t>sa.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==o)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==o&&(r.sortKey=o),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,o){return new sa([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:o,vaos:{},sortKey:0}])}}sa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zr(sa,"SegmentVector");var aa=8192;class la{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof jl?new jl(t.lng,t.lat):jl.convert(t),this}setSouthWest(t){return this._sw=t instanceof jl?new jl(t.lng,t.lat):jl.convert(t),this}extend(t){const e=this._sw,n=this._ne;let o,r;if(t instanceof jl)o=t,r=t;else{if(!(t instanceof la))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(la.convert(t)):this.extend(jl.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(jl.convert(t)):this;if(o=t._sw,r=t._ne,!o||!r)return this}return e||n?(e.lng=Math.min(o.lng,e.lng),e.lat=Math.min(o.lat,e.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new jl(o.lng,o.lat),this._ne=new jl(r.lng,r.lat)),this}getCenter(){return new jl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new jl(this.getWest(),this.getNorth())}getSouthEast(){return new jl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=jl.convert(t);let o=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(o=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&o}static convert(t){return!t||t instanceof la?t:new la(t)}}var ua=1e-6,ca="undefined"!=typeof Float32Array?Float32Array:Array;function pa(){var t=new ca(9);return ca!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ha(t,e,n){var o=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=n[0],d=n[1],f=n[2],g=n[3],m=n[4],y=n[5],v=n[6],_=n[7],C=n[8];return t[0]=h*o+d*s+f*u,t[1]=h*r+d*a+f*c,t[2]=h*i+d*l+f*p,t[3]=g*o+m*s+y*u,t[4]=g*r+m*a+y*c,t[5]=g*i+m*l+y*p,t[6]=v*o+_*s+C*u,t[7]=v*r+_*a+C*c,t[8]=v*i+_*l+C*p,t}function da(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fa(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],p=e[9],h=e[10],d=e[11],f=e[12],g=e[13],m=e[14],y=e[15],v=n*a-o*s,_=n*l-r*s,C=n*u-i*s,w=o*l-r*a,b=o*u-i*a,x=r*u-i*l,E=c*g-p*f,S=c*m-h*f,T=c*y-d*f,R=p*m-h*g,O=p*y-d*g,P=h*y-d*m,I=v*P-_*O+C*R+w*T-b*S+x*E;return I?(t[0]=(a*P-l*O+u*R)*(I=1/I),t[1]=(r*O-o*P-i*R)*I,t[2]=(g*x-m*b+y*w)*I,t[3]=(h*b-p*x-d*w)*I,t[4]=(l*T-s*P-u*S)*I,t[5]=(n*P-r*T+i*S)*I,t[6]=(m*C-f*x-y*_)*I,t[7]=(c*x-h*C+d*_)*I,t[8]=(s*O-a*T+u*E)*I,t[9]=(o*T-n*O-i*E)*I,t[10]=(f*b-g*C+y*v)*I,t[11]=(p*C-c*b-d*v)*I,t[12]=(a*S-s*R-l*E)*I,t[13]=(n*R-o*S+r*E)*I,t[14]=(g*_-f*w-m*v)*I,t[15]=(c*w-p*_+h*v)*I,t):null}function ga(t,e,n){var o=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],C=n[1],w=n[2],b=n[3];return t[0]=_*o+C*a+w*p+b*g,t[1]=_*r+C*l+w*h+b*m,t[2]=_*i+C*u+w*d+b*y,t[3]=_*s+C*c+w*f+b*v,t[4]=(_=n[4])*o+(C=n[5])*a+(w=n[6])*p+(b=n[7])*g,t[5]=_*r+C*l+w*h+b*m,t[6]=_*i+C*u+w*d+b*y,t[7]=_*s+C*c+w*f+b*v,t[8]=(_=n[8])*o+(C=n[9])*a+(w=n[10])*p+(b=n[11])*g,t[9]=_*r+C*l+w*h+b*m,t[10]=_*i+C*u+w*d+b*y,t[11]=_*s+C*c+w*f+b*v,t[12]=(_=n[12])*o+(C=n[13])*a+(w=n[14])*p+(b=n[15])*g,t[13]=_*r+C*l+w*h+b*m,t[14]=_*i+C*u+w*d+b*y,t[15]=_*s+C*c+w*f+b*v,t}function ma(t,e,n){var o,r,i,s,a,l,u,c,p,h,d,f,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(r=e[1],i=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=o=e[0],t[1]=r,t[2]=i,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=o*g+a*m+p*y+e[12],t[13]=r*g+l*m+h*y+e[13],t[14]=i*g+u*m+d*y+e[14],t[15]=s*g+c*m+f*y+e[15]),t}function ya(t,e,n){var o=n[0],r=n[1],i=n[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function va(t,e,n){var o=Math.sin(n),r=Math.cos(n),i=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*r+u*o,t[5]=s*r+c*o,t[6]=a*r+p*o,t[7]=l*r+h*o,t[8]=u*r-i*o,t[9]=c*r-s*o,t[10]=p*r-a*o,t[11]=h*r-l*o,t}function _a(t,e,n){var o=Math.sin(n),r=Math.cos(n),i=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],p=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r-u*o,t[1]=s*r-c*o,t[2]=a*r-p*o,t[3]=l*r-h*o,t[8]=i*o+u*r,t[9]=s*o+c*r,t[10]=a*o+p*r,t[11]=l*o+h*r,t}function Ca(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function wa(t,e,n){var o,r,i,s=n[0],a=n[1],l=n[2],u=Math.hypot(s,a,l);return u<ua?null:(s*=u=1/u,a*=u,l*=u,o=Math.sin(e),r=Math.cos(e),t[0]=s*s*(i=1-r)+r,t[1]=a*s*i+l*o,t[2]=l*s*i-a*o,t[3]=0,t[4]=s*a*i-l*o,t[5]=a*a*i+r,t[6]=l*a*i+s*o,t[7]=0,t[8]=s*l*i+a*o,t[9]=a*l*i-s*o,t[10]=l*l*i+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ba=ga;function xa(){var t=new ca(3);return ca!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ea(t){var e=new ca(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Sa(t){return Math.hypot(t[0],t[1],t[2])}function Ta(t,e,n){var o=new ca(3);return o[0]=t,o[1]=e,o[2]=n,o}function Ra(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Oa(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Pa(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ia(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Aa(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Da(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Ma(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t}function La(t,e){var n=e[0],o=e[1],r=e[2],i=n*n+o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Na(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Fa(t,e,n){var o=e[0],r=e[1],i=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-i*a,t[1]=i*s-o*l,t[2]=o*a-r*s,t}function ka(t,e,n){var o=e[0],r=e[1],i=e[2],s=n[3]*o+n[7]*r+n[11]*i+n[15];return t[0]=(n[0]*o+n[4]*r+n[8]*i+n[12])/(s=s||1),t[1]=(n[1]*o+n[5]*r+n[9]*i+n[13])/s,t[2]=(n[2]*o+n[6]*r+n[10]*i+n[14])/s,t}function Ga(t,e,n){var o=n[0],r=n[1],i=n[2],s=e[0],a=e[1],l=e[2],u=r*l-i*a,c=i*s-o*l,p=o*a-r*s,h=r*p-i*c,d=i*u-o*p,f=o*c-r*u,g=2*n[3];return c*=g,p*=g,d*=2,f*=2,t[0]=s+(u*=g)+(h*=2),t[1]=a+c+d,t[2]=l+p+f,t}var Ba,Va=Oa,za=Pa,ja=Sa;function Ha(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Ua(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],s=n*n+o*o+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=o*s,t[2]=r*s,t[3]=i*s,t}function Wa(t,e,n){var o=e[0],r=e[1],i=e[2],s=e[3];return t[0]=n[0]*o+n[4]*r+n[8]*i+n[12]*s,t[1]=n[1]*o+n[5]*r+n[9]*i+n[13]*s,t[2]=n[2]*o+n[6]*r+n[10]*i+n[14]*s,t[3]=n[3]*o+n[7]*r+n[11]*i+n[15]*s,t}function qa(){var t=new ca(4);return ca!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Xa(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ya(t,e,n){n*=.5;var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=o*l+s*a,t[1]=r*l+i*a,t[2]=i*l-r*a,t[3]=s*l-o*a,t}function Ka(t,e,n){n*=.5;var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=o*l-i*a,t[1]=r*l+s*a,t[2]=i*l+o*a,t[3]=s*l-r*a,t}xa(),Ba=new ca(4),ca!=Float32Array&&(Ba[0]=0,Ba[1]=0,Ba[2]=0,Ba[3]=0);var Za=Ua;xa(),Ta(1,0,0),Ta(0,1,0),qa(),qa(),pa();const Ja=Bi([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Qa}=Ja,$a=Bi([{name:"a_pos_3",components:3,type:"Int16"}]);var tl=Bi([{name:"a_pos",type:"Int16",components:2}]);class el{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(t,e,n){const o=Na(e,this.dir);if(Math.abs(o)<1e-6)return!1;const r=((t[0]-this.pos[0])*e[0]+(t[1]-this.pos[1])*e[1]+(t[2]-this.pos[2])*e[2])/o;return n[0]=this.pos[0]+this.dir[0]*r,n[1]=this.pos[1]+this.dir[1]*r,n[2]=this.pos[2]+this.dir[2]*r,!0}closestPointOnSphere(t,e,n){if(function(t,e){var n=t[0],o=t[1],r=t[2],i=e[0],s=e[1],a=e[2];return Math.abs(n-i)<=ua*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(o-s)<=ua*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(r-a)<=ua*Math.max(1,Math.abs(r),Math.abs(a))}(this.pos,t)||0===e)return n[0]=n[1]=n[2]=0,!1;const[o,r,i]=this.dir,s=this.pos[0]-t[0],a=this.pos[1]-t[1],l=this.pos[2]-t[2],u=o*o+r*r+i*i,c=2*(s*o+a*r+l*i),p=c*c-4*u*(s*s+a*a+l*l-e*e);if(p<0){const t=Math.max(-c/2,0),u=s+o*t,p=a+r*t,h=l+i*t,d=Math.hypot(u,p,h);return n[0]=u*e/d,n[1]=p*e/d,n[2]=h*e/d,!1}{const t=(-c-Math.sqrt(p))/(2*u);if(t<0){const t=Math.hypot(s,a,l);return n[0]=s*e/t,n[1]=a*e/t,n[2]=l*e/t,!1}return n[0]=s+o*t,n[1]=a+r*t,n[2]=l+i*t,!0}}}class nl{constructor(t,e,n,o,r){this.TL=t,this.TR=e,this.BR=n,this.BL=o,this.horizon=r}static fromInvProjectionMatrix(t,e,n){const o=[-1,1,1],r=[1,1,1],i=[1,-1,1],s=[-1,-1,1],a=ka(o,o,t),l=ka(r,r,t),u=ka(i,i,t),c=ka(s,s,t);return new nl(a,l,u,c,e/n)}}class ol{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(t,e,n,o){const r=Math.pow(2,n),i=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{const i=Wa([],n,t),s=1/i[3]/e*r;return function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}(i,i,[s,s,o?1/i[3]:s,s])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const e=La([],Fa([],Va([],i[t[0]],i[t[1]]),Va([],i[t[2]],i[t[1]]))),n=-Na(e,i[t[1]]);return e.concat(n)}));return new ol(i,s)}}class rl{static fromPoints(t){const e=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];for(const o of t)Ia(e,e,o),Aa(n,n,o);return new rl(e,n)}static applyTransform(t,e){const n=t.getCorners();for(let o=0;o<n.length;++o)ka(n[o],n[o],e);return rl.fromPoints(n)}constructor(t,e){this.min=t,this.max=e,this.center=Da([],Ra([],this.min,this.max),.5)}quadrant(t){const e=[t%2==0,t<2],n=Ea(this.min),o=Ea(this.max);for(let r=0;r<e.length;r++)n[r]=e[r]?this.min[r]:this.center[r],o[r]=e[r]?this.center[r]:this.max[r];return o[2]=this.max[2],new rl(n,o)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,e=this.max;return[[t[0],t[1],t[2]],[e[0],t[1],t[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],e[2]],[t[0],e[1],e[2]]]}intersects(t){const e=this.getCorners();let n=!0;for(let o=0;o<t.planes.length;o++){const r=t.planes[o];let i=0;for(let t=0;t<e.length;t++)i+=Na(r,e[t])+r[3]>=0;if(0===i)return 0;i!==e.length&&(n=!1)}if(n)return 2;for(let o=0;o<3;o++){let e=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<t.points.length;r++){const i=t.points[r][o]-this.min[o];e=Math.min(e,i),n=Math.max(n,i)}if(n<0||e>this.max[o]-this.min[o])return 0}return 1}}const il=5,sl=6,al=aa/Math.PI/2,ll=16383,ul=64,cl=[ul,32,16],pl=-al,hl=al,dl=[new rl([pl,pl,pl],[hl,hl,hl]),new rl([pl,pl,pl],[0,0,hl]),new rl([0,pl,pl],[hl,0,hl]),new rl([pl,0,pl],[0,hl,hl]),new rl([0,0,pl],[hl,hl,hl])];function fl(t){return t*al/Bl}function gl(t,e,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=Da([],t._camera.position,t.worldSize),i=[e,n,1,1];Wa(i,i,t.pixelMatrixInverse),Ha(i,i,1/i[3]);const s=La([],Va([],i,r)),a=t.globeMatrix,l=[a[12],a[13],a[14]],u=Va([],l,r),c=Sa(u),p=La([],u),h=t.worldSize/(2*Math.PI),d=Na(p,s),f=Math.asin(h/c);if(f<Math.acos(d)){if(!o)return null;const t=[],e=[];Da(t,s,c/d),La(e,Va(e,t,u)),La(s,Ra(s,u,Da(s,e,Math.tan(f)*c)))}const g=[];new el(r,s).closestPointOnSphere(l,h,g);const m=La([],Q(a,0)),y=La([],Q(a,1)),v=La([],Q(a,2)),_=Na(m,g),C=Na(y,g),w=Na(v,g),x=b(Math.asin(-C/h));let E=b(Math.atan2(_,w));E=t.center.lng+function(t,e){const n=(e-t+180)%360-180;return n<-180?n+360:n}(t.center.lng,E);const S=Ul(E),T=R(Wl(x),0,1);return new Ql(S,T)}class ml{constructor(t,e,n){this.a=Va([],t,n),this.b=Va([],e,n),this.center=n;const o=La([],this.a),r=La([],this.b);this.angle=Math.acos(Na(o,r))}}function yl(t,e){if(0===t.angle)return null;let n;return n=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(t,e,n,o){const r=Math.sin(n);return t*(Math.sin((1-o)*n)/r)+e*(Math.sin(o*n)/r)}(t.a[e],t.b[e],t.angle,R(n,0,1))+t.center[e]}function vl(t){if(t.z<=1)return dl[t.z+2*t.y+t.x];const e=El(xl(t));return rl.fromPoints(e)}function _l(t,e,n){return Da(t,t,1-n),Ma(t,t,e,n)}function Cl(t,e){const n=Ml(e.zoom);if(0===n)return vl(t);const o=xl(t),r=El(o),i=Ul(o.getWest())*e.worldSize,s=Ul(o.getEast())*e.worldSize,a=Wl(o.getNorth())*e.worldSize,l=Wl(o.getSouth())*e.worldSize,u=[i,a,0],c=[s,a,0],p=[i,l,0],h=[s,l,0],d=fa([],e.globeMatrix);return ka(u,u,d),ka(c,c,d),ka(p,p,d),ka(h,h,d),r[0]=_l(r[0],p,n),r[1]=_l(r[1],h,n),r[2]=_l(r[2],c,n),r[3]=_l(r[3],u,n),rl.fromPoints(r)}function wl(t,e,n){for(const o of t)ka(o,o,e),Da(o,o,n)}function bl(t,e,n){const o=e/t.worldSize,r=t.globeMatrix;if(n.z<=1){const t=vl(n).getCorners();return wl(t,r,o),rl.fromPoints(t)}const i=xl(n),s=El(i);wl(s,r,o);const a=Number.MAX_VALUE,l=[-a,-a,-a],u=[a,a,a];if(i.contains(t.center)){for(const t of s)Ia(u,u,t),Aa(l,l,t);l[2]=0;const e=t.point,n=[e.x*o,e.y*o,0];return Ia(u,u,n),Aa(l,l,n),new rl(u,l)}const c=[r[12]*o,r[13]*o,r[14]*o],p=i.getCenter(),h=R(t.center.lat,-Zl,Zl),d=R(p.lat,-Zl,Zl),f=Ul(t.center.lng),g=Wl(h);let m=f-Ul(p.lng);const y=g-Wl(d);m>.5?m-=1:m<-.5&&(m+=1);let v=0;Math.abs(m)>Math.abs(y)?v=m>=0?1:3:(v=y>=0?0:2,Ma(c,c,[r[4]*o,r[5]*o,r[6]*o],-Math.sin(w(y>=0?i.getSouth():i.getNorth()))*al));const _=s[v],C=s[(v+1)%4],b=new ml(_,C,c),x=[yl(b,0)||_[0],yl(b,1)||_[1],yl(b,2)||_[2]],E=Ml(t.zoom);if(E>0){const o=function(t,e,n,o,r){let{x:i,y:s,z:a}=t;const l=1/(1<<a);let u=i*l,c=u+l,p=s*l,h=p+l,d=0;const f=(u+c)/2-o;return f>.5?d=-1:f<-.5&&(d=1),u=((u+d)*e-(o*=e))*n+o,c=((c+d)*e-o)*n+o,p=(p*e-(r*=e))*n+r,h=(h*e-r)*n+r,[[u,h,0],[c,h,0],[c,p,0],[u,p,0]]}(n,e,t._pixelsPerMercatorPixel,f,g);for(let t=0;t<s.length;t++)_l(s[t],o[t],E);const r=Ra([],o[v],o[(v+1)%4]);Da(r,r,.5),_l(x,r,E)}for(const w of s)Ia(u,u,w),Aa(l,l,w);return u[2]=Math.min(_[2],C[2]),Ia(u,u,x),Aa(l,l,x),new rl(u,l)}function xl(t){let{x:e,y:n,z:o}=t;const r=1/(1<<o),i=new jl(Xl(e*r),Yl((n+1)*r)),s=new jl(Xl((e+1)*r),Yl(n*r));return new la(i,s)}function El(t){const e=w(t.getNorth()),n=w(t.getSouth()),o=Math.cos(e),r=Math.cos(n),i=Math.sin(e),s=Math.sin(n),a=t.getWest(),l=t.getEast();return[Sl(r,s,a),Sl(r,s,l),Sl(o,i,l),Sl(o,i,a)]}function Sl(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:al;return n=w(n),[t*Math.sin(n)*o,-e*o,t*Math.cos(n)*o]}function Tl(t,e,n){return Sl(Math.cos(w(t)),Math.sin(w(t)),e,n)}function Rl(t,e,n,o){const r=1<<n.z,i=(t/aa+n.x)/r;return Tl(Yl((e/aa+n.y)/r),Xl(i),o)}function Ol(t){let{min:e,max:n}=t;return ll/Math.max(n[0]-e[0],n[1]-e[1],n[2]-e[2])}const Pl=new Float64Array(16);function Il(t){const e=Ol(t),n=Ca(Pl,[e,e,e]);return ma(n,n,((o=[])[0]=-(r=t.min)[0],o[1]=-r[1],o[2]=-r[2],o));var o,r}function Al(t){const e=(o=t.min,(n=Pl)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=o[0],n[13]=o[1],n[14]=o[2],n[15]=1,n);var n,o;const r=1/Ol(t);return ya(e,e,[r,r,r])}function Dl(t,e,n,o,r){const i=function(t){const e=aa/(2*Math.PI);return t/(2*Math.PI)/e}(n),s=[t,e,-n/(2*Math.PI)],a=da(new Float64Array(16));return ma(a,a,s),ya(a,a,[i,i,i]),va(a,a,w(-r)),_a(a,a,w(-o)),a}function Ml(t){return O(il,sl,t)}function Ll(t,e){const n=Tl(e.lat,e.lng),o=function(t){const e=Tl(t._center.lat,t._center.lng);let n=Fa([],Ta(0,1,0),e);const o=wa([],-t.angle,e);n=ka(n,n,o),wa(o,-t._pitch,n);const r=La([],e);return Da(r,r,fl(t.cameraToCenterDistance/t.pixelsPerMeter)),ka(r,r,o),Ra([],e,r)}(t);return s=(r=Oa([],o,n))[0],a=r[1],l=r[2],u=(i=n)[0],c=i[1],p=i[2],d=(h=Math.sqrt(s*s+a*a+l*l)*Math.sqrt(u*u+c*c+p*p))&&Na(r,i)/h,Math.acos(Math.min(Math.max(d,-1),1));var r,i,s,a,l,u,c,p,h,d}function Nl(t,e){return Ll(t,e)>Math.PI/2*1.01}const Fl=w(85),kl=Math.cos(Fl),Gl=Math.sin(Fl),Bl=6371008.8,Vl=2*Math.PI*Bl;class zl{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(e,")"));if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new zl(P(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(t){const e=Math.PI/180,n=this.lat*e,o=t.lat*e,r=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((t.lng-this.lng)*e);return Bl*Math.acos(Math.min(r,1))}toBounds(){const t=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,e=t/Math.cos(Math.PI/180*this.lat);return new la(new zl(this.lng-e,this.lat-t),new zl(this.lng+e,this.lat+t))}toEcef(t){const e=fl(t);return Tl(this.lat,this.lng,al+e)}static convert(t){if(t instanceof zl)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new zl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new zl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var jl=zl;function Hl(t){return Vl*Math.cos(t*Math.PI/180)}function Ul(t){return(180+t)/360}function Wl(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ql(t,e){return t/Hl(e)}function Xl(t){return 360*t-180}function Yl(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Kl(t,e){return t*Hl(Yl(e))}const Zl=85.051129;function Jl(t){return 1/Math.cos(t*Math.PI/180)}class Ql{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=jl.convert(t);return new Ql(Ul(n.lng),Wl(n.lat),ql(e,n.lat))}toLngLat(){return new jl(Xl(this.x),Yl(this.y))}toAltitude(){return Kl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Vl*Jl(Yl(this.y))}}function $l(t,e,n,o,r,i,s,a,l){const u=(e+o)/2,c=(n+r)/2,p=new v(u,c);a(p),function(t,e,n,o,r,i){const s=n-r,a=o-i;return Math.abs((o-e)*s-(n-t)*a)/Math.hypot(s,a)}(p.x,p.y,i.x,i.y,s.x,s.y)>=l?($l(t,e,n,u,c,i,p,a,l),$l(t,u,c,o,r,p,s,a,l)):t.push(s)}function tu(t,e,n){let o=t[0],r=o.x,i=o.y;e(o);const s=[o];for(let a=1;a<t.length;a++){const l=t[a],{x:u,y:c}=l;e(l),$l(s,r,i,u,c,o,l,e,n),r=u,i=c,o=l}return s}function eu(t,e,n,o){if(o(e,n)){const r=e.add(n)._mult(.5);eu(t,e,r,o),eu(t,r,n,o)}else t.push(n)}function nu(t,e){let n=t[0];const o=[n];for(let r=1;r<t.length;r++){const i=t[r];eu(o,n,i,e),n=i}return o}const ou=Math.pow(2,14)-1,ru=-ou-1;function iu(t,e){const n=Math.round(t.x*e),o=Math.round(t.y*e);return t.x=R(n,ru,ou),t.y=R(o,ru,ou),(n<t.x||n>t.x+1||o<t.y||o>t.y+1)&&U("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function su(t,e,n){const o=t.loadGeometry(),r=t.extent,i=aa/r;if(e&&n&&n.projection.isReprojectedInTileSpace){const i=1<<e.z,{scale:s,x:a,y:l,projection:u}=n,c=t=>{const n=Xl((e.x+t.x/r)/i),o=Yl((e.y+t.y/r)/i),c=u.project(n,o);t.x=(c.x*s-a)*r,t.y=(c.y*s-l)*r};for(let e=0;e<o.length;e++)if(1!==t.type)o[e]=tu(o[e],c,1);else{const t=[];for(const n of o[e])n.x<0||n.x>=r||n.y<0||n.y>=r||(c(n),t.push(n));o[e]=t}}for(const s of o)for(const t of s)iu(t,i);return o}function au(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?su(t):[]}}function lu(t,e,n,o,r){t.emplaceBack(2*e+(o+1)/2,2*n+(r+1)/2)}function uu(t,e,n){const o=16384;t.emplaceBack(e.x,e.y,e.z,n[0]*o,n[1]*o,n[2]*o)}class cu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new zi,this.indexArray=new os,this.segments=new sa,this.programConfigurations=new Zs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n,o){const r=this.layers[0],i=[];let s=null;"circle"===r.type&&(s=r.layout.get("circle-sort-key"));for(const{feature:l,id:u,index:c,sourceLayerIndex:p}of t){const t=this.layers[0]._featureFilter.needGeometry,e=au(l,t);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),e,n))continue;const r=s?s.evaluate(e,{},n):void 0,a={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:t?e.geometry:su(l,n,o),patterns:{},sortKey:r};i.push(a)}s&&i.sort(((t,e)=>t.sortKey-e.sortKey));let a=null;"globe"===o.projection.name&&(this.globeExtVertexArray=new Yi,a=o.projection);for(const l of i){const{geometry:o,index:r,sourceLayerIndex:i}=l,s=t[r].feature;this.addFeature(l,o,r,e.availableImages,n,a),e.featureIndex.insert(s,o,r,i,this.index)}}update(t,e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ra.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,ia.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,e,n,o,r,i){for(const s of e)for(const e of s){const n=e.x,o=e.y;if(n<0||n>=aa||o<0||o>=aa)continue;if(i){const t=i.projectTilePoint(n,o,r),e=i.upVector(r,n,o),s=this.globeExtVertexArray;uu(s,t,e),uu(s,t,e),uu(s,t,e),uu(s,t,e)}const s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=s.vertexLength;lu(this.layoutVertexArray,n,o,-1,-1),lu(this.layoutVertexArray,n,o,1,-1),lu(this.layoutVertexArray,n,o,1,1),lu(this.layoutVertexArray,n,o,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),s.vertexLength+=4,s.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},o,r)}}function pu(t,e){for(let n=0;n<t.length;n++)if(Cu(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Cu(t,e[n]))return!0;return!!gu(t,e)}function hu(t,e,n){return!!Cu(t,e)||!!yu(e,t,n)}function du(t,e){if(1===t.length)return _u(e,t[0]);for(let n=0;n<e.length;n++){const o=e[n];for(let e=0;e<o.length;e++)if(Cu(t,o[e]))return!0}for(let n=0;n<t.length;n++)if(_u(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(gu(t,e[n]))return!0;return!1}function fu(t,e,n){if(t.length>1){if(gu(t,e))return!0;for(let o=0;o<e.length;o++)if(yu(e[o],t,n))return!0}for(let o=0;o<t.length;o++)if(yu(t[o],e,n))return!0;return!1}function gu(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const o=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)if(mu(o,r,e[t],e[t+1]))return!0}return!1}function mu(t,e,n,o){return W(t,n,o)!==W(e,n,o)&&W(t,e,n)!==W(t,e,o)}function yu(t,e,n){const o=n*n;if(1===e.length)return t.distSqr(e[0])<o;for(let r=1;r<e.length;r++)if(vu(t,e[r-1],e[r])<o)return!0;return!1}function vu(t,e,n){const o=e.distSqr(n);if(0===o)return t.distSqr(e);const r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/o;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function _u(t,e){let n,o,r,i=!1;for(let s=0;s<t.length;s++){n=t[s];for(let t=0,s=n.length-1;t<n.length;s=t++)o=n[t],r=n[s],o.y>e.y!=r.y>e.y&&e.x<(r.x-o.x)*(e.y-o.y)/(r.y-o.y)+o.x&&(i=!i)}return i}function Cu(t,e){let n=!1;for(let o=0,r=t.length-1;o<t.length;r=o++){const i=t[o],s=t[r];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(n=!n)}return n}function wu(t,e,n,o,r){for(const s of t)if(e<=s.x&&n<=s.y&&o>=s.x&&r>=s.y)return!0;const i=[new v(e,n),new v(e,r),new v(o,r),new v(o,n)];if(t.length>2)for(const s of i)if(Cu(t,s))return!0;for(let s=0;s<t.length-1;s++)if(bu(t[s],t[s+1],i))return!0;return!1}function bu(t,e,n){const o=n[0],r=n[2];if(t.x<o.x&&e.x<o.x||t.x>r.x&&e.x>r.x||t.y<o.y&&e.y<o.y||t.y>r.y&&e.y>r.y)return!1;const i=W(t,e,n[0]);return i!==W(t,e,n[1])||i!==W(t,e,n[2])||i!==W(t,e,n[3])}function xu(t,e,n){const o=e.paint.get(t).value;return"constant"===o.kind?o.value:n.programConfigurations.get(e.id).getMaxValue(t)}function Eu(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Su(t,e,n,o,r){if(!e[0]&&!e[1])return t;const i=v.convert(e)._mult(r);"viewport"===n&&i._rotate(-o);const s=[];for(let a=0;a<t.length;a++)s.push(t[a].sub(i));return s}function Tu(t,e,n,o){const r=v.convert(t)._mult(o);return"viewport"===e&&r._rotate(-n),r}Zr(cu,"CircleBucket",{omit:["layers"]});const Ru=new Li({"circle-sort-key":new Di(te.layout_circle["circle-sort-key"])});var Ou={paint:new Li({"circle-radius":new Di(te.paint_circle["circle-radius"]),"circle-color":new Di(te.paint_circle["circle-color"]),"circle-blur":new Di(te.paint_circle["circle-blur"]),"circle-opacity":new Di(te.paint_circle["circle-opacity"]),"circle-translate":new Ai(te.paint_circle["circle-translate"]),"circle-translate-anchor":new Ai(te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ai(te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ai(te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Di(te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Di(te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Di(te.paint_circle["circle-stroke-opacity"])}),layout:Ru};function Pu(t,e,n,o,r,i,s,a,l){if(i&&t.queryGeometry.isAboveHorizon)return!1;i&&(l*=t.pixelToTileUnitsFactor);const u=t.tileID.canonical,c=n.projection.upVectorScale(u,n.center.lat,n.worldSize).metersToTile;for(const p of e)for(const e of p){const p=e.add(a),h=r&&n.elevation?n.elevation.exaggeration()*r.getElevationAt(p.x,p.y,!0):0,d=n.projection.projectTilePoint(p.x,p.y,u);if(h>0){const t=n.projection.upVector(u,p.x,p.y);d.x+=t[0]*c*h,d.y+=t[1]*c*h,d.z+=t[2]*c*h}const f=i?p:Iu(d.x,d.y,d.z,o),g=i?t.tilespaceRays.map((t=>Mu(t,h))):t.queryGeometry.screenGeometry,m=Wa([],[d.x,d.y,d.z,1],o);if(!s&&i?l*=m[3]/n.cameraToCenterDistance:s&&!i&&(l*=n.cameraToCenterDistance/m[3]),i){const t=Yl((e.y/aa+u.y)/(1<<u.z));l/=n.projection.pixelsPerMeter(t,1)/ql(1,t)}if(hu(g,f,l))return!0}return!1}function Iu(t,e,n,o){const r=Wa([],[t,e,n,1],o);return new v(r[0]/r[3],r[1]/r[3])}const Au=Ta(0,0,0),Du=Ta(0,0,1);function Mu(t,e){const n=xa();return Au[2]=e,t.intersectsPlane(Au,Du,n),new v(n[0],n[1])}class Lu extends cu{}function Nu(t,e,n,o){let{width:r,height:i}=e;if(o){if(o instanceof Uint8ClampedArray)o=new Uint8Array(o.buffer);else if(o.length!==r*i*n)throw new RangeError("mismatched image size")}else o=new Uint8Array(r*i*n);return t.width=r,t.height=i,t.data=o,t}function Fu(t,e,n){const{width:o,height:r}=e;o===t.width&&r===t.height||(ku(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,o),height:Math.min(t.height,r)},n),t.width=o,t.height=r,t.data=e.data)}function ku(t,e,n,o,r,i){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||o.x>e.width-r.width||o.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const s=t.data,a=e.data;for(let l=0;l<r.height;l++){const u=((n.y+l)*t.width+n.x)*i,c=((o.y+l)*e.width+o.x)*i;for(let t=0;t<r.width*i;t++)a[c+t]=s[u+t]}return e}Zr(Lu,"HeatmapBucket",{omit:["layers"]});class Gu{constructor(t,e){Nu(this,t,1,e)}resize(t){Fu(this,new Gu(t),1)}clone(){return new Gu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,o,r){ku(t,e,n,o,r,1)}}class Bu{constructor(t,e){Nu(this,t,4,e)}resize(t){Fu(this,new Bu(t),4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Bu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,o,r){ku(t,e,n,o,r,4)}}Zr(Gu,"AlphaImage"),Zr(Bu,"RGBAImage");var Vu={paint:new Li({"heatmap-radius":new Di(te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Di(te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ai(te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mi(te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ai(te.paint_heatmap["heatmap-opacity"])})};function zu(t){const e={},n=t.resolution||256,o=t.clips?t.clips.length:1,r=t.image||new Bu({width:n,height:o}),i=(n,o,i)=>{e[t.evaluationKey]=i;const s=t.expression.evaluate(e);r.data[n+o+0]=Math.floor(255*s.r/s.a),r.data[n+o+1]=Math.floor(255*s.g/s.a),r.data[n+o+2]=Math.floor(255*s.b/s.a),r.data[n+o+3]=Math.floor(255*s.a)};if(t.clips)for(let s=0,a=0;s<o;++s,a+=4*n)for(let e=0,o=0;e<n;e++,o+=4){const r=e/(n-1),{start:l,end:u}=t.clips[s];i(a,o,l*(1-r)+u*r)}else for(let s=0,a=0;s<n;s++,a+=4)i(0,a,s/(n-1));return r}var ju={paint:new Li({"hillshade-illumination-direction":new Ai(te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ai(te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ai(te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ai(te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ai(te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ai(te.paint_hillshade["hillshade-accent-color"])})};const Hu=Bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Uu}=Hu;var Wu={exports:{}};function qu(t,e,n){n=n||2;var o,r,i,s,a,l,u,c=e&&e.length,p=c?e[0]*n:t.length,h=Xu(t,0,p,n,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(t,e,n,o){var r,i,s,a=[];for(r=0,i=e.length;r<i;r++)(s=Xu(t,e[r]*o,r<i-1?e[r+1]*o:t.length,o,!1))===s.next&&(s.steiner=!0),a.push(rc(s));for(a.sort(tc),r=0;r<a.length;r++)n=ec(a[r],n);return n}(t,e,h,n)),t.length>80*n){o=i=t[0],r=s=t[1];for(var f=n;f<p;f+=n)(a=t[f])<o&&(o=a),(l=t[f+1])<r&&(r=l),a>i&&(i=a),l>s&&(s=l);u=0!==(u=Math.max(i-o,s-r))?32767/u:0}return Ku(h,d,n,o,r,u,0),d}function Xu(t,e,n,o,r){var i,s;if(r===yc(t,e,n,o)>0)for(i=e;i<n;i+=o)s=fc(i,t[i],t[i+1],s);else for(i=n-o;i>=e;i-=o)s=fc(i,t[i],t[i+1],s);return s&&lc(s,s.next)&&(gc(s),s=s.next),s}function Yu(t,e){if(!t)return t;e||(e=t);var n,o=t;do{if(n=!1,o.steiner||!lc(o,o.next)&&0!==ac(o.prev,o,o.next))o=o.next;else{if(gc(o),(o=e=o.prev)===o.next)break;n=!0}}while(n||o!==e);return e}function Ku(t,e,n,o,r,i,s){if(t){!s&&i&&function(t,e,n,o){var r=t;do{0===r.z&&(r.z=oc(r.x,r.y,e,n,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,o,r,i,s,a,l,u=1;do{for(n=t,t=null,i=null,s=0;n;){for(s++,o=n,a=0,e=0;e<u&&(a++,o=o.nextZ);e++);for(l=u;a>0||l>0&&o;)0!==a&&(0===l||!o||n.z<=o.z)?(r=n,n=n.nextZ,a--):(r=o,o=o.nextZ,l--),i?i.nextZ=r:t=r,r.prevZ=i,i=r;n=o}i.nextZ=null,u*=2}while(s>1)}(r)}(t,o,r,i);for(var a,l,u=t;t.prev!==t.next;)if(a=t.prev,l=t.next,i?Ju(t,o,r,i):Zu(t))e.push(a.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),gc(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?Ku(t=Qu(Yu(t),e,n),e,n,o,r,i,2):2===s&&$u(t,e,n,o,r,i):Ku(Yu(t),e,n,o,r,i,1);break}}}function Zu(t){var e=t.prev,n=t,o=t.next;if(ac(e,n,o)>=0)return!1;for(var r=e.x,i=n.x,s=o.x,a=e.y,l=n.y,u=o.y,c=r<i?r<s?r:s:i<s?i:s,p=a<l?a<u?a:u:l<u?l:u,h=r>i?r>s?r:s:i>s?i:s,d=a>l?a>u?a:u:l>u?l:u,f=o.next;f!==e;){if(f.x>=c&&f.x<=h&&f.y>=p&&f.y<=d&&ic(r,a,i,l,s,u,f.x,f.y)&&ac(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ju(t,e,n,o){var r=t.prev,i=t,s=t.next;if(ac(r,i,s)>=0)return!1;for(var a=r.x,l=i.x,u=s.x,c=r.y,p=i.y,h=s.y,d=a<l?a<u?a:u:l<u?l:u,f=c<p?c<h?c:h:p<h?p:h,g=a>l?a>u?a:u:l>u?l:u,m=c>p?c>h?c:h:p>h?p:h,y=oc(d,f,e,n,o),v=oc(g,m,e,n,o),_=t.prevZ,C=t.nextZ;_&&_.z>=y&&C&&C.z<=v;){if(_.x>=d&&_.x<=g&&_.y>=f&&_.y<=m&&_!==r&&_!==s&&ic(a,c,l,p,u,h,_.x,_.y)&&ac(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,C.x>=d&&C.x<=g&&C.y>=f&&C.y<=m&&C!==r&&C!==s&&ic(a,c,l,p,u,h,C.x,C.y)&&ac(C.prev,C,C.next)>=0)return!1;C=C.nextZ}for(;_&&_.z>=y;){if(_.x>=d&&_.x<=g&&_.y>=f&&_.y<=m&&_!==r&&_!==s&&ic(a,c,l,p,u,h,_.x,_.y)&&ac(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;C&&C.z<=v;){if(C.x>=d&&C.x<=g&&C.y>=f&&C.y<=m&&C!==r&&C!==s&&ic(a,c,l,p,u,h,C.x,C.y)&&ac(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Qu(t,e,n){var o=t;do{var r=o.prev,i=o.next.next;!lc(r,i)&&uc(r,o,o.next,i)&&hc(r,i)&&hc(i,r)&&(e.push(r.i/n|0),e.push(o.i/n|0),e.push(i.i/n|0),gc(o),gc(o.next),o=t=i),o=o.next}while(o!==t);return Yu(o)}function $u(t,e,n,o,r,i){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&sc(s,a)){var l=dc(s,a);return s=Yu(s,s.next),l=Yu(l,l.next),Ku(s,e,n,o,r,i,0),void Ku(l,e,n,o,r,i,0)}a=a.next}s=s.next}while(s!==t)}function tc(t,e){return t.x-e.x}function ec(t,e){var n=function(t,e){var n,o=e,r=t.x,i=t.y,s=-1/0;do{if(i<=o.y&&i>=o.next.y&&o.next.y!==o.y){var a=o.x+(i-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(a<=r&&a>s&&(s=a,n=o.x<o.next.x?o:o.next,a===r))return n}o=o.next}while(o!==e);if(!n)return null;var l,u=n,c=n.x,p=n.y,h=1/0;o=n;do{r>=o.x&&o.x>=c&&r!==o.x&&ic(i<p?r:s,i,c,p,i<p?s:r,i,o.x,o.y)&&(l=Math.abs(i-o.y)/(r-o.x),hc(o,t)&&(l<h||l===h&&(o.x>n.x||o.x===n.x&&nc(n,o)))&&(n=o,h=l)),o=o.next}while(o!==u);return n}(t,e);if(!n)return e;var o=dc(n,t);return Yu(o,o.next),Yu(n,n.next)}function nc(t,e){return ac(t.prev,t,e.prev)<0&&ac(e.next,t,t.next)<0}function oc(t,e,n,o,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function rc(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ic(t,e,n,o,r,i,s,a){return(r-s)*(e-a)>=(t-s)*(i-a)&&(t-s)*(o-a)>=(n-s)*(e-a)&&(n-s)*(i-a)>=(r-s)*(o-a)}function sc(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&uc(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(hc(t,e)&&hc(e,t)&&function(t,e){var n=t,o=!1,r=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&r<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(o=!o),n=n.next}while(n!==t);return o}(t,e)&&(ac(t.prev,t,e.prev)||ac(t,e.prev,e))||lc(t,e)&&ac(t.prev,t,t.next)>0&&ac(e.prev,e,e.next)>0)}function ac(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function lc(t,e){return t.x===e.x&&t.y===e.y}function uc(t,e,n,o){var r=pc(ac(t,e,n)),i=pc(ac(t,e,o)),s=pc(ac(n,o,t)),a=pc(ac(n,o,e));return r!==i&&s!==a||!(0!==r||!cc(t,n,e))||!(0!==i||!cc(t,o,e))||!(0!==s||!cc(n,t,o))||!(0!==a||!cc(n,e,o))}function cc(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function pc(t){return t>0?1:t<0?-1:0}function hc(t,e){return ac(t.prev,t,t.next)<0?ac(t,e,t.next)>=0&&ac(t,t.prev,e)>=0:ac(t,e,t.prev)<0||ac(t,t.next,e)<0}function dc(t,e){var n=new mc(t.i,t.x,t.y),o=new mc(e.i,e.x,e.y),r=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,o.next=n,n.prev=o,i.next=o,o.prev=i,o}function fc(t,e,n,o){var r=new mc(t,e,n);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function gc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function mc(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yc(t,e,n,o){for(var r=0,i=e,s=n-o;i<n;i+=o)r+=(t[s]-t[i])*(t[i+1]+t[s+1]),s=i;return r}Wu.exports=qu,Wu.exports.default=qu,qu.deviation=function(t,e,n,o){var r=e&&e.length,i=Math.abs(yc(t,0,r?e[0]*n:t.length,n));if(r)for(var s=0,a=e.length;s<a;s++)i-=Math.abs(yc(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n));var l=0;for(s=0;s<o.length;s+=3){var u=o[s]*n,c=o[s+1]*n,p=o[s+2]*n;l+=Math.abs((t[u]-t[p])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[p+1]-t[u+1]))}return 0===i&&0===l?0:Math.abs((l-i)/i)},qu.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,r=0;r<t.length;r++){for(var i=0;i<t[r].length;i++)for(var s=0;s<e;s++)n.vertices.push(t[r][i][s]);r>0&&n.holes.push(o+=t[r-1].length)}return n};var vc=h(Wu.exports);function _c(t,e,n,o,r){Cc(t,e,n||0,o||t.length-1,r||bc)}function Cc(t,e,n,o,r){for(;o>n;){if(o-n>600){var i=o-n+1,s=e-n+1,a=Math.log(i),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(i-l)/i)*(s-i/2<0?-1:1);Cc(t,e,Math.max(n,Math.floor(e-s*l/i+u)),Math.min(o,Math.floor(e+(i-s)*l/i+u)),r)}var c=t[e],p=n,h=o;for(wc(t,n,e),r(t[o],c)>0&&wc(t,n,o);p<h;){for(wc(t,p,h),p++,h--;r(t[p],c)<0;)p++;for(;r(t[h],c)>0;)h--}0===r(t[n],c)?wc(t,n,h):wc(t,++h,o),h<=e&&(n=h+1),e<=h&&(o=h-1)}}function wc(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function bc(t,e){return t<e?-1:t>e?1:0}function xc(t,e){const n=t.length;if(n<=1)return[t];const o=[];let r,i;for(let s=0;s<n;s++){const e=q(t[s]);0!==e&&(t[s].area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(r&&o.push(r),r=[t[s]]):r.push(t[s]))}if(r&&o.push(r),e>1)for(let s=0;s<o.length;s++)o[s].length<=e||(_c(o[s],e,1,o[s].length-1,Ec),o[s]=o[s].slice(0,e));return o}function Ec(t,e){return e.area-t.area}function Sc(t,e,n){const o=n.patternDependencies;let r=!1;for(const i of e){const e=i.paint.get("".concat(t,"-pattern"));e.isConstant()||(r=!0);const n=e.constantOr(null);n&&(r=!0,o[n]=!0)}return r}function Tc(t,e,n,o,r){const i=r.patternDependencies;for(const s of e){const e=s.paint.get("".concat(t,"-pattern")).value;if("constant"!==e.kind){let t=e.evaluate({zoom:o},n,{},r.availableImages);t=t&&t.name?t.name:t,i[t]=!0,n.patterns[s.id]=t}}return n}class Rc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zi,this.indexArray=new os,this.indexArray2=new us,this.programConfigurations=new Zs(t.layers,t.zoom),this.segments=new sa,this.segments2=new sa,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.projection=t.projection}populate(t,e,n,o){this.hasPattern=Sc("fill",this.layers,e);const r=this.layers[0].layout.get("fill-sort-key"),i=[];for(const{feature:s,id:a,index:l,sourceLayerIndex:u}of t){const t=this.layers[0]._featureFilter.needGeometry,c=au(s,t);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),c,n))continue;const p=r?r.evaluate(c,{},n,e.availableImages):void 0,h={id:a,properties:s.properties,type:s.type,sourceLayerIndex:u,index:l,geometry:t?c.geometry:su(s,n,o),patterns:{},sortKey:p};i.push(h)}r&&i.sort(((t,e)=>t.sortKey-e.sortKey));for(const s of i){const{geometry:o,index:r,sourceLayerIndex:i}=s;if(this.hasPattern){const t=Tc("fill",this.layers,s,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(s,o,r,n,{},e.availableImages);e.featureIndex.insert(t[r].feature,o,r,i,this.index)}}update(t,e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,o)}addFeatures(t,e,n,o,r){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Uu),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];for(const s of xc(e,500)){let t=0;for(const a of s)t+=a.length;const e=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),n=e.vertexLength,o=[],r=[];for(const a of s){if(0===a.length)continue;a!==s[0]&&r.push(o.length/2);const t=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),e=t.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(e+a.length-1,e),o.push(a[0].x),o.push(a[0].y);for(let n=1;n<a.length;n++)this.layoutVertexArray.emplaceBack(a[n].x,a[n].y),this.indexArray2.emplaceBack(e+n-1,e+n),o.push(a[n].x),o.push(a[n].y);t.vertexLength+=a.length,t.primitiveLength+=a.length}const i=vc(o,r);for(let s=0;s<i.length;s+=3)this.indexArray.emplaceBack(n+i[s],n+i[s+1],n+i[s+2]);e.vertexLength+=t,e.primitiveLength+=i.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i,o)}}Zr(Rc,"FillBucket",{omit:["layers","patternFeatures"]});const Oc=new Li({"fill-sort-key":new Di(te.layout_fill["fill-sort-key"])});var Pc={paint:new Li({"fill-antialias":new Ai(te.paint_fill["fill-antialias"]),"fill-opacity":new Di(te.paint_fill["fill-opacity"]),"fill-color":new Di(te.paint_fill["fill-color"]),"fill-outline-color":new Di(te.paint_fill["fill-outline-color"]),"fill-translate":new Ai(te.paint_fill["fill-translate"]),"fill-translate-anchor":new Ai(te.paint_fill["fill-translate-anchor"]),"fill-pattern":new Di(te.paint_fill["fill-pattern"])}),layout:Oc};const Ic=Bi([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ac=Bi([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Dc=Bi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Mc}=Ic;var Lc={},Nc=m,Fc=kc;function kc(t,e,n,o,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=o,this._values=r,t.readFields(Gc,this,e)}function Gc(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var o=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[o]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Bc(t){for(var e,n,o=0,r=0,i=t.length,s=i-1;r<i;s=r++)o+=((n=t[s]).x-(e=t[r]).x)*(e.y+n.y);return o}kc.types=["Unknown","Point","LineString","Polygon"],kc.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,o=1,r=0,i=0,s=0,a=[];t.pos<n;){if(r<=0){var l=t.readVarint();o=7&l,r=l>>3}if(r--,1===o||2===o)i+=t.readSVarint(),s+=t.readSVarint(),1===o&&(e&&a.push(e),e=[]),e.push(new Nc(i,s));else{if(7!==o)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&a.push(e),a},kc.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,o=0,r=0,i=0,s=1/0,a=-1/0,l=1/0,u=-1/0;t.pos<e;){if(o<=0){var c=t.readVarint();n=7&c,o=c>>3}if(o--,1===n||2===n)(r+=t.readSVarint())<s&&(s=r),r>a&&(a=r),(i+=t.readSVarint())<l&&(l=i),i>u&&(u=i);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,a,u]},kc.prototype.toGeoJSON=function(t,e,n){var o,r,i=this.extent*Math.pow(2,n),s=this.extent*t,a=this.extent*e,l=this.loadGeometry(),u=kc.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+s)/i-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+a)/i)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(o=0;o<l.length;o++)p[o]=l[o][0];c(l=p);break;case 2:for(o=0;o<l.length;o++)c(l[o]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,o,r=[],i=0;i<e;i++){var s=Bc(t[i]);0!==s&&(void 0===o&&(o=s<0),o===s<0?(n&&r.push(n),n=[t[i]]):n.push(t[i]))}return n&&r.push(n),r}(l),o=0;o<l.length;o++)for(r=0;r<l[o].length;r++)c(l[o][r])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var Vc=Fc,zc=jc;function jc(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Hc,this,e),this.length=this._features.length}function Hc(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var o=t.readVarint()>>3;e=1===o?t.readString():2===o?t.readFloat():3===o?t.readDouble():4===o?t.readVarint64():5===o?t.readVarint():6===o?t.readSVarint():7===o?t.readBoolean():null}return e}(n))}jc.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Vc(this._pbf,e,this.extent,this._keys,this._values)};var Uc=zc;function Wc(t,e,n){if(3===t){var o=new Uc(n,n.readVarint()+n.pos);o.length&&(e[o.name]=o)}}var qc=Lc.VectorTile=function(t,e){this.layers=t.readFields(Wc,{},e)},Xc=Lc.VectorTileFeature=Fc;function Yc(t,e,n,o){const r=[],i=0===o?(t,e,n,o,r,i)=>{t.push(new v(i,n+(i-e)/(o-e)*(r-n)))}:(t,e,n,o,r,i)=>{t.push(new v(e+(i-n)/(r-n)*(o-e),i))};for(const s of t){const t=[];for(const r of s){if(r.length<=2)continue;const s=[];for(let t=0;t<r.length-1;t++){const a=r[t].x,l=r[t].y,u=r[t+1].x,c=r[t+1].y,p=0===o?a:l,h=0===o?u:c;p<e?h>e&&i(s,a,l,u,c,e):p>n?h<n&&i(s,a,l,u,c,n):s.push(r[t]),h<e&&p>=e&&i(s,a,l,u,c,e),h>n&&p<=n&&i(s,a,l,u,c,n)}let a=r[r.length-1];const l=0===o?a.x:a.y;l>=e&&l<=n&&s.push(a),s.length&&(a=s[s.length-1],s[0].x===a.x&&s[0].y===a.y||s.push(s[0]),t.push(s))}t.length&&r.push(t)}return r}Lc.VectorTileLayer=zc;const Kc=Xc.types,Zc=Math.pow(2,13);function Jc(t,e,n,o,r,i,s,a){t.emplaceBack((e<<1)+s,(n<<1)+i,(Math.floor(o*Zc)<<1)+r,Math.round(a))}function Qc(t,e,n){const o=16384;t.emplaceBack(e.x,e.y,e.z,n[0]*o,n[1]*o,n[2]*o)}class $c{constructor(){this.acc=new v(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new v(t.x,t.y),this.max=new v(t.x,t.y))}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);const n=this.min,o=this.max;t.x<n.x?n.x=t.x:t.x>o.x&&(o.x=t.x),t.y<n.y?n.y=t.y:t.y>o.y&&(o.y=t.y),((0===t.x||t.x===aa)&&t.x===e.x)!=((0===t.y||t.y===aa)&&t.y===e.y)&&this.processBorderOverlap(t,e),e.x<0!=t.x<0&&this.addBorderIntersection(0,Dn(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>aa!=t.x>aa&&this.addBorderIntersection(1,Dn(e.y,t.y,(aa-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,Dn(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>aa!=t.y>aa&&this.addBorderIntersection(3,Dn(e.x,t.x,(aa-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[t];e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const n=0===t.x?0:1;this.addBorderIntersection(n,e.y),this.addBorderIntersection(n,t.y)}else{const n=0===t.y?2:3;this.addBorderIntersection(n,e.x),this.addBorderIntersection(n,t.x)}}centroid(){const t=this.polyCount.reduce(((t,e)=>t+e.edges),0);return 0!==t?this.acc.div(t)._round():new v(0,0)}span(){return new v(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((t,e)=>t+ +(e[0]!==Number.MAX_VALUE)),0)}}class tp{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new Hi,this.centroidVertexArray=new bs,this.indexArray=new os,this.programConfigurations=new Zs(t.layers,t.zoom),this.segments=new sa,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.enableTerrain=t.enableTerrain}populate(t,e,n,o){this.features=[],this.hasPattern=Sc("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/aa/(1<<t.z)}(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:r,id:i,index:s,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,l=au(r,t);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),l,n))continue;const u={id:i,sourceLayerIndex:a,index:s,geometry:t?l.geometry:su(r,n,o),properties:r.properties,type:r.type,patterns:{}},c=this.layoutVertexArray.length;this.hasPattern?this.features.push(Tc("fill-extrusion",this.layers,u,this.zoom,e)):this.addFeature(u,u.geometry,s,n,{},e.availableImages,o),e.featureIndex.insert(r,u.geometry,s,a,this.index,c)}this.sortBorders()}addFeatures(t,e,n,o,r){for(const i of this.features){const{geometry:t}=i;this.addFeature(i,t,i.index,e,n,o,r)}this.sortBorders()}update(t,e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mc),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,Dc.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ac.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,o,r,i,s){const a=[new v(0,0),new v(aa,aa)],l=s.projection,u="globe"===l.name,c=this.enableTerrain&&!u?new $c:null,p="Polygon"===Kc[t.type];u&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Yi);const h=xc(e,500);for(let m=h.length-1;m>=0;m--){const t=h[m];(0===t.length||(d=t[0]).every((t=>t.x<=0))||d.every((t=>t.x>=aa))||d.every((t=>t.y<=0))||d.every((t=>t.y>=aa)))&&h.splice(m,1)}var d;let f;if(u)f=lp(h,a,o);else{f=[];for(const t of h)f.push({polygon:t,bounds:a})}const g=p?this.edgeRadius:0;for(const{polygon:m,bounds:y}of f){let t=0,e=0;for(const o of m)p&&!o[0].equals(o[o.length-1])&&o.push(o[0]),e+=p?o.length-1:o.length;const n=this.segments.prepareSegment((p?5:4)*e,this.layoutVertexArray,this.indexArray);if(p){const e=[],r=[];t=n.vertexLength;for(const t of m){let i,s;t.length&&t!==m[0]&&r.push(e.length/2),i=t[1].sub(t[0])._perp()._unit();for(let r=1;r<t.length;r++){const a=t[r],c=t[r===t.length-1?1:r+1];let{x:p,y:h}=a;if(g){s=c.sub(a)._perp()._unit();const t=i.add(s)._unit(),e=g*Math.min(4,1/(i.x*t.x+i.y*t.y));p+=e*t.x,h+=e*t.y,i=s}Jc(this.layoutVertexArray,p,h,0,0,1,1,0),n.vertexLength++,e.push(a.x,a.y),u&&Qc(this.layoutVertexExtArray,l.projectTilePoint(p,h,o),l.upVector(o,p,h))}}const i=vc(e,r);for(let o=0;o<i.length;o+=3)this.indexArray.emplaceBack(t+i[o],t+i[o+2],t+i[o+1]),n.primitiveLength++}for(const r of m){c&&r.length&&c.startRing(r[0]);let e,i,s,a=r.length>4&&ip(r[r.length-2],r[0],r[1]),h=g?np(r[r.length-2],r[0],r[1],g):0;i=r[1].sub(r[0])._perp()._unit();let d=!0;for(let f=1,m=0;f<r.length;f++){let v=r[f-1],_=r[f];const C=r[f===r.length-1?1:f+1];if(c&&p&&c.currentPolyCount.top++,rp(_,v,y)){g&&(i=C.sub(_)._perp()._unit(),d=!d);continue}c&&c.append(_,v);const w=_.sub(v)._perp(),b=w.x/(Math.abs(w.x)+Math.abs(w.y)),x=w.y>0?1:0,E=v.dist(_);if(m+E>32768&&(m=0),g){s=C.sub(_)._perp()._unit();let t=op(v,_,C,ep(i,s),g);isNaN(t)&&(t=0);const e=_.sub(v)._unit();v=v.add(e.mult(h))._round(),_=_.add(e.mult(-t))._round(),h=t,i=s}const S=n.vertexLength,T=r.length>4&&ip(v,_,C);let R=sp(m,a,d);if(Jc(this.layoutVertexArray,v.x,v.y,b,x,0,0,R),Jc(this.layoutVertexArray,v.x,v.y,b,x,0,1,R),m+=E,R=sp(m,T,!d),a=T,Jc(this.layoutVertexArray,_.x,_.y,b,x,0,0,R),Jc(this.layoutVertexArray,_.x,_.y,b,x,0,1,R),n.vertexLength+=4,this.indexArray.emplaceBack(S+0,S+1,S+2),this.indexArray.emplaceBack(S+1,S+3,S+2),n.primitiveLength+=2,g){const o=t+(1===f?r.length-2:f-2),i=1===f?t:o+1;if(this.indexArray.emplaceBack(S+1,o,S+3),this.indexArray.emplaceBack(o,i,S+3),n.primitiveLength+=2,void 0===e&&(e=S),!rp(C,r[f],y)){const t=f===r.length-1?e:n.vertexLength;this.indexArray.emplaceBack(S+2,S+3,t),this.indexArray.emplaceBack(S+3,t+1,t),this.indexArray.emplaceBack(S+3,i,t+1),n.primitiveLength+=3}d=!d}if(u){const t=this.layoutVertexExtArray,e=l.projectTilePoint(v.x,v.y,o),n=l.projectTilePoint(_.x,_.y,o),r=l.upVector(o,v.x,v.y),i=l.upVector(o,_.x,_.y);Qc(t,e,r),Qc(t,e,r),Qc(t,n,i),Qc(t,n,i)}}p&&(t+=r.length-1)}}if(c&&c.polyCount.length>0){if(c.borders){c.vertexArrayOffset=this.centroidVertexArray.length;const t=c.borders,e=this.featuresOnBorder.push(c)-1;for(let n=0;n<4;n++)t[n][0]!==Number.MAX_VALUE&&this.borders[n].push(e)}this.encodeCentroid(c.borders?void 0:c.centroid(),c)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i,o)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort(((e,n)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[n].borders[t][0]))}encodeCentroid(t,e){let n,o,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t)if(0!==t.y){const r=e.span()._mult(this.tileToMeter);n=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(r.x/10)),o=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(r.y/10))}else n=Math.ceil(7*(t.x+450)),o=0;else n=0,o=+r;let i=r?this.centroidVertexArray.length:e.vertexArrayOffset;for(const s of e.polyCount){r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*s.edges+s.top);for(let t=0;t<s.top;t++)this.centroidVertexArray.emplace(i++,n,o);for(let t=0;t<2*s.edges;t++)this.centroidVertexArray.emplace(i++,0,o),this.centroidVertexArray.emplace(i++,n,o)}}}function ep(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function np(t,e,n,o){const r=e.sub(t)._perp()._unit(),i=n.sub(e)._perp()._unit();return op(t,e,n,ep(r,i),o)}function op(t,e,n,o,r){const i=Math.sqrt(1-o*o);return Math.min(t.dist(e)/3,e.dist(n)/3,r*i/o)}function rp(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function ip(t,e,n){if(t.x<0||t.x>=aa||e.x<0||e.x>=aa||n.x<0||n.x>=aa)return!1;const o=n.sub(e),r=o.perp(),i=t.sub(e);return(o.x*i.x+o.y*i.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(i.x*i.x+i.y*i.y))>-.866&&r.x*i.x+r.y*i.y<0}function sp(t,e,n){const o=e?2|t:-3&t;return n?1|o:-2&o}function ap(){const t=Math.PI/32,e=Math.tan(t),n=Bl;return n*Math.sqrt(1+2*e*e)-n}function lp(t,e,n){const o=1<<n.z,r=Xl(n.x/o),i=Xl((n.x+1)/o),s=Yl(n.y/o),a=Yl((n.y+1)/o);return function(t,e,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0;const s=[];if(!t.length||!n||!o)return s;const a=(t,e)=>{for(const n of t)s.push({polygon:n,bounds:e})},l=Math.ceil(Math.log2(n)),u=Math.ceil(Math.log2(o)),c=l-u,p=[];for(let f=0;f<Math.abs(c);f++)p.push(c>0?0:1);for(let f=0;f<Math.min(l,u);f++)p.push(0),p.push(1);let h=t;if(h=Yc(h,e[0].y-r,e[1].y+r,1),h=Yc(h,e[0].x-r,e[1].x+r,0),!h.length)return s;const d=[];for(p.length?d.push({polygons:h,bounds:e,depth:0}):a(h,e);d.length;){const t=d.pop(),e=t.depth,n=p[e],o=t.bounds[0],s=t.bounds[1],l=0===n?o.x:o.y,u=0===n?s.x:s.y,c=i?i(n,l,u):.5*(l+u),h=Yc(t.polygons,l-r,c+r,n),f=Yc(t.polygons,c-r,u+r,n);if(h.length){const t=[o,new v(0===n?c:s.x,1===n?c:s.y)];p.length>e+1?d.push({polygons:h,bounds:t,depth:e+1}):a(h,t)}if(f.length){const t=[new v(0===n?c:o.x,1===n?c:o.y),s];p.length>e+1?d.push({polygons:f,bounds:t,depth:e+1}):a(f,t)}}return s}(t,e,Math.ceil((i-r)/11.25),Math.ceil((s-a)/11.25),1,((t,e,r)=>{if(0===t)return.5*(e+r);{const t=Yl((n.y+e/aa)/o);return(Wl(.5*(Yl((n.y+r/aa)/o)+t))*o-n.y)*aa}}))}Zr(tp,"FillExtrusionBucket",{omit:["layers","features"]}),Zr($c,"PartMetadata");const up=new Li({"fill-extrusion-edge-radius":new Ai(te["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var cp={paint:new Li({"fill-extrusion-opacity":new Ai(te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Di(te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ai(te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ai(te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Di(te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Di(te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Di(te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ai(te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ai(te["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ai(te["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Ai(te["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:up};function pp(t,e,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[t*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class hp{constructor(t,e,n){this.z=t,this.x=e,this.y=n,this.key=gp(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const n=function(t,e,n){var o=pp(256*t,256*(e=Math.pow(2,n)-e-1),n),r=pp(256*(t+1),256*(e+1),n);return o[0]+","+o[1]+","+r[0]+","+r[1]}(this.x,this.y,this.z),o=function(t,e,n){let o,r="";for(let i=t;i>0;i--)o=1<<i-1,r+=(e&o?1:0)+(n&o?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",o).replace("{bbox-epsg-3857}",n)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}class dp{constructor(t,e){this.wrap=t,this.canonical=e,this.key=gp(t,e.z,e.z,e.x,e.y)}}class fp{constructor(t,e,n,o,r){this.overscaledZ=t,this.wrap=e,this.canonical=new hp(n,+o,+r),this.key=0===e&&t===n?this.canonical.key:gp(e,t,n,o,r)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new fp(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fp(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return gp(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-t;return gp(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new fp(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,o=2*this.canonical.y;return[new fp(e,this.wrap,e,n,o),new fp(e,this.wrap,e,n+1,o),new fp(e,this.wrap,e,n,o+1),new fp(e,this.wrap,e,n+1,o+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new fp(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new fp(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new dp(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}}function gp(t,e,n,o,r){const i=1<<Math.min(n,22);let s=i*(r%i)+o%i;return t&&n<22&&(s+=i*i*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*s+n)+(e-n)}Zr(hp,"CanonicalTileID"),Zr(fp,"OverscaledTileID",{omit:["projMatrix"]});class mp extends v{constructor(t,e,n){super(t,e),this.z=n}}function yp(t,e){return t.x*e.x+t.y*e.y}function vp(t,e){if(1===t.length){let n=0;const o=e[n++];let r;for(;!r||o.equals(r);)if(r=e[n++],!r)return 1/0;for(;n<e.length;n++){const i=e[n],s=t[0],a=r.sub(o),l=i.sub(o),u=s.sub(o),c=yp(a,a),p=yp(a,l),h=yp(l,l),d=yp(u,a),f=yp(u,l),g=c*h-p*p,m=(h*d-p*f)/g,y=(c*f-p*d)/g,v=o.z*(1-m-y)+r.z*m+i.z*y;if(isFinite(v))return v}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}function _p(t,e,n,o,r,i,s,a){const l=s*r.getElevationAt(t,e,!0,!0),u=0!==i[0],c=u?0===i[1]?s*(i[0]/7-450):s*function(t,e,n){const o=Math.floor(e[0]/8),r=Math.floor(e[1]/8),i=10*(e[0]-8*o),s=10*(e[1]-8*r),a=t.getElevationAt(o,r,!0,!0),l=t.getMeterToDEM(n),u=Math.floor(.5*(i*l-1)),c=Math.floor(.5*(s*l-1)),p=t.tileCoordToPixel(o,r),h=2*u+1,d=2*c+1,f=function(t,e,n,o,r){return[t.getElevationAtPixel(e,n,!0),t.getElevationAtPixel(e+r,n,!0),t.getElevationAtPixel(e,n+r,!0),t.getElevationAtPixel(e+o,n+r,!0)]}(t,p.x-u,p.y-c,h,d),g=Math.abs(f[0]-f[1]),m=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),v=Math.min(.25,.5*l*(g+m)/h),_=Math.min(.25,.5*l*y/d);return a+Math.max(v*i,_*s)}(r,i,a):l;return{base:l+(0===n)?-1:n,top:u?Math.max(c+o,l+n+2):l+o}}const Cp=Bi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:wp}=Cp,bp=Bi([{name:"a_packed",components:4,type:"Float32"}]),{members:xp}=bp,Ep=Xc.types,Sp=Math.cos(Math.PI/180*37.5);class Tp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new Ui,this.layoutVertexArray2=new Wi,this.indexArray=new os,this.programConfigurations=new Zs(t.layers,t.zoom),this.segments=new sa,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n,o){this.hasPattern=Sc("line",this.layers,e);const r=this.layers[0].layout.get("line-sort-key"),i=[];for(const{feature:u,id:c,index:p,sourceLayerIndex:h}of t){const t=this.layers[0]._featureFilter.needGeometry,e=au(u,t);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),e,n))continue;const s=r?r.evaluate(e,{},n):void 0,a={id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:p,geometry:t?e.geometry:su(u,n,o),patterns:{},sortKey:s};i.push(a)}r&&i.sort(((t,e)=>t.sortKey-e.sortKey));const{lineAtlas:s,featureIndex:a}=e,l=this.addConstantDashes(s);for(const u of i){const{geometry:o,index:r,sourceLayerIndex:i}=u;if(l&&this.addFeatureDashes(u,s),this.hasPattern){const t=Tc("line",this.layers,u,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(u,o,r,n,s.positions,e.availableImages);a.insert(t[r].feature,o,r,i,this.index)}}addConstantDashes(t){let e=!1;for(const n of this.layers){const o=n.paint.get("line-dasharray").value,r=n.layout.get("line-cap").value;if("constant"!==o.kind||"constant"!==r.kind)e=!0;else{const e=r.value,n=o.value;if(!n)continue;t.addDash(n,e)}}return e}addFeatureDashes(t,e){const n=this.zoom;for(const o of this.layers){const r=o.paint.get("line-dasharray").value,i=o.layout.get("line-cap").value;if("constant"===r.kind&&"constant"===i.kind)continue;let s,a;if("constant"===r.kind){if(s=r.value,!s)continue}else s=r.evaluate({zoom:n},t);a="constant"===i.kind?i.value:i.evaluate({zoom:n},t),e.addDash(s,a),t.patterns[o.id]=e.getKey(s,a)}}update(t,e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n,o)}addFeatures(t,e,n,o,r){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,xp)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wp),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,o,r,i){const s=this.layers[0].layout,a=s.get("line-join").evaluate(t,{}),l=s.get("line-cap").evaluate(t,{}),u=s.get("line-miter-limit"),c=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const p of e)this.addLine(p,t,a,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i,o)}addLine(t,e,n,o,r,i){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===Ep[e.type];let a=t.length;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l=0;for(;l<a-1&&t[l].equals(t[l+1]);)l++;if(a<(s?3:2))return;"bevel"===n&&(r=1.05);const u=this.overscaling<=16?15*aa/(512*this.overscaling):0,c=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let p,h,d,f,g;this.e1=this.e2=-1,s&&(p=t[a-2],g=t[l].sub(p)._unit()._perp());for(let m=l;m<a;m++){if(d=m===a-1?s?t[l+1]:void 0:t[m+1],d&&t[m].equals(d))continue;g&&(f=g),p&&(h=p),p=t[m],g=d?d.sub(p)._unit()._perp():f,f=f||g;let e=f.add(g);0===e.x&&0===e.y||e._unit();const y=f.x*g.x+f.y*g.y,v=e.x*g.x+e.y*g.y,_=0!==v?1/v:1/0,C=2*Math.sqrt(2-2*v),w=v<Sp&&h&&d,b=f.x*g.y-f.y*g.x>0;if(w&&m>l){const t=p.dist(h);if(t>2*u){const e=p.sub(p.sub(h)._mult(u/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,f,0,0,c),h=e}}const x=h&&d;let E=x?n:s?"butt":o;if(x&&"round"===E&&(_<i?E="miter":_<=2&&(E="fakeround")),"miter"===E&&_>r&&(E="bevel"),"bevel"===E&&(_>2&&(E="flipbevel"),_<r&&(E="miter")),h&&this.updateDistance(h,p),"miter"===E)e._mult(_),this.addCurrentVertex(p,e,0,0,c);else if("flipbevel"===E){if(_>100)e=g.mult(-1);else{const t=_*f.add(g).mag()/f.sub(g).mag();e._perp()._mult(t*(b?-1:1))}this.addCurrentVertex(p,e,0,0,c),this.addCurrentVertex(p,e.mult(-1),0,0,c)}else if("bevel"===E||"fakeround"===E){const t=-Math.sqrt(_*_-1),e=b?t:0,n=b?0:t;if(h&&this.addCurrentVertex(p,f,e,n,c),"fakeround"===E){const t=Math.round(180*C/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*t*t+(.848013+y*(.215638*y-1.06021)))}const o=g.sub(f)._mult(n)._add(f)._unit()._mult(b?-1:1);this.addHalfVertex(p,o.x,o.y,!1,b,0,c)}}d&&this.addCurrentVertex(p,g,-e,-n,c)}else if("butt"===E)this.addCurrentVertex(p,e,0,0,c);else if("square"===E){const t=h?1:-1;h||this.addCurrentVertex(p,e,t,t,c),this.addCurrentVertex(p,e,0,0,c),h&&this.addCurrentVertex(p,e,t,t,c)}else"round"===E&&(h&&(this.addCurrentVertex(p,f,0,0,c),this.addCurrentVertex(p,f,1,1,c,!0)),d&&(this.addCurrentVertex(p,g,-1,-1,c,!0),this.addCurrentVertex(p,g,0,0,c)));if(w&&m<a-1){const t=p.dist(d);if(t>2*u){const e=p.add(d.sub(p)._mult(u/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,g,0,0,c),p=e}}}}addCurrentVertex(t,e,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=e.y*o-e.x,a=-e.y-e.x*o;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,i,!1,n,r),this.addHalfVertex(t,s,a,i,!0,-o,r)}addHalfVertex(t,e,n,o,r,i,s){let{x:a,y:l}=t;this.layoutVertexArray.emplaceBack((a<<1)+(o?1:0),(l<<1)+(r?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===i?0:i<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),s.primitiveLength++),r?this.e2=u:this.e1=u}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}Zr(Tp,"LineBucket",{omit:["layers","patternFeatures"]});const Rp=new Li({"line-cap":new Di(te.layout_line["line-cap"]),"line-join":new Di(te.layout_line["line-join"]),"line-miter-limit":new Ai(te.layout_line["line-miter-limit"]),"line-round-limit":new Ai(te.layout_line["line-round-limit"]),"line-sort-key":new Di(te.layout_line["line-sort-key"])});var Op={paint:new Li({"line-opacity":new Di(te.paint_line["line-opacity"]),"line-color":new Di(te.paint_line["line-color"]),"line-translate":new Ai(te.paint_line["line-translate"]),"line-translate-anchor":new Ai(te.paint_line["line-translate-anchor"]),"line-width":new Di(te.paint_line["line-width"]),"line-gap-width":new Di(te.paint_line["line-gap-width"]),"line-offset":new Di(te.paint_line["line-offset"]),"line-blur":new Di(te.paint_line["line-blur"]),"line-dasharray":new Di(te.paint_line["line-dasharray"]),"line-pattern":new Di(te.paint_line["line-pattern"]),"line-gradient":new Mi(te.paint_line["line-gradient"]),"line-trim-offset":new Ai(te.paint_line["line-trim-offset"])}),layout:Rp};const Pp=new class extends Di{possiblyEvaluate(t,e){return e=new bi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,o){return e=D({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,o)}}(Op.paint.properties["line-width"].specification);function Ip(t,e){return e>0?e+2*t:t}Pp.useIntegerZoom=!0;const Ap=Bi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Dp=Bi([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Mp=Bi([{name:"a_projected_pos",components:4,type:"Float32"}],4);Bi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Lp=Bi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Np=Bi([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Bi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Fp=Bi([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),kp=Bi([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Bi([{name:"triangle",components:3,type:"Uint16"}]),Bi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Bi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Bi([{type:"Float32",name:"offsetX"}]),Bi([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Gp=24;const Bp=128;function Vp(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new bi(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:o}=n;let r=0;for(;r<e.length&&e[r]<=t;)r++;r=Math.max(0,r-1);let i=r;for(;i<e.length&&e[i]<t+1;)i++;i=Math.min(e.length-1,i);const s=e[r],a=e[i];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:o}:{kind:"camera",minZoom:s,maxZoom:a,minSize:n.evaluate(new bi(s)),maxSize:n.evaluate(new bi(a)),interpolationType:o}}}function zp(t,e,n){let{uSize:o,uSizeT:r}=e,{lowerSize:i,upperSize:s}=n;return"source"===t.kind?i/Bp:"composite"===t.kind?Dn(i/Bp,s/Bp,r):o}function jp(t,e){let n=0,o=0;if("constant"===t.kind)o=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:i,maxZoom:s}=t,a=r?R(to.interpolationFactor(r,e,i,s),0,1):0;"camera"===t.kind?o=Dn(t.minSize,t.maxSize,a):n=a}return{uSizeT:n,uSize:o}}var Hp=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Bp,evaluateSizeForFeature:zp,evaluateSizeForZoom:jp,getSizeData:Vp});function Up(t,e,n){return t.sections.forEach((t=>{t.text=function(t,e,n){const o=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===o?t=t.toLocaleUpperCase():"lowercase"===o&&(t=t.toLocaleLowerCase()),wi.applyArabicShaping&&(t=wi.applyArabicShaping(t)),t}(t.text,e,n)})),t}const Wp={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function qp(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function Xp(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var Yp=Jp,Kp=function(t,e,n,o,r){var i,s,a=8*r-o-1,l=(1<<a)-1,u=l>>1,c=-7,p=n?r-1:0,h=n?-1:1,d=t[e+p];for(p+=h,i=d&(1<<-c)-1,d>>=-c,c+=a;c>0;i=256*i+t[e+p],p+=h,c-=8);for(s=i&(1<<-c)-1,i>>=-c,c+=o;c>0;s=256*s+t[e+p],p+=h,c-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,o),i-=u}return(d?-1:1)*s*Math.pow(2,i-o)},Zp=function(t,e,n,o,r,i){var s,a,l,u=8*i-r-1,c=(1<<u)-1,p=c>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=o?0:i-1,f=o?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+p>=1?h/l:h*Math.pow(2,1-p))*l>=2&&(s++,l/=2),s+p>=c?(a=0,s=c):s+p>=1?(a=(e*l-1)*Math.pow(2,r),s+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,r),s=0));r>=8;t[n+d]=255&a,d+=f,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;t[n+d]=255&s,d+=f,s/=256,u-=8);t[n+d-f]|=128*g};function Jp(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Jp.Varint=0,Jp.Fixed64=1,Jp.Bytes=2,Jp.Fixed32=5;var Qp=4294967296,$p=1/Qp,th="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function eh(t){return t.type===Jp.Bytes?t.readVarint()+t.pos:t.pos+1}function nh(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function oh(t,e,n){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(o);for(var r=n.pos-1;r>=t;r--)n.buf[r+o]=n.buf[r]}function rh(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function ih(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function sh(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function ah(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function lh(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function uh(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function ch(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function ph(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function hh(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function dh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function fh(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function gh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Jp.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var o=this.readVarint(),r=o>>3,i=this.pos;this.type=7&o,t(r,e,this),this.pos===i&&this.skip(o)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=dh(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=gh(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=dh(this.buf,this.pos)+dh(this.buf,this.pos+4)*Qp;return this.pos+=8,t},readSFixed64:function(){var t=dh(this.buf,this.pos)+gh(this.buf,this.pos+4)*Qp;return this.pos+=8,t},readFloat:function(){var t=Kp(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Kp(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,o=this.buf;return e=127&(n=o[this.pos++]),n<128?e:(e|=(127&(n=o[this.pos++]))<<7,n<128?e:(e|=(127&(n=o[this.pos++]))<<14,n<128?e:(e|=(127&(n=o[this.pos++]))<<21,n<128?e:function(t,e,n){var o,r,i=n.buf;if(o=(112&(r=i[n.pos++]))>>4,r<128)return nh(t,o,e);if(o|=(127&(r=i[n.pos++]))<<3,r<128)return nh(t,o,e);if(o|=(127&(r=i[n.pos++]))<<10,r<128)return nh(t,o,e);if(o|=(127&(r=i[n.pos++]))<<17,r<128)return nh(t,o,e);if(o|=(127&(r=i[n.pos++]))<<24,r<128)return nh(t,o,e);if(o|=(1&(r=i[n.pos++]))<<31,r<128)return nh(t,o,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=o[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&th?function(t,e,n){return th.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var o="",r=e;r<n;){var i,s,a,l=t[r],u=null,c=l>239?4:l>223?3:l>191?2:1;if(r+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(i=t[r+1]))&&(u=(31&l)<<6|63&i)<=127&&(u=null):3===c?(s=t[r+2],128==(192&(i=t[r+1]))&&128==(192&s)&&((u=(15&l)<<12|(63&i)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(s=t[r+2],a=t[r+3],128==(192&(i=t[r+1]))&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&i)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,o+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),o+=String.fromCharCode(u),r+=c}return o}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Jp.Bytes)return t.push(this.readVarint(e));var n=eh(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Jp.Bytes)return t.push(this.readSVarint());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Jp.Bytes)return t.push(this.readBoolean());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Jp.Bytes)return t.push(this.readFloat());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Jp.Bytes)return t.push(this.readDouble());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Jp.Bytes)return t.push(this.readFixed32());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Jp.Bytes)return t.push(this.readSFixed32());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Jp.Bytes)return t.push(this.readFixed64());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Jp.Bytes)return t.push(this.readSFixed64());var e=eh(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Jp.Varint)for(;this.buf[this.pos++]>127;);else if(e===Jp.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Jp.Fixed32)this.pos+=4;else{if(e!==Jp.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),fh(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),fh(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),fh(this.buf,-1&t,this.pos),fh(this.buf,Math.floor(t*$p),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),fh(this.buf,-1&t,this.pos),fh(this.buf,Math.floor(t*$p),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,o;if(t>=0?(n=t%4294967296|0,o=t/4294967296|0):(o=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,o=o+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(o,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var o,r,i=0;i<e.length;i++){if((o=e.charCodeAt(i))>55295&&o<57344){if(!r){o>56319||i+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=o;continue}if(o<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=o;continue}o=r-55296<<10|o-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);o<128?t[n++]=o:(o<2048?t[n++]=o>>6|192:(o<65536?t[n++]=o>>12|224:(t[n++]=o>>18|240,t[n++]=o>>12&63|128),t[n++]=o>>6&63|128),t[n++]=63&o|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&oh(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Zp(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Zp(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var o=this.pos-n;o>=128&&oh(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeMessage:function(t,e,n){this.writeTag(t,Jp.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,rh,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,ih,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,lh,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,sh,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,ah,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,uh,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ch,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,ph,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,hh,e)},writeBytesField:function(t,e){this.writeTag(t,Jp.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Jp.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Jp.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Jp.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Jp.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Jp.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Jp.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Jp.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Jp.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Jp.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var mh=h(Yp);const yh=3;function vh(t,e,n){e.glyphs=[],1===t&&n.readMessage(_h,e)}function _h(t,e,n){if(3===t){const{id:t,bitmap:o,width:r,height:i,left:s,top:a,advance:l}=n.readMessage(Ch,{});e.glyphs.push({id:t,bitmap:new Gu({width:r+2*yh,height:i+2*yh},o),metrics:{width:r,height:i,left:s,top:a,advance:l}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function Ch(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}const wh=yh;function bh(t){let e=0,n=0;for(const s of t)e+=s.w*s.h,n=Math.max(n,s.w);t.sort(((t,e)=>e.h-t.h));const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let r=0,i=0;for(const s of t)for(let t=o.length-1;t>=0;t--){const e=o[t];if(!(s.w>e.w||s.h>e.h)){if(s.x=e.x,s.y=e.y,i=Math.max(i,s.y+s.h),r=Math.max(r,s.x+s.w),s.w===e.w&&s.h===e.h){const e=o.pop();t<o.length&&(o[t]=e)}else s.h===e.h?(e.x+=s.w,e.w-=s.w):s.w===e.w?(e.y+=s.h,e.h-=s.h):(o.push({x:e.x+s.w,y:e.y,w:e.w-s.w,h:s.h}),e.y+=s.h,e.h-=s.h);break}}return{w:r,h:i,fill:e/(r*i)||0}}const xh=1;class Eh{constructor(t,e){let{pixelRatio:n,version:o,stretchX:r,stretchY:i,content:s}=e;this.paddedRect=t,this.pixelRatio=n,this.stretchX=r,this.stretchY=i,this.content=s,this.version=o}get tl(){return[this.paddedRect.x+xh,this.paddedRect.y+xh]}get br(){return[this.paddedRect.x+this.paddedRect.w-xh,this.paddedRect.y+this.paddedRect.h-xh]}get displaySize(){return[(this.paddedRect.w-2*xh)/this.pixelRatio,(this.paddedRect.h-2*xh)/this.pixelRatio]}}class Sh{constructor(t,e){const n={},o={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,n,r),this.addImages(e,o,r);const{w:i,h:s}=bh(r),a=new Bu({width:i||1,height:s||1});for(const l in t){const e=t[l],o=n[l].paddedRect;Bu.copy(e.data,a,{x:0,y:0},{x:o.x+xh,y:o.y+xh},e.data)}for(const l in e){const t=e[l],n=o[l].paddedRect,r=n.x+xh,i=n.y+xh,s=t.data.width,u=t.data.height;Bu.copy(t.data,a,{x:0,y:0},{x:r,y:i},t.data),Bu.copy(t.data,a,{x:0,y:u-1},{x:r,y:i-1},{width:s,height:1}),Bu.copy(t.data,a,{x:0,y:0},{x:r,y:i+u},{width:s,height:1}),Bu.copy(t.data,a,{x:s-1,y:0},{x:r-1,y:i},{width:1,height:u}),Bu.copy(t.data,a,{x:0,y:0},{x:r+s,y:i},{width:1,height:u})}this.image=a,this.iconPositions=n,this.patternPositions=o}addImages(t,e,n){for(const o in t){const r=t[o],i={x:0,y:0,w:r.data.width+2*xh,h:r.data.height+2*xh};n.push(i),e[o]=new Eh(i,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(o)}}patchUpdatedImages(t,e){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((e=>t.hasImage(e))),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[o,r]=t.tl;n.update(e.data,void 0,{x:o,y:r})}}Zr(Eh,"ImagePosition"),Zr(Sh,"ImageAtlas");const Th={horizontal:1,vertical:2,horizontalOnly:3},Rh=-17;class Oh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new Oh;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new Oh;return e.imageName=t,e}}class Ph{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new Ph;for(let o=0;o<t.sections.length;o++){const r=t.sections[o];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(t,e){let n="";for(let o=0;o<t.length;o++){const r=t.charCodeAt(o+1)||null,i=t.charCodeAt(o-1)||null;n+=!e&&(r&&si(r)&&!Wp[t[o+1]]||i&&si(i)&&!Wp[t[o-1]])||!Wp[t[o]]?t[o]:Wp[t[o]]}return n}(this.text,t)}trim(){let t=0;for(let n=0;n<this.text.length&&Ah[this.text.charCodeAt(n)];n++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&Ah[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new Ph;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Oh.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let o=0;o<t.text.length;++o)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void U("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Oh.forImage(e)),this.sectionIndex.push(this.sections.length-1)):U("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ih(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f){const g=Ph.fromFeature(t,r);p===Th.vertical&&g.verticalizePunctuation(h);let m=[];const y=function(t,e,n,o,r,i){if(!t)return[];const s=[],a=function(t,e,n,o,r,i){let s=0;for(let a=0;a<t.length();a++){const n=t.getSection(a);s+=Mh(t.getCharCode(a),n,o,r,e,i)}return s/Math.max(1,Math.ceil(s/n))}(t,e,n,o,r,i),l=t.text.indexOf("\u200b")>=0;let u=0;for(let p=0;p<t.length();p++){const n=t.getSection(p),h=t.getCharCode(p);if(Ah[h]||(u+=Mh(h,n,o,r,e,i)),p<t.length()-1){const e=!((c=h)<11904||!(ei["Bopomofo Extended"](c)||ei.Bopomofo(c)||ei["CJK Compatibility Forms"](c)||ei["CJK Compatibility Ideographs"](c)||ei["CJK Compatibility"](c)||ei["CJK Radicals Supplement"](c)||ei["CJK Strokes"](c)||ei["CJK Symbols and Punctuation"](c)||ei["CJK Unified Ideographs Extension A"](c)||ei["CJK Unified Ideographs"](c)||ei["Enclosed CJK Letters and Months"](c)||ei["Halfwidth and Fullwidth Forms"](c)||ei.Hiragana(c)||ei["Ideographic Description Characters"](c)||ei["Kangxi Radicals"](c)||ei["Katakana Phonetic Extensions"](c)||ei.Katakana(c)||ei["Vertical Forms"](c)||ei["Yi Radicals"](c)||ei["Yi Syllables"](c)));(Dh[h]||e||n.imageName)&&s.push(Fh(p+1,u,a,s,Nh(h,t.getCharCode(p+1),e&&l),!1))}}var c;return kh(Fh(t.length(),u,a,s,0,!0))}(g,u,i,e,o,d),{processBidirectionalText:v,processStyledBidirectionalText:_}=wi;if(v&&1===g.sections.length){const t=v(g.toString(),y);for(const e of t){const t=new Ph;t.text=e,t.sections=g.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);m.push(t)}}else if(_){const t=_(g.text,g.sectionIndex,y);for(const e of t){const t=new Ph;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,m.push(t)}}else m=function(t,e){const n=[],o=t.text;let r=0;for(const i of e)n.push(t.substring(r,i)),r=i;return r<o.length&&n.push(t.substring(r,o.length)),n}(g,y);const C=[],w={positionedLines:C,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(t,e,n,o,r,i,s,a,l,u,c,p){let h=0,d=0,f=0;const g="right"===a?1:"left"===a?0:.5;let m=!1;for(const b of r){const t=b.getSections();for(const n of t){if(n.imageName)continue;const t=e[n.fontStack];if(t&&(m=void 0!==t.ascender&&void 0!==t.descender,!m))break}if(!m)break}let y=0;for(const b of r){b.trim();const r=b.getMaxScale(),s=(r-1)*Gp,a={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=a;const _=a.positionedGlyphs;let C=0;if(!b.length()){d+=i,++y;continue}let w=0,x=0;for(let i=0;i<b.length();i++){const s=b.getSection(i),a=b.getSectionIndex(i),f=b.getCharCode(i);let g=s.scale,y=null,E=null,S=null,T=Gp,R=0;const O=!(l===Th.horizontal||!c&&!ii(f)||c&&(Ah[f]||(v=f,ei.Arabic(v)||ei["Arabic Supplement"](v)||ei["Arabic Extended-A"](v)||ei["Arabic Presentation Forms-A"](v)||ei["Arabic Presentation Forms-B"](v))));if(s.imageName){const e=o[s.imageName];if(!e)continue;S=s.imageName,t.iconsInText=t.iconsInText||!0,E=e.paddedRect;const n=e.displaySize;g=g*Gp/p,y={width:n[0],height:n[1],left:xh,top:-wh,advance:O?n[1]:n[0],localGlyph:!1},R=m?-y.height*g:Rh+r*Gp-n[1]*g,T=y.advance;const i=(O?n[0]:n[1])*g-Gp*r;i>0&&i>C&&(C=i)}else{const t=n[s.fontStack];if(!t)continue;t[f]&&(E=t[f]);const o=e[s.fontStack];if(!o)continue;const i=o.glyphs[f];if(!i)continue;if(y=i.metrics,T=8203!==f?Gp:0,m){const t=void 0!==o.ascender?Math.abs(o.ascender):0,e=void 0!==o.descender?Math.abs(o.descender):0,n=(t+e)*g;w<n&&(w=n,x=(t-e)/2*g),R=-t*g}else R=Rh+(r-g)*Gp}O?(t.verticalizable=!0,_.push({glyph:f,imageName:S,x:h,y:d+R,vertical:O,scale:g,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:E}),h+=T*g+u):(_.push({glyph:f,imageName:S,x:h,y:d+R,vertical:O,scale:g,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:E}),h+=y.advance*g+u)}0!==_.length&&(f=Math.max(h-u,f),m?Bh(_,g,C,x,i*r/2):Bh(_,g,C,0,i/2)),h=0;const E=i*r+C;a.lineOffset=Math.max(C,s),d+=E,++y}var v;const _=d,{horizontalAlign:C,verticalAlign:w}=Gh(s);(function(t,e,n,o,r,i){const s=(e-n)*r,a=-i*o;for(const l of t)for(const t of l.positionedGlyphs)t.x+=s,t.y+=a})(t.positionedLines,g,C,w,f,_),t.top+=-w*_,t.bottom=t.top+_,t.left+=-C*f,t.right=t.left+f,t.hasBaseline=m}(w,e,n,o,m,s,a,l,p,u,h,f),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(C)&&w}const Ah={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Dh={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Mh(t,e,n,o,r,i){if(e.imageName){const t=o[e.imageName];return t?t.displaySize[0]*e.scale*Gp/i+r:0}{const o=n[e.fontStack],i=o&&o.glyphs[t];return i?i.metrics.advance*e.scale+r:0}}function Lh(t,e,n,o){const r=Math.pow(t-e,2);return o?t<e?r/2:2*r:r+Math.abs(n)*n}function Nh(t,e,n){let o=0;return 10===t&&(o-=1e4),n&&(o+=150),40!==t&&65288!==t||(o+=50),41!==e&&65289!==e||(o+=50),o}function Fh(t,e,n,o,r,i){let s=null,a=Lh(e,n,r,i);for(const l of o){const t=Lh(e-l.x,n,r,i)+l.badness;t<=a&&(s=l,a=t)}return{index:t,x:e,priorBreak:s,badness:a}}function kh(t){return t?kh(t.priorBreak).concat(t.index):[]}function Gh(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Bh(t,e,n,o,r){if(!(e||n||o||r))return;const i=t.length-1,s=t[i],a=(s.x+s.metrics.advance*s.scale)*e;for(let l=0;l<=i;l++)t[l].x-=a,t[l].y+=n+o+r}function Vh(t,e,n){const{horizontalAlign:o,verticalAlign:r}=Gh(n),i=e[0]-t.displaySize[0]*o,s=e[1]-t.displaySize[1]*r;return{image:t,top:s,bottom:s+t.displaySize[1],left:i,right:i+t.displaySize[0]}}function zh(t,e,n,o,r,i){const s=t.image;let a;if(s.content){const t=s.content,e=s.pixelRatio||1;a=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*i,u=e.right*i;let c,p,h,d;"width"===n||"both"===n?(d=r[0]+l-o[3],p=r[0]+u+o[1]):(d=r[0]+(l+u-s.displaySize[0])/2,p=d+s.displaySize[0]);const f=e.top*i,g=e.bottom*i;return"height"===n||"both"===n?(c=r[1]+f-o[0],h=r[1]+g+o[2]):(c=r[1]+(f+g-s.displaySize[1])/2,h=c+s.displaySize[1]),{image:s,top:c,right:p,bottom:h,left:d,collisionPadding:a}}class jh extends v{constructor(t,e,n,o,r){super(t,e),this.angle=o,this.z=n,void 0!==r&&(this.segment=r)}clone(){return new jh(this.x,this.y,this.z,this.angle,this.segment)}}function Hh(t,e,n,o,r){if(void 0===e.segment)return!0;let i=e,s=e.segment+1,a=0;for(;a>-n/2;){if(s--,s<0)return!1;a-=t[s].dist(i),i=t[s]}a+=t[s].dist(t[s+1]),s++;const l=[];let u=0;for(;a<n/2;){const e=t[s],n=t[s+1];if(!n)return!1;let i=t[s-1].angleTo(e)-e.angleTo(n);for(i=Math.abs((i+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:i}),u+=i;a-l[0].distance>o;)u-=l.shift().angleDelta;if(u>r)return!1;s++,a+=e.dist(n)}return!0}function Uh(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Wh(t,e,n){return t?.6*e*n:0}function qh(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Xh(t,e,n,o,r,i){const s=Wh(n,r,i),a=qh(n,o)*i;let l=0;const u=Uh(t)/2;for(let c=0;c<t.length-1;c++){const n=t[c],o=t[c+1],r=n.dist(o);if(l+r>u){const i=(u-l)/r,p=Dn(n.x,o.x,i),h=Dn(n.y,o.y,i),d=new jh(p,h,0,o.angleTo(n),c);return!s||Hh(t,d,a,s,e)?d:void 0}l+=r}}function Yh(t,e,n,o,r,i,s,a,l){const u=Wh(o,i,s),c=qh(o,r),p=c*s,h=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-p<e/4&&(e=p+e/4),Kh(t,h?e/2*a%e:(c/2+2*i)*s*a%e,e,u,n,p,h,!1,l)}function Kh(t,e,n,o,r,i,s,a,l){const u=i/2,c=Uh(t);let p=0,h=e-n,d=[];for(let f=0;f<t.length-1;f++){const e=t[f],s=t[f+1],a=e.dist(s),g=s.angleTo(e);for(;h+n<p+a;){h+=n;const m=(h-p)/a,y=Dn(e.x,s.x,m),v=Dn(e.y,s.y,m);if(y>=0&&y<l&&v>=0&&v<l&&h-u>=0&&h+u<=c){const e=new jh(y,v,0,g,f);e._round(),o&&!Hh(t,e,i,o,r)||d.push(e)}}p+=a}return a||d.length||s||(d=Kh(t,p/2,n,o,r,i,s,!0,l)),d}function Zh(t,e,n,o,r){const i=[];for(let s=0;s<t.length;s++){const a=t[s];let l;for(let t=0;t<a.length-1;t++){let s=a[t],u=a[t+1];s.x<e&&u.x<e||(s.x<e?s=new v(e,s.y+(e-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x<e&&(u=new v(e,s.y+(e-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y<n&&u.y<n||(s.y<n?s=new v(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round():u.y<n&&(u=new v(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round()),s.x>=o&&u.x>=o||(s.x>=o?s=new v(o,s.y+(o-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x>=o&&(u=new v(o,s.y+(o-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y>=r&&u.y>=r||(s.y>=r?s=new v(s.x+(r-s.y)/(u.y-s.y)*(u.x-s.x),r)._round():u.y>=r&&(u=new v(s.x+(r-s.y)/(u.y-s.y)*(u.x-s.x),r)._round()),l&&s.equals(l[l.length-1])||(l=[s],i.push(l)),l.push(u)))))}}return i}Zr(jh,"Anchor");const Jh=1e20;function Qh(t,e,n,o,r,i,s,a,l){for(let u=e;u<e+o;u++)$h(t,n*i+u,i,r,s,a,l);for(let u=n;u<n+r;u++)$h(t,u*i+e,1,o,s,a,l)}function $h(t,e,n,o,r,i,s){i[0]=0,s[0]=-Jh,s[1]=Jh,r[0]=t[e];for(let a=1,l=0,u=0;a<o;a++){r[a]=t[e+a*n];const o=a*a;do{const t=i[l];u=(r[a]-r[t]+o-t*t)/(a-t)/2}while(u<=s[l]&&--l>-1);l++,i[l]=a,s[l]=u,s[l+1]=Jh}for(let a=0,l=0;a<o;a++){for(;s[l+1]<a;)l++;const o=i[l],u=a-o;t[e+a*n]=r[o]+u*u}}const td=2,ed={none:0,ideographs:1,all:2};class nd{constructor(t,e,n){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,e){const n=[];for(const o in t)for(const e of t[o])n.push({stack:o,id:e});I(n,((t,e)=>{let{stack:n,id:o}=t,r=this.entries[n];r||(r=this.entries[n]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let i=r.glyphs[o];if(void 0!==i)return void e(null,{stack:n,id:o,glyph:i});if(i=this._tinySDF(r,n,o),i)return r.glyphs[o]=i,void e(null,{stack:n,id:o,glyph:i});const s=Math.floor(o/256);if(256*s>65535)return void e(new Error("glyphs > 65535 not supported"));if(r.ranges[s])return void e(null,{stack:n,id:o,glyph:i});let a=r.requests[s];a||(a=r.requests[s]=[],nd.loadGlyphRange(n,s,this.url,this.requestManager,((t,e)=>{if(e){r.ascender=e.ascender,r.descender=e.descender;for(const t in e.glyphs)this._doesCharSupportLocalGlyph(+t)||(r.glyphs[+t]=e.glyphs[+t]);r.ranges[s]=!0}for(const n of a)n(t,e);delete r.requests[s]}))),a.push(((t,r)=>{t?e(t):r&&e(null,{stack:n,id:o,glyph:r.glyphs[o]||null})}))}),((t,n)=>{if(t)e(t);else if(n){const t={};for(const{stack:e,id:o,glyph:r}of n)void 0===t[e]&&(t[e]={}),void 0===t[e].glyphs&&(t[e].glyphs={}),t[e].glyphs[o]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics},t[e].ascender=this.entries[e].ascender,t[e].descender=this.entries[e].descender;e(null,t)}}))}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==ed.none&&(this.localGlyphMode===ed.all?!!this.localFontFamily:!!this.localFontFamily&&(ei["CJK Unified Ideographs"](t)||ei["Hangul Syllables"](t)||ei.Hiragana(t)||ei.Katakana(t)||ei["CJK Symbols and Punctuation"](t)))}_tinySDF(t,e,n){const o=this.localFontFamily;if(!o||!this._doesCharSupportLocalGlyph(n))return;let r=t.tinySDF;if(!r){let n="400";/bold/i.test(e)?n="900":/medium/i.test(e)?n="500":/light/i.test(e)&&(n="200"),r=t.tinySDF=new nd.TinySDF({fontFamily:o,fontWeight:n,fontSize:24*td,buffer:3*td,radius:8*td}),r.fontWeight=n}if(this.localGlyphs[r.fontWeight][n])return this.localGlyphs[r.fontWeight][n];const i=String.fromCharCode(n),{data:s,width:a,height:l,glyphWidth:u,glyphHeight:c,glyphLeft:p,glyphTop:h,glyphAdvance:d}=r.draw(i);return this.localGlyphs[r.fontWeight][n]={id:n,bitmap:new Gu({width:a,height:l},s),metrics:{width:u/td,height:c/td,left:p/td,top:h/td-27,advance:d/td,localGlyph:!0}}}}nd.loadGlyphRange=function(t,e,n,o,r){const i=256*e,s=i+255,a=o.transformRequest(o.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}","".concat(i,"-").concat(s)),lt.Glyphs);ht(a,((t,e)=>{if(t)r(t);else if(e){const t={},n=function(t){return new mh(t).readFields(vh,{})}(e);for(const e of n.glyphs)t[e.id]=e;r(null,{glyphs:t,ascender:n.ascender,descender:n.descender})}}))},nd.TinySDF=class{constructor(){let{fontSize:t=24,buffer:e=3,radius:n=8,cutoff:o=.25,fontFamily:r="sans-serif",fontWeight:i="normal",fontStyle:s="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=e,this.cutoff=o,this.radius=n;const a=this.size=t+4*e,l=this._createCanvas(a),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font="".concat(s," ").concat(i," ").concat(t,"px ").concat(r),u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:o,actualBoundingBoxLeft:r,actualBoundingBoxRight:i}=this.ctx.measureText(t),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(i-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(o)),u=a+2*this.buffer,c=l+2*this.buffer,p=Math.max(u*c,0),h=new Uint8ClampedArray(p),d={data:h,width:u,height:c,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return d;const{ctx:f,buffer:g,gridInner:m,gridOuter:y}=this;f.clearRect(g,g,a,l),f.fillText(t,g,g+s);const v=f.getImageData(g,g,a,l);y.fill(Jh,0,p),m.fill(0,0,p);for(let _=0;_<l;_++)for(let t=0;t<a;t++){const e=v.data[4*(_*a+t)+3]/255;if(0===e)continue;const n=(_+g)*u+t+g;if(1===e)y[n]=0,m[n]=Jh;else{const t=.5-e;y[n]=t>0?t*t:0,m[n]=t<0?t*t:0}}Qh(y,0,0,u,c,u,this.f,this.v,this.z),Qh(m,g,g,a,l,u,this.f,this.v,this.z);for(let _=0;_<p;_++){const t=Math.sqrt(y[_])-Math.sqrt(m[_]);h[_]=Math.round(255-255*(t/this.radius+this.cutoff))}return d}};const od=xh;function rd(t,e,n,o){const r=[],i=t.image,s=i.pixelRatio,a=i.paddedRect.w-2*od,l=i.paddedRect.h-2*od,u=t.right-t.left,c=t.bottom-t.top,p=i.stretchX||[[0,a]],h=i.stretchY||[[0,l]],d=(t,e)=>t+e[1]-e[0],f=p.reduce(d,0),g=h.reduce(d,0),m=a-f,y=l-g;let _=0,C=f,w=0,b=g,x=0,E=m,S=0,T=y;if(i.content&&o){const t=i.content;_=id(p,0,t[0]),w=id(h,0,t[1]),C=id(p,t[0],t[2]),b=id(h,t[1],t[3]),x=t[0]-_,S=t[1]-w,E=t[2]-t[0]-C,T=t[3]-t[1]-b}const R=(o,r,a,l)=>{const p=ad(o.stretch-_,C,u,t.left),h=ld(o.fixed-x,E,o.stretch,f),d=ad(r.stretch-w,b,c,t.top),m=ld(r.fixed-S,T,r.stretch,g),y=ad(a.stretch-_,C,u,t.left),R=ld(a.fixed-x,E,a.stretch,f),O=ad(l.stretch-w,b,c,t.top),P=ld(l.fixed-S,T,l.stretch,g),I=new v(p,d),A=new v(y,d),D=new v(y,O),M=new v(p,O),L=new v(h/s,m/s),N=new v(R/s,P/s),F=e*Math.PI/180;if(F){const t=Math.sin(F),e=Math.cos(F),n=[e,-t,t,e];I._matMult(n),A._matMult(n),M._matMult(n),D._matMult(n)}const k=o.stretch+o.fixed,G=r.stretch+r.fixed;return{tl:I,tr:A,bl:M,br:D,tex:{x:i.paddedRect.x+od+k,y:i.paddedRect.y+od+G,w:a.stretch+a.fixed-k,h:l.stretch+l.fixed-G},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:N,minFontScaleX:E/s/u,minFontScaleY:T/s/c,isSDF:n}};if(o&&(i.stretchX||i.stretchY)){const t=sd(p,m,f),e=sd(h,y,g);for(let n=0;n<t.length-1;n++){const o=t[n],i=t[n+1];for(let t=0;t<e.length-1;t++)r.push(R(o,e[t],i,e[t+1]))}}else r.push(R({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:l+1}));return r}function id(t,e,n){let o=0;for(const r of t)o+=Math.max(e,Math.min(n,r[1]))-Math.max(e,Math.min(n,r[0]));return o}function sd(t,e,n){const o=[{fixed:-od,stretch:0}];for(const[r,i]of t){const t=o[o.length-1];o.push({fixed:r-t.stretch,stretch:t.stretch}),o.push({fixed:r-t.stretch,stretch:t.stretch+(i-r)})}return o.push({fixed:e+od,stretch:n}),o}function ad(t,e,n,o){return t/e*n+o}function ld(t,e,n,o){return t-e*n/o}function ud(t,e,n,o){const r=e+t.positionedLines[o].lineOffset;return 0===o?n+r/2:n+(r+(e+t.positionedLines[o-1].lineOffset))/2}class cd{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pd;if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,o=e[t];for(;t>0;){const r=t-1>>1,i=e[r];if(n(o,i)>=0)break;e[t]=i,t=r}e[t]=o}_down(t){const{data:e,compare:n}=this,o=this.length>>1,r=e[t];for(;t<o;){let o=1+(t<<1),i=e[o];const s=o+1;if(s<this.length&&n(e[s],i)<0&&(o=s,i=e[s]),n(i,r)>=0)break;e[t]=i,t=o}e[t]=r}}function pd(t,e){return t<e?-1:t>e?1:0}function hd(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=1/0,r=1/0,i=-1/0,s=-1/0;const a=t[0];for(let d=0;d<a.length;d++){const t=a[d];(!d||t.x<o)&&(o=t.x),(!d||t.y<r)&&(r=t.y),(!d||t.x>i)&&(i=t.x),(!d||t.y>s)&&(s=t.y)}const l=Math.min(i-o,s-r);let u=l/2;const c=new cd([],dd);if(0===l)return new v(o,r);for(let d=o;d<i;d+=l)for(let e=r;e<s;e+=l)c.push(new fd(d+u,e+u,u,t));let p=function(t){let e=0,n=0,o=0;const r=t[0];for(let i=0,s=r.length,a=s-1;i<s;a=i++){const t=r[i],s=r[a],l=t.x*s.y-s.x*t.y;n+=(t.x+s.x)*l,o+=(t.y+s.y)*l,e+=3*l}return new fd(n/e,o/e,0,t)}(t),h=c.length;for(;c.length;){const o=c.pop();(o.d>p.d||!p.d)&&(p=o,n&&console.log("found best %d after %d probes",Math.round(1e4*o.d)/1e4,h)),o.max-p.d<=e||(u=o.h/2,c.push(new fd(o.p.x-u,o.p.y-u,u,t)),c.push(new fd(o.p.x+u,o.p.y-u,u,t)),c.push(new fd(o.p.x-u,o.p.y+u,u,t)),c.push(new fd(o.p.x+u,o.p.y+u,u,t)),h+=4)}return n&&(console.log("num probes: ".concat(h)),console.log("best distance: ".concat(p.d))),p.p}function dd(t,e){return e.max-t.max}class fd{constructor(t,e,n,o){this.p=new v(t,e),this.h=n,this.d=function(t,e){let n=!1,o=1/0;for(let r=0;r<e.length;r++){const i=e[r];for(let e=0,r=i.length,s=r-1;e<r;s=e++){const r=i[e],a=i[s];r.y>t.y!=a.y>t.y&&t.x<(a.x-r.x)*(t.y-r.y)/(a.y-r.y)+r.x&&(n=!n),o=Math.min(o,vu(t,r,a))}}return(n?1:-1)*Math.sqrt(o)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}}const gd=7,md=Number.POSITIVE_INFINITY,yd=Math.sqrt(2);function vd(t,e){let[n,o]=e,r=0,i=0;if(o===md){n<0&&(n=0);const e=n/yd;switch(t){case"top-right":case"top-left":i=e-gd;break;case"bottom-right":case"bottom-left":i=-e+gd;break;case"bottom":i=-n+gd;break;case"top":i=n-gd}switch(t){case"top-right":case"bottom-right":r=-e;break;case"top-left":case"bottom-left":r=e;break;case"left":r=n;break;case"right":r=-n}}else{switch(n=Math.abs(n),o=Math.abs(o),t){case"top-right":case"top-left":case"top":i=o-gd;break;case"bottom-right":case"bottom-left":case"bottom":i=-o+gd}switch(t){case"top-right":case"bottom-right":case"right":r=-n;break;case"top-left":case"bottom-left":case"left":r=n}}return[r,i]}function _d(t,e,n,o,r,i,s,a,l,u){t.createArrays(),t.tilePixelRatio=aa/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const c=t.layers[0].layout,p=t.layers[0]._unevaluatedLayout._values,h={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.textSizeData;h.compositeTextSizes=[p["text-size"].possiblyEvaluate(new bi(e),a),p["text-size"].possiblyEvaluate(new bi(n),a)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.iconSizeData;h.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new bi(e),a),p["icon-size"].possiblyEvaluate(new bi(n),a)]}h.layoutTextSize=p["text-size"].possiblyEvaluate(new bi(l+1),a),h.layoutIconSize=p["icon-size"].possiblyEvaluate(new bi(l+1),a),h.textMaxSize=p["text-size"].possiblyEvaluate(new bi(18),a);const d="map"===c.get("text-rotation-alignment")&&"point"!==c.get("symbol-placement"),f=c.get("text-size");for(const g of t.features){const i=c.get("text-font").evaluate(g,{},a).join(","),l=f.evaluate(g,{},a),p=h.layoutTextSize.evaluate(g,{},a),m=(h.layoutIconSize.evaluate(g,{},a),{horizontal:{},vertical:void 0}),y=g.text;let v,_=[0,0];if(y){const o=y.toString(),s=c.get("text-letter-spacing").evaluate(g,{},a)*Gp,u=c.get("text-line-height").evaluate(g,{},a)*Gp,h=oi(o)?s:0,f=c.get("text-anchor").evaluate(g,{},a),v=c.get("text-variable-anchor");if(!v){const t=c.get("text-radial-offset").evaluate(g,{},a);_=t?vd(f,[t*Gp,md]):c.get("text-offset").evaluate(g,{},a).map((t=>t*Gp))}let C=d?"center":c.get("text-justify").evaluate(g,{},a);const w="point"===c.get("symbol-placement"),b=w?c.get("text-max-width").evaluate(g,{},a)*Gp:1/0,x=s=>{t.allowVerticalPlacement&&ni(o)&&(m.vertical=Ih(y,e,n,r,i,b,u,f,s,h,_,Th.vertical,!0,p,l))};if(!d&&v){const t="auto"===C?v.map((t=>Cd(t))):[C];let o=!1;for(let s=0;s<t.length;s++){const a=t[s];if(!m.horizontal[a])if(o)m.horizontal[a]=m.horizontal[0];else{const t=Ih(y,e,n,r,i,b,u,"center",a,h,_,Th.horizontal,!1,p,l);t&&(m.horizontal[a]=t,o=1===t.positionedLines.length)}}x("left")}else{if("auto"===C&&(C=Cd(f)),w||c.get("text-writing-mode").indexOf("horizontal")>=0||!ni(o)){const t=Ih(y,e,n,r,i,b,u,f,C,h,_,Th.horizontal,!1,p,l);t&&(m.horizontal[C]=t)}x(w?"left":C)}}let C=!1;if(g.icon&&g.icon.name){const e=o[g.icon.name];e&&(v=Vh(r[g.icon.name],c.get("icon-offset").evaluate(g,{},a),c.get("icon-anchor").evaluate(g,{},a)),C=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&U("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==c.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const w=Sd(m.horizontal)||m.vertical;t.iconsInText||(t.iconsInText=!!w&&w.iconsInText),(w||v)&&wd(t,g,m,v,o,h,p,0,_,C,s,a,u)}i&&t.generateCollisionDebugBuffers(l,t.collisionBoxArray)}function Cd(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wd(t,e,n,o,r,i,s,a,l,u,c,p,h){let d=i.textMaxSize.evaluate(e,{},p);void 0===d&&(d=s);const f=t.layers[0].layout,g=f.get("icon-offset").evaluate(e,{},p),m=Sd(n.horizontal)||n.vertical,y="globe"===h.name,v=Gp,_=s/v,C=t.tilePixelRatio*d/v,b=(I=t.overscaling,t.zoom>18&&I>2&&(I>>=1),Math.max(aa/(512*I),1)*f.get("symbol-spacing")),x=f.get("text-padding")*t.tilePixelRatio,E=f.get("icon-padding")*t.tilePixelRatio,S=w(f.get("text-max-angle")),T="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),R="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),O=f.get("symbol-placement"),P=b/2;var I;const A=f.get("icon-text-fit");let D;o&&"none"!==A&&(t.allowVerticalPlacement&&n.vertical&&(D=zh(o,n.vertical,A,f.get("icon-text-fit-padding"),g,_)),m&&(o=zh(o,m,A,f.get("icon-text-fit-padding"),g,_)));const M=(s,a,d)=>{if(a.x<0||a.x>=aa||a.y<0||a.y>=aa)return;let f=null;if(y){const{x:t,y:e,z:n}=h.projectTilePoint(a.x,a.y,d);f={anchor:new jh(t,e,n,0,void 0),up:h.upVector(d,a.x,a.y)}}!function(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_,C,w,b,x,E){const S=t.addToLineVertexArray(e,o);let T,R,O,P,I,A,D,M=0,L=0,N=0,F=0,k=-1,G=-1;const B={};let V=As("");const z=n?n.anchor:e;let j=0,H=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[j,H]=l.layout.get("text-offset").evaluate(C,{},E).map((t=>t*Gp)):(j=l.layout.get("text-radial-offset").evaluate(C,{},E)*Gp,H=md),t.allowVerticalPlacement&&r.vertical){const t=r.vertical;if(f)A=Rd(t),a&&(D=Rd(a));else{const n=l.layout.get("text-rotate").evaluate(C,{},E)+90;O=Td(u,z,e,c,p,h,t,d,n,g),a&&(P=Td(u,z,e,c,p,h,a,y,n))}}if(i){const o=l.layout.get("icon-rotate").evaluate(C,{},E),r="none"!==l.layout.get("icon-text-fit"),s=rd(i,o,b,r),d=a?rd(a,o,b,r):void 0;R=Td(u,z,e,c,p,h,i,y,o),M=4*s.length;const f=t.iconSizeData;let g=null;"source"===f.kind?(g=[Bp*l.layout.get("icon-size").evaluate(C,{},E)],g[0]>xd&&U("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(bd,'. Reduce your "icon-size".'))):"composite"===f.kind&&(g=[Bp*w.compositeIconSizes[0].evaluate(C,{},E),Bp*w.compositeIconSizes[1].evaluate(C,{},E)],(g[0]>xd||g[1]>xd)&&U("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(bd,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,s,g,_,v,C,!1,n,e,S.lineStartIndex,S.lineLength,-1,x,E),k=t.icon.placedSymbolArray.length-1,d&&(L=4*d.length,t.addSymbols(t.icon,d,g,_,v,C,Th.vertical,n,e,S.lineStartIndex,S.lineLength,-1,x,E),G=t.icon.placedSymbolArray.length-1)}for(const U in r.horizontal){const o=r.horizontal[U];T||(V=As(o.text),f?I=Rd(o):T=Td(u,z,e,c,p,h,o,d,l.layout.get("text-rotate").evaluate(C,{},E),g));const i=1===o.positionedLines.length;if(N+=Ed(t,n,e,o,s,l,f,C,g,S,r.vertical?Th.horizontal:Th.horizontalOnly,i?Object.keys(r.horizontal):[U],B,k,w,x,E),i)break}r.vertical&&(F+=Ed(t,n,e,r.vertical,s,l,f,C,g,S,Th.vertical,["vertical"],B,G,w,x,E));let W=-1;const q=(t,e)=>t?Math.max(t,e):e;W=q(I,W),W=q(A,W),W=q(D,W);const X=W>-1?1:0;t.glyphOffsetArray.length>=af.MAX_GLYPHS&&U("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==C.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,C.sortKey),t.symbolInstances.emplaceBack(z.x,z.y,z.z,e.x,e.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical>=0?B.vertical:-1,k,G,V,void 0!==T?T:t.collisionBoxArray.length,void 0!==T?T+1:t.collisionBoxArray.length,void 0!==O?O:t.collisionBoxArray.length,void 0!==O?O+1:t.collisionBoxArray.length,void 0!==R?R:t.collisionBoxArray.length,void 0!==R?R+1:t.collisionBoxArray.length,P||t.collisionBoxArray.length,P?P+1:t.collisionBoxArray.length,c,N,F,M,L,X,0,j,H,W)}(t,a,f,s,n,o,r,D,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,x,T,l,0,E,R,g,e,i,u,c,p)};if("line"===O)for(const w of Zh(e.geometry,0,0,aa,aa)){const e=Yh(w,b,S,n.vertical||m,o,v,C,t.overscaling,aa);for(const n of e)m&&Od(t,m.text,P,n)||M(w,n,p)}else if("line-center"===O){for(const w of e.geometry)if(w.length>1){const t=Xh(w,S,n.vertical||m,o,v,C);t&&M(w,t,p)}}else if("Polygon"===e.type)for(const w of xc(e.geometry,0)){const t=hd(w,16);M(w[0],new jh(t.x,t.y,0,0,void 0),p)}else if("LineString"===e.type)for(const w of e.geometry)M(w,new jh(w[0].x,w[0].y,0,0,void 0),p);else if("Point"===e.type)for(const w of e.geometry)for(const t of w)M([t],new jh(t.x,t.y,0,0,void 0),p)}const bd=255,xd=bd*Bp;function Ed(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m){const y=function(t,e,n,o,r,i,s,a){const l=[];if(0===e.positionedLines.length)return l;const u=o.layout.get("text-rotate").evaluate(i,{})*Math.PI/180,c=function(t){const e=t[0],n=t[1],o=e*n;return o>0?[e,-n]:o<0?[-e,n]:0===e?[n,e]:[n,-e]}(n);let p=Math.abs(e.top-e.bottom);for(const g of e.positionedLines)p-=g.lineOffset;const h=e.positionedLines.length,d=p/h;let f=e.top-n[1];for(let g=0;g<h;++g){const t=e.positionedLines[g];f=ud(e,d,f,g);for(const o of t.positionedGlyphs){if(!o.rect)continue;const t=o.rect||{};let i=wh+1,p=!0,h=1,d=0;if(o.imageName){const t=s[o.imageName];if(!t)continue;if(t.sdf){U("SDF images are not supported in formatted text and will be ignored.");continue}p=!1,h=t.pixelRatio,i=xh/h}const g=(r||a)&&o.vertical,m=o.metrics.advance*o.scale/2,y=o.metrics,_=o.rect;if(null===_)continue;a&&e.verticalizable&&(d=o.imageName?m-o.metrics.width*o.scale/2:0);const C=r?[o.x+m,o.y]:[0,0];let w=[0,0],b=[0,0],x=!1;r||(g?(b=[o.x+m+c[0],o.y+c[1]-d],x=!0):w=[o.x+m+n[0],o.y+n[1]-d]);const E=_.w*o.scale/(h*(o.localGlyph?td:1)),S=_.h*o.scale/(h*(o.localGlyph?td:1));let T,R,O,P;if(g){const t=o.y-f,e=new v(-m,m-t),n=-Math.PI/2,r=new v(...b);T=new v(-m+w[0],w[1]),T._rotateAround(n,e)._add(r),T.x+=-t+m,T.y-=(y.left-i)*o.scale;const s=o.imageName?y.advance*o.scale:Gp*o.scale,a=String.fromCharCode(o.glyph);qp(a)?T.x+=(1-i)*o.scale:Xp(a)?T.x+=s-y.height*o.scale+(-i-1)*o.scale:T.x+=o.imageName||y.width+2*i===_.w&&y.height+2*i===_.h?(s-S)/2:(s-(y.height+2*i)*o.scale)/2,R=new v(T.x,T.y-E),O=new v(T.x+S,T.y),P=new v(T.x+S,T.y-E)}else{const t=(y.left-i)*o.scale-m+w[0],e=(-y.top-i)*o.scale+w[1],n=t+E,r=e+S;T=new v(t,e),R=new v(n,e),O=new v(t,r),P=new v(n,r)}if(u){let t;t=r?new v(0,0):x?new v(c[0],c[1]):new v(n[0],n[1]),T._rotateAround(u,t),R._rotateAround(u,t),O._rotateAround(u,t),P._rotateAround(u,t)}const I=new v(0,0),A=new v(0,0);l.push({tl:T,tr:R,bl:O,br:P,tex:t,writingMode:e.writingMode,glyphOffset:C,sectionIndex:o.sectionIndex,isSDF:p,pixelOffsetTL:I,pixelOffsetBR:A,minFontScaleX:0,minFontScaleY:0})}}return l}(0,o,l,i,s,a,r,t.allowVerticalPlacement),_=t.textSizeData;let C=null;"source"===_.kind?(C=[Bp*i.layout.get("text-size").evaluate(a,{},m)],C[0]>xd&&U("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(bd,'. Reduce your "text-size".'))):"composite"===_.kind&&(C=[Bp*f.compositeTextSizes[0].evaluate(a,{},m),Bp*f.compositeTextSizes[1].evaluate(a,{},m)],(C[0]>xd||C[1]>xd)&&U("".concat(t.layerIds[0],': Value for "text-size" is >= ').concat(bd,'. Reduce your "text-size".'))),t.addSymbols(t.text,y,C,l,s,a,c,e,n,u.lineStartIndex,u.lineLength,d,g,m);for(const v of p)h[v]=t.text.placedSymbolArray.length-1;return 4*y.length}function Sd(t){for(const e in t)return t[e];return null}function Td(t,e,n,o,r,i,s,a,l,u){let c=s.top,p=s.bottom,h=s.left,d=s.right;const f=s.collisionPadding;if(f&&(h-=f[0],c-=f[1],d+=f[2],p+=f[3]),l){const t=new v(h,c),e=new v(d,c),n=new v(h,p),o=new v(d,p),r=w(l);let i=new v(0,0);u&&(i=new v(u[0],u[1])),t._rotateAround(r,i),e._rotateAround(r,i),n._rotateAround(r,i),o._rotateAround(r,i),h=Math.min(t.x,e.x,n.x,o.x),d=Math.max(t.x,e.x,n.x,o.x),c=Math.min(t.y,e.y,n.y,o.y),p=Math.max(t.y,e.y,n.y,o.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,h,c,d,p,a,o,r,i),t.length-1}function Rd(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Od(t,e,n,o){const r=t.compareText;if(e in r){const t=r[e];for(let e=t.length-1;e>=0;e--)if(o.dist(t[e])<n)return!0}else r[e]=[];return r[e].push(o),!1}function Pd(t,e){const n=t.fovAboveCenter,o=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,r=(t._camera.position[2]*t.worldSize-o)/Math.cos(t._pitch),i=Math.sin(n)*r/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),s=Math.sin(t._pitch)*i+r;return Math.min(1.01*s,r*(1/t._horizonShift))}function Id(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),o=t.x*n,r=(t.x+1)*n,i=t.y*n,s=(t.y+1)*n,a=Xl(o),l=Xl(r),u=Yl(i),c=Yl(s),p=e.project(a,u),h=e.project(l,u),d=e.project(l,c),f=e.project(a,c);let g=Math.min(p.x,h.x,d.x,f.x),m=Math.min(p.y,h.y,d.y,f.y),y=Math.max(p.x,h.x,d.x,f.x),v=Math.max(p.y,h.y,d.y,f.y);const _=n/16;function C(t,n,o,r,i,s){const a=(o+i)/2,l=(r+s)/2,u=e.project(Xl(a),Yl(l)),c=Math.max(0,g-u.x,m-u.y,u.x-y,u.y-v);g=Math.min(g,u.x),y=Math.max(y,u.x),m=Math.min(m,u.y),v=Math.max(v,u.y),c>_&&(C(t,u,o,r,a,l),C(u,n,a,l,i,s))}C(p,h,o,i,r,i),C(h,d,r,i,r,s),C(d,f,r,s,o,s),C(f,p,o,s,o,i),g-=_,m-=_,y+=_,v+=_;const w=1/Math.max(y-g,v-m);return{scale:w,x:g*w,y:m*w,x2:y*w,y2:v*w,projection:e}}const Ad=da(new Float32Array(16));class Dd{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,e){return{x:0,y:0,z:0}}unproject(t,e){return new jl(0,0)}projectTilePoint(t,e,n){return{x:t,y:e,z:0}}locationPoint(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t._coordinatePoint(t.locationCoordinate(e),n)}pixelsPerMeter(t,e){return ql(1,t)*e}pixelSpaceConversion(t,e,n){return 1}farthestPixelDistance(t){return Pd(t,t.pixelsPerMeter)}pointCoordinate(t,e,n,o){const r=t.horizonLineFromTop(!1),i=new v(e,Math.max(r,n));return t.rayIntersectionCoordinate(t.pointRayIntersection(i,o))}pointCoordinate3D(t,e,n){const o=new v(e,n);if(t.elevation)return t.elevation.pointCoordinate(o);{const e=this.pointCoordinate(t,o.x,o.y,0);return[e.x,e.y,e.z]}}isPointAboveHorizon(t,e){if(t.elevation)return!this.pointCoordinate3D(t,e.x,e.y);const n=t.horizonLineFromTop();return e.y<n}createInversionMatrix(t,e){return Ad}createTileMatrix(t,e,n){let o,r,i;const s=n.canonical,a=da(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=Id(s,this);o=1,r=l.x+n.wrap*l.scale,i=l.y,ya(a,a,[o/l.scale,o/l.scale,t.pixelsPerMeter/e])}else o=e/t.zoomScale(s.z),r=(s.x+Math.pow(2,s.z)*n.wrap)*o,i=s.y*o;return ma(a,a,[r,i,0]),ya(a,a,[o/aa,o/aa,1]),a}upVector(t,e,n){return[0,0,1]}upVectorScale(t,e,n){return{metersToTile:1}}}class Md extends Dd{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[e,n]=this.parallels=t.parallels||[29.5,45.5],o=Math.sin(w(e));this.n=(o+Math.sin(w(n)))/2,this.c=1+o*(2*this.n-o),this.r0=Math.sqrt(this.c)/this.n}project(t,e){const{n:n,c:o,r0:r}=this,i=w(t-this.center[0]),s=w(e),a=Math.sqrt(o-2*n*Math.sin(s))/n;return{x:a*Math.sin(i*n),y:a*Math.cos(i*n)-r,z:0}}unproject(t,e){const{n:n,c:o,r0:r}=this,i=r+e;let s=Math.atan2(t,Math.abs(i))*Math.sign(i);i*n<0&&(s-=Math.PI*Math.sign(t)*Math.sign(i));const a=w(this.center[0])*n;s=P(s,-Math.PI-a,Math.PI-a);const l=R(b(s/n)+this.center[0],-180,180),u=Math.asin(R((o-(t*t+i*i)*n*n)/(2*n),-1,1)),c=R(b(u),-Zl,Zl);return new jl(l,c)}}const Ld=1.340264,Nd=-.081106,Fd=893e-6,kd=.003796,Gd=Math.sqrt(3)/2;class Bd extends Dd{project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const n=Math.asin(Gd*Math.sin(e)),o=n*n,r=o*o*o;return{x:.5*(t*Math.cos(n)/(Gd*(Ld+3*Nd*o+r*(7*Fd+9*kd*o)))/Math.PI+.5),y:1-.5*(n*(Ld+Nd*o+r*(Fd+kd*o))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,o=n*n,r=o*o*o;for(let u,c,p,h=0;h<12&&(c=n*(Ld+Nd*o+r*(Fd+kd*o))-e,p=Ld+3*Nd*o+r*(7*Fd+9*kd*o),u=c/p,n=R(n-u,-Math.PI/3,Math.PI/3),o=n*n,r=o*o*o,!(Math.abs(u)<1e-12));++h);const i=Gd*t*(Ld+3*Nd*o+r*(7*Fd+9*kd*o))/Math.cos(n),s=Math.asin(Math.sin(n)/Gd),a=R(180*i/Math.PI,-180,180),l=R(180*s/Math.PI,-Zl,Zl);return new jl(a,l)}}class Vd extends Dd{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){return{x:.5+t/360,y:.5-e/360,z:0}}unproject(t,e){const n=360*(t-.5),o=R(360*(.5-e),-Zl,Zl);return new jl(n,o)}}const zd=Math.PI/2;function jd(t){return Math.tan((zd+t)/2)}class Hd extends Dd{constructor(t){super(t),this.center=t.center||[0,30];const[e,n]=this.parallels=t.parallels||[30,30];let o=w(e),r=w(n);this.southernCenter=o+r<0,this.southernCenter&&(o=-o,r=-r);const i=Math.cos(o),s=jd(o);this.n=o===r?Math.sin(o):Math.log(i/Math.cos(r))/Math.log(jd(r)/s),this.f=i*Math.pow(jd(o),this.n)/this.n}project(t,e){e=w(e),this.southernCenter&&(e=-e),t=w(t-this.center[0]);const n=1e-6,{n:o,f:r}=this;r>0?e<-zd+n&&(e=-zd+n):e>zd-n&&(e=zd-n);const i=r/Math.pow(jd(e),o);let s=i*Math.sin(o*t),a=r-i*Math.cos(o*t);return s=.5*(s/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:s,y:this.southernCenter?a:1-a,z:0}}unproject(t,e){t=(2*t-.5)*Math.PI,this.southernCenter&&(e=1-e),e=(2*(1-e)-.5)*Math.PI;const{n:n,f:o}=this,r=o-e,i=Math.sign(r),s=Math.sign(n)*Math.sqrt(t*t+r*r);let a=Math.atan2(t,Math.abs(r))*i;r*n<0&&(a-=Math.PI*Math.sign(t)*i);const l=R(b(a/n)+this.center[0],-180,180),u=R(b(2*Math.atan(Math.pow(o/s,1/n))-zd),-Zl,Zl);return new jl(l,this.southernCenter?-u:u)}}class Ud extends Dd{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,e){return{x:Ul(t),y:Wl(e),z:0}}unproject(t,e){const n=Xl(t),o=Yl(e);return new jl(n,o)}}const Wd=w(Zl);class qd extends Dd{project(t,e){const n=(e=w(e))*e,o=n*n;return{x:.5*((t=w(t))*(.8707-.131979*n+o*(o*(.003971*n-.001529*o)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+n*(.015085+o*(.028874*n-.044475-.005916*o)))/Math.PI+1),z:0}}unproject(t,e){t=(2*t-.5)*Math.PI;let n=e=(2*(1-e)-1)*Math.PI,o=25,r=0,i=n*n;do{i=n*n;const t=i*i;r=(n*(1.007226+i*(.015085+t*(.028874*i-.044475-.005916*t)))-e)/(1.007226+i*(.045255+t*(.259866*i-.311325-.005916*11*t))),n=R(n-r,-Wd,Wd)}while(Math.abs(r)>1e-6&&--o>0);i=n*n;const s=R(b(t/(.8707+i*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979))),-180,180),a=b(n);return new jl(s,a)}}const Xd=w(Zl);class Yd extends Dd{project(t,e){e=w(e),t=w(t);const n=Math.cos(e),o=2/Math.PI,r=Math.acos(n*Math.cos(t/2)),i=Math.sin(r)/r,s=.5*(t*o+2*n*Math.sin(t/2)/i)||0,a=.5*(e+Math.sin(e)/i)||0;return{x:.5*(s/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(t,e){let n=t=(2*t-.5)*Math.PI,o=e=(2*(1-e)-1)*Math.PI,r=25;const i=1e-6;let s=0,a=0;do{const r=Math.cos(o),i=Math.sin(o),l=2*i*r,u=i*i,c=r*r,p=Math.cos(n/2),h=Math.sin(n/2),d=2*p*h,f=h*h,g=1-c*p*p,m=g?1/g:0,y=g?Math.acos(r*p)*Math.sqrt(1/g):0,v=.5*(2*y*r*h+2*n/Math.PI)-t,_=.5*(y*i+o)-e,C=.5*m*(c*f+y*r*p*u)+1/Math.PI,w=m*(d*l/4-y*i*h),b=.125*m*(l*h-y*i*c*d),x=.5*m*(u*p+y*f*r)+.5,E=w*b-x*C;s=(_*w-v*x)/E,a=(v*b-_*C)/E,n=R(n-s,-Math.PI,Math.PI),o=R(o-a,-Xd,Xd)}while((Math.abs(s)>i||Math.abs(a)>i)&&--r>0);return new jl(b(n),b(o))}}class Kd extends Dd{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(w(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,e){const{scale:n,cosPhi:o}=this;return{x:w(t)*o*n+.5,y:-Math.sin(w(e))/o*n+.5,z:0}}unproject(t,e){const{scale:n,cosPhi:o}=this,r=-(e-.5)/n,i=R(b((t-.5)/n)/o,-180,180),s=Math.asin(R(r*o,-1,1)),a=R(b(s),-Zl,Zl);return new jl(i,a)}}class Zd extends Ud{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,e,n){const o=Rl(t,e,n);return ka(o,o,Il(vl(n))),{x:o[0],y:o[1],z:o[2]}}locationPoint(t,e){const n=Tl(e.lat,e.lng),o=La([],n),r=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(e),t._centerAltitude):t._centerAltitude;Ma(n,n,o,ql(1,0)*aa*r);const i=da(new Float64Array(16));return ga(i,t.pixelMatrix,t.globeMatrix),ka(n,n,i),new v(n[0],n[1])}pixelsPerMeter(t,e){return ql(1,0)*e}pixelSpaceConversion(t,e,n){const o=ql(1,t)*e,r=Dn(ql(1,45)*e,o,n);return this.pixelsPerMeter(t,e)/r}createTileMatrix(t,e,n){const o=Al(vl(n.canonical));return ga(new Float64Array(16),t.globeMatrix,o)}createInversionMatrix(t,e){const{center:n}=t,o=Il(vl(e));return _a(o,o,w(n.lng)),va(o,o,w(n.lat)),ya(o,o,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(o)}pointCoordinate(t,e,n,o){return gl(t,e,n,!0)||new Ql(0,0)}pointCoordinate3D(t,e,n){const o=this.pointCoordinate(t,e,n,0);return[o.x,o.y,o.z]}isPointAboveHorizon(t,e){return!gl(t,e.x,e.y,!1)}farthestPixelDistance(t){const e=function(t,e){const n=t.cameraToCenterDistance,o=t._centerAltitude*e,r=t._camera,i=t._camera.forward(),s=Ra([],Da([],i,-n),[0,0,o]),a=t.worldSize/(2*Math.PI),l=[0,0,-a],u=t.width/t.height,c=Math.tan(t.fovAboveCenter),p=Da([],r.up(),c),h=Da([],r.right(),c*u),d=La([],Ra([],Ra([],i,p),h)),f=[];let g;if(new el(s,d).closestPointOnSphere(l,a,f)){const e=Ra([],f,l),n=Va([],e,s);g=Math.cos(t.fovAboveCenter)*Sa(n)}else{const t=Va([],s,l),e=Va([],l,s);La(e,e);const n=Sa(t)-a;g=Math.sqrt(n*(n+2*a));const o=Math.acos(g/(a+n))-Math.acos(Na(i,e));g*=Math.cos(o)}return 1.01*g}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),n=Ml(t.zoom);if(n>0){const o=Pd(t,ql(1,t.center.lat)*t.worldSize),r=t.worldSize/(2*Math.PI),i=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Dn(e,o+r*(1-Math.cos(i)),Math.pow(n,10))}return e}upVector(t,e,n){return Rl(e,n,t,1)}upVectorScale(t){return{metersToTile:fl(Ol(vl(t)))}}}function Jd(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new Ud(t);case"equirectangular":return new Vd(t);case"naturalEarth":return new qd(t);case"equalEarth":return new Bd(t);case"winkelTripel":return new Yd(t);case"albers":return n?new Kd(t):new Md(t);case"lambertConformalConic":return n?new Kd(t):new Hd(t);case"globe":return new Zd(t)}throw new Error("Invalid projection name: ".concat(t.name))}const Qd=Xc.types,$d=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tf(t,e,n,o,r,i,s,a,l,u,c,p,h){const d=a?Math.min(xd,Math.round(a[0])):0,f=a?Math.min(xd,Math.round(a[1])):0;t.emplaceBack(e,n,Math.round(32*o),Math.round(32*r),i,s,(d<<1)+(l?1:0),f,16*u,16*c,256*p,256*h)}function ef(t,e,n,o,r,i,s){t.emplaceBack(e,n,o,r,i,s)}function nf(t,e,n,o,r){t.emplaceBack(e,n,o,r),t.emplaceBack(e,n,o,r),t.emplaceBack(e,n,o,r),t.emplaceBack(e,n,o,r)}function of(t){for(const e of t.sections)if(ui(e.text))return!0;return!1}class rf{constructor(t){this.layoutVertexArray=new Ki,this.indexArray=new os,this.programConfigurations=t,this.segments=new sa,this.dynamicLayoutVertexArray=new Wi,this.opacityVertexArray=new Ji,this.placedSymbolArray=new gs,this.globeExtVertexArray=new Zi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,o){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ap.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Mp.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,$d,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Dp.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||o)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Zr(rf,"SymbolBuffers");class sf{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new sa,this.collisionVertexArray=new es,this.collisionVertexArrayExt=new ns}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Lp.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,Np.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Zr(sf,"CollisionBuffers");class af{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=da([]),this.placementViewportMatrix=da([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vp(this.zoom,e["text-size"]),this.iconSizeData=Vp(this.zoom,e["icon-size"]);const n=this.layers[0].layout,o=n.get("symbol-sort-key"),r=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==o.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map((t=>Th[t])),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new rf(new Zs(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new rf(new Zs(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new vs,this.lineVertexArray=new _s,this.symbolInstances=new ys}calculateGlyphDependencies(t,e,n,o,r){for(let i=0;i<t.length;i++)if(e[t.charCodeAt(i)]=!0,o&&r){const n=Wp[t.charAt(i)];n&&(e[n.charCodeAt(0)]=!0)}}populate(t,e,n,o){const r=this.layers[0],i=r.layout,s="globe"===this.projection.name,a=i.get("text-font"),l=i.get("text-field"),u=i.get("icon-image"),c=("constant"!==l.value.kind||l.value.value instanceof Le&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),p="constant"!==u.value.kind||!!u.value.value||Object.keys(u.parameters).length>0,h=i.get("symbol-sort-key");if(this.features=[],!c&&!p)return;const d=e.iconDependencies,f=e.glyphDependencies,g=e.availableImages,m=new bi(this.zoom);for(const{feature:y,id:v,index:_,sourceLayerIndex:C}of t){const t=r._featureFilter.needGeometry,e=au(y,t);if(!r._featureFilter.filter(m,e,n))continue;if(t||(e.geometry=su(y,n,o)),s&&1!==y.type&&n.z<=5){const t=e.geometry,o=.98078528056,r=(t,e)=>Na(Rl(t.x,t.y,n,1),Rl(e.x,e.y,n,1))<o;for(let e=0;e<t.length;e++)t[e]=nu(t[e],r)}let l,u;if(c){const t=r.getValueAndResolveTokens("text-field",e,n,g),o=Le.factory(t);of(o)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===_i()||this.hasRTLText&&wi.isParsed())&&(l=Up(o,r,e))}if(p){const t=r.getValueAndResolveTokens("icon-image",e,n,g);u=t instanceof Ne?t:Ne.fromString(t)}if(!l&&!u)continue;const w=this.sortFeaturesByKey?h.evaluate(e,{},n):void 0;if(this.features.push({id:v,text:l,icon:u,index:_,sourceLayerIndex:C,geometry:e.geometry,properties:y.properties,type:Qd[y.type],sortKey:w}),u&&(d[u.name]=!0),l){const t=a.evaluate(e,{},n).join(","),o="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Th.vertical)>=0;for(const e of l.sections)if(e.image)d[e.image.name]=!0;else{const n=ni(l.toString()),r=e.fontStack||t,i=f[r]=f[r]||{};this.calculateGlyphDependencies(e.text,i,o,this.allowVerticalPlacement,n)}}}"line"===i.get("symbol-placement")&&(this.features=function(t){const e={},n={},o=[];let r=0;function i(e){o.push(t[e]),r++}function s(t,e,r){const i=n[t];return delete n[t],n[e]=i,o[i].geometry[0].pop(),o[i].geometry[0]=o[i].geometry[0].concat(r[0]),i}function a(t,n,r){const i=e[n];return delete e[n],e[t]=i,o[i].geometry[0].shift(),o[i].geometry[0]=r[0].concat(o[i].geometry[0]),i}function l(t,e,n){const o=n?e[0][e[0].length-1]:e[0][0];return"".concat(t,":").concat(o.x,":").concat(o.y)}for(let u=0;u<t.length;u++){const c=t[u],p=c.geometry,h=c.text?c.text.toString():null;if(!h){i(u);continue}const d=l(h,p),f=l(h,p,!0);if(d in n&&f in e&&n[d]!==e[f]){const t=a(d,f,p),r=s(d,f,o[t].geometry);delete e[d],delete n[f],n[l(h,o[r].geometry,!0)]=r,o[t].geometry=null}else d in n?s(d,f,p):f in e?a(d,f,p):(i(u),e[d]=r-1,n[f]=r-1)}return o.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,n,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n,o),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n,o))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Jd(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment)for(const{x:o,y:r}of e)this.lineVertexArray.emplaceBack(o,r);return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,e,n,o,r,i,s,a,l,u,c,p,h,d){const f=t.indexArray,g=t.layoutVertexArray,m=t.globeExtVertexArray,y=t.segments.prepareSegment(4*e.length,g,f,this.canOverlap?i.sortKey:void 0),v=this.glyphOffsetArray.length,_=y.vertexLength,C=this.allowVerticalPlacement&&s===Th.vertical?Math.PI/2:0,w=i.text&&i.text.sections;for(let x=0;x<e.length;x++){const{tl:o,tr:r,bl:s,br:u,tex:c,pixelOffsetTL:p,pixelOffsetBR:v,minFontScaleX:_,minFontScaleY:b,glyphOffset:E,isSDF:S,sectionIndex:T}=e[x],R=y.vertexLength,O=E[1];if(tf(g,l.x,l.y,o.x,O+o.y,c.x,c.y,n,S,p.x,p.y,_,b),tf(g,l.x,l.y,r.x,O+r.y,c.x+c.w,c.y,n,S,v.x,p.y,_,b),tf(g,l.x,l.y,s.x,O+s.y,c.x,c.y+c.h,n,S,p.x,v.y,_,b),tf(g,l.x,l.y,u.x,O+u.y,c.x+c.w,c.y+c.h,n,S,v.x,v.y,_,b),a){const{x:e,y:n,z:o}=a.anchor,[r,i,s]=a.up;ef(m,e,n,o,r,i,s),ef(m,e,n,o,r,i,s),ef(m,e,n,o,r,i,s),ef(m,e,n,o,r,i,s),nf(t.dynamicLayoutVertexArray,e,n,o,C)}else nf(t.dynamicLayoutVertexArray,l.x,l.y,l.z,C);f.emplaceBack(R,R+1,R+2),f.emplaceBack(R+1,R+2,R+3),y.vertexLength+=4,y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(E[0]),x!==e.length-1&&T===e[x+1].sectionIndex||t.programConfigurations.populatePaintArrays(g.length,i,i.index,{},h,d,w&&w[T])}const b=a?a.anchor:l;t.placedSymbolArray.emplaceBack(b.x,b.y,b.z,l.x,l.y,v,this.glyphOffsetArray.length-v,_,u,c,l.segment,n?n[0]:0,n?n[1]:0,o[0],o[1],s,0,!1,0,p,0)}_commitLayoutVertex(t,e,n,o,r,i,s){t.emplaceBack(e,n,o,r,i,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(t,e,n,o,r,i,s){const a=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=a.vertexLength,u=s.tileAnchorX,c=s.tileAnchorY;for(let h=0;h<4;h++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),n.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(n.layoutVertexArray,o,r,i,u,c,new v(t.x1,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,o,r,i,u,c,new v(t.x2,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,o,r,i,u,c,new v(t.x2,t.y2)),this._commitLayoutVertex(n.layoutVertexArray,o,r,i,u,c,new v(t.x1,t.y2)),a.vertexLength+=4;const p=n.indexArray;p.emplaceBack(l,l+1),p.emplaceBack(l+1,l+2),p.emplaceBack(l+2,l+3),p.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,n,o,r,i){for(let s=o;s<r;s++){const o=n.get(s),r=this.getSymbolInstanceTextSize(t,i,e,s);this._addCollisionDebugVertices(o,r,this.textCollisionBox,o.projectedAnchorX,o.projectedAnchorY,o.projectedAnchorZ,i)}}_addIconDebugCollisionBoxes(t,e,n,o,r,i){for(let s=o;s<r;s++){const o=n.get(s),r=this.getSymbolInstanceIconSize(t,e,i.placedIconSymbolIndex);this._addCollisionDebugVertices(o,r,this.iconCollisionBox,o.projectedAnchorX,o.projectedAnchorY,o.projectedAnchorZ,i)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sf($i,Fp.members,us),this.iconCollisionBox=new sf($i,Fp.members,us);const n=jp(this.iconSizeData,t),o=jp(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const i=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(o,t,e,i.textBoxStartIndex,i.textBoxEndIndex,i),this._addTextDebugCollisionBoxes(o,t,e,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i),this._addIconDebugCollisionBoxes(n,t,e,i.iconBoxStartIndex,i.iconBoxEndIndex,i),this._addIconDebugCollisionBoxes(n,t,e,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i)}}getSymbolInstanceTextSize(t,e,n,o){const r=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:o),i=zp(this.textSizeData,t,r)/Gp;return this.tilePixelRatio*i}getSymbolInstanceIconSize(t,e,n){const o=this.icon.placedSymbolArray.get(n),r=zp(this.iconSizeData,t,o);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(t,e,n){t.emplaceBack(e,-n,-n),t.emplaceBack(e,n,-n),t.emplaceBack(e,n,n),t.emplaceBack(e,-n,n)}_updateTextDebugCollisionBoxes(t,e,n,o,r,i){for(let s=o;s<r;s++){const o=n.get(s),r=this.getSymbolInstanceTextSize(t,i,e,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,o.padding)}}_updateIconDebugCollisionBoxes(t,e,n,o,r,i){for(let s=o;s<r;s++){const o=n.get(s),r=this.getSymbolInstanceIconSize(t,e,i);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,o.padding)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=jp(this.iconSizeData,t),o=jp(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const i=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(o,t,e,i.textBoxStartIndex,i.textBoxEndIndex,i),this._updateTextDebugCollisionBoxes(o,t,e,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i),this._updateIconDebugCollisionBoxes(n,t,e,i.iconBoxStartIndex,i.iconBoxEndIndex,i.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(n,t,e,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,n,o,r,i,s,a,l){const u={};if(e<n){const{x1:n,y1:o,x2:r,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(e);u.textBox={x1:n,y1:o,x2:r,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.textFeatureIndex=d}if(o<r){const{x1:e,y1:n,x2:r,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(o);u.verticalTextBox={x1:e,y1:n,x2:r,y2:i,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.verticalTextFeatureIndex=d}if(i<s){const{x1:e,y1:n,x2:o,y2:r,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(i);u.iconBox={x1:e,y1:n,x2:o,y2:r,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.iconFeatureIndex=d}if(a<l){const{x1:e,y1:n,x2:o,y2:r,padding:i,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h,featureIndex:d}=t.get(a);u.verticalIconBox={x1:e,y1:n,x2:o,y2:r,padding:i,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:c,tileAnchorX:p,tileAnchorY:h},u.verticalIconFeatureIndex=d}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),o=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<o;r+=4)t.indexArray.emplaceBack(r,r+1,r+2),t.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),o=[],r=[],i=[];for(let s=0;s<this.symbolInstances.length;++s){i.push(s);const t=this.symbolInstances.get(s);o.push(0|Math.round(e*t.tileAnchorX+n*t.tileAnchorY)),r.push(t.featureIndex)}return i.sort(((t,e)=>o[t]-o[e]||r[e]-r[t])),i}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex);const{rightJustifiedTextSymbolIndex:n,centerJustifiedTextSymbolIndex:o,leftJustifiedTextSymbolIndex:r,verticalPlacedTextSymbolIndex:i,placedIconSymbolIndex:s,verticalPlacedIconSymbolIndex:a}=e;n>=0&&this.addIndicesForPlacedSymbol(this.text,n),o>=0&&o!==n&&this.addIndicesForPlacedSymbol(this.text,o),r>=0&&r!==o&&r!==n&&this.addIndicesForPlacedSymbol(this.text,r),i>=0&&this.addIndicesForPlacedSymbol(this.text,i),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Zr(af,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),af.MAX_GLYPHS=65535,af.addDynamicAttributes=nf;const lf=new Li({"symbol-placement":new Ai(te.layout_symbol["symbol-placement"]),"symbol-spacing":new Ai(te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ai(te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Di(te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ai(te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ai(te.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ai(te.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ai(te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ai(te.layout_symbol["icon-rotation-alignment"]),"icon-size":new Di(te.layout_symbol["icon-size"]),"icon-text-fit":new Ai(te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ai(te.layout_symbol["icon-text-fit-padding"]),"icon-image":new Di(te.layout_symbol["icon-image"]),"icon-rotate":new Di(te.layout_symbol["icon-rotate"]),"icon-padding":new Ai(te.layout_symbol["icon-padding"]),"icon-keep-upright":new Ai(te.layout_symbol["icon-keep-upright"]),"icon-offset":new Di(te.layout_symbol["icon-offset"]),"icon-anchor":new Di(te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ai(te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ai(te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ai(te.layout_symbol["text-rotation-alignment"]),"text-field":new Di(te.layout_symbol["text-field"]),"text-font":new Di(te.layout_symbol["text-font"]),"text-size":new Di(te.layout_symbol["text-size"]),"text-max-width":new Di(te.layout_symbol["text-max-width"]),"text-line-height":new Di(te.layout_symbol["text-line-height"]),"text-letter-spacing":new Di(te.layout_symbol["text-letter-spacing"]),"text-justify":new Di(te.layout_symbol["text-justify"]),"text-radial-offset":new Di(te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ai(te.layout_symbol["text-variable-anchor"]),"text-anchor":new Di(te.layout_symbol["text-anchor"]),"text-max-angle":new Ai(te.layout_symbol["text-max-angle"]),"text-writing-mode":new Ai(te.layout_symbol["text-writing-mode"]),"text-rotate":new Di(te.layout_symbol["text-rotate"]),"text-padding":new Ai(te.layout_symbol["text-padding"]),"text-keep-upright":new Ai(te.layout_symbol["text-keep-upright"]),"text-transform":new Di(te.layout_symbol["text-transform"]),"text-offset":new Di(te.layout_symbol["text-offset"]),"text-allow-overlap":new Ai(te.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ai(te.layout_symbol["text-ignore-placement"]),"text-optional":new Ai(te.layout_symbol["text-optional"])});var uf={paint:new Li({"icon-opacity":new Di(te.paint_symbol["icon-opacity"]),"icon-color":new Di(te.paint_symbol["icon-color"]),"icon-halo-color":new Di(te.paint_symbol["icon-halo-color"]),"icon-halo-width":new Di(te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Di(te.paint_symbol["icon-halo-blur"]),"icon-translate":new Ai(te.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ai(te.paint_symbol["icon-translate-anchor"]),"text-opacity":new Di(te.paint_symbol["text-opacity"]),"text-color":new Di(te.paint_symbol["text-color"],{runtimeType:he,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Di(te.paint_symbol["text-halo-color"]),"text-halo-width":new Di(te.paint_symbol["text-halo-width"]),"text-halo-blur":new Di(te.paint_symbol["text-halo-blur"]),"text-translate":new Ai(te.paint_symbol["text-translate"]),"text-translate-anchor":new Ai(te.paint_symbol["text-translate-anchor"])}),layout:lf};class cf{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:le,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Zr(cf,"FormatSectionOverride",{omit:["defaultValue"]});class pf extends oa{constructor(t){super(t,uf)}recalculate(t,e){super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const t=[];for(const e of n)t.indexOf(e)<0&&t.push(e);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,o){const r=this.layout.get(t).evaluate(e,{},n,o),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||Zo(i.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,((e,n)=>n in t?String(t[n]):""))}(e.properties,r)}createBucket(t){return new af(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of uf.paint.overridableProperties){if(!pf.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new cf(e),o=new Ko(n,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new Qo("source",o):new $o("composite",o,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new Pi(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&pf.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),o=uf.paint.properties[e];let r=!1;const i=t=>{for(const e of t)if(o.overrides&&o.overrides.hasOverride(e))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof Le)i(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{r||(e instanceof ze&&Ge(e.value)===me?i(e.value.sections):e instanceof qe?i(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return r}getProgramConfiguration(t){return new Ks(this,t)}}var hf={paint:new Li({"background-color":new Ai(te.paint_background["background-color"]),"background-pattern":new Ai(te.paint_background["background-pattern"]),"background-opacity":new Ai(te.paint_background["background-opacity"])})},df={paint:new Li({"raster-opacity":new Ai(te.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ai(te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ai(te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ai(te.paint_raster["raster-brightness-max"]),"raster-saturation":new Ai(te.paint_raster["raster-saturation"]),"raster-contrast":new Ai(te.paint_raster["raster-contrast"]),"raster-resampling":new Ai(te.paint_raster["raster-resampling"]),"raster-fade-duration":new Ai(te.paint_raster["raster-fade-duration"])})};class ff extends oa{constructor(t){super(t,{}),this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var gf={paint:new Li({"sky-type":new Ai(te.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ai(te.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ai(te.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ai(te.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ai(te.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mi(te.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ai(te.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ai(te.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ai(te.paint_sky["sky-opacity"])})};function mf(t,e,n){const o=[0,0,1],r=Xa([]);return Ka(r,r,n?-w(t)+Math.PI:w(t)),Ya(r,r,-w(e)),Ga(o,o,r),La(o,o)}const yf={circle:class extends oa{constructor(t){super(t,Ou)}createBucket(t){return new cu(t)}queryRadius(t){const e=t;return xu("circle-radius",this,e)+xu("circle-stroke-width",this,e)+Eu(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,o,r,i,s,a){const l=Tu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Pu(t,o,i,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,u)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Ks(this,t)}},heatmap:class extends oa{createBucket(t){return new Lu(t)}constructor(t){super(t,Vu),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=zu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return xu("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,o,r,i,s,a){const l=this.paint.get("heatmap-radius").evaluate(e,n);return Pu(t,o,i,s,a,!0,!0,new v(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Ks(this,t)}},hillshade:class extends oa{constructor(t){super(t,ju)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends oa{constructor(t){super(t,Pc)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new Ks(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Rc(t)}queryRadius(){return Eu(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,o,r,i){return!t.queryGeometry.isAboveHorizon&&du(Su(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends oa{constructor(t){super(t,cp)}createBucket(t){return new tp(t)}queryRadius(){return Eu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Ks(this,t)}queryIntersectsFeature(t,e,n,o,r,i,s,a,l){const u=Tu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),c=this.paint.get("fill-extrusion-height").evaluate(e,n),p=this.paint.get("fill-extrusion-base").evaluate(e,n),h=[0,0],d=a&&i.elevation,f=i.elevation?i.elevation.exaggeration():1,g=t.tile.getBucket(this);if(d&&g instanceof tp){const t=g.centroidVertexArray,e=l+1;e<t.length&&(h[0]=t.geta_centroid_pos0(e),h[1]=t.geta_centroid_pos1(e))}if(0===h[0]&&1===h[1])return!1;"globe"===i.projection.name&&(o=lp([o],[new v(0,0),new v(aa,aa)],t.tileID.canonical).map((t=>t.polygon)).flat());const m=d?a:null,[y,_]=function(t,e,n,o,r,i,s,a,l,u,c){return"globe"===t.projection.name?function(t,e,n,o,r,i,s,a,l,u,c){const p=[],h=[],d=t.projection.upVectorScale(c,t.center.lat,t.worldSize).metersToTile,f=[0,0,0,1],g=[0,0,0,1],m=(t,e,n,o)=>{t[0]=e,t[1]=n,t[2]=o,t[3]=1},y=ap();n>0&&(n+=y),o+=y;for(const v of e){const e=[],y=[];for(const p of v){const h=p.x+r.x,v=p.y+r.y,_=t.projection.projectTilePoint(h,v,c),C=t.projection.upVector(c,p.x,p.y);let w=n,b=o;if(s){const t=_p(h,v,n,o,s,a,l,u);w+=t.base,b+=t.top}0!==n?m(f,_.x+C[0]*d*w,_.y+C[1]*d*w,_.z+C[2]*d*w):m(f,_.x,_.y,_.z),m(g,_.x+C[0]*d*b,_.y+C[1]*d*b,_.z+C[2]*d*b),ka(f,f,i),ka(g,g,i),e.push(new mp(f[0],f[1],f[2])),y.push(new mp(g[0],g[1],g[2]))}p.push(e),h.push(y)}return[p,h]}(t,e,n,o,r,i,s,a,l,u,c):s?function(t,e,n,o,r,i,s,a,l){const u=[],c=[],p=[0,0,0,1];for(const h of t){const t=[],d=[];for(const u of h){const c=u.x+o.x,h=u.y+o.y,f=_p(c,h,e,n,i,s,a,l);p[0]=c,p[1]=h,p[2]=f.base,p[3]=1,Wa(p,p,r),p[3]=Math.max(p[3],1e-5);const g=new mp(p[0]/p[3],p[1]/p[3],p[2]/p[3]);p[0]=c,p[1]=h,p[2]=f.top,p[3]=1,Wa(p,p,r),p[3]=Math.max(p[3],1e-5);const m=new mp(p[0]/p[3],p[1]/p[3],p[2]/p[3]);t.push(g),d.push(m)}u.push(t),c.push(d)}return[u,c]}(e,n,o,r,i,s,a,l,u):function(t,e,n,o,r){const i=[],s=[],a=r[8]*e,l=r[9]*e,u=r[10]*e,c=r[11]*e,p=r[8]*n,h=r[9]*n,d=r[10]*n,f=r[11]*n;for(const g of t){const t=[],e=[];for(const n of g){const i=n.x+o.x,s=n.y+o.y,g=r[0]*i+r[4]*s+r[12],m=r[1]*i+r[5]*s+r[13],y=r[2]*i+r[6]*s+r[14],v=r[3]*i+r[7]*s+r[15],_=g+a,C=m+l,w=y+u,b=Math.max(v+c,1e-5),x=g+p,E=m+h,S=y+d,T=Math.max(v+f,1e-5);t.push(new mp(_/b,C/b,w/b)),e.push(new mp(x/T,E/T,S/T))}i.push(t),s.push(e)}return[i,s]}(e,n,o,r,i)}(i,o,p,c,u,s,m,h,f,i.center.lat,t.tileID.canonical),C=t.queryGeometry;return function(t,e,n){let o=1/0;du(n,e)&&(o=vp(n,e[0]));for(let r=0;r<e.length;r++){const i=e[r],s=t[r];for(let t=0;t<i.length-1;t++){const e=i[t],r=[e,i[t+1],s[t+1],s[t],e];pu(n,r)&&(o=Math.min(o,vp(n,r)))}}return o!==1/0&&o}(y,_,C.isPointQuery()?C.screenBounds:C.screenGeometry)}},line:class extends oa{constructor(t){super(t,Op),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof An,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Pp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Tp(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Ks(this,t)}queryRadius(t){const e=t,n=Ip(xu("line-width",this,e),xu("line-gap-width",this,e)),o=xu("line-offset",this,e);return n/2+Math.abs(o)+Eu(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,o,r,i){if(t.queryGeometry.isAboveHorizon)return!1;const s=Su(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),i.angle,t.pixelToTileUnitsFactor),a=t.pixelToTileUnitsFactor/2*Ip(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(o=function(t,e){const n=[],o=new v(0,0);for(let r=0;r<t.length;r++){const i=t[r],s=[];for(let t=0;t<i.length;t++){const n=i[t],r=i[t+1],a=0===t?o:n.sub(i[t-1])._unit()._perp(),l=t===i.length-1?o:r.sub(n)._unit()._perp(),u=a._add(l)._unit();u._mult(1/(u.x*l.x+u.y*l.y)),s.push(u._mult(e)._add(n))}n.push(s)}return n}(o,l*t.pixelToTileUnitsFactor)),function(t,e,n){for(let o=0;o<e.length;o++){const r=e[o];if(t.length>=3)for(let e=0;e<r.length;e++)if(Cu(t,r[e]))return!0;if(fu(t,r,n))return!0}return!1}(s,o,a)}isTileClipped(){return!0}},symbol:pf,background:class extends oa{constructor(t){super(t,hf)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends oa{constructor(t){super(t,df)}getProgramIds(){return["raster"]}},sky:class extends oa{constructor(t){super(t,gf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=zu({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const n=this.paint.get("sky-atmosphere-sun"),o=!n,r=t.style.light,i=r.properties.get("position");return o&&"viewport"===r.properties.get("anchor")&&U("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),o?mf(i.azimuthal,90-i.polar,e):mf(n[0],90-n[1],e)}const n=this.paint.get("sky-gradient-center");return mf(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class vf{constructor(t,e,n,o){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,o)}update(t,n,o){const{width:r,height:i}=t,{context:s}=this,{gl:a}=s,{HTMLImageElement:l,HTMLCanvasElement:u,HTMLVideoElement:c,ImageData:p,ImageBitmap:h}=e;if(a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!n||!1!==n.premultiply)),o||this.size&&this.size[0]===r&&this.size[1]===i){const{x:e,y:n}=o||{x:0,y:0};t instanceof l||t instanceof u||t instanceof c||t instanceof p||h&&t instanceof h?a.texSubImage2D(a.TEXTURE_2D,0,e,n,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,n,r,i,a.RGBA,a.UNSIGNED_BYTE,t.data)}else this.size=[r,i],t instanceof l||t instanceof u||t instanceof c||t instanceof p||h&&t instanceof h?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,r,i,0,this.format,a.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&a.generateMipmap(a.TEXTURE_2D)}bind(t,e){const{context:n}=this,{gl:o}=n;o.bindTexture(o.TEXTURE_2D,this.texture),t!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this.useMipmap?t===o.NEAREST?o.NEAREST_MIPMAP_NEAREST:o.LINEAR_MIPMAP_NEAREST:t),this.filter=t),e!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class _f{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Cf{constructor(){this.tasks={},this.taskQueue=[],G(["process"],this),this.invoker=new _f(this.process),this.nextId=0}add(t,e){const n=this.nextId++,o=function(t){let{type:e,isSymbolTile:n,zoom:o}=t;return o=o||0,"message"===e?0:"maybePrepare"!==e||n?"parseTile"!==e||n?"parseTile"===e&&n?300-o:"maybePrepare"===e&&n?400-o:500:200-o:100-o}(e);if(0===o){X();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:t,metadata:e,priority:o,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){X();try{if(this.taskQueue=this.taskQueue.filter((t=>!!this.tasks[t])),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let o=0;o<this.taskQueue.length;o++){const n=this.tasks[this.taskQueue[o]];n.priority<e&&(e=n.priority,t=o)}if(null===t)return null;const n=this.taskQueue[t];return this.taskQueue.splice(t,1),n}remove(){this.invoker.remove()}}class wf{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const bf=["tile","layer","source","sourceLayer","state"];class xf{constructor(t,e,n,o,r){this.type="Feature",this._vectorTileFeature=t,this._z=e,this._x=n,this._y=o,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(t.id=this.id);for(const e of bf)void 0!==this[e]&&(t[e]=this[e]);return t}}const Ef=32,Sf=33,Tf=new Uint16Array(8184);for(let xg=0;xg<2046;xg++){let t=xg+2,e=0,n=0,o=0,r=0,i=0,s=0;for(1&t?o=r=i=Ef:e=n=s=Ef;(t>>=1)>1;){const a=e+o>>1,l=n+r>>1;1&t?(o=e,r=n,e=i,n=s):(e=o,n=r,o=i,r=s),i=a,s=l}const a=4*xg;Tf[a+0]=e,Tf[a+1]=n,Tf[a+2]=o,Tf[a+3]=r}const Rf=new Uint16Array(2178),Of=new Uint8Array(1089),Pf=new Uint16Array(1089);function If(t){return 0===t?-.03125:32===t?.03125:0}var Af=Bi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Df={type:2,extent:aa,loadGeometry:()=>[[new v(0,0),new v(aa+1,0),new v(aa+1,aa+1),new v(0,aa+1),new v(0,0)]]};class Mf{constructor(t,e,n,o,r){this.tileID=t,this.uid=L(),this.uses=0,this.tileSize=e,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=r,this.expiredRequestCount=0,this.state="loading",o&&o.transform&&(this.projection=o.transform.projection)}registerFadeDuration(t){const e=t+this.timeAdded;e<Yt.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Id(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,e,n){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const o of t){const t=o.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){o.layers=t,o.stateDependentLayerIds&&(o.stateDependentLayers=o.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)n[e.id]=o}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof af){if(this.hasSymbolBuckets=!0,!n)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof af&&e.hasRTLText){this.hasRTLText=!0,wi.isLoading()||wi.isLoaded()||"deferred"!==_i()||Ci();break}}this.queryPadding=0;for(const t in this.buckets){const n=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(n))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new ds}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const n in this.buckets){const e=this.buckets[n];e.uploadPending()&&e.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new vf(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new vf(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new vf(t,this.lineAtlas.image,e.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,o,r,i,s,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:o,pixelPosMatrix:s,transform:i,params:r,tileTransform:this.tileTransform},t,e,n):{}}querySourceFeatures(t,e){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const o=n.loadVTLayers(),r=e?e.sourceLayer:"",i=o._geojsonTileLayer||o[r];if(!i)return;const s=hr(e&&e.filter),{z:a,x:l,y:u}=this.tileID.canonical,c={z:a,x:l,y:u};for(let p=0;p<i.length;p++){const e=i.feature(p);if(s.needGeometry){const t=au(e,!0);if(!s.filter(new bi(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new bi(this.tileID.overscaledZ),e))continue;const o=n.getId(e,r),h=new xf(e,a,l,u,o);h.tile=c,t.push(h)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=Y(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let n=!1;if(this.expirationTime>t)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{const o=this.expirationTime-e;o?this.expirationTime=t+Math.max(o,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length||!e)return;const n=this.latestFeatureIndex.loadVTLayers(),o=e.style.listImages();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const i=this.buckets[r],s=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[s],l=t[s];if(!a||!l||0===Object.keys(l).length)continue;if(i.update(l,a,o,this.imageAtlas&&this.imageAtlas.patternPositions||{}),i instanceof Tp||i instanceof Rc){const t=e.style._getSourceCache(i.layers[0].source);e._terrain&&e._terrain.enabled&&t&&i.programConfigurations.needsUpload&&e._terrain._clearRenderCacheForTile(t.id,this.tileID)}const u=e&&e.style&&e.style.getLayer(r);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Yt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Yt.now()+t}setTexture(t,e){const n=e.context,o=n.gl;this.texture=this.texture||e.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new vf(n,t,o.RGBA,{useMipmap:!0}),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE))}setDependencies(t,e){const n={};for(const o of e)n[o]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,e){if(!e||"mercator"===e.name||this._tileDebugBuffer)return;const n=su(Df,this.tileID.canonical,this.tileTransform)[0],o=new zi,r=new cs;for(let i=0;i<n.length;i++){const{x:t,y:e}=n[i];o.emplaceBack(t,e),r.emplaceBack(i)}r.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(r),this._tileDebugBuffer=t.createVertexBuffer(o,tl.members),this._tileDebugSegments=sa.simpleSegment(0,0,o.length,r.length)}_makeTileBoundsBuffers(t,e){if(this._tileBoundsBuffer||!e||"mercator"===e.name)return;const n=su(Df,this.tileID.canonical,this.tileTransform)[0];let o,r;if(this.isRaster){const t=function(t,e){const n=Id(t,e),o=Math.pow(2,t.z);for(let u=0;u<Sf;u++)for(let r=0;r<Sf;r++){const i=Xl((t.x+(r+If(r))/Ef)/o),s=Yl((t.y+(u+If(u))/Ef)/o),a=e.project(i,s),l=u*Sf+r;Rf[2*l+0]=Math.round((a.x*n.scale-n.x)*aa),Rf[2*l+1]=Math.round((a.y*n.scale-n.y)*aa)}Of.fill(0),Pf.fill(0);for(let u=2045;u>=0;u--){const t=4*u,e=Tf[t+0],n=Tf[t+1],o=Tf[t+2],r=Tf[t+3],i=e+o>>1,s=n+r>>1,a=i+s-n,l=s+e-i,c=n*Sf+e,p=r*Sf+o,h=s*Sf+i,d=Math.hypot((Rf[2*c+0]+Rf[2*p+0])/2-Rf[2*h+0],(Rf[2*c+1]+Rf[2*p+1])/2-Rf[2*h+1])>=16;Of[h]=Of[h]||(d?1:0),u<1022&&(Of[h]=Of[h]||Of[(n+l>>1)*Sf+(e+a>>1)]||Of[(r+l>>1)*Sf+(o+a>>1)])}const r=new Hi,i=new os;let s=0;function a(t,e){const n=e*Sf+t;return 0===Pf[n]&&(r.emplaceBack(Rf[2*n+0],Rf[2*n+1],t*aa/Ef,e*aa/Ef),Pf[n]=++s),Pf[n]-1}function l(t,e,n,o,r,s){const u=t+n>>1,c=e+o>>1;if(Math.abs(t-r)+Math.abs(e-s)>1&&Of[c*Sf+u])l(r,s,t,e,u,c),l(n,o,r,s,u,c);else{const l=a(t,e),u=a(n,o),c=a(r,s);i.emplaceBack(l,u,c)}}return l(0,0,Ef,Ef,Ef,0),l(Ef,Ef,0,0,0,Ef),{vertices:r,indices:i}}(this.tileID.canonical,e);o=t.vertices,r=t.indices}else{o=new Hi,r=new os;for(const{x:e,y:r}of n)o.emplaceBack(e,r,0,0);const t=vc(o.int16,void 0,4);for(let e=0;e<t.length;e+=3)r.emplaceBack(t[e],t[e+1],t[e+2])}this._tileBoundsBuffer=t.createVertexBuffer(o,Af.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(r),this._tileBoundsSegments=sa.simpleSegment(0,0,o.length,r.length)}_makeGlobeTileDebugBuffers(t,e){const n=e.projection;if(!n||"globe"!==n.name||e.freezeTileCoverage)return;const o=this.tileID.canonical,r=Il(Cl(o,e)),i=Ml(e.zoom);let s;i>0&&(s=fa(new Float64Array(16),e.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,o,e,r,s,i),this._makeGlobeTileDebugTextBuffer(t,o,e,r,s,i)}_globePoint(t,e,n,o,r,i,s){let a=Rl(t,e,n);if(i){const r=1<<n.z,l=Ul(o.center.lng),u=Wl(o.center.lat),c=(n.x+.5)/r-l;let p=0;c>.5?p=-1:c<-.5&&(p=1);let h=(t/aa+n.x)/r+p,d=(e/aa+n.y)/r;h=(h-l)*o._pixelsPerMercatorPixel+l,d=(d-u)*o._pixelsPerMercatorPixel+u;const f=[h*o.worldSize,d*o.worldSize,0];ka(f,f,i),a=_l(a,f,s)}return ka(a,a,r)}_makeGlobeTileDebugBorderBuffer(t,e,n,o,r,i){const s=new zi,a=new cs,l=new ji,u=(t,u,c,p,h)=>{const d=(c-t)/(h-1),f=(p-u)/(h-1),g=s.length;for(let m=0;m<h;m++){const c=t+m*d,p=u+m*f;s.emplaceBack(c,p);const h=this._globePoint(c,p,e,n,o,r,i);l.emplaceBack(h[0],h[1],h[2]),a.emplaceBack(g+m)}},c=aa;u(0,0,c,0,16),u(c,0,c,c,16),u(c,c,0,c,16),u(0,c,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(a),this._tileDebugBuffer=t.createVertexBuffer(s,tl.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(l,$a.members),this._tileDebugSegments=sa.simpleSegment(0,0,s.length,a.length)}_makeGlobeTileDebugTextBuffer(t,e,n,o,r,i){const s=aa/4,a=new zi,l=new os,u=new ji,c=25;l.reserve(32),a.reserve(c),u.reserve(c);const p=(t,e)=>c*t+e;for(let h=0;h<c;h++){const t=h*s;for(let l=0;l<c;l++){const c=l*s;a.emplaceBack(c,t);const p=this._globePoint(c,t,e,n,o,r,i);u.emplaceBack(p[0],p[1],p[2])}}for(let h=0;h<4;h++)for(let t=0;t<4;t++){const e=p(h,t),n=p(h,t+1),o=p(h+1,t),r=p(h+1,t+1);l.emplaceBack(e,n,o),l.emplaceBack(o,n,r)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(l),this._tileDebugTextBuffer=t.createVertexBuffer(a,tl.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(u,$a.members),this._tileDebugTextSegments=sa.simpleSegment(0,0,c,32)}}class Lf{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,n){const o=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][o]=this.stateChanges[t][o]||{},D(this.stateChanges[t][o],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==o&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][o]){this.deletedStates[t][o]={};for(const e in this.state[t][o])n[e]||(this.deletedStates[t][o][e]=null)}else for(const r in n)this.deletedStates[t]&&this.deletedStates[t][o]&&null===this.deletedStates[t][o][r]&&delete this.deletedStates[t][o][r]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const o=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][o]&&(this.deletedStates[t][o]=this.deletedStates[t][o]||{},this.deletedStates[t][o][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][o])for(n in this.deletedStates[t][o]={},this.stateChanges[t][o])this.deletedStates[t][o][n]=null;else this.deletedStates[t][o]=null;else this.deletedStates[t]=null}getState(t,e){const n=String(e),o=D({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const n=this.deletedStates[t][e];if(null===n)return{};for(const t in n)delete o[t]}return o}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const n={};for(const o in this.stateChanges){this.state[o]=this.state[o]||{};const t={};for(const e in this.stateChanges[o])this.state[o][e]||(this.state[o][e]={}),D(this.state[o][e],this.stateChanges[o][e]),t[e]=this.state[o][e];n[o]=t}for(const o in this.deletedStates){this.state[o]=this.state[o]||{};const t={};if(null===this.deletedStates[o])for(const e in this.state[o])t[e]={},this.state[o][e]={};else for(const e in this.deletedStates[o]){if(null===this.deletedStates[o][e])this.state[o][e]={};else if(this.state[o][e])for(const t of Object.keys(this.deletedStates[o][e]))delete this.state[o][e][t];t[e]=this.state[o][e]}n[o]=n[o]||{},D(n[o],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const o in t)t[o].setFeatureState(n,e)}}class Nf{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const n=this.toIdx(t,e);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function Ff(t,e,n,o){let r=0,i=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(o[s])<1e-15){if(n[s]<t[s]||n[s]>e[s])return null}else{const a=1/o[s];let l=(t[s]-n[s])*a,u=(e[s]-n[s])*a;if(l>u){const t=l;l=u,u=t}if(l>r&&(r=l),u<i&&(i=u),r>i)return null}return r}function kf(t,e,n,o,r,i,s,a,l,u,c){const p=o-t,h=r-e,d=i-n,f=s-t,g=a-e,m=l-n,y=c[1]*m-c[2]*g,v=c[2]*f-c[0]*m,_=c[0]*g-c[1]*f,C=p*y+h*v+d*_;if(Math.abs(C)<1e-15)return null;const w=1/C,b=u[0]-t,x=u[1]-e,E=u[2]-n,S=(b*y+x*v+E*_)*w;if(S<0||S>1)return null;const T=x*d-E*h,R=E*p-b*d,O=b*h-x*p,P=(c[0]*T+c[1]*R+c[2]*O)*w;return P<0||S+P>1?null:(f*T+g*R+m*O)*w}function Gf(t,e,n){return(t-e)/(n-e)}function Bf(t,e,n,o,r,i,s,a,l){const u=1<<n,c=i-o,p=s-r,h=(t+1)/u*c+o,d=(e+0)/u*p+r,f=(e+1)/u*p+r;a[0]=(t+0)/u*c+o,a[1]=d,l[0]=h,l[1]=f}class Vf{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),n=[];let o=Math.ceil(Math.pow(2,e));const r=1/o,i=(t,e,n,o,r)=>{const i=o?1:0,s=(t+1)*n-i,a=e*n,l=(e+1)*n-i;r[0]=t*n,r[1]=a,r[2]=s,r[3]=l};let s=new Nf(o);const a=[];for(let l=0;l<o*o;l++){i(l%o,Math.floor(l/o),r,!1,a);const e=jf(a[0],a[1],t),n=jf(a[2],a[1],t),u=jf(a[2],a[3],t),c=jf(a[0],a[3],t);s.minimums.push(Math.min(e,n,u,c)),s.maximums.push(Math.max(e,n,u,c)),s.leaves.push(1)}for(n.push(s),o/=2;o>=1;o/=2){const t=n[n.length-1];s=new Nf(o);for(let e=0;e<o*o;e++){i(e%o,Math.floor(e/o),2,!0,a);const n=t.getElevation(a[0],a[1]),r=t.getElevation(a[2],a[1]),l=t.getElevation(a[2],a[3]),u=t.getElevation(a[0],a[3]),c=t.isLeaf(a[0],a[1]),p=t.isLeaf(a[2],a[1]),h=t.isLeaf(a[2],a[3]),d=t.isLeaf(a[0],a[3]),f=Math.min(n.min,r.min,l.min,u.min),g=Math.max(n.max,r.max,l.max,u.max),m=c&&p&&h&&d;s.maximums.push(g),s.minimums.push(f),s.leaves.push(g-f<=5&&m?1:0)}n.push(s)}return n}(this.dem),n=e.length-1,o=e[n];this._addNode(o.minimums[0],o.maximums[0],o.leaves[0]),this._construct(e,0,0,n,0)}raycastRoot(t,e,n,o,r,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Ff([t,e,-100],[n,o,this.maximums[0]*s],r,i)}raycast(t,e,n,o,r,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;const a=this.raycastRoot(t,e,n,o,r,i,s);if(null==a)return null;const l=[],u=[],c=[],p=[],h=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;h.length>0;){const{idx:a,t:d,nodex:f,nodey:g,depth:m}=h.pop();if(this.leaves[a]){Bf(f,g,m,t,e,n,o,c,p);const a=1<<m,l=(f+0)/a,u=(f+1)/a,h=(g+0)/a,y=(g+1)/a,v=jf(l,h,this.dem)*s,_=jf(u,h,this.dem)*s,C=jf(u,y,this.dem)*s,w=jf(l,y,this.dem)*s,b=kf(c[0],c[1],v,p[0],c[1],_,p[0],p[1],C,r,i),x=kf(p[0],p[1],C,c[0],p[1],w,c[0],c[1],v,r,i),E=Math.min(null!==b?b:Number.MAX_VALUE,null!==x?x:Number.MAX_VALUE);if(E!==Number.MAX_VALUE)return E;{const t=Ma([],r,i,d);if(zf(v,_,w,C,Gf(t[0],c[0],p[0]),Gf(t[1],c[1],p[1]))>=t[2])return d}continue}let y=0;for(let h=0;h<this._siblingOffset.length;h++){Bf((f<<1)+this._siblingOffset[h][0],(g<<1)+this._siblingOffset[h][1],m+1,t,e,n,o,c,p),c[2]=-100,p[2]=this.maximums[this.childOffsets[a]+h]*s;const d=Ff(c,p,r,i);if(null!=d){const t=d;l[h]=t;let e=!1;for(let n=0;n<y&&!e;n++)t>=l[u[n]]&&(u.splice(n,0,h),e=!0);e||(u[y]=h),y++}}for(let t=0;t<y;t++){const e=u[t];h.push({idx:this.childOffsets[a]+e,t:l[e],nodex:(f<<1)+this._siblingOffset[e][0],nodey:(g<<1)+this._siblingOffset[e][1],depth:m+1})}}return null}_addNode(t,e,n){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,n,o,r){if(1===t[o].isLeaf(e,n))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const i=o-1,s=t[i];let a=0,l=0;for(let u=0;u<this._siblingOffset.length;u++){const t=2*e+this._siblingOffset[u][0],o=2*n+this._siblingOffset[u][1],r=s.getElevation(t,o),i=s.isLeaf(t,o),c=this._addNode(r.min,r.max,i);i&&(a|=1<<u),l||(l=c)}for(let u=0;u<this._siblingOffset.length;u++)a&1<<u||this._construct(t,2*e+this._siblingOffset[u][0],2*n+this._siblingOffset[u][1],i,l+u)}}function zf(t,e,n,o,r,i){return Dn(Dn(t,n,i),Dn(e,o,i),r)}function jf(t,e,n){const o=n.dim,r=R(t*o-.5,0,o-1),i=R(e*o-.5,0,o-1),s=Math.floor(r),a=Math.floor(i),l=Math.min(s+1,o-1),u=Math.min(a+1,o-1);return zf(n.get(s,a),n.get(l,a),n.get(s,u),n.get(l,u),r-s,i-a)}const Hf={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Uf(t,e,n){return(256*t*256+256*e+n)/10-1e4}function Wf(t,e,n){return 256*t+e+n/256-32768}class qf{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return U('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=e.height;const i=this.dim=e.height-2,s=new Uint32Array(e.data.buffer);if(this.pixels=new Uint8Array(e.data.buffer),this.encoding=n||"mapbox",this.borderReady=o,!o){for(let t=0;t<i;t++)s[this._idx(-1,t)]=s[this._idx(0,t)],s[this._idx(i,t)]=s[this._idx(i-1,t)],s[this._idx(t,-1)]=s[this._idx(t,0)],s[this._idx(t,i)]=s[this._idx(t,i-1)];s[this._idx(-1,-1)]=s[this._idx(0,0)],s[this._idx(i,-1)]=s[this._idx(i-1,0)],s[this._idx(-1,i)]=s[this._idx(0,i-1)],s[this._idx(i,i)]=s[this._idx(i-1,i-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Vf(this)}get(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(t=R(t,-1,this.dim),e=R(e,-1,this.dim));const n=4*this._idx(t,e);return("terrarium"===this.encoding?Wf:Uf)(this.pixels[n],this.pixels[n+1],this.pixels[n+2])}static getUnpackVector(t){return Hf[t]}get unpackVector(){return Hf[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}static pack(t,e){const n=[0,0,0,0],o=qf.getUnpackVector(e);let r=Math.floor((t+o[3])/o[2]);return n[2]=r%256,r=Math.floor(r/256),n[1]=r%256,r=Math.floor(r/256),n[0]=r,n}getPixels(){return new Bu({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let o=e*this.dim,r=e*this.dim+this.dim,i=n*this.dim,s=n*this.dim+this.dim;switch(e){case-1:o=r-1;break;case 1:r=o+1}switch(n){case-1:i=s-1;break;case 1:s=i+1}const a=-e*this.dim,l=-n*this.dim;for(let u=i;u<s;u++)for(let e=o;e<r;e++){const n=4*this._idx(e,u),o=4*this._idx(e+a,u+l);this.pixels[n+0]=t.pixels[o+0],this.pixels[n+1]=t.pixels[o+1],this.pixels[n+2]=t.pixels[o+2],this.pixels[n+3]=t.pixels[o+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Zr(qf,"DEMData"),Zr(Vf,"DemMinMaxQuadTree",{omit:["dem"]});class Xf{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const o=t.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);const r={value:e,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout((()=>{this.remove(t,r)}),n)),this.data[o].push(r),this.order.push(o),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,o=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][o];return this.data[n].splice(o,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const o of this.data[n])t(o.value)||e.push(o);for(const n of e)this.remove(n.value.tileID,n)}}class Yf{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}Yf.ReadOnly=!1,Yf.ReadWrite=!0,Yf.disabled=new Yf(519,Yf.ReadOnly,[0,1]);const Kf=7680;class Zf{constructor(t,e,n,o,r,i){this.test=t,this.ref=e,this.mask=n,this.fail=o,this.depthFail=r,this.pass=i}}Zf.disabled=new Zf({func:519,mask:0},0,0,Kf,Kf,Kf);class Jf{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}Jf.Replace=[1,0],Jf.disabled=new Jf(Jf.Replace,Ae.transparent,[!1,!1,!1,!1]),Jf.unblended=new Jf(Jf.Replace,Ae.transparent,[!0,!0,!0,!0]),Jf.alphaBlended=new Jf([1,771],Ae.transparent,[!0,!0,!0,!0]);const Qf=1029,$f=2305;class tg{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}tg.disabled=new tg(!1,Qf,$f),tg.backCCW=new tg(!0,Qf,$f),tg.backCW=new tg(!0,Qf,2304),tg.frontCW=new tg(!0,1028,2304),tg.frontCCW=new tg(!0,1028,$f);class eg extends $t{constructor(t,e,n){super(),this.id=t,this._onlySymbols=n,e.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),e.on("error",(()=>{this._sourceErrored=!0})),this._source=e,this._tiles={},this._cache=new Xf(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Lf,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(t){this.map=t,this._minTileCacheSize=void 0===this._minTileCacheSize&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,(()=>{}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return A(this._tiles).map((t=>t.tileID)).sort(ng).map((t=>t.key))}getRenderableIds(t){const e=[];for(const n in this._tiles)this._isIdRenderable(+n,t)&&e.push(this._tiles[n]);return t?e.sort(((t,e)=>{const n=t.tileID,o=e.tileID,r=new v(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),i=new v(o.canonical.x,o.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-o.overscaledZ||i.y-r.y||i.x-r.x})).map((t=>t.tileID.key)):e.map((t=>t.tileID)).sort(ng).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(t,e,n,o){if(o)if(t.state="errored",404!==o.status)this._source.fire(new Qt(o,{tile:t}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const t=this.map.painter.terrain;this.update(this.transform,t.getScaledDemTileSize(),!0),t.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Yt.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Jt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let o=0;o<e.length;o++){const r=e[o];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);n(t,e),n(e,t)}}function n(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const o=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),i=e.tileID.key;0===n&&0===o||Math.abs(o)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,o),t.neighboringTiles&&t.neighboringTiles[i]&&(t.neighboringTiles[i].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,o){for(const r in this._tiles){let i=this._tiles[r];if(o[r]||!i.hasData()||i.tileID.overscaledZ<=e||i.tileID.overscaledZ>n)continue;let s=i.tileID;for(;i&&i.tileID.overscaledZ>e+1;){const t=i.tileID.scaledTo(i.tileID.overscaledZ-1);i=this._tiles[t.key],i&&i.hasData()&&(s=t)}let a=s;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){o[s.key]=s;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),o=this._getLoadedTile(e);if(o)return o}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const n=Math.ceil(t.width/e)+1,o=Math.ceil(t.height/e)+1,r=Math.floor(n*o*5),i="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,r):r,s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(s)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const o=this._tiles[n];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+e),t[o.tileID.key]=o}this._tiles=t;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(+e,this._tiles[e])}}update(t,e,n){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let o;this.updateCacheSize(t,e),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?o=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new fp(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(o=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(o=o.filter((t=>this._source.hasTile(t))))):o=[];const r=this._updateRetainedTiles(o);if(og(this._source.type)&&0!==o.length){const t={},e={},n=Object.keys(r);for(const o of n){const n=r[o],i=this._tiles[o];if(!i||i.fadeEndTime&&i.fadeEndTime<=Yt.now())continue;const s=this.findLoadedParent(n,Math.max(n.overscaledZ-eg.maxOverzooming,this._source.minzoom));s&&(this._addTile(s.tileID),t[s.tileID.key]=s.tileID),e[o]=n}const i=o[o.length-1].overscaledZ;for(const o in this._tiles){const t=this._tiles[o];if(r[o]||!t.hasData())continue;let n=t.tileID;for(;n.overscaledZ>i;){n=n.scaledTo(n.overscaledZ-1);const i=this._tiles[n.key];if(i&&i.hasData()&&e[n.key]){r[o]=t.tileID;break}}}for(const o in t)r[o]||(this._coveredTiles[o]=!0,r[o]=t[o])}for(const s in r)this._tiles[s].clearFadeHold();const i=function(t,e){const n=[];for(const o in t)o in e||n.push(o);return n}(this._tiles,r);for(const s of i){const t=this._tiles[s];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(+s)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const n={},o=t.reduce(((t,e)=>Math.min(t,e.overscaledZ)),1/0),r=t[0].overscaledZ,i=Math.max(r-eg.maxOverzooming,this._source.minzoom),s=Math.max(r+eg.maxUnderzooming,this._source.minzoom),a={};for(const l of t){const t=this._addTile(l);e[l.key]=l,t.hasData()||o<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,o,s,e);for(const l of t){let t=this._tiles[l.key];if(t.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const t=l.children(this._source.maxzoom)[0],n=this.getTile(t);if(n&&n.hasData()){e[t.key]=t;continue}}else{const t=l.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let o=t.wasRequested();for(let r=l.overscaledZ-1;r>=i;--r){const i=l.scaledTo(r);if(n[i.key])break;if(n[i.key]=!0,t=this.getTile(i),!t&&o&&(t=this._addTile(i)),t&&(e[i.key]=i,o=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,o=this._tiles[t].tileID;for(;o.overscaledZ>0;){if(o.key in this._loadedParentTiles){n=this._loadedParentTiles[o.key];break}e.push(o.key);const t=o.scaledTo(o.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;o=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const n=Boolean(e);if(!n){const n=this.map?this.map.painter:null;e=new Mf(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,n,this._isRaster),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))}return e?(e.uses++,this._tiles[t.key]=e,n||this._source.fire(new Jt("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,e,n){const o=[],r=this.transform;if(!r)return o;const i="globe"===r.projection.name,s=Ul(r.center.lng);for(const a in this._tiles){const l=this._tiles[a];if(n&&l.clearQueryDebugViz(),l.holdingForFade())continue;let u;if(i){const t=l.tileID.canonical;if(0===t.z){const e=[Math.abs(R(s,...rg(t,-1))-s),Math.abs(R(s,...rg(t,1))-s)];u=[0,2*e.indexOf(Math.min(...e))-1]}else{const e=[Math.abs(R(s,...rg(t,-1))-s),Math.abs(R(s,...rg(t,0))-s),Math.abs(R(s,...rg(t,1))-s)];u=[e.indexOf(Math.min(...e))-1]}}else u=[0];for(const n of u){const i=t.containsTile(l,r,e,n);i&&o.push(i)}}return o}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const n of e)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(og(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=Yt.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const o=this._tiles[t];o&&o.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(+n,"reloading");this._cache.filter((n=>!n.hasDependency(t,e)))}_preloadTiles(t,e){if(!this._sourceLoaded){const n=()=>{this._sourceLoaded&&(this._source.off("data",n),this._preloadTiles(t,e))};return void this._source.on("data",n)}const n=new Map,o=Array.isArray(t)?t:[t],r=this.map.painter.terrain,i=this.usedForTerrain&&r?r.getScaledDemTileSize():this._source.tileSize;for(const s of o){const t=s.coveringTiles({tileSize:i,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const e of t)n.set(e.key,e);this.usedForTerrain&&s.updateElevation(!1)}I(Array.from(n.values()),((t,e)=>{const n=new Mf(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(n,(t=>{"raster-dem"===this._source.type&&n.dem&&this._backfillDEM(n),e(t,n)}))}),e)}}function ng(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),o=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||o-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function og(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function rg(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}eg.maxOverzooming=10,eg.maxUnderzooming=3;class ig{constructor(t,e,n){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=n}static create(t,e,n){const o=n||t.findDEMTileFor(e);if(!o||!o.dem)return;const r=o.dem,i=o.tileID,s=1<<e.canonical.z-i.canonical.z;return new ig(o,o.tileSize/aa/s,[(e.canonical.x/s-i.canonical.x)*r.dim,(e.canonical.y/s-i.canonical.y)*r.dim])}tileCoordToPixel(t,e){const n=e*this._scale+this._offset[1],o=Math.floor(t*this._scale+this._offset[0]),r=Math.floor(n);return new v(o,r)}getElevationAt(t,e,n,o){const r=t*this._scale+this._offset[0],i=e*this._scale+this._offset[1],s=Math.floor(r),a=Math.floor(i),l=this._dem;return o=!!o,n?Dn(Dn(l.get(s,a,o),l.get(s,a+1,o),i-a),Dn(l.get(s+1,a,o),l.get(s+1,a+1,o),i-a),r-s):l.get(s,a,o)}getElevationAtPixel(t,e,n){return this._dem.get(t,e,!!n)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*ql(1,t)*this._dem.stride}}class sg{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Yr(aa,16,0),this.featureIndexArray=new ws,this.promoteId=e}insert(t,e,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,o,r,i);const a=this.grid;for(let l=0;l<e.length;l++){const t=e[l],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<t.length;e++){const o=t[e];n[0]=Math.min(n[0],o.x),n[1]=Math.min(n[1],o.y),n[2]=Math.max(n[2],o.x),n[3]=Math.max(n[3],o.y)}n[0]<aa&&n[1]<aa&&n[2]>=0&&n[3]>=0&&a.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new qc(new mh(this.rawTileData)).layers,this.sourceLayerCoder=new wf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,e,n,o){var r=this;this.loadVTLayers();const i=t.params||{},s=hr(i.filter),a=t.tileResult,l=t.transform,u=a.bufferedTilespaceBounds,c=this.grid.query(u.min.x,u.min.y,u.max.x,u.max.y,((t,e,n,o)=>wu(a.bufferedTilespaceGeometry,t,e,n,o)));c.sort(lg);let p=null;l.elevation&&c.length>0&&(p=ig.create(l.elevation,this.tileID));const h={};let d;for(let f=0;f<c.length;f++){const l=c[f];if(l===d)continue;d=l;const u=this.featureIndexArray.get(l);let g=null;this.loadMatchingFeature(h,u,s,i.layers,i.availableImages,e,n,o,(function(e,n,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return g||(g=su(e,r.tileID.canonical,t.tileTransform)),n.queryIntersectsFeature(a,e,o,g,r.z,t.transform,t.pixelPosMatrix,p,i)}))}return h}loadMatchingFeature(t,e,n,o,r,i,s,a,l){const{featureIndex:u,bucketIndex:c,sourceLayerIndex:p,layoutVertexArrayOffset:h}=e,d=this.bucketLayerIDs[c];if(o&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,d))return;const f=this.sourceLayerCoder.decode(p),g=this.vtLayers[f].feature(u);if(n.needGeometry){const t=au(g,!0);if(!n.filter(new bi(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new bi(this.tileID.overscaledZ),g))return;const m=this.getId(g,f);for(let y=0;y<d.length;y++){const e=d[y];if(o&&o.indexOf(e)<0)continue;const n=i[e];if(!n)continue;let c={};void 0!==m&&a&&(c=a.getState(n.sourceLayer||"_geojsonTileLayer",m));const p=D({},s[e]);p.paint=ag(p.paint,n.paint,g,c,r),p.layout=ag(p.layout,n.layout,g,c,r);const f=!l||l(g,n,c,h);if(!f)continue;const v=new xf(g,this.z,this.x,this.y,m);v.layer=p;let _=t[e];void 0===_&&(_=t[e]=[]),_.push({featureIndex:u,feature:v,intersectionZ:f})}}lookupSymbolFeatures(t,e,n,o,r,i,s,a){const l={};this.loadVTLayers();const u=hr(r);for(const c of t)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:o,featureIndex:c,layoutVertexArrayOffset:0},u,i,s,a,e);return l}loadFeature(t){const{featureIndex:e,sourceLayerIndex:n}=t;this.loadVTLayers();const o=this.sourceLayerCoder.decode(n),r=this.vtFeatures[o];if(r[e])return r[e];const i=this.vtLayers[o].feature(e);return r[e]=i,i}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;if(this.promoteId){const o="string"==typeof this.promoteId?this.promoteId:this.promoteId[e];null!=o&&(n=t.properties[o]),"boolean"==typeof n&&(n=Number(n))}return n}}function ag(t,e,n,o,r){return V(t,((t,i)=>{const s=e instanceof Ii?e.get(i):null;return s&&s.evaluate?s.evaluate(n,o,r):s}))}function lg(t,e){return e-t}Zr(sg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class ug{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new Gu({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const n=this.getKey(t,e);return this.positions[n]}trim(){const t=this.width,e=this.height=F(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,n){const o=[];let r=t.length%2==1?-t[t.length-1]*n:0,i=t[0]*n,s=!0;o.push({left:r,right:i,isDash:s,zeroLength:0===t[0]});let a=t[0];for(let l=1;l<t.length;l++){s=!s;const e=t[l];r=a*n,a+=e,i=a*n,o.push({left:r,right:i,isDash:s,zeroLength:0===e})}return o}addRoundDash(t,e,n){const o=e/2;for(let r=-n;r<=n;r++){const e=this.width*(this.nextRow+n+r);let i=0,s=t[i];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++i]);const l=Math.abs(a-s.left),u=Math.abs(a-s.right),c=Math.min(l,u);let p;const h=r/n*(o+1);if(s.isDash){const t=o-Math.abs(h);p=Math.sqrt(c*c+t*t)}else p=o-Math.sqrt(c*c+h*h);this.image.data[e+a]=Math.max(0,Math.min(255,p+128))}}}addRegularDash(t,e){for(let a=t.length-1;a>=0;--a){const e=t[a],n=t[a+1];e.zeroLength?t.splice(a,1):n&&n.isDash===e.isDash&&(n.left=e.left,t.splice(a,1))}const n=t[0],o=t[t.length-1];n.isDash===o.isDash&&(n.left=o.left-this.width,o.right=n.right+this.width);const r=this.width*this.nextRow;let i=0,s=t[i];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++i]);const n=Math.abs(a-s.left),o=Math.abs(a-s.right),l=Math.min(n,o);this.image.data[r+a]=Math.max(0,Math.min(255,(s.isDash?l:-l)+e+128))}}addDash(t,e){const n=this.getKey(t,e);if(this.positions[n])return this.positions[n];const o="round"===e,r=o?7:0,i=2*r+1;if(this.nextRow+i>this.height)return U("LineAtlas out of space"),null;0===t.length&&t.push(1);let s=0;for(let u=0;u<t.length;u++)t[u]<0&&(U("Negative value is found in line dasharray, replacing values with 0"),t[u]=0),s+=t[u];if(0!==s){const n=this.width/s,i=this.getDashRanges(t,this.width,n);o?this.addRoundDash(i,n,r):this.addRegularDash(i,"square"===e?.5*n:0)}const a=this.nextRow+r;this.nextRow+=i;const l={tl:[a,r],br:[s,0]};return this.positions[n]=l,l}}Zr(ug,"LineAtlas");const cg=1*td;class pg{constructor(t){const e={},n=[];for(const s in t){const o=t[s],r=e[s]={};for(const t in o.glyphs){const e=o.glyphs[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const i=e.metrics.localGlyph?cg:1,s={x:0,y:0,w:e.bitmap.width+2*i,h:e.bitmap.height+2*i};n.push(s),r[t]=s}}const{w:o,h:r}=bh(n),i=new Gu({width:o||1,height:r||1});for(const s in t){const n=t[s];for(const t in n.glyphs){const o=n.glyphs[+t];if(!o||0===o.bitmap.width||0===o.bitmap.height)continue;const r=e[s][t],a=o.metrics.localGlyph?cg:1;Gu.copy(o.bitmap,i,{x:0,y:0},{x:r.x+a,y:r.y+a},o.bitmap)}}this.image=i,this.positions=e}}Zr(pg,"GlyphAtlas");class hg{constructor(t){this.tileID=new fp(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Id(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,e,n,o,r){this.status="parsing",this.data=t,this.collisionBoxArray=new ds;const i=new wf(Object.keys(t.layers).sort()),s=new sg(this.tileID,this.promoteId);s.bucketLayerIDs=[];const a={},l=new ug(256,256),u={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:n},c=e.familiesBySource[this.source];for(const C in c){const e=t.layers[C];if(!e)continue;let o=!1,r=!1;for(const t of c[C])"symbol"===t[0].type?o=!0:r=!0;if(!0===this.isSymbolTile&&!o)continue;if(!1===this.isSymbolTile&&!r)continue;1===e.version&&U('Vector tile source "'.concat(this.source,'" layer "').concat(C,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));const l=i.encode(C),p=[];for(let t=0;t<e.length;t++){const n=e.feature(t),o=s.getId(n,C);p.push({feature:n,id:o,index:t,sourceLayerIndex:l})}for(const t of c[C]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(dg(t,this.zoom,n),(a[e.id]=e.createBucket({index:s.bucketLayerIDs.length,layers:t,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:n})).populate(p,u,this.tileID.canonical,this.tileTransform),s.bucketLayerIDs.push(t.map((t=>t.id))))}}let p,h,d,f;l.trim();const g={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},m=()=>{if(p)return r(p);if(h&&d&&f){const t=new pg(h),e=new Sh(d,f);for(const o in a){const r=a[o];r instanceof af?(dg(r.layers,this.zoom,n),_d(r,h,t.positions,d,e.iconPositions,this.showCollisionBoxes,n,this.tileID.canonical,this.tileZoom,this.projection)):r.hasPattern&&(r instanceof Tp||r instanceof Rc||r instanceof tp)&&(dg(r.layers,this.zoom,n),r.addFeatures(u,this.tileID.canonical,e.patternPositions,n,this.tileTransform))}this.status="done",r(null,{buckets:A(a).filter((t=>!t.isEmpty())),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:l,imageAtlas:e,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?t.positions:null})}},y=V(u.glyphDependencies,(t=>Object.keys(t).map(Number)));Object.keys(y).length?o.send("getGlyphs",{uid:this.uid,stacks:y},((t,e)=>{p||(p=t,h=e,m())}),void 0,!1,g):h={};const v=Object.keys(u.iconDependencies);v.length?o.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"icons"},((t,e)=>{p||(p=t,d=e,m())}),void 0,!1,g):d={};const _=Object.keys(u.patternDependencies);_.length?o.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"patterns"},((t,e)=>{p||(p=t,f=e,m())}),void 0,!1,g):f={},m()}}function dg(t,e,n){const o=new bi(e);for(const r of t)r.recalculate(o,n)}class fg{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,o){const r=this.entries[t]=this.entries[t]||{callbacks:[]};if(r.result){const[t,n]=r.result;return this.scheduler?this.scheduler.add((()=>{o(t,n)}),e):o(t,n),()=>{}}return r.callbacks.push(o),r.cancel||(r.cancel=n(((n,o)=>{r.result=[n,o];for(const t of r.callbacks)this.scheduler?this.scheduler.add((()=>{t(n,o)}),e):t(n,o);setTimeout((()=>delete this.entries[t]),3e3)}))),()=>{r.result||(r.callbacks=r.callbacks.filter((t=>t!==o)),r.callbacks.length||(r.cancel(),delete this.entries[t]))}}}function gg(t,e,n){const o=JSON.stringify(t.request);return t.data&&(this.deduped.entries[o]={result:[null,t.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},(e=>{const o=ht(t.request,((t,o,r,i)=>{t?e(t):o&&e(null,{vectorTile:n?void 0:new qc(new mh(o)),rawData:o,cacheControl:r,expires:i})}));return()=>{o.cancel(),e()}}),e)}const mg=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class yg{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const o=n>>4;if(1!==o)throw new Error("Got v".concat(o," data when expected v1."));const r=mg[15&n];if(!r)throw new Error("Unrecognized array type.");const[i]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new yg(s,i,r,t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,o=arguments.length>3?arguments[3]:void 0;if(isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const r=mg.indexOf(this.ArrayType),i=2*t*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(r<0)throw new Error("Unexpected typed array class: ".concat(n,"."));o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+a,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+i+s+a),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+a,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error("Added ".concat(t," items when expected ").concat(this.numItems,"."));return vg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:i,nodeSize:s}=this,a=[0,r.length-1,0],l=[];for(;a.length;){const u=a.pop()||0,c=a.pop()||0,p=a.pop()||0;if(c-p<=s){for(let s=p;s<=c;s++){const a=i[2*s],u=i[2*s+1];a>=t&&a<=n&&u>=e&&u<=o&&l.push(r[s])}continue}const h=p+c>>1,d=i[2*h],f=i[2*h+1];d>=t&&d<=n&&f>=e&&f<=o&&l.push(r[h]),(0===u?t<=d:e<=f)&&(a.push(p),a.push(h-1),a.push(1-u)),(0===u?n>=d:o>=f)&&(a.push(h+1),a.push(c),a.push(1-u))}return l}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:r,nodeSize:i}=this,s=[0,o.length-1,0],a=[],l=n*n;for(;s.length;){const u=s.pop()||0,c=s.pop()||0,p=s.pop()||0;if(c-p<=i){for(let n=p;n<=c;n++)bg(r[2*n],r[2*n+1],t,e)<=l&&a.push(o[n]);continue}const h=p+c>>1,d=r[2*h],f=r[2*h+1];bg(d,f,t,e)<=l&&a.push(o[h]),(0===u?t-n<=d:e-n<=f)&&(s.push(p),s.push(h-1),s.push(1-u)),(0===u?t+n>=d:e+n>=f)&&(s.push(h+1),s.push(c),s.push(1-u))}return a}}function vg(t,e,n,o,r,i){if(r-o<=n)return;const s=o+r>>1;_g(t,e,s,o,r,i),vg(t,e,n,o,s-1,1-i),vg(t,e,n,s+1,r,1-i)}function _g(t,e,n,o,r,i){for(;r>o;){if(r-o>600){const s=r-o+1,a=n-o+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);_g(t,e,n,Math.max(o,Math.floor(n-a*u/s+c)),Math.min(r,Math.floor(n+(s-a)*u/s+c)),i)}const s=e[2*n+i];let a=o,l=r;for(Cg(t,e,o,n),e[2*r+i]>s&&Cg(t,e,o,r);a<l;){for(Cg(t,e,a,l),a++,l--;e[2*a+i]<s;)a++;for(;e[2*l+i]>s;)l--}e[2*o+i]===s?Cg(t,e,o,l):(l++,Cg(t,e,l,r)),l<=n&&(o=l+1),n<=l&&(r=l-1)}}function Cg(t,e,n,o){wg(t,n,o),wg(e,2*n,2*o),wg(e,2*n+1,2*o+1)}function wg(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}function bg(t,e,n,o){const r=t-n,i=e-o;return r*r+i*i}t.ARRAY_TYPE=ca,t.AUTH_ERR_MSG=vt,t.Aabb=rl,t.Actor=class{constructor(t,n,o){this.target=t,this.parent=n,this.mapId=o,this.callbacks={},this.cancelCallbacks={},G(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=X()?t:e,this.scheduler=new Cf}send(t,e,n,o){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=i,this.callbacks[s]=n);const a=Z(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:t,hasCallback:!!n,targetMapId:o,mustQueue:r,sourceMapId:this.mapId,data:$r(e,a)},a),{cancel:()=>{n&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:o,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t.cancel()}else if(e.mustQueue||X()){const t=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add((()=>this.processTask(n,e)),t&&t.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(ti(e.error)):n(null,ti(e.data)))}else{const n=Z(this.globalScope)?void 0:[],o=e.hasCallback?(e,o)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?$r(e):null,data:$r(o,n)},n)}:t=>{},r=ti(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,r,o);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],r.source)[t[1]](r,o)}else o(new Error("Could not find function ".concat(e.type)))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=hp,t.Color=Ae,t.ColorMode=Jf,t.CullFaceMode=tg,t.DEMData=qf,t.DataConstantProperty=Ai,t.DedupedRequest=fg,t.DepthMode=Yf,t.EXTENT=aa,t.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,o=1<<n,r=Math.floor(t.x),i=Math.floor((t.x-r)*o),s=Math.floor(t.y*o),a=this.findDEMTileFor(new fp(n,r,n,i,s));return!(!a||!a.dem)}getAtPointOrZero(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(t,e)||0}getAtPoint(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isUsingMockSource())return null;null==e&&(e=null);const o=this._source();if(!o)return e;if(t.y<0||t.y>1)return e;const r=o.getSource().maxzoom,i=1<<r,s=Math.floor(t.x),a=t.x-s,l=new fp(r,s,r,Math.floor(a*i),Math.floor(t.y*i)),u=this.findDEMTileFor(l);if(!u||!u.dem)return e;const c=u.dem,p=1<<u.tileID.canonical.z,h=(a*p-u.tileID.canonical.x)*c.dim,d=(t.y*p-u.tileID.canonical.y)*c.dim,f=Math.floor(h),g=Math.floor(d);return(n?this.exaggeration():1)*Dn(Dn(c.get(f,g),c.get(f,g+1),d-g),Dn(c.get(f+1,g),c.get(f+1,g+1),d-g),h-f)}getAtTileOffset(t,e,n){const o=1<<t.canonical.z;return this.getAtPointOrZero(new Ql(t.wrap+(t.canonical.x+e/aa)/o,(t.canonical.y+n/aa)/o))}getAtTileOffsetFunc(t,e,n,o){return r=>{const i=this.getAtTileOffset(t,r.x,r.y),s=o.upVector(t.canonical,r.x,r.y);return Da(s,s,i*o.upVectorScale(t.canonical,e,n).metersToTile),s}}getForTilePoints(t,e,n,o){if(this.isUsingMockSource())return!1;const r=ig.create(this,t,o);return!!r&&(e.forEach((t=>{t[2]=this.exaggeration()*r.getElevationAt(t[0],t[1],n)})),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,o=e.tileID,r=1<<t.canonical.z-o.canonical.z;let i=t.canonical.x/r-o.canonical.x,s=t.canonical.y/r-o.canonical.y,a=0;for(let l=0;l<t.canonical.z-o.canonical.z&&!n.leaves[a];l++){i*=2,s*=2;const t=2*Math.floor(s)+Math.floor(i);a=n.childOffsets[a]+t,i%=1,s%=1}return{min:this.exaggeration()*n.minimums[a],max:this.exaggeration()*n.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Qt,t.EvaluationParameters=bi,t.Event=Jt,t.Evented=$t,t.FillExtrusionBucket=tp,t.Frustum=ol,t.FrustumCorners=nl,t.GLOBE_RADIUS=al,t.GLOBE_SCALE_MATCH_LATITUDE=45,t.GLOBE_ZOOM_THRESHOLD_MAX=sl,t.GLOBE_ZOOM_THRESHOLD_MIN=il,t.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_fillGridMeshWithLods(t,e){const n=new zi,o=new os,r=[],i=t+1+2,s=e[0]+1,a=e[0]+1+(1+e.length),l=(t,e,n)=>{let o=t===i-1?t-2:0===t?t:t-1;return o+=n?24575:0,[o,e]};for(let u=0;u<i;++u)n.emplaceBack(...l(u,0,!0));for(let u=0;u<s;++u)for(let t=0;t<i;++t)n.emplaceBack(...l(t,u,(0===t||t===i-1)&&!0));for(let u=0;u<e.length;++u){const t=e[u];for(let e=0;e<i;++e)n.emplaceBack(...l(e,t,!0))}for(let u=0;u<e.length;++u){const t=o.length,s=e[u]+1+2,l=new os;for(let n=0;n<s-1;n++){const t=n===s-2,r=t?i*(a-e.length+u-n):i;for(let e=0;e<i-1;e++){const s=n*i+e;0===n||t||0===e||e===i-2?(l.emplaceBack(s+1,s,s+r),l.emplaceBack(s+r,s+r+1,s+1)):(o.emplaceBack(s+1,s,s+r),o.emplaceBack(s+r,s+r+1,s+1))}}const c=sa.simpleSegment(0,t,n.length,o.length-t);for(let e=0;e<l.uint16.length;e+=3)o.emplaceBack(l.uint16[e],l.uint16[e+1],l.uint16[e+2]);const p=sa.simpleSegment(0,t,n.length,o.length-t);r.push({withoutSkirts:c,withSkirts:p})}return{vertices:n,indices:o,segments:r}}_createGrid(t){const e=this._fillGridMeshWithLods(ul,cl);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,tl.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new os;for(let r=0;r<=ul;r++)e.emplaceBack(0,r+1,r+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new as,o=new as;this._poleSegments=[];for(let r=0,i=0;r<il;r++){const t=360/(1<<r);n.emplaceBack(0,-al,0,.5,0),o.emplaceBack(0,-al,0,.5,1);for(let e=0;e<=ul;e++){const r=e/ul,i=Dn(0,t,r),[s,a,l]=Sl(kl,Gl,i,al);n.emplaceBack(s,a,l,r,0),o.emplaceBack(s,a,l,r,1)}this._poleSegments.push(sa.simpleSegment(i,0,66,64)),i+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,Qa,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(o,Qa,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const e=new us,n=ul,o=n+1+2,r=1;this._wireframeSegments=[];for(let t=0,i=0;t<cl.length;t++){const s=cl[t];for(let t=r;t<s+r;t++)for(let i=r;i<n+r;i++){const n=t*o+i;e.emplaceBack(n,n+1),e.emplaceBack(n,n+o),e.emplaceBack(n,n+o+1)}const a=s*n*3;this._wireframeSegments.push(sa.simpleSegment(0,i,(s+1)*o,a)),i+=a}this._wireframeIndexBuffer=t.createIndexBuffer(e)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},t.GlyphManager=nd,t.ImagePosition=Eh,t.KDBush=yg,t.LivePerformanceUtils=Vt,t.LngLat=jl,t.LngLatBounds=la,t.LocalGlyphMode=ed,t.MAX_MERCATOR_LATITUDE=Zl,t.MercatorCoordinate=Ql,t.ONE_EM=Gp,t.OverscaledTileID=fp,t.PerformanceMarkers=Bt,t.Point=v,t.Properties=Li,t.RGBAImage=Bu,t.Ray=el,t.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",p,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!_t(t))return t;const n=St(t);return n.path="/styles/v1".concat(n.path),this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!_t(t))return t;const n=St(t);return n.path="/fonts/v1".concat(n.path),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,o){if(!_t(t))return t;const r=St(t);return r.path="/v4/".concat(r.authority,".json"),r.params.push("secure"),n&&r.params.push("language=".concat(n)),o&&r.params.push("worldview=".concat(o)),this._makeAPIURL(r,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,o){const r=St(t);return _t(t)?(r.path="/styles/v1".concat(r.path,"/sprite").concat(e).concat(n),this._makeAPIURL(r,this._customAccessToken||o)):(r.path+="".concat(e).concat(n),Tt(r))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!_t(t))return t;const o=St(t);o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(e||n&&"raster"!==o.authority&&512===n?"@2x":"").concat(i.supported?".webp":"$1")),"raster"===o.authority?o.path="/".concat(r.RASTER_URL_PREFIX).concat(o.path):(o.path=o.path.replace(/^.+\/v4\//,"/"),o.path="/".concat(r.TILE_URL_VERSION).concat(o.path));const s=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(o.params)||r.ACCESS_TOKEN;return r.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&o.params.push("sku=".concat(this._skuToken)),this._makeAPIURL(o,s)}canonicalizeTileURL(t,e){const n=St(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let o="mapbox://";n.path.match(/^\/raster\/v1\//)?o+="raster/".concat(n.path.replace("/".concat(r.RASTER_URL_PREFIX,"/"),"")):o+="tiles/".concat(n.path.replace("/".concat(r.TILE_URL_VERSION,"/"),""));let i=n.params;return e&&(i=i.filter((t=>!t.match(/^access_token=/)))),i.length&&(o+="?".concat(i.join("&"))),o}canonicalizeTileset(t,e){const n=!!e&&_t(e),o=[];for(const r of t.tiles||[])Ct(r)?o.push(this.canonicalizeTileURL(r,n)):o.push(r);return o}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",o=St(r.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==o.path&&(t.path="".concat(o.path).concat(t.path)),!r.REQUIRE_ACCESS_TOKEN)return Tt(t);if(e=e||r.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error("An API access token is required to use Mapbox GL. ".concat(n));if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(n))}return t.params=t.params.filter((t=>-1===t.indexOf("access_token"))),t.params.push("access_token=".concat(e||"")),Tt(t)}},t.ResourceType=lt,t.SegmentVector=sa,t.SourceCache=eg,t.StencilMode=Zf,t.StructArrayLayout1ui2=cs,t.StructArrayLayout2f1f2i16=ts,t.StructArrayLayout2i4=zi,t.StructArrayLayout2ui4=us,t.StructArrayLayout3f12=ns,t.StructArrayLayout3ui6=os,t.StructArrayLayout4i8=Hi,t.StructArrayLayout5f20=as,t.Texture=vf,t.Tile=Mf,t.Transitionable=Si,t.Uniform1f=ks,t.Uniform1i=class extends Fs{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},t.Uniform2f=class extends Fs{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},t.Uniform3f=class extends Fs{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},t.Uniform4f=Gs,t.UniformColor=Bs,t.UniformMatrix2f=class extends Fs{constructor(t){super(t),this.current=js}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let o=0;o<4;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},t.UniformMatrix3f=class extends Fs{constructor(t){super(t),this.current=zs}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let o=0;o<9;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},t.UniformMatrix4f=class extends Fs{constructor(t){super(t),this.current=Vs}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},t.UnwrappedTileID=dp,t.ValidationError=or,t.VectorTileFeature=Xc,t.VectorTileWorkerSource=class extends $t{constructor(t,e,n,o,r){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=r||gg,this.loading={},this.loaded={},this.deduped=new fg(t.scheduler),this.isSpriteLoaded=o,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,o=t&&t.request,r=o&&o.collectResourceTiming,i=this.loading[n]=new hg(t);i.abort=this.loadVectorData(t,((s,a)=>{const l=!this.loading[n];if(delete this.loading[n],l||s||!a)return i.status="done",l||(this.loaded[n]=i),e(s);const u=a.rawData,c={};a.expires&&(c.expires=a.expires),a.cacheControl&&(c.cacheControl=a.cacheControl),i.vectorTile=a.vectorTile||new qc(new mh(u));const p=()=>{i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,((t,n)=>{if(t||!n)return e(t);const i={};if(r){const t=Ht(o);t.length>0&&(i.resourceTiming=JSON.parse(JSON.stringify(t)))}e(null,D({rawTileData:u.slice(0)},n,c,i))}))};this.isSpriteLoaded?p():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(p,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):p()})),this.loaded=this.loaded||{},this.loaded[n]=i}))}reloadTile(t,e){const n=this.loaded,o=t.uid,r=this;if(n&&n[o]){const i=n[o];i.showCollisionBoxes=t.showCollisionBoxes,i.enableTerrain=!!t.enableTerrain,i.projection=t.projection,i.tileTransform=Id(t.tileID.canonical,t.projection);const s=(t,n)=>{const o=i.reloadCallback;o&&(delete i.reloadCallback,i.parse(i.vectorTile,r.layerIndex,this.availableImages,r.actor,o)),e(t,n)};"parsing"===i.status?i.reloadCallback=s:"done"===i.status&&(i.vectorTile?i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}abortTile(t,e){const n=t.uid,o=this.loading[n];o&&(o.abort&&o.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,o=t.uid;n&&n[o]&&delete n[o],e()}},t.WritingMode=Th,t.ZoomDependentExpression=$o,t.add=Ra,t.addDynamicAttributes=nf,t.adjoint=function(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=s*c-a*u,t[1]=r*u-o*c,t[2]=o*a-r*s,t[3]=a*l-i*c,t[4]=n*c-r*l,t[5]=r*i-n*a,t[6]=i*u-s*l,t[7]=o*l-n*u,t[8]=n*s-o*i,t},t.asyncAll=I,t.bezier=S,t.bindAll=G,t.boundsAttributes=Af,t.bufferConvexPolygon=function(t,e){const n=[];for(let o=0;o<t.length;o++){const r=P(o-1,-1,t.length-1),i=P(o+1,-1,t.length-1),s=t[o],a=t[i],l=t[r].sub(s).unit(),u=a.sub(s).unit(),c=u.angleWithSep(l.x,l.y),p=l.add(u).unit().mult(-1*e/Math.sin(c/2));n.push(s.add(p))}return n},t.cacheEntryPossiblyAdded=function(t){at++,at>ot&&(t.getActor().send("enforceCacheSizeLimit",nt),at=0)},t.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:o}=t.point,r=Dl(n,o,t.worldSize/t._pixelsPerMercatorPixel,0,0);return ga(r,r,Al(vl(e)))},t.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:o,lat:r}=t._center;return Dl(e,n,t.worldSize,o,r)},t.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/ql(1,t.center.lat),o=da(new Float64Array(16));return ma(o,o,[t.point.x,t.point.y,0]),ya(o,o,[n,n,e]),Float32Array.from(o)},t.circumferenceAtLatitude=Hl,t.clamp=R,t.clearTileCache=function(t){if(!rt())return;const n=e.caches.delete($);t&&n.catch(t).then((()=>t()))},t.clipLine=Zh,t.clone=function(t){var e=new ca(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=j,t.collisionCircleLayout=kp,t.config=r,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.create=function(){var t=new ca(16);return ca!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=pa,t.createExpression=Jo,t.createLayout=Bi,t.createStyleLayer=function(t){return"custom"===t.type?new ff(t):new yf[t.type](t)},t.cross=Fa,t.degToRad=w,t.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},t.dot=Na,t.earthRadius=Bl,t.ease=T,t.easeCubicInOut=E,t.ecefToLatLng=function(t){let[e,n,o]=t;const r=Math.hypot(e,n,o),i=Math.atan2(e,o),s=.5*Math.PI-Math.acos(-n/r);return new jl(b(i),b(s))},t.emitValidationErrors=Ur,t.endsWith=B,t.enforceCacheSizeLimit=function(t){it(),tt&&tt.then((e=>{e.keys().then((n=>{for(let o=0;o<n.length-t;o++)e.delete(n[o])}))}))},t.evaluateSizeForFeature=zp,t.evaluateSizeForZoom=jp,t.evaluateVariableOffset=vd,t.evented=vi,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=Yt,t.exported$1=i,t.extend=D,t.extend$1=ee,t.fillExtrusionHeightLift=ap,t.filterObject=z,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],s=n+n,a=o+o,l=r+r,u=n*s,c=o*s,p=o*a,h=r*s,d=r*a,f=r*l,g=i*s,m=i*a,y=i*l;return t[0]=1-p-f,t[1]=c+y,t[2]=h-m,t[3]=0,t[4]=c-y,t[5]=1-u-f,t[6]=d+g,t[7]=0,t[8]=h+m,t[9]=d-g,t[10]=1-u-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=-n,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=Ca,t.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return x[e]},t.getAABBPointSquareDist=function(t,e,n){let o=0;for(let r=0;r<2;++r){const i=n?n[r]:0;t[r]>i&&(o+=(t[r]-i)*(t[r]-i)),e[r]<i&&(o+=(i-e[r])*(i-e[r]))}return o},t.getAnchorAlignment=Gh,t.getAnchorJustification=Cd,t.getBounds=function(t){let e=1/0,n=1/0,o=-1/0,r=-1/0;for(const i of t)e=Math.min(e,i.x),n=Math.min(n,i.y),o=Math.max(o,i.x),r=Math.max(r,i.y);return{min:new v(e,n),max:new v(o,r)}},t.getColumn=Q,t.getDefaultExportFromCjs=h,t.getGridMatrix=function(t,e,n,o){const r=e.getNorth(),i=e.getSouth(),s=e.getWest(),a=e.getEast(),l=1<<t.z,u=a-s,c=r-i,p=u/ul,h=-c/cl[n],d=[0,p,0,h,0,0,r,s,0];if(t.z>0){const t=180/o;ha(d,d,[t/u+1,0,0,0,t/c+1,0,-.5*t/p,.5*t/h,1])}return d[2]=l,d[5]=t.x,d[8]=t.y,d},t.getImage=yt,t.getJSON=function(t,e){return pt(D(t,{type:"json"}),e)},t.getLatitudinalLod=function(t){const e=Zl-5;t=R(t,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(w(t))),3);return Math.round(n*(cl.length-1))},t.getMapSessionAPI=kt,t.getPerformanceMeasurement=Ht,t.getProjection=Jd,t.getRTLTextPluginStatus=_i,t.getReferrer=ct,t.getTilePoint=function(t,e){let{x:n,y:o}=e;return new v(((n-(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0))*t.scale-t.x)*aa,(o*t.scale-t.y)*aa)},t.getTileVec3=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ta(((e.x-n)*t.scale-t.x)*aa,(e.y*t.scale-t.y)*aa,Kl(e.z,e.y))},t.getVideo=function(t,n){const o=e.document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(let r=0;r<t.length;r++){const n=e.document.createElement("source");dt(t[r])||(o.crossOrigin="Anonymous"),n.src=t[r],o.appendChild(n)}return{cancel:()=>{}}},t.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=da(new Float64Array(16));return ga(n,t.pixelMatrix,t.globeMatrix),ka(e,e,n),new v(e[0],e[1])},t.globeDenormalizeECEF=Al,t.globeECEFOrigin=function(t,e){const n=[0,0,0];return ka(n,n,Il(vl(e.canonical))),ka(n,n,t),n},t.globeMetersToEcef=fl,t.globeNormalizeECEF=Il,t.globePixelsToTileUnits=function(t,e){return aa/(512*Math.pow(2,t))*Ol(vl(e))},t.globePoleMatrixForTile=function(t,e,n){const o=da(new Float64Array(16)),r=(e/(1<<t)-.5)*Math.PI*2;return _a(o,n.globeMatrix,r),Float32Array.from(o)},t.globeTileBounds=vl,t.globeTiltAtLngLat=Ll,t.globeToMercatorTransition=Ml,t.globeUseCustomAntiAliasing=function(t,e,n){const o=Ml(n.zoom),r=t.style.map._antialias,i=!!e.extStandardDerivatives,s=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===o&&!r&&!s&&i},t.identity=da,t.identity$1=Xa,t.invert=fa,t.isFullscreen=function(){return!!e.document.fullscreenElement||!!e.document.webkitFullscreenElement},t.isLngLatBehindGlobe=Nl,t.isMapAuthenticated=function(t){return Gt.has(t)},t.isMapboxURL=_t,t.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!Z(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},t.latFromMercatorY=Yl,t.latLngToECEF=Tl,t.len=ja,t.length=Sa,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.lngFromMercatorX=Xl,t.loadVectorTile=gg,t.makeRequest=pt,t.mapValue=function(t,e,n,o,r){return R((t-e)/(n-e)*(r-o)+o,o,r)},t.mercatorScale=Jl,t.mercatorXfromLng=Ul,t.mercatorYfromLat=Wl,t.mercatorZfromAltitude=ql,t.mul=ba,t.mul$1=za,t.multiply=ga,t.multiply$1=ha,t.multiply$2=Pa,t.nextPowerOfTwo=F,t.normalize=La,t.normalize$1=Za,t.normalize$2=Ua,t.number=Dn,t.ortho=function(t,e,n,o,r,i,s){var a=1/(e-n),l=1/(o-r),u=1/(i-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+o)*l,t[14]=(s+i)*u,t[15]=1,t},t.pbf=Yp,t.perspective=function(t,e,n,o,r){var i,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+o)*(i=1/(o-r)),t[14]=2*r*o*i):(t[10]=-1,t[14]=-2*o),t},t.pick=function(t,e){const n={};for(let o=0;o<e.length;o++){const r=e[o];r in t&&(n[r]=t[r])}return n},t.plugin=wi,t.pointGeometry=m,t.polesInViewport=function(t){const e=da(new Float64Array(16));ga(e,t.pixelMatrix,t.globeMatrix);const n=[0,pl,0],o=[0,hl,0];return ka(n,n,e),ka(o,o,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!Nl(t,new jl(t.center.lat,90)),o[0]>0&&o[0]<=t.width&&o[1]>0&&o[1]<=t.height&&!Nl(t,new jl(t.center.lat,-90))]},t.polygonContainsPoint=Cu,t.polygonIntersectsBox=wu,t.polygonIntersectsPolygon=pu,t.polygonizeBounds=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=new v(n,n),i=t.sub(r),s=e.add(r),a=[i,new v(s.x,i.y),s,new v(i.x,s.y)];return o&&a.push(i.clone()),a},t.posAttributes=tl,t.postMapLoadEvent=Mt,t.postPerformanceEvent=Nt,t.postTurnstileEvent=At,t.potpack=bh,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=b,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:fi,pluginURL:gi}),vi.on("pluginStateChange",t),t},t.removeAuthState=function(t){Gt.delete(t)},t.renderColorRamp=zu,t.resample=tu,t.rotateX=va,t.rotateX$1=Ya,t.rotateY=_a,t.rotateY$1=Ka,t.rotateZ=function(t,e,n){var o=Math.sin(n),r=Math.cos(n),i=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r+u*o,t[1]=s*r+c*o,t[2]=a*r+p*o,t[3]=l*r+h*o,t[4]=u*r-i*o,t[5]=c*r-s*o,t[6]=p*r-a*o,t[7]=h*r-l*o,t},t.rotateZ$1=function(t,e,n){n*=.5;var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=o*l+r*a,t[1]=r*l-o*a,t[2]=i*l+s*a,t[3]=s*l-i*a,t},t.scale=ya,t.scale$1=Ha,t.scale$2=Da,t.scaleAndAdd=Ma,t.set=function(t,e,n,o){return t[0]=e,t[1]=n,t[2]=o,t},t.setCacheLimits=function(t,e){nt=t,ot=e},t.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},t.setRTLTextPlugin=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(fi===ci||fi===pi||fi===hi)throw new Error("setRTLTextPlugin cannot be called multiple times.");gi=Yt.resolveURL(t),fi=ci,di=e,yi(),n||Ci()},t.smoothstep=O,t.spec=te,t.squaredLength=function(t){var e=t[0],n=t[1],o=t[2];return e*e+n*n+o*o},t.storeAuthState=function(t,e){e?Gt.add(t):Gt.delete(t)},t.sub=Va,t.subtract=Oa,t.symbolSize=Hp,t.tileAABB=function(t,e,n,o,r,i,s,a,l){if("globe"===l.name)return bl(t,e,new hp(n,o,r));const u=Id({z:n,x:o,y:r},l);return new rl([(i+u.x/u.scale)*e,e*(u.y/u.scale),s],[(i+u.x2/u.scale)*e,e*(u.y2/u.scale),a])},t.tileCornersToBounds=xl,t.tileTransform=Id,t.transformMat3=function(t,e,n){var o=e[0],r=e[1],i=e[2];return t[0]=o*n[0]+r*n[3]+i*n[6],t[1]=o*n[1]+r*n[4]+i*n[7],t[2]=o*n[2]+r*n[5]+i*n[8],t},t.transformMat4=ka,t.transformMat4$1=Wa,t.transformQuat=Ga,t.transitionTileAABBinECEF=Cl,t.translate=ma,t.transpose=function(t,e){if(t===e){var n=e[1],o=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=o,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},t.triggerPluginCompletionEvent=mi,t.uniqueId=L,t.updateGlobeVertexNormal=function(t,e,n,o,r){const i=5*e+2;t.float32[i+0]=n,t.float32[i+1]=o,t.float32[i+2]=r},t.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===t.render&&e.push({message:"layers.".concat(n,': missing required method "render"')}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),e},t.validateFilter=t=>Hr(Er(t)),t.validateFog=t=>Hr(Fr(t)),t.validateLayer=t=>Hr(Pr(t)),t.validateLight=t=>Hr(Lr(t)),t.validateSource=t=>Hr(Dr(t)),t.validateStyle=Vr,t.validateTerrain=t=>Hr(Nr(t)),t.values=A,t.vectorTile=Lc,t.version=n,t.warnOnce=U,t.window=e,t.wrap=P})),o(["./shared"],(function(t){function e(t){if("number"==typeof t||"boolean"==typeof t||"string"==typeof t||null==t)return JSON.stringify(t);if(Array.isArray(t)){let n="[";for(const o of t)n+="".concat(e(o),",");return"".concat(n,"]")}let n="{";for(const o of Object.keys(t).sort())n+="".concat(o,":").concat(e(t[o]),",");return"".concat(n,"}")}function n(n){let o="";for(const r of t.refProperties)o+="/".concat(e(n[r]));return o}class o{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,o){for(const n of e)this._layerConfigs[n.id]=n,(this._layers[n.id]=t.createStyleLayer(n)).compileFilter(),this.keyCache[n.id]&&delete this.keyCache[n.id];for(const t of o)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=function(t,e){const o={};for(let i=0;i<t.length;i++){const r=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=r);let s=o[r];s||(s=o[r]=[]),s.push(t[i])}const r=[];for(const n in o)r.push(o[n]);return r}(t.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map((t=>this._layers[t.id])),n=e[0];if("none"===n.visibility)continue;const o=n.source||"";let r=this.familiesBySource[o];r||(r=this.familiesBySource[o]={});const i=n.sourceLayer||"_geojsonTileLayer";let s=r[i];s||(s=r[i]=[]),s.push(e)}}}class r{loadTile(e,n){const{uid:o,encoding:r,rawImageData:i,padding:s,buildQuadTree:a}=e,l=t.window.ImageBitmap&&i instanceof t.window.ImageBitmap?this.getImageData(i,s):i;n(null,new t.DEMData(o,l,r,s<1,a))}getImageData(t,e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);const n=this.offscreenCanvasContext.getImageData(-e,-e,t.width+2*e,t.height+2*e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),n}}function i(t,e){if(0!==t.length){s(t[0],e);for(var n=1;n<t.length;n++)s(t[n],!e)}}function s(t,e){for(var n=0,o=0,r=0,i=t.length,s=i-1;r<i;s=r++){var a=(t[r][0]-t[s][0])*(t[s][1]+t[r][1]),l=n+a;o+=Math.abs(n)>=Math.abs(a)?n-l+a:a-l+n,n=l}n+o>=0!=!!e&&t.reverse()}var a=t.getDefaultExportFromCjs((function t(e,n){var o,r=e&&e.type;if("FeatureCollection"===r)for(o=0;o<e.features.length;o++)t(e.features[o],n);else if("GeometryCollection"===r)for(o=0;o<e.geometries.length;o++)t(e.geometries[o],n);else if("Feature"===r)t(e.geometry,n);else if("Polygon"===r)i(e.coordinates,n);else if("MultiPolygon"===r)for(o=0;o<e.coordinates.length;o++)i(e.coordinates[o],n);return e}));const l=t.VectorTileFeature.prototype.toGeoJSON;var u={exports:{}},c=t.pointGeometry,p=t.vectorTile.VectorTileFeature,h=d;function d(t,e){this.options=e||{},this.features=t,this.length=t.length}function f(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}d.prototype.feature=function(t){return new f(this.features[t],this.options.extent)},f.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],o=[],r=0;r<n.length;r++)o.push(new c(n[r][0],n[r][1]));this.geometry.push(o)}return this.geometry},f.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,o=1/0,r=-1/0,i=0;i<t.length;i++)for(var s=t[i],a=0;a<s.length;a++){var l=s[a];e=Math.min(e,l.x),n=Math.max(n,l.x),o=Math.min(o,l.y),r=Math.max(r,l.y)}return[e,o,n,r]},f.prototype.toGeoJSON=p.prototype.toGeoJSON;var g=t.pbf,m=h;function y(t){var e=new g;return function(t,e){for(var n in t.layers)e.writeMessage(3,v,t.layers[n])}(t,e),e.finish()}function v(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var o={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)o.feature=t.feature(n),e.writeMessage(2,_,o);var r=o.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var i=o.values;for(n=0;n<i.length;n++)e.writeMessage(4,E,i[n])}function _(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,C,t),e.writeVarintField(3,n.type),e.writeMessage(4,x,n)}function C(t,e){var n=t.feature,o=t.keys,r=t.values,i=t.keycache,s=t.valuecache;for(var a in n.properties){var l=n.properties[a],u=i[a];if(null!==l){void 0===u&&(o.push(a),i[a]=u=o.length-1),e.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var p=c+":"+l,h=s[p];void 0===h&&(r.push(l),s[p]=h=r.length-1),e.writeVarint(h)}}}function w(t,e){return(e<<3)+(7&t)}function b(t){return t<<1^t>>31}function x(t,e){for(var n=t.loadGeometry(),o=t.type,r=0,i=0,s=n.length,a=0;a<s;a++){var l=n[a],u=1;1===o&&(u=l.length),e.writeVarint(w(1,u));for(var c=3===o?l.length-1:l.length,p=0;p<c;p++){1===p&&1!==o&&e.writeVarint(w(2,c-1));var h=l[p].x-r,d=l[p].y-i;e.writeVarint(b(h)),e.writeVarint(b(d)),r+=h,i+=d}3===o&&e.writeVarint(w(7,1))}}function E(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}u.exports=y,u.exports.fromVectorTileJs=y,u.exports.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var o in t)n[o]=new m(t[o].features,e),n[o].name=o,n[o].version=e.version,n[o].extent=e.extent;return y({layers:n})},u.exports.GeoJSONWrapper=m;var S=t.getDefaultExportFromCjs(u.exports);const T={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},R=Math.fround||(O=new Float32Array(1),t=>(O[0]=+t,O[0]));var O;const P=3,I=5,A=6;class D{constructor(t){this.options=Object.assign(Object.create(T),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:n,maxZoom:o}=this.options;e&&console.time("total time");const r="prepare ".concat(t.length," points");e&&console.time(r),this.points=t;const i=[];for(let a=0;a<t.length;a++){const e=t[a];if(!e.geometry)continue;const[n,o]=e.geometry.coordinates,r=R(N(n)),s=R(F(o));i.push(r,s,1/0,a,-1,1),this.options.reduce&&i.push(0)}let s=this.trees[o+1]=this._createTree(i);e&&console.timeEnd(r);for(let a=o;a>=n;a--){const t=+Date.now();s=this.trees[a]=this._createTree(this._cluster(s,a)),e&&console.log("z%d: %d clusters in %dms",a,s.numItems,+Date.now()-t)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){const t=this.getClusters([n,o,180,i],e),s=this.getClusters([-180,o,r,i],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],a=s.range(N(n),F(i),N(r),F(o)),l=s.data,u=[];for(const c of a){const t=this.stride*c;u.push(l[t+I]>1?M(l,t,this.clusterProps):this.points[l[t+P]])}return u}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),o="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(o);const i=r.data;if(e*this.stride>=i.length)throw new Error(o);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=r.within(i[e*this.stride],i[e*this.stride+1],s),l=[];for(const u of a){const e=u*this.stride;i[e+4]===t&&l.push(i[e+I]>1?M(i,e,this.clusterProps):this.points[i[e+P]])}if(0===l.length)throw new Error(o);return l}getLeaves(t,e,n){const o=[];return this._appendLeaves(o,t,e=e||10,n=n||0,0),o}getTile(t,e,n){const o=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:i,radius:s}=this.options,a=s/i,l=(n-a)/r,u=(n+1+a)/r,c={features:[]};return this._addTileFeatures(o.range((e-a)/r,l,(e+1+a)/r,u),o.data,e,n,r,c),0===e&&this._addTileFeatures(o.range(1-a/r,l,1,u),o.data,r,n,r,c),e===r-1&&this._addTileFeatures(o.range(0,l,a/r,u),o.data,-1,n,r,c),c.features.length?c:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,o,r){const i=this.getChildren(e);for(const s of i){const e=s.properties;if(e&&e.cluster?r+e.point_count<=o?r+=e.point_count:r=this._appendLeaves(t,e.cluster_id,n,o,r):r<o?r++:t.push(s),t.length===n)break}return r}_createTree(e){const n=new t.KDBush(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)n.add(e[t],e[t+1]);return n.finish(),n.data=e,n}_addTileFeatures(t,e,n,o,r,i){for(const s of t){const t=s*this.stride,a=e[t+I]>1;let l,u,c;if(a)l=L(e,t,this.clusterProps),u=e[t],c=e[t+1];else{const n=this.points[e[t+P]];l=n.properties;const[o,r]=n.geometry.coordinates;u=N(o),c=F(r)}const p={type:1,geometry:[[Math.round(this.options.extent*(u*r-n)),Math.round(this.options.extent*(c*r-o))]],tags:l};let h;h=a||this.options.generateId?e[t+P]:this.points[e[t+P]].id,void 0!==h&&(p.id=h),i.features.push(p)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:n,extent:o,reduce:r,minPoints:i}=this.options,s=n/(o*Math.pow(2,e)),a=t.data,l=[],u=this.stride;for(let c=0;c<a.length;c+=u){if(a[c+2]<=e)continue;a[c+2]=e;const n=a[c],o=a[c+1],p=t.within(a[c],a[c+1],s),h=a[c+I];let d=h;for(const t of p){const n=t*u;a[n+2]>e&&(d+=a[n+I])}if(d>h&&d>=i){let t,i=n*h,s=o*h,f=-1;const g=((c/u|0)<<5)+(e+1)+this.points.length;for(const n of p){const o=n*u;if(a[o+2]<=e)continue;a[o+2]=e;const l=a[o+I];i+=a[o]*l,s+=a[o+1]*l,a[o+4]=g,r&&(t||(t=this._map(a,c,!0),f=this.clusterProps.length,this.clusterProps.push(t)),r(t,this._map(a,o)))}a[c+4]=g,l.push(i/d,s/d,1/0,g,-1,d),r&&l.push(f)}else{for(let t=0;t<u;t++)l.push(a[c+t]);if(d>1)for(const t of p){const n=t*u;if(!(a[n+2]<=e)){a[n+2]=e;for(let t=0;t<u;t++)l.push(a[n+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,n){if(t[e+I]>1){const o=this.clusterProps[t[e+A]];return n?Object.assign({},o):o}const o=this.points[t[e+P]].properties,r=this.options.map(o);return n&&r===o?Object.assign({},r):r}}function M(t,e,n){return{type:"Feature",id:t[e+P],properties:L(t,e,n),geometry:{type:"Point",coordinates:[(o=t[e],360*(o-.5)),k(t[e+1])]}};var o}function L(t,e,n){const o=t[e+I],r=o>=1e4?"".concat(Math.round(o/1e3),"k"):o>=1e3?Math.round(o/100)/10+"k":o,i=t[e+A],s=-1===i?{}:Object.assign({},n[i]);return Object.assign(s,{cluster:!0,cluster_id:t[e+P],point_count:o,point_count_abbreviated:r})}function N(t){return t/360+.5}function F(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function k(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function G(t,e,n,o){for(var r,i=o,s=n-e>>1,a=n-e,l=t[e],u=t[e+1],c=t[n],p=t[n+1],h=e+3;h<n;h+=3){var d=B(t[h],t[h+1],l,u,c,p);if(d>i)r=h,i=d;else if(d===i){var f=Math.abs(h-s);f<a&&(r=h,a=f)}}i>o&&(r-e>3&&G(t,e,r,o),t[r+2]=i,n-r>3&&G(t,r,n,o))}function B(t,e,n,o,r,i){var s=r-n,a=i-o;if(0!==s||0!==a){var l=((t-n)*s+(e-o)*a)/(s*s+a*a);l>1?(n=r,o=i):l>0&&(n+=s*l,o+=a*l)}return(s=t-n)*s+(a=e-o)*a}function V(t,e,n,o){var r={id:void 0===t?null:t,type:e,geometry:n,tags:o,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)z(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var o=0;o<e.length;o++)z(t,e[o]);else if("MultiPolygon"===n)for(o=0;o<e.length;o++)for(var r=0;r<e[o].length;r++)z(t,e[o][r])}(r),r}function z(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function j(t,e,n,o){if(e.geometry){var r=e.geometry.coordinates,i=e.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=o||0),"Point"===i)H(r,a);else if("MultiPoint"===i)for(var u=0;u<r.length;u++)H(r[u],a);else if("LineString"===i)U(r,a,s,!1);else if("MultiLineString"===i){if(n.lineMetrics){for(u=0;u<r.length;u++)U(r[u],a=[],s,!1),t.push(V(l,"LineString",a,e.properties));return}W(r,a,s,!1)}else if("Polygon"===i)W(r,a,s,!0);else{if("MultiPolygon"!==i){if("GeometryCollection"===i){for(u=0;u<e.geometry.geometries.length;u++)j(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},n,o);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<r.length;u++){var c=[];W(r[u],c,s,!0),a.push(c)}}t.push(V(l,i,a,e.properties))}}function H(t,e){e.push(q(t[0])),e.push(X(t[1])),e.push(0)}function U(t,e,n,o){for(var r,i,s=0,a=0;a<t.length;a++){var l=q(t[a][0]),u=X(t[a][1]);e.push(l),e.push(u),e.push(0),a>0&&(s+=o?(r*u-l*i)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(u-i,2))),r=l,i=u}var c=e.length-3;e[2]=1,G(e,0,c,n),e[c+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function W(t,e,n,o){for(var r=0;r<t.length;r++){var i=[];U(t[r],i,n,o),e.push(i)}}function q(t){return t/360+.5}function X(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Y(t,e,n,o,r,i,s,a){if(o/=e,i>=(n/=e)&&s<o)return t;if(s<n||i>=o)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],p=c.geometry,h=c.type,d=0===r?c.minX:c.minY,f=0===r?c.maxX:c.maxY;if(d>=n&&f<o)l.push(c);else if(!(f<n||d>=o)){var g=[];if("Point"===h||"MultiPoint"===h)K(p,g,n,o,r);else if("LineString"===h)Z(p,g,n,o,r,!1,a.lineMetrics);else if("MultiLineString"===h)Q(p,g,n,o,r,!1);else if("Polygon"===h)Q(p,g,n,o,r,!0);else if("MultiPolygon"===h)for(var m=0;m<p.length;m++){var y=[];Q(p[m],y,n,o,r,!0),y.length&&g.push(y)}if(g.length){if(a.lineMetrics&&"LineString"===h){for(m=0;m<g.length;m++)l.push(V(c.id,h,g[m],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===g.length?(h="LineString",g=g[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===g.length?"Point":"MultiPoint"),l.push(V(c.id,h,g,c.tags))}}}return l.length?l:null}function K(t,e,n,o,r){for(var i=0;i<t.length;i+=3){var s=t[i+r];s>=n&&s<=o&&(e.push(t[i]),e.push(t[i+1]),e.push(t[i+2]))}}function Z(t,e,n,o,r,i,s){for(var a,l,u=J(t),c=0===r?tt:et,p=t.start,h=0;h<t.length-3;h+=3){var d=t[h],f=t[h+1],g=t[h+2],m=t[h+3],y=t[h+4],v=0===r?d:f,_=0===r?m:y,C=!1;s&&(a=Math.sqrt(Math.pow(d-m,2)+Math.pow(f-y,2))),v<n?_>n&&(l=c(u,d,f,m,y,n),s&&(u.start=p+a*l)):v>o?_<o&&(l=c(u,d,f,m,y,o),s&&(u.start=p+a*l)):$(u,d,f,g),_<n&&v>=n&&(l=c(u,d,f,m,y,n),C=!0),_>o&&v<=o&&(l=c(u,d,f,m,y,o),C=!0),!i&&C&&(s&&(u.end=p+a*l),e.push(u),u=J(t)),s&&(p+=a)}var w=t.length-3;d=t[w],f=t[w+1],g=t[w+2],(v=0===r?d:f)>=n&&v<=o&&$(u,d,f,g),w=u.length-3,i&&w>=3&&(u[w]!==u[0]||u[w+1]!==u[1])&&$(u,u[0],u[1],u[2]),u.length&&e.push(u)}function J(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Q(t,e,n,o,r,i){for(var s=0;s<t.length;s++)Z(t[s],e,n,o,r,i,!1)}function $(t,e,n,o){t.push(e),t.push(n),t.push(o)}function tt(t,e,n,o,r,i){var s=(i-e)/(o-e);return t.push(i),t.push(n+(r-n)*s),t.push(1),s}function et(t,e,n,o,r,i){var s=(i-n)/(r-n);return t.push(e+(o-e)*s),t.push(i),t.push(1),s}function nt(t,e){for(var n=[],o=0;o<t.length;o++){var r,i=t[o],s=i.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)r=ot(i.geometry,e);else if("MultiLineString"===s||"Polygon"===s){r=[];for(var a=0;a<i.geometry.length;a++)r.push(ot(i.geometry[a],e))}else if("MultiPolygon"===s)for(r=[],a=0;a<i.geometry.length;a++){for(var l=[],u=0;u<i.geometry[a].length;u++)l.push(ot(i.geometry[a][u],e));r.push(l)}n.push(V(i.id,s,r,i.tags))}return n}function ot(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var o=0;o<t.length;o+=3)n.push(t[o]+e,t[o+1],t[o+2]);return n}function rt(t,e){if(t.transformed)return t;var n,o,r,i=1<<t.z,s=t.x,a=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(o=0;o<u.length;o+=2)l.geometry.push(it(u[o],u[o+1],e,i,s,a));else for(o=0;o<u.length;o++){var p=[];for(r=0;r<u[o].length;r+=2)p.push(it(u[o][r],u[o][r+1],e,i,s,a));l.geometry.push(p)}}return t.transformed=!0,t}function it(t,e,n,o,r,i){return[Math.round(n*(t*o-r)),Math.round(n*(e*o-i))]}function st(t,e,n,o,r){for(var i=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:o,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<t.length;a++){s.numFeatures++,at(s,t[a],i,r);var l=t[a].minX,u=t[a].minY,c=t[a].maxX,p=t[a].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),p>s.maxY&&(s.maxY=p)}return s}function at(t,e,n,o){var r=e.geometry,i=e.type,s=[];if("Point"===i||"MultiPoint"===i)for(var a=0;a<r.length;a+=3)s.push(r[a]),s.push(r[a+1]),t.numPoints++,t.numSimplified++;else if("LineString"===i)lt(s,r,t,n,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(a=0;a<r.length;a++)lt(s,r[a],t,n,"Polygon"===i,0===a);else if("MultiPolygon"===i)for(var l=0;l<r.length;l++){var u=r[l];for(a=0;a<u.length;a++)lt(s,u[a],t,n,!0,0===a)}if(s.length){var c=e.tags||null;if("LineString"===i&&o.lineMetrics){for(var p in c={},e.tags)c[p]=e.tags[p];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var h={geometry:s,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:c};null!==e.id&&(h.id=e.id),t.features.push(h)}}function lt(t,e,n,o,r,i){var s=o*o;if(o>0&&e.size<(r?s:o))n.numPoints+=e.length/3;else{for(var a=[],l=0;l<e.length;l+=3)(0===o||e[l+2]>s)&&(n.numSimplified++,a.push(e[l]),a.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,o=0,r=t.length,i=r-2;o<r;i=o,o+=2)n+=(t[o]-t[i])*(t[o+1]+t[i+1]);if(n>0===e)for(o=0,r=t.length;o<r/2;o+=2){var s=t[o],a=t[o+1];t[o]=t[r-2-o],t[o+1]=t[r-1-o],t[r-2-o]=s,t[r-1-o]=a}}(a,i),t.push(a)}}function ut(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var o=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var o=0;o<t.features.length;o++)j(n,t.features[o],e,o);else j(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),o=function(t,e){var n=e.buffer/e.extent,o=t,r=Y(t,1,-1-n,n,0,-1,2,e),i=Y(t,1,1-n,2+n,0,-1,2,e);return(r||i)&&(o=Y(t,1,-n,1+n,0,-1,2,e)||[],r&&(o=nt(r,1).concat(o)),i&&(o=o.concat(nt(i,-1)))),o}(o,e),o.length&&this.splitTile(o,0,0,0),n&&(o.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ct(t,e,n){return 32*((1<<t)*n+e)+t}function pt(e,n){const o=e.tileID.canonical;if(!this._geoJSONIndex)return n(null,null);const r=this._geoJSONIndex.getTile(o.z,o.x,o.y);if(!r)return n(null,null);const i=new class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(e){return new class{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.Point(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const o=[];for(const e of n)o.push(new t.Point(e[0],e[1]));e.push(o)}return e}}toGeoJSON(t,e,n){return l.call(this,t,e,n)}}(this._features[e])}}(r.features);let s=S(i);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),n(null,{vectorTile:i,rawData:s.buffer})}ut.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ut.prototype.splitTile=function(t,e,n,o,r,i,s){for(var a=[t,e,n,o],l=this.options,u=l.debug;a.length;){o=a.pop(),n=a.pop(),e=a.pop(),t=a.pop();var c=1<<e,p=ct(e,n,o),h=this.tiles[p];if(!h&&(u>1&&console.time("creation"),h=this.tiles[p]=st(t,e,n,o,l),this.tileCoords.push({z:e,x:n,y:o}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,o,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=t,r){if(e===l.maxZoom||e===r)continue;var f=1<<r-e;if(n!==Math.floor(i/f)||o!==Math.floor(s/f))continue}else if(e===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==t.length){u>1&&console.time("clipping");var g,m,y,v,_,C,w=.5*l.buffer/l.extent,b=.5-w,x=.5+w,E=1+w;g=m=y=v=null,_=Y(t,c,n-w,n+x,0,h.minX,h.maxX,l),C=Y(t,c,n+b,n+E,0,h.minX,h.maxX,l),t=null,_&&(g=Y(_,c,o-w,o+x,1,h.minY,h.maxY,l),m=Y(_,c,o+b,o+E,1,h.minY,h.maxY,l),_=null),C&&(y=Y(C,c,o-w,o+x,1,h.minY,h.maxY,l),v=Y(C,c,o+b,o+E,1,h.minY,h.maxY,l),C=null),u>1&&console.timeEnd("clipping"),a.push(g||[],e+1,2*n,2*o),a.push(m||[],e+1,2*n,2*o+1),a.push(y||[],e+1,2*n+1,2*o),a.push(v||[],e+1,2*n+1,2*o+1)}}},ut.prototype.getTile=function(t,e,n){var o=this.options,r=o.extent,i=o.debug;if(t<0||t>24)return null;var s=1<<t,a=ct(t,e=(e%s+s)%s,n);if(this.tiles[a])return rt(this.tiles[a],r);i>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,p=n;!l&&u>0;)u--,c=Math.floor(c/2),p=Math.floor(p/2),l=this.tiles[ct(u,c,p)];return l&&l.source?(i>1&&console.log("found parent tile z%d-%d-%d",u,c,p),i>1&&console.time("drilling down"),this.splitTile(l.source,u,c,p,t,e,n),i>1&&console.timeEnd("drilling down"),this.tiles[a]?rt(this.tiles[a],r):null):null};class ht extends t.VectorTileWorkerSource{constructor(t,e,n,o,r){super(t,e,n,o,pt),r&&(this.loadGeoJSON=r)}loadData(e,n){const o=e&&e.request,r=o&&o.collectResourceTiming;this.loadGeoJSON(e,((i,s)=>{if(i||!s)return n(i);if("object"!=typeof s)return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));{a(s,!0);try{if(e.filter){const n=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((t=>"".concat(t.key,": ").concat(t.message))).join(", "));const o=s.features.filter((t=>n.value.evaluate({zoom:0},t)));s={type:"FeatureCollection",features:o}}this._geoJSONIndex=e.cluster?new D(function(e){let{superclusterOptions:n,clusterProperties:o}=e;if(!o||!n)return n;const r={},i={},s={accumulated:null,zoom:0},a={properties:null},l=Object.keys(o);for(const u of l){const[e,n]=o[u],s=t.createExpression(n),a=t.createExpression("string"==typeof e?[e,["accumulated"],["get",u]]:e);r[u]=s.value,i[u]=a.value}return n.map=t=>{a.properties=t;const e={};for(const n of l)e[n]=r[n].evaluate(s,a);return e},n.reduce=(t,e)=>{a.properties=e;for(const n of l)s.accumulated=t[n],t[n]=i[n].evaluate(s,a)},n}(e)).load(s.features):function(t,e){return new ut(t,e)}(s,e.geojsonVtOptions)}catch(i){return n(i)}this.loaded={};const l={};if(r){const n=t.getPerformanceMeasurement(o);n&&(l.resourceTiming={},l.resourceTiming[e.source]=JSON.parse(JSON.stringify(n)))}n(null,l)}}))}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object.")))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class dt{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=t.getProjection({name:"mercator"}),this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:ht},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error('Worker source with name "'.concat(t,'" already registered.'));this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}clearCaches(t,e,n){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t],n()}checkIfReady(t,e,n){n()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,n){this.isSpriteLoaded[e]=n;for(const o in this.workerSources[e]){const r=this.workerSources[e][o];for(const e in r)r[e]instanceof t.VectorTileWorkerSource&&(r[e].isSpriteLoaded=n,r[e].fire(new t.Event("isSpriteLoaded")))}}setImages(t,e,n){this.availableImages[t]=e;for(const o in this.workerSources[t]){const n=this.workerSources[t][o];for(const t in n)n[t].availableImages=e}n()}enableTerrain(t,e,n){this.terrain=e,n()}setProjection(e,n){this.projections[e]=t.getProjection(n)}setLayers(t,e,n){this.getLayerIndex(t).replace(e),n()}updateLayers(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}loadTile(e,n,o){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;r.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,n.type,n.source).loadTile(r,o)}loadDEMTile(e,n,o){const r=this.enableTerrain?t.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(e,n.source).loadTile(r,o)}reloadTile(e,n,o){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;r.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,n.type,n.source).reloadTile(r,o)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}removeSource(t,e,n){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const o=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==o.removeSource?o.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,o){try{t.plugin.setState(n);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const n=t.plugin.isParsed();o(n?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(e)),n)}}catch(t){o(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new o),e}getWorkerSource(t,e,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){const o={send:(e,n,o,r,i,s)=>{this.actor.send(e,n,o,t,i,s)},scheduler:this.actor.scheduler};this.workerSources[t][e][n]=new this.workerSourceTypes[e](o,this.getLayerIndex(t),this.getAvailableImages(t),this.isSpriteLoaded[t])}return this.workerSources[t][e][n]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new r),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,n){t.enforceCacheSizeLimit(n)}getWorkerPerformanceMetrics(t,e,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new dt(self)),dt})),o(["./shared"],(function(t){function e(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],n[o]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const o in t)if(!e(t[o],n[o]))return!1;return!0}return t===n}var n=o;function o(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),o=URL.createObjectURL(n);try{e=new Worker(o),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(o),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===r[e=t&&t.failIfMajorPerformanceCaveat]&&(r[e]=function(t){var e,n=function(t){var e=document.createElement("canvas"),n=Object.create(o.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,e.getContext("webgl",n)||e.getContext("experimental-webgl",n)}(t);if(!n)return!1;try{e=n.createShader(n.VERTEX_SHADER)}catch(t){return!1}return!(!e||n.isContextLost())&&(n.shaderSource(e,"void main() {}"),n.compileShader(e),!0===n.getShaderParameter(e,n.COMPILE_STATUS))}(e)),r[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var r={};function i(e,n,o){const r=t.window.document.createElement(e);return void 0!==n&&(r.className=n),o&&o.appendChild(r),r}function s(e,n,o){const r=t.window.document.createElementNS("http://www.w3.org/2000/svg",e);for(const t of Object.keys(n))r.setAttributeNS(null,t,n[t]);return o&&o.appendChild(r),r}o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const a=t.window.document&&t.window.document.documentElement.style,l=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let u;function c(){a&&l&&(u=a[l],a[l]="none")}function p(){a&&l&&(a[l]=u)}function h(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",h,!0)}function d(){t.window.addEventListener("click",h,!0),t.window.setTimeout((()=>{t.window.removeEventListener("click",h,!0)}),0)}function f(t,e){const n=t.getBoundingClientRect();return y(t,n,e)}function g(t,e){const n=t.getBoundingClientRect(),o=[];for(let r=0;r<e.length;r++)o.push(y(t,n,e[r]));return o}function m(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button}function y(e,n,o){const r=e.offsetWidth===n.width?1:e.offsetWidth/n.width;return new t.Point((o.clientX-n.left)*r,(o.clientY-n.top)*r)}function v(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],s=n*i-r*o;return s?(t[0]=i*(s=1/s),t[1]=-o*s,t[2]=-r*s,t[3]=n*s,t):null}function _(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class C extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e)}_validate(e,n){let o=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),o=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),o=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'.concat(e,'" has invalid "content" value')))),o=!1),o}_validateStretch(t,e){if(!t)return!0;let n=0;for(const o of t){if(o[0]<n||o[1]<o[0]||e<o[1])return!1;n=o[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let n=!0;if(!this.isLoaded())for(const o of t)this.images[o]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,n){const o={};for(const r of e){this.images[r]||this.fire(new t.Event("styleimagemissing",{id:r}));const e=this.images[r];e?o[r]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce('Image "'.concat(r,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}n(null,o)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const n=this.patterns[e],o=this.getImage(e);if(!o)return null;if(n&&n.position.version===o.version)return n.position;if(n)n.position.version=o.version;else{const n={w:o.data.width+2,h:o.data.height+2,x:0,y:0},r=new t.ImagePosition(n,o);this.patterns[e]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture&&this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:o}=t.potpack(e),r=this.atlasImage;r.resize({width:n||1,height:o||1});for(const i in this.patterns){const{bin:e}=this.patterns[i],n=e.x+1,o=e.y+1,s=this.images[i].data,a=s.width,l=s.height;t.RGBAImage.copy(s,r,{x:0,y:0},{x:n,y:o},{width:a,height:l}),t.RGBAImage.copy(s,r,{x:0,y:l-1},{x:n,y:o-1},{width:a,height:1}),t.RGBAImage.copy(s,r,{x:0,y:0},{x:n,y:o+l},{width:a,height:1}),t.RGBAImage.copy(s,r,{x:a-1,y:0},{x:n-1,y:o},{width:1,height:l}),t.RGBAImage.copy(s,r,{x:0,y:0},{x:n+a,y:o},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];_(t)&&this.updateImage(e,t)}}}const w=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,n){return function(e){let[n,o,r]=e;const i=t.degToRad(o+90),s=t.degToRad(r);return{x:n*Math.cos(i)*Math.sin(s),y:n*Math.sin(i)*Math.sin(s),z:n*Math.cos(s),azimuthal:o,polar:r}}(e.expression.evaluate(n))}interpolate(e,n,o){return{x:t.number(e.x,n.x,o),y:t.number(e.y,n.y,o),z:t.number(e.z,n.z,o),azimuthal:t.number(e.azimuthal,n.azimuthal,o),polar:t.number(e.polar,n.polar,o)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)});class b extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(w),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.validateLight,e,n))for(const o in e){const n=e[o];t.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),n):this._transitionable.setValue(o,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,o){return(!o||!1!==o.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const x=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)});let E=class extends t.Evented{constructor(e,n){super(),this._transitionable=new t.Transitionable(x),this.set(e),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(e){for(const n in e){const o=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),o):this._transitionable.setValue(n,o)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}};function S(e,n,o,r){const i=t.smoothstep(45,65,o),[s,a]=T(e,r),l=t.length(n);let u=1-Math.min(1,Math.exp((l-s)/(a-s)*-6));return u*=u*u,u=Math.min(1,1.00747*u),u*i*e.alpha}function T(t,e){const n=.5/Math.tan(.5*e);return[t.range[0]+n,t.range[1]+n]}const R=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"high-color":new t.DataConstantProperty(t.spec.fog["high-color"]),"space-color":new t.DataConstantProperty(t.spec.fog["space-color"]),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"]),"star-intensity":new t.DataConstantProperty(t.spec.fog["star-intensity"])});class O extends t.Evented{constructor(e,n){super(),this._transitionable=new t.Transitionable(R),this.set(e),this._transitioning=this._transitionable.untransitioned(),this._transform=n}get state(){const e=this._transform,n="globe"===e.projection.name,o=t.globeToMercatorTransition(e.zoom),r=this.properties.get("range"),i=[.5,3];return{range:n?[t.number(i[0],r[0],o),t.number(i[1],r[1],o)]:r,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.validateFog,e,n)){for(const n of Object.keys(t.spec.fog))e&&void 0===e[n]&&(e[n]=t.spec.fog[n].default);for(const n in e){const o=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),o):this._transitionable.setValue(n,o)}}}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:t.smoothstep(45,65,e))*n.a}getOpacityAtLatLng(e,n){return this._transform.projection.supportsFog?function(e,n,o){const r=t.MercatorCoordinate.fromLngLat(n),i=o.elevation?o.elevation.getAtPointOrZero(r):0,s=[r.x,r.y,i];return t.transformMat4(s,s,o.mercatorFogMatrix),S(e,s,o.pitch,o._fov)}(this.state,e,n):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?T(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,o){return(!o||!1!==o.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class P{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const o=this.workerPool.acquire(this.id);for(let t=0;t<o.length;t++){const e=new P.Actor(o[t],n,this.id);e.name="Worker ".concat(t),this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(e,n,o){t.asyncAll(this.actors,((t,o)=>{t.send(e,n,o)}),o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}function I(e,n,o){return n*(t.EXTENT/(e.tileSize*Math.pow(2,o-e.tileID.overscaledZ)))}P.Actor=t.Actor;class A{constructor(t,e,n,o){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,o)}static createFromScreenPoints(e,n){let o,r;if(e instanceof t.Point||"number"==typeof e[0]){const i=t.Point.convert(e);o=[i],r=n.isPointAboveHorizon(i)}else{const i=t.Point.convert(e[0]),s=t.Point.convert(e[1]);o=[i,s],r=t.polygonizeBounds(i,s).every((t=>n.isPointAboveHorizon(t)))}return new A(o,n.getCameraPoint(),r,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],o=1===this.screenBounds.length?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],r=t.polygonizeBounds(n,o,0,!1);return this.cameraPoint.y>o.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<o.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=o.x?r[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(r[3]=this.cameraPoint)),t.bufferConvexPolygon(r,e)}bufferedCameraGeometryGlobe(e){const n=this.screenBounds[0],o=1===this.screenBounds.length?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],r=t.polygonizeBounds(n,o,e),i=this.cameraPoint.clone();switch(3*((i.y>n.y)+(i.y>o.y))+((i.x>n.x)+(i.x>o.x))){case 0:r[0]=i,r[4]=i.clone();break;case 1:r.splice(1,0,i);break;case 2:r[1]=i;break;case 3:r.splice(4,0,i);break;case 5:r.splice(2,0,i);break;case 6:r[3]=i;break;case 7:r.splice(3,0,i);break;case 8:r[2]=i}return r}containsTile(e,n,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=e.queryPadding/n._pixelsPerMercatorPixel+1,s=o?this._bufferedCameraMercator(i,n):this._bufferedScreenMercator(i,n);let a=e.tileID.wrap+(s.unwrapped?r:0);const l=s.polygon.map((n=>t.getTilePoint(e.tileTransform,n,a)));if(!t.polygonIntersectsBox(l,0,0,t.EXTENT,t.EXTENT))return;a=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?r:0);const u=this.screenGeometryMercator.polygon.map((n=>t.getTileVec3(e.tileTransform,n,a))),c=u.map((e=>new t.Point(e[0],e[1]))),p=n.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),h=t.getTileVec3(e.tileTransform,p,a),d=u.map((e=>{const n=t.sub(e,e,h);return t.normalize(n,n),new t.Ray(h,n)})),f=I(e,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:c,tilespaceRays:d,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(g=t.getBounds(l),g.min.x=t.clamp(g.min.x,0,t.EXTENT),g.min.y=t.clamp(g.min.y,0,t.EXTENT),g.max.x=t.clamp(g.max.x,0,t.EXTENT),g.max.y=t.clamp(g.max.y,0,t.EXTENT),g),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:f};var g}_bufferedScreenMercator(t,e){const n=L(t);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{let o;return o="globe"===e.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),e):{polygon:this.bufferedScreenGeometry(t).map((t=>e.pointCoordinate3D(t))),unwrapped:!0},this._screenRaycastCache[n]=o,o}}_bufferedCameraMercator(t,e){const n=L(t);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{let o;return o="globe"===e.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),e):{polygon:this.bufferedCameraGeometry(t).map((t=>e.pointCoordinate3D(t))),unwrapped:!0},this._cameraRaycastCache[n]=o,o}}_projectAndResample(e,n){const o=function(e,n){const o=t.multiply([],n.pixelMatrix,n.globeMatrix),r=[0,-t.GLOBE_RADIUS,0,1],i=[0,t.GLOBE_RADIUS,0,1],s=[0,0,0,1];t.transformMat4$1(r,r,o),t.transformMat4$1(i,i,o),t.transformMat4$1(s,s,o);const a=new t.Point(r[0]/r[3],r[1]/r[3]),l=new t.Point(i[0]/i[3],i[1]/i[3]),u=t.polygonContainsPoint(e,a)&&r[3]<s[3],c=t.polygonContainsPoint(e,l)&&i[3]<s[3];if(!u&&!c)return null;const p=function(t,e,n){for(let o=1;o<t.length;o++){const r=M(e.pointCoordinate3D(t[o-1]).x),i=M(e.pointCoordinate3D(t[o]).x);if(n<0){if(r<i)return{idx:o,t:-r/(i-1-r)}}else if(i<r)return{idx:o,t:(1-r)/(i+1-r)}}return null}(e,n,u?-1:1);if(!p)return null;const{idx:h,t:d}=p;let f=h>1?D(e.slice(0,h),n):[],g=h<e.length?D(e.slice(h),n):[];f=f.map((e=>new t.Point(M(e.x),e.y))),g=g.map((e=>new t.Point(M(e.x),e.y)));const m=[...f];0===m.length&&m.push(g[g.length-1]);const y=t.number(m[m.length-1].y,(0===g.length?f[0]:g[0]).y,d);let v;return v=u?[new t.Point(0,y),new t.Point(0,0),new t.Point(1,0),new t.Point(1,y)]:[new t.Point(1,y),new t.Point(1,1),new t.Point(0,1),new t.Point(0,y)],m.push(...v),0===g.length?m.push(f[0]):m.push(...g),{polygon:m.map((e=>new t.MercatorCoordinate(e.x,e.y))),unwrapped:!1}}(e,n);if(o)return o;const r=function(e,n){let o=!1,r=-1/0,i=0;for(let t=0;t<e.length-1;t++)e[t].x>r&&(r=e[t].x,i=t);for(let t=0;t<e.length-1;t++){const n=(i+t)%(e.length-1),r=e[n],s=e[n+1];Math.abs(r.x-s.x)>.5&&(r.x<s.x?(r.x+=1,0===n&&(e[e.length-1].x+=1)):(s.x+=1,n+1===e.length-1&&(e[0].x+=1)),o=!0)}const s=t.mercatorXfromLng(n.center.lng);return o&&s<Math.abs(s-1)&&e.forEach((t=>{t.x-=1})),{polygon:e,unwrapped:o}}(D(e,n).map((e=>new t.Point(M(e.x),e.y))),n);return{polygon:r.polygon.map((e=>new t.MercatorCoordinate(e.x,e.y))),unwrapped:r.unwrapped}}}function D(e,n){return t.resample(e,(t=>{const e=n.pointCoordinate3D(t);t.x=e.x,t.y=e.y}),1/256)}function M(t){return t<0?1+t%1:t%1}function L(t){return 100*t|0}function N(e,n,o,r,i){const s=function(o,r){if(o)return i(o);if(r){e.url&&r.tiles&&e.tiles&&delete e.tiles;const o=t.pick(t.extend(r,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(o.vectorLayers=r.vector_layers,o.vectorLayerIds=o.vectorLayers.map((t=>t.id))),o.tiles=n.canonicalizeTileset(o,e.url),i(null,o)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url,null,o,r),t.ResourceType.Source),s):t.exported.frame((()=>s(null,e)))}class F{constructor(e,n,o){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=o||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),o=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),i=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),s=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=o&&e.x<i&&e.y>=r&&e.y<s}}class k{constructor(t,e,n){this.context=t;const o=t.gl;this.buffer=o.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||e.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const G={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class B{constructor(t,e,n,o){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=o,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||e.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const o=e.attributes[this.attributes[n].name];void 0!==o&&t.enableVertexAttribArray(o)}}setVertexAttribPointers(t,e,n){for(let o=0;o<this.attributes.length;o++){const r=this.attributes[o],i=e.attributes[r.name];void 0!==i&&t.vertexAttribPointer(i,r.components,t[G[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class V{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class z extends V{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class j extends V{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class H extends V{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class U extends V{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class W extends V{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class q extends V{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class X extends V{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Y extends V{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class K extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class Z extends V{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class J extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class Q extends V{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class $ extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class tt extends V{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class et extends V{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class nt extends V{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class ot extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class rt extends V{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class it extends V{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let st,at=class extends V{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}};class lt extends V{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ut extends V{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ct extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class pt extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ht extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class dt extends V{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ft extends V{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gt extends V{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class mt extends V{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class yt extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class vt extends V{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class _t extends V{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class Ct extends _t{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class wt extends _t{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class bt extends wt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xt{constructor(t,e,n,o){this.context=t,this.width=e,this.height=n;const r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new Ct(t,r),o&&(this.depthAttachment=new wt(t,r))}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Et{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.gl=t,this.isWebGL2=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),e){const e=t;this.extVertexArrayObject={createVertexArrayOES:e.createVertexArray.bind(t),deleteVertexArrayOES:e.deleteVertexArray.bind(t),bindVertexArrayOES:e.bindVertexArray.bind(t)}}this.clearColor=new z(this),this.clearDepth=new j(this),this.clearStencil=new H(this),this.colorMask=new U(this),this.depthMask=new W(this),this.stencilMask=new q(this),this.stencilFunc=new X(this),this.stencilOp=new Y(this),this.stencilTest=new K(this),this.depthRange=new Z(this),this.depthTest=new J(this),this.depthFunc=new Q(this),this.blend=new $(this),this.blendFunc=new tt(this),this.blendColor=new et(this),this.blendEquation=new nt(this),this.cullFace=new ot(this),this.cullFaceSide=new rt(this),this.frontFace=new it(this),this.program=new at(this),this.activeTexture=new lt(this),this.viewport=new ut(this),this.bindFramebuffer=new ct(this),this.bindRenderbuffer=new pt(this),this.bindTexture=new ht(this),this.bindVertexBuffer=new dt(this),this.bindElementBuffer=new ft(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gt(this),this.pixelStoreUnpack=new mt(this),this.pixelStoreUnpackPremultiplyAlpha=new yt(this),this.pixelStoreUnpackFlipY=new vt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),e||(this.extTextureHalfFloat=t.getExtension("OES_texture_half_float")),(e||this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=e||t.getExtension("OES_standard_derivatives"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new k(this,t,e)}createVertexBuffer(t,e,n){return new B(this,t,e,n)}createRenderbuffer(t,e,n){const o=this.gl,r=o.createRenderbuffer();return this.bindRenderbuffer.set(r),o.renderbufferStorage(o.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,n){return new xt(this,t,e,n)}clear(t){let{color:e,depth:n,stencil:o}=t;const r=this.gl;let i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==o&&(i|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(o),this.stencilMask.set(255)),r.clear(i)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(n){e(n.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class St extends t.Evented{constructor(e,n,o,r){if(super(),this.id=e,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(n,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(e){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,o=this.map._worldview;this._tileJSONRequest=N(this._options,this.map._requestManager,n,o,((r,i)=>{this._tileJSONRequest=null,this._loaded=!0,r?(n&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ".concat(n)),o&&2!==o.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: ".concat(o)),this.fire(new t.ErrorEvent(r))):i&&(t.extend(this,i),i.bounds&&(this.tileBounds=new F(i.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),e&&e(r)}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}loadTile(e,n){const o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(o,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",r,i.bind(this));else if(e.actor=this._tileWorkers[o]=this._tileWorkers[o]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",r,i.bind(this),void 0,!0);else{const n=t.loadVectorTile.call({deduped:this._deduped},r,((t,n)=>{t||!n?i.call(this,t):(r.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},e.actor&&e.actor.send("loadTile",r,i.bind(this),void 0,!0))}),!0);e.request={cancel:n}}function i(o,r){return delete e.request,e.aborted?n(null):o&&404!==o.status?n(o):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Tt extends t.Evented{constructor(e,n,o,r){super(),this.id=e,this.dispatcher=o,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=N(this._options,this.map._requestManager,null,null,((n,o)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new t.ErrorEvent(n)):o&&(t.extend(this,o),o.bounds&&(this.tileBounds=new F(o.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(o.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),e&&e(n)}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const o=t.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),o,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),((o,r,i,s)=>(delete e.request,e.aborted?(e.state="unloaded",n(null)):o?(e.state="errored",n(o)):r?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:i,expires:s}),e.setTexture(r,this.map.painter),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),void n(null)):n(null))))}static loadTileData(t,e,n){t.setTexture(e,n)}static unloadTileData(t,e){t.texture&&e.saveTileTexture(t.texture)}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Rt(e,n,o,r,i,s,a,l){const u=[e,o,i,n,r,s,1,1,1],c=[a,l,1],p=t.adjoint([],u),[h,d,f]=t.transformMat3(c,c,t.transpose(p,p));return t.multiply$1(u,[h,0,0,0,d,0,0,0,f],u)}class Ot extends t.Evented{constructor(t,e,n,o){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=e,this._dirty=!1}load(e,n){this._loaded=n||!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),((n,o)=>{if(this._imageRequest=null,this._loaded=!0,n)this.fire(new t.ErrorEvent(n));else if(o){const{HTMLImageElement:n}=t.window;this.image=o instanceof n?t.exported.getImageData(o):o,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(e){this.coordinates=e,this._boundsArray=void 0;const n=e.map(t.MercatorCoordinate.fromLngLat);return this.tileID=function(e){let n=1/0,o=1/0,r=-1/0,i=-1/0;for(const t of e)n=Math.min(n,t.x),o=Math.min(o,t.y),r=Math.max(r,t.x),i=Math.max(i,t.y);const s=Math.max(r-n,i-o),a=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,a);return new t.CanonicalTileID(a,Math.floor((n+r)/2*l),Math.floor((o+i)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(e){for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}if(this._boundsArray)return;const n=t.tileTransform(this.tileID,this.map.transform.projection),[o,r,i,s]=this.coordinates.map((e=>{const o=n.projection.project(e[0],e[1]);return t.getTilePoint(n,o)._round()}));this.perspectiveTransform=function(e,n,o,r,i,s,a,l,u,c){const p=Rt(0,0,e,0,0,n,e,n),h=Rt(o,r,i,s,a,l,u,c);return t.multiply$1(h,t.adjoint(p,p),h),[h[6]/h[8]*e/t.EXTENT,h[7]/h[8]*n/t.EXTENT]}(this.width,this.height,o.x,o.y,r.x,r.y,s.x,s.y,i.x,i.y);const a=this._boundsArray=new t.StructArrayLayout4i8;a.emplaceBack(o.x,o.y,0,0),a.emplaceBack(r.x,r.y,t.EXTENT,0),a.emplaceBack(s.x,s.y,0,t.EXTENT),a.emplaceBack(i.x,i.y,t.EXTENT,t.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=e.createVertexBuffer(a,t.boundsAttributes.members),this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(e)}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Pt={vector:St,raster:Tt,"raster-dem":class extends Tt{constructor(e,n,o,r){super(e,n,o,r),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(e,n){const o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(t,o){t&&(e.state="errored",n(t)),o&&(e.dem=o,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(o,t.ResourceType.Tile),function(o,i,s,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(o)e.state="errored",n(o);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:s,expires:a});const n=t.window.ImageBitmap&&i instanceof t.window.ImageBitmap&&(null==st&&(st=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof t.window.createImageBitmap),st),o=1-(i.width-t.prevPowerOfTwo(i.width))/2;o<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=n?i:t.exported.getImageData(i,o),u={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:o};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",u,r.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(e){const n=e.canonical,o=Math.pow(2,n.z),r=(n.x-1+o)%o,i=0===n.x?e.wrap-1:e.wrap,s=(n.x+1+o)%o,a=n.x+1===o?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,i,n.z,r,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,i,n.z,r,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<o&&(l[new t.OverscaledTileID(e.overscaledZ,i,n.z,r,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends t.Evented{constructor(e,n,o,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(r),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const i=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*i,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*i,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*i,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,n,o){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},o),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),n=this._data;"string"==typeof n?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(n),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(n),this._pendingLoad=this.actor.send("".concat(this.type,".loadData"),e,((e,n)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else{const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[this.id]&&(e.resourceTiming=n.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(e,n){const o=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(o,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((t,r)=>(delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(r,this.map.painter,"reloadTile"===o),n(null)))),void 0,"loadTile"===o)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ot{constructor(t,e,n,o){super(t,e,n,o),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.ResourceType.Source).url);t.getVideo(this.urls,((e,n)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ot,canvas:class extends Ot{constructor(e,n,o,r){super(e,n,o,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources.".concat(e),null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}},custom:class extends t.Evented{constructor(e,n,o,r){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=o,this._implementation=n,this.setEventedParent(r),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new t.ErrorEvent(new Error("Missing implementation for ".concat(this.id," custom source")))),this._implementation.loadTile||this.fire(new t.ErrorEvent(new Error("Missing loadTile implementation for ".concat(this.id," custom source")))),this._implementation.bounds&&(this.tileBounds=new F(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),t.extend(this,t.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return t.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this._map=e,this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(t){this._implementation.onRemove&&this._implementation.onRemove(t)}hasTile(t){if(this._implementation.hasTile){const{x:e,y:n,z:o}=t.canonical;return this._implementation.hasTile({x:e,y:n,z:o})}return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const{x:o,y:r,z:i}=e.tileID.canonical,s=new t.window.AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:o,y:r,z:i},{signal:s.signal})).then(function(o){return delete e.request,e.aborted?(e.state="unloaded",n(null)):void 0===o?(e.state="errored",n(null)):null===o?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",n(null)):function(e){return e instanceof t.window.ImageData||e instanceof t.window.HTMLCanvasElement||e instanceof t.window.ImageBitmap||e instanceof t.window.HTMLImageElement}(o)?(this.loadTileData(e,o),e.state="loaded",void n(null)):(e.state="errored",n(new Error("Can't infer data type for ".concat(this.id,", only raster data supported at the moment"))))}.bind(this)).catch((t=>{20!==t.code&&(e.state="errored",n(t))})),e.request.cancel=()=>s.abort()}loadTileData(t,e){Tt.loadTileData(t,e,this._map.painter)}unloadTileData(t){Tt.unloadTileData(t,this._map.painter)}unloadTile(t,e){if(this.unloadTileData(t),this._implementation.unloadTile){const{x:e,y:n,z:o}=t.tileID.canonical;this._implementation.unloadTile({x:e,y:n,z:o})}e()}abortTile(t,e){t.request&&t.request.cancel&&(t.request.cancel(),delete t.request),e()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((t=>({x:t.canonical.x,y:t.canonical.y,z:t.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}}},It=function(e,n,o,r){const i=new Pt[n.type](e,n,o,r);if(i.id!==e)throw new Error("Expected Source id to be ".concat(e," instead of ").concat(i.id));return t.bindAll(["load","abort","unload","serialize","prepare"],i),i};function At(e,n){const o=t.identity([]);return t.scale(o,o,[.5*e.width,.5*-e.height,1]),t.translate(o,o,[1,-1,0]),t.multiply(o,o,e.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(o)}function Dt(t,e,n,o,r,i,s){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=t.tilesIn(o,s,a);l.sort(Lt);const u=[];for(const p of l)u.push({wrappedTileID:p.tile.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,n,t._state,p,r,i,At(t.transform,p.tile.tileID),a)});const c=function(t){const e={},n={};for(const o of t){const t=o.queryResults,r=o.wrappedTileID,i=n[r]=n[r]||{};for(const n in t){const o=t[n],r=i[n]=i[n]||{},s=e[n]=e[n]||[];for(const t of o)r[t.featureIndex]||(r[t.featureIndex]=!0,s.push(t))}}return e}(u);for(const p in c)c[p].forEach((e=>{const n=e.feature,o=n.layer;o&&"background"!==o.type&&"sky"!==o.type&&(n.source=o.source,o["source-layer"]&&(n.sourceLayer=o["source-layer"]),n.state=void 0!==n.id?t.getFeatureState(o["source-layer"],n.id):{})}));return c}function Mt(t,e){const n=t.getRenderableIds().map((e=>t.getTileByID(e))),o=[],r={};for(let i=0;i<n.length;i++){const t=n[i],s=t.tileID.canonical.key;r[s]||(r[s]=!0,t.querySourceFeatures(o,e))}return o}function Lt(t,e){const n=t.tileID,o=e.tileID;return n.overscaledZ-o.overscaledZ||n.canonical.y-o.canonical.y||n.wrap-o.wrap||n.canonical.x-o.canonical.x}function Nt(){return null!=di.workerClass?new di.workerClass:new t.window.Worker(di.workerUrl)}const Ft="mapboxgl_preloaded_worker_pool";class kt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<kt.workerCount;)this.workers.push(new Nt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Ft]}numActive(){return Object.keys(this.active).length}}let Gt;function Bt(){return Gt||(Gt=new kt),Gt}function Vt(e,n){const o={};for(const t in e)"ref"!==t&&(o[t]=e[t]);return t.refProperties.forEach((t=>{t in n&&(o[t]=n[t])})),o}function zt(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Vt(t[n],e[t[n].ref]));return t}kt.workerCount=2;const jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ht(t,e,n){n.push({command:jt.addSource,args:[t,e[t]]})}function Ut(t,e,n){e.push({command:jt.removeSource,args:[t]}),n[t]=!0}function Wt(t,e,n,o){Ut(t,n,o),Ht(t,e,n)}function qt(t,n,o){let r;for(r in t[o])if(t[o].hasOwnProperty(r)&&"data"!==r&&!e(t[o][r],n[o][r]))return!1;for(r in n[o])if(n[o].hasOwnProperty(r)&&"data"!==r&&!e(t[o][r],n[o][r]))return!1;return!0}function Xt(t,n,o,r,i,s){let a;for(a in n=n||{},t=t||{})t.hasOwnProperty(a)&&(e(t[a],n[a])||o.push({command:s,args:[r,a,n[a],i]}));for(a in n)n.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(e(t[a],n[a])||o.push({command:s,args:[r,a,n[a],i]}))}function Yt(t){return t.id}function Kt(t,e){return t[e.id]=e,t}class Zt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let n=1,o=this._distances[n];const r=e*this.paddedLength+this.padding;for(;o<r&&n<this._distances.length;)o=this._distances[++n];const i=n-1,s=this._distances[i],a=o-s,l=a>0?(r-s)/a:0;return this.points[i].mult(1-l).add(this.points[n].mult(l))}}class Jt{constructor(t,e,n){const o=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let i=0;i<this.xCellCount*this.yCellCount;i++)o.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,o,r){this._forEachCell(e,n,o,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(r)}insertCircle(t,e,n,o){this._forEachCell(e-o,n-o,e+o,n+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(o)}_insertBoxCell(t,e,n,o,r,i){this.boxCells[r].push(i)}_insertCircleCell(t,e,n,o,r,i){this.circleCells[r].push(i)}_query(t,e,n,o,r,i){if(n<0||t>this.width||o<0||e>this.height)return!r&&[];const s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=o){if(r)return!0;for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],o=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-o,y1:n-o,x2:e+o,y2:n+o})}return i?s.filter(i):s}return this._forEachCell(t,e,n,o,this._queryCell,s,{hitTest:r,seenUids:{box:{},circle:{}}},i),r?s.length>0:s}_queryCircle(t,e,n,o,r){const i=t-n,s=t+n,a=e-n,l=e+n;if(s<0||i>this.width||l<0||a>this.height)return!o&&[];const u=[];return this._forEachCell(i,a,s,l,this._queryCellCircle,u,{hitTest:o,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),o?u.length>0:u}query(t,e,n,o,r){return this._query(t,e,n,o,!1,r)}hitTest(t,e,n,o,r){return this._query(t,e,n,o,!0,r)}hitTestCircle(t,e,n,o){return this._queryCircle(t,e,n,!0,o)}_queryCell(t,e,n,o,r,i,s,a){const l=s.seenUids,u=this.boxCells[r];if(null!==u){const r=this.bboxes;for(const c of u)if(!l.box[c]){l.box[c]=!0;const u=4*c;if(t<=r[u+2]&&e<=r[u+3]&&n>=r[u+0]&&o>=r[u+1]&&(!a||a(this.boxKeys[c]))){if(s.hitTest)return i.push(!0),!0;i.push({key:this.boxKeys[c],x1:r[u],y1:r[u+1],x2:r[u+2],y2:r[u+3]})}}}const c=this.circleCells[r];if(null!==c){const r=this.circles;for(const u of c)if(!l.circle[u]){l.circle[u]=!0;const c=3*u;if(this._circleAndRectCollide(r[c],r[c+1],r[c+2],t,e,n,o)&&(!a||a(this.circleKeys[u]))){if(s.hitTest)return i.push(!0),!0;{const t=r[c],e=r[c+1],n=r[c+2];i.push({key:this.circleKeys[u],x1:t-n,y1:e-n,x2:t+n,y2:e+n})}}}}}_queryCellCircle(t,e,n,o,r,i,s,a){const l=s.circle,u=s.seenUids,c=this.boxCells[r];if(null!==c){const t=this.bboxes;for(const e of c)if(!u.box[e]){u.box[e]=!0;const n=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!a||a(this.boxKeys[e])))return i.push(!0),!0}}const p=this.circleCells[r];if(null!==p){const t=this.circles;for(const e of p)if(!u.circle[e]){u.circle[e]=!0;const n=3*e;if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[e])))return i.push(!0),!0}}}_forEachCell(t,e,n,o,r,i,s,a){const l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),p=this._convertToYCellCoord(o);for(let h=l;h<=c;h++)for(let l=u;l<=p;l++)if(r.call(this,t,e,n,o,this.xCellCount*l+h,i,s,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,o,r,i){const s=o-t,a=r-e,l=n+i;return l*l>s*s+a*a}_circleAndRectCollide(t,e,n,o,r,i,s){const a=(i-o)/2,l=Math.abs(t-(o+a));if(l>a+n)return!1;const u=(s-r)/2,c=Math.abs(e-(r+u));if(c>u+n)return!1;if(l<=a||c<=u)return!0;const p=l-a,h=c-u;return p*p+h*h<=n*n}}const Qt={unknown:0,flipRequired:1,flipNotRequired:2},$t=Math.tan(85*Math.PI/180);function te(e,n,o,r,i,s,a){const l=t.create();if(o)if("globe"===s.name){const e=t.calculateGlobeLabelMatrix(i,n);t.multiply(l,l,e)}else{const e=v([],a);l[0]=e[0],l[1]=e[1],l[4]=e[2],l[5]=e[3],r||t.rotateZ(l,l,i.angle)}else t.multiply(l,i.labelPlaneMatrix,e);return l}function ee(t,e,n,o,r,i,s){const a=te(t,e,n,o,r,i,s);return"globe"===i.name&&n||(a[2]=a[6]=a[10]=a[14]=0),a}function ne(e,n,o,r,i,s,a){if(o){if("globe"===s.name){const l=te(e,n,o,r,i,s,a);return t.invert(l,l),t.multiply(l,e,l),l}{const n=t.clone(e),o=t.identity([]);return o[0]=a[0],o[1]=a[1],o[4]=a[2],o[5]=a[3],t.multiply(n,n,o),r||t.rotateZ(n,n,-i.angle),n}}return i.glCoordMatrix}function oe(e,n,o,r){const i=[e,n,o,1];o?t.transformMat4$1(i,i,r):fe(i,i,r);const s=i[3];return i[0]/=s,i[1]/=s,i[2]/=s,i}function re(t,e){return Math.min(.5+t/e*.5,1.5)}function ie(t,e){const n=t[0]/t[3],o=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&o>=-e[1]&&o<=e[1]}function se(e,n,o,r,i,s,a,l,u,c){const p=o.transform,h=r?e.textSizeData:e.iconSizeData,d=t.evaluateSizeForZoom(h,o.transform.zoom),f="globe"===p.projection.name,g=[256/o.width*2+1,256/o.height*2+1],m=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;m.clear();let y=null;f&&(y=r?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const v=e.lineVertexArray,_=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,C=o.transform.width/o.transform.height;let w,b=!1;for(let x=0;x<_.length;x++){const r=_.get(x),{numGlyphs:f,writingMode:E}=r;if(E!==t.WritingMode.vertical||b||w===t.WritingMode.horizontal||(b=!0),w=E,(r.hidden||E===t.WritingMode.vertical)&&!b){de(f,m);continue}b=!1;const S=new t.Point(r.tileAnchorX,r.tileAnchorY);let{x:T,y:R,z:O}=p.projection.projectTilePoint(S.x,S.y,c.canonical);if(u){const[t,e,n]=u(S);T+=t,R+=e,O+=n}const P=[T,R,O,1];if(t.transformMat4$1(P,P,n),!ie(P,g)){de(f,m);continue}const I=re(o.transform.cameraToCenterDistance,P[3]),A=t.evaluateSizeForFeature(h,d,r),D=a?A/I:A*I,M=oe(T,R,O,i);if(M[3]<=0){de(f,m);continue}let L={};const N=a?null:u,F=ue(r,D,!1,l,n,i,s,e.glyphOffsetArray,v,m,y,M,S,L,C,N,p.projection,c,a);b=F.useVertical,N&&F.needsFlipping&&(L={}),(F.notEnoughRoom||b||F.needsFlipping&&ue(r,D,!0,l,n,i,s,e.glyphOffsetArray,v,m,y,M,S,L,C,N,p.projection,c,a).notEnoughRoom)&&de(f,m)}r?(e.text.dynamicLayoutVertexBuffer.updateData(m),y&&e.text.globeExtVertexBuffer.updateData(y)):(e.icon.dynamicLayoutVertexBuffer.updateData(m),y&&e.icon.globeExtVertexBuffer.updateData(y))}function ae(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g){const{lineStartIndex:m,glyphStartIndex:y,segment:v}=a,_=y+a.numGlyphs,C=m+a.lineLength,w=e.getoffsetX(y),b=e.getoffsetX(_-1),x=he(t*w,n,o,r,i,s,v,m,C,l,u,c,p,h,!0,d,f,g);if(!x)return null;const E=he(t*b,n,o,r,i,s,v,m,C,l,u,c,p,h,!0,d,f,g);return E?{first:x,last:E}:null}function le(e,n,o,r){return e===t.WritingMode.horizontal&&Math.abs(r)>Math.abs(o)?{useVertical:!0}:e===t.WritingMode.vertical?r>0?{needsFlipping:!0}:null:n!==Qt.unknown&&function(t,e){return 0===t||Math.abs(e/t)>$t}(o,r)?n===Qt.flipRequired?{needsFlipping:!0}:null:o<0?{needsFlipping:!0}:null}function ue(e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v,_){const C=n/24,w=e.lineOffsetX*C,b=e.lineOffsetY*C,{lineStartIndex:x,glyphStartIndex:E,numGlyphs:S,segment:T,writingMode:R,flipState:O}=e,P=x+e.lineLength,I=e=>{if(p){const[n,o,r]=e.up,i=c.length;t.updateGlobeVertexNormal(p,i+0,n,o,r),t.updateGlobeVertexNormal(p,i+1,n,o,r),t.updateGlobeVertexNormal(p,i+2,n,o,r),t.updateGlobeVertexNormal(p,i+3,n,o,r)}const[n,o,r]=e.point;t.addDynamicAttributes(c,n,o,r,e.angle)};if(S>1){const t=ae(C,l,w,b,o,h,d,e,u,s,f,m,!1,y,v,_);if(!t)return{notEnoughRoom:!0};if(r&&!o){let[n,o,r]=t.first.point,[i,s,l]=t.last.point;[n,o]=oe(n,o,r,a),[i,s]=oe(i,s,l,a);const u=le(R,O,(i-n)*g,s-o);if(e.flipState=u&&u.needsFlipping?Qt.flipRequired:Qt.flipNotRequired,u)return u}I(t.first);for(let e=E+1;e<E+S-1;e++){const t=he(C*l.getoffsetX(e),w,b,o,h,d,T,x,P,u,s,f,m,!1,!1,y,v,_);if(!t)return c.length-=4*(e-E),{notEnoughRoom:!0};I(t)}I(t.last)}else{if(r&&!o){const n=oe(d.x,d.y,0,i),o=x+T+1,r=new t.Point(u.getx(o),u.gety(o)),s=oe(r.x,r.y,0,i),a=s[3]>0?s:pe(d,r,n,1,i,void 0,y,v.canonical),l=le(R,O,(a[0]-n[0])*g,a[1]-n[1]);if(e.flipState=l&&l.needsFlipping?Qt.flipRequired:Qt.flipNotRequired,l)return l}const n=he(C*l.getoffsetX(E),w,b,o,h,d,T,x,P,u,s,f,m,!1,!1,y,v,_);if(!n)return{notEnoughRoom:!0};I(n)}return{}}function ce(t,e,n,o,r){const{x:i,y:s,z:a}=o.projectTilePoint(t.x,t.y,e);if(!r)return oe(i,s,a,n);const[l,u,c]=r(t);return oe(i+l,s+u,a+c,n)}function pe(e,n,o,r,i,s,a,l){const u=ce(e.sub(n)._unit()._add(e),l,i,a,s);return t.sub(u,o,u),t.normalize(u,u),t.scaleAndAdd(u,o,u,r)}function he(e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y,v){const _=r?e-n:e+n;let C=_>0?1:-1,w=0;r&&(C*=-1,w=Math.PI),C<0&&(w+=Math.PI);let b=l+a+(C>0?0:1)|0,x=i,E=i,S=0,T=0;const R=Math.abs(_),O=[],P=[];let I=s,A=I;const D=()=>pe(A,I,E,R-S+1,p,d,m,y.canonical);for(;S+T<=R;){if(b+=C,b<l||b>=u)return null;if(E=x,A=I,O.push(E),f&&P.push(A),I=new t.Point(c.getx(b),c.gety(b)),x=h[b],!x){const t=ce(I,y.canonical,p,m,d);x=t[3]>0?h[b]=t:D()}S+=T,T=t.distance(E,x)}g&&d&&(h[b]&&(x=D(),T=t.distance(E,x)),h[b]=x);const M=(R-S)/T,L=I.sub(A)._mult(M)._add(A),N=t.sub([],x,E),F=t.scaleAndAdd([],E,N,M);let k=[0,0,1],G=N[0],B=N[1];if(v&&(k=m.upVector(y.canonical,L.x,L.y),0!==k[0]||0!==k[1]||1!==k[2])){const e=[k[2],0,-k[0]],n=t.cross([],k,e);t.normalize(e,e),t.normalize(n,n),G=t.dot(N,e),B=t.dot(N,n)}if(o){const e=t.cross([],k,N);t.normalize(e,e),t.scaleAndAdd(F,F,e,o*C)}const V=w+Math.atan2(B,G);return O.push(F),f&&P.push(L),{point:F,angle:V,path:O,tilePath:P,up:k}}function de(t,e){const n=e.length,o=n+4*t;e.resize(o),e.float32.fill(-1/0,4*n,4*o)}function fe(t,e,n){const o=e[0],r=e[1];return t[0]=n[0]*o+n[4]*r+n[12],t[1]=n[1]*o+n[5]*r+n[13],t[3]=n[3]*o+n[7]*r+n[15],t}const ge=100;class me{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Jt(t.width+200,t.height+200,25),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Jt(t.width+200,t.height+200,25);this.transform=t,this.grid=n,this.ignoredGrid=o,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ge,this.screenBottomBoundary=t.height+ge,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,n,o,r,i,s,a){let l=n.projectedAnchorX,u=n.projectedAnchorY,c=n.projectedAnchorZ;const p=n.elevation,h=n.tileID,d=t.getProjection();if(p&&h){const[t,e,o]=d.upVector(h.canonical,n.tileAnchorX,n.tileAnchorY),r=d.upVectorScale(h.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=t*p*r,u+=e*p*r,c+=o*p*r}const f=this.projectAndGetPerspectiveRatio(s,l,u,c,n.tileID,"globe"===d.name||!!p||this.transform.pitch>0,d),g=i*f.perspectiveRatio,m=(n.x1*e+o.x-n.padding)*g+f.point.x,y=(n.y1*e+o.y-n.padding)*g+f.point.y,v=(n.x2*e+o.x+n.padding)*g+f.point.x,_=(n.y2*e+o.y+n.padding)*g+f.point.y,C=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(m,y,v,_)||!r&&this.grid.hitTest(m,y,v,_,a)||C?{box:[],offscreen:!1,occluded:f.occluded}:{box:[m,y,v,_],offscreen:this.isOffscreen(m,y,v,_),occluded:!1}}placeCollisionCircles(e,n,o,r,i,s,a,l,u,c,p,h,d,f,g){const m=[],y=this.transform.elevation,v=e.getProjection(),_=y?y.getAtTileOffsetFunc(g,this.transform.center.lat,this.transform.worldSize,v):null,C=new t.Point(o.tileAnchorX,o.tileAnchorY);let{x:w,y:b,z:x}=v.projectTilePoint(C.x,C.y,g.canonical);if(_){const[t,e,n]=_(C);w+=t,b+=e,x+=n}const E="globe"===v.name,S=this.projectAndGetPerspectiveRatio(a,w,b,x,g,E||!!y||this.transform.pitch>0,v),{perspectiveRatio:T}=S,R=(p?s/T:s*T)/t.ONE_EM,O=oe(w,b,x,l),P=S.signedDistanceFromCamera>0?ae(R,i,o.lineOffsetX*R,o.lineOffsetY*R,!1,O,C,o,r,l,{},y&&!p?_:null,p&&!!y,v,g,p):null;let I=!1,A=!1,D=!0;if(P&&!S.occluded){const e=.5*d*T+f,o=new t.Point(-100,-100),r=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),i=new Zt,{first:s,last:a}=P,l=s.path.length;let p=[];for(let t=l-1;t>=1;t--)p.push(s.path[t]);for(let t=1;t<a.path.length;t++)p.push(a.path[t]);const g=2.5*e;u&&(p=p.map(((t,e)=>{let[n,o,r]=t;return _&&!E&&(r=_(e<l-1?s.tilePath[l-1-e]:a.tilePath[e-l+2])[2]),oe(n,o,r,u)})),p.some((t=>t[3]<=0))&&(p=[]));let y=[];if(p.length>0){let e=1/0,n=-1/0,i=1/0,s=-1/0;for(const t of p)e=Math.min(e,t[0]),i=Math.min(i,t[1]),n=Math.max(n,t[0]),s=Math.max(s,t[1]);n>=o.x&&e<=r.x&&s>=o.y&&i<=r.y&&(y=[p.map((e=>new t.Point(e[0],e[1])))],(e<o.x||n>r.x||i<o.y||s>r.y)&&(y=t.clipLine(y,o.x,o.y,r.x,r.y)))}for(const t of y){i.reset(t,.25*e);let o=0;o=i.length<=.5*e?1:Math.ceil(i.paddedLength/g)+1;for(let t=0;t<o;t++){const r=t/Math.max(o-1,1),s=i.lerp(r),a=s.x+ge,l=s.y+ge;m.push(a,l,e,0);const u=a-e,p=l-e,d=a+e,f=l+e;if(D=D&&this.isOffscreen(u,p,d,f),A=A||this.isInsideGrid(u,p,d,f),!n&&this.grid.hitTestCircle(a,l,e,h)&&(I=!0,!c))return{circles:[],offscreen:!1,collisionDetected:I,occluded:!1}}}}return{circles:!c&&I||!A?[]:m,offscreen:D,collisionDetected:I,occluded:S.occluded}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let o=1/0,r=1/0,i=-1/0,s=-1/0;for(const c of e){const e=new t.Point(c.x+ge,c.y+ge);o=Math.min(o,e.x),r=Math.min(r,e.y),i=Math.max(i,e.x),s=Math.max(s,e.y),n.push(e)}const a=this.grid.query(o,r,i,s).concat(this.ignoredGrid.query(o,r,i,s)),l={},u={};for(const c of a){const e=c.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const o=[new t.Point(c.x1,c.y1),new t.Point(c.x2,c.y1),new t.Point(c.x2,c.y2),new t.Point(c.x1,c.y2)];t.polygonIntersectsPolygon(n,o)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===u[e.bucketInstanceId]&&(u[e.bucketInstanceId]=[]),u[e.bucketInstanceId].push(e.featureIndex))}return u}insertCollisionBox(t,e,n,o,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:o,collisionGroupID:r},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,o,r){const i=e?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:o,collisionGroupID:r};for(let a=0;a<t.length;a+=4)i.insertCircle(s,t[a],t[a+1],t[a+2])}projectAndGetPerspectiveRatio(e,n,o,r,i,s,a){const l=[n,o,r,1];let u=!1;if(r||this.transform.pitch>0){if(t.transformMat4$1(l,l,e),this.fogState&&i&&"globe"!==a.name){const e=function(e,n,o,r,i,s){const a=s.calculateFogTileMatrix(i),l=[n,o,r];return t.transformMat4(l,l,a),S(e,l,s.pitch,s._fov)}(this.fogState,n,o,r,i.toUnwrapped(),this.transform);u=e>.9}}else fe(l,l,e);const c=l[3];return{point:new t.Point((l[0]/c+1)/2*this.transform.width+ge,(-l[1]/c+1)/2*this.transform.height+ge),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/c*.5,1.5),signedDistanceFromCamera:c,occluded:s&&l[2]>c||u}}isOffscreen(t,e,n,o){return n<ge||t>=this.screenRightBoundary||o<ge||e>this.screenBottomBoundary}isInsideGrid(t,e,n,o){return n>=0&&t<this.gridRightBoundary&&o>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}function ye(e,n,o){const r=n.createTileMatrix(e,e.worldSize,o.toUnwrapped());return t.multiply(new Float32Array(16),e.projMatrix,r)}function ve(t,e,n){if(e.projection.name===n.projection.name)return t.projMatrix;const o=n.clone();return o.setProjection(e.projection),ye(o,e.getProjection(),t)}function _e(t,e,n){return e.name===n.projection.name?t.projMatrix:ye(n,e,t)}class Ce{constructor(t,e,n,o){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):o&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class we{constructor(t,e,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.text=new Ce(t?t.text:null,e,n,r),this.icon=new Ce(t?t.icon:null,e,o,r),this.clipped=i}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class be{constructor(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.text=t,this.icon=e,this.skipFade=n,this.clipped=o}}class xe{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class Ee{constructor(t,e,n,o,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=o,this.tileID=r}}class Se{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Te(e,n,o,r,i){const{horizontalAlign:s,verticalAlign:a}=t.getAnchorAlignment(e),l=-(s-.5)*n,u=-(a-.5)*o,c=t.evaluateVariableOffset(e,r);return new t.Point(l+c[0]*i,u+c[1]*i)}function Re(e,n,o,r,i){const s=new t.Point(e,n);return o&&s._rotate(r?i:-i),s}class Oe{constructor(t,e,n,o,r){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new me(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Se(n),this.collisionCircleArrays={},this.prevPlacement=o,o&&(o.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,o,r){const i=o.getBucket(n),s=o.latestFeatureIndex;if(!i||!s||n.id!==i.layerIds[0])return;const a=i.layers[0].layout,l=o.collisionBoxArray,u=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),c=o.tileSize/t.EXTENT,p=o.tileID.toUnwrapped();this.transform.setProjection(i.projection);const h=(d=o.tileID,f=i.getProjection(),g=this.transform,f.name===this.projection?g.calculateProjMatrix(d.toUnwrapped()):ye(g,f,d));var d,f,g;const m="map"===a.get("text-pitch-alignment"),y="map"===a.get("text-rotation-alignment");n.compileFilter();const v=n.dynamicFilter(),_=n.dynamicFilterNeedsFeature(),C=this.transform.calculatePixelsToTileUnitsMatrix(o),w=ee(h,o.tileID.canonical,m,y,this.transform,i.getProjection(),C);let b=null;if(m){const e=ne(h,o.tileID.canonical,m,y,this.transform,i.getProjection(),C);b=t.multiply([],this.transform.labelPlaneMatrix,e)}let x=null;v&&o.latestFeatureIndex&&(x={unwrappedTileID:p,dynamicFilter:v,dynamicFilterNeedsFeature:_,featureIndex:o.latestFeatureIndex}),this.retainedQueryData[i.bucketInstanceId]=new Ee(i.bucketInstanceId,s,i.sourceLayerIndex,i.index,o.tileID);const E={bucket:i,layout:a,posMatrix:h,textLabelPlaneMatrix:w,labelToScreenMatrix:b,clippingData:x,scale:u,textPixelRatio:c,holdingForFade:o.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(i.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(i.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(i.sourceID)};if(r)for(const t of i.sortKeyRanges){const{sortKey:n,symbolInstanceStart:o,symbolInstanceEnd:r}=t;e.push({sortKey:n,symbolInstanceStart:o,symbolInstanceEnd:r,parameters:E})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:i.symbolInstances.length,parameters:E})}attemptAnchorPlacement(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y){const{textOffset0:v,textOffset1:_,crossTileID:C}=p,w=[v,_],b=Te(t,n,o,w,r),x=this.collisionIndex.placeCollisionBox(d,r,e,Re(b.x,b.y,i,s,this.transform.angle),c,a,l,u.predicate);if(g){const t=d.getSymbolInstanceIconSize(y,this.transform.zoom,p.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(d,t,g,Re(b.x,b.y,i,s,this.transform.angle),c,a,l,u.predicate).box.length)return}if(x.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[C]&&this.prevPlacement.placements[C]&&this.prevPlacement.placements[C].text&&(e=this.prevPlacement.variableOffsets[C].anchor),this.variableOffsets[C]={textOffset:w,width:n,height:o,anchor:t,textScale:r,prevAnchor:e},this.markUsedJustification(d,t,p,f),d.allowVerticalPlacement&&(this.markUsedOrientation(d,f,p),this.placedOrientations[C]=f),{shift:b,placedGlyphBoxes:x}}}placeLayerBucketPart(e,n,o,r){const{bucket:i,layout:s,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:u,clippingData:c,textPixelRatio:p,holdingForFade:h,collisionBoxArray:d,partiallyEvaluatedTextSize:f,partiallyEvaluatedIconSize:g,collisionGroup:m}=e.parameters,y=s.get("text-optional"),v=s.get("icon-optional"),_=s.get("text-allow-overlap"),C=s.get("icon-allow-overlap"),w="map"===s.get("text-rotation-alignment"),b="map"===s.get("text-pitch-alignment"),x="none"!==s.get("icon-text-fit"),E="viewport-y"===s.get("symbol-z-order");this.transform.setProjection(i.projection);let S=_&&(C||!i.hasIconData()||v),T=C&&(_||!i.hasTextData()||y);!i.collisionArrays&&d&&i.deserializeCollisionBoxes(d),o&&r&&i.updateCollisionDebugBuffers(this.transform.zoom,d);const R=(e,r,d)=>{const{crossTileID:E,numVerticalGlyphVertices:R}=e;if(c){const o={zoom:this.transform.zoom,pitch:this.transform.pitch};let r=null;if(c.dynamicFilterNeedsFeature){const t=this.retainedQueryData[i.bucketInstanceId];r=c.featureIndex.loadFeature({featureIndex:e.featureIndex,bucketIndex:t.bucketIndex,sourceLayerIndex:t.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,c.dynamicFilter)(o,r,this.retainedQueryData[i.bucketInstanceId].tileID.canonical,new t.Point(e.tileAnchorX,e.tileAnchorY),this.transform.calculateDistanceTileData(c.unwrappedTileID)))return this.placements[E]=new be(!1,!1,!1,!0),void n.add(E)}if(n.has(E))return;if(h)return void(this.placements[E]=new be(!1,!1,!1));let O=!1,P=!1,I=!0,A=!1,D=!1,M=null,L={box:null,offscreen:null,occluded:null},N={box:null,offscreen:null,occluded:null},F=null,k=null,G=null,B=0,V=0,z=0;d.textFeatureIndex?B=d.textFeatureIndex:e.useRuntimeCollisionCircles&&(B=e.featureIndex),d.verticalTextFeatureIndex&&(V=d.verticalTextFeatureIndex);const j=t=>{t.tileID=this.retainedQueryData[i.bucketInstanceId].tileID;const e=this.transform.elevation;(e||t.elevation)&&(t.elevation=e?e.getAtTileOffset(t.tileID,t.tileAnchorX,t.tileAnchorY):0)},H=d.textBox;if(H){j(H);const n=n=>{let o=t.WritingMode.horizontal;if(i.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[E];t&&(this.placedOrientations[E]=t,o=t,this.markUsedOrientation(i,o,e))}return o},o=(e,n)=>{if(i.allowVerticalPlacement&&R>0&&d.verticalTextBox){for(const o of i.writingModes)if(o===t.WritingMode.vertical?(L=n(),N=L):L=e(),L&&L.box&&L.box.length)break}else L=e()};if(s.get("text-variable-anchor")){let l=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E]){const t=this.prevPlacement.variableOffsets[E];l.indexOf(t.anchor)>0&&(l=l.filter((e=>e!==t.anchor)),l.unshift(t.anchor))}const u=(t,n,o)=>{const s=i.getSymbolInstanceTextSize(f,e,this.transform.zoom,r),u=(t.x2-t.x1)*s+2*t.padding,c=(t.y2-t.y1)*s+2*t.padding,h=x&&!C?n:null;h&&j(h);let d={box:[],offscreen:!1,occluded:!1};const y=_?2*l.length:l.length;for(let v=0;v<y;++v){const n=this.attemptAnchorPlacement(l[v%l.length],t,u,c,s,w,b,p,a,m,v>=l.length,e,r,i,o,h,f,g);if(n&&(d=n.placedGlyphBoxes,d&&d.box&&d.box.length)){O=!0,M=n.shift;break}}return d};o((()=>u(H,d.iconBox,t.WritingMode.horizontal)),(()=>{const e=d.verticalTextBox;return e&&j(e),i.allowVerticalPlacement&&!(L&&L.box&&L.box.length)&&R>0&&e?u(e,d.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),L&&(O=L.box,I=L.offscreen,A=L.occluded);const c=n(!(!L||!L.box));if(!O&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[E];t&&(this.variableOffsets[E]=t,this.markUsedJustification(i,t.anchor,e,c))}}else{const s=(n,o)=>{const s=i.getSymbolInstanceTextSize(f,e,this.transform.zoom,r),l=this.collisionIndex.placeCollisionBox(i,s,n,new t.Point(0,0),_,p,a,m.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(i,o,e),this.placedOrientations[E]=o),l};o((()=>s(H,t.WritingMode.horizontal)),(()=>{const e=d.verticalTextBox;return i.allowVerticalPlacement&&R>0&&e?(j(e),s(e,t.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),n(!!(L&&L.box&&L.box.length))}}if(F=L,O=F&&F.box&&F.box.length>0,I=F&&F.offscreen,A=F&&F.occluded,e.useRuntimeCollisionCircles){const n=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex),r=t.evaluateSizeForFeature(i.textSizeData,f,n),c=s.get("text-padding");k=this.collisionIndex.placeCollisionCircles(i,_,n,i.lineVertexArray,i.glyphOffsetArray,r,a,l,u,o,b,m.predicate,e.collisionCircleDiameter*r/t.ONE_EM,c,this.retainedQueryData[i.bucketInstanceId].tileID),O=_||k.circles.length>0&&!k.collisionDetected,I=I&&k.offscreen,A=k.occluded}if(d.iconFeatureIndex&&(z=d.iconFeatureIndex),d.iconBox){const n=n=>{j(n);const o=x&&M?Re(M.x,M.y,w,b,this.transform.angle):new t.Point(0,0),r=i.getSymbolInstanceIconSize(g,this.transform.zoom,e.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(i,r,n,o,C,p,a,m.predicate)};N&&N.box&&N.box.length&&d.verticalIconBox?(G=n(d.verticalIconBox),P=G.box.length>0):(G=n(d.iconBox),P=G.box.length>0),I=I&&G.offscreen,D=G.occluded}const U=y||0===e.numHorizontalGlyphVertices&&0===R,W=v||0===e.numIconVertices;if(U||W?W?U||(P=P&&O):O=P&&O:P=O=P&&O,O&&F&&F.box&&this.collisionIndex.insertCollisionBox(F.box,s.get("text-ignore-placement"),i.bucketInstanceId,N&&N.box&&V?V:B,m.ID),P&&G&&this.collisionIndex.insertCollisionBox(G.box,s.get("icon-ignore-placement"),i.bucketInstanceId,z,m.ID),k&&(O&&this.collisionIndex.insertCollisionCircles(k.circles,s.get("text-ignore-placement"),i.bucketInstanceId,B,m.ID),o)){const t=i.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new xe);for(let n=0;n<k.circles.length;n+=4)e.circles.push(k.circles[n+0]),e.circles.push(k.circles[n+1]),e.circles.push(k.circles[n+2]),e.circles.push(k.collisionDetected?1:0)}const q="globe"!==i.projection.name;S=S&&(q||!A),T=T&&(q||!D),this.placements[E]=new be(O||S,P||T,I||i.justReloaded),n.add(E)};if(E){const t=i.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];R(i.symbolInstances.get(n),n,i.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)R(i.symbolInstances.get(t),t,i.collisionArrays[t]);if(o&&i.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[i.bucketInstanceId];t.invert(e.invProjMatrix,a),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}i.justReloaded=!1}markUsedJustification(e,n,o,r){const{leftJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:u}=o,c=t.getAnchorJustification(n),p=r===t.WritingMode.vertical?l:"left"===c?i:"center"===c?s:"right"===c?a:-1;i>=0&&(e.text.placedSymbolArray.get(i).crossTileID=p>=0&&i!==p?0:u),s>=0&&(e.text.placedSymbolArray.get(s).crossTileID=p>=0&&s!==p?0:u),a>=0&&(e.text.placedSymbolArray.get(a).crossTileID=p>=0&&a!==p?0:u),l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=p>=0&&l!==p?0:u)}markUsedOrientation(e,n,o){const r=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,i=n===t.WritingMode.vertical?n:0,{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:u}=o,c=e.text.placedSymbolArray;s>=0&&(c.get(s).placedOrientation=r),a>=0&&(c.get(a).placedOrientation=r),l>=0&&(c.get(l).placedOrientation=r),u>=0&&(c.get(u).placedOrientation=i)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const o=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},i=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const a in this.placements){const t=this.placements[a],e=r[a];e?(this.opacities[a]=new we(e,o,t.text,t.icon,null,t.clipped),n=n||t.text!==e.text.placed||t.icon!==e.icon.placed):(this.opacities[a]=new we(null,o,t.text,t.icon,t.skipFade,t.clipped),n=n||t.text||t.icon)}for(const a in r){const t=r[a];if(!this.opacities[a]){const e=new we(t,o,!1,!1);e.isHidden()||(this.opacities[a]=e,n=n||t.text.placed||t.icon.placed)}}for(const a in i)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=i[a]);for(const a in s)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=s[a]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n=new Set;for(const o of e){const e=o.getBucket(t);e&&o.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,n,o.collisionBoxArray)}}updateBucketOpacities(e,n,o){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const r=e.layers[0].layout,i=!!e.layers[0].dynamicFilter(),s=new we(null,0,!1,!1,!0),a=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),u=r.get("text-variable-anchor"),c="map"===r.get("text-rotation-alignment"),p="map"===r.get("text-pitch-alignment"),h="none"!==r.get("icon-text-fit"),d=new we(null,0,a&&(l||!e.hasIconData()||r.get("icon-optional")),l&&(a||!e.hasTextData()||r.get("text-optional")),!0);!e.collisionArrays&&o&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(o);const f=(t,e,n)=>{for(let o=0;o<e/4;o++)t.opacityVertexArray.emplaceBack(n)};let g=0;for(let m=0;m<e.symbolInstances.length;m++){const o=e.symbolInstances.get(m),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:l,numIconVertices:y}=o,v=n.has(l);let _=this.opacities[l];v?_=s:_||(_=d,this.opacities[l]=_),n.add(l);const C=r>0||a>0,w=y>0,b=this.placedOrientations[l],x=b===t.WritingMode.vertical,E=b===t.WritingMode.horizontal||b===t.WritingMode.horizontalOnly;if(!C&&!w||_.isHidden()||g++,C){const t=ke(_.text);f(e.text,r,x?Ge:t),f(e.text,a,E?Ge:t);const n=_.text.isHidden(),{leftJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:c}=o,p=e.text.placedSymbolArray,h=n||x?1:0;i>=0&&(p.get(i).hidden=h),s>=0&&(p.get(s).hidden=h),u>=0&&(p.get(u).hidden=h),c>=0&&(p.get(c).hidden=n||E?1:0);const d=this.variableOffsets[l];d&&this.markUsedJustification(e,d.anchor,o,b);const g=this.placedOrientations[l];g&&(this.markUsedJustification(e,"left",o,g),this.markUsedOrientation(e,g,o))}if(w){const t=ke(_.icon),{placedIconSymbolIndex:n,verticalPlacedIconSymbolIndex:r}=o,i=e.icon.placedSymbolArray,s=_.icon.isHidden()?1:0;n>=0&&(f(e.icon,y,x?Ge:t),i.get(n).hidden=s),r>=0&&(f(e.icon,o.numVerticalIconVertices,E?Ge:t),i.get(r).hidden=s)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[m];if(n){let o=new t.Point(0,0),r=!0;if(n.textBox||n.verticalTextBox){if(u){const t=this.variableOffsets[l];t?(o=Te(t.anchor,t.width,t.height,t.textOffset,t.textScale),c&&o._rotate(p?this.transform.angle:-this.transform.angle)):r=!1}i&&(r=!_.clipped),n.textBox&&Pe(e.textCollisionBox.collisionVertexArray,_.text.placed,!r||x,o.x,o.y),n.verticalTextBox&&Pe(e.textCollisionBox.collisionVertexArray,_.text.placed,!r||E,o.x,o.y)}const s=r&&Boolean(!E&&n.verticalIconBox);n.iconBox&&Pe(e.iconCollisionBox.collisionVertexArray,_.icon.placed,s,h?o.x:0,h?o.y:0),n.verticalIconBox&&Pe(e.iconCollisionBox.collisionVertexArray,_.icon.placed,!s,h?o.x:0,h?o.y:0)}}}if(e.fullyClipped=0===g,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function Pe(t,e,n,o,r){t.emplaceBack(e?1:0,n?1:0,o||0,r||0),t.emplaceBack(e?1:0,n?1:0,o||0,r||0),t.emplaceBack(e?1:0,n?1:0,o||0,r||0),t.emplaceBack(e?1:0,n?1:0,o||0,r||0)}const Ie=Math.pow(2,25),Ae=Math.pow(2,24),De=Math.pow(2,17),Me=Math.pow(2,16),Le=Math.pow(2,9),Ne=Math.pow(2,8),Fe=Math.pow(2,1);function ke(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Ie+e*Ae+n*De+e*Me+n*Le+e*Ne+n*Fe+e}const Ge=0;class Be{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,e,n,o,r){const i=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(i,o,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,i.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<i.length;){const t=i[this._currentPartIndex];if(e.placeLayerBucketPart(t,this._seenCrossTileIDs,n,0===t.symbolInstanceStart),this._currentPartIndex++,r())return!0}return!1}}class Ve{constructor(t,e,n,o,r,i,s,a){this.placement=new Oe(t,r,i,s,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=o,this._done=!1}isDone(){return this._done}continuePlacement(e,n,o){const r=t.exported.now(),i=()=>{const e=t.exported.now()-r;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=n[e[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=r)&&(!t.maxzoom||t.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Be(t)),this._inProgressLayer.continuePlacement(o[t.source],this.placement,this._showCollisionBoxes,t,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ze=512/t.EXTENT/2;class je{constructor(e,n,o){this.tileID=e,this.bucketInstanceId=o,this.index=new t.KDBush(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const r=e.canonical.x*t.EXTENT,i=e.canonical.y*t.EXTENT;for(let t=0;t<n.length;t++){const{key:e,crossTileID:o,tileAnchorX:s,tileAnchorY:a}=n.get(t),l=Math.floor((r+s)*ze),u=Math.floor((i+a)*ze);this.index.add(l,u),this.keys.push(e),this.crossTileIDs.push(o)}this.index.finish()}findMatches(e,n,o){const r=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),i=ze/Math.pow(2,n.canonical.z-this.tileID.canonical.z),s=n.canonical.x*t.EXTENT,a=n.canonical.y*t.EXTENT;for(let t=0;t<e.length;t++){const n=e.get(t);if(n.crossTileID)continue;const{key:l,tileAnchorX:u,tileAnchorY:c}=n,p=Math.floor((s+u)*i),h=Math.floor((a+c)*i),d=this.index.range(p-r,h-r,p+r,h+r);for(const t of d){const e=this.crossTileIDs[t];if(this.keys[t]===l&&!o.has(e)){o.add(e),n.crossTileID=e;break}}}}}class He{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ue{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const n in this.indexes){const t=this.indexes[n],o={};for(const n in t){const r=t[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),o[r.tileID.key]=r}this.indexes[n]=o}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const o=this.usedCrossTileIDs[t.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>t.overscaledZ)for(const r in n){const i=n[r];i.tileID.isChildOf(t)&&i.findMatches(e.symbolInstances,t,o)}else{const i=n[t.scaledTo(Number(r)).key];i&&i.findMatches(e.symbolInstances,t,o)}}for(let r=0;r<e.symbolInstances.length;r++){const t=e.symbolInstances.get(r);t.crossTileID||(t.crossTileID=n.generate(),o.add(t.crossTileID))}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new je(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n of e.crossTileIDs)this.usedCrossTileIDs[t].delete(n)}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const o=this.indexes[n];for(const r in o)t[o[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,o[r]),delete o[r],e=!0)}return e}}class We{constructor(){this.layerIndexes={},this.crossTileIDs=new He,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n,o){let r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Ue);let i=!1;const s={};"globe"!==o.name&&r.handleWrapJump(n);for(const a of e){const e=a.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(a.tileID,e,this.crossTileIDs)&&(i=!0),s[e.bucketInstanceId]=!0)}return r.removeStaleBuckets(s)&&(i=!0),i}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const n in this.layerIndexes)e[n]||delete this.layerIndexes[n]}}const qe=(e,n)=>t.emitValidationErrors(e,n&&n.filter((t=>"source.canvas"!==t.identifier))),Xe=t.pick(jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ye=t.pick(jt,["setCenter","setZoom","setBearing","setPitch"]),Ke={version:8,layers:[],sources:{}},Ze={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Je extends t.Evented{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.map=e,this.dispatcher=new P(Bt(),this),this.imageManager=new C,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,n.localFontFamily?t.LocalGlyphMode.all:n.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,n.localFontFamily||n.localIdeographFontFamily),this.crossTileSymbolIndex=new We,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const o=this;this._rtlTextPluginCallback=Je.registerForPluginStateChange((e=>{o.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,n)=>{if(t.triggerPluginCompletionEvent(e),n&&n.every((t=>t)))for(const t in o._sourceCaches){const e=o._sourceCaches[t],n=e.getSource().type;"vector"!==n&&"geojson"!==n||e.reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const n in this._layers){const t=this._layers[n];t.source===e.id&&this._validateLayer(t)}}))}loadURL(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new t.Event("dataloading",{dataType:"style"}));const o="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);const r=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(r,((e,n)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):n&&this._load(n,o)}))}loadJSON(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame((()=>{this._request=null,this._load(e,!1!==n.validate)}))}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ke,!1)}_updateLayerCount(t,e){const n=e?1:-1;t.is3D()&&(this._num3DLayers+=n),"circle"===t.type&&(this._numCircleLayers+=n),"symbol"===t.type&&(this._numSymbolLayers+=n)}_load(e,n){if(n&&qe(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=t.clone$1(e),this._updateMapProjection();for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const o=zt(this.stylesheet.layers);this._order=o.map((t=>t.id)),this._layers={},this._serializedLayers={};for(const r of o){const e=t.createStyleLayer(r);e.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=e,this._serializedLayers[e.id]=e.serialize(),this._updateLayerCount(e,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new b(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(e){this._spriteRequest=function(e,n,o){let r,i,s;const a=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,a,".json"),t.ResourceType.SpriteJSON),((t,e)=>{l=null,s||(s=t,r=e,c())})),u=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,a,".png"),t.ResourceType.SpriteImage),((t,e)=>{u=null,s||(s=t,i=e,c())}));function c(){if(s)o(s);else if(r&&i){const e=t.exported.getImageData(i),n={};for(const o in r){const{width:i,height:s,x:a,y:l,sdf:u,pixelRatio:c,stretchX:p,stretchY:h,content:d}=r[o],f=new t.RGBAImage({width:i,height:s});t.RGBAImage.copy(e,f,{x:a,y:l},{x:0,y:0},{width:i,height:s}),n[o]={data:f,pixelRatio:c,sdf:u,stretchX:p,stretchY:h,content:d}}o(null,n)}}return{cancel(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e,this.map._requestManager,((e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(n)for(const t in n)this.imageManager.addImage(t,n[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))}))}_validateLayer(e){const n=this.getSource(e.source);if(!n)return;const o=e.sourceLayer;o&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(o))&&this.fire(new t.ErrorEvent(new Error('Source layer "'.concat(o,'" does not exist on source "').concat(n.id,'" as specified by style layer "').concat(e.id,'"'))))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&("function"==typeof t.isLayerDraped?t.isLayerDraped():Ze[t.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;const n=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];"reload"===t?this._reloadSource(e):"clear"===t&&this._clearSource(e)}this._updateTilesForChangedImages();for(const o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const o={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];o[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];if(n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)){const t=this._getLayerSourceCache(n);t&&(t.used=!0)}const o=this.map.painter;if(o){const t=n.getProgramIds();if(!t)continue;const r=n.getProgramConfiguration(e.zoom);for(const e of t)o.useProgram(e,r)}}for(const r in o){const e=this._sourceCaches[r];o[r]!==e.used&&e.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:e.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),qe(this,t.validateStyle(n)))return!1;(n=t.clone$1(n)).layers=zt(n.layers);const o=function(t,n){if(!t)return[{command:jt.setStyle,args:[n]}];let o=[];try{if(!e(t.version,n.version))return[{command:jt.setStyle,args:[n]}];e(t.center,n.center)||o.push({command:jt.setCenter,args:[n.center]}),e(t.zoom,n.zoom)||o.push({command:jt.setZoom,args:[n.zoom]}),e(t.bearing,n.bearing)||o.push({command:jt.setBearing,args:[n.bearing]}),e(t.pitch,n.pitch)||o.push({command:jt.setPitch,args:[n.pitch]}),e(t.sprite,n.sprite)||o.push({command:jt.setSprite,args:[n.sprite]}),e(t.glyphs,n.glyphs)||o.push({command:jt.setGlyphs,args:[n.glyphs]}),e(t.transition,n.transition)||o.push({command:jt.setTransition,args:[n.transition]}),e(t.light,n.light)||o.push({command:jt.setLight,args:[n.light]}),e(t.fog,n.fog)||o.push({command:jt.setFog,args:[n.fog]}),e(t.projection,n.projection)||o.push({command:jt.setProjection,args:[n.projection]});const r={},i=[];!function(t,n,o,r){let i;for(i in n=n||{},t=t||{})t.hasOwnProperty(i)&&(n.hasOwnProperty(i)||Ut(i,o,r));for(i in n){if(!n.hasOwnProperty(i))continue;const s=n[i];t.hasOwnProperty(i)?e(t[i],s)||("geojson"===t[i].type&&"geojson"===s.type&&qt(t,n,i)?o.push({command:jt.setGeoJSONSourceData,args:[i,s.data]}):Wt(i,n,o,r)):Ht(i,n,o)}}(t.sources,n.sources,i,r);const s=[];t.layers&&t.layers.forEach((t=>{t.source&&r[t.source]?o.push({command:jt.removeLayer,args:[t.id]}):s.push(t)}));let a=t.terrain;a&&r[a.source]&&(o.push({command:jt.setTerrain,args:[void 0]}),a=void 0),o=o.concat(i),e(a,n.terrain)||o.push({command:jt.setTerrain,args:[n.terrain]}),function(t,n,o){n=n||[];const r=(t=t||[]).map(Yt),i=n.map(Yt),s=t.reduce(Kt,{}),a=n.reduce(Kt,{}),l=r.slice(),u=Object.create(null);let c,p,h,d,f,g,m;for(c=0,p=0;c<r.length;c++)h=r[c],a.hasOwnProperty(h)?p++:(o.push({command:jt.removeLayer,args:[h]}),l.splice(l.indexOf(h,p),1));for(c=0,p=0;c<i.length;c++)h=i[i.length-1-c],l[l.length-1-c]!==h&&(s.hasOwnProperty(h)?(o.push({command:jt.removeLayer,args:[h]}),l.splice(l.lastIndexOf(h,l.length-p),1)):p++,g=l[l.length-c],o.push({command:jt.addLayer,args:[a[h],g]}),l.splice(l.length-c,0,h),u[h]=!0);for(c=0;c<i.length;c++)if(h=i[c],d=s[h],f=a[h],!u[h]&&!e(d,f))if(e(d.source,f.source)&&e(d["source-layer"],f["source-layer"])&&e(d.type,f.type)){for(m in Xt(d.layout,f.layout,o,h,null,jt.setLayoutProperty),Xt(d.paint,f.paint,o,h,null,jt.setPaintProperty),e(d.filter,f.filter)||o.push({command:jt.setFilter,args:[h,f.filter]}),e(d.minzoom,f.minzoom)&&e(d.maxzoom,f.maxzoom)||o.push({command:jt.setLayerZoomRange,args:[h,f.minzoom,f.maxzoom]}),d)d.hasOwnProperty(m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Xt(d[m],f[m],o,h,m.slice(6),jt.setPaintProperty):e(d[m],f[m])||o.push({command:jt.setLayerProperty,args:[h,m,f[m]]}));for(m in f)f.hasOwnProperty(m)&&!d.hasOwnProperty(m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Xt(d[m],f[m],o,h,m.slice(6),jt.setPaintProperty):e(d[m],f[m])||o.push({command:jt.setLayerProperty,args:[h,m,f[m]]}))}else o.push({command:jt.removeLayer,args:[h]}),g=l[l.lastIndexOf(h)+1],o.push({command:jt.addLayer,args:[f,g]})}(s,n.layers,o)}catch(t){console.warn("Unable to compute style diff:",t),o=[{command:jt.setStyle,args:[n]}]}return o}(this.serialize(),n).filter((t=>!(t.command in Ye)));if(0===o.length)return!1;const r=o.filter((t=>!(t.command in Xe)));if(r.length>0)throw new Error("Unimplemented: ".concat(r.map((t=>t.command)).join(", "),"."));return o.forEach((t=>{"setTransition"!==t.command&&"setProjection"!==t.command&&this[t.command].apply(this,t.args)})),this.stylesheet=n,this._updateMapProjection(),!0}addImage(e,n){return this.getImage(e)?this.fire(new t.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,n),this._afterImageUpdated(e),this)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e),this._afterImageUpdated(e),this):this.fire(new t.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getSource(e))throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateSource,"sources.".concat(e),n,null,o))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=It(e,n,this.dispatcher,this);r.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(e),source:r.serialize(),sourceId:e})));const i=n=>{const o=(n?"symbol:":"other:")+e,i=this._sourceCaches[o]=new t.SourceCache(o,r,n);(n?this._symbolSourceCaches:this._otherSourceCaches)[e]=i,i.style=this,i.onAdd(this.map)};i(!1),"vector"!==n.type&&"geojson"!==n.type||i(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const n=this.getSource(e);if(!n)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(r,'" is using it.'))));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(new Error('Source "'.concat(e,'" cannot be removed while terrain is using it.'))));const o=this._getSourceCaches(e);for(const r of o)delete this._sourceCaches[r.id],delete this._updatedSources[r.id],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r.getSource().id})),r.setEventedParent(null),r.clearTiles();return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}_getSources(){const t=[];for(const e in this._otherSourceCaches){const n=this._getSourceCache(e);n&&t.push(n.getSource())}return t}addLayer(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=e.id;if(this.getLayer(r))return void this.fire(new t.ErrorEvent(new Error('Layer with id "'.concat(r,'" already exists on this map'))));let i;if("custom"===e.type){if(qe(this,t.validateCustomStyleLayer(e)))return;i=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$1(e),e=t.extend(e,{source:r})),this._validate(t.validateLayer,"layers.".concat(r),e,{arrayIndex:-1},o))return;i=t.createStyleLayer(e),this._validateLayer(i),i.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[i.id]=i.serialize(),this._updateLayerCount(i,!0)}const s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)return void this.fire(new t.ErrorEvent(new Error('Layer with id "'.concat(n,'" does not exist on this map.'))));this._order.splice(s,0,r),this._layerOrderChanged=!0,this._layers[r]=i;const a=this._getLayerSourceCache(i);if(this._removedLayers[r]&&i.source&&a&&"custom"!==i.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==i.type?this._updatedSources[i.source]="clear":(this._updatedSources[i.source]="reload",a.pause())}this._updateLayer(i),i.onAdd&&i.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));if(e===n)return;const o=this._order.indexOf(e);this._order.splice(o,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error('Layer with id "'.concat(n,'" does not exist on this map.')))):(this._order.splice(r,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be removed."))));n.setEventedParent(null),this._updateLayerCount(n,!1);const o=this._order.indexOf(e);this._order.splice(o,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(e,n,o){this._checkLoaded();const r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===o||(null!=n&&(r.minzoom=n),null!=o&&(r.maxzoom=o),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot have zoom extent."))))}setFilter(n,o){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=this.getLayer(n);if(i){if(!e(i.filter,o))return null==o?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateFilter,"layers.".concat(i.id,".filter"),o,{layerType:i.type},r)||(i.filter=t.clone$1(o),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be filtered."))))}getFilter(e){const n=this.getLayer(e);return n&&t.clone$1(n.filter)}setLayoutProperty(n,o,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const s=this.getLayer(n);s?e(s.getLayoutProperty(o),r)||(s.setLayoutProperty(o,r,i),this._updateLayer(s)):this.fire(new t.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be styled."))))}getLayoutProperty(e,n){const o=this.getLayer(e);if(o)return o.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style."))))}setPaintProperty(n,o,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const s=this.getLayer(n);s?e(s.getPaintProperty(o),r)||(s.setPaintProperty(o,r,i)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new t.ErrorEvent(new Error("The layer '".concat(n,"' does not exist in the map's style and cannot be styled."))))}getPaintProperty(t,e){const n=this.getLayer(t);return n&&n.getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const o=e.source,r=e.sourceLayer,i=this.getSource(o);if(!i)return void this.fire(new t.ErrorEvent(new Error("The source '".concat(o,"' does not exist in the map's style."))));const s=i.type;if("geojson"===s&&r)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!r)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(o);for(const t of a)t.setFeatureState(r,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const o=e.source,r=this.getSource(o);if(!r)return void this.fire(new t.ErrorEvent(new Error("The source '".concat(o,"' does not exist in the map's style."))));const i=r.type,s="vector"===i?e.sourceLayer:void 0;if("vector"===i&&!s)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(o);for(const t of a)t.removeFeatureState(s,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,o=e.sourceLayer,r=this.getSource(n);if(r){if("vector"!==r.type||o)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(o,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const n=this._sourceCaches[t].getSource();e[n.id]||(e[n.id]=n.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:e,layers:this._serializeLayers(this._order)},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},o=[];for(let i=this._order.length-1;i>=0;i--){const r=this._order[i];if(e(r)){n[r]=i;for(const e of t){const t=e[r];if(t)for(const e of t)o.push(e)}}}o.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const r=[];for(let i=this._order.length-1;i>=0;i--){const s=this._order[i];if(e(s))for(let t=o.length-1;t>=0;t--){const e=o[t].feature;if(n[e.layer.id]<i)break;r.push(e),o.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(e,n,o){n&&n.filter&&this._validate(t.validateFilter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.ErrorEvent(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be queried for features.")))),[];r[n.source]=!0}}const i=[];n.availableImages=this._availableImages;const s=n&&n.layers?n.layers.some((t=>{const e=this.getLayer(t);return e&&e.is3D()})):this.has3DLayers(),a=A.createFromScreenPoints(e,o);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;n.layers&&!r[e]||i.push(Dt(this._sourceCaches[t],this._layers,this._serializedLayers,a,n,o,s,!!this.map._showQueryGeometry))}return this.placement&&i.push(function(t,e,n,o,r,i,s){const a={},l=i.queryRenderedSymbols(o),u=[];for(const c of Object.keys(l).map(Number))u.push(s[c]);u.sort(Lt);for(const c of u){const n=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],e,c.bucketIndex,c.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in n){const e=a[t]=a[t]||[],o=n[t];o.sort(((t,e)=>{const n=c.featureSortOrder;if(n){const o=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-o}return e.featureIndex-t.featureIndex}));for(const t of o)e.push(t)}}for(const c in a)a[c].forEach((e=>{const o=e.feature,r=n(t[c]);if(!r)return;const i=r.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=i}));return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(i)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.validateFilter,"querySourceFeatures.filter",n.filter,null,n);const o=this._getSourceCaches(e);let r=[];for(const t of o)r=r.concat(Mt(t,n));return r}addSourceType(t,e,n){return Je.getSourceType(t)?n(new Error('A source type called "'.concat(t,'" already exists.'))):(Je.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const o=this.light.getLight();let r=!1;for(const s in t)if(!e(t[s],o[s])){r=!0;break}if(!r)return;const i=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(t,n),this.light.updateTransitions(i)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let r=n;if(1===o){if("object"==typeof r.source){const e="terrain-dem-src";this.addSource(e,r.source),r=t.clone$1(r),r=t.extend(r,{source:e})}if(this._validate(t.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&o!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,o)}else{const n=this.terrain,o=n.get();for(const e of Object.keys(t.spec.terrain))!r.hasOwnProperty(e)&&t.spec.terrain[e].default&&(r[e]=t.spec.terrain[e].default);for(const t in r)if(!e(r[t],o[t])){n.set(r),this.stylesheet.terrain=r;const t=this._setTransitionParameters({duration:0});n.updateTransitions(t);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const e=this.fog=new O(t,this.map.transform);this.stylesheet.fog=t;const n=this._setTransitionParameters({duration:0});e.updateTransitions(n)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const t of this.map._markers)t._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog,o=n.get();0===Object.keys(t).length&&n.set(t);for(const r in t)if(!e(t[r],o[r])){n.set(t),this.stylesheet.fog=t;const e=this._setTransitionParameters({duration:0});n.updateTransitions(e);break}}else this._createFog(t);this._markersNeedUpdate=!0}_setTransitionParameters(e){return{now:t.exported.now(),transition:t.extend(e,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter((t=>this.isLayerDraped(this._layers[t]))),e=this._order.filter((t=>!this.isLayerDraped(this._layers[t])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(t,e){const n=this.terrain=new E(t,e);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const o=this._setTransitionParameters({duration:0});n.updateTransitions(o)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"symbol"===e.type&&this._updateLayer(e)}}_validate(e,n,o,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!i||!1!==i.validate)&&qe(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:o,styleSpec:t.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const e=this._getSourceCaches(t);for(const n of e)n.clearTiles()}_reloadSource(t){const e=this._getSourceCaches(t);for(const n of e)n.resume(),n.reload()}_reloadSources(){for(const t of this._getSources())t.reload&&t.reload()}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,n,o,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=!1,a=!1;const l={};for(const t of this._order){const n=this._layers[t];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this._getLayerSourceCache(n);if(!t)continue;l[n.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const o=this.crossTileSymbolIndex.addLayer(n,l[n.source],e.center.lng,e.projection);s=s||o}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),i=i||this._layerOrderChanged||0===o,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(i||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Ve(e,this._order,i,n,o,r,this.placement,this.fog&&e.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),a=!0),s&&this.pauseablePlacement.placement.setStale()),a||s)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();const o=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};o(this._otherSourceCaches[e.source]),o(this._symbolSourceCaches[e.source])}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}getResource(e,n,o){return t.makeRequest(n,o)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}_isSourceCacheLoaded(e){const n=this._getSourceCaches(e);return 0===n.length?(this.fire(new t.ErrorEvent(new Error("There is no source with ID '".concat(e,"'")))),!1):n.every((t=>t.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Je.getSourceType=function(t){return Pt[t]},Je.setSourceType=function(t,e){Pt[t]=e},Je.registerForPluginStateChange=t.registerForPluginStateChange;var Qe="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",$e="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",tn="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",en="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",nn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let on={},rn={};const sn=[];pn(Qe,sn),pn(tn,sn),pn(en,sn),pn(nn,sn),on=hn("",tn),rn=hn(nn,en);const an=hn("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ln=Qe,un="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var cn={background:hn("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:hn("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:hn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:hn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:hn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:hn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:hn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:hn("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:hn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:hn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:hn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:hn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:hn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:hn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:hn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",$e),skyboxGradient:hn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",$e),skyboxCapture:hn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:hn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function pn(t,e){const n=t.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let o of n)if(o=o.trim(),"#"===o[0]&&o.includes("if")&&!o.includes("endif")){o=o.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const t=o.split(" ");for(const n of t)e.includes(n)||e.push(n)}}function hn(t,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,o=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),r={},i=[...sn];return pn(t,i),pn(e,i),{fragmentSource:t=t.replace(n,((t,e,n,o,i)=>(r[i]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nvarying ").concat(n," ").concat(o," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(o," u_").concat(i,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(o," ").concat(i," = u_").concat(i,";\n#endif\n")))),vertexSource:e=e.replace(n,((t,e,n,o,i)=>{const s="float"===o?"vec2":"vec4",a=i.match(/color/)?"color":s;return r[i]?"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(s," a_").concat(i,";\nvarying ").concat(n," ").concat(o," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(o," u_").concat(i,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(o," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = unpack_mix_").concat(a,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(o," ").concat(i," = u_").concat(i,";\n#endif\n"):"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(s," a_").concat(i,";\n#else\nuniform ").concat(n," ").concat(o," u_").concat(i,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(o," ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(o," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(o," ").concat(i," = unpack_mix_").concat(a,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(o," ").concat(i," = u_").concat(i,";\n#endif\n")})),staticAttributes:o,usedDefines:i}}class dn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,e,n,o,r,i,s){this.context=t;let a=this.boundPaintVertexBuffers.length!==o.length;for(let u=0;!a&&u<o.length;u++)this.boundPaintVertexBuffers[u]!==o[u]&&(a=!0);let l=this.boundDynamicVertexBuffers.length!==s.length;for(let u=0;!l&&u<s.length;u++)this.boundDynamicVertexBuffers[u]!==s[u]&&(l=!0);if(!t.extVertexArrayObject||!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||a||l||this.boundIndexBuffer!==r||this.boundVertexOffset!==i)this.freshBind(e,n,o,r,i,s);else{t.bindVertexArrayOES.set(this.vao);for(const t of s)t&&t.bind();r&&r.dynamicDraw&&r.bind()}}freshBind(t,e,n,o,r,i){let s;const a=t.numAttributes,l=this.context,u=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=o,this.boundVertexOffset=r,this.boundDynamicVertexBuffers=i;else{s=l.currentNumAttributes||0;for(let t=a;t<s;t++)u.disableVertexAttribArray(t)}e.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(const c of n)c.enableAttributes(u,t),c.bind(),c.setVertexAttribPointers(u,t,r);for(const c of i)c&&(c.enableAttributes(u,t),c.bind(),c.setVertexAttribPointers(u,t,r));o&&o.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function fn(e,n){const o=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new t.MercatorCoordinate(0,r/o).toLngLat().lat,new t.MercatorCoordinate(0,(r+1)/o).toLngLat().lat]}function gn(e,n,o,r,i,s,a){const l=e.context,u=l.gl,c=o.fbo;if(!c)return;e.prepareDrawTile();const p=e.useProgram("hillshade");l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());const h=((t,e,n,o)=>{const r=n.paint.get("hillshade-shadow-color"),i=n.paint.get("hillshade-highlight-color"),s=n.paint.get("hillshade-accent-color");let a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);const l=!t.options.moving;return{u_matrix:o||t.transform.calculateProjMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:fn(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:i,u_accent:s}})(e,o,r,e.terrain?n.projMatrix:null);e.prepareDrawProgram(l,p,n.toUnwrapped());const{tileBoundsBuffer:d,tileBoundsIndexBuffer:f,tileBoundsSegments:g}=e.getTileBoundsBuffers(o);p.draw(l,u.TRIANGLES,i,s,a,t.CullFaceMode.disabled,h,r.id,d,f,g)}function mn(e,n,o){if(!n.needsDEMTextureUpload)return;const r=e.context,i=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(o.stride);const s=o.getPixels();n.demTexture?n.demTexture.update(s,{premultiply:!1}):n.demTexture=new t.Texture(r,s,i.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function yn(e,n,o,r,i,s){const a=e.context,l=a.gl;if(!n.dem)return;const u=n.dem;if(a.activeTexture.set(l.TEXTURE1),mn(e,n,u),!n.demTexture)return;n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const c=u.dim;a.activeTexture.set(l.TEXTURE0);let p=n.fbo;if(!p){const e=new t.Texture(a,{width:c,height:c,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=n.fbo=a.createFramebuffer(c,c,!0),p.colorAttachment.set(e.texture)}a.bindFramebuffer.set(p.framebuffer),a.viewport.set([0,0,c,c]);const{tileBoundsBuffer:h,tileBoundsIndexBuffer:d,tileBoundsSegments:f}=e.getMercatorTileBoundsBuffers();e.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,r,i,s,t.CullFaceMode.disabled,((e,n)=>{const o=n.stride,r=t.create();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[o,o],u_zoom:e.overscaledZ,u_unpack:n.unpackVector}})(n.tileID,u),o.id,h,d,f),n.needsHillshadePrepare=!1}const vn=e=>({u_matrix:new t.UniformMatrix4f(e),u_image0:new t.Uniform1i(e),u_skirt_height:new t.Uniform1f(e)}),_n=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),Cn=(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f)=>({u_proj_matrix:Float32Array.from(t),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(o),u_merc_matrix:n,u_zoom_transition:r,u_merc_center:i,u_image0:0,u_frustum_tl:s,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:u,u_globe_pos:c,u_globe_radius:p,u_viewport:h,u_grid_matrix:f?Float32Array.from(f):new Float32Array(9),u_skirt_height:d});function wn(t,e){return null!=t&&null!=e&&!(!t.hasData()||!e.hasData())&&null!=t.demTexture&&null!=e.demTexture&&t.tileID.key!==e.tileID.key}const bn=new class{constructor(){this.operations={}}newMorphing(t,e,n,o,r){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==n.tileID.key&&(e.queued=n)}else this.operations[t]={startTime:o,phase:0,duration:r,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},xn={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function En(t){return 6*Math.pow(1.5,22-t)}function Sn(t,e){const n=1<<t.z;return!e&&(0===t.x||t.x===n-1)||0===t.y||t.y===n-1}const Tn=t=>({u_matrix:t});function Rn(e,n,o,r,i){if(i>0){const s=t.exported.now(),a=(s-e.timeAdded)/i,l=n?(s-n.timeAdded)/i:-1,u=o.getSource(),c=r.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-c)>Math.abs(e.tileID.overscaledZ-c),h=p&&e.refreshedUponExpiration?1:t.clamp(p?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}class On extends t.SourceCache{constructor(t){const e={type:"raster-dem",maxzoom:t.transform.maxZoom},n=new P(Bt(),null),o=It("mock-dem",e,n,t.style);super("mock-dem",o,!1),o.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,e){t.state="loaded",e(null)}}class Pn extends t.SourceCache{constructor(t){const e=It("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new P(Bt(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,o){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((n,o)=>{if(n[o.key]="",!this._tiles[o.key]){const n=new t.Tile(o,this._source.tileSize*o.overscaleFactor(),e.tileZoom);n.state="loaded",this._tiles[o.key]=n}return n}),{});for(const t in this._tiles)t in r||(this.freeFBO(t),this._tiles[t].unloadVectorData(),delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const n=Object.values(e);this.renderCachePool.push(...n),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach((t=>t.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class In extends t.OverscaledTileID{constructor(t,e,n){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=n}}class An extends t.Elevation{constructor(e,n){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[o,r,i]=function(e){const n=new t.StructArrayLayout2i4,o=new t.StructArrayLayout3ui6,r=131;n.reserve(17161),o.reserve(33800);const i=t.EXTENT/128,s=t.EXTENT+i/2,a=s+i;for(let u=-i;u<a;u+=i)for(let e=-i;e<a;e+=i){const o=e<0||e>s||u<0||u>s?24575:0,r=t.clamp(Math.round(e),0,t.EXTENT),i=t.clamp(Math.round(u),0,t.EXTENT);n.emplaceBack(r+o,i)}const l=(t,e)=>{const n=e*r+t;o.emplaceBack(n+1,n,n+r),o.emplaceBack(n+r,n+r+1,n+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach((t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)})),[n,o,32768]}(),s=e.context;this.gridBuffer=s.createVertexBuffer(o,t.posAttributes.members),this.gridIndexBuffer=s.createIndexBuffer(r),this.gridSegments=t.SegmentVector.simpleSegment(0,0,o.length,r.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,o.length,i),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Pn(n.map),this.orthoMatrix=t.create(),t.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,t.EXTENT,0,t.EXTENT,0,1);const a=s.gl;this._overlapStencilMode=new t.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new On(n.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(e,n,o){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const r=e.terrain.properties;this.sourceCache=0===e.terrain.drapeRenderMode?this._mockSourceCache:e._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const i=()=>{this.sourceCache.used&&t.warnOnce("Raster DEM source '".concat(this.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));const e=this.getScaledDemTileSize();this.sourceCache.update(n,e,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,i(),this._initializing=!0),i(),n.updateElevation(!0,o),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce("Terrain render cache efficiency is not optimal (".concat(e.efficiency,"%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(e.firstUndrapedLayer,"' or create a map using optimizeForTerrain: true option."))}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((t=>t.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,o=this.painter.transform;this._initializing&&(this._initializing=0===o._centerAltitude&&-1===this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(o.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.proxyCoords=n.getIds().map((t=>{const e=n.getTileByID(t).tileID;return e.projMatrix=o.calculateProjMatrix(e.toUnwrapped()),e}));!function(e,n){const o=n.transform.pointCoordinate(n.transform.getCameraPoint()),r=new t.Point(o.x,o.y);e.sort(((e,n)=>{if(n.overscaledZ-e.overscaledZ)return n.overscaledZ-e.overscaledZ;const o=new t.Point(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),i=new t.Point(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),s=r.mult(1<<e.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(o)-s.distSqr(i)}))}(r,this.painter),this._previousZoom=o.zoom;const i=this.proxyToSource||{};this.proxyToSource={},r.forEach((t=>{this.proxyToSource[t.key]={}})),this.terrainTileForTile={};const s=this._style._sourceCaches;for(const t in s){const n=s[t];if(!n.used)continue;if(n!==this.sourceCache&&this.resetTileLookupCache(n.id),this._setupProxiedCoordsForOrtho(n,e[t],i),n.usedForTerrain)continue;const o=e[t];n.getSource().reparseOverscaled&&this._assignTerrainTiles(o)}this.proxiedCoords[n.id]=r.map((t=>new In(t,t.key,this.orthoMatrix))),this._assignTerrainTiles(r),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(i),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const a={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const n=e.tileID.key;n in a||(this._visibleDemTiles.push(e),a[n]=n)}}_assignTerrainTiles(t){this._initializing||t.forEach((t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)}))}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const n in this.terrainTileForTile){const o=this.terrainTileForTile[n],r=o.dem;!r||o.demTexture&&!o.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),mn(this.painter,o,r))}}_prepareDemTileUniforms(t,e,n,o){if(!e||null==e.demTexture)return!1;const r=t.tileID.canonical,i=Math.pow(2,e.tileID.canonical.z-r.z),s=o||"";return n["u_dem_tl".concat(s)]=[r.x*i%1,r.y*i%1],n["u_dem_scale".concat(s)]=i,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const e=this.painter.context,n=e.gl;if(!this._emptyDepthBufferTexture){const o=new t.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new t.Texture(e,o,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce(((e,n)=>{if(!n.dem)return e;const o=n.dem.tree.minimums[0];return o>0&&t++,e+o}),0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const o=this._getLoadedAreaMinimum(),r=new t.RGBAImage({width:1,height:1},new Uint8Array(t.DEMData.pack(o,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let i=this._emptyDEMTexture;return i?i.update(r,{premultiply:!1}):i=this._emptyDEMTexture=new t.Texture(e,r,n.RGBA,{premultiply:!1}),i}setupElevationDraw(e,n,o){const r=this.painter.context,i=r.gl,s=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();let l=null,u=null,c=1;if(o&&o.morphing&&this._useVertexMorphing){const t=o.morphing.srcDemTile,n=o.morphing.dstDemTile;c=o.morphing.phase,t&&n&&(this._prepareDemTileUniforms(e,t,s,"_prev")&&(u=t),this._prepareDemTileUniforms(e,n,s)&&(l=n))}if(u&&l?(r.activeTexture.set(i.TEXTURE2),l.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE,i.NEAREST),r.activeTexture.set(i.TEXTURE4),u.demTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE,i.NEAREST),s.u_dem_lerp=c):(l=this.terrainTileForTile[e.tileID.key],r.activeTexture.set(i.TEXTURE2),(this._prepareDemTileUniforms(e,l,s)?l.demTexture:this.emptyDEMTexture).bind(i.NEAREST,i.CLAMP_TO_EDGE)),r.activeTexture.set(i.TEXTURE3),o&&o.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE),this._depthFBO&&(s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE),s.u_depth_size_inv=[1,1]),o&&o.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=e}if(o&&o.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=o.labelPlaneMatrixInv),n.setTerrainUniformValues(r,s),"globe"===this.painter.transform.projection.name){const t=this.globeUniformValues(this.painter.transform,e.tileID.canonical,o&&o.useDenormalizedUpVectorScale);n.setGlobeUniformValues(r,t)}}globeUniformValues(e,n,o){const r=e.projection;return{u_tile_tl_up:r.upVector(n,0,0),u_tile_tr_up:r.upVector(n,t.EXTENT,0),u_tile_br_up:r.upVector(n,t.EXTENT,t.EXTENT),u_tile_bl_up:r.upVector(n,0,t.EXTENT),u_tile_up_scale:o?t.globeMetersToEcef(1):r.upVectorScale(n,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const n=this.painter,o=this.painter.context;0!==e.length&&(o.bindFramebuffer.set(null),o.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(e,n,o,r,i){if("globe"===e.transform.projection.name)!function(e,n,o,r,i){const s=e.context,a=s.gl;let l,u;const c=e.options.showTerrainWireframe?2:0,p=e.transform,h=t.globeUseCustomAntiAliasing(e,s,p),d=(t,n)=>{if(u===t)return;const o=[xn[t],"PROJECTION_GLOBE_VIEW"];h&&o.push("CUSTOM_ANTIALIASING"),n&&o.push(xn[c]),l=e.useProgram("globeRaster",null,o),u=t},f=e.colorModeForRenderPass(),g=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);bn.update(i);const m=t.calculateGlobeMercatorMatrix(p),y=[t.mercatorXfromLng(p.center.lng),t.mercatorYfromLat(p.center.lat)],v=c?[!1,!0]:[!1],_=e.globeSharedBuffers,C=[p.width*t.exported.devicePixelRatio,p.height*t.exported.devicePixelRatio],w=Float32Array.from(p.globeMatrix),b={useDenormalizedUpVectorScale:!0};if(v.forEach((c=>{const p=e.transform,h=En(p.zoom)*n.exaggeration();u=-1;const v=c?a.LINES:a.TRIANGLES;for(const u of r){const r=o.getTile(u),x=t.StencilMode.disabled,E=n.prevTerrainTileForTile[u.key],S=n.terrainTileForTile[u.key];wn(E,S)&&bn.newMorphing(u.key,E,S,i,250),s.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const T=bn.getMorphValuesForProxy(u.key),R=T?1:0;T&&t.extend$1(b,{morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:t.easeCubicInOut(T.phase)}});const O=t.tileCornersToBounds(u.canonical),P=t.getLatitudinalLod(O.getCenter().lat),I=t.getGridMatrix(u.canonical,O,P,p.worldSize/p._pixelsPerMercatorPixel),A=t.globeNormalizeECEF(t.globeTileBounds(u.canonical)),D=Cn(p.projMatrix,w,m,A,t.globeToMercatorTransition(p.zoom),y,p.frustumCorners.TL,p.frustumCorners.TR,p.frustumCorners.BR,p.frustumCorners.BL,p.globeCenterInViewSpace,p.globeRadius,C,h,I);if(d(R,c),n.setupElevationDraw(r,l,b),e.prepareDrawProgram(s,l,u.toUnwrapped()),_){const[n,o,r]=c?_.getWirefameBuffers(e.context,P):_.getGridBuffers(P,0!==h);l.draw(s,v,g,x,f,t.CullFaceMode.backCCW,D,"globe_raster",n,o,r)}}})),_){const i=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&i.push("CUSTOM_ANTIALIASING"),l=e.useProgram("globeRaster",null,i);for(const u of r){const{x:r,y:i,z:c}=u.canonical,h=0===i,d=i===(1<<c)-1,[m,v,w,x]=_.getPoleBuffers(c);if(x&&(h||d)){const i=o.getTile(u);s.activeTexture.set(a.TEXTURE0),i.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let _=t.globePoleMatrixForTile(c,r,p);const E=t.globeNormalizeECEF(t.globeTileBounds(u.canonical)),S=(e,n)=>e.draw(s,a.TRIANGLES,g,t.StencilMode.disabled,f,t.CullFaceMode.disabled,Cn(p.projMatrix,_,_,E,0,y,p.frustumCorners.TL,p.frustumCorners.TR,p.frustumCorners.BR,p.frustumCorners.BL,p.globeCenterInViewSpace,p.globeRadius,C,0),"globe_pole_raster",n,w,x);n.setupElevationDraw(i,l,b),e.prepareDrawProgram(s,l,u.toUnwrapped()),h&&S(l,m),d&&(_=t.scale(t.create(),_,[1,-1,1]),S(l,v))}}}}(e,n,o,r,i);else{const s=e.context,a=s.gl;let l,u;const c=e.options.showTerrainWireframe?2:0,p=(t,n)=>{if(u===t)return;const o=[xn[t]];n&&o.push(xn[c]),l=e.useProgram("terrainRaster",null,o),u=t},h=e.colorModeForRenderPass(),d=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);bn.update(i);const f=e.transform,g=En(f.zoom)*n.exaggeration();(c?[!1,!0]:[!1]).forEach((c=>{u=-1;const m=c?a.LINES:a.TRIANGLES,[y,v]=c?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments];for(const u of r){const r=o.getTile(u),_=t.StencilMode.disabled,C=n.prevTerrainTileForTile[u.key],w=n.terrainTileForTile[u.key];wn(C,w)&&bn.newMorphing(u.key,C,w,i,250),s.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const b=bn.getMorphValuesForProxy(u.key),x=b?1:0;let E;b&&(E={morphing:{srcDemTile:b.from,dstDemTile:b.to,phase:t.easeCubicInOut(b.phase)}});const S=_n(u.projMatrix,Sn(u.canonical,f.renderWorldCopies)?g/10:g);p(x,c),n.setupElevationDraw(r,l,E),e.prepareDrawProgram(s,l,u.toUnwrapped()),l.draw(s,m,d,_,h,t.CullFaceMode.backCCW,S,"terrain_raster",n.gridBuffer,y,v)}}))}}(n,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const n=this.painter,o=this.painter.context,r=this.proxySourceCache,i=this.proxiedCoords[r.id],s=this._drapedRenderBatches.shift(),a=[],l=n.style.order;let u=0;for(const c of i){const i=r.getTileByID(c.proxyTileKey),p=r.proxyCachedFBO[c.key]?r.proxyCachedFBO[c.key][e]:void 0,h=void 0!==p?r.renderCache[p]:this.pool[u++],d=void 0!==p;if(i.texture=h.tex,d&&!h.dirty){a.push(i.tileID);continue}let f;o.bindFramebuffer.set(h.fb.framebuffer),this.renderedToTile=!1,h.dirty&&(o.clear({color:t.Color.transparent,stencil:0}),h.dirty=!1);for(let t=s.start;t<=s.end;++t){const e=n.style._layers[l[t]];if(e.isHidden(n.transform.zoom))continue;const r=n.style._getLayerSourceCache(e),i=r?this.proxyToSource[c.key][r.id]:[c];if(!i)continue;const s=i;o.viewport.set([0,0,h.fb.width,h.fb.height]),f!==(r?r.id:null)&&(this._setupStencil(h,i,e,r),f=r?r.id:null),n.renderLayer(n,r,e,s)}this.renderedToTile?(h.dirty=!0,a.push(i.tileID)):d||--u,5===u&&(u=0,this.renderToBackBuffer(a))}return this.renderToBackBuffer(a),this.renderingToTexture=!1,o.bindFramebuffer.set(null),o.viewport.set([0,0,n.width,n.height]),s.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return{efficiency:100};let n,o=0,r=0,i=!1;for(let s=0;s<e;++s){const e=t._layers[t.order[s]];this._style.isLayerDraped(e)?(i&&++o,++r):i||(i=!0,n=e.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-o/r),firstUndrapedLayer:n}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter((t=>t.dem)).forEach((e=>{t=Math.min(t,e.dem.tree.minimums[0])})),0===t?t:(t-30)*this._exaggeration}raycast(t,e,n){if(!this._visibleDemTiles)return null;const o=this._visibleDemTiles.filter((t=>t.dem)).map((o=>{const r=o.tileID,i=1<<r.overscaledZ,{x:s,y:a}=r.canonical,l=s/i,u=(s+1)/i,c=a/i,p=(a+1)/i;return{minx:l,miny:c,maxx:u,maxy:p,t:o.dem.tree.raycastRoot(l,c,u,p,t,e,n),tile:o}}));o.sort(((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE)));for(const r of o){if(null==r.t)return null;const o=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,t,e,n);if(null!=o)return o}return null}_createFBO(){const e=this.painter.context,n=e.gl,o=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const r=new t.Texture(e,{width:o[0],height:o[1],data:null},n.RGBA);r.bind(n.LINEAR,n.CLAMP_TO_EDGE);const i=e.createFramebuffer(o[0],o[1],!1);return i.colorAttachment.set(r.texture),i.depthAttachment=new bt(e,i.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,o[0],o[1]),this._stencilRef=0,i.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):i.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:i,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some((t=>{const e=this._style._layers[t],n=e.isHidden(this.painter.transform.zoom);return"custom"===e.type?!n&&e.shouldRedrape():!n&&e.hasTransition()}))}_clearLineLayersFromRenderCache(){let e=!1;for(const t of this._style._getSources())if(t instanceof St){e=!0;break}if(!e)return;const n={};for(let o=0;o<this._style.order.length;++o){const e=this._style._layers[this._style.order[o]],r=this._style._getLayerSourceCache(e);if(r&&!n[r.id]&&!e.isHidden(this.painter.transform.zoom)&&"line"===e.type&&e.widthExpression()instanceof t.ZoomDependentExpression){n[r.id]=!0;for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][r.id];if(e)for(const t of e)this._clearRenderCacheForTile(r.id,t)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n]._source instanceof Tt){t=!0;break}if(!t)return;const e={};for(let n=0;n<this._style.order.length;++n){const t=this._style._layers[this._style.order[n]],o=this._style._getLayerSourceCache(t);if(!o||e[o.id])continue;if(t.isHidden(this.painter.transform.zoom)||"raster"!==t.type)continue;const r=t.paint.get("raster-fade-duration");for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][o.id];if(t)for(const e of t){const t=Rn(o.getTile(e),o.findLoadedParent(e,0),o,this.painter.transform,r);(1!==t.opacity||0!==t.mix)&&this._clearRenderCacheForTile(o.id,e)}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const n=[];let o,r=0,i=this._style._layers[t[r]];for(;!this._style.isLayerDraped(i)&&i.isHidden(this.painter.transform.zoom)&&++r<e;)i=this._style._layers[t[r]];for(;r<e;++r){const e=this._style._layers[t[r]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===o&&(o=r):void 0!==o&&(n.push({start:o,end:r-1}),o=void 0))}void 0!==o&&n.push({start:o,end:r-1}),this._drapedRenderBatches=n}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let n=0;n<t.length;++n){const o=Object.values(t[n]);e.renderCachePool.push(...o)}}return}this._clearRasterLayersFromRenderCache();const n=this.proxyCoords,o=this._tilesDirty;for(let i=n.length-1;i>=0;i--){const r=n[i];if(e.getTileByID(r.key),void 0!==e.proxyCachedFBO[r.key]){const n=t[r.key],i=this.proxyToSource[r.key];let s=0;for(const t in i){const e=i[t],r=n[t];if(!r||r.length!==e.length||e.some(((e,n)=>e!==r[n]||o[t]&&o[t].hasOwnProperty(e.key)))){s=-1;break}++s}for(const t in e.proxyCachedFBO[r.key])e.renderCache[e.proxyCachedFBO[r.key][t]].dirty=s<0||s!==Object.values(n).length}}const r=[...this._drapedRenderBatches];r.sort(((t,e)=>e.end-e.start-(t.end-t.start)));for(const i of r)for(const t of n){if(e.proxyCachedFBO[t.key])continue;let n=e.renderCachePool.pop();void 0===n&&e.renderCache.length<50&&(n=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==n&&(e.proxyCachedFBO[t.key]={},e.proxyCachedFBO[t.key][i.start]=n,e.renderCache[n].dirty=!0)}this._tilesDirty={}}_setupStencil(t,e,n,o){if(!o||!this._sourceTilesOverlap[o.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const r=this.painter.context,i=r.gl;if(e.length<=1)return void(this._overlapStencilType=!1);let s;if(n.isTileClipped())s=e.length,this._overlapStencilMode.test={func:i.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(e[0].overscaledZ>e[e.length-1].overscaledZ))return void(this._overlapStencilType=!1);s=1,this._overlapStencilMode.test={func:i.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+s>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=s,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(e,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,n){const o=this.painter,r=this.painter.context,i=r.gl;o._tileClippingMaskIDs={},r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const s=o.useProgram("clippingMask");for(const a of e){const e=o._tileClippingMaskIDs[a.key]=--n;s.draw(r,i.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:i.ALWAYS,mask:0},e,255,i.KEEP,i.KEEP,i.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Tn(a.projMatrix),"$clipping",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const o=[e.x,e.y,1,1];t.transformMat4$1(o,o,n.pixelMatrixInverse),t.scale$1(o,o,1/o[3]),o[0]/=n.worldSize,o[1]/=n.worldSize;const r=n._camera.position,i=t.mercatorZfromAltitude(1,n.center.lat),s=[r[0],r[1],r[2]/i,0],a=t.subtract([],o.slice(0,3),s);t.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=i,s):null}drawDepth(){const e=this.painter,n=e.context,o=this.proxySourceCache,r=Math.ceil(e.width),i=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===i||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const e=n.gl,o=n.createFramebuffer(r,i,!0);n.activeTexture.set(e.TEXTURE0);const s=new t.Texture(n,{width:r,height:i,data:null},e.RGBA);s.bind(e.NEAREST,e.CLAMP_TO_EDGE),o.colorAttachment.set(s.texture);const a=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,r,i);o.depthAttachment.set(a),this._depthFBO=o,this._depthTexture=s}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,r,i]),function(e,n,o,r){if("globe"===e.transform.projection.name)return;const i=e.context,s=i.gl;i.clear({depth:1});const a=e.useProgram("terrainDepth"),l=new t.DepthMode(s.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const u of r){const e=o.getTile(u),r=_n(u.projMatrix,0);n.setupElevationDraw(e,a),a.draw(i,s.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,r,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(e,this,o,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,e,n){if(t.getSource()instanceof Ot)return this._setupProxiedCoordsForImageSource(t,e,n);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const o=this.proxiedCoords[t.id]=[],r=this.proxyCoords;for(let s=0;s<r.length;s++){const e=r[s],i=this._findTileCoveringTileID(e,t);if(i){const r=this._createProxiedId(e,i,n[e.key]&&n[e.key][t.id]);o.push(r),this.proxyToSource[e.key][t.id]=[r]}}let i=!1;for(let s=0;s<e.length;s++){const r=t.getTile(e[s]);if(!r||!r.hasData())continue;const a=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==r.tileID.canonical.z){const e=this.proxyToSource[a.tileID.key][t.id],s=this._createProxiedId(a.tileID,r,n[a.tileID.key]&&n[a.tileID.key][t.id]);e?e.splice(e.length-1,0,s):this.proxyToSource[a.tileID.key][t.id]=[s],o.push(s),i=!0}}this._sourceTilesOverlap[t.id]=i}_setupProxiedCoordsForImageSource(e,n,o){if(!e.getSource().loaded())return;const r=this.proxiedCoords[e.id]=[],i=this.proxyCoords,s=e.getSource(),a=new t.Point(s.tileID.x,s.tileID.y)._div(1<<s.tileID.z),l=s.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce(((t,e)=>(t.min.x=Math.min(t.min.x,e.x-a.x),t.min.y=Math.min(t.min.y,e.y-a.y),t.max.x=Math.max(t.max.x,e.x-a.x),t.max.y=Math.max(t.max.y,e.y-a.y),t)),{min:new t.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(e,n)=>{const o=e.wrap+e.canonical.x/(1<<e.canonical.z),r=e.canonical.y/(1<<e.canonical.z),i=t.EXTENT/(1<<e.canonical.z),s=n.wrap+n.canonical.x/(1<<n.canonical.z),a=n.canonical.y/(1<<n.canonical.z);return o+i<s+l.min.x||o>s+l.max.x||r+i<a+l.min.y||r>a+l.max.y};for(let t=0;t<i.length;t++){const s=i[t];for(let t=0;t<n.length;t++){const i=e.getTile(n[t]);if(!i||!i.hasData())continue;if(u(s,i.tileID))continue;const a=this._createProxiedId(s,i,o[s.key]&&o[s.key][e.id]),l=this.proxyToSource[s.key][e.id];l?l.push(a):this.proxyToSource[s.key][e.id]=[a],r.push(a)}}}_createProxiedId(e,n,o){let r=this.orthoMatrix;if(o){const t=o.find((t=>t.key===n.tileID.key));if(t)return t}if(n.tileID.key!==e.key){const o=e.canonical.z-n.tileID.canonical.z;let i,s,a;r=t.create();const l=n.tileID.wrap-e.wrap<<e.overscaledZ;o>0?(i=t.EXTENT>>o,s=i*((n.tileID.canonical.x<<o)-e.canonical.x+l),a=i*((n.tileID.canonical.y<<o)-e.canonical.y)):(i=t.EXTENT<<-o,s=t.EXTENT*(n.tileID.canonical.x-(e.canonical.x+l<<-o)),a=t.EXTENT*(n.tileID.canonical.y-(e.canonical.y<<-o))),t.ortho(r,0,i,0,i,0,1),t.translate(r,r,[s,a,0])}return new In(n.tileID,e.key,r)}_findTileCoveringTileID(e,n){let o=n.getTile(e);if(o&&o.hasData())return o;const r=this._findCoveringTileCache[n.id],i=r[e.key];if(o=i?n.getTileByID(i):null,o&&o.hasData()||null===i)return o;let s=o?o.tileID:e,a=s.overscaledZ;const l=n.getSource().minzoom,u=[];if(!i){const r=n.getSource().maxzoom;if(e.canonical.z>=r){const o=e.canonical.z-r;n.getSource().reparseOverscaled?(a=Math.max(e.canonical.z+2,n.transform.tileZoom),s=new t.OverscaledTileID(a,e.wrap,r,e.canonical.x>>o,e.canonical.y>>o)):0!==o&&(a=r,s=new t.OverscaledTileID(a,e.wrap,r,e.canonical.x>>o,e.canonical.y>>o))}s.key!==e.key&&(u.push(s.key),o=n.getTile(s))}const c=t=>{u.forEach((e=>{r[e]=t})),u.length=0};for(a-=1;a>=l&&(!o||!o.hasData());a--){o&&c(o.tileID.key);const t=s.calculateScaledKey(a);if(o=n.getTileByID(t),o&&o.hasData())break;const e=r[t];if(null===e)break;void 0===e?u.push(t):o=n.getTileByID(e)}return c(o?o.tileID.key:null),o&&o.hasData()?o:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,e){let n=this._tilesDirty[t];n||(n=this._tilesDirty[t]={}),n[e.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let n=0;const o=new t.StructArrayLayout2ui4,r=131;for(let t=1;t<129;t++){for(let e=1;e<129;e++)n=t*r+e,o.emplaceBack(n,n+1),o.emplaceBack(n,n+r),o.emplaceBack(n+1,n+r),128===t&&o.emplaceBack(n+r,n+r+1);o.emplaceBack(n+1,n+1+r)}return o}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Dn{static cacheKey(t,e,n,o){let r="".concat(e).concat(o?o.cacheKey:"");for(const i of n)t.usedDefines.includes(i)&&(r+="/".concat(i));return r}constructor(e,n,o,r,i,s){const a=e.gl;this.program=a.createProgram();const l=function(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const o=t[n].split(" ");e.push(o.pop())}return e}(o.staticAttributes),u=r?r.getBinderAttributes():[],c=l.concat(u);let p=r?r.defines():[];p=p.concat(s.map((t=>"#define ".concat(t))));const h=e.isWebGL2?"#version 300 es\n":"",d=h+p.concat(e.extStandardDerivatives&&0===h.length?"#extension GL_OES_standard_derivatives : enable\n".concat(un):un,un,ln,an.fragmentSource,rn.fragmentSource,o.fragmentSource).join("\n"),f=h+p.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ln,an.vertexSource,rn.vertexSource,on.vertexSource,o.vertexSource).join("\n"),g=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(g,d),a.compileShader(g),a.attachShader(this.program,g);const m=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(m,f),a.compileShader(m),a.attachShader(this.program,m),this.attributes={},this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)c[t]&&(a.bindAttribLocation(this.program,t,c[t]),this.attributes[c[t]]=t);a.linkProgram(this.program),a.deleteShader(m),a.deleteShader(g),this.fixedUniforms=i(e),this.binderUniforms=r?r.getUniforms(e):[],s.includes("TERRAIN")&&(this.terrainUniforms=(e=>({u_dem:new t.Uniform1i(e),u_dem_prev:new t.Uniform1i(e),u_dem_unpack:new t.Uniform4f(e),u_dem_tl:new t.Uniform2f(e),u_dem_scale:new t.Uniform1f(e),u_dem_tl_prev:new t.Uniform2f(e),u_dem_scale_prev:new t.Uniform1f(e),u_dem_size:new t.Uniform1f(e),u_dem_lerp:new t.Uniform1f(e),u_exaggeration:new t.Uniform1f(e),u_depth:new t.Uniform1i(e),u_depth_size_inv:new t.Uniform2f(e),u_meter_to_dem:new t.Uniform1f(e),u_label_plane_matrix_inv:new t.UniformMatrix4f(e)}))(e)),s.includes("GLOBE")&&(this.globeUniforms=(e=>({u_tile_tl_up:new t.Uniform3f(e),u_tile_tr_up:new t.Uniform3f(e),u_tile_br_up:new t.Uniform3f(e),u_tile_bl_up:new t.Uniform3f(e),u_tile_up_scale:new t.Uniform1f(e)}))(e)),s.includes("FOG")&&(this.fogUniforms=(e=>({u_fog_matrix:new t.UniformMatrix4f(e),u_fog_range:new t.Uniform2f(e),u_fog_color:new t.Uniform4f(e),u_fog_horizon_blend:new t.Uniform1f(e),u_fog_temporal_offset:new t.Uniform1f(e),u_frustum_tl:new t.Uniform3f(e),u_frustum_tr:new t.Uniform3f(e),u_frustum_br:new t.Uniform3f(e),u_frustum_bl:new t.Uniform3f(e),u_globe_pos:new t.Uniform3f(e),u_globe_radius:new t.Uniform1f(e),u_globe_transition:new t.Uniform1f(e),u_is_globe:new t.Uniform1i(e),u_viewport:new t.Uniform2f(e)}))(e))}}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t]&&n[t].set(this.program,t,e[t])}}setGlobeUniformValues(t,e){if(!this.globeUniforms)return;const n=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t]&&n[t].set(this.program,t,e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(this.program,t,e[t])}}draw(t,e,n,o,r,i,s,a,l,u,c,p,h,d,f){const g=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(o),t.setColorMode(r),t.setCullFace(i);for(const y of Object.keys(this.fixedUniforms))this.fixedUniforms[y].set(this.program,y,s[y]);d&&d.setUniforms(this.program,t,this.binderUniforms,p,{zoom:h});const m={[g.LINES]:2,[g.TRIANGLES]:3,[g.LINE_STRIP]:1}[e];for(const y of c.get()){const n=y.vaos||(y.vaos={});(n[a]||(n[a]=new dn)).bind(t,this,l,d?d.getPaintVertexBuffers():[],u,y.vertexOffset,f||[]),g.drawElements(e,y.primitiveLength*m,g.UNSIGNED_SHORT,y.primitiveOffset*m*2)}}}function Mn(t,e){const n=Math.pow(2,e.tileID.overscaledZ),o=e.tileSize*Math.pow(2,t.transform.tileZoom)/n,r=o*(e.tileID.canonical.x+e.tileID.wrap*n),i=o*e.tileID.canonical.y;return{u_image:0,u_texsize:e.imageAtlasTexture.size,u_tile_units_to_pixels:1/I(e,1,t.transform.tileZoom),u_pixel_coord_upper:[r>>16,i>>16],u_pixel_coord_lower:[65535&r,65535&i]}}const Ln=t.create(),Nn=(e,n,o,r,i,s,a,l,u,c,p)=>{const h=n.style.light,d=h.properties.get("position"),f=[d.x,d.y,d.z],g=t.create$1();"viewport"===h.properties.get("anchor")&&(t.fromRotation(g,-n.transform.angle),t.transformMat3(f,f,g));const m=h.properties.get("color"),y=n.transform,v={u_matrix:e,u_lightpos:f,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[m.r,m.g,m.b],u_vertical_gradient:+o,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ln,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:i,u_edge_radius:s};return"globe"===y.projection.name&&(v.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],v.u_zoom_transition=u,v.u_inv_rot_matrix=p,v.u_merc_center=c,v.u_up_dir=y.projection.upVector(new t.CanonicalTileID(0,0,0),c[0]*t.EXTENT,c[1]*t.EXTENT),v.u_height_lift=l),v},Fn=(e,n,o,r,i,s,a,l,u,c,p,h)=>{const d=Nn(e,n,o,r,i,s,a,u,c,p,h),f={u_height_factor:-Math.pow(2,a.overscaledZ)/l.tileSize/8};return t.extend(d,Mn(n,l),f)},kn=t=>({u_matrix:t}),Gn=(e,n,o)=>t.extend(kn(e),Mn(n,o)),Bn=(t,e)=>({u_matrix:t,u_world:e}),Vn=(e,n,o,r)=>t.extend(Gn(e,n,o),{u_world:r}),zn=t.create(),jn=(e,n,o,r,i,s)=>{const a=e.transform,l="globe"===a.projection.name;let u;if("map"===s.paint.get("circle-pitch-alignment"))if(l){const e=t.globePixelsToTileUnits(a.zoom,n.canonical)*a._pixelsPerMercatorPixel;u=Float32Array.from([e,0,0,e])}else u=a.calculatePixelsToTileUnitsMatrix(o);else u=new Float32Array([a.pixelsToGLUnits[0],0,0,a.pixelsToGLUnits[1]]);const c={u_camera_to_center_distance:a.cameraToCenterDistance,u_matrix:e.translatePosMatrix(n.projMatrix,o,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:u,u_inv_rot_matrix:zn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(l){c.u_inv_rot_matrix=r,c.u_merc_center=i,c.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],c.u_zoom_transition=t.globeToMercatorTransition(a.zoom);const e=i[0]*t.EXTENT,o=i[1]*t.EXTENT;c.u_up_dir=a.projection.upVector(new t.CanonicalTileID(0,0,0),e,o)}return c},Hn=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},Un=(e,n,o,r)=>{const i=t.EXTENT/o.tileSize;return{u_matrix:e,u_camera_to_center_distance:n.getCameraToCenterDistance(r),u_extrude_scale:[n.pixelsToGLUnits[0]/i,n.pixelsToGLUnits[1]/i]}},Wn=function(t,e){return{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},qn=t.create(),Xn=(e,n,o,r,i,s,a)=>{const l=e.transform,u="globe"===l.projection.name,c=u?t.globePixelsToTileUnits(l.zoom,n.canonical)*l._pixelsPerMercatorPixel:I(o,1,s),p={u_matrix:n.projMatrix,u_extrude_scale:c,u_intensity:a,u_inv_rot_matrix:qn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){p.u_inv_rot_matrix=r,p.u_merc_center=i,p.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],p.u_zoom_transition=t.globeToMercatorTransition(l.zoom);const e=i[0]*t.EXTENT,o=i[1]*t.EXTENT;p.u_up_dir=l.projection.upVector(new t.CanonicalTileID(0,0,0),e,o)}return p},Yn=(t,e,n,o,r,i,s)=>{const a=t.transform,l=a.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:Jn(t,e,n,o),u_pixels_to_tile_units:l,u_device_pixel_ratio:i,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:r,u_texsize:Qn(n)?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Zn(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:s}},Kn=(t,e,n,o,r)=>{const i=t.transform;return{u_matrix:Jn(t,e,n,o),u_texsize:e.imageAtlasTexture.size,u_pixels_to_tile_units:i.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:r,u_image:0,u_tile_units_to_pixels:Zn(e,i),u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Zn(t,e){return 1/I(t,1,e.tileZoom)}function Jn(t,e,n,o){return t.translatePosMatrix(o||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}function Qn(t){const e=t.paint.get("line-dasharray").value;return e.value||"constant"!==e.kind}const $n=(t,e,n,o,r,i)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_fade_t:o.mix,u_opacity:o.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(s=r.paint.get("raster-contrast"),s>0?1/(1-s):1+s),u_spin_weights:to(r.paint.get("raster-hue-rotate")),u_perspective_transform:i};var s,a};function to(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const eo=t.create(),no=(e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m)=>{const y=i.transform,v={u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:y.cameraToCenterDistance,u_rotate_symbol:+o,u_aspect_ratio:y.width/y.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:eo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:eo,u_up_vector:[0,-1,0]};return"globe"===m.name&&(v.u_tile_id=[p.canonical.x,p.canonical.y,1<<p.canonical.z],v.u_zoom_transition=h,v.u_inv_rot_matrix=f,v.u_merc_center=d,v.u_camera_forward=y._camera.forward(),v.u_ecef_origin=t.globeECEFOrigin(y.globeMatrix,p.toUnwrapped()),v.u_tile_matrix=Float32Array.from(y.globeMatrix),v.u_up_vector=g),v},oo=(e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m,y)=>t.extend(no(e,n,o,r,i,s,a,l,u,c,h,d,f,g,m,y),{u_gamma_scale:r?i.transform.cameraToCenterDistance*Math.cos(i.terrain?0:i.transform._pitch):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+p}),ro=(e,n,o,r,i,s,a,l,u,c,p,h,d,f,g,m)=>t.extend(oo(e,n,o,r,i,s,a,l,!0,u,!0,p,h,d,f,g,m),{u_texsize_icon:c,u_texture_icon:1}),io=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),so=(e,n,o,r,i)=>t.extend(function(t,e,n){const o=e.imageManager.getPattern(t.toString()),{width:r,height:i}=e.imageManager.getPixelSize(),s=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,e.transform.tileZoom)/s,l=a*(n.tileID.canonical.x+n.tileID.wrap*s),u=a*n.tileID.canonical.y;return{u_image:0,u_pattern_tl:o.tl,u_pattern_br:o.br,u_texsize:[r,i],u_pattern_size:o.displaySize,u_tile_units_to_pixels:1/I(n,1,e.transform.tileZoom),u_pixel_coord_upper:[l>>16,u>>16],u_pixel_coord_lower:[65535&l,65535&u]}}(r,o,i),{u_matrix:e,u_opacity:n}),ao={fillExtrusion:e=>({u_matrix:new t.UniformMatrix4f(e),u_lightpos:new t.Uniform3f(e),u_lightintensity:new t.Uniform1f(e),u_lightcolor:new t.Uniform3f(e),u_vertical_gradient:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e),u_edge_radius:new t.Uniform1f(e),u_ao:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_up_dir:new t.Uniform3f(e),u_height_lift:new t.Uniform1f(e)}),fillExtrusionPattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_lightpos:new t.Uniform3f(e),u_lightintensity:new t.Uniform1f(e),u_lightcolor:new t.Uniform3f(e),u_vertical_gradient:new t.Uniform1f(e),u_height_factor:new t.Uniform1f(e),u_edge_radius:new t.Uniform1f(e),u_ao:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_up_dir:new t.Uniform3f(e),u_height_lift:new t.Uniform1f(e),u_image:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e)}),fill:e=>({u_matrix:new t.UniformMatrix4f(e)}),fillPattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_image:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e)}),fillOutline:e=>({u_matrix:new t.UniformMatrix4f(e),u_world:new t.Uniform2f(e)}),fillOutlinePattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_world:new t.Uniform2f(e),u_image:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e)}),circle:e=>({u_camera_to_center_distance:new t.Uniform1f(e),u_extrude_scale:new t.UniformMatrix2f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_up_dir:new t.Uniform3f(e)}),collisionBox:e=>({u_matrix:new t.UniformMatrix4f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_extrude_scale:new t.Uniform2f(e)}),collisionCircle:e=>({u_matrix:new t.UniformMatrix4f(e),u_inv_matrix:new t.UniformMatrix4f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_viewport_size:new t.Uniform2f(e)}),debug:e=>({u_color:new t.UniformColor(e),u_matrix:new t.UniformMatrix4f(e),u_overlay:new t.Uniform1i(e),u_overlay_scale:new t.Uniform1f(e)}),clippingMask:e=>({u_matrix:new t.UniformMatrix4f(e)}),heatmap:e=>({u_extrude_scale:new t.Uniform1f(e),u_intensity:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_up_dir:new t.Uniform3f(e)}),heatmapTexture:e=>({u_image:new t.Uniform1i(e),u_color_ramp:new t.Uniform1i(e),u_opacity:new t.Uniform1f(e)}),hillshade:e=>({u_matrix:new t.UniformMatrix4f(e),u_image:new t.Uniform1i(e),u_latrange:new t.Uniform2f(e),u_light:new t.Uniform2f(e),u_shadow:new t.UniformColor(e),u_highlight:new t.UniformColor(e),u_accent:new t.UniformColor(e)}),hillshadePrepare:e=>({u_matrix:new t.UniformMatrix4f(e),u_image:new t.Uniform1i(e),u_dimension:new t.Uniform2f(e),u_zoom:new t.Uniform1f(e),u_unpack:new t.Uniform4f(e)}),line:e=>({u_matrix:new t.UniformMatrix4f(e),u_pixels_to_tile_units:new t.UniformMatrix2f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_units_to_pixels:new t.Uniform2f(e),u_dash_image:new t.Uniform1i(e),u_gradient_image:new t.Uniform1i(e),u_image_height:new t.Uniform1f(e),u_texsize:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e),u_alpha_discard_threshold:new t.Uniform1f(e),u_trim_offset:new t.Uniform2f(e)}),linePattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_texsize:new t.Uniform2f(e),u_pixels_to_tile_units:new t.UniformMatrix2f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_image:new t.Uniform1i(e),u_units_to_pixels:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e),u_alpha_discard_threshold:new t.Uniform1f(e)}),raster:e=>({u_matrix:new t.UniformMatrix4f(e),u_tl_parent:new t.Uniform2f(e),u_scale_parent:new t.Uniform1f(e),u_fade_t:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e),u_image0:new t.Uniform1i(e),u_image1:new t.Uniform1i(e),u_brightness_low:new t.Uniform1f(e),u_brightness_high:new t.Uniform1f(e),u_saturation_factor:new t.Uniform1f(e),u_contrast_factor:new t.Uniform1f(e),u_spin_weights:new t.Uniform3f(e),u_perspective_transform:new t.Uniform2f(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new t.Uniform1i(e),u_is_size_feature_constant:new t.Uniform1i(e),u_size_t:new t.Uniform1f(e),u_size:new t.Uniform1f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_rotate_symbol:new t.Uniform1i(e),u_aspect_ratio:new t.Uniform1f(e),u_fade_change:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_label_plane_matrix:new t.UniformMatrix4f(e),u_coord_matrix:new t.UniformMatrix4f(e),u_is_text:new t.Uniform1i(e),u_pitch_with_map:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_camera_forward:new t.Uniform3f(e),u_tile_matrix:new t.UniformMatrix4f(e),u_up_vector:new t.Uniform3f(e),u_ecef_origin:new t.Uniform3f(e),u_texture:new t.Uniform1i(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new t.Uniform1i(e),u_is_size_feature_constant:new t.Uniform1i(e),u_size_t:new t.Uniform1f(e),u_size:new t.Uniform1f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_rotate_symbol:new t.Uniform1i(e),u_aspect_ratio:new t.Uniform1f(e),u_fade_change:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_label_plane_matrix:new t.UniformMatrix4f(e),u_coord_matrix:new t.UniformMatrix4f(e),u_is_text:new t.Uniform1i(e),u_pitch_with_map:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_texture:new t.Uniform1i(e),u_gamma_scale:new t.Uniform1f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_tile_id:new t.Uniform3f(e),u_zoom_transition:new t.Uniform1f(e),u_inv_rot_matrix:new t.UniformMatrix4f(e),u_merc_center:new t.Uniform2f(e),u_camera_forward:new t.Uniform3f(e),u_tile_matrix:new t.UniformMatrix4f(e),u_up_vector:new t.Uniform3f(e),u_ecef_origin:new t.Uniform3f(e),u_is_halo:new t.Uniform1i(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new t.Uniform1i(e),u_is_size_feature_constant:new t.Uniform1i(e),u_size_t:new t.Uniform1f(e),u_size:new t.Uniform1f(e),u_camera_to_center_distance:new t.Uniform1f(e),u_rotate_symbol:new t.Uniform1i(e),u_aspect_ratio:new t.Uniform1f(e),u_fade_change:new t.Uniform1f(e),u_matrix:new t.UniformMatrix4f(e),u_label_plane_matrix:new t.UniformMatrix4f(e),u_coord_matrix:new t.UniformMatrix4f(e),u_is_text:new t.Uniform1i(e),u_pitch_with_map:new t.Uniform1i(e),u_texsize:new t.Uniform2f(e),u_texsize_icon:new t.Uniform2f(e),u_texture:new t.Uniform1i(e),u_texture_icon:new t.Uniform1i(e),u_gamma_scale:new t.Uniform1f(e),u_device_pixel_ratio:new t.Uniform1f(e),u_is_halo:new t.Uniform1i(e)}),background:e=>({u_matrix:new t.UniformMatrix4f(e),u_opacity:new t.Uniform1f(e),u_color:new t.UniformColor(e)}),backgroundPattern:e=>({u_matrix:new t.UniformMatrix4f(e),u_opacity:new t.Uniform1f(e),u_image:new t.Uniform1i(e),u_pattern_tl:new t.Uniform2f(e),u_pattern_br:new t.Uniform2f(e),u_texsize:new t.Uniform2f(e),u_pattern_size:new t.Uniform2f(e),u_pixel_coord_upper:new t.Uniform2f(e),u_pixel_coord_lower:new t.Uniform2f(e),u_tile_units_to_pixels:new t.Uniform1f(e)}),terrainRaster:vn,terrainDepth:vn,skybox:e=>({u_matrix:new t.UniformMatrix4f(e),u_sun_direction:new t.Uniform3f(e),u_cubemap:new t.Uniform1i(e),u_opacity:new t.Uniform1f(e),u_temporal_offset:new t.Uniform1f(e)}),skyboxGradient:e=>({u_matrix:new t.UniformMatrix4f(e),u_color_ramp:new t.Uniform1i(e),u_center_direction:new t.Uniform3f(e),u_radius:new t.Uniform1f(e),u_opacity:new t.Uniform1f(e),u_temporal_offset:new t.Uniform1f(e)}),skyboxCapture:e=>({u_matrix_3f:new t.UniformMatrix3f(e),u_sun_direction:new t.Uniform3f(e),u_sun_intensity:new t.Uniform1f(e),u_color_tint_r:new t.Uniform4f(e),u_color_tint_m:new t.Uniform4f(e),u_luminance:new t.Uniform1f(e)}),globeRaster:e=>({u_proj_matrix:new t.UniformMatrix4f(e),u_globe_matrix:new t.UniformMatrix4f(e),u_normalize_matrix:new t.UniformMatrix4f(e),u_merc_matrix:new t.UniformMatrix4f(e),u_zoom_transition:new t.Uniform1f(e),u_merc_center:new t.Uniform2f(e),u_image0:new t.Uniform1i(e),u_grid_matrix:new t.UniformMatrix3f(e),u_skirt_height:new t.Uniform1f(e),u_frustum_tl:new t.Uniform3f(e),u_frustum_tr:new t.Uniform3f(e),u_frustum_br:new t.Uniform3f(e),u_frustum_bl:new t.Uniform3f(e),u_globe_pos:new t.Uniform3f(e),u_globe_radius:new t.Uniform1f(e),u_viewport:new t.Uniform2f(e)}),globeAtmosphere:e=>({u_frustum_tl:new t.Uniform3f(e),u_frustum_tr:new t.Uniform3f(e),u_frustum_br:new t.Uniform3f(e),u_frustum_bl:new t.Uniform3f(e),u_horizon:new t.Uniform1f(e),u_transition:new t.Uniform1f(e),u_fadeout_range:new t.Uniform1f(e),u_color:new t.Uniform4f(e),u_high_color:new t.Uniform4f(e),u_space_color:new t.Uniform4f(e),u_star_intensity:new t.Uniform1f(e),u_star_density:new t.Uniform1f(e),u_star_size:new t.Uniform1f(e),u_temporal_offset:new t.Uniform1f(e),u_horizon_angle:new t.Uniform1f(e),u_rotation_matrix:new t.UniformMatrix4f(e)})};let lo;function uo(e,n,o,r,i,s,a){const l=e.context,u=l.gl,c=e.transform,p=e.useProgram("collisionBox"),h=[];let d=0,f=0;for(let w=0;w<r.length;w++){const g=r[w],m=n.getTile(g),y=m.getBucket(o);if(!y)continue;const v=ve(g,y,c);let _=v;0===i[0]&&0===i[1]||(_=e.translatePosMatrix(v,m,i,s));const C=a?y.textCollisionBox:y.iconCollisionBox,b=y.collisionCircleArray;if(b.length>0){const e=t.create(),n=_;t.mul(e,y.placementInvProjMatrix,c.glCoordMatrix),t.mul(e,e,y.placementViewportMatrix),h.push({circleArray:b,circleOffset:f,transform:n,invTransform:e,projection:y.getProjection()}),d+=b.length/4,f=d}C&&(e.terrain&&e.terrain.setupElevationDraw(m,p),p.draw(l,u.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,Un(_,c,m,y.getProjection()),o.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,null,c.zoom,null,[C.collisionVertexBuffer,C.collisionVertexBufferExt]))}if(!a||!h.length)return;const g=e.useProgram("collisionCircle"),m=new t.StructArrayLayout2f1f2i16;m.resize(4*d),m._trim();let y=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,o=t.circleArray[n+0],r=t.circleArray[n+1],i=t.circleArray[n+2],s=t.circleArray[n+3];m.emplace(y++,o,r,i,s,0),m.emplace(y++,o,r,i,s,1),m.emplace(y++,o,r,i,s,2),m.emplace(y++,o,r,i,s,3)}(!lo||lo.length<2*d)&&(lo=function(e){const n=2*e,o=new t.StructArrayLayout3ui6;o.resize(n),o._trim();for(let t=0;t<n;t++){const e=6*t;o.uint16[e+0]=4*t+0,o.uint16[e+1]=4*t+1,o.uint16[e+2]=4*t+2,o.uint16[e+3]=4*t+2,o.uint16[e+4]=4*t+3,o.uint16[e+5]=4*t+0}return o}(d));const v=l.createIndexBuffer(lo,!0),_=l.createVertexBuffer(m,t.collisionCircleLayout.members,!0);for(const w of h){const n={u_matrix:w.transform,u_inv_matrix:w.invTransform,u_camera_to_center_distance:(C=c).getCameraToCenterDistance(w.projection),u_viewport_size:[C.width,C.height]};g.draw(l,u.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,n,o.id,_,v,t.SegmentVector.simpleSegment(0,2*w.circleOffset,w.circleArray.length,w.circleArray.length/2),null,c.zoom)}var C;_.destroy(),v.destroy()}const co=t.create();function po(e,n){let{width:o,height:r,anchor:i,textOffset:s,textScale:a}=e;const{horizontalAlign:l,verticalAlign:u}=t.getAnchorAlignment(i),c=-(l-.5)*o,p=-(u-.5)*r,h=t.evaluateVariableOffset(i,s);return new t.Point((c/a+h[0])*n,(p/a+h[1])*n)}function ho(e,n,o,r,i,s,a,l,u,c,p){const h=e.text.placedSymbolArray,d=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,g={},m=e.getProjection(),y=_e(l,m,s),v=s.elevation,_=m.upVectorScale(l.canonical,s.center.lat,s.worldSize).metersToTile;d.clear();for(let C=0;C<h.length;C++){const f=h.get(C),{tileAnchorX:w,tileAnchorY:b,numGlyphs:x}=f,E=f.hidden||!f.crossTileID||e.allowVerticalPlacement&&!f.placedOrientation?null:r[f.crossTileID];if(E){let r=0,h=0,C=0;if(v){const t=v?v.getAtTileOffset(l,w,b):0,[e,n,o]=m.upVector(l.canonical,w,b);r=t*e*_,h=t*n*_,C=t*o*_}let[S,T,R,O]=oe(f.projectedAnchorX+r,f.projectedAnchorY+h,f.projectedAnchorZ+C,o?y:a);const P=re(s.getCameraToCenterDistance(m),O);let I=i.evaluateSizeForFeature(e.textSizeData,c,f)*P/t.ONE_EM;o&&(I*=e.tilePixelRatio/u);const A=po(E,I);o?(({x:S,y:T,z:R}=m.projectTilePoint(w+A.x,b+A.y,l.canonical)),[S,T,R]=oe(S+r,T+h,R+C,a)):(n&&A._rotate(-s.angle),S+=A.x,T+=A.y,R=0);const D=e.allowVerticalPlacement&&f.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<x;e++)t.addDynamicAttributes(d,S,T,R,D);p&&f.associatedIconIndex>=0&&(g[f.associatedIconIndex]={x:S,y:T,z:R,angle:D})}else de(x,d)}if(p){f.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const o=n.get(e),{numGlyphs:r}=o,i=g[e];if(o.hidden||!i)de(r,f);else{const{x:e,y:n,z:o,angle:s}=i;for(let i=0;i<r;i++)t.addDynamicAttributes(f,e,n,o,s)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(d)}function fo(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function go(e,n,o,r,i,s,a,l,u,c,p,h){const d=e.context,f=d.gl,g=e.transform,m="map"===l,y="map"===u,v=m&&"point"!==o.layout.get("symbol-placement"),_=m&&!y&&!v,C=void 0!==o.layout.get("symbol-sort-key").constantOr(1);let w=!1;const b=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),x=[t.mercatorXfromLng(g.center.lng),t.mercatorYfromLat(g.center.lat)],E=o.layout.get("text-variable-anchor"),S="globe"===g.projection.name,T=[],R=[0,-1,0];let O=R;!S&&!g.mercatorFromTransition||m||(O=function(e){const n=e._camera.getWorldToCamera(e.worldSize,1),o=t.multiply([],n,e.globeMatrix);t.invert(o,o);const r=[0,0,0],i=[0,1,0,0];return t.transformMat4$1(i,i,o),r[0]=i[0],r[1]=i[1],r[2]=i[2],t.normalize(r,r),r}(g));for(const P of r){const r=n.getTile(P),l=r.getBucket(o);if(!l)continue;if("mercator"===l.projection.name&&S)continue;const u=i?l.text:l.icon;if(!u||l.fullyClipped||!u.segments.get().length)continue;const p=u.programConfigurations.get(o.id),h=i||l.sdfIcons,d=i?l.textSizeData:l.iconSizeData,b=y||0!==g.pitch,I=t.evaluateSizeForZoom(d,g.zoom);let A,D,M,L,N=[0,0],F=null;if(i)D=r.glyphAtlasTexture,M=f.LINEAR,A=r.glyphAtlasTexture.size,l.iconsInText&&(N=r.imageAtlasTexture.size,F=r.imageAtlasTexture,L=b||e.options.rotating||e.options.zooming||"composite"===d.kind||"camera"===d.kind?f.LINEAR:f.NEAREST);else{const t=1!==o.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;D=r.imageAtlasTexture,M=h||e.options.rotating||e.options.zooming||t||b?f.LINEAR:f.NEAREST,A=r.imageAtlasTexture.size}const k="globe"===l.projection.name,G=k?O:R,B=k?t.globeToMercatorTransition(g.zoom):0,V=_e(P,l.getProjection(),g),z=g.calculatePixelsToTileUnitsMatrix(r),j=te(V,r.tileID.canonical,y,m,g,l.getProjection(),z),H=e.terrain&&y&&v?t.invert(t.create(),j):co,U=ne(V,r.tileID.canonical,y,m,g,l.getProjection(),z),W=E&&l.hasTextData(),q="none"!==o.layout.get("icon-text-fit")&&W&&l.hasIconData();if(v){const t=g.elevation,n=t?t.getAtTileOffsetFunc(P,g.center.lat,g.worldSize,l.getProjection()):null,o=ee(V,r.tileID.canonical,y,m,g,l.getProjection(),z);se(l,V,e,i,o,U,y,c,n,P)}const X=v||i&&E||q,Y=e.translatePosMatrix(V,r,s,a),K=X?co:j,Z=e.translatePosMatrix(U,r,s,a,!0),J=l.getProjection().createInversionMatrix(g,P.canonical),Q=[];e.terrainRenderModeElevated()&&y&&Q.push("PITCH_WITH_MAP_TERRAIN"),k&&Q.push("PROJECTION_GLOBE_VIEW"),X&&Q.push("PROJECTED_POS_ON_VIEWPORT");const $=h&&0!==o.paint.get(i?"text-halo-width":"icon-halo-width").constantOr(1);let tt;tt=h?l.iconsInText?ro(d.kind,I,_,y,e,Y,K,Z,A,N,P,B,x,J,G,l.getProjection()):oo(d.kind,I,_,y,e,Y,K,Z,i,A,!0,P,B,x,J,G,l.getProjection()):no(d.kind,I,_,y,e,Y,K,Z,i,A,P,B,x,J,G,l.getProjection());const et={program:e.useProgram(fo(h,i,l),p,Q),buffers:u,uniformValues:tt,atlasTexture:D,atlasTextureIcon:F,atlasInterpolation:M,atlasInterpolationIcon:L,isSDF:h,hasHalo:$,tile:r,labelPlaneMatrixInv:H};if(C&&l.canOverlap){w=!0;const e=u.segments.get();for(const n of e)T.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:et})}else T.push({segments:u.segments,sortKey:0,state:et})}w&&T.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of T){const n=t.state;if(e.terrain&&e.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!S,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),d.activeTexture.set(f.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,f.CLAMP_TO_EDGE),n.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,mo(n.buffers,t.segments,o,e,n.program,b,p,h,r)),r.u_is_halo=0}mo(n.buffers,t.segments,o,e,n.program,b,p,h,n.uniformValues)}}function mo(e,n,o,r,i,s,a,l,u){const c=r.context,p=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.globeExtVertexBuffer];i.draw(c,c.gl.TRIANGLES,s,a,l,t.CullFaceMode.disabled,u,o.id,e.layoutVertexBuffer,e.indexBuffer,n,o.paint,r.transform.zoom,e.programConfigurations.get(o.id),p)}function yo(e,n,o,r,i,s,a){const l=e.context.gl,u=o.paint.get("fill-pattern"),c=u&&u.constantOr(1);let p,h,d,f,g;a?(h=c&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=l.LINES):(h=c?"fillPattern":"fill",p=l.TRIANGLES);for(const m of r){const r=n.getTile(m);if(c&&!r.patternsLoaded())continue;const y=r.getBucket(o);if(!y)continue;e.prepareDrawTile();const v=y.programConfigurations.get(o.id),_=e.useProgram(h,v);c&&(e.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers());const C=u.constantOr(null);if(C&&r.imageAtlas){const t=r.imageAtlas.patternPositions[C.toString()];t&&v.setConstantPatternPositions(t)}const w=e.translatePosMatrix(m.projMatrix,r,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(a){f=y.indexBuffer2,g=y.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];d="fillOutlinePattern"===h&&c?Vn(w,e,r,t):Bn(w,t)}else f=y.indexBuffer,g=y.segments,d=c?Gn(w,e,r):kn(w);e.prepareDrawProgram(e.context,_,m.toUnwrapped()),_.draw(e.context,p,i,e.stencilModeForClipping(m),s,t.CullFaceMode.disabled,d,o.id,y.layoutVertexBuffer,f,g,o.paint,e.transform.zoom,v)}}function vo(e,n,o,r,i,s,a){const l=e.context,u=l.gl,c=e.transform,p=o.paint.get("fill-extrusion-pattern"),h=p.constantOr(1),d=o.paint.get("fill-extrusion-opacity"),f=[o.paint.get("fill-extrusion-ambient-occlusion-intensity"),o.paint.get("fill-extrusion-ambient-occlusion-radius")],g=o.layout.get("fill-extrusion-edge-radius"),m=g>0&&!o.paint.get("fill-extrusion-rounded-roof"),y=m?0:g,v="globe"===c.projection.name?t.fillExtrusionHeightLift():0,_="globe"===c.projection.name,C=_?t.globeToMercatorTransition(c.zoom):0,w=[t.mercatorXfromLng(c.center.lng),t.mercatorYfromLat(c.center.lat)],b=[];_&&b.push("PROJECTION_GLOBE_VIEW"),f[0]>0&&b.push("FAUX_AO"),m&&b.push("ZERO_ROOF_RADIUS");for(const x of r){const r=n.getTile(x),g=r.getBucket(o);if(!g||g.projection.name!==c.projection.name)continue;const m=g.programConfigurations.get(o.id),E=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",m,b);if(e.terrain){const t=e.terrain;if(e.style.terrainSetForDrapingOnly())t.setupElevationDraw(r,E,{useMeterToDem:!0});else{if(!g.enableTerrain)continue;if(t.setupElevationDraw(r,E,{useMeterToDem:!0}),_o(l,n,x,g,o,t),!g.centroidVertexBuffer){const t=E.attributes.a_centroid_pos;void 0!==t&&u.vertexAttrib2f(t,0,0)}}}h&&(e.context.activeTexture.set(u.TEXTURE0),r.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),m.updatePaintBuffers());const S=p.constantOr(null);if(S&&r.imageAtlas){const t=r.imageAtlas.patternPositions[S.toString()];t&&m.setConstantPatternPositions(t)}const T=e.translatePosMatrix(x.projMatrix,r,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),R=c.projection.createInversionMatrix(c,x.canonical),O=o.paint.get("fill-extrusion-vertical-gradient"),P=h?Fn(T,e,O,d,f,y,x,r,v,C,w,R):Nn(T,e,O,d,f,y,x,v,C,w,R);e.prepareDrawProgram(l,E,x.toUnwrapped());const I=[];e.terrain&&I.push(g.centroidVertexBuffer),_&&I.push(g.layoutVertexExtBuffer),E.draw(l,l.gl.TRIANGLES,i,s,a,t.CullFaceMode.backCCW,P,o.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,o.paint,e.transform.zoom,m,I)}}function _o(e,n,o,r,i,s){const a=[e=>{let n=e.canonical.x-1,o=e.wrap;return n<0&&(n=(1<<e.canonical.z)-1,o--),new t.OverscaledTileID(e.overscaledZ,o,e.canonical.z,n,e.canonical.y)},e=>{let n=e.canonical.x+1,o=e.wrap;return n===1<<e.canonical.z&&(n=0,o++),new t.OverscaledTileID(e.overscaledZ,o,e.canonical.z,n,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=n.getSource().minzoom,o=t=>{const e=n.getTileByID(t);if(e&&e.hasData())return e.getBucket(i)},r=[0,-1,1];for(const n of r){if(t.overscaledZ+n<e)continue;const r=o(t.calculateScaledKey(t.overscaledZ+n));if(r)return r}},u=[0,0,0],c=(e,n)=>(u[0]=Math.min(e.min.y,n.min.y),u[1]=Math.max(e.max.y,n.max.y),u[2]=t.EXTENT-n.min.x>e.max.x?n.min.x-t.EXTENT:e.max.x,u),p=(e,n)=>(u[0]=Math.min(e.min.x,n.min.x),u[1]=Math.max(e.max.x,n.max.x),u[2]=t.EXTENT-n.min.y>e.max.y?n.min.y-t.EXTENT:e.max.y,u),h=[(t,e)=>c(t,e),(t,e)=>c(e,t),(t,e)=>p(t,e),(t,e)=>p(e,t)],d=new t.Point(0,0);let f,g,m;const y=(e,n,r,i,a)=>{const l=[[i?r:e,i?e:r,0],[i?r:n,i?n:r,0]],u=a<0?t.EXTENT+a:a,c=[i?u:(e+n)/2,i?(e+n)/2:u,0];return 0===r&&a<0||0!==r&&a>0?s.getForTilePoints(m,[c],!0,g):l.push(c),s.getForTilePoints(o,l,!0,f),Math.max(l[0][2],l[1][2],c[2])/s.exaggeration()};for(let v=0;v<4;v++){const e=(v<2?1:5)-v,n=r.borders[v];if(0===n.length)continue;const i=m=a[v](o),u=l(i);if(!(u&&u instanceof t.FillExtrusionBucket&&u.enableTerrain))continue;if(r.borderDoneWithNeighborZ[v]===u.canonical.z&&u.borderDoneWithNeighborZ[e]===r.canonical.z)continue;if(g=s.findDEMTileFor(i),!g||!g.dem)continue;if(!f){const t=s.findDEMTileFor(o);if(!t||!t.dem)return;f=t}const c=u.borders[e];let p=0;const _=u.borderDoneWithNeighborZ[e]!==r.canonical.z;if(r.canonical.z===u.canonical.z){for(let o=0;o<n.length;o++){const i=r.featuresOnBorder[n[o]],s=i.borders[v];let a;for(;p<c.length&&(a=u.featuresOnBorder[c[p]],!(a.borders[e][1]>s[0]+3));)_&&u.encodeCentroid(void 0,a,!1),p++;if(a&&p<c.length){const n=p;let o=0;for(;!(a.borders[e][0]>s[1]-3)&&(o++,++p!==c.length);)a=u.featuresOnBorder[c[p]];if(a=u.featuresOnBorder[c[n]],i.intersectsCount()>1||a.intersectsCount()>1||1!==o){1!==o&&(p=n),r.encodeCentroid(void 0,i,!1),_&&u.encodeCentroid(void 0,a,!1);continue}const l=h[v](i,a),f=v%2?t.EXTENT-1:0;d.x=y(l[0],Math.min(t.EXTENT-1,l[1]),f,v<2,l[2]),d.y=0,r.encodeCentroid(d,i,!1),_&&u.encodeCentroid(d,a,!1)}else r.encodeCentroid(void 0,i,!1)}r.borderDoneWithNeighborZ[v]=u.canonical.z,r.needsCentroidUpdate=!0,_&&(u.borderDoneWithNeighborZ[e]=r.canonical.z,u.needsCentroidUpdate=!0)}else{for(const t of n)r.encodeCentroid(void 0,r.featuresOnBorder[t],!1);if(_){for(const t of c)u.encodeCentroid(void 0,u.featuresOnBorder[t],!1);u.borderDoneWithNeighborZ[e]=r.canonical.z,u.needsCentroidUpdate=!0}r.borderDoneWithNeighborZ[v]=u.canonical.z,r.needsCentroidUpdate=!0}}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(e)}const Co=new t.Color(1,0,0,1),wo=new t.Color(0,1,0,1),bo=new t.Color(0,0,1,1),xo=new t.Color(1,0,1,1),Eo=new t.Color(0,1,1,1);function So(e,n,o){const r=e.context,i=e.transform,s=r.gl,a="globe"===i.projection.name,l=a?["PROJECTION_GLOBE_VIEW"]:null;let u=o.projMatrix;if(a&&t.globeToMercatorTransition(i.zoom)>0){const e=t.transitionTileAABBinECEF(o.canonical,i),n=t.globeDenormalizeECEF(e);u=t.multiply(new Float32Array(16),i.globeMatrix,n),t.multiply(u,i.projMatrix,u)}const c=e.useProgram("debug",null,l),p=n.getTileByID(o.key);e.terrain&&e.terrain.setupElevationDraw(p,c);const h=t.DepthMode.disabled,d=t.StencilMode.disabled,f=e.colorModeForRenderPass(),g="$debug";r.activeTexture.set(s.TEXTURE0),e.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),a?p._makeGlobeTileDebugBuffers(e.context,i):p._makeDebugTileBoundsBuffers(e.context,i.projection);const m=p._tileDebugBuffer||e.debugBuffer,y=p._tileDebugIndexBuffer||e.debugIndexBuffer,v=p._tileDebugSegments||e.debugSegments;c.draw(r,s.LINE_STRIP,h,d,f,t.CullFaceMode.disabled,Wn(u,t.Color.red),g,m,y,v,null,null,null,[p._globeTileDebugBorderBuffer]);const _=p.latestRawTileData,C=Math.floor((_&&_.byteLength||0)/1024),w=n.getTile(o).tileSize,b=512/Math.min(w,512)*(o.overscaledZ/i.zoom)*.5;let x=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(x+=" => ".concat(o.overscaledZ)),x+=" ".concat(C,"kb"),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,o=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}(e,x);const E=p._tileDebugTextBuffer||e.debugBuffer,S=p._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,T=p._tileDebugTextSegments||e.debugSegments;c.draw(r,s.TRIANGLES,h,d,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Wn(u,t.Color.transparent,b),g,E,S,T,null,null,null,[p._globeTileDebugTextBuffer])}function To(t,e,n,o){Oo(t,0,e+n/2,t.transform.width,n,o)}function Ro(t,e,n,o){Oo(t,e-n/2,0,n,t.transform.height,o)}function Oo(e,n,o,r,i,s){const a=e.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.exported.devicePixelRatio,o*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,i*t.exported.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}const Po=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Io}=Po;function Ao(t,e,n,o){t.emplaceBack(e,n,o)}class Do{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,Ao(this.vertexArray,-1,-1,1),Ao(this.vertexArray,1,-1,1),Ao(this.vertexArray,-1,1,1),Ao(this.vertexArray,1,1,1),Ao(this.vertexArray,-1,-1,-1),Ao(this.vertexArray,1,-1,-1),Ao(this.vertexArray,-1,1,-1),Ao(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Io),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function Mo(e,n,o,r,i,s){const a=e.gl,l=n.paint.get("sky-atmosphere-color"),u=n.paint.get("sky-atmosphere-halo-color"),c=n.paint.get("sky-atmosphere-sun-intensity"),p=((t,e,n,o,r)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:n,u_color_tint_r:[o.r,o.g,o.b,o.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(t.fromMat4(t.create$1(),r),i,c,l,u);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,n.skyboxTexture,0),o.draw(e,a.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,p,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Lo=t.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class No{constructor(e){const n=new t.StructArrayLayout5f20;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const o=new t.StructArrayLayout3ui6;o.emplaceBack(0,1,2),o.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(n,Lo.members),this.indexBuffer=e.createIndexBuffer(o),this.segments=t.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Fo={symbol:function(e,n,o,r,i){if("translucent"!==e.renderPass)return;const s=t.StencilMode.disabled,a=e.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(e,n,o,r,i,s,a){const l=n.transform,u="map"===i,c="map"===s;for(const p of e){const e=r.getTile(p),n=e.getBucket(o);if(!n||!n.text||!n.text.segments.get().length)continue;const i=t.evaluateSizeForZoom(n.textSizeData,l.zoom),s=_e(p,n.getProjection(),l),h=l.calculatePixelsToTileUnitsMatrix(e),d=te(s,e.tileID.canonical,c,u,l,n.getProjection(),h),f="none"!==o.layout.get("icon-text-fit")&&n.hasIconData();if(i){const o=Math.pow(2,l.zoom-e.tileID.overscaledZ);ho(n,u,c,a,t.symbolSize,l,d,p,o,i,f)}}}(r,e,o,n,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),i),0!==o.paint.get("icon-opacity").constantOr(1)&&go(e,n,o,r,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),s,a),0!==o.paint.get("text-opacity").constantOr(1)&&go(e,n,o,r,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),s,a),n.map.showCollisionBoxes&&(uo(e,n,o,r,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),uo(e,n,o,r,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,o,r){if("translucent"!==e.renderPass)return;const i=o.paint.get("circle-opacity"),s=o.paint.get("circle-stroke-width"),a=o.paint.get("circle-stroke-opacity"),l=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0===i.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const u=e.context,c=u.gl,p=e.transform,h=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),d=t.StencilMode.disabled,f=e.colorModeForRenderPass(),g="globe"===p.projection.name,m=[t.mercatorXfromLng(p.center.lng),t.mercatorYfromLat(p.center.lat)],y=[];for(let _=0;_<r.length;_++){const i=r[_],s=n.getTile(i),a=s.getBucket(o);if(!a||a.projection.name!==p.projection.name)continue;const u=a.programConfigurations.get(o.id),c=Hn(o);g&&c.push("PROJECTION_GLOBE_VIEW");const h=e.useProgram("circle",u,c),d=a.layoutVertexBuffer,f=a.globeExtVertexBuffer,v=a.indexBuffer,C=p.projection.createInversionMatrix(p,i.canonical),w={programConfiguration:u,program:h,layoutVertexBuffer:d,globeExtVertexBuffer:f,indexBuffer:v,uniformValues:jn(e,i,s,C,m,o),tile:s};if(l){const e=a.segments.get();for(const n of e)y.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:w})}else y.push({segments:a.segments,sortKey:0,state:w})}l&&y.sort(((t,e)=>t.sortKey-e.sortKey));const v={useDepthForOcclusion:!g};for(const _ of y){const{programConfiguration:n,program:r,layoutVertexBuffer:i,globeExtVertexBuffer:s,indexBuffer:a,uniformValues:l,tile:g}=_.state,m=_.segments;e.terrain&&e.terrain.setupElevationDraw(g,r,v),e.prepareDrawProgram(u,r,g.tileID.toUnwrapped()),r.draw(u,c.TRIANGLES,h,d,f,t.CullFaceMode.disabled,l,o.id,i,a,m,o.paint,p.zoom,n,[s])}},heatmap:function(e,n,o,r){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const i=e.context,s=i.gl,a=t.StencilMode.disabled,l=new t.ColorMode([s.ONE,s.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n,o){const r=t.gl,i=e.width*o,s=e.height*o;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,i,s]);let a=n.heatmapFbo;if(!a||a&&(a.width!==i||a.height!==s)){a&&a.destroy();const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),a=n.heatmapFbo=t.createFramebuffer(i,s,!1),function(t,e,n,o,r,i){const s=t.gl;s.texImage2D(s.TEXTURE_2D,0,t.isWebGL2&&t.extRenderToTextureHalfFloat?s.RGBA16F:s.RGBA,r,i,0,s.RGBA,t.extRenderToTextureHalfFloat?t.isWebGL2?s.HALF_FLOAT:t.extTextureHalfFloat.HALF_FLOAT_OES:s.UNSIGNED_BYTE,null),o.colorAttachment.set(n)}(t,0,e,a,i,s)}else r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),t.bindFramebuffer.set(a.framebuffer)}(i,e,o,"globe"===e.transform.projection.name?.5:.25),i.clear({color:t.Color.transparent});const u=e.transform,c="globe"===u.projection.name,p=c?["PROJECTION_GLOBE_VIEW"]:null,h=c?t.CullFaceMode.frontCCW:t.CullFaceMode.disabled,d=[t.mercatorXfromLng(u.center.lng),t.mercatorYfromLat(u.center.lat)];for(let f=0;f<r.length;f++){const g=r[f];if(n.hasRenderableParent(g))continue;const m=n.getTile(g),y=m.getBucket(o);if(!y||y.projection.name!==u.projection.name)continue;const v=y.programConfigurations.get(o.id),_=e.useProgram("heatmap",v,p),{zoom:C}=e.transform;e.terrain&&e.terrain.setupElevationDraw(m,_),e.prepareDrawProgram(i,_,g.toUnwrapped());const w=u.projection.createInversionMatrix(u,g.canonical);_.draw(i,s.TRIANGLES,t.DepthMode.disabled,a,l,h,Xn(e,g,m,w,d,C,o.paint.get("heatmap-intensity")),o.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,o.paint,e.transform.zoom,v,c?[y.globeExtVertexBuffer]:null)}i.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const o=e.context,r=o.gl,i=n.heatmapFbo;if(!i)return;o.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),o.activeTexture.set(r.TEXTURE1);let s=n.colorRampTexture;s||(s=n.colorRampTexture=new t.Texture(o,n.colorRamp,r.RGBA)),s.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(o,r.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((t,e,n,o)=>({u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}))(0,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,o))},line:function(e,n,o,r){if("translucent"!==e.renderPass)return;const i=o.paint.get("line-opacity"),s=o.paint.get("line-width");if(0===i.constantOr(1)||0===s.constantOr(1))return;const a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),u=e.terrain&&e.terrain.renderingToTexture?1:t.exported.devicePixelRatio,c=o.paint.get("line-dasharray"),p=c.constantOr(1),h=o.layout.get("line-cap"),d=o.paint.get("line-pattern"),f=d.constantOr(1),g=o.paint.get("line-gradient"),m=f?"linePattern":"line",y=e.context,v=y.gl,_=(t=>{const e=[];Qn(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const n=t.paint.get("line-trim-offset");0===n[0]&&0===n[1]||e.push("RENDER_LINE_TRIM_OFFSET");const o=t.paint.get("line-pattern").constantOr(1),r=1!==t.paint.get("line-opacity").constantOr(1);return!o&&r&&e.push("RENDER_LINE_ALPHA_DISCARD"),e})(o);let C=_.includes("RENDER_LINE_ALPHA_DISCARD");e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(C=!1);for(const w of r){const r=n.getTile(w);if(f&&!r.patternsLoaded())continue;const i=r.getBucket(o);if(!i)continue;e.prepareDrawTile();const s=i.programConfigurations.get(o.id),b=e.useProgram(m,s,_),x=d.constantOr(null);if(x&&r.imageAtlas){const t=r.imageAtlas.patternPositions[x.toString()];t&&s.setConstantPatternPositions(t)}const E=c.constantOr(null),S=h.constantOr(null);if(!f&&E&&S&&r.lineAtlas){const t=r.lineAtlas.getDash(E,S);t&&s.setConstantPatternPositions(t)}let[T,R]=o.paint.get("line-trim-offset");if("round"===S||"square"===S){const t=1;T!==R&&(0===T&&(T-=t),1===R&&(R+=t))}const O=e.terrain?w.projMatrix:null,P=f?Kn(e,r,o,O,u):Yn(e,r,o,O,i.lineClipsArray.length,u,[T,R]);if(g){const r=i.gradients[o.id];let s=r.texture;if(o.gradientVersion!==r.version){let a=256;if(o.stepInterpolant){const o=n.getSource().maxzoom,r=w.canonical.z===o?Math.ceil(1<<e.transform.maxZoom-w.canonical.z):1;a=t.clamp(t.nextPowerOfTwo(i.maxLineLength/t.EXTENT*1024*r),256,y.maxTextureSize)}r.gradient=t.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:r.gradient||void 0,clips:i.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new t.Texture(y,r.gradient,v.RGBA),r.version=o.gradientVersion,s=r.texture}y.activeTexture.set(v.TEXTURE1),s.bind(o.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}p&&(y.activeTexture.set(v.TEXTURE0),r.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),s.updatePaintBuffers()),f&&(y.activeTexture.set(v.TEXTURE0),r.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),s.updatePaintBuffers()),e.prepareDrawProgram(y,b,w.toUnwrapped());const I=n=>{b.draw(y,v.TRIANGLES,a,n,l,t.CullFaceMode.disabled,P,o.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,o.paint,e.transform.zoom,s,[i.layoutVertexBuffer2])};if(C){const n=e.stencilModeForClipping(w).ref;0===n&&e.terrain&&y.clear({stencil:0});const o={func:v.EQUAL,mask:255};P.u_alpha_discard_threshold=.8,I(new t.StencilMode(o,n,255,v.KEEP,v.KEEP,v.INVERT)),P.u_alpha_discard_threshold=0,I(new t.StencilMode(o,n,255,v.KEEP,v.KEEP,v.KEEP))}else I(e.stencilModeForClipping(w))}C&&(e.resetStencilClippingMasks(),e.terrain&&y.clear({stencil:0}))},fill:function(e,n,o,r){const i=o.paint.get("fill-color"),s=o.paint.get("fill-opacity");if(0===s.constantOr(1))return;const a=e.colorModeForRenderPass(),l=o.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===i.constantOr(t.Color.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const i=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);yo(e,n,o,r,i,a,!1)}if("translucent"===e.renderPass&&o.paint.get("fill-antialias")){const i=e.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);yo(e,n,o,r,i,a,!0)}},"fill-extrusion":function(e,n,o,r){const i=o.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===e.renderPass){const s=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==i||o.paint.get("fill-extrusion-pattern").constantOr(1))vo(e,n,o,r,s,t.StencilMode.disabled,t.ColorMode.disabled),vo(e,n,o,r,s,e.stencilModeFor3D(),e.colorModeForRenderPass()),e.resetStencilClippingMasks();else{const i=e.colorModeForRenderPass();vo(e,n,o,r,s,t.StencilMode.disabled,i)}}},hillshade:function(e,n,o,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const i=e.context,s=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),a=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[u,c]="translucent"!==e.renderPass||l?[{},r]:e.stencilConfigForOverlap(r);for(const p of c){const r=n.getTile(p);if(r.needsHillshadePrepare&&"offscreen"===e.renderPass)yn(e,r,o,s,t.StencilMode.disabled,a);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(p):u[p.overscaledZ];gn(e,p,r,o,s,t,a)}}i.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,n,o,r,i,s){if("translucent"!==e.renderPass)return;if(0===o.paint.get("raster-opacity"))return;if(!r.length)return;const a=e.context,l=a.gl,u=n.getSource(),c=e.useProgram("raster"),p=e.colorModeForRenderPass(),h=e.terrain&&e.terrain.renderingToTexture,[d,f]=u instanceof Ot||h?[{},r]:e.stencilConfigForOverlap(r),g=f[f.length-1].overscaledZ,m=!e.options.moving;for(const y of f){const r=h?t.DepthMode.disabled:e.depthModeForSublayer(y.overscaledZ-g,1===o.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),i=y.toUnwrapped(),f=n.getTile(y);if(h&&(!f||!f.hasData()))continue;const v=h?y.projMatrix:e.transform.calculateProjMatrix(i,m),_=e.terrain&&h?e.terrain.stencilModeForRTTOverlap(y):d[y.overscaledZ],C=s?0:o.paint.get("raster-fade-duration");f.registerFadeDuration(C);const w=n.findLoadedParent(y,0),b=Rn(f,w,n,e.transform,C);let x,E;e.terrain&&e.terrain.prepareDrawTile();const S="nearest"===o.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),f.texture.bind(S,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),w?(w.texture.bind(S,l.CLAMP_TO_EDGE),x=Math.pow(2,w.tileID.overscaledZ-f.tileID.overscaledZ),E=[f.tileID.canonical.x*x%1,f.tileID.canonical.y*x%1]):f.texture.bind(S,l.CLAMP_TO_EDGE),f.texture.useMipmap&&a.extTextureFilterAnisotropic&&e.transform.pitch>20&&l.texParameterf(l.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax);const T=$n(v,E||[0,0],x||1,b,o,u instanceof Ot?u.perspectiveTransform:[0,0]);if(e.prepareDrawProgram(a,c,i),u instanceof Ot)u.boundsBuffer&&u.boundsSegments&&c.draw(a,l.TRIANGLES,r,t.StencilMode.disabled,p,t.CullFaceMode.disabled,T,o.id,u.boundsBuffer,e.quadTriangleIndexBuffer,u.boundsSegments);else{const{tileBoundsBuffer:n,tileBoundsIndexBuffer:i,tileBoundsSegments:s}=e.getTileBoundsBuffers(f);c.draw(a,l.TRIANGLES,r,_,p,t.CullFaceMode.disabled,T,o.id,n,i,s)}}e.resetStencilClippingMasks()},background:function(e,n,o,r){const i=o.paint.get("background-color"),s=o.paint.get("background-opacity");if(0===s)return;const a=e.context,l=a.gl,u=e.transform,c=u.tileSize,p=o.paint.get("background-pattern");if(e.isPatternMissing(p))return;const h=!p&&1===i.a&&1===s&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==h)return;const d=t.StencilMode.disabled,f=e.depthModeForSublayer(0,"opaque"===h?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),g=e.colorModeForRenderPass(),m=e.useProgram(p?"backgroundPattern":"background");let y,v=r;v||(y=e.getBackgroundTiles(),v=Object.values(y).map((t=>t.tileID))),p&&(a.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));for(const _ of v){const h=_.toUnwrapped(),v=r?_.projMatrix:e.transform.calculateProjMatrix(h);e.prepareDrawTile();const C=n?n.getTile(_):y?y[_.key]:new t.Tile(_,c,u.zoom,e),w=p?so(v,s,e,p,{tileID:_,tileSize:c}):io(v,s,i);e.prepareDrawProgram(a,m,h);const{tileBoundsBuffer:b,tileBoundsIndexBuffer:x,tileBoundsSegments:E}=e.getTileBoundsBuffers(C);m.draw(a,l.TRIANGLES,f,d,g,t.CullFaceMode.disabled,w,o.id,b,x,E)}},sky:function(e,n,o){const r=e.transform,i="mercator"===r.projection.name||"globe"===r.projection.name?1:t.smoothstep(7,8,r.zoom),s=o.paint.get("sky-opacity")*i;if(0===s)return;const a=e.context,l=o.paint.get("sky-type"),u=new t.DepthMode(a.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),c=e.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===e.renderPass?o.needsSkyboxCapture(e)&&(function(e,n,o,r){const i=e.context,s=i.gl;let a=n.skyboxFbo;if(!a){a=n.skyboxFbo=i.createFramebuffer(32,32,!1),n.skyboxGeometry=new Do(i),n.skyboxTexture=i.gl.createTexture(),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);for(let t=0;t<6;++t)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,s.RGBA,32,32,0,s.RGBA,s.UNSIGNED_BYTE,null)}i.bindFramebuffer.set(a.framebuffer),i.viewport.set([0,0,32,32]);const l=n.getCenter(e,!0),u=e.useProgram("skyboxCapture"),c=new Float64Array(16);t.identity(c),t.rotateY(c,c,.5*-Math.PI),Mo(i,n,u,c,l,0),t.identity(c),t.rotateY(c,c,.5*Math.PI),Mo(i,n,u,c,l,1),t.identity(c),t.rotateX(c,c,.5*-Math.PI),Mo(i,n,u,c,l,2),t.identity(c),t.rotateX(c,c,.5*Math.PI),Mo(i,n,u,c,l,3),t.identity(c),Mo(i,n,u,c,l,4),t.identity(c),t.rotateY(c,c,Math.PI),Mo(i,n,u,c,l,5),i.viewport.set([0,0,e.width,e.height])}(e,o),o.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,n,o,r,i){const s=e.context,a=s.gl,l=e.transform,u=e.useProgram("skybox");s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,n.skyboxTexture);const c=((t,e,n,o,r)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:o,u_temporal_offset:r}))(l.skyboxMatrix,n.getCenter(e,!1),0,r,i);e.prepareDrawProgram(s,u),u.draw(s,a.TRIANGLES,o,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,c,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,o,u,s,c):"gradient"===l&&"sky"===e.renderPass&&function(e,n,o,r,i){const s=e.context,a=s.gl,l=e.transform,u=e.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new Do(s)),s.activeTexture.set(a.TEXTURE0);let c=n.colorRampTexture;c||(c=n.colorRampTexture=new t.Texture(s,n.colorRamp,a.RGBA)),c.bind(a.LINEAR,a.CLAMP_TO_EDGE);const p=((e,n,o,r,i)=>({u_matrix:e,u_color_ramp:0,u_center_direction:n,u_radius:t.degToRad(o),u_opacity:r,u_temporal_offset:i}))(l.skyboxMatrix,n.getCenter(e,!1),n.paint.get("sky-gradient-radius"),r,i);e.prepareDrawProgram(s,u),u.draw(s,a.TRIANGLES,o,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,p,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,o,u,s,c)},debug:function(t,e,n){for(let o=0;o<n.length;o++)So(t,e,n[o])},custom:function(e,n,o,r){const i=e.context,s=o.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||"offscreen"===e.renderPass)&&o.isLayerDraped()){if("offscreen"===e.renderPass){const n=s.prerender;if(n){if(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),"globe"===e.transform.projection.name){const o=e.transform.pointMerc;n.call(s,i.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(e.transform.zoom),[o.x,o.y],e.transform.pixelsPerMeterRatio)}else n.call(s,i.gl,e.transform.customLayerMatrix());i.setDirty(),e.setBaseState()}}else if("translucent"===e.renderPass){if(e.terrain&&e.terrain.renderingToTexture){const n=s.renderToTile;if(n){const o=r[0].canonical,a=new t.MercatorCoordinate(o.x+r[0].wrap*(1<<o.z),o.y,o.z);i.setDepthMode(t.DepthMode.disabled),i.setStencilMode(t.StencilMode.disabled),i.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),n.call(s,i.gl,a),i.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(t.StencilMode.disabled);const n="3d"===s.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);if(i.setDepthMode(n),"globe"===e.transform.projection.name){const n=e.transform.pointMerc;s.render(i.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(e.transform.zoom),[n.x,n.y],e.transform.pixelsPerMeterRatio)}else s.render(i.gl,e.transform.customLayerMatrix());i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null)}}else t.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class ko{constructor(e,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context=new Et(e,o),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(t,e){const n=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new An(this,t));const o=this._terrain;this.transform.elevation=n?o:null,o.update(t,this.transform,e)}_updateFog(t){const e=t.fog;if(!e||"globe"===this.transform.projection.name||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,o]=e.getFovAdjustedRange(this.transform._fov);if(n>o)return void(this.transform.fogCullDistSq=null);const r=n+.78*(o-n);this.transform.fogCullDistSq=r*r}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,n){if(this.width=e*t.exported.devicePixelRatio,this.height=n*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize()}setup(){const e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(t.EXTENT,0),o.emplaceBack(0,t.EXTENT),o.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(o,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const r=new t.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(r,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.mercatorBoundsBuffer=e.createVertexBuffer(i,t.boundsAttributes.members),this.mercatorBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);const a=new t.StructArrayLayout1ui2;for(const t of[0,1,3,2,0])a.emplaceBack(t);this.debugIndexBuffer=e.createIndexBuffer(a),this.emptyTexture=new t.Texture(e,new t.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=t.create();const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now()),this.atmosphereBuffer=new No(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(e,n.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,Tn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,n,o){if(!n||this.currentStencilSource===n.id||!e.isTileClipped()||!o||0===o.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let t=!1;for(const e of o)if(void 0===this._tileClippingMaskIDs[e.key]){t=!0;break}if(!t)return}this.currentStencilSource=n.id;const r=this.context,i=r.gl;this.nextStencilID+o.length>256&&this.clearStencil(),r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const s=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of o){const e=n.getTile(a),o=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,{tileBoundsBuffer:l,tileBoundsIndexBuffer:u,tileBoundsSegments:c}=this.getTileBoundsBuffers(e);s.draw(r,i.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:i.ALWAYS,mask:0},o,255,i.KEEP,i.KEEP,i.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Tn(a.projMatrix),"$clipping",l,u,c)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new t.StencilMode({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new t.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,o=e.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),r=o[o.length-1].overscaledZ,i=o[0].overscaledZ-r+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let o=0;o<i;o++)e[o+r]=new t.StencilMode({func:n.GEQUAL,mask:255},o+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=i,[e,o]}return[{[r]:t.StencilMode.disabled},o]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,n,o){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(o||this.context.gl.LEQUAL,n,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const o=this.style.order,r=this.style._sourceCaches;for(const t in r){const e=r[t];e.used&&e.prepare(this.context)}const i={},s={},a={};for(const t in r){const e=r[t];i[t]=e.getVisibleCoordinates(),s[t]=i[t].slice().reverse(),a[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<o.length;t++)if(this.style._layers[o[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new t.GlobeSharedBuffers(this.context)),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const t of o){const n=this.style._layers[t],o=e._getLayerSourceCache(n);if(!n.hasOffscreenPass()||n.isHidden(this.transform.zoom))continue;const r=o?s[o.id]:void 0;("custom"===n.type||n.isSky()||r&&r.length)&&this.renderLayer(this,o,n,r)}this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon];const l=this.terrain;if(l&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&l.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[o[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky())continue;const r=n?s[n.id]:void 0;this._renderTileClippingMasks(t,n,r),this.renderLayer(this,n,t,r)}if(this.style.fog&&this.transform.projection.supportsFog&&function(e,n){const o=e.context,r=o.gl,i=e.transform,s=new t.DepthMode(r.LEQUAL,t.DepthMode.ReadOnly,[0,1]),a=e.useProgram("globeAtmosphere",null,"globe"===i.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=t.globeToMercatorTransition(i.zoom),u=n.properties.get("color").toArray01(),c=n.properties.get("high-color").toArray01(),p=n.properties.get("space-color").toArray01PremultipliedAlpha(),h=t.identity$1([]);t.rotateY$1(h,h,-t.degToRad(i._center.lng)),t.rotateX$1(h,h,t.degToRad(i._center.lat)),t.rotateZ$1(h,h,i.angle),t.rotateX$1(h,h,-i._pitch);const d=t.fromQuat(new Float32Array(16),h),f=t.mapValue(n.properties.get("star-intensity"),0,1,0,.25),g=5e-4,m=t.mapValue(n.properties.get("horizon-blend"),0,1,g,.25),y=t.globeUseCustomAntiAliasing(e,o,i)&&m===g?i.worldSize/(2*Math.PI*1.025)-1:i.globeRadius,v=e.frameCounter/1e3%1,_=t.length(i.globeCenterInViewSpace),C=Math.sqrt(Math.pow(_,2)-Math.pow(y,2)),w=Math.acos(C/_),b=((e,n,o,r,i,s,a,l,u,c,p,h,d,f)=>({u_frustum_tl:e,u_frustum_tr:n,u_frustum_br:o,u_frustum_bl:r,u_horizon:i,u_transition:s,u_fadeout_range:a,u_color:l,u_high_color:u,u_space_color:c,u_star_intensity:p,u_star_size:5*t.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:h,u_horizon_angle:d,u_rotation_matrix:f}))(i.frustumCorners.TL,i.frustumCorners.TR,i.frustumCorners.BR,i.frustumCorners.BL,i.frustumCorners.horizon,l,m,u,c,p,f,v,w,d);e.prepareDrawProgram(o,a);const x=e.atmosphereBuffer;x&&a.draw(o,r.TRIANGLES,s,t.StencilMode.disabled,t.ColorMode.alphaBlended,t.CullFaceMode.backCW,b,"skybox",x.vertexBuffer,x.indexBuffer,x.segments)}(this,this.style.fog),this.renderPass="sky",(t.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){const t=this.style._layers[o[this.currentLayer]],n=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,n,t,n?s[n.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;){const t=this.style._layers[o[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=n?("symbol"===t.type?a:s)[n.id]:void 0;this._renderTileClippingMasks(t,n,n?i[n.id]:void 0),this.renderLayer(this,n,t,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let n=null;t.values(this.style._layers).forEach((t=>{const o=e._getLayerSourceCache(t);o&&!t.isHidden(this.transform.zoom)&&(!n||n.getSource().maxzoom<o.getSource().maxzoom)&&(n=o)})),n&&this.options.showTileBoundaries&&Fo.debug(this,n,n.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;To(t,t.transform.height-(e.top||0),3,Co),To(t,e.bottom||0,3,wo),Ro(t,e.left||0,3,bo),Ro(t,t.transform.width-(e.right||0),3,xo);const n=t.transform.centerPoint;!function(t,e,n,o){Oo(t,e-1,n-10,2,20,o),Oo(t,e-10,n-1,20,2,o)}(t,n.x,t.transform.height-n.y,Eo)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,e,n,o){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||o&&o.length)&&(this.id=n.id,this.gpuTimingStart(n),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(n.type)||t.terrain&&"custom"===n.type)&&Fo[n.type](t,e,n,o,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,e=t.createQueryEXT();this.deferredRenderGpuTimeQueries.push(e),t.beginQueryEXT(t.TIME_ELAPSED_EXT,e)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const e={};for(const n in t){const o=t[n],r=this.context.extTimerQuery,i=r.getQueryObjectEXT(o.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(o.query),e[n]=i}return e}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const e=this.context.extTimerQuery;let n=0;for(const o of t)n+=e.getQueryObjectEXT(o,e.QUERY_RESULT_EXT)/1e6,e.deleteQueryEXT(o);return n}translatePosMatrix(e,n,o,r,i){if(!o[0]&&!o[1])return e;const s=i?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);o=[o[0]*e-o[1]*t,o[0]*t+o[1]*e]}const a=[i?o[0]:I(n,o[0],this.transform.zoom),i?o[1]:I(n,o[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,a),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){return null===t||void 0!==t&&!this.imageManager.getPattern(t.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=this.terrain&&0===this.terrain.exaggeration(),n=this.style&&this.style.fog,o=[];return this.terrainRenderModeElevated()&&o.push("TERRAIN"),"globe"===this.transform.projection.name&&o.push("GLOBE"),e&&o.push("ZERO_EXAGGERATION"),n&&!t&&0!==n.getOpacity(this.transform.pitch)&&o.push("FOG"),t&&o.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&o.push("OVERDRAW_INSPECTOR"),o}useProgram(t,e,n){this.cache=this.cache||{};const o=n||[],r=this.currentGlobalDefines().concat(o),i=Dn.cacheKey(cn[t],t,r,e);return this.cache[i]||(this.cache[i]=new Dn(this.context,t,cn[t],e,ao[t],r)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(e,n,o){if(this.terrain&&this.terrain.renderingToTexture)return;const r=this.style.fog;if(r){const i=r.getOpacity(this.transform.pitch),s=((e,n,o,r,i,s,a,l,u,c,p)=>{const h=e.transform,d=n.properties.get("color").toArray01();d[3]=r;const f=e.frameCounter/1e3%1;return{u_fog_matrix:o?h.calculateFogTileMatrix(o):e.identityMat,u_fog_range:n.getFovAdjustedRange(h._fov),u_fog_color:d,u_fog_horizon_blend:n.properties.get("horizon-blend"),u_fog_temporal_offset:f,u_frustum_tl:i,u_frustum_tr:s,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:u,u_globe_radius:c,u_viewport:p,u_globe_transition:t.globeToMercatorTransition(h.zoom),u_is_globe:+("globe"===h.projection.name)}})(this,r,o,i,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*t.exported.devicePixelRatio,this.transform.height*t.exported.devicePixelRatio]);n.setFogUniformValues(e,s)}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,n=this._backgroundTiles={},o=this.transform.coveringTiles({tileSize:512});for(const r of o)n[r.key]=e[r.key]||new t.Tile(r,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}}class Go{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(o)||o<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=o}interpolate(e,n,o){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,o)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,o)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,o)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,o)),this}getCenter(e,n){const o=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.Point(o,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Go(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Bo(e,n){const o=t.getColumn(e,3);t.fromQuat(e,n),t.setColumn(e,3,o)}function Vo(e,n){const o=t.identity$1([]);return t.rotateZ$1(o,o,-n),t.rotateX$1(o,o,-e),o}function zo(e,n){const o=[e[0],e[1],0],r=[n[0],n[1],0];if(t.length(o)>=1e-15){const e=t.normalize([],o);t.scale$2(r,e,t.dot(r,e)),n[0]=r[0],n[1]=r[1]}const i=t.cross([],n,e);if(t.len(i)<1e-15)return null;const s=Math.atan2(-i[1],i[0]);return Vo(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),s)}class jo{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){if(e){const n=e instanceof t.MercatorCoordinate?e:new t.MercatorCoordinate(e[0],e[1],e[2]);this._renderWorldCopies&&(n.x=t.wrap(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const o=this.position,r=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)):0,i=t.MercatorCoordinate.fromLngLat(e,r),s=[i.x-o.x,i.y-o.y,i.z-o.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=zo(s,n)}setPitchBearing(e,n){this.orientation=Vo(t.degToRad(e),t.degToRad(-n))}}class Ho{constructor(e,n){this._transform=t.identity([]),this.orientation=n,this.position=e}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const e=t.getColumn(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var n;e&&t.setColumn(this._transform,3,[(n=e)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||t.identity$1([]),e&&Bo(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=Vo(t,e),Bo(this._transform,this._orientation)}forward(){const e=t.getColumn(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=t.getColumn(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=t.getColumn(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,n){const o=new Float64Array(16);return t.invert(o,this.getWorldToCamera(e,n)),o}getWorldToCameraPosition(e,n,o){const r=this.position;t.scale$2(r,r,-e);const i=new Float64Array(16);return t.fromScaling(i,[o,o,o]),t.translate(i,i,r),i[10]*=n,i}getWorldToCamera(e,n){const o=new Float64Array(16),r=new Float64Array(4),i=this.position;return t.conjugate(r,this._orientation),t.scale$2(i,i,-e),t.fromQuat(o,r),t.translate(o,o,i),o[1]*=-1,o[5]*=-1,o[9]*=-1,o[13]*=-1,o[8]*=n,o[9]*=n,o[10]*=n,o[11]*=n,o}getCameraToClipPerspective(e,n,o,r){const i=new Float64Array(16);return t.perspective(i,e,n,o,r),i}getDistanceToElevation(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=0===e?0:t.mercatorZfromAltitude(e,n?t.latFromMercatorY(this.position[1]):this.position[1]),r=this.forward();return(o-this.position[2])/r[2]}clone(){return new Ho([...this.position],[...this.orientation])}}function Uo(e,n){const o=qo(e.projection,e.zoom,e.width,e.height),r=function(e,n,o,r,i){const s=new t.LngLat(o.lng-180*Xo,o.lat),a=new t.LngLat(o.lng+180*Xo,o.lat),l=e.project(s.lng,s.lat),u=e.project(a.lng,a.lat),c=-Math.atan2(u.y-l.y,u.x-l.x),p=t.MercatorCoordinate.fromLngLat(o);p.y=t.clamp(p.y,-1+Xo,1-Xo);const h=p.toLngLat(),d=e.project(h.lng,h.lat),f=t.MercatorCoordinate.fromLngLat(h);f.x+=Xo;const g=f.toLngLat(),m=e.project(g.lng,g.lat),y=Ko(m.x-d.x,m.y-d.y,c),v=t.MercatorCoordinate.fromLngLat(h);v.y+=Xo;const _=v.toLngLat(),C=e.project(_.lng,_.lat),w=Ko(C.x-d.x,C.y-d.y,c),b=Math.abs(y.x)/Math.abs(w.y),x=t.identity([]);t.rotateZ(x,x,-c*(1-(i?0:r)));const E=t.identity([]);return t.scale(E,E,[1,1-(1-b)*r,1]),E[4]=-w.x/w.y*r,t.rotateZ(E,E,c),t.multiply(E,x,E),E}(e.projection,0,e.center,o,n),i=Wo(e);return t.scale(r,r,[i,i,1]),r}function Wo(e){const n=e.projection,o=qo(e.projection,e.zoom,e.width,e.height),r=Yo(n,e.center),i=Yo(n,t.LngLat.convert(n.center));return Math.pow(2,r*o+(1-o)*i)}function qo(e,n,o,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const s=e.range;if(!s)return 0;const a=Math.min(i,Math.max(o,r)),l=Math.log(a/1024)/Math.LN2;return t.smoothstep(s[0]+l,s[1]+l,n)}const Xo=1/4e4;function Yo(e,n){const o=t.clamp(n.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),r=new t.LngLat(n.lng-180*Xo,o),i=new t.LngLat(n.lng+180*Xo,o),s=e.project(r.lng,o),a=e.project(i.lng,o),l=t.MercatorCoordinate.fromLngLat(r),u=t.MercatorCoordinate.fromLngLat(i),c=a.x-s.x,p=a.y-s.y,h=u.x-l.x,d=u.y-l.y,f=Math.sqrt((h*h+d*d)/(c*c+p*p));return Math.log(f)/Math.LN2}function Ko(t,e,n){const o=Math.cos(n),r=Math.sin(n);return{x:t*o-e*r,y:t*r+e*o}}class Zo{constructor(e,n,o,r,i,s,a){this.tileSize=512,this._renderWorldCopies=void 0===i||i,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==o?0:o,this._maxPitch=null==r?60:r,this.setProjection(s),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Go,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ho,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const t=new Zo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||n)&&this._updateCameraOnTerrain(),(t||n)&&this._constrainCamera(e),this._calcMatrices()}getProjection(){return t.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const o=this.projection?this.getProjection():void 0;this.projection=t.getProjection(this.projectionOptions);const r=!e(o,this.getProjection());return r&&this._calcMatrices(),this.mercatorFromTransition=!1,r}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=t.getProjection({name:"mercator"});const n=e!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.Point(this.width,this.height)}get bearing(){return t.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const n=-e*Math.PI/180;var o;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(o=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0),o[0]=1,o[3]=1,o),function(t,e,n){var o=e[0],r=e[1],i=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=o*l+i*a,t[1]=r*l+s*a,t[2]=o*-a+i*l,t[3]=r*-a+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=t.degToRad(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],o=this.horizonLineFromTop();let r=0,i=0;for(let s=0;s<n.length;s++){const a=new t.Point(n[s][0]*this.width,o+n[s][1]*(this.height-o)),l=e.pointCoordinate(a);if(!l)continue;const u=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*u,i+=u}return 0===i?NaN:r/i}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,e=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),n=this.pixelsPerMeter/this.worldSize*e,o=this._mercatorZfromZoom(t),r=this._mercatorZfromZoom(this._maxZoom),i=Math.max(o-n,r);this._setZoom(this._zoomFromMercatorZ(i))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let o;o=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const r=t.length(t.sub([],this._camera.position,o));return t.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const o=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(o,this._camera.position)||(this._setCameraPosition(o),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new jo;return n.position=new t.MercatorCoordinate(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(e){if(!t.length$1(e))return!1;t.normalize$1(e,e);const n=t.transformQuat([],[0,0,-1],e),o=t.transformQuat([],[0,-1,0],e);if(o[2]<0)return!1;const r=zo(n,o);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,o=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;e[2]=t.clamp(e[2],r/o,r/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.UnwrappedTileID(0,e)];if(this.renderWorldCopies){const o=this.pointCoordinate(new t.Point(0,0)),r=this.pointCoordinate(new t.Point(this.width,0)),i=this.pointCoordinate(new t.Point(this.width,this.height)),s=this.pointCoordinate(new t.Point(0,this.height)),a=Math.floor(Math.min(o.x,r.x,i.x,s.x)),l=Math.floor(Math.max(o.x,r.x,i.x,s.x)),u=1;for(let c=a-u;c<=l+u;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e))}return n}coveringTiles(e){let n=this.coveringZoomLevel(e);const o=n,r=this.elevation&&!e.isTerrainDEM,i="mercator"===this.projection.name;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const s=this.locationCoordinate(this.center),a=this.center.lat,l=1<<n,u=[l*s.x,l*s.y,0],c="globe"===this.projection.name,p=!c,h=t.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,p),d=c?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),f=l*t.mercatorZfromAltitude(1,this.center.lat),g=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),m=[l*d.x,l*d.y,g*(p?1:f)],y=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),v=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?n:0,_=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,C=e.isTerrainDEM?-_:this._elevation?this._elevation.getMinElevationBelowMSL():0,w=this.projection.isReprojectedInTileSpace?Wo(this):1,b=e=>{const n=1/4e4,o=new t.MercatorCoordinate(e.x+n,e.y,e.z),r=new t.MercatorCoordinate(e.x,e.y+n,e.z),i=e.toLngLat(),s=o.toLngLat(),a=r.toLngLat(),l=this.locationCoordinate(i),u=this.locationCoordinate(s),c=this.locationCoordinate(a),p=Math.hypot(u.x-l.x,u.y-l.y),h=Math.hypot(c.x-l.x,c.y-l.y);return Math.sqrt(p*h)*w/n},x=e=>{const n=_,o=C;return{aabb:t.tileAABB(this,l,0,0,0,e,o,n,this.projection),zoom:0,x:0,y:0,minZ:o,maxZ:n,wrap:e,fullyVisible:!1}},E=[];let S=[];const T=n,R=e.reparseOverscaled?o:n,O=t=>t*t,P=O((g-this._centerAltitude)*f),I=t=>{if(!this._elevation||!t.tileID||!i)return;const e=this._elevation.getMinMaxForTile(t.tileID),n=t.aabb;e?(n.min[2]=e.min,n.max[2]=e.max,n.center[2]=(n.min[2]+n.max[2])/2):(t.shouldSplit=A(t),t.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},A=e=>{if(e.zoom<v)return!0;if(e.zoom===T)return!1;if(null!=e.shouldSplit)return e.shouldSplit;const n=e.aabb.distanceX(m),i=e.aabb.distanceY(m);let s=P,l=1;if(c){s=O(e.aabb.distanceZ(m));const n=Math.pow(2,e.zoom),o=t.latFromMercatorY((e.y+1)/n),r=t.latFromMercatorY(e.y/n),i=Math.min(Math.max(a,o),r),u=t.circumferenceAtLatitude(i)/t.circumferenceAtLatitude(a);if(l=i===a?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,u/this._mercatorScaleRatio),this.zoom<=t.GLOBE_ZOOM_THRESHOLD_MIN&&e.zoom===T-1&&u>=.9)return!0}else if(r&&(s=O(e.aabb.distanceZ(m)*f)),this.projection.isReprojectedInTileSpace&&o<=5){const n=Math.pow(2,e.zoom),o=b(new t.MercatorCoordinate((e.x+.5)/n,(e.y+.5)/n));l=o>.85?1:o}const u=n*n+i*i+s,p=O((1<<T-e.zoom)*y*l*((t,e)=>{if(e*O(.707)<t)return 1;const n=Math.sqrt(e/t);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(s,P),u));return u<p};if(this.renderWorldCopies)for(let t=1;t<=3;t++)E.push(x(-t)),E.push(x(t));for(E.push(x(0));E.length>0;){const o=E.pop(),s=o.x,a=o.y;let p=o.fullyVisible;if(!p){const t=o.aabb.intersects(h);if(0===t)continue;p=2===t}if(o.zoom!==T&&A(o))for(let e=0;e<4;e++){const n=(s<<1)+e%2,u=(a<<1)+(e>>1),h={aabb:i?o.aabb.quadrant(e):t.tileAABB(this,l,o.zoom+1,n,u,o.wrap,o.minZ,o.maxZ,this.projection),zoom:o.zoom+1,x:n,y:u,wrap:o.wrap,fullyVisible:p,tileID:void 0,shouldSplit:void 0,minZ:o.minZ,maxZ:o.maxZ};r&&!c&&(h.tileID=new t.OverscaledTileID(o.zoom+1===T?R:o.zoom+1,o.wrap,o.zoom+1,n,u),I(h)),E.push(h)}else{const r=o.zoom===T?R:o.zoom;if(e.minzoom&&e.minzoom>r)continue;const i=u[0]-(.5+s+(o.wrap<<o.zoom))*(1<<n-o.zoom),l=u[1]-.5-a,c=o.tileID?o.tileID:new t.OverscaledTileID(r,o.wrap,o.zoom,s,a);S.push({tileID:c,distanceSq:i*i+l*l})}}if(this.fogCullDistSq){const n=this.fogCullDistSq,o=this.horizonLineFromTop();S=S.filter((r=>{const i=[0,0,0,1],s=[t.EXTENT,t.EXTENT,0,1],a=this.calculateFogTileMatrix(r.tileID.toUnwrapped());t.transformMat4$1(i,i,a),t.transformMat4$1(s,s,a);const l=t.getAABBPointSquareDist(i,s);if(0===l)return!0;let u=!1;const c=this._elevation;if(c&&l>n&&0!==o){const n=this.calculateProjMatrix(r.tileID.toUnwrapped());let i;e.isTerrainDEM||(i=c.getMinMaxForTile(r.tileID)),i||(i={min:C,max:_});const s=t.furthestTileCorner(this.rotation),a=[s[0]*t.EXTENT,s[1]*t.EXTENT,i.max];t.transformMat4(a,a,n),u=(1-a[1])*this.height*.5<o}return l<n||u}))}return S.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.clamp(e.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),o=this.projection.project(e.lng,n);return new t.Point(o.x*this.worldSize,o.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/t.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,n){let o,r;const i=this.centerPoint;if("globe"===this.projection.name){const t=this.worldSize;o=(n.x-i.x)/t,r=(n.y-i.y)/t}else{const t=this.pointCoordinate(n),e=this.pointCoordinate(i);o=t.x-e.x,r=t.y-e.y}const s=this.locationCoordinate(e);this.setLocation(new t.MercatorCoordinate(s.x-o,s.y-r))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e,n){const o=n?t.mercatorZfromAltitude(n,e.lat):void 0,r=this.projection.project(e.lng,e.lat);return new t.MercatorCoordinate(r.x,r.y,o)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(e,n){const o=null!=n?n:this._centerAltitude,r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4$1(r,r,this.pixelMatrixInverse),t.transformMat4$1(i,i,this.pixelMatrixInverse);const s=i[3];t.scale$1(r,r,1/r[3]),t.scale$1(i,i,1/s);const a=r[2],l=i[2];return{p0:r,p1:i,t:a===l?0:(o-a)/(l-a)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],o=[e.x,e.y,1,1];return t.transformMat4$1(n,n,this.pixelMatrixInverse),t.transformMat4$1(o,o,this.pixelMatrixInverse),t.scale$1(n,n,1/n[3]),t.scale$1(o,o,1/o[3]),n[2]=t.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,o[2]=t.mercatorZfromAltitude(o[2],this._center.lat)*this.worldSize,t.scale$1(n,n,1/this.worldSize),t.scale$1(o,o,1/this.worldSize),new t.Ray([n[0],n[1],n[2]],t.normalize([],t.sub([],o,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:o,t:r}=e,i=t.mercatorZfromAltitude(n[2],this._center.lat),s=t.mercatorZfromAltitude(o[2],this._center.lat);return new t.MercatorCoordinate(t.number(n[0],o[0],r)/this.worldSize,t.number(n[1],o[1],r)/this.worldSize,t.number(i,s,r))}pointCoordinate(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,t.x,t.y,e)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let n=this.projection.pointCoordinate3D(this,e.x,e.y);if(n)return new t.MercatorCoordinate(n[0],n[1],n[2]);let o=0,r=this.horizonLineFromTop();if(e.y>r)return this.pointCoordinate(e);const i=.02*r,s=e.clone();for(let a=0;a<10&&r-o>i;a++){s.y=t.number(o,r,.66);const e=this.projection.pointCoordinate3D(this,s.x,s.y);e?(r=s.y,n=e):o=s.y}return n?new t.MercatorCoordinate(n[0],n[1],n[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(e);const n=this.pointCoordinate(e);return n.y>=0&&n.y<=1}_coordinatePoint(e,n){const o=n&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,r=[e.x*this.worldSize,e.y*this.worldSize,o+e.toAltitude(),1];return t.transformMat4$1(r,r,this.pixelMatrix),r[3]>0?new t.Point(r[0]/r[3],r[1]/r[3]):new t.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:n}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,r=this.width-this._edgeInsets.right,i=this.pointLocation3D(new t.Point(n,e)),s=this.pointLocation3D(new t.Point(r,e)),a=this.pointLocation3D(new t.Point(r,o)),l=this.pointLocation3D(new t.Point(n,o));let u=Math.min(i.lng,s.lng,a.lng,l.lng),c=Math.max(i.lng,s.lng,a.lng,l.lng),p=Math.min(i.lat,s.lat,a.lat,l.lat),h=Math.max(i.lat,s.lat,a.lat,l.lat);const d=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,g=(e,n,o,r,i)=>{const s=(e+o)/2,a=(n+r)/2,l=new t.Point(s,a),{lng:m,lat:y}=this.pointLocation3D(l),v=Math.max(0,u-m,p-y,m-c,y-h);u=Math.min(u,m),c=Math.max(c,m),p=Math.min(p,y),h=Math.max(h,y),(i<f||v>d)&&(g(e,n,s,a,i+1),g(s,a,o,r,i+1))};if(g(n,e,r,e,1),g(r,e,r,o,1),g(r,o,n,o,1),g(n,o,n,e,1),"globe"===this.projection.name){const[e,n]=t.polesInViewport(this);e?(h=90,c=180,u=-180):n&&(p=-90,c=180,u=-180)}return new t.LngLatBounds(new t.LngLat(u,p),new t.LngLat(c,h))}_getBoundsRectangular(e,n){const{top:o,left:r}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,a=new t.Point(r,o),l=new t.Point(s,o),u=new t.Point(s,i),c=new t.Point(r,i);let p=this.pointCoordinate(a,e),h=this.pointCoordinate(l,e);const d=this.pointCoordinate(u,n),f=this.pointCoordinate(c,n),g=(t,e)=>(e.y-t.y)/(e.x-t.x);return p.y>1&&h.y>=0?p=new t.MercatorCoordinate((1-f.y)/g(f,p)+f.x,1):p.y<0&&h.y<=1&&(p=new t.MercatorCoordinate(-f.y/g(f,p)+f.x,0)),h.y>1&&p.y>=0?h=new t.MercatorCoordinate((1-d.y)/g(d,h)+d.x,1):h.y<0&&p.y<=1&&(h=new t.MercatorCoordinate(-d.y/g(d,h)+d.x,0)),(new t.LngLatBounds).extend(this.coordinateLocation(p)).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(d))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const e=t.visibleDemTiles.reduce(((t,e)=>{if(e.dem){const n=e.dem.tree;t.min=Math.min(t.min,n.minimums[0]),t.max=Math.max(t.max,n.maximums[0])}return t}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(e.min*t.exaggeration(),e.max*t.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-e*(1-this._horizonShift);return t?Math.max(0,n):n}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-t.MAX_MERCATOR_LATITUDE,this.maxLat=t.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=t.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=t.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=t.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,e){return this.projection.createTileMatrix(this,e,t)}calculateDistanceTileData(e){const n=e.key,o=this._distanceTileDataCache;if(o[n])return o[n];const r=e.canonical,i=1/this.height,s=this.cameraWorldSize,a=s/this.zoomScale(r.z),l=(r.x+Math.pow(2,r.z)*e.wrap)*a,u=r.y*a,c=this.point;c.x*=s/this.worldSize,c.y*=s/this.worldSize;const p=this.angle,h=Math.sin(-p),d=-Math.cos(-p);return o[n]={bearing:[h,d],center:[(c.x-l)*i,(c.y-u)*i],scale:a/t.EXTENT*i},o[n]}calculateFogTileMatrix(e){const n=e.key,o=this._fogTileMatrixCache;if(o[n])return o[n];const r=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return t.multiply(r,this.worldToFogMatrix,r),o[n]=new Float32Array(r),o[n]}calculateProjMatrix(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=e.key,r=n?this._alignedProjMatrixCache:this._projMatrixCache;if(r[o])return r[o];const i=this.calculatePosMatrix(e,this.worldSize);return t.multiply(i,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:n?this.alignedProjMatrix:this.projMatrix,i),r[o]=new Float32Array(i),r[o]}calculatePixelsToTileUnitsMatrix(e){const n=e.tileID.key,o=this._pixelsToTileUnitsCache;if(o[n])return o[n];const r=function(e,n){const{scale:o}=e.tileTransform,r=o*t.EXTENT/(e.tileSize*Math.pow(2,n.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return i=new Float32Array(4),l=(s=n.inverseAdjustmentMatrix)[1],u=s[2],c=s[3],h=(a=[r,r])[1],i[0]=s[0]*(p=a[0]),i[1]=l*p,i[2]=u*h,i[3]=c*h,i;var i,s,a,l,u,c,p,h}(e,this);return o[n]=r,o[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const e=1/this.worldSize,n=t.fromScaling([],[e,e,e]);return t.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const e=this._elevation;this._updateCameraState();const n=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,o=this._computeCameraPosition(n),r=this._camera.forward(),i=t.mercatorZfromAltitude(1,this._center.lat);o[2]/=i,r[2]/=i,t.normalize(r,r);const s=e.raycast(o,r,e.exaggeration());if(s){const e=t.scaleAndAdd([],o,r,s),n=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),a=(n.z+t.length([n.x-o[0],n.y-o[1],n.z-o[2]*i]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=n.toAltitude(),this._center=this.coordinateLocation(n),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._elevation)return;const n=this._elevation,o=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(o),i=n.getAtPointOrZero(new t.MercatorCoordinate(...r)),s=this.pixelsPerMeter/this.worldSize*i,a=this._minimumHeightOverTerrain(),l=r[2]-s;if(l<=a)if(l<0||e){const e=this.locationCoordinate(this._center,this._centerAltitude),n=[r[0],r[1],e.z-r[2]],o=t.length(n);n[2]-=(a-l)/this._pixelsPerMercatorPixel;const i=t.length(n);if(0===i)return;t.scale$2(n,n,o/i*this._pixelsPerMercatorPixel),this._camera.position=[r[0],r[1],e.z*this._pixelsPerMercatorPixel-n[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const n=this.center;return n.lat=t.clamp(n.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(n.lng=t.clamp(n.lng,this.minLng,this.maxLng)),this.center=n,void(this._constraining=!1)}const n=this._unmodified,{x:o,y:r}=this.point;let i=0,s=o,a=r;const l=this.width/2,u=this.height/2,c=this.worldMinY*this.scale,p=this.worldMaxY*this.scale;if(r-u<c&&(a=c+u),r+u>p&&(a=p-u),p-c<this.height&&(i=Math.max(i,this.height/(p-c)),a=(p+c)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const t=this.worldMinX*this.scale,e=this.worldMaxX*this.scale,n=this.worldSize/2-(t+e)/2;s=(o+n+this.worldSize)%this.worldSize-n,s-l<t&&(s=t+l),s+l>e&&(s=e-l),e-t<this.width&&(i=Math.max(i,this.width/(e-t)),s=(e+t)/2)}s===o&&a===r||(this.center=this.unproject(new t.Point(s,a))),i&&(this.zoom+=this.scaleZoom(i)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=t.mercatorZfromAltitude(1,this.center.lat)/t.mercatorZfromAltitude(1,t.GLOBE_SCALE_MATCH_LATITUDE));const o=qo(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,o),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const r="meters"===this.projection.zAxisUnit?n:1,i=this._camera.getWorldToCamera(this.worldSize,r),s=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);s[8]=2*-e.x/this.width,s[9]=2*e.y/this.height;let a=t.mul([],s,i);if(this.projection.isReprojectedInTileSpace){const e=this.locationCoordinate(this.center),n=t.identity([]);t.translate(n,n,[e.x*this.worldSize,e.y*this.worldSize,0]),t.multiply(n,n,Uo(this)),t.translate(n,n,[-e.x*this.worldSize,-e.y*this.worldSize,0]),t.multiply(a,a,n),this.inverseAdjustmentMatrix=function(t){const e=Uo(t,!0);return v([],[e[0],e[1],e[4],e[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=t.scale([],a,[this.worldSize,this.worldSize,this.worldSize/r,1]),this.projMatrix=a,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const l=t.invert([],s);this.frustumCorners=t.FrustumCorners.fromInvProjectionMatrix(l,this.horizonLineFromTop(),this.height);const u=new Float32Array(16);t.identity(u),t.scale(u,u,[1,-1,1]),t.rotateX(u,u,this._pitch),t.rotateZ(u,u,this.angle);const c=t.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),p=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;c[8]=2*-e.x/this.width,c[9]=2*(e.y+p)/this.height,this.skyboxMatrix=t.multiply(u,c,u);const h=this.point,d=h.x,f=h.y,g=this.width%2/2,m=this.height%2/2,y=Math.cos(this.angle),_=Math.sin(this.angle),C=d-Math.round(d)+y*g+_*m,w=f-Math.round(f)+y*m+_*g,b=new Float64Array(a);if(t.translate(b,b,[C>.5?C-1:C,w>.5?w-1:w,0]),this.alignedProjMatrix=b,a=t.create(),t.scale(a,a,[this.width/2,-this.height/2,1]),t.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=t.create(),t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},a=t.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=a,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=t.calculateGlobeMatrix(this);const e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=t.transformMat4(e,e,i),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=a;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,o=this._camera.position,r=1/this.height/this._pixelsPerMercatorPixel,i=[e,e,n];t.scale$2(i,i,r),t.scale$2(o,o,-1),t.multiply$2(o,o,i);const s=t.create();t.translate(s,s,o),t.scale(s,s,i),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,n,r)}_computeCameraPosition(t){const e=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,n=this._camera.forward(),o=this.point,r=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*e-t/this.worldSize*this._centerAltitude;return[o.x/this.worldSize-n[0]*r,o.y/this.worldSize-n[1]*r,t/this.worldSize*this._centerAltitude-n[2]*r]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),o=this._camera.position[2],r=e[2];let i=1;this.projection.wrap&&(this.center=this.center.wrap()),r>0&&(i=Math.min((n-o)/r,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,i),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:o,bearing:r}=this._camera.getPitchBearing(),i=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),a=Math.max((e[2]-i)/Math.cos(o),s),l=this._zoomFromMercatorZ(a);t.scaleAndAdd(e,e,n,a),this._pitch=t.clamp(o,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(r,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new t.MercatorCoordinate(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(e){let n=0,o=t.GLOBE_ZOOM_THRESHOLD_MAX,r=0,i=1/0;for(;o-n>1e-6&&o>n;){const t=n+.5*(o-n),s=this.tileSize*Math.pow(2,t),a=this.getCameraToCenterDistance(this.projection,t,s),l=this.scaleZoom(a/(e*this.tileSize)),u=Math.abs(t-l);u<i&&(i=u,r=t),t<l?n=t:o=t}return r}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(t.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,n){const o=Math.min(e.x,n.x),r=Math.max(e.x,n.x),i=Math.min(e.y,n.y),s=Math.max(e.y,n.y);if(i<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new t.Point(o,i),new t.Point(r,s),new t.Point(o,s),new t.Point(r,i)],l=this.renderWorldCopies?-3:0,u=this.renderWorldCopies?4:1;for(const t of a){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const n=this.rayIntersectionCoordinate(e);if(n.x<l||n.y<0||n.x>u||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.Point(0,0),new t.Point(this.width,this.height))}zoomDeltaToMovement(e,n){const o=t.length(t.sub([],this._camera.position,e)),r=this._zoomFromMercatorZ(o)+n;return o-this._mercatorZfromZoom(r)}getCameraPoint(){if("globe"===this.projection.name){const e=function(e,n){let[o,r,i]=e;const s=[o,r,i,1];t.transformMat4$1(s,s,n);const a=s[3]=Math.max(s[3],1e-6);return s[0]/=a,s[1]/=a,s[2]/=a,s}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new t.Point(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))}}getCameraToCenterDistance(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldSize;const o=qo(t,e,this.width,this.height,1024),r=t.pixelSpaceConversion(this.center.lat,n,o);return.5/Math.tan(.5*this._fov)*this.height*r}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&t.multiply(e,e,this.globeMatrix),e}}function Jo(t,e){let n=!1,o=null;const r=()=>{o=null,n&&(t(),o=setTimeout(r,e),n=!1)};return()=>(n=!0,o||r(),o)}class Qo{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Jo(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),t.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const n=$o(e);if(this._hashName){const e=this._hashName;let o=!1;const r=t.window.location.hash.slice(1).split("&").map((t=>{const r=t.split("=")[0];return r===e?(o=!0,"".concat(r,"=").concat(n)):t})).filter((t=>t));return o||r.push("".concat(e,"=").concat(n)),"#".concat(r.join("&"))}return"#".concat(n)}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((t=>t.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const e=this._getCurrentHash();if(e.length>=3&&!e.some((t=>isNaN(t)))){const n=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(e[3]||0):t.getBearing();return t.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:n,pitch:+(e[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e)}}function $o(t,e){const n=t.getCenter(),o=Math.round(100*t.getZoom())/100,r=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,r),s=Math.round(n.lng*i)/i,a=Math.round(n.lat*i)/i,l=t.getBearing(),u=t.getPitch();let c=e?"/".concat(s,"/").concat(a,"/").concat(o):"".concat(o,"/").concat(a,"/").concat(s);return(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+="/".concat(Math.round(u))),c}const tr={linearity:.3,easing:t.bezier(0,0,.3,1)},er=t.extend({deceleration:2500,maxSpeed:1400},tr),nr=t.extend({deceleration:20,maxSpeed:1400},tr),or=t.extend({deceleration:1e3,maxSpeed:360},tr),rr=t.extend({deceleration:1e3,maxSpeed:90},tr);class ir{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.exported.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const i=ar(n.pan.mag(),o,t.extend({},er,e||{}));r.offset=n.pan.mult(i.amount/n.pan.mag()),r.center=this._map.transform.center,sr(r,i)}if(n.zoom){const t=ar(n.zoom,o,nr);r.zoom=this._map.transform.zoom+t.amount,sr(r,t)}if(n.bearing){const e=ar(n.bearing,o,or);r.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),sr(r,e)}if(n.pitch){const t=ar(n.pitch,o,rr);r.pitch=this._map.transform.pitch+t.amount,sr(r,t)}if(r.zoom||r.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),r.noMoveStart=!0,r}}function sr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function ar(e,n,o){const{maxSpeed:r,linearity:i,deceleration:s}=o,a=t.clamp(e*i/(n/1e3),-r,r),l=Math.abs(a)/(s*i);return{easing:o.easing,duration:1e3*l,amount:a*(l/2)}}class lr extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=f(n.getCanvasContainer(),o),s=n.unproject(i);super(e,t.extend({point:i,lngLat:s,originalEvent:o},r)),this._defaultPrevented=!1,this.target=n}}class ur extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,o){const r="touchend"===e?o.changedTouches:o.touches,i=g(n.getCanvasContainer(),r),s=i.map((t=>n.unproject(t))),a=i.reduce(((t,e,n,o)=>t.add(e.div(o.length))),new t.Point(0,0));super(e,{points:i,point:a,lngLats:s,lngLat:n.unproject(a),originalEvent:o}),this._defaultPrevented=!1}}class cr extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class pr{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new cr(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new lr(t.type,this._map,t))}mouseup(t){this._map.fire(new lr(t.type,this._map,t))}preclick(e){const n=t.extend({},e);n.type="preclick",this._map.fire(new lr(n.type,this._map,n))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||(this.preclick(t),this._map.fire(new lr(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new lr(t.type,this._map,t))}mouseover(t){this._map.fire(new lr(t.type,this._map,t))}mouseout(t){this._map.fire(new lr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new ur(t.type,this._map,t))}touchmove(t){this._map.fire(new ur(t.type,this._map,t))}touchend(t){this._map.fire(new ur(t.type,this._map,t))}touchcancel(t){this._map.fire(new ur(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new lr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new lr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new lr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dr{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(c(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e,o=this._startPos,r=this._lastPos;if(!o||!r||r.equals(n)||!this._box&&n.dist(o)<this._clickTolerance)return;this._lastPos=n,this._box||(this._box=i("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const s=Math.min(o.x,n.x),a=Math.max(o.x,n.x),l=Math.min(o.y,n.y),u=Math.max(o.y,n.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform="translate(".concat(s,"px,").concat(l,"px)"),this._box.style.width=a-s+"px",this._box.style.height=u-l+"px")}))}mouseupWindow(e,n){if(!this._active)return;const o=this._startPos,r=n;if(o&&0===e.button){if(this.reset(),d(),o.x!==r.x||o.y!==r.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(o,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),p(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}function fr(t,e){const n={};for(let o=0;o<t.length;o++)n[t[o].identifier]=e[o];return n}class gr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,n,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=e.timeStamp),o.length===this.numTouches&&(this.centroid=function(e){const n=new t.Point(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=fr(o,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const o=fr(n,e);for(const r in this.touches){const t=o[r];(!t||t.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class mr{constructor(t){this.singleTap=new gr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const o=this.singleTap.touchend(t,e,n);if(o){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(o)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=o,this.count===this.numTaps)return this.reset(),o}}}class yr{constructor(){this._zoomIn=new mr({numTouches:1,numTaps:2}),this._zoomOut=new mr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const o=this._zoomIn.touchend(t,e,n),r=this._zoomOut.touchend(t,e,n);return o?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(o)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const vr={0:1,2:2};class _r{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=m(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),null!=this._eventButton&&function(t,e){const n=vr[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&m(t)===this._eventButton&&(this._moved&&d(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cr extends _r{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class wr extends _r{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class br extends _r{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class xr{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),t.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(e,n,o){if(this._active&&!(o.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===o.length&&!t.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,n,o)}}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,o){o.length>0&&(this._active=!0);const r=fr(o,n),i=new t.Point(0,0),s=new t.Point(0,0);let a=0;for(const t in r){const e=r[t],n=this._touches[t];n&&(i._add(e),s._add(e.sub(n)),a++,r[t]=e)}if(this._touches=r,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:i.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=i("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class Er{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){const o=this._firstTwoTouches;if(!o)return;t.preventDefault();const[r,i]=o,s=Sr(n,e,r),a=Sr(n,e,i);if(!s||!a)return;const l=this._aroundCenter?null:s.add(a).div(2);return this._move([s,a],l,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[o,r]=this._firstTwoTouches,i=Sr(n,e,o),s=Sr(n,e,r);i&&s||(this._active&&d(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Sr(t,e,n){for(let o=0;o<t.length;o++)if(t[o].identifier===n)return e[o]}function Tr(t,e){return Math.log(t/e)/Math.LN2}class Rr extends Er{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Tr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Tr(this._distance,n),pinchAround:e}}}function Or(t,e){return 180*t.angleWith(e)/Math.PI}class Pr extends Er{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),n&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Or(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=this._startVector;if(!n)return!1;const o=Or(t,n);return Math.abs(o)<e}}function Ir(t){return Math.abs(t.y)>Math.abs(t.x)}class Ar extends Er{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,Ir(t[0].sub(t[1]))&&(this._valid=!1)}_move(e,n,o){const r=this._lastPoints;if(!r)return;const i=e[0].sub(r[0]),s=e[1].sub(r[1]);return this._map._cooperativeGestures&&!t.isFullscreen()&&o.touches.length<3||(this._valid=this.gestureBeginsVertically(i,s,o.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(i.y+s.y)/2*-.5})}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const o=t.mag()>=2,r=e.mag()>=2;if(!o&&!r)return;if(!o||!r)return null==this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const i=t.y>0==e.y>0;return Ir(t)&&Ir(e)&&i}}const Dr={panStep:100,bearingStep:15,pitchStep:10};class Mr{constructor(){const t=Dr;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,o=0,r=0,i=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?o=1:(t.preventDefault(),i=-1);break;case 40:t.shiftKey?o=-1:(t.preventDefault(),i=1);break;default:return}return this._rotationDisabled&&(n=0,o=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Lr,zoom:e?Math.round(a)+e*(t.shiftKey?2:1):a,bearing:s.getBearing()+n*this._bearingStep,pitch:s.getPitch()+o*this._pitchStep,offset:[-r*this._panStep,-i*this._panStep],center:s.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Lr(t){return t*(2-t)}const Nr=4.000244140625;class Fr{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||t.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const o=t.exported.now(),r=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==n&&n%Nr==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=f(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform;"wheel"===this._type&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>Nr?this._wheelZoomRate:this._defaultZoomRate;let o=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==o&&(o=1/o);const r=n(),i=Math.pow(2,r),s="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):i;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(s*o))),"wheel"===this._type&&(this._startZoom=r,this._easing=this._smoothOutEasing(200)),this._delta=0}const o="number"==typeof this._targetZoom?this._targetZoom:n(),r=this._startZoom,i=this._easing;let s,a=!1;if("wheel"===this._type&&r&&i){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),n=i(e);s=t.number(r,o,n),e<1?this._frameId||(this._frameId=!0):a=!0}else s=o,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:s-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.ease;if(this._prevEase){const e=this._prevEase,o=(t.exported.now()-e.start)/e.duration,r=e.easing(o+.01)-e.easing(o),i=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-i*i);n=t.bezier(i,s,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=i("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(t.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class kr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Gr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Br{constructor(){this._tap=new mr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const o=e[0],r=o.y-this._swipePoint.y;return this._swipePoint=o,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vr{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class zr{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jr{constructor(t,e,n,o){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=o,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Hr=t=>t.zoom||t.drag||t.pitch||t.rotate;class Ur extends t.Event{}class Wr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const o=t.sub([],n,e);this.radius=t.length(o[2]<0?t.div([],o,this.constants):[o[0],o[1],0])}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$1(e,e,this.constants);const n=t.scale$2([],e,this.radius);if(n[2]>0){const e=t.scale$2([],[0,0,1],t.dot(n,[0,0,1])),o=t.scale$2([],t.normalize([],[n[0],n[1],0]),this.radius),r=t.add([],n,t.scale$2([],t.sub([],t.add([],o,e),n),2));n[0]=r[0],n[1]=r[1]}return n}}function qr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class Xr{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ir(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Wr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),t.bindAll(["handleEvent","handleWindowEvent"],this);const o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[r,i,s]of this._listeners)r.addEventListener(i,r===t.window.document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[e,n,o]of this._listeners)e.removeEventListener(n,e===t.window.document?this.handleWindowEvent:this.handleEvent,o)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new pr(e,t));const o=e.boxZoom=new dr(e,t);this._add("boxZoom",o);const r=new yr,i=new Gr;e.doubleClickZoom=new kr(i,r),this._add("tapZoom",r),this._add("clickZoom",i);const s=new Br;this._add("tapDragZoom",s);const a=e.touchPitch=new Ar(e);this._add("touchPitch",a);const l=new wr(t),u=new br(t);e.dragRotate=new zr(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);const c=new Cr(t),p=new xr(e,t);e.dragPan=new Vr(n,c,p),this._add("mousePan",c),this._add("touchPan",p,["touchZoom","touchRotate"]);const h=new Pr,d=new Rr;e.touchZoomRotate=new jr(n,d,h,s),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hr(e));const f=e.scrollZoom=new Fr(e,this);this._add("scrollZoom",f,["mousePan"]);const g=e.keyboard=new Mr;this._add("keyboard",g);for(const m of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[m]&&e[m].enable(t[m])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hr(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,e,n){for(const o in t)if(o!==n&&(!e||e.indexOf(o)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,"".concat(t.type,"Window"))}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){this._updatingCamera=!0;const n="renderFrame"===t.type,o=n?void 0:t,r={needsRenderFrame:!1},i={},s={},a=t.touches?this._getMapTouches(t.touches):void 0,l=a?g(this._el,a):n?void 0:f(this._el,t);for(const{handlerName:p,handler:h,allowed:d}of this._handlers){if(!h.isEnabled())continue;let n;this._blockedByActive(s,d,p)?h.reset():h[e||t.type]&&(n=h[e||t.type](t,l,a),this.mergeHandlerResult(r,i,n,p,o),n&&n.needsRenderFrame&&this._triggerRenderFrame()),(n||h.isActive())&&(s[p]=h)}const u={};for(const p in this._previousActiveHandlers)s[p]||(u[p]=o);this._previousActiveHandlers=s,(Object.keys(u).length||qr(r))&&(this._changes.push([r,i,u]),this._triggerRenderFrame()),(Object.keys(s).length||qr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:c}=r;c&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],c(this._map))}mergeHandlerResult(e,n,o,r,i){if(!o)return;t.extend(e,o);const s={handlerName:r,originalEvent:o.originalEvent||i};void 0!==o.zoomDelta&&(n.zoom=s),void 0!==o.panDelta&&(n.drag=s),void 0!==o.pitchDelta&&(n.pitch=s),void 0!==o.bearingDelta&&(n.rotate=s)}_applyChanges(){const e={},n={},o={};for(const[r,i,s]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.aroundCoord&&(e.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),t.extend(n,i),t.extend(o,s);this._updateMapTransform(e,n,o),this._changes=[]}_updateMapTransform(e,n,o){const r=this._map,i=r.transform,s=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!qr(e)){const t=i.zoom;i.cameraElevationReference="sea",i.recenterOnTerrain(),i.cameraElevationReference="ground",t!==i.zoom&&this._map._update(!0)}if(i._isCameraConstrained&&r._stop(!0),!qr(e))return void this._fireEvents(n,o,!0);let{panDelta:a,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:p,aroundCoord:h,pinchAround:d}=e;i._isCameraConstrained&&(l>0&&(l=0),i._isCameraConstrained=!1),void 0!==d&&(p=d),(l||(t=>n[t]&&!this._eventsInProgress[t])("drag"))&&p&&(this._dragOrigin=s(i.pointCoordinate3D(p)),this._trackingEllipsoid.setup(i._camera.position,this._dragOrigin)),i.cameraElevationReference="sea",r._stop(!0),p=p||r.transform.centerPoint,u&&(i.bearing+=u),c&&(i.pitch+=c),i._updateCameraState();const f=[0,0,0];if(a)if("mercator"===i.projection.name){const t=this._trackingEllipsoid.projectRay(i.screenPointToMercatorRay(p).dir),e=this._trackingEllipsoid.projectRay(i.screenPointToMercatorRay(p.sub(a)).dir);f[0]=e[0]-t[0],f[1]=e[1]-t[1]}else{const e=i.pointCoordinate(p);if("globe"===i.projection.name){a=a.rotate(-i.angle);const n=i._pixelsPerMercatorPixel/i.worldSize;f[0]=-a.x*t.mercatorScale(t.latFromMercatorY(e.y))*n,f[1]=-a.y*t.mercatorScale(i.center.lat)*n}else{const t=i.pointCoordinate(p.sub(a));e&&t&&(f[0]=t.x-e.x,f[1]=t.y-e.y)}}const g=i.zoom,m=[0,0,0];if(l){const e=s(h||i.pointCoordinate3D(p)),n={dir:t.normalize([],t.sub([],e,i._camera.position))};if(n.dir[2]<0){const o=i.zoomDeltaToMovement(e,l);t.scale$2(m,n.dir,o)}}const y=t.add(f,f,m);i._translateCameraConstrained(y),l&&Math.abs(i.zoom-g)>1e-4&&i.recenterOnTerrain(),i.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,o,!0)}_fireEvents(e,n,o){const r=Hr(this._eventsInProgress),i=Hr(e),s={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(s["".concat(t,"start")]=n),this._eventsInProgress[t]=e[t]}!r&&i&&this._fireEvent("movestart",i.originalEvent);for(const t in s)this._fireEvent(t,s[t]);i&&this._fireEvent("move",i.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const a={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:o}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||o,a["".concat(t,"end")]=l)}for(const t in a)this._fireEvent(t,a[t]);const u=Hr(this._eventsInProgress);if(o&&(r||i)&&!u){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{this._frameId=void 0,this.handleEvent(new Ur("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Yr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Kr extends t.Evented{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=!1!==n.respectPrefersReducedMotion,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,o){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),o)}panTo(e,n,o){return this.easeTo(t.extend({center:e},n),o)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,o){return this.easeTo(t.extend({zoom:e},n),o)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,o){return this.easeTo(t.extend({bearing:e},n),o)}resetNorth(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.LngLatBounds.convert(e);const o=n&&n.bearing||0,r=n&&n.pitch||0,i=e.getNorthWest(),s=e.getSouthEast();return this._cameraForBounds(this.transform,i,s,o,r,n)}_extendCameraOptions(e){const n={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t}}return e.padding=t.extend(n,e.padding),e}_minimumAABBFrustumDistance(t,e){const n=e.max[0]-e.min[0],o=e.max[1]-e.min[1];return n/o>t.aspect?n/(2*Math.tan(.5*t.fovX)*t.aspect):o/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(e,n,o,r,i,s){const a=e.clone(),l=this._extendCameraOptions(s);a.bearing=r,a.pitch=i;const u=t.LngLat.convert(n),c=t.LngLat.convert(o),p=.5*(u.lat+c.lat),h=.5*(u.lng+c.lng),d=t.latLngToECEF(p,h),f=t.normalize([],d),g=t.normalize([],t.cross([],f,[0,1,0])),m=t.cross([],g,f),y=[g[0],g[1],g[2],0,m[0],m[1],m[2],0,f[0],f[1],f[2],0,0,0,0,1],v=[d,t.latLngToECEF(u.lat,u.lng),t.latLngToECEF(c.lat,u.lng),t.latLngToECEF(c.lat,c.lng),t.latLngToECEF(u.lat,c.lng),t.latLngToECEF(p,u.lng),t.latLngToECEF(p,c.lng),t.latLngToECEF(u.lat,h),t.latLngToECEF(c.lat,h)];let _=t.Aabb.fromPoints(v.map((e=>[t.dot(g,e),t.dot(m,e),t.dot(f,e)])));const C=t.transformMat4([],_.center,y);0===t.squaredLength(C)&&t.set(C,0,0,1),t.normalize(C,C),t.scale$2(C,C,t.GLOBE_RADIUS),a.center=t.ecefToLatLng(C);const w=a.getWorldToCameraMatrix(),b=t.invert(new Float64Array(16),w);_=t.Aabb.applyTransform(_,t.multiply([],w,y)),t.transformMat4(C,C,w);const x=.5*(_.max[2]-_.min[2]),E=this._minimumAABBFrustumDistance(a,_),S=t.scale$2([],[0,0,1],x),T=t.add(S,C,S),R=E+(0===a.pitch?0:t.distance(C,T)),O=a.globeCenterInViewSpace,P=t.sub([],C,[O[0],O[1],O[2]]);t.normalize(P,P),t.scale$2(P,P,R);const I=t.add([],C,P);t.transformMat4(I,I,b);const A=t.earthRadius/t.GLOBE_RADIUS,D=t.length(I),M=t.mercatorZfromAltitude(Math.max(D*A-t.earthRadius,Number.EPSILON),0),L=Math.min(a.zoomFromMercatorZAdjusted(M),l.maxZoom);return L>.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"mercator"}),a.zoom=L,this._cameraForBounds(a,n,o,r,i,s)):{center:a.center,zoom:L,bearing:r,pitch:i}}queryTerrainElevation(e,n){const o=this.transform.elevation;return o?(n=t.extend({},{exaggerated:!0},n),o.getAtPoint(t.MercatorCoordinate.fromLngLat(e),null,n.exaggerated)):null}_cameraForBounds(e,n,o,r,i,s){if("globe"===e.projection.name)return this._cameraForBoundsOnGlobe(e,n,o,r,i,s);const a=e.clone(),l=this._extendCameraOptions(s),u=a.padding;a.bearing=r,a.pitch=i;const c=t.LngLat.convert(n),p=t.LngLat.convert(o),h=new t.LngLat(c.lng,p.lat),d=new t.LngLat(p.lng,c.lat),f=a.project(c),g=a.project(p),m=this.queryTerrainElevation(c),y=this.queryTerrainElevation(p),v=this.queryTerrainElevation(h),_=this.queryTerrainElevation(d),C=[[f.x,f.y,Math.min(m||0,y||0,v||0,_||0)],[g.x,g.y,Math.max(m||0,y||0,v||0,_||0)]];let w=t.Aabb.fromPoints(C);const b=a.getWorldToCameraMatrix(),x=t.invert(new Float64Array(16),b);w=t.Aabb.applyTransform(w,b);const E=t.sub([],w.max,w.min),S=u.left||0,T=u.right||0,R=u.bottom||0,O=u.top||0,{left:P,right:I,top:A,bottom:D}=l.padding,M=.5*(S+T),L=.5*(O+R),N=Math.min(a.scaleZoom(a.scale*Math.min((a.width-(S+T+P+I))/E[0],(a.height-(R+O+D+A))/E[1])),l.maxZoom),F=a.scale/a.zoomScale(N);w=new t.Aabb([w.min[0]-(P+M)*F,w.min[1]-(D+L)*F,w.min[2]],[w.max[0]+(I+M)*F,w.max[1]+(A+L)*F,w.max[2]]);const k=.5*E[2],G=this._minimumAABBFrustumDistance(a,w),B=[0,0,1,0];t.transformMat4$1(B,B,b),t.normalize$2(B,B);const V=t.scale$2([],B,G+k),z=t.add([],w.center,V),j=("number"==typeof l.offset.x&&"number"==typeof l.offset.y?new t.Point(l.offset.x,l.offset.y):t.Point.convert(l.offset)).rotate(-t.degToRad(r));w.center[0]-=j.x*F,w.center[1]+=j.y*F,t.transformMat4(w.center,w.center,x),t.transformMat4(z,z,x);const H=[w.center[0],w.center[1],z[2]*a.pixelsPerMeter];t.scale$2(H,H,1/a.worldSize);const U=t.lngFromMercatorX(H[0]),W=t.latFromMercatorY(H[1]),q=Math.min(a._zoomFromMercatorZ(H[2]),l.maxZoom),X=new t.LngLat(U,W);return a.mercatorFromTransition&&q<.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"globe"}),a.zoom=q,this._cameraForBounds(a,n,o,r,i,s)):{center:X,zoom:q,bearing:r,pitch:i}}fitBounds(t,e,n){const o=this.cameraForBounds(t,e);return this._fitInternal(o,e,n)}fitScreenCoordinates(e,n,o,r,i){const s=t.Point.convert(e),a=t.Point.convert(n),l=new t.Point(Math.min(s.x,a.x),Math.min(s.y,a.y)),u=new t.Point(Math.max(s.x,a.x),Math.max(s.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(s,a))return this;const c=this.transform.pointLocation3D(l),p=this.transform.pointLocation3D(u),h=this.transform.pointLocation3D(new t.Point(l.x,u.y)),d=this.transform.pointLocation3D(new t.Point(u.x,l.y)),f=[Math.min(c.lng,p.lng,h.lng,d.lng),Math.min(c.lat,p.lat,h.lat,d.lat)],g=[Math.max(c.lng,p.lng,h.lng,d.lng),Math.max(c.lat,p.lat,h.lat,d.lat)],m=r&&r.pitch?r.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,f,g,o,m,r);return this._fitInternal(y,r,i)}_fitInternal(e,n,o){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,o):this.flyTo(n,o)):this}jumpTo(e,n){this.stop();const o=e.preloadOnly?this.transform.clone():this.transform;let r=!1,i=!1,s=!1;return"zoom"in e&&o.zoom!==+e.zoom&&(r=!0,o.zoom=+e.zoom),void 0!==e.center&&(o.center=t.LngLat.convert(e.center)),"bearing"in e&&o.bearing!==+e.bearing&&(i=!0,o.bearing=+e.bearing),"pitch"in e&&o.pitch!==+e.pitch&&(s=!0,o.pitch=+e.pitch),null==e.padding||o.isPaddingEqual(e.padding)||(o.padding=e.padding),e.preloadOnly?(this._preloadTiles(o),this):(this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),i&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),s&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||t.warnOnce(Yr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){const o=this.transform;if(!o.projection.supportsFreeCamera)return t.warnOnce(Yr),this;this.stop();const r=o.zoom,i=o.pitch,s=o.bearing;o.setFreeCameraOptions(e);const a=r!==o.zoom,l=i!==o.pitch,u=s!==o.bearing;return this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),a&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),u&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),l&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||this._prefersReducedMotion(e))&&(e.duration=0);const o=this.transform,r=this.getZoom(),i=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?+e.zoom:r,u="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:o.padding,h=t.Point.convert(e.offset);let d,f,g;if("globe"===o.projection.name){const n=t.MercatorCoordinate.fromLngLat(o.center),r=h.rotate(-o.angle);n.x+=r.x/o.worldSize,n.y+=r.y/o.worldSize;const i=n.toLngLat(),s=t.LngLat.convert(e.center||i);this._normalizeCenter(s),d=o.centerPoint.add(r),f=new t.Point(n.x,n.y).mult(o.worldSize),g=new t.Point(t.mercatorXfromLng(s.lng),t.mercatorYfromLat(s.lat)).mult(o.worldSize).sub(f)}else{d=o.centerPoint.add(h);const n=o.pointLocation(d),r=t.LngLat.convert(e.center||n);this._normalizeCenter(r),f=o.project(n),g=o.project(r).sub(f)}const m=o.zoomScale(l-r);let y,v;e.around&&(y=t.LngLat.convert(e.around),v=o.locationPoint(y));const _=this._zooming||l!==r,C=this._rotating||i!==u,w=this._pitching||c!==s,b=!o.isPaddingEqual(p),x=o=>x=>{if(_&&(o.zoom=t.number(r,l,x)),C&&(o.bearing=t.number(i,u,x)),w&&(o.pitch=t.number(s,c,x)),b&&(o.interpolatePadding(a,p,x),d=o.centerPoint.add(h)),y)o.setLocationAtPoint(y,v);else{const t=o.zoomScale(o.zoom-r),e=l>r?Math.min(2,m):Math.max(.5,m),n=Math.pow(e,1-x),i=o.unproject(f.add(g.mult(x*n)).mult(t));o.setLocationAtPoint(o.renderWorldCopies?i.wrap():i,d)}return e.preloadOnly||this._fireMoveEvents(n),o};if(e.preloadOnly){const t=this._emulate(x,e.duration,o);return this._preloadTiles(t),this}const E={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_,this._rotating=C,this._pitching=w,this._padding=b,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,E),this._ease(x(o),(t=>{o.recenterOnTerrain(),this._afterEase(n,t)}),e),this}_prepareEase(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",n||o.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!o.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!o.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!o.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const o=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,o&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,n){if(this._prefersReducedMotion(e)){const o=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const o=this.transform,r=this.getZoom(),i=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):r,u="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:o.padding,h=o.zoomScale(l-r),d=t.Point.convert(e.offset);let f=o.centerPoint.add(d);const g=o.pointLocation(f),m=t.LngLat.convert(e.center||g);this._normalizeCenter(m);const y=o.project(g),v=o.project(m).sub(y);let _=e.curve;const C=Math.max(o.width,o.height),w=C/h,b=v.mag();if("minZoom"in e){const n=t.clamp(Math.min(e.minZoom,r,l),o.minZoom,o.maxZoom),i=C/o.zoomScale(n-r);_=Math.sqrt(i/b*2)}const x=_*_;function E(t){const e=(w*w-C*C+(t?-1:1)*x*x*b*b)/(2*(t?w:C)*x*b);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}const R=E(0);let O=function(t){return T(R)/T(R+_*t)},P=function(t){return C*((T(R)*(S(e=R+_*t)/T(e))-S(R))/x)/b;var e},I=(E(1)-R)/_;if(Math.abs(b)<1e-6||!isFinite(I)){if(Math.abs(C-w)<1e-6)return this.easeTo(e,n);const t=w<C?-1:1;I=Math.abs(Math.log(w/C))/_,P=function(){return 0},O=function(e){return Math.exp(t*_*e)}}e.duration="duration"in e?+e.duration:1e3*I/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const A=i!==u,D=c!==s,M=!o.isPaddingEqual(p),L=o=>h=>{const g=h*I,_=1/O(g);o.zoom=1===h?l:r+o.scaleZoom(_),A&&(o.bearing=t.number(i,u,h)),D&&(o.pitch=t.number(s,c,h)),M&&(o.interpolatePadding(a,p,h),f=o.centerPoint.add(d));const C=1===h?m:o.unproject(y.add(v.mult(P(g))).mult(_));return o.setLocationAtPoint(o.renderWorldCopies?C.wrap():C,f),o._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(n),o};if(e.preloadOnly){const t=this._emulate(L,e.duration,o);return this._preloadTiles(t),this}return this._zooming=!0,this._rotating=A,this._pitching=D,this._padding=M,this._prepareEase(n,!1),this._ease(L(o),(()=>this._afterEase(n)),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const t=this._onEaseEnd;this._onEaseEnd=void 0,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,o){!1===o.animate||0===o.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=o,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.wrap(e,-180,180);const o=Math.abs(e-n);return Math.abs(e-360-n)<o&&(e-=360),Math.abs(e+360-n)<o&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.maxBounds)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&t.exported.prefersReducedMotion&&!(e&&e.essential)}_emulate(t,e,n){const o=Math.ceil(15*e/1e3),r=[],i=t(n.clone());for(let s=0;s<=o;s++){const t=i(s/o);r.push(t.clone())}return r}}class Zr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=i("button","mapboxgl-ctrl-attrib-button",this._container),i("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=i("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString("AttributionControl.".concat(e));t.setAttribute("aria-label",n),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const o=n.reduce(((t,e,o)=>(e.value&&(t+="".concat(e.key,"=").concat(e.value).concat(o<n.length-1?"&":"")),t)),"?");e.href="".concat(t.config.FEEDBACK_URL,"/").concat(o,"#").concat($o(this._map,!0)),e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._sourceCaches;for(const o in e){const n=e[o];if(n.used){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,n)=>{for(let o=n+1;o<t.length;o++)if(t[o].indexOf(e)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Jr{constructor(){t.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=i("div","mapboxgl-ctrl");const e=i("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const n=t[e].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class Qr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const o of n)if(o.id===t)return void(o.cancelled=!0)}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function $r(e,n,o){if(e=new t.LngLat(e.lng,e.lat),n){const r=new t.LngLat(e.lng-360,e.lat),i=new t.LngLat(e.lng+360,e.lat),s=360*Math.ceil(Math.abs(e.lng-o.center.lng)/360),a=o.locationPoint(e).distSqr(n),l=n.x<0||n.y<0||n.x>o.width||n.y>o.height;o.locationPoint(r).distSqr(n)<a&&(l||Math.abs(r.lng-o.center.lng)<s)?e=r:o.locationPoint(i).distSqr(n)<a&&(l||Math.abs(i.lng-o.center.lng)<s)&&(e=i)}for(;Math.abs(e.lng-o.center.lng)>180;){const t=o.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=o.width&&t.y<=o.height)break;e.lng>o.center.lng?e.lng-=360:e.lng+=360}return e}const ti={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ei extends t.Evented{constructor(e,n){if(super(),(e instanceof t.window.HTMLElement||n)&&(e=t.extend({element:e},n)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=t.Point.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=i("div");const n=41,o=27,r=s("svg",{display:"block",height:n*this._scale+"px",width:o*this._scale+"px",viewBox:"0 0 ".concat(o," ").concat(n)},this._element),a=s("radialGradient",{id:"shadowGradient"},s("defs",{},r));s("stop",{offset:"10%","stop-opacity":.4},a),s("stop",{offset:"100%","stop-opacity":.05},a),s("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},r),s("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},r),s("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},r),s("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},r),this._offset=t.Point.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()}));const o=this._element.classList;for(const t in ti)o.remove("mapboxgl-marker-anchor-".concat(t));o.add("mapboxgl-marker-anchor-".concat(this._anchor)),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,o=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[o,-1*(e-n+o)],"bottom-right":[-o,-1*(e-n+o)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,e=this._pos;if(!t||!e)return!1;const n=t.unproject(e),o=t.getFreeCameraOptions();if(!o.position)return!1;const r=o.position.toLngLat();return r.distanceTo(n)<.9*r.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const n=this._pos;if(!n||n.x<0||n.x>e.transform.width||n.y<0||n.y>e.transform.height)return void this._clearFadeTimer();const o=e.unproject(n);let r;e._showingGlobe()&&t.isLngLatBehindGlobe(e.transform,this._lngLat)?r=0:(r=1-e._queryFogOpacity(o),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(r*=this._occludedOpacity)),this._element.style.opacity="".concat(r),this._element.style.pointerEvents=r>0?"auto":"none",this._popup&&this._popup._setOpacity(r),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const e=this._offset.mult(this._scale);this._element.style.transform="\n            translate(".concat(t.x,"px,").concat(t.y,"px)\n            ").concat(ti[this._anchor],"\n            ").concat(this._calculateXYTransform()," ").concat(this._calculateZTransform(),"\n            translate(").concat(e.x,"px,").concat(e.y,"px)\n        ")}_calculateXYTransform(){const e=this._pos,n=this._map,o=this.getPitchAlignment();if(!n||!e||"map"!==o)return"";if(!n._showingGlobe()){const t=n.getPitch();return t?"rotateX(".concat(t,"deg)"):""}const r=t.radToDeg(t.globeTiltAtLngLat(n.transform,this._lngLat)),i=e.sub(t.globeCenterToScreenPoint(n.transform)),s=Math.abs(i.x)+Math.abs(i.y);if(0===s)return"";const a=r/s;return"rotateX(".concat(-i.y*a,"deg) rotateY(").concat(i.x*a,"deg)")}_calculateZTransform(){const e=this._pos,n=this._map;if(!n||!e)return"";let o=0;const r=this.getRotationAlignment();if("map"===r)if(n._showingGlobe()){const e=n.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),r=n.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(e);o=t.radToDeg(Math.atan2(r.y,r.x))-90}else o=-n.getBearing();else if("horizon"===r){const r=t.smoothstep(4,6,n.getZoom()),i=t.globeCenterToScreenPoint(n.transform);i.y+=r*n.transform.height;const s=e.sub(i),a=t.radToDeg(Math.atan2(s.y,s.x));o=(a>90?a-270:a+90)*(1-r)}return o+=this._rotation,o?"rotateZ(".concat(o,"deg)"):""}_update(e){t.window.cancelAnimationFrame(this._updateFrameId);const n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=$r(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),!0===e?this._updateFrameId=t.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),n._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(n._showingGlobe()||n.getTerrain()||n.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(e){return this._offset=t.Point.convert(e),this._update(),this}_onMove(e){const n=this._map;if(!n)return;const o=this._pointerdownPos,r=this._positionDelta;if(o&&r){if(!this._isDragging){const t=this._clickTolerance||n._clickTolerance;if(e.point.dist(o)<t)return;this._isDragging=!0}this._pos=e.point.sub(r),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){const e=this._map,n=this._pos;e&&n&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(n),this._pointerdownPos=t.point,this._state="pending",e.on("mousemove",this._onMove),e.on("touchmove",this._onMove),e.once("mouseup",this._onUp),e.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const e=this._map;return e&&(t?(e.on("mousedown",this._addDragHandler),e.on("touchstart",this._addDragHandler)):(e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ni={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},oi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ri(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t.Point(0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof e){const o=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(n){case"top":return new t.Point(0,e);case"top-left":return new t.Point(o,o);case"top-right":return new t.Point(-o,o);case"bottom":return new t.Point(0,-e);case"bottom-left":return new t.Point(o,-o);case"bottom-right":return new t.Point(-o,-o);case"left":return new t.Point(e,0);case"right":return new t.Point(-e,0)}return new t.Point(0,0)}return e instanceof t.Point||Array.isArray(e)?t.Point.convert(e):t.Point.convert(e[n]||[0,0])}class ii{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const n=t.easeCubicInOut((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,n){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+n}}const si={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ai={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},li={showCompass:!0,showZoom:!0,visualizePitch:!1};class ui{constructor(e,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._clickTolerance=10,this.element=n,this.mouseRotate=new wr({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,o&&(this.mousePitch=new br({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),c()}move(t,e){const n=this.map,o=this.mouseRotate.mousemoveWindow(t,e),r=o&&o.bearingDelta;if(r&&n.setBearing(n.getBearing()+r),this.mousePitch){const o=this.mousePitch.mousemoveWindow(t,e),r=o&&o.pitchDelta;r&&n.setPitch(n.getPitch()+r)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){p(),t.window.removeEventListener("mousemove",this.mousemove),t.window.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),f(this.element,e)),t.window.addEventListener("mousemove",this.mousemove),t.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,f(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=g(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=g(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ci={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},pi={maxWidth:100,unit:"metric"},hi={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},di={version:t.version,supported:n,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Kr{constructor(e){if(t.LivePerformanceUtils.mark(t.PerformanceMarkers.create),null!=(e=t.extend({},ai,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&t.isSafariWithAntialiasingBug(t.window)&&(e.antialias=!1,t.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Zo(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._useWebGL2=e.useWebGL2,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new Qr,this._domRenderTaskQueue=new Qr,this._controls=[],this._markers=[],this._popups=[],this._mapId=t.uniqueId(),this._locale=t.extend({},si,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ii(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '".concat(e.container,"' not found."))}else{if(!(e.container instanceof t.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&t.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1),t.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Xr(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),this._hash=e.hash&&new Qo("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),e.attributionControl&&this.addControl(new Zr({customAttribution:e.customAttribution})),this._logoControl=new Jr,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.Event("".concat(e.dataType,"data"),e))})),this.on("dataloading",(e=>{this.fire(new t.Event("".concat(e.dataType,"dataloading"),e))}))}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(o,r.firstChild):r.appendChild(o),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)),this.fire(new t.Event("resize",e)),n&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?85:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return"auto"===e?t.window.navigator.language:Array.isArray(e)?0===e.length?void 0:e.map((e=>"auto"===e?t.window.navigator.language:e)):e}setLanguage(t){const e=this._parseLanguage(t);if(!this.style||e===this._language)return this;this._language=e,this.style._reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(t){return this.style&&t!==this._worldview?(this._worldview=t,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(t){return this._lazyInitEmptyStyle(),t?"string"==typeof t&&(t={name:t}):t=null,this._useExplicitProjection=!!t,this._prioritizeAndUpdateProjection(t,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const e=this.transform,n=e.projection.name;let o;"globe"===n&&e.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?(e.setMercatorFromTransition(),o=!0):"mercator"===n&&e.zoom<t.GLOBE_ZOOM_THRESHOLD_MAX&&(e.setProjection({name:"globe"}),o=!0),o&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(t,e){return this._updateProjection(t||e||{name:"mercator"})}_updateProjection(e){let n;if(n="globe"===e.name&&this.transform.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),n){this.painter.clearBackgroundTiles();for(const t in this.style._sourceCaches)this.style._sourceCaches[t].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.Point.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let o=!1;const r=r=>{const i=e.filter((t=>this.getLayer(t))),s=i.length?this.queryRenderedFeatures(r.point,{layers:i}):[];s.length?o||(o=!0,n.call(this,new lr(t,this,r.originalEvent,{features:s}))):o=!1},i=()=>{o=!1};return{layers:new Set(e),listener:n,delegates:{mousemove:r,mouseout:i}}}if("mouseleave"===t||"mouseout"===t){let o=!1;const r=r=>{const i=e.filter((t=>this.getLayer(t)));(i.length?this.queryRenderedFeatures(r.point,{layers:i}):[]).length?o=!0:o&&(o=!1,n.call(this,new lr(t,this,r.originalEvent)))},i=e=>{o&&(o=!1,n.call(this,new lr(t,this,e.originalEvent)))};return{layers:new Set(e),listener:n,delegates:{mousemove:r,mouseout:i}}}{const o=t=>{const o=e.filter((t=>this.getLayer(t))),r=o.length?this.queryRenderedFeatures(t.point,{layers:o}):[];r.length&&(t.features=r,n.call(this,t),delete t.features)};return{layers:new Set(e),listener:n,delegates:{[t]:o}}}}on(t,e,n){if(void 0===n)return super.on(t,e);Array.isArray(e)||(e=[e]);const o=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(o);for(const r in o.delegates)this.on(r,o.delegates[r]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);Array.isArray(e)||(e=[e]);const o=this._createDelegatedListener(t,e,n);for(const r in o.delegates)this.once(r,o.delegates[r]);return this}off(t,e,n){if(void 0===n)return super.off(t,e);e=new Set(Array.isArray(e)?e:[e]);const o=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0},r=this._delegatedListeners?this._delegatedListeners[t]:void 0;return r&&(t=>{for(let r=0;r<t.length;r++){const i=t[r];if(i.listener===n&&o(i.layers,e)){for(const t in i.delegates)this.off(t,i.delegates[t]);return t.splice(r,1),this}}})(r),this}queryRenderedFeatures(e,n){return this.style?(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}isPointOnSurface(e){const{name:n}=this.transform.projection;return"globe"!==n&&"mercator"!==n&&t.warnOnce("".concat(n," projection does not support isPointOnSurface, this API may behave unexpectedly.")),this.transform.isPointOnSurface(t.Point.convert(e))}setStyle(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(e,n))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error("Missing UI string '".concat(t,"'"));return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),t&&(this.style=new Je(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Je(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const o=this._requestManager.normalizeStyleURL(e),r=this._requestManager.transformRequest(o,t.ResourceType.Style);t.getJSON(r,((e,o)=>{e?this.fire(new t.ErrorEvent(e)):o&&this._updateDiff(o,n)}))}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e)&&this._update(!0)}catch(o){t.warnOnce("Unable to perform style diff: ".concat(o.message||o.error||o,".  Rebuilding the style from scratch.")),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(t.warnOnce("There is no style added to the map."),!1)}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){return!!this.style&&this.style._isSourceCacheLoaded(t)}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,n){this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,n){let{pixelRatio:o=1,sdf:r=!1,stretchX:i,stretchY:s,content:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._lazyInitEmptyStyle(),n instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&n instanceof t.window.ImageBitmap){const{width:l,height:u,data:c}=t.exported.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:o,stretchX:i,stretchY:s,content:a,sdf:r,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:u}=n,c=n;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},new Uint8Array(c.data)),pixelRatio:o,stretchX:i,stretchY:s,content:a,sdf:r,version:0,userImage:c}),c.onAdd&&c.onAdd(this,e)}}updateImage(e,n){const o=this.style.getImage(e);if(!o)return void this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&n instanceof t.window.ImageBitmap?t.exported.getImageData(n):n,{width:i,height:s}=r;void 0!==i&&void 0!==s?i===o.data.width&&s===o.data.height?(o.data.replace(r.data,!(n instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&n instanceof t.window.ImageBitmap)),this.style.updateImage(e,o)):this.fire(new t.ErrorEvent(new Error("The width and height of the updated image (".concat(i,", ").concat(s,")\n                must be that same as the previous version of the image\n                (").concat(o.data.width,", ").concat(o.data.height,")")))):this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),((e,o)=>{n(e,o instanceof t.window.HTMLImageElement?t.exported.getImageData(o):o)}))}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(t,e,n,o),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(t,e,n,o),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),!t&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e),this.transform):0}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let o,r,i,s=this._container;for(;s&&(!r||!i);){const e=t.window.getComputedStyle(s).transform;e&&"none"!==e&&(o=e.match(/matrix.*\((.+)\)/)[1].split(", "),o[0]&&"0"!==o[0]&&"1"!==o[0]&&(r=o[0]),o[3]&&"0"!==o[3]&&"1"!==o[3]&&(i=o[3])),s=s.parentElement}this._containerWidth=r?Math.abs(e/r):e,this._containerHeight=i?Math.abs(n/i):n}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=i("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=i("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=i("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=i("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{o[t]=i("div","mapboxgl-ctrl-".concat(t),n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,n){const o=t.exported.devicePixelRatio||1;this._canvas.width=o*Math.ceil(e),this._canvas.height=o*Math.ceil(n),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(n,"px")}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_addPopup(t){this._popups.push(t)}_removePopup(t){const e=this._popups.indexOf(t);-1!==e&&this._popups.splice(e,1)}_setupPainter(){const e=t.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",e),r=o||this._canvas.getContext("webgl",e)||this._canvas.getContext("experimental-webgl",e);r?(this._useWebGL2&&!o&&t.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),t.storeAuthState(r,!0),this.painter=new ko(r,this.transform,!!o),this.on("data",(t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)})),t.exported$1.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t)}_render(e){let n;const o=this.painter.context.extTimerQuery,r=t.exported.now();if(this.listens("gpu-timing-frame")&&(n=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],t.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],t.window.performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const i=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=this.transform.pitch,o=t.exported.now(),r=new t.EvaluationParameters(e,{now:o,fadeDuration:i,pitch:n,transition:this.style.getTransition()});this.style.update(r)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let s=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),s=this._updateAverageElevation(r),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):s=this._updateAverageElevation(r),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const e=t.exported.now()-r;o.endQueryEXT(o.TIME_ELAPSED_EXT,n),setTimeout((()=>{const i=o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(n),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:i})),t.window.performance.mark("frame-gpu",{startTime:r,detail:{gpuTime:i}})}),50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout((()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:n}))}),50)}if(this.listens("gpu-timing-deferred-render")){const e=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const n=this.painter.queryGpuTimeDeferredRender(e);this.fire(new t.Event("gpu-timing-deferred-render",{gpuTime:n}))}),50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty||s;if(a||this._repaint)this.triggerRepaint();else{const e=!this.isMoving()&&this.loaded();if(e&&(s=this._updateAverageElevation(r,!0)),s)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,t.LivePerformanceUtils.mark(t.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&t.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(t){for(const e of this._markers)t&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!t||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let o=this.transform.sampleAverageElevation(),r=!1;this.transform.elevation&&(r=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(o)?o=0:this._averageElevationLastSampledAt=t;const i=Math.abs(e-o);if(i>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(o),n(o);this._averageElevation.easeTo(o,t,300)}else if(i>1e-4)return this._averageElevation.jumpTo(o),n(o)}return!!this._averageElevation.isEasing(t)&&n(this._averageElevation.getValue(t))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof Jr&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const t=this._isDragging();this.painter.updateTerrain(this.style,t)}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,o=n.createFramebuffer();function r(t){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const e=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,e),e}return n.bindFramebuffer(n.FRAMEBUFFER,o),this._canvasPixelComparison(r(t),e.canvasCopies.map(r),e.timeStamps)}_canvasPixelComparison(t,e,n){let o=n[1]-n[0];const r=t.length/4;for(let i=0;i<e.length;i++){const s=e[i];let a=0;for(let e=0;e<s.length;e+=4)s[e]===t[e]&&s[e+1]===t[e+1]&&s[e+2]===t[e+2]&&s[e+3]===t[e+3]&&(a+=1);o+=(n[i+2]-n[i+1])*(1-a/r)}return o}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1),t.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame((t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)})))}_preloadTiles(e){const n=this.style?Object.values(this.style._sourceCaches):[];return t.asyncAll(n,((t,n)=>t._preloadTiles(e,n)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}_onVisibilityChange(){"hidden"===t.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(t){this._showTileAABBs!==t&&(this._showTileAABBs=t,t&&this._update())}_setCacheLimits(e,n){t.setCacheLimits(e,n)}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},li,e),this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(t=>{this._map&&this._map.zoomIn({},{originalEvent:t})})),i("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(t=>{this._map&&this._map.zoomOut({},{originalEvent:t})})),i("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(t=>{const e=this._map;e&&(this.options.visualizePitch?e.resetNorthPitch({},{originalEvent:t}):e.resetNorth({},{originalEvent:t}))})),this._compassIcon=i("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map;if(!t)return;const e=t.getZoom(),n=e===t.getMaxZoom(),o=e===t.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())}_rotateCompassArrow(){const t=this._map;if(!t)return;const e=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(t.transform.pitch,"deg) rotateZ(").concat(t.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(t.transform.angle*(180/Math.PI),"deg)");t._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=e)}))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),t.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&t.on("pitch",this._rotateCompassArrow),t.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ui(t,this._compass,this.options.visualizePitch)),this._container}onRemove(){const t=this._map;t&&(this._container.remove(),this.options.showZoom&&t.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&t.off("pitch",this._rotateCompassArrow),t.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(t,e){const n=i("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){if(!this._map)return;const n=this._map._getUIString("NavigationControl.".concat(e));t.setAttribute("aria-label",n),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({geolocation:t.window.navigator.geolocation},ci,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Jo(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(t){return this._map=t,this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){var n=this;const o=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!!n.options.geolocation;n._supportsGeolocation=t,e(t)};void 0!==this._supportsGeolocation?e(this._supportsGeolocation):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((t=>o("denied"!==t.state))).catch((()=>o())):o()}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return!!e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude),o=e.coords.accuracy,r=this._map.getBearing(),i=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(o),i,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,n=t.mercatorZfromAltitude(1,e._center.lat)*e.worldSize,o=Math.ceil(2*this._accuracy*n);this._circleElement.style.width="".concat(o,"px"),this._circleElement.style.height="".concat(o,"px")}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=i("button","mapboxgl-ctrl-geolocate",this._container),i("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i("div","mapboxgl-user-location"),this._dotElement.appendChild(i("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(i("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ei({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=i("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ei({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))}))}}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:!0===t.absolute&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{t.window.addEventListener("ondeviceorientationabsolute"in t.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==t.window.DeviceMotionEvent&&"function"==typeof t.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((t=>{"granted"===t&&e()})).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),t.window.removeEventListener("deviceorientation",this._onDeviceOrientation),t.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Zr,ScaleControl:class{constructor(e){this.options=t.extend({},pi,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(t){return!1}}(),t.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const t=this.options.maxWidth||100,e=this._map,n=e._containerHeight/2,o=e._containerWidth/2-t/2,r=e.unproject([o,n]),i=e.unproject([o+t,n]),s=r.distanceTo(i);if("imperial"===this.options.unit){const e=3.2808*s;e>5280?this._setScale(t,e/5280,"mile"):this._setScale(t,e,"foot")}else"nautical"===this.options.unit?this._setScale(t,s/1852,"nautical-mile"):s>=1e3?this._setScale(t,s/1e3,"kilometer"):this._setScale(t,s,"meter")}_setScale(t,e,n){this._map._requestDomTask((()=>{const o=function(t){const e=Math.pow(10,"".concat(Math.floor(t)).length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(e),r=o/e;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==n?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(o):"".concat(o,"&nbsp;").concat(hi[n]),this._container.style.width=t*r+"px"}))}onAdd(t){return this._map=t,this._language=t.getLanguage(),this._container=i("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(t){this._language=t,this._update()}setUnit(t){this.options.unit=t,this._update()}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=i("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=i("button","mapboxgl-ctrl-fullscreen",this._controlContainer);i("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(ni),e),t.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const t=this._map;return t&&(t.off("move",this._update),t.on("mousemove",this._onMouseEvent),t.on("drag",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const n=t.window.document.createDocumentFragment(),o=t.window.document.createElement("body");let r;for(o.innerHTML=e;r=o.firstChild,r;)n.appendChild(r);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=i("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(t),this.options.closeButton){const t=this._closeButton=i("button","mapboxgl-popup-close-button",e);t.type="button",t.setAttribute("aria-label","Close popup"),t.setAttribute("aria-hidden","true"),t.innerHTML="&#215;",t.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._updateClassList(),e}_onMouseEvent(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._map,n=this._container,o=this._pos;if(!e||!n||!o)return"bottom";const r=n.offsetWidth,i=n.offsetHeight,s=o.x<r/2,a=o.x>e.transform.width-r/2;if(o.y+t<i)return s?"top-left":a?"top-right":"top";if(o.y>e.transform.height-i){if(s)return"bottom-left";if(a)return"bottom-right"}return s?"left":a?"right":"bottom"}_updateClassList(){const t=this._container;if(!t)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push("mapboxgl-popup-anchor-".concat(this._anchor)),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),t.className=e.join(" ")}_update(e){const n=this._map,o=this._content;if(!n||!this._lngLat&&!this._trackPointer||!o)return;let r=this._container;if(r||(r=this._container=i("div","mapboxgl-popup",n.getContainer()),this._tip=i("div","mapboxgl-popup-tip",r),r.appendChild(o)),this.options.maxWidth&&r.style.maxWidth!==this.options.maxWidth&&(r.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$r(this._lngLat,this._pos,n.transform)),!this._trackPointer||e){const t=this._pos=this._trackPointer&&e?e:n.project(this._lngLat),o=ri(this.options.offset),r=this._anchor=this._getAnchor(o.y),i=ri(this.options.offset,r),s=t.add(i).round();n._requestDomTask((()=>{this._container&&r&&(this._container.style.transform="".concat(ti[r]," translate(").concat(s.x,"px,").concat(s.y,"px)"))}))}if(!this._marker&&n._showingGlobe()){const e=t.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(e)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(oi);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._container&&(this._container.style.opacity="".concat(t)),this._content&&(this._content.style.pointerEvents=t?"auto":"none")}},Marker:ei,Style:Je,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:jo,Evented:t.Evented,config:t.config,prewarm:function(){Bt().acquire(Ft)},clearPrewarmedResources:function(){const t=Gt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Ft),Gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return kt.workerCount},set workerCount(t){kt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return di})),n}()},1725:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(t){o[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(r){return!1}}()?Object.assign:function(t,r){for(var i,s,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))n.call(i,u)&&(a[u]=i[u]);if(e){s=e(i);for(var c=0;c<s.length;c++)o.call(i,s[c])&&(a[s[c]]=i[s[c]])}}return a}},2592:t=>{"use strict";var e=function(t){return t!==t};t.exports=function(t,n){return 0===t&&0===n?1/t===1/n:t===n||!(!e(t)||!e(n))}},3454:(t,e,n)=>{"use strict";var o=n(9396),r=n(9722),i=n(2592),s=n(3355),a=n(3118),l=r(s(),Object);o(l,{getPolyfill:s,implementation:i,shim:a}),t.exports=l},3355:(t,e,n)=>{"use strict";var o=n(2592);t.exports=function(){return"function"===typeof Object.is?Object.is:o}},3118:(t,e,n)=>{"use strict";var o=n(3355),r=n(9396);t.exports=function(){var t=o();return r(Object,{is:t},{is:function(){return Object.is!==t}}),t}},1949:(t,e,n)=>{"use strict";var o;if(!Object.keys){var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,s=n(7635),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(t){var e=t.constructor;return e&&e.prototype===t},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"===typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"===typeof window[t])try{p(window[t])}catch(e){return!0}}catch(e){return!0}return!1}();o=function(t){var e=null!==t&&"object"===typeof t,n="[object Function]"===i.call(t),o=s(t),a=e&&"[object String]"===i.call(t),h=[];if(!e&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var f=u&&n;if(a&&t.length>0&&!r.call(t,0))for(var g=0;g<t.length;++g)h.push(String(g));if(o&&t.length>0)for(var m=0;m<t.length;++m)h.push(String(m));else for(var y in t)f&&"prototype"===y||!r.call(t,y)||h.push(String(y));if(l)for(var v=function(t){if("undefined"===typeof window||!d)return p(t);try{return p(t)}catch(e){return!1}}(t),_=0;_<c.length;++_)v&&"constructor"===c[_]||!r.call(t,c[_])||h.push(c[_]);return h}}t.exports=o},4892:(t,e,n)=>{"use strict";var o=Array.prototype.slice,r=n(7635),i=Object.keys,s=i?function(t){return i(t)}:n(1949),a=Object.keys;s.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return r(t)?a(o.call(t)):a(t)})}else Object.keys=s;return Object.keys||s},t.exports=s},7635:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),o="[object Arguments]"===n;return o||(o="[object Array]"!==n&&null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),o}},5164:t=>{t.exports=function(t,e,n,o){var r=t[0],i=t[1],s=!1;void 0===n&&(n=0),void 0===o&&(o=e.length);for(var a=(o-n)/2,l=0,u=a-1;l<a;u=l++){var c=e[n+2*l+0],p=e[n+2*l+1],h=e[n+2*u+0],d=e[n+2*u+1];p>i!==d>i&&r<(h-c)*(i-p)/(d-p)+c&&(s=!s)}return s}},5021:(t,e,n)=>{var o=n(5164),r=n(1850);t.exports=function(t,e,n,i){return e.length>0&&Array.isArray(e[0])?r(t,e,n,i):o(t,e,n,i)},t.exports.nested=r,t.exports.flat=o},1850:t=>{t.exports=function(t,e,n,o){var r=t[0],i=t[1],s=!1;void 0===n&&(n=0),void 0===o&&(o=e.length);for(var a=o-n,l=0,u=a-1;l<a;u=l++){var c=e[l+n][0],p=e[l+n][1],h=e[u+n][0],d=e[u+n][1];p>i!==d>i&&r<(h-c)*(i-p)/(d-p)+c&&(s=!s)}return s}},9056:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}var o=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function r(t,e){return t>e?1:t<e?-1:0}function i(t,e,n){for(var r=new o(null,null),i=r,s=r;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;i.right=e,i=e,e=e.right}}return i.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function s(t,e,n,r){var s=new o(t,e);if(null===n)return s.left=s.right=null,s;var a=r(t,(n=i(t,n,r)).key);return a<0?(s.left=n.left,s.right=n,n.left=null):a>=0&&(s.right=n.right,s.left=n,n.right=null),s}function a(t,e,n){var o=null,r=null;if(e){var s=n((e=i(t,e,n)).key,t);0===s?(o=e.left,r=e.right):s<0?(r=e.right,e.right=null,o=e):(o=e.left,e.left=null,r=e)}return{left:o,right:r}}function l(t,e,n){return null===e?t:(null===t||((e=i(t.key,e,n)).left=t),e)}function u(t,e,n,o,r){if(t){o(e+(n?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+r(t)+"\n");var i=e+(n?"    ":"\u2502   ");t.left&&u(t.left,i,!1,o,r),t.right&&u(t.right,i,!0,o,r)}}var c=function(){function t(t){void 0===t&&(t=r),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=s(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new o(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,s=i(t,this._root,r),a=r(t,s.key);return 0===a?this._root=s:(a<0?(n.left=s.left,n.right=s,s.left=null):a>0&&(n.right=s.right,n.left=s,s.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var o;return null===e?null:0===n(t,(e=i(t,e,n)).key)?(null===e.left?o=e.right:(o=i(t,e.left,n)).right=e.right,this._size--,o):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=i(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var o=n(t,e.key);if(0===o)return e;e=o<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=i(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var o=n(t,e.key);if(0===o)return!0;e=o<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,o=[],r=!1;!r;)null!==n?(o.push(n),n=n.left):0!==o.length?(n=o.pop(),t.call(e,n),n=n.right):r=!0;return this},t.prototype.range=function(t,e,n,o){for(var r=[],i=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(i((s=r.pop()).key,e)>0)break;if(i(s.key,t)>=0&&n.call(o,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,o=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),o===t)return e;o++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var o=this._comparator;e;){var r=o(t.key,e.key);if(0===r)break;r<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var o=this._comparator;e;){var r=o(t.key,e.key);if(0===r)break;r<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return d(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var o=t.length,r=this._comparator;if(n&&m(t,e,0,o-1,r),null===this._root)this._root=p(t,e,0,o),this._size=o;else{var i=g(this.toList(),h(t,e),r);o=this._size+o,this._root=f({head:i},0,o)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return u(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var o=this._comparator,r=a(t,this._root,o),i=r.left,u=r.right;o(t,e)<0?u=s(e,n,u,o):i=s(e,n,i,o),this._root=l(i,u,o)},t.prototype.split=function(t){return a(t,this._root,this._comparator)},t}();function p(t,e,n,r){var i=r-n;if(i>0){var s=n+Math.floor(i/2),a=t[s],l=e[s],u=new o(a,l);return u.left=p(t,e,n,s),u.right=p(t,e,s+1,r),u}return null}function h(t,e){for(var n=new o(null,null),r=n,i=0;i<t.length;i++)r=r.next=new o(t[i],e[i]);return r.next=null,n.next}function d(t){for(var e=t,n=[],r=!1,i=new o(null,null),s=i;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:r=!0;return s.next=null,i.next}function f(t,e,n){var o=n-e;if(o>0){var r=e+Math.floor(o/2),i=f(t,e,r),s=t.head;return s.left=i,t.head=t.head.next,s.right=f(t,r+1,n),s}return null}function g(t,e,n){for(var r=new o(null,null),i=r,s=t,a=e;null!==s&&null!==a;)n(s.key,a.key)<0?(i.next=s,s=s.next):(i.next=a,a=a.next),i=i.next;return null!==s?i.next=s:null!==a&&(i.next=a),r.next}function m(t,e,n,o,r){if(!(n>=o)){for(var i=t[n+o>>1],s=n-1,a=o+1;;){do{s++}while(r(t[s],i)<0);do{a--}while(r(t[a],i)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}m(t,e,n,a,r),m(t,e,a+1,o,r)}}var y=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},v=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,o=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:o,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},_=Number.EPSILON;void 0===_&&(_=Math.pow(2,-52));var C=_*_,w=function(t,e){if(-_<t&&t<_&&-_<e&&e<_)return 0;var n=t-e;return n*n<C*t*e?0:t<e?-1:1},b=function(){function e(){t(this,e),this.reset()}return n(e,[{key:"reset",value:function(){this.xRounder=new x,this.yRounder=new x}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),x=function(){function e(){t(this,e),this.tree=new c,this.round(0)}return n(e,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===w(e.key,n.key))return this.tree.remove(t),n.key;var o=this.tree.next(e);return null!==o&&0===w(e.key,o.key)?(this.tree.remove(t),o.key):t}}]),e}(),E=new b,S=function(t,e){return t.x*e.y-t.y*e.x},T=function(t,e){return t.x*e.x+t.y*e.y},R=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y},i=S(o,r);return w(i,0)},O=function(t){return Math.sqrt(T(t,t))},P=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return S(r,o)/O(r)/O(o)},I=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return T(r,o)/O(r)/O(o)},A=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},D=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},M=function(t,e,n,o){if(0===e.x)return D(n,o,t.x);if(0===o.x)return D(t,e,n.x);if(0===e.y)return A(n,o,t.y);if(0===o.y)return A(t,e,n.y);var r=S(e,o);if(0==r)return null;var i={x:n.x-t.x,y:n.y-t.y},s=S(i,e)/r,a=S(i,o)/r;return{x:(t.x+a*e.x+(n.x+s*o.x))/2,y:(t.y+a*e.y+(n.y+s*o.y))/2}},L=function(){function e(n,o){t(this,e),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=o}return n(e,null,[{key:"compare",value:function(t,n){var o=e.comparePoints(t.point,n.point);return 0!==o?o:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:F.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),n(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,o=e.length;n<o;n++){var r=e[n];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var o=e+1;o<t;o++){var r=this.point.events[o];void 0===r.consumedBy&&n.otherSE.point.events===r.otherSE.point.events&&n.segment.consume(r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var o=this.point.events[e];o!==this&&!o.segment.ringOut&&o.segment.isInResult()&&t.push(o)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,o=function(o){var r=o.otherSE;n.set(o,{sine:P(e.point,t.point,r.point),cosine:I(e.point,t.point,r.point)})};return function(t,e){n.has(t)||o(t),n.has(e)||o(e);var r=n.get(t),i=r.sine,s=r.cosine,a=n.get(e),l=a.sine,u=a.cosine;return i>=0&&l>=0?s<u?1:s>u?-1:0:i<0&&l<0?s<u?-1:s>u?1:0:l<i?-1:l>i?1:0}}}]),e}(),N=0,F=function(){function e(n,o,r,i){t(this,e),this.id=++N,this.leftSE=n,n.segment=this,n.otherSE=o,this.rightSE=o,o.segment=this,o.otherSE=n,this.rings=r,this.windings=i}return n(e,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,o=e.leftSE.point.x,r=t.rightSE.point.x,i=e.rightSE.point.x;if(i<n)return 1;if(r<o)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<o){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var p=e.comparePoint(t.rightSE.point);return 0!==p?p:-1}if(n>o){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var h=e.comparePoint(t.leftSE.point);if(0!==h)return h;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<i){var f=e.comparePoint(t.rightSE.point);if(0!==f)return f}if(r>i){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==i){var m=l-s,y=r-n,v=u-a,_=i-o;if(m>y&&v<_)return 1;if(m<y&&v>_)return-1}return r>i?1:r<i||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),n(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,o=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/o.y,i=e.x+r*o.x;if(t.x===i)return 0;var s=(t.x-e.x)/o.x,a=e.y+s*o.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),o=v(e,n);if(null===o)return null;var r=this.leftSE.point,i=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=y(e,s)&&0===this.comparePoint(s),u=y(n,r)&&0===t.comparePoint(r),c=y(e,a)&&0===this.comparePoint(a),p=y(n,i)&&0===t.comparePoint(i);if(u&&l)return p&&!c?i:!p&&c?a:null;if(u)return c&&r.x===a.x&&r.y===a.y?null:r;if(l)return p&&i.x===s.x&&i.y===s.y?null:s;if(p&&c)return null;if(p)return i;if(c)return a;var h=M(r,this.vector(),s,t.vector());return null===h?null:y(o,h)?E.round(h.x,h.y):null}},{key:"split",value:function(t){var n=[],o=void 0!==t.events,r=new L(t,!0),i=new L(t,!1),s=this.rightSE;this.replaceRightSE(i),n.push(i),n.push(r);var a=new e(r,s,this.rings.slice(),this.windings.slice());return L.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),L.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(r.checkForConsuming(),i.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var n=this,o=t;n.consumedBy;)n=n.consumedBy;for(;o.consumedBy;)o=o.consumedBy;var r=e.compare(n,o);if(0!==r){if(r>0){var i=n;n=o,o=i}if(n.prev===o){var s=n;n=o,o=s}for(var a=0,l=o.rings.length;a<l;a++){var u=o.rings[a],c=o.windings[a],p=n.rings.indexOf(u);-1===p?(n.rings.push(u),n.windings.push(c)):n.windings[p]+=c}o.rings=null,o.windings=null,o.consumedBy=n,o.leftSE.consumedBy=n.leftSE,o.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,o=this._afterState.multiPolys,r=0,i=this.rings.length;r<i;r++){var s=this.rings[r],a=this.windings[r],l=e.indexOf(s);-1===l?(e.push(s),n.push(a)):n[l]+=a}for(var u=[],c=[],p=0,h=e.length;p<h;p++)if(0!==n[p]){var d=e[p],f=d.poly;if(-1===c.indexOf(f))if(d.isExterior)u.push(f);else{-1===c.indexOf(f)&&c.push(f);var g=u.indexOf(d.poly);-1!==g&&u.splice(g,1)}}for(var m=0,y=u.length;m<y;m++){var v=u[m].multiPoly;-1===o.indexOf(v)&&o.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(q.type){case"union":var n=0===t.length,o=0===e.length;this._isInResult=n!==o;break;case"intersection":var r,i;t.length<e.length?(r=t.length,i=e.length):(r=e.length,i=t.length),this._isInResult=i===q.numMultiPolys&&r<i;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2===1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(q.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,o){var r,i,s,a=L.comparePoints(t,n);if(a<0)r=t,i=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));r=n,i=t,s=-1}return new e(new L(r,!0),new L(i,!1),[o],[s])}}]),e}(),k=function(){function e(n,o,r){if(t(this,e),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=o,this.isExterior=r,this.segments=[],"number"!==typeof n[0][0]||"number"!==typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=E.round(n[0][0],n[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var s=i,a=1,l=n.length;a<l;a++){if("number"!==typeof n[a][0]||"number"!==typeof n[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=E.round(n[a][0],n[a][1]);u.x===s.x&&u.y===s.y||(this.segments.push(F.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}i.x===s.x&&i.y===s.y||this.segments.push(F.fromRing(s,i,this))}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var o=this.segments[e];t.push(o.leftSE),t.push(o.rightSE)}return t}}]),e}(),G=function(){function e(n,o){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new k(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,i=n.length;r<i;r++){var s=new k(n[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=o}return n(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var o=this.interiorRings[e].getSweepEvents(),r=0,i=o.length;r<i;r++)t.push(o[r]);return t}}]),e}(),B=function(){function e(n,o){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"===typeof n[0][0][0]&&(n=[n])}catch(a){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,i=n.length;r<i;r++){var s=new G(n[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=o}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var o=this.polys[e].getSweepEvents(),r=0,i=o.length;r<i;r++)t.push(o[r]);return t}}]),e}(),V=function(){function e(n){t(this,e),this.events=n;for(var o=0,r=n.length;o<r;o++)n[o].segment.ringOut=this;this.poly=null}return n(e,null,[{key:"factory",value:function(t){for(var n=[],o=0,r=t.length;o<r;o++){var i=t[o];if(i.isInResult()&&!i.ringOut){for(var s=null,a=i.leftSE,l=i.rightSE,u=[a],c=a.point,p=[];s=a,a=l,u.push(a),a.point!==c;)for(;;){var h=a.getAvailableLinkedEvents();if(0===h.length){var d=u[0].point,f=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(f.x,", ").concat(f.y,"]."))}if(1===h.length){l=h[0].otherSE;break}for(var g=null,m=0,y=p.length;m<y;m++)if(p[m].point===a.point){g=m;break}if(null===g){p.push({index:u.length,point:a.point});var v=a.getLeftmostComparator(s);l=h.sort(v)[0].otherSE;break}var _=p.splice(g)[0],C=u.splice(_.index);C.unshift(C[0].otherSE),n.push(new e(C.reverse()))}n.push(new e(u))}}return n}}]),n(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,o=this.events.length-1;n<o;n++){var r=this.events[n].point,i=this.events[n+1].point;0!==R(r,t,i)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],a=e[1];0===R(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,p=[],h=u;h!=c;h+=l)p.push([e[h].x,e[h].y]);return p}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var o=this.events[e];L.compare(t,o)>0&&(t=o)}for(var r=t.segment.prevInResult(),i=r?r.prevInResult():null;;){if(!r)return null;if(!i)return r.ringOut;if(i.ringOut!==r.ringOut)return i.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=i.prevInResult(),i=r?r.prevInResult():null}}}]),e}(),z=function(){function e(n){t(this,e),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return n(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var o=this.interiorRings[e].getGeom();null!==o&&t.push(o)}return t}}]),e}(),j=function(){function e(n){t(this,e),this.rings=n,this.polys=this._composePolys(n)}return n(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var o=this.polys[e].getGeom();null!==o&&t.push(o)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,o=t.length;n<o;n++){var r=t[n];if(!r.poly)if(r.isExteriorRing())e.push(new z(r));else{var i=r.enclosingRing();i.poly||e.push(new z(i)),i.poly.addInterior(r)}}return e}}]),e}(),H=function(){function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.compare;t(this,e),this.queue=n,this.tree=new c(o),this.segments=[]}return n(e,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var o=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!o)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=o,i=o,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(i=this.tree.next(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var c=this._splitSafely(s,u),p=0,h=c.length;p<h;p++)n.push(c[p])}var d=null;if(a){var f=a.getIntersection(e);if(null!==f&&(e.isAnEndpoint(f)||(d=f),!a.isAnEndpoint(f)))for(var g=this._splitSafely(a,f),m=0,y=g.length;m<y;m++)n.push(g[m])}if(null!==l||null!==d){var v=null;v=null===l?d:null===d||L.comparePoints(l,d)<=0?l:d,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var _=e.split(v),C=0,w=_.length;C<w;C++)n.push(_[C])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var b=s.getIntersection(a);if(null!==b){if(!s.isAnEndpoint(b))for(var x=this._splitSafely(s,b),E=0,S=x.length;E<S;E++)n.push(x[E]);if(!a.isAnEndpoint(b))for(var T=this._splitSafely(a,b),R=0,O=T.length;R<O;R++)n.push(T[R])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var o=t.split(e);return o.push(n),void 0===t.consumedBy&&this.tree.insert(t),o}}]),e}(),U="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/food-security2",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,W="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/food-security2",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,q=new(function(){function e(){t(this,e)}return n(e,[{key:"run",value:function(t,e,n){q.type=t,E.reset();for(var o=[new B(e,!0)],r=0,i=n.length;r<i;r++)o.push(new B(n[r],!1));if(q.numMultiPolys=o.length,"difference"===q.type)for(var s=o[0],a=1;a<o.length;)null!==v(o[a].bbox,s.bbox)?a++:o.splice(a,1);if("intersection"===q.type)for(var l=0,u=o.length;l<u;l++)for(var p=o[l],h=l+1,d=o.length;h<d;h++)if(null===v(p.bbox,o[h].bbox))return[];for(var f=new c(L.compare),g=0,m=o.length;g<m;g++)for(var y=o[g].getSweepEvents(),_=0,C=y.length;_<C;_++)if(f.insert(y[_]),f.size>U)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new H(f),b=f.size,x=f.pop();x;){var S=x.key;if(f.size===b){var T=S.segment;throw new Error("Unable to pop() ".concat(S.isLeft?"left":"right"," SweepEvent ")+"[".concat(S.point.x,", ").concat(S.point.y,"] from segment #").concat(T.id," ")+"[".concat(T.leftSE.point.x,", ").concat(T.leftSE.point.y,"] -> ")+"[".concat(T.rightSE.point.x,", ").concat(T.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(f.size>U)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>W)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var R=w.process(S),O=0,P=R.length;O<P;O++){var I=R[O];void 0===I.consumedBy&&f.insert(I)}b=f.size,x=f.pop()}E.reset();var A=V.factory(w.segments);return new j(A).getGeom()}}]),e}()),X=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return q.run("union",t,n)},Y=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return q.run("intersection",t,n)},K=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return q.run("xor",t,n)},Z=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return q.run("difference",t,n)};return{union:X,intersection:Y,xor:K,difference:Z}}()},888:(t,e,n)=>{"use strict";var o=n(9047);function r(){}function i(){}i.resetWarningCache=r,t.exports=function(){function t(t,e,n,r,i,s){if(s!==o){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:r};return n.PropTypes=n,n}},2007:(t,e,n)=>{t.exports=n(888)()},9047:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1977:(t,e,n)=>{"use strict";t.exports=r,t.exports.default=r;var o=n(5287);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function i(t,e,n){if(!n)return e.indexOf(t);for(var o=0;o<e.length;o++)if(n(t,e[o]))return o;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,o,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var i,s=e;s<n;s++)i=t.children[s],l(r,t.leaf?o(i):i);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function p(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){var n=Math.max(t.minX,e.minX),o=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),i=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,i-o)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,e,n,r,i){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,o(t,s,e,n,i),a.push(e,s,s,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],o=this.toBBox;if(!g(t,e))return n;for(var r,i,s,a,l=[];e;){for(r=0,i=e.children.length;r<i;r++)s=e.children[r],g(t,a=e.leaf?o(s):s)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!g(t,e))return!1;for(var o,r,i,s,a=[];e;){for(o=0,r=e.children.length;o<r;o++)if(i=e.children[o],g(t,s=e.leaf?n(i):i)){if(e.leaf||f(t,s))return!0;a.push(i)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var o=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===o.height)this._splitRoot(this.data,o);else{if(this.data.height<o.height){var r=this.data;this.data=o,o=r}this._insert(o,this.data.height-o.height-1,!0)}else this.data=o;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var n,o,r,s,a=this.data,l=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),o=u[u.length-1],n=c.pop(),s=!0),a.leaf&&-1!==(r=i(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,l)?o?(n++,a=o.children[n],s=!1):a=null:(u.push(a),c.push(n),n=0,o=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,o){var r,i=n-e+1,a=this._maxEntries;if(i<=a)return s(r=m(t.slice(e,n+1)),this.toBBox),r;o||(o=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,o-1))),(r=m([])).leaf=!1,r.height=o;var l,u,c,p,h=Math.ceil(i/a),d=h*Math.ceil(Math.sqrt(a));for(y(t,e,n,d,this.compareMinX),l=e;l<=n;l+=d)for(y(t,l,c=Math.min(l+d-1,n),h,this.compareMinY),u=l;u<=c;u+=h)p=Math.min(u+h-1,c),r.children.push(this._build(t,u,p,o-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,n,o){for(var r,i,s,a,l,u,c,h,d,f;o.push(e),!e.leaf&&o.length-1!==n;){for(c=h=1/0,r=0,i=e.children.length;r<i;r++)l=p(s=e.children[r]),d=t,f=s,(u=(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-l)<h?(h=u,c=l<c?l:c,a=s):u===h&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var o=this.toBBox,r=n?t:o(t),i=[],s=this._chooseSubtree(r,this.data,e,i);for(s.children.push(t),l(s,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},_split:function(t,e){var n=t[e],o=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,o);var i=this._chooseSplitIndex(n,r,o),a=m(n.children.splice(i,n.children.length-i));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var o,r,i,s,l,u,c,h;for(u=c=1/0,o=e;o<=n-e;o++)s=d(r=a(t,0,o,this.toBBox),i=a(t,o,n,this.toBBox)),l=p(r)+p(i),s<u?(u=s,h=o,c=l<c?l:c):s===u&&l<c&&(c=l,h=o);return h},_chooseSplitAxis:function(t,e,n){var o=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,o)<this._allDistMargin(t,e,n,r)&&t.children.sort(o)},_allDistMargin:function(t,e,n,o){t.children.sort(o);var r,i,s=this.toBBox,u=a(t,0,e,s),c=a(t,n-e,n,s),p=h(u)+h(c);for(r=e;r<n-e;r++)i=t.children[r],l(u,t.leaf?s(i):i),p+=h(u);for(r=n-e-1;r>=e;r--)i=t.children[r],l(c,t.leaf?s(i):i),p+=h(c);return p},_adjustParentBBoxes:function(t,e,n){for(var o=n;o>=0;o--)l(e[o],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},5287:function(t){t.exports=function(){"use strict";function t(t,n,r,i,s){e(t,n,r||0,i||t.length-1,s||o)}function e(t,o,r,i,s){for(;i>r;){if(i-r>600){var a=i-r+1,l=o-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);e(t,o,Math.max(r,Math.floor(o-l*c/a+p)),Math.min(i,Math.floor(o+(a-l)*c/a+p)),s)}var h=t[o],d=r,f=i;for(n(t,r,o),s(t[i],h)>0&&n(t,r,i);d<f;){for(n(t,d,f),d++,f--;s(t[d],h)<0;)d++;for(;s(t[f],h)>0;)f--}0===s(t[r],h)?n(t,r,f):n(t,++f,i),f<=o&&(r=f+1),o<=f&&(i=f-1)}}function n(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function o(t,e){return t<e?-1:t>e?1:0}return t}()},4424:(t,e,n)=>{"use strict";var o=n(1725),r=n(2791);function i(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s="function"===typeof Symbol&&Symbol.for,a=s?Symbol.for("react.portal"):60106,l=s?Symbol.for("react.fragment"):60107,u=s?Symbol.for("react.strict_mode"):60108,c=s?Symbol.for("react.profiler"):60114,p=s?Symbol.for("react.provider"):60109,h=s?Symbol.for("react.context"):60110,d=s?Symbol.for("react.concurrent_mode"):60111,f=s?Symbol.for("react.forward_ref"):60112,g=s?Symbol.for("react.suspense"):60113,m=s?Symbol.for("react.suspense_list"):60120,y=s?Symbol.for("react.memo"):60115,v=s?Symbol.for("react.lazy"):60116,_=s?Symbol.for("react.block"):60121,C=s?Symbol.for("react.fundamental"):60117,w=s?Symbol.for("react.scope"):60119;function b(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case l:return"Fragment";case a:return"Portal";case c:return"Profiler";case u:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case h:return"Context.Consumer";case p:return"Context.Provider";case f:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case y:return b(t.type);case _:return b(t.render);case v:if(t=1===t._status?t._result:null)return b(t)}return null}var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;x.hasOwnProperty("ReactCurrentDispatcher")||(x.ReactCurrentDispatcher={current:null}),x.hasOwnProperty("ReactCurrentBatchConfig")||(x.ReactCurrentBatchConfig={suspense:null});var E={};function S(t,e){for(var n=0|t._threadCount;n<=e;n++)t[n]=t._currentValue2,t._threadCount=n+1}for(var T=new Uint16Array(16),R=0;15>R;R++)T[R]=R+1;T[15]=0;var O=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,P=Object.prototype.hasOwnProperty,I={},A={};function D(t){return!!P.call(A,t)||!P.call(I,t)&&(O.test(t)?A[t]=!0:(I[t]=!0,!1))}function M(t,e,n,o,r,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=o,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){L[t]=new M(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];L[e]=new M(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){L[t]=new M(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){L[t]=new M(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){L[t]=new M(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){L[t]=new M(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){L[t]=new M(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){L[t]=new M(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){L[t]=new M(t,5,!1,t.toLowerCase(),null,!1)}));var N=/[\-:]([a-z])/g;function F(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(N,F);L[e]=new M(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(N,F);L[e]=new M(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(N,F);L[e]=new M(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){L[t]=new M(t,1,!1,t.toLowerCase(),null,!1)})),L.xlinkHref=new M("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){L[t]=new M(t,1,!1,t.toLowerCase(),null,!0)}));var k=/["'&<>]/;function G(t){if("boolean"===typeof t||"number"===typeof t)return""+t;t=""+t;var e=k.exec(t);if(e){var n,o="",r=0;for(n=e.index;n<t.length;n++){switch(t.charCodeAt(n)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}r!==n&&(o+=t.substring(r,n)),r=n+1,o+=e}t=r!==n?o+t.substring(r,n):o}return t}function B(t,e){var n,o=L.hasOwnProperty(t)?L[t]:null;return(n="style"!==t)&&(n=null!==o?0===o.type:2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])),n||function(t,e,n,o){if(null===e||"undefined"===typeof e||function(t,e,n,o){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(t,e,o,!1)?"":null!==o?(t=o.attributeName,3===(n=o.type)||4===n&&!0===e?t+'=""':(o.sanitizeURL&&(e=""+e),t+'="'+G(e)+'"')):D(t)?t+'="'+G(e)+'"':""}var V="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},z=null,j=null,H=null,U=!1,W=!1,q=null,X=0;function Y(){if(null===z)throw Error(i(321));return z}function K(){if(0<X)throw Error(i(312));return{memoizedState:null,queue:null,next:null}}function Z(){return null===H?null===j?(U=!1,j=H=K()):(U=!0,H=j):null===H.next?(U=!1,H=H.next=K()):(U=!0,H=H.next),H}function J(t,e,n,o){for(;W;)W=!1,X+=1,H=null,n=t(e,o);return j=z=null,X=0,H=q=null,n}function Q(t,e){return"function"===typeof e?e(t):e}function $(t,e,n){if(z=Y(),H=Z(),U){var o=H.queue;if(e=o.dispatch,null!==q&&void 0!==(n=q.get(o))){q.delete(o),o=H.memoizedState;do{o=t(o,n.action),n=n.next}while(null!==n);return H.memoizedState=o,[o,e]}return[H.memoizedState,e]}return t=t===Q?"function"===typeof e?e():e:void 0!==n?n(e):e,H.memoizedState=t,t=(t=H.queue={last:null,dispatch:null}).dispatch=tt.bind(null,z,t),[H.memoizedState,t]}function tt(t,e,n){if(!(25>X))throw Error(i(301));if(t===z)if(W=!0,t={action:n,next:null},null===q&&(q=new Map),void 0===(n=q.get(e)))q.set(e,t);else{for(e=n;null!==e.next;)e=e.next;e.next=t}}function et(){}var nt=0,ot={readContext:function(t){var e=nt;return S(t,e),t[e]},useContext:function(t){Y();var e=nt;return S(t,e),t[e]},useMemo:function(t,e){if(z=Y(),e=void 0===e?null:e,null!==(H=Z())){var n=H.memoizedState;if(null!==n&&null!==e){t:{var o=n[1];if(null===o)o=!1;else{for(var r=0;r<o.length&&r<e.length;r++)if(!V(e[r],o[r])){o=!1;break t}o=!0}}if(o)return n[0]}}return t=t(),H.memoizedState=[t,e],t},useReducer:$,useRef:function(t){z=Y();var e=(H=Z()).memoizedState;return null===e?(t={current:t},H.memoizedState=t):e},useState:function(t){return $(Q,t)},useLayoutEffect:function(){},useCallback:function(t){return t},useImperativeHandle:et,useEffect:et,useDebugValue:et,useResponder:function(t,e){return{props:e,responder:t}},useDeferredValue:function(t){return Y(),t},useTransition:function(){return Y(),[function(t){t()},!1]}},rt="http://www.w3.org/1999/xhtml";function it(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var st={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},at=o({menuitem:!0},st),lt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ut=["Webkit","ms","Moz","O"];Object.keys(lt).forEach((function(t){ut.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lt[e]=lt[t]}))}));var ct=/([A-Z])/g,pt=/^ms-/,ht=r.Children.toArray,dt=x.ReactCurrentDispatcher,ft={listing:!0,pre:!0,textarea:!0},gt=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,mt={},yt={};var vt=Object.prototype.hasOwnProperty,_t={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function Ct(t,e){if(void 0===t)throw Error(i(152,b(e)||"Component"))}function wt(t,e,n){function s(r,s){var a=s.prototype&&s.prototype.isReactComponent,l=function(t,e,n,o){if(o&&"object"===typeof(o=t.contextType)&&null!==o)return S(o,n),o[n];if(t=t.contextTypes){for(var r in n={},t)n[r]=e[r];e=n}else e=E;return e}(s,e,n,a),u=[],c=!1,p={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===u)return null},enqueueReplaceState:function(t,e){c=!0,u=[e]},enqueueSetState:function(t,e){if(null===u)return null;u.push(e)}};if(a){if(a=new s(r.props,l,p),"function"===typeof s.getDerivedStateFromProps){var h=s.getDerivedStateFromProps.call(null,r.props,a.state);null!=h&&(a.state=o({},a.state,h))}}else if(z={},a=s(r.props,l,p),null==(a=J(s,r.props,a,l))||null==a.render)return void Ct(t=a,s);if(a.props=r.props,a.context=l,a.updater=p,void 0===(p=a.state)&&(a.state=p=null),"function"===typeof a.UNSAFE_componentWillMount||"function"===typeof a.componentWillMount)if("function"===typeof a.componentWillMount&&"function"!==typeof s.getDerivedStateFromProps&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&"function"!==typeof s.getDerivedStateFromProps&&a.UNSAFE_componentWillMount(),u.length){p=u;var d=c;if(u=null,c=!1,d&&1===p.length)a.state=p[0];else{h=d?p[0]:a.state;var f=!0;for(d=d?1:0;d<p.length;d++){var g=p[d];null!=(g="function"===typeof g?g.call(a,h,r.props,l):g)&&(f?(f=!1,h=o({},h,g)):o(h,g))}a.state=h}}else u=null;if(Ct(t=a.render(),s),"function"===typeof a.getChildContext&&"object"===typeof(r=s.childContextTypes)){var m=a.getChildContext();for(var y in m)if(!(y in r))throw Error(i(108,b(s)||"Unknown",y))}m&&(e=o({},e,m))}for(;r.isValidElement(t);){var a=t,l=a.type;if("function"!==typeof l)break;s(a,l)}return{child:t,context:e}}var bt=function(){function t(t,e){r.isValidElement(t)?t.type!==l?t=[t]:(t=t.props.children,t=r.isValidElement(t)?[t]:ht(t)):t=ht(t),t={type:null,domNamespace:rt,children:t,childIndex:0,context:E,footer:""};var n=T[0];if(0===n){var o=T,s=2*(n=o.length);if(!(65536>=s))throw Error(i(304));var a=new Uint16Array(s);for(a.set(o),(T=a)[0]=n+1,o=n;o<s-1;o++)T[o]=o+1;T[s-1]=0}else T[0]=T[n];this.threadID=n,this.stack=[t],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=e,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[]}var e=t.prototype;return e.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var t=this.threadID;T[t]=T[0],T[0]=t}},e.pushProvider=function(t){var e=++this.contextIndex,n=t.type._context,o=this.threadID;S(n,o);var r=n[o];this.contextStack[e]=n,this.contextValueStack[e]=r,n[o]=t.props.value},e.popProvider=function(){var t=this.contextIndex,e=this.contextStack[t],n=this.contextValueStack[t];this.contextStack[t]=null,this.contextValueStack[t]=null,this.contextIndex--,e[this.threadID]=n},e.clearProviders=function(){for(var t=this.contextIndex;0<=t;t--)this.contextStack[t][this.threadID]=this.contextValueStack[t]},e.read=function(t){if(this.exhausted)return null;var e=nt;nt=this.threadID;var n=dt.current;dt.current=ot;try{for(var o=[""],r=!1;o[0].length<t;){if(0===this.stack.length){this.exhausted=!0;var s=this.threadID;T[s]=T[0],T[0]=s;break}var a=this.stack[this.stack.length-1];if(r||a.childIndex>=a.children.length){var l=a.footer;if(""!==l&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===a.type)this.currentSelectValue=null;else if(null!=a.type&&null!=a.type.type&&a.type.type.$$typeof===p)this.popProvider(a.type);else if(a.type===g){this.suspenseDepth--;var u=o.pop();if(r){r=!1;var c=a.fallbackFrame;if(!c)throw Error(i(303));this.stack.push(c),o[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}o[this.suspenseDepth]+=u}o[this.suspenseDepth]+=l}else{var h=a.children[a.childIndex++],d="";try{d+=this.render(h,a.context,a.domNamespace)}catch(f){if(null!=f&&"function"===typeof f.then)throw Error(i(294));throw f}o.length<=this.suspenseDepth&&o.push(""),o[this.suspenseDepth]+=d}}return o[0]}finally{dt.current=n,nt=e}},e.render=function(t,e,n){if("string"===typeof t||"number"===typeof t)return""===(n=""+t)?"":this.makeStaticMarkup?G(n):this.previousWasTextNode?"\x3c!-- --\x3e"+G(n):(this.previousWasTextNode=!0,G(n));if(t=(e=wt(t,e,this.threadID)).child,e=e.context,null===t||!1===t)return"";if(!r.isValidElement(t)){if(null!=t&&null!=t.$$typeof){if((n=t.$$typeof)===a)throw Error(i(257));throw Error(i(258,n.toString()))}return t=ht(t),this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),""}var s=t.type;if("string"===typeof s)return this.renderDOM(t,e,n);switch(s){case u:case d:case c:case m:case l:return t=ht(t.props.children),this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),"";case g:throw Error(i(294))}if("object"===typeof s&&null!==s)switch(s.$$typeof){case f:z={};var _=s.render(t.props,t.ref);return _=J(s.render,t.props,_,t.ref),_=ht(_),this.stack.push({type:null,domNamespace:n,children:_,childIndex:0,context:e,footer:""}),"";case y:return t=[r.createElement(s.type,o({ref:t.ref},t.props))],this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),"";case p:return n={type:t,domNamespace:n,children:s=ht(t.props.children),childIndex:0,context:e,footer:""},this.pushProvider(t),this.stack.push(n),"";case h:s=t.type,_=t.props;var b=this.threadID;return S(s,b),s=ht(_.children(s[b])),this.stack.push({type:t,domNamespace:n,children:s,childIndex:0,context:e,footer:""}),"";case C:throw Error(i(338));case v:switch(function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(s=t.type),s._status){case 1:return t=[r.createElement(s._result,o({ref:t.ref},t.props))],this.stack.push({type:null,domNamespace:n,children:t,childIndex:0,context:e,footer:""}),"";case 2:throw s._result;default:throw Error(i(295))}case w:throw Error(i(343))}throw Error(i(130,null==s?s:typeof s,""))},e.renderDOM=function(t,e,n){var s=t.type.toLowerCase();if(n===rt&&it(s),!mt.hasOwnProperty(s)){if(!gt.test(s))throw Error(i(65,s));mt[s]=!0}var a=t.props;if("input"===s)a=o({type:void 0},a,{defaultChecked:void 0,defaultValue:void 0,value:null!=a.value?a.value:a.defaultValue,checked:null!=a.checked?a.checked:a.defaultChecked});else if("textarea"===s){var l=a.value;if(null==l){l=a.defaultValue;var u=a.children;if(null!=u){if(null!=l)throw Error(i(92));if(Array.isArray(u)){if(!(1>=u.length))throw Error(i(93));u=u[0]}l=""+u}null==l&&(l="")}a=o({},a,{value:void 0,children:""+l})}else if("select"===s)this.currentSelectValue=null!=a.value?a.value:a.defaultValue,a=o({},a,{value:void 0});else if("option"===s){u=this.currentSelectValue;var c=function(t){if(void 0===t||null===t)return t;var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(a.children);if(null!=u){var p=null!=a.value?a.value+"":c;if(l=!1,Array.isArray(u)){for(var h=0;h<u.length;h++)if(""+u[h]===p){l=!0;break}}else l=""+u===p;a=o({selected:void 0,children:void 0},a,{selected:l,children:c})}}if(l=a){if(at[s]&&(null!=l.children||null!=l.dangerouslySetInnerHTML))throw Error(i(137,s,""));if(null!=l.dangerouslySetInnerHTML){if(null!=l.children)throw Error(i(60));if("object"!==typeof l.dangerouslySetInnerHTML||!("__html"in l.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=l.style&&"object"!==typeof l.style)throw Error(i(62,""))}for(C in l=a,u=this.makeStaticMarkup,c=1===this.stack.length,p="<"+t.type,l)if(vt.call(l,C)){var d=l[C];if(null!=d){if("style"===C){h=void 0;var f="",g="";for(h in d)if(d.hasOwnProperty(h)){var m=0===h.indexOf("--"),y=d[h];if(null!=y){if(m)var v=h;else if(v=h,yt.hasOwnProperty(v))v=yt[v];else{var _=v.replace(ct,"-$1").toLowerCase().replace(pt,"-ms-");v=yt[v]=_}f+=g+v+":",g=h,f+=m=null==y||"boolean"===typeof y||""===y?"":m||"number"!==typeof y||0===y||lt.hasOwnProperty(g)&&lt[g]?(""+y).trim():y+"px",g=";"}}d=f||null}h=null;t:if(m=s,y=l,-1===m.indexOf("-"))m="string"===typeof y.is;else switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":m=!1;break t;default:m=!0}m?_t.hasOwnProperty(C)||(h=D(h=C)&&null!=d?h+'="'+G(d)+'"':""):h=B(C,d),h&&(p+=" "+h)}}u||c&&(p+=' data-reactroot=""');var C=p;l="",st.hasOwnProperty(s)?C+="/>":(C+=">",l="</"+t.type+">");t:{if(null!=(u=a.dangerouslySetInnerHTML)){if(null!=u.__html){u=u.__html;break t}}else if("string"===typeof(u=a.children)||"number"===typeof u){u=G(u);break t}u=null}return null!=u?(a=[],ft.hasOwnProperty(s)&&"\n"===u.charAt(0)&&(C+="\n"),C+=u):a=ht(a.children),t=t.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?it(t):"http://www.w3.org/2000/svg"===n&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:s,children:a,childIndex:0,context:e,footer:l}),this.previousWasTextNode=!1,C},t}(),xt={renderToString:function(t){t=new bt(t,!1);try{return t.read(1/0)}finally{t.destroy()}},renderToStaticMarkup:function(t){t=new bt(t,!0);try{return t.read(1/0)}finally{t.destroy()}},renderToNodeStream:function(){throw Error(i(207))},renderToStaticNodeStream:function(){throw Error(i(208))},version:"16.14.0"};t.exports=xt.default||xt},4463:(t,e,n)=>{"use strict";var o=n(2791),r=n(1725),i=n(5296);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!o)throw Error(s(227));function a(t,e,n,o,r,i,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var l=!1,u=null,c=!1,p=null,h={onError:function(t){l=!0,u=t}};function d(t,e,n,o,r,i,s,c,p){l=!1,u=null,a.apply(h,arguments)}var f=null,g=null,m=null;function y(t,e,n){var o=t.type||"unknown-event";t.currentTarget=m(n),function(t,e,n,o,r,i,a,h,f){if(d.apply(this,arguments),l){if(!l)throw Error(s(198));var g=u;l=!1,u=null,c||(c=!0,p=g)}}(o,e,void 0,t),t.currentTarget=null}var v=null,_={};function C(){if(v)for(var t in _){var e=_[t],n=v.indexOf(t);if(!(-1<n))throw Error(s(96,t));if(!b[n]){if(!e.extractEvents)throw Error(s(97,t));for(var o in b[n]=e,n=e.eventTypes){var r=void 0,i=n[o],a=e,l=o;if(x.hasOwnProperty(l))throw Error(s(99,l));x[l]=i;var u=i.phasedRegistrationNames;if(u){for(r in u)u.hasOwnProperty(r)&&w(u[r],a,l);r=!0}else i.registrationName?(w(i.registrationName,a,l),r=!0):r=!1;if(!r)throw Error(s(98,o,t))}}}}function w(t,e,n){if(E[t])throw Error(s(100,t));E[t]=e,S[t]=e.eventTypes[n].dependencies}var b=[],x={},E={},S={};function T(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var o=t[e];if(!_.hasOwnProperty(e)||_[e]!==o){if(_[e])throw Error(s(102,e));_[e]=o,n=!0}}n&&C()}var R=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),O=null,P=null,I=null;function A(t){if(t=g(t)){if("function"!==typeof O)throw Error(s(280));var e=t.stateNode;e&&(e=f(e),O(t.stateNode,t.type,e))}}function D(t){P?I?I.push(t):I=[t]:P=t}function M(){if(P){var t=P,e=I;if(I=P=null,A(t),e)for(t=0;t<e.length;t++)A(e[t])}}function L(t,e){return t(e)}function N(t,e,n,o,r){return t(e,n,o,r)}function F(){}var k=L,G=!1,B=!1;function V(){null===P&&null===I||(F(),M())}function z(t,e,n){if(B)return t(e,n);B=!0;try{return k(t,e,n)}finally{B=!1,V()}}var j=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H=Object.prototype.hasOwnProperty,U={},W={};function q(t,e,n,o,r,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=o,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i}var X={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){X[t]=new q(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];X[e]=new q(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){X[t]=new q(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){X[t]=new q(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){X[t]=new q(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){X[t]=new q(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){X[t]=new q(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){X[t]=new q(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){X[t]=new q(t,5,!1,t.toLowerCase(),null,!1)}));var Y=/[\-:]([a-z])/g;function K(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(Y,K);X[e]=new q(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(Y,K);X[e]=new q(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(Y,K);X[e]=new q(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){X[t]=new q(t,1,!1,t.toLowerCase(),null,!1)})),X.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){X[t]=new q(t,1,!1,t.toLowerCase(),null,!0)}));var Z=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function J(t,e,n,o){var r=X.hasOwnProperty(e)?X[e]:null;(null!==r?0===r.type:!o&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,o){if(null===e||"undefined"===typeof e||function(t,e,n,o){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,o)&&(n=null),o||null===r?function(t){return!!H.call(W,t)||!H.call(U,t)&&(j.test(t)?W[t]=!0:(U[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,o=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,o?t.setAttributeNS(o,e,n):t.setAttribute(e,n))))}Z.hasOwnProperty("ReactCurrentDispatcher")||(Z.ReactCurrentDispatcher={current:null}),Z.hasOwnProperty("ReactCurrentBatchConfig")||(Z.ReactCurrentBatchConfig={suspense:null});var Q=/^(.*)[\\\/]/,$="function"===typeof Symbol&&Symbol.for,tt=$?Symbol.for("react.element"):60103,et=$?Symbol.for("react.portal"):60106,nt=$?Symbol.for("react.fragment"):60107,ot=$?Symbol.for("react.strict_mode"):60108,rt=$?Symbol.for("react.profiler"):60114,it=$?Symbol.for("react.provider"):60109,st=$?Symbol.for("react.context"):60110,at=$?Symbol.for("react.concurrent_mode"):60111,lt=$?Symbol.for("react.forward_ref"):60112,ut=$?Symbol.for("react.suspense"):60113,ct=$?Symbol.for("react.suspense_list"):60120,pt=$?Symbol.for("react.memo"):60115,ht=$?Symbol.for("react.lazy"):60116,dt=$?Symbol.for("react.block"):60121,ft="function"===typeof Symbol&&Symbol.iterator;function gt(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=ft&&t[ft]||t["@@iterator"])?t:null}function mt(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case nt:return"Fragment";case et:return"Portal";case rt:return"Profiler";case ot:return"StrictMode";case ut:return"Suspense";case ct:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case st:return"Context.Consumer";case it:return"Context.Provider";case lt:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case pt:return mt(t.type);case dt:return mt(t.render);case ht:if(t=1===t._status?t._result:null)return mt(t)}return null}function yt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var o=t._debugOwner,r=t._debugSource,i=mt(t.type);n=null,o&&(n=mt(o.type)),o=i,i="",r?i=" (at "+r.fileName.replace(Q,"")+":"+r.lineNumber+")":n&&(i=" (created by "+n+")"),n="\n    in "+(o||"Unknown")+i}e+=n,t=t.return}while(t);return e}function vt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function _t(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Ct(t){t._valueTracker||(t._valueTracker=function(t){var e=_t(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),o=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){o=""+t,i.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(t){o=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function wt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),o="";return t&&(o=_t(t)?t.checked?"true":"false":t.value),(t=o)!==n&&(e.setValue(t),!0)}function bt(t,e){var n=e.checked;return r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function xt(t,e){var n=null==e.defaultValue?"":e.defaultValue,o=null!=e.checked?e.checked:e.defaultChecked;n=vt(null!=e.value?e.value:n),t._wrapperState={initialChecked:o,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Et(t,e){null!=(e=e.checked)&&J(t,"checked",e,!1)}function St(t,e){Et(t,e);var n=vt(e.value),o=e.type;if(null!=n)"number"===o?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===o||"reset"===o)return void t.removeAttribute("value");e.hasOwnProperty("value")?Rt(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rt(t,e.type,vt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Tt(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!("submit"!==o&&"reset"!==o||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Rt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function Ot(t,e){return t=r({children:void 0},e),(e=function(t){var e="";return o.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Pt(t,e,n,o){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&o&&(t[n].defaultSelected=!0)}else{for(n=""+vt(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(o&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function It(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function At(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:vt(n)}}function Dt(t,e){var n=vt(e.value),o=vt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=o&&(t.defaultValue=""+o)}function Mt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var Lt="http://www.w3.org/1999/xhtml",Nt="http://www.w3.org/2000/svg";function Ft(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Ft(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Gt,Bt,Vt=(Bt=function(t,e){if(t.namespaceURI!==Nt||"innerHTML"in t)t.innerHTML=e;else{for((Gt=Gt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,o){MSApp.execUnsafeLocalFunction((function(){return Bt(t,e)}))}:Bt);function zt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function jt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ht={animationend:jt("Animation","AnimationEnd"),animationiteration:jt("Animation","AnimationIteration"),animationstart:jt("Animation","AnimationStart"),transitionend:jt("Transition","TransitionEnd")},Ut={},Wt={};function qt(t){if(Ut[t])return Ut[t];if(!Ht[t])return t;var e,n=Ht[t];for(e in n)if(n.hasOwnProperty(e)&&e in Wt)return Ut[t]=n[e];return t}R&&(Wt=document.createElement("div").style,"AnimationEvent"in window||(delete Ht.animationend.animation,delete Ht.animationiteration.animation,delete Ht.animationstart.animation),"TransitionEvent"in window||delete Ht.transitionend.transition);var Xt=qt("animationend"),Yt=qt("animationiteration"),Kt=qt("animationstart"),Zt=qt("transitionend"),Jt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qt=new("function"===typeof WeakMap?WeakMap:Map);function $t(t){var e=Qt.get(t);return void 0===e&&(e=new Map,Qt.set(t,e)),e}function te(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function ee(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ne(t){if(te(t)!==t)throw Error(s(188))}function oe(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=te(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,o=e;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(o=r.return)){n=o;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return ne(r),t;if(i===o)return ne(r),e;i=i.sibling}throw Error(s(188))}if(n.return!==o.return)n=r,o=i;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,o=i;break}if(l===o){a=!0,o=r,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,o=r;break}if(l===o){a=!0,o=i,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==o)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function re(t,e){if(null==e)throw Error(s(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function ie(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var se=null;function ae(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var o=0;o<e.length&&!t.isPropagationStopped();o++)y(t,e[o],n[o]);else e&&y(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function le(t){if(null!==t&&(se=re(se,t)),t=se,se=null,t){if(ie(t,ae),se)throw Error(s(95));if(c)throw t=p,c=!1,p=null,t}}function ue(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function ce(t){if(!R)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"===typeof e[t]),e}var pe=[];function he(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>pe.length&&pe.push(t)}function de(t,e,n,o){if(pe.length){var r=pe.pop();return r.topLevelType=t,r.eventSystemFlags=o,r.nativeEvent=e,r.targetInst=n,r}return{topLevelType:t,eventSystemFlags:o,nativeEvent:e,targetInst:n,ancestors:[]}}function fe(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var o=n;if(3===o.tag)o=o.stateNode.containerInfo;else{for(;o.return;)o=o.return;o=3!==o.tag?null:o.stateNode.containerInfo}if(!o)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=Mn(o)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var r=ue(t.nativeEvent);o=t.topLevelType;var i=t.nativeEvent,s=t.eventSystemFlags;0===n&&(s|=64);for(var a=null,l=0;l<b.length;l++){var u=b[l];u&&(u=u.extractEvents(o,e,i,r,s))&&(a=re(a,u))}le(a)}}function ge(t,e,n){if(!n.has(t)){switch(t){case"scroll":Ke(e,"scroll",!0);break;case"focus":case"blur":Ke(e,"focus",!0),Ke(e,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ce(t)&&Ke(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Jt.indexOf(t)&&Ye(t,e)}n.set(t,null)}}var me,ye,ve,_e=!1,Ce=[],we=null,be=null,xe=null,Ee=new Map,Se=new Map,Te=[],Re="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Oe="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Pe(t,e,n,o,r){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:r,container:o}}function Ie(t,e){switch(t){case"focus":case"blur":we=null;break;case"dragenter":case"dragleave":be=null;break;case"mouseover":case"mouseout":xe=null;break;case"pointerover":case"pointerout":Ee.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Se.delete(e.pointerId)}}function Ae(t,e,n,o,r,i){return null===t||t.nativeEvent!==i?(t=Pe(e,n,o,r,i),null!==e&&(null!==(e=Ln(e))&&ye(e)),t):(t.eventSystemFlags|=o,t)}function De(t){var e=Mn(t.target);if(null!==e){var n=te(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=ee(n)))return t.blockedOn=e,void i.unstable_runWithPriority(t.priority,(function(){ve(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Me(t){if(null!==t.blockedOn)return!1;var e=$e(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(null!==e){var n=Ln(e);return null!==n&&ye(n),t.blockedOn=e,!1}return!0}function Le(t,e,n){Me(t)&&n.delete(e)}function Ne(){for(_e=!1;0<Ce.length;){var t=Ce[0];if(null!==t.blockedOn){null!==(t=Ln(t.blockedOn))&&me(t);break}var e=$e(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);null!==e?t.blockedOn=e:Ce.shift()}null!==we&&Me(we)&&(we=null),null!==be&&Me(be)&&(be=null),null!==xe&&Me(xe)&&(xe=null),Ee.forEach(Le),Se.forEach(Le)}function Fe(t,e){t.blockedOn===e&&(t.blockedOn=null,_e||(_e=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ne)))}function ke(t){function e(e){return Fe(e,t)}if(0<Ce.length){Fe(Ce[0],t);for(var n=1;n<Ce.length;n++){var o=Ce[n];o.blockedOn===t&&(o.blockedOn=null)}}for(null!==we&&Fe(we,t),null!==be&&Fe(be,t),null!==xe&&Fe(xe,t),Ee.forEach(e),Se.forEach(e),n=0;n<Te.length;n++)(o=Te[n]).blockedOn===t&&(o.blockedOn=null);for(;0<Te.length&&null===(n=Te[0]).blockedOn;)De(n),null===n.blockedOn&&Te.shift()}var Ge={},Be=new Map,Ve=new Map,ze=["abort","abort",Xt,"animationEnd",Yt,"animationIteration",Kt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Zt,"transitionEnd","waiting","waiting"];function je(t,e){for(var n=0;n<t.length;n+=2){var o=t[n],r=t[n+1],i="on"+(r[0].toUpperCase()+r.slice(1));i={phasedRegistrationNames:{bubbled:i,captured:i+"Capture"},dependencies:[o],eventPriority:e},Ve.set(o,e),Be.set(o,i),Ge[r]=i}}je("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),je("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),je(ze,2);for(var He="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ue=0;Ue<He.length;Ue++)Ve.set(He[Ue],0);var We=i.unstable_UserBlockingPriority,qe=i.unstable_runWithPriority,Xe=!0;function Ye(t,e){Ke(e,t,!1)}function Ke(t,e,n){var o=Ve.get(e);switch(void 0===o?2:o){case 0:o=Ze.bind(null,e,1,t);break;case 1:o=Je.bind(null,e,1,t);break;default:o=Qe.bind(null,e,1,t)}n?t.addEventListener(e,o,!0):t.addEventListener(e,o,!1)}function Ze(t,e,n,o){G||F();var r=Qe,i=G;G=!0;try{N(r,t,e,n,o)}finally{(G=i)||V()}}function Je(t,e,n,o){qe(We,Qe.bind(null,t,e,n,o))}function Qe(t,e,n,o){if(Xe)if(0<Ce.length&&-1<Re.indexOf(t))t=Pe(null,t,e,n,o),Ce.push(t);else{var r=$e(t,e,n,o);if(null===r)Ie(t,o);else if(-1<Re.indexOf(t))t=Pe(r,t,e,n,o),Ce.push(t);else if(!function(t,e,n,o,r){switch(e){case"focus":return we=Ae(we,t,e,n,o,r),!0;case"dragenter":return be=Ae(be,t,e,n,o,r),!0;case"mouseover":return xe=Ae(xe,t,e,n,o,r),!0;case"pointerover":var i=r.pointerId;return Ee.set(i,Ae(Ee.get(i)||null,t,e,n,o,r)),!0;case"gotpointercapture":return i=r.pointerId,Se.set(i,Ae(Se.get(i)||null,t,e,n,o,r)),!0}return!1}(r,t,e,n,o)){Ie(t,o),t=de(t,o,null,e);try{z(fe,t)}finally{he(t)}}}}function $e(t,e,n,o){if(null!==(n=Mn(n=ue(o)))){var r=te(n);if(null===r)n=null;else{var i=r.tag;if(13===i){if(null!==(n=ee(r)))return n;n=null}else if(3===i){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}t=de(t,o,n,e);try{z(fe,t)}finally{he(t)}return null}var tn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];function nn(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||tn.hasOwnProperty(t)&&tn[t]?(""+e).trim():e+"px"}function on(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var o=0===n.indexOf("--"),r=nn(n,e[n],o);"float"===n&&(n="cssFloat"),o?t.setProperty(n,r):t[n]=r}}Object.keys(tn).forEach((function(t){en.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),tn[e]=tn[t]}))}));var rn=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sn(t,e){if(e){if(rn[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62,""))}}function an(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ln=Lt;function un(t,e){var n=$t(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=S[e];for(var o=0;o<e.length;o++)ge(e[o],t,n)}function cn(){}function pn(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function hn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dn(t,e){var n,o=hn(t);for(t=0;o;){if(3===o.nodeType){if(n=t+o.textContent.length,t<=e&&n>=e)return{node:o,offset:e-t};t=n}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=hn(o)}}function fn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?fn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function gn(){for(var t=window,e=pn();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(o){n=!1}if(!n)break;e=pn((t=e.contentWindow).document)}return e}function mn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var yn="$",vn="/$",_n="$?",Cn="$!",wn=null,bn=null;function xn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function En(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Sn="function"===typeof setTimeout?setTimeout:void 0,Tn="function"===typeof clearTimeout?clearTimeout:void 0;function Rn(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function On(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if(n===yn||n===Cn||n===_n){if(0===e)return t;e--}else n===vn&&e++}t=t.previousSibling}return null}var Pn=Math.random().toString(36).slice(2),In="__reactInternalInstance$"+Pn,An="__reactEventHandlers$"+Pn,Dn="__reactContainere$"+Pn;function Mn(t){var e=t[In];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Dn]||n[In]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=On(t);null!==t;){if(n=t[In])return n;t=On(t)}return e}n=(t=n).parentNode}return null}function Ln(t){return!(t=t[In]||t[Dn])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function Nn(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function Fn(t){return t[An]||null}function kn(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function Gn(t,e){var n=t.stateNode;if(!n)return null;var o=f(n);if(!o)return null;n=o[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!o;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(s(231,e,typeof n));return n}function Bn(t,e,n){(e=Gn(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function Vn(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=kn(e);for(e=n.length;0<e--;)Bn(n[e],"captured",t);for(e=0;e<n.length;e++)Bn(n[e],"bubbled",t)}}function zn(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=Gn(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=re(n._dispatchListeners,e),n._dispatchInstances=re(n._dispatchInstances,t))}function jn(t){t&&t.dispatchConfig.registrationName&&zn(t._targetInst,null,t)}function Hn(t){ie(t,Vn)}var Un=null,Wn=null,qn=null;function Xn(){if(qn)return qn;var t,e,n=Wn,o=n.length,r="value"in Un?Un.value:Un.textContent,i=r.length;for(t=0;t<o&&n[t]===r[t];t++);var s=o-t;for(e=1;e<=s&&n[o-e]===r[i-e];e++);return qn=r.slice(t,1<e?1-e:void 0)}function Yn(){return!0}function Kn(){return!1}function Zn(t,e,n,o){for(var r in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(r)&&((e=t[r])?this[r]=e(n):"target"===r?this.target=o:this[r]=n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Yn:Kn,this.isPropagationStopped=Kn,this}function Jn(t,e,n,o){if(this.eventPool.length){var r=this.eventPool.pop();return this.call(r,t,e,n,o),r}return new this(t,e,n,o)}function Qn(t){if(!(t instanceof this))throw Error(s(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function $n(t){t.eventPool=[],t.getPooled=Jn,t.release=Qn}r(Zn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=Yn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=Yn)},persist:function(){this.isPersistent=Yn},isPersistent:Kn,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Kn,this._dispatchInstances=this._dispatchListeners=null}}),Zn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Zn.extend=function(t){function e(){}function n(){return o.apply(this,arguments)}var o=this;e.prototype=o.prototype;var i=new e;return r(i,n.prototype),n.prototype=i,n.prototype.constructor=n,n.Interface=r({},o.Interface,t),n.extend=o.extend,$n(n),n},$n(Zn);var to=Zn.extend({data:null}),eo=Zn.extend({data:null}),no=[9,13,27,32],oo=R&&"CompositionEvent"in window,ro=null;R&&"documentMode"in document&&(ro=document.documentMode);var io=R&&"TextEvent"in window&&!ro,so=R&&(!oo||ro&&8<ro&&11>=ro),ao=String.fromCharCode(32),lo={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},uo=!1;function co(t,e){switch(t){case"keyup":return-1!==no.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function po(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var ho=!1;var fo={eventTypes:lo,extractEvents:function(t,e,n,o){var r;if(oo)t:{switch(t){case"compositionstart":var i=lo.compositionStart;break t;case"compositionend":i=lo.compositionEnd;break t;case"compositionupdate":i=lo.compositionUpdate;break t}i=void 0}else ho?co(t,n)&&(i=lo.compositionEnd):"keydown"===t&&229===n.keyCode&&(i=lo.compositionStart);return i?(so&&"ko"!==n.locale&&(ho||i!==lo.compositionStart?i===lo.compositionEnd&&ho&&(r=Xn()):(Wn="value"in(Un=o)?Un.value:Un.textContent,ho=!0)),i=to.getPooled(i,e,n,o),r?i.data=r:null!==(r=po(n))&&(i.data=r),Hn(i),r=i):r=null,(t=io?function(t,e){switch(t){case"compositionend":return po(e);case"keypress":return 32!==e.which?null:(uo=!0,ao);case"textInput":return(t=e.data)===ao&&uo?null:t;default:return null}}(t,n):function(t,e){if(ho)return"compositionend"===t||!oo&&co(t,e)?(t=Xn(),qn=Wn=Un=null,ho=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return so&&"ko"!==e.locale?null:e.data}}(t,n))?((e=eo.getPooled(lo.beforeInput,e,n,o)).data=t,Hn(e)):e=null,null===r?e:null===e?r:[r,e]}},go={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mo(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!go[t.type]:"textarea"===e}var yo={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function vo(t,e,n){return(t=Zn.getPooled(yo.change,t,e,n)).type="change",D(n),Hn(t),t}var _o=null,Co=null;function wo(t){le(t)}function bo(t){if(wt(Nn(t)))return t}function xo(t,e){if("change"===t)return e}var Eo=!1;function So(){_o&&(_o.detachEvent("onpropertychange",To),Co=_o=null)}function To(t){if("value"===t.propertyName&&bo(Co))if(t=vo(Co,t,ue(t)),G)le(t);else{G=!0;try{L(wo,t)}finally{G=!1,V()}}}function Ro(t,e,n){"focus"===t?(So(),Co=n,(_o=e).attachEvent("onpropertychange",To)):"blur"===t&&So()}function Oo(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return bo(Co)}function Po(t,e){if("click"===t)return bo(e)}function Io(t,e){if("input"===t||"change"===t)return bo(e)}R&&(Eo=ce("input")&&(!document.documentMode||9<document.documentMode));var Ao={eventTypes:yo,_isInputEventSupported:Eo,extractEvents:function(t,e,n,o){var r=e?Nn(e):window,i=r.nodeName&&r.nodeName.toLowerCase();if("select"===i||"input"===i&&"file"===r.type)var s=xo;else if(mo(r))if(Eo)s=Io;else{s=Oo;var a=Ro}else(i=r.nodeName)&&"input"===i.toLowerCase()&&("checkbox"===r.type||"radio"===r.type)&&(s=Po);if(s&&(s=s(t,e)))return vo(s,n,o);a&&a(t,r,e),"blur"===t&&(t=r._wrapperState)&&t.controlled&&"number"===r.type&&Rt(r,"number",r.value)}},Do=Zn.extend({view:null,detail:null}),Mo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lo(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Mo[t])&&!!e[t]}function No(){return Lo}var Fo=0,ko=0,Go=!1,Bo=!1,Vo=Do.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:No,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Fo;return Fo=t.screenX,Go?"mousemove"===t.type?t.screenX-e:0:(Go=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=ko;return ko=t.screenY,Bo?"mousemove"===t.type?t.screenY-e:0:(Bo=!0,0)}}),zo=Vo.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),jo={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Ho={eventTypes:jo,extractEvents:function(t,e,n,o,r){var i="mouseover"===t||"pointerover"===t,s="mouseout"===t||"pointerout"===t;if(i&&0===(32&r)&&(n.relatedTarget||n.fromElement)||!s&&!i)return null;(i=o.window===o?o:(i=o.ownerDocument)?i.defaultView||i.parentWindow:window,s)?(s=e,null!==(e=(e=n.relatedTarget||n.toElement)?Mn(e):null)&&(e!==te(e)||5!==e.tag&&6!==e.tag)&&(e=null)):s=null;if(s===e)return null;if("mouseout"===t||"mouseover"===t)var a=Vo,l=jo.mouseLeave,u=jo.mouseEnter,c="mouse";else"pointerout"!==t&&"pointerover"!==t||(a=zo,l=jo.pointerLeave,u=jo.pointerEnter,c="pointer");if(t=null==s?i:Nn(s),i=null==e?i:Nn(e),(l=a.getPooled(l,s,n,o)).type=c+"leave",l.target=t,l.relatedTarget=i,(n=a.getPooled(u,e,n,o)).type=c+"enter",n.target=i,n.relatedTarget=t,c=e,(o=s)&&c)t:{for(u=c,s=0,t=a=o;t;t=kn(t))s++;for(t=0,e=u;e;e=kn(e))t++;for(;0<s-t;)a=kn(a),s--;for(;0<t-s;)u=kn(u),t--;for(;s--;){if(a===u||a===u.alternate)break t;a=kn(a),u=kn(u)}a=null}else a=null;for(u=a,a=[];o&&o!==u&&(null===(s=o.alternate)||s!==u);)a.push(o),o=kn(o);for(o=[];c&&c!==u&&(null===(s=c.alternate)||s!==u);)o.push(c),c=kn(c);for(c=0;c<a.length;c++)zn(a[c],"bubbled",l);for(c=o.length;0<c--;)zn(o[c],"captured",n);return 0===(64&r)?[l]:[l,n]}};var Uo="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},Wo=Object.prototype.hasOwnProperty;function qo(t,e){if(Uo(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++)if(!Wo.call(e,n[o])||!Uo(t[n[o]],e[n[o]]))return!1;return!0}var Xo=R&&"documentMode"in document&&11>=document.documentMode,Yo={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Ko=null,Zo=null,Jo=null,Qo=!1;function $o(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Qo||null==Ko||Ko!==pn(n)?null:("selectionStart"in(n=Ko)&&mn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Jo&&qo(Jo,n)?null:(Jo=n,(t=Zn.getPooled(Yo.select,Zo,t,e)).type="select",t.target=Ko,Hn(t),t))}var tr={eventTypes:Yo,extractEvents:function(t,e,n,o,r,i){if(!(i=!(r=i||(o.window===o?o.document:9===o.nodeType?o:o.ownerDocument)))){t:{r=$t(r),i=S.onSelect;for(var s=0;s<i.length;s++)if(!r.has(i[s])){r=!1;break t}r=!0}i=!r}if(i)return null;switch(r=e?Nn(e):window,t){case"focus":(mo(r)||"true"===r.contentEditable)&&(Ko=r,Zo=e,Jo=null);break;case"blur":Jo=Zo=Ko=null;break;case"mousedown":Qo=!0;break;case"contextmenu":case"mouseup":case"dragend":return Qo=!1,$o(n,o);case"selectionchange":if(Xo)break;case"keydown":case"keyup":return $o(n,o)}return null}},er=Zn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),nr=Zn.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),or=Do.extend({relatedTarget:null});function rr(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var ir={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ar=Do.extend({key:function(t){if(t.key){var e=ir[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=rr(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?sr[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:No,charCode:function(t){return"keypress"===t.type?rr(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?rr(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),lr=Vo.extend({dataTransfer:null}),ur=Do.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:No}),cr=Zn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),pr=Vo.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),hr={eventTypes:Ge,extractEvents:function(t,e,n,o){var r=Be.get(t);if(!r)return null;switch(t){case"keypress":if(0===rr(n))return null;case"keydown":case"keyup":t=ar;break;case"blur":case"focus":t=or;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=lr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=ur;break;case Xt:case Yt:case Kt:t=er;break;case Zt:t=cr;break;case"scroll":t=Do;break;case"wheel":t=pr;break;case"copy":case"cut":case"paste":t=nr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=zo;break;default:t=Zn}return Hn(e=t.getPooled(r,e,n,o)),e}};if(v)throw Error(s(101));v=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),C(),f=Fn,g=Ln,m=Nn,T({SimpleEventPlugin:hr,EnterLeaveEventPlugin:Ho,ChangeEventPlugin:Ao,SelectEventPlugin:tr,BeforeInputEventPlugin:fo});var dr=[],fr=-1;function gr(t){0>fr||(t.current=dr[fr],dr[fr]=null,fr--)}function mr(t,e){fr++,dr[fr]=t.current,t.current=e}var yr={},vr={current:yr},_r={current:!1},Cr=yr;function wr(t,e){var n=t.type.contextTypes;if(!n)return yr;var o=t.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var r,i={};for(r in n)i[r]=e[r];return o&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function br(t){return null!==(t=t.childContextTypes)&&void 0!==t}function xr(){gr(_r),gr(vr)}function Er(t,e,n){if(vr.current!==yr)throw Error(s(168));mr(vr,e),mr(_r,n)}function Sr(t,e,n){var o=t.stateNode;if(t=e.childContextTypes,"function"!==typeof o.getChildContext)return n;for(var i in o=o.getChildContext())if(!(i in t))throw Error(s(108,mt(e)||"Unknown",i));return r({},n,{},o)}function Tr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yr,Cr=vr.current,mr(vr,t),mr(_r,_r.current),!0}function Rr(t,e,n){var o=t.stateNode;if(!o)throw Error(s(169));n?(t=Sr(t,e,Cr),o.__reactInternalMemoizedMergedChildContext=t,gr(_r),gr(vr),mr(vr,t)):gr(_r),mr(_r,n)}var Or=i.unstable_runWithPriority,Pr=i.unstable_scheduleCallback,Ir=i.unstable_cancelCallback,Ar=i.unstable_requestPaint,Dr=i.unstable_now,Mr=i.unstable_getCurrentPriorityLevel,Lr=i.unstable_ImmediatePriority,Nr=i.unstable_UserBlockingPriority,Fr=i.unstable_NormalPriority,kr=i.unstable_LowPriority,Gr=i.unstable_IdlePriority,Br={},Vr=i.unstable_shouldYield,zr=void 0!==Ar?Ar:function(){},jr=null,Hr=null,Ur=!1,Wr=Dr(),qr=1e4>Wr?Dr:function(){return Dr()-Wr};function Xr(){switch(Mr()){case Lr:return 99;case Nr:return 98;case Fr:return 97;case kr:return 96;case Gr:return 95;default:throw Error(s(332))}}function Yr(t){switch(t){case 99:return Lr;case 98:return Nr;case 97:return Fr;case 96:return kr;case 95:return Gr;default:throw Error(s(332))}}function Kr(t,e){return t=Yr(t),Or(t,e)}function Zr(t,e,n){return t=Yr(t),Pr(t,e,n)}function Jr(t){return null===jr?(jr=[t],Hr=Pr(Lr,$r)):jr.push(t),Br}function Qr(){if(null!==Hr){var t=Hr;Hr=null,Ir(t)}$r()}function $r(){if(!Ur&&null!==jr){Ur=!0;var t=0;try{var e=jr;Kr(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),jr=null}catch(n){throw null!==jr&&(jr=jr.slice(t+1)),Pr(Lr,Qr),n}finally{Ur=!1}}}function ti(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function ei(t,e){if(t&&t.defaultProps)for(var n in e=r({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var ni={current:null},oi=null,ri=null,ii=null;function si(){ii=ri=oi=null}function ai(t){var e=ni.current;gr(ni),t.type._context._currentValue=e}function li(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function ui(t,e){oi=t,ii=ri=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(Fs=!0),t.firstContext=null)}function ci(t,e){if(ii!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(ii=t,e=1073741823),e={context:t,observedBits:e,next:null},null===ri){if(null===oi)throw Error(s(308));ri=e,oi.dependencies={expirationTime:0,firstContext:e,responders:null}}else ri=ri.next=e;return t._currentValue}var pi=!1;function hi(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function di(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function fi(t,e){return(t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null}).next=t}function gi(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function mi(t,e){var n=t.alternate;null!==n&&di(n,t),null===(n=(t=t.updateQueue).baseQueue)?(t.baseQueue=e.next=e,e.next=e):(e.next=n.next,n.next=e)}function yi(t,e,n,o){var i=t.updateQueue;pi=!1;var s=i.baseQueue,a=i.shared.pending;if(null!==a){if(null!==s){var l=s.next;s.next=a.next,a.next=l}s=a,i.shared.pending=null,null!==(l=t.alternate)&&(null!==(l=l.updateQueue)&&(l.baseQueue=a))}if(null!==s){l=s.next;var u=i.baseState,c=0,p=null,h=null,d=null;if(null!==l)for(var f=l;;){if((a=f.expirationTime)<o){var g={expirationTime:f.expirationTime,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null};null===d?(h=d=g,p=u):d=d.next=g,a>c&&(c=a)}else{null!==d&&(d=d.next={expirationTime:1073741823,suspenseConfig:f.suspenseConfig,tag:f.tag,payload:f.payload,callback:f.callback,next:null}),bl(a,f.suspenseConfig);t:{var m=t,y=f;switch(a=e,g=n,y.tag){case 1:if("function"===typeof(m=y.payload)){u=m.call(g,u,a);break t}u=m;break t;case 3:m.effectTag=-4097&m.effectTag|64;case 0:if(null===(a="function"===typeof(m=y.payload)?m.call(g,u,a):m)||void 0===a)break t;u=r({},u,a);break t;case 2:pi=!0}}null!==f.callback&&(t.effectTag|=32,null===(a=i.effects)?i.effects=[f]:a.push(f))}if(null===(f=f.next)||f===l){if(null===(a=i.shared.pending))break;f=s.next=a.next,a.next=l,i.baseQueue=s=a,i.shared.pending=null}}null===d?p=u:d.next=h,i.baseState=p,i.baseQueue=d,xl(c),t.expirationTime=c,t.memoizedState=u}}function vi(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var o=t[e],r=o.callback;if(null!==r){if(o.callback=null,o=r,r=n,"function"!==typeof o)throw Error(s(191,o));o.call(r)}}}var _i=Z.ReactCurrentBatchConfig,Ci=(new o.Component).refs;function wi(t,e,n,o){n=null===(n=n(o,e=t.memoizedState))||void 0===n?e:r({},e,n),t.memoizedState=n,0===t.expirationTime&&(t.updateQueue.baseState=n)}var bi={isMounted:function(t){return!!(t=t._reactInternalFiber)&&te(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var o=ul(),r=_i.suspense;(r=fi(o=cl(o,t,r),r)).payload=e,void 0!==n&&null!==n&&(r.callback=n),gi(t,r),pl(t,o)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var o=ul(),r=_i.suspense;(r=fi(o=cl(o,t,r),r)).tag=1,r.payload=e,void 0!==n&&null!==n&&(r.callback=n),gi(t,r),pl(t,o)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=ul(),o=_i.suspense;(o=fi(n=cl(n,t,o),o)).tag=2,void 0!==e&&null!==e&&(o.callback=e),gi(t,o),pl(t,n)}};function xi(t,e,n,o,r,i,s){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(o,i,s):!e.prototype||!e.prototype.isPureReactComponent||(!qo(n,o)||!qo(r,i))}function Ei(t,e,n){var o=!1,r=yr,i=e.contextType;return"object"===typeof i&&null!==i?i=ci(i):(r=br(e)?Cr:vr.current,i=(o=null!==(o=e.contextTypes)&&void 0!==o)?wr(t,r):yr),e=new e(n,i),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=bi,t.stateNode=e,e._reactInternalFiber=t,o&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function Si(t,e,n,o){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,o),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,o),e.state!==t&&bi.enqueueReplaceState(e,e.state,null)}function Ti(t,e,n,o){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=Ci,hi(t);var i=e.contextType;"object"===typeof i&&null!==i?r.context=ci(i):(i=br(e)?Cr:vr.current,r.context=wr(t,i)),yi(t,n,r,o),r.state=t.memoizedState,"function"===typeof(i=e.getDerivedStateFromProps)&&(wi(t,e,i,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&bi.enqueueReplaceState(r,r.state,null),yi(t,n,r,o),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.effectTag|=4)}var Ri=Array.isArray;function Oi(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var o=n.stateNode}if(!o)throw Error(s(147,t));var r=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===r?e.ref:(e=function(t){var e=o.refs;e===Ci&&(e=o.refs={}),null===t?delete e[r]:e[r]=t},e._stringRef=r,e)}if("string"!==typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function Pi(t,e){if("textarea"!==t.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Ii(t){function e(e,n){if(t){var o=e.lastEffect;null!==o?(o.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,o){if(!t)return null;for(;null!==o;)e(n,o),o=o.sibling;return null}function o(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Hl(t,e)).index=0,t.sibling=null,t}function i(e,n,o){return e.index=o,t?null!==(o=e.alternate)?(o=o.index)<n?(e.effectTag=2,n):o:(e.effectTag=2,n):n}function a(e){return t&&null===e.alternate&&(e.effectTag=2),e}function l(t,e,n,o){return null===e||6!==e.tag?((e=ql(n,t.mode,o)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,o){return null!==e&&e.elementType===n.type?((o=r(e,n.props)).ref=Oi(t,e,n),o.return=t,o):((o=Ul(n.type,n.key,n.props,null,t.mode,o)).ref=Oi(t,e,n),o.return=t,o)}function c(t,e,n,o){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Xl(n,t.mode,o)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function p(t,e,n,o,i){return null===e||7!==e.tag?((e=Wl(n,t.mode,o,i)).return=t,e):((e=r(e,n)).return=t,e)}function h(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=ql(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case tt:return(n=Ul(e.type,e.key,e.props,null,t.mode,n)).ref=Oi(t,null,e),n.return=t,n;case et:return(e=Xl(e,t.mode,n)).return=t,e}if(Ri(e)||gt(e))return(e=Wl(e,t.mode,n,null)).return=t,e;Pi(t,e)}return null}function d(t,e,n,o){var r=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==r?null:l(t,e,""+n,o);if("object"===typeof n&&null!==n){switch(n.$$typeof){case tt:return n.key===r?n.type===nt?p(t,e,n.props.children,o,r):u(t,e,n,o):null;case et:return n.key===r?c(t,e,n,o):null}if(Ri(n)||gt(n))return null!==r?null:p(t,e,n,o,null);Pi(t,n)}return null}function f(t,e,n,o,r){if("string"===typeof o||"number"===typeof o)return l(e,t=t.get(n)||null,""+o,r);if("object"===typeof o&&null!==o){switch(o.$$typeof){case tt:return t=t.get(null===o.key?n:o.key)||null,o.type===nt?p(e,t,o.props.children,r,o.key):u(e,t,o,r);case et:return c(e,t=t.get(null===o.key?n:o.key)||null,o,r)}if(Ri(o)||gt(o))return p(e,t=t.get(n)||null,o,r,null);Pi(e,o)}return null}function g(r,s,a,l){for(var u=null,c=null,p=s,g=s=0,m=null;null!==p&&g<a.length;g++){p.index>g?(m=p,p=null):m=p.sibling;var y=d(r,p,a[g],l);if(null===y){null===p&&(p=m);break}t&&p&&null===y.alternate&&e(r,p),s=i(y,s,g),null===c?u=y:c.sibling=y,c=y,p=m}if(g===a.length)return n(r,p),u;if(null===p){for(;g<a.length;g++)null!==(p=h(r,a[g],l))&&(s=i(p,s,g),null===c?u=p:c.sibling=p,c=p);return u}for(p=o(r,p);g<a.length;g++)null!==(m=f(p,r,g,a[g],l))&&(t&&null!==m.alternate&&p.delete(null===m.key?g:m.key),s=i(m,s,g),null===c?u=m:c.sibling=m,c=m);return t&&p.forEach((function(t){return e(r,t)})),u}function m(r,a,l,u){var c=gt(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var p=c=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var _=d(r,g,v.value,u);if(null===_){null===g&&(g=y);break}t&&g&&null===_.alternate&&e(r,g),a=i(_,a,m),null===p?c=_:p.sibling=_,p=_,g=y}if(v.done)return n(r,g),c;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(r,v.value,u))&&(a=i(v,a,m),null===p?c=v:p.sibling=v,p=v);return c}for(g=o(r,g);!v.done;m++,v=l.next())null!==(v=f(g,r,m,v.value,u))&&(t&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=i(v,a,m),null===p?c=v:p.sibling=v,p=v);return t&&g.forEach((function(t){return e(r,t)})),c}return function(t,o,i,l){var u="object"===typeof i&&null!==i&&i.type===nt&&null===i.key;u&&(i=i.props.children);var c="object"===typeof i&&null!==i;if(c)switch(i.$$typeof){case tt:t:{for(c=i.key,u=o;null!==u;){if(u.key===c){if(7===u.tag){if(i.type===nt){n(t,u.sibling),(o=r(u,i.props.children)).return=t,t=o;break t}}else if(u.elementType===i.type){n(t,u.sibling),(o=r(u,i.props)).ref=Oi(t,u,i),o.return=t,t=o;break t}n(t,u);break}e(t,u),u=u.sibling}i.type===nt?((o=Wl(i.props.children,t.mode,l,i.key)).return=t,t=o):((l=Ul(i.type,i.key,i.props,null,t.mode,l)).ref=Oi(t,o,i),l.return=t,t=l)}return a(t);case et:t:{for(u=i.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===i.containerInfo&&o.stateNode.implementation===i.implementation){n(t,o.sibling),(o=r(o,i.children||[])).return=t,t=o;break t}n(t,o);break}e(t,o),o=o.sibling}(o=Xl(i,t.mode,l)).return=t,t=o}return a(t)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==o&&6===o.tag?(n(t,o.sibling),(o=r(o,i)).return=t,t=o):(n(t,o),(o=ql(i,t.mode,l)).return=t,t=o),a(t);if(Ri(i))return g(t,o,i,l);if(gt(i))return m(t,o,i,l);if(c&&Pi(t,i),"undefined"===typeof i&&!u)switch(t.tag){case 1:case 0:throw t=t.type,Error(s(152,t.displayName||t.name||"Component"))}return n(t,o)}}var Ai=Ii(!0),Di=Ii(!1),Mi={},Li={current:Mi},Ni={current:Mi},Fi={current:Mi};function ki(t){if(t===Mi)throw Error(s(174));return t}function Gi(t,e){switch(mr(Fi,e),mr(Ni,t),mr(Li,Mi),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kt(null,"");break;default:e=kt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}gr(Li),mr(Li,e)}function Bi(){gr(Li),gr(Ni),gr(Fi)}function Vi(t){ki(Fi.current);var e=ki(Li.current),n=kt(e,t.type);e!==n&&(mr(Ni,t),mr(Li,n))}function zi(t){Ni.current===t&&(gr(Li),gr(Ni))}var ji={current:0};function Hi(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===_n||n.data===Cn))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Ui(t,e){return{responder:t,props:e}}var Wi=Z.ReactCurrentDispatcher,qi=Z.ReactCurrentBatchConfig,Xi=0,Yi=null,Ki=null,Zi=null,Ji=!1;function Qi(){throw Error(s(321))}function $i(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Uo(t[n],e[n]))return!1;return!0}function ts(t,e,n,o,r,i){if(Xi=i,Yi=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,Wi.current=null===t||null===t.memoizedState?xs:Es,t=n(o,r),e.expirationTime===Xi){i=0;do{if(e.expirationTime=0,!(25>i))throw Error(s(301));i+=1,Zi=Ki=null,e.updateQueue=null,Wi.current=Ss,t=n(o,r)}while(e.expirationTime===Xi)}if(Wi.current=bs,e=null!==Ki&&null!==Ki.next,Xi=0,Zi=Ki=Yi=null,Ji=!1,e)throw Error(s(300));return t}function es(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Zi?Yi.memoizedState=Zi=t:Zi=Zi.next=t,Zi}function ns(){if(null===Ki){var t=Yi.alternate;t=null!==t?t.memoizedState:null}else t=Ki.next;var e=null===Zi?Yi.memoizedState:Zi.next;if(null!==e)Zi=e,Ki=t;else{if(null===t)throw Error(s(310));t={memoizedState:(Ki=t).memoizedState,baseState:Ki.baseState,baseQueue:Ki.baseQueue,queue:Ki.queue,next:null},null===Zi?Yi.memoizedState=Zi=t:Zi=Zi.next=t}return Zi}function os(t,e){return"function"===typeof e?e(t):e}function rs(t){var e=ns(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var o=Ki,r=o.baseQueue,i=n.pending;if(null!==i){if(null!==r){var a=r.next;r.next=i.next,i.next=a}o.baseQueue=r=i,n.pending=null}if(null!==r){r=r.next,o=o.baseState;var l=a=i=null,u=r;do{var c=u.expirationTime;if(c<Xi){var p={expirationTime:u.expirationTime,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(a=l=p,i=o):l=l.next=p,c>Yi.expirationTime&&(Yi.expirationTime=c,xl(c))}else null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:u.suspenseConfig,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),bl(c,u.suspenseConfig),o=u.eagerReducer===t?u.eagerState:t(o,u.action);u=u.next}while(null!==u&&u!==r);null===l?i=o:l.next=a,Uo(o,e.memoizedState)||(Fs=!0),e.memoizedState=o,e.baseState=i,e.baseQueue=l,n.lastRenderedState=o}return[e.memoizedState,n.dispatch]}function is(t){var e=ns(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var o=n.dispatch,r=n.pending,i=e.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{i=t(i,a.action),a=a.next}while(a!==r);Uo(i,e.memoizedState)||(Fs=!0),e.memoizedState=i,null===e.baseQueue&&(e.baseState=i),n.lastRenderedState=i}return[i,o]}function ss(t){var e=es();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:os,lastRenderedState:t}).dispatch=ws.bind(null,Yi,t),[e.memoizedState,t]}function as(t,e,n,o){return t={tag:t,create:e,destroy:n,deps:o,next:null},null===(e=Yi.updateQueue)?(e={lastEffect:null},Yi.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(o=n.next,n.next=t,t.next=o,e.lastEffect=t),t}function ls(){return ns().memoizedState}function us(t,e,n,o){var r=es();Yi.effectTag|=t,r.memoizedState=as(1|e,n,void 0,void 0===o?null:o)}function cs(t,e,n,o){var r=ns();o=void 0===o?null:o;var i=void 0;if(null!==Ki){var s=Ki.memoizedState;if(i=s.destroy,null!==o&&$i(o,s.deps))return void as(e,n,i,o)}Yi.effectTag|=t,r.memoizedState=as(1|e,n,i,o)}function ps(t,e){return us(516,4,t,e)}function hs(t,e){return cs(516,4,t,e)}function ds(t,e){return cs(4,2,t,e)}function fs(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function gs(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,cs(4,2,fs.bind(null,e,t),n)}function ms(){}function ys(t,e){return es().memoizedState=[t,void 0===e?null:e],t}function vs(t,e){var n=ns();e=void 0===e?null:e;var o=n.memoizedState;return null!==o&&null!==e&&$i(e,o[1])?o[0]:(n.memoizedState=[t,e],t)}function _s(t,e){var n=ns();e=void 0===e?null:e;var o=n.memoizedState;return null!==o&&null!==e&&$i(e,o[1])?o[0]:(t=t(),n.memoizedState=[t,e],t)}function Cs(t,e,n){var o=Xr();Kr(98>o?98:o,(function(){t(!0)})),Kr(97<o?97:o,(function(){var o=qi.suspense;qi.suspense=void 0===e?null:e;try{t(!1),n()}finally{qi.suspense=o}}))}function ws(t,e,n){var o=ul(),r=_i.suspense;r={expirationTime:o=cl(o,t,r),suspenseConfig:r,action:n,eagerReducer:null,eagerState:null,next:null};var i=e.pending;if(null===i?r.next=r:(r.next=i.next,i.next=r),e.pending=r,i=t.alternate,t===Yi||null!==i&&i===Yi)Ji=!0,r.expirationTime=Xi,Yi.expirationTime=Xi;else{if(0===t.expirationTime&&(null===i||0===i.expirationTime)&&null!==(i=e.lastRenderedReducer))try{var s=e.lastRenderedState,a=i(s,n);if(r.eagerReducer=i,r.eagerState=a,Uo(a,s))return}catch(l){}pl(t,o)}}var bs={readContext:ci,useCallback:Qi,useContext:Qi,useEffect:Qi,useImperativeHandle:Qi,useLayoutEffect:Qi,useMemo:Qi,useReducer:Qi,useRef:Qi,useState:Qi,useDebugValue:Qi,useResponder:Qi,useDeferredValue:Qi,useTransition:Qi},xs={readContext:ci,useCallback:ys,useContext:ci,useEffect:ps,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,us(4,2,fs.bind(null,e,t),n)},useLayoutEffect:function(t,e){return us(4,2,t,e)},useMemo:function(t,e){var n=es();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var o=es();return e=void 0!==n?n(e):e,o.memoizedState=o.baseState=e,t=(t=o.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=ws.bind(null,Yi,t),[o.memoizedState,t]},useRef:function(t){return t={current:t},es().memoizedState=t},useState:ss,useDebugValue:ms,useResponder:Ui,useDeferredValue:function(t,e){var n=ss(t),o=n[0],r=n[1];return ps((function(){var n=qi.suspense;qi.suspense=void 0===e?null:e;try{r(t)}finally{qi.suspense=n}}),[t,e]),o},useTransition:function(t){var e=ss(!1),n=e[0];return e=e[1],[ys(Cs.bind(null,e,t),[e,t]),n]}},Es={readContext:ci,useCallback:vs,useContext:ci,useEffect:hs,useImperativeHandle:gs,useLayoutEffect:ds,useMemo:_s,useReducer:rs,useRef:ls,useState:function(){return rs(os)},useDebugValue:ms,useResponder:Ui,useDeferredValue:function(t,e){var n=rs(os),o=n[0],r=n[1];return hs((function(){var n=qi.suspense;qi.suspense=void 0===e?null:e;try{r(t)}finally{qi.suspense=n}}),[t,e]),o},useTransition:function(t){var e=rs(os),n=e[0];return e=e[1],[vs(Cs.bind(null,e,t),[e,t]),n]}},Ss={readContext:ci,useCallback:vs,useContext:ci,useEffect:hs,useImperativeHandle:gs,useLayoutEffect:ds,useMemo:_s,useReducer:is,useRef:ls,useState:function(){return is(os)},useDebugValue:ms,useResponder:Ui,useDeferredValue:function(t,e){var n=is(os),o=n[0],r=n[1];return hs((function(){var n=qi.suspense;qi.suspense=void 0===e?null:e;try{r(t)}finally{qi.suspense=n}}),[t,e]),o},useTransition:function(t){var e=is(os),n=e[0];return e=e[1],[vs(Cs.bind(null,e,t),[e,t]),n]}},Ts=null,Rs=null,Os=!1;function Ps(t,e){var n=zl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Is(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function As(t){if(Os){var e=Rs;if(e){var n=e;if(!Is(t,e)){if(!(e=Rn(n.nextSibling))||!Is(t,e))return t.effectTag=-1025&t.effectTag|2,Os=!1,void(Ts=t);Ps(Ts,n)}Ts=t,Rs=Rn(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,Os=!1,Ts=t}}function Ds(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Ts=t}function Ms(t){if(t!==Ts)return!1;if(!Os)return Ds(t),Os=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!En(e,t.memoizedProps))for(e=Rs;e;)Ps(t,e),e=Rn(e.nextSibling);if(Ds(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if(n===vn){if(0===e){Rs=Rn(t.nextSibling);break t}e--}else n!==yn&&n!==Cn&&n!==_n||e++}t=t.nextSibling}Rs=null}}else Rs=Ts?Rn(t.stateNode.nextSibling):null;return!0}function Ls(){Rs=Ts=null,Os=!1}var Ns=Z.ReactCurrentOwner,Fs=!1;function ks(t,e,n,o){e.child=null===t?Di(e,null,n,o):Ai(e,t.child,n,o)}function Gs(t,e,n,o,r){n=n.render;var i=e.ref;return ui(e,r),o=ts(t,e,n,o,i,r),null===t||Fs?(e.effectTag|=1,ks(t,e,o,r),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),ea(t,e,r))}function Bs(t,e,n,o,r,i){if(null===t){var s=n.type;return"function"!==typeof s||jl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ul(n.type,null,o,null,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,Vs(t,e,s,o,r,i))}return s=t.child,r<i&&(r=s.memoizedProps,(n=null!==(n=n.compare)?n:qo)(r,o)&&t.ref===e.ref)?ea(t,e,i):(e.effectTag|=1,(t=Hl(s,o)).ref=e.ref,t.return=e,e.child=t)}function Vs(t,e,n,o,r,i){return null!==t&&qo(t.memoizedProps,o)&&t.ref===e.ref&&(Fs=!1,r<i)?(e.expirationTime=t.expirationTime,ea(t,e,i)):js(t,e,n,o,i)}function zs(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function js(t,e,n,o,r){var i=br(n)?Cr:vr.current;return i=wr(e,i),ui(e,r),n=ts(t,e,n,o,i,r),null===t||Fs?(e.effectTag|=1,ks(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),ea(t,e,r))}function Hs(t,e,n,o,r){if(br(n)){var i=!0;Tr(e)}else i=!1;if(ui(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),Ei(e,n,o),Ti(e,n,o,r),o=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;"object"===typeof u&&null!==u?u=ci(u):u=wr(e,u=br(n)?Cr:vr.current);var c=n.getDerivedStateFromProps,p="function"===typeof c||"function"===typeof s.getSnapshotBeforeUpdate;p||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==o||l!==u)&&Si(e,s,o,u),pi=!1;var h=e.memoizedState;s.state=h,yi(e,o,s,r),l=e.memoizedState,a!==o||h!==l||_r.current||pi?("function"===typeof c&&(wi(e,n,c,o),l=e.memoizedState),(a=pi||xi(e,n,a,o,h,l,u))?(p||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(e.effectTag|=4)):("function"===typeof s.componentDidMount&&(e.effectTag|=4),e.memoizedProps=o,e.memoizedState=l),s.props=o,s.state=l,s.context=u,o=a):("function"===typeof s.componentDidMount&&(e.effectTag|=4),o=!1)}else s=e.stateNode,di(t,e),a=e.memoizedProps,s.props=e.type===e.elementType?a:ei(e.type,a),l=s.context,"object"===typeof(u=n.contextType)&&null!==u?u=ci(u):u=wr(e,u=br(n)?Cr:vr.current),(p="function"===typeof(c=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==o||l!==u)&&Si(e,s,o,u),pi=!1,l=e.memoizedState,s.state=l,yi(e,o,s,r),h=e.memoizedState,a!==o||l!==h||_r.current||pi?("function"===typeof c&&(wi(e,n,c,o),h=e.memoizedState),(c=pi||xi(e,n,a,o,l,h,u))?(p||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(o,h,u),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(o,h,u)),"function"===typeof s.componentDidUpdate&&(e.effectTag|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=o,e.memoizedState=h),s.props=o,s.state=h,s.context=u,o=c):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),o=!1);return Us(t,e,n,o,i,r)}function Us(t,e,n,o,r,i){zs(t,e);var s=0!==(64&e.effectTag);if(!o&&!s)return r&&Rr(e,n,!1),ea(t,e,i);o=e.stateNode,Ns.current=e;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:o.render();return e.effectTag|=1,null!==t&&s?(e.child=Ai(e,t.child,null,i),e.child=Ai(e,null,a,i)):ks(t,e,a,i),e.memoizedState=o.state,r&&Rr(e,n,!0),e.child}function Ws(t){var e=t.stateNode;e.pendingContext?Er(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Er(0,e.context,!1),Gi(t,e.containerInfo)}var qs,Xs,Ys,Ks,Zs={dehydrated:null,retryTime:0};function Js(t,e,n){var o,r=e.mode,i=e.pendingProps,s=ji.current,a=!1;if((o=0!==(64&e.effectTag))||(o=0!==(2&s)&&(null===t||null!==t.memoizedState)),o?(a=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(s|=1),mr(ji,1&s),null===t){if(void 0!==i.fallback&&As(e),a){if(a=i.fallback,(i=Wl(null,r,0,null)).return=e,0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,i.child=t;null!==t;)t.return=i,t=t.sibling;return(n=Wl(a,r,n,null)).return=e,i.sibling=n,e.memoizedState=Zs,e.child=i,n}return r=i.children,e.memoizedState=null,e.child=Di(e,null,r,n)}if(null!==t.memoizedState){if(r=(t=t.child).sibling,a){if(i=i.fallback,(n=Hl(t,t.pendingProps)).return=e,0===(2&e.mode)&&(a=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=a;null!==a;)a.return=n,a=a.sibling;return(r=Hl(r,i)).return=e,n.sibling=r,n.childExpirationTime=0,e.memoizedState=Zs,e.child=n,r}return n=Ai(e,t.child,i.children,n),e.memoizedState=null,e.child=n}if(t=t.child,a){if(a=i.fallback,(i=Wl(null,r,0,null)).return=e,i.child=t,null!==t&&(t.return=i),0===(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,i.child=t;null!==t;)t.return=i,t=t.sibling;return(n=Wl(a,r,n,null)).return=e,i.sibling=n,n.effectTag|=2,i.childExpirationTime=0,e.memoizedState=Zs,e.child=i,n}return e.memoizedState=null,e.child=Ai(e,t,i.children,n)}function Qs(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),li(t.return,e)}function $s(t,e,n,o,r,i){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:n,tailExpiration:0,tailMode:r,lastEffect:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=o,s.tail=n,s.tailExpiration=0,s.tailMode=r,s.lastEffect=i)}function ta(t,e,n){var o=e.pendingProps,r=o.revealOrder,i=o.tail;if(ks(t,e,o.children,n),0!==(2&(o=ji.current)))o=1&o|2,e.effectTag|=64;else{if(null!==t&&0!==(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Qs(t,n);else if(19===t.tag)Qs(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}o&=1}if(mr(ji,o),0===(2&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===Hi(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),$s(e,!1,r,n,i,e.lastEffect);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===Hi(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}$s(e,!0,n,null,i,e.lastEffect);break;case"together":$s(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function ea(t,e,n){null!==t&&(e.dependencies=t.dependencies);var o=e.expirationTime;if(0!==o&&xl(o),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Hl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Hl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function na(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var o=null;null!==n;)null!==n.alternate&&(o=n),n=n.sibling;null===o?e||null===t.tail?t.tail=null:t.tail.sibling=null:o.sibling=null}}function oa(t,e,n){var o=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return br(e.type)&&xr(),null;case 3:return Bi(),gr(_r),gr(vr),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||!Ms(e)||(e.effectTag|=4),Xs(e),null;case 5:zi(e),n=ki(Fi.current);var i=e.type;if(null!==t&&null!=e.stateNode)Ys(t,e,i,o,n),t.ref!==e.ref&&(e.effectTag|=128);else{if(!o){if(null===e.stateNode)throw Error(s(166));return null}if(t=ki(Li.current),Ms(e)){o=e.stateNode,i=e.type;var a=e.memoizedProps;switch(o[In]=e,o[An]=a,i){case"iframe":case"object":case"embed":Ye("load",o);break;case"video":case"audio":for(t=0;t<Jt.length;t++)Ye(Jt[t],o);break;case"source":Ye("error",o);break;case"img":case"image":case"link":Ye("error",o),Ye("load",o);break;case"form":Ye("reset",o),Ye("submit",o);break;case"details":Ye("toggle",o);break;case"input":xt(o,a),Ye("invalid",o),un(n,"onChange");break;case"select":o._wrapperState={wasMultiple:!!a.multiple},Ye("invalid",o),un(n,"onChange");break;case"textarea":At(o,a),Ye("invalid",o),un(n,"onChange")}for(var l in sn(i,a),t=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?o.textContent!==u&&(t=["children",u]):"number"===typeof u&&o.textContent!==""+u&&(t=["children",""+u]):E.hasOwnProperty(l)&&null!=u&&un(n,l)}switch(i){case"input":Ct(o),Tt(o,a,!0);break;case"textarea":Ct(o),Mt(o);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(o.onclick=cn)}n=t,e.updateQueue=n,null!==n&&(e.effectTag|=4)}else{switch(l=9===n.nodeType?n:n.ownerDocument,t===ln&&(t=Ft(i)),t===ln?"script"===i?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof o.is?t=l.createElement(i,{is:o.is}):(t=l.createElement(i),"select"===i&&(l=t,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):t=l.createElementNS(t,i),t[In]=e,t[An]=o,qs(t,e,!1,!1),e.stateNode=t,l=an(i,o),i){case"iframe":case"object":case"embed":Ye("load",t),u=o;break;case"video":case"audio":for(u=0;u<Jt.length;u++)Ye(Jt[u],t);u=o;break;case"source":Ye("error",t),u=o;break;case"img":case"image":case"link":Ye("error",t),Ye("load",t),u=o;break;case"form":Ye("reset",t),Ye("submit",t),u=o;break;case"details":Ye("toggle",t),u=o;break;case"input":xt(t,o),u=bt(t,o),Ye("invalid",t),un(n,"onChange");break;case"option":u=Ot(t,o);break;case"select":t._wrapperState={wasMultiple:!!o.multiple},u=r({},o,{value:void 0}),Ye("invalid",t),un(n,"onChange");break;case"textarea":At(t,o),u=It(t,o),Ye("invalid",t),un(n,"onChange");break;default:u=o}sn(i,u);var c=u;for(a in c)if(c.hasOwnProperty(a)){var p=c[a];"style"===a?on(t,p):"dangerouslySetInnerHTML"===a?null!=(p=p?p.__html:void 0)&&Vt(t,p):"children"===a?"string"===typeof p?("textarea"!==i||""!==p)&&zt(t,p):"number"===typeof p&&zt(t,""+p):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(E.hasOwnProperty(a)?null!=p&&un(n,a):null!=p&&J(t,a,p,l))}switch(i){case"input":Ct(t),Tt(t,o,!1);break;case"textarea":Ct(t),Mt(t);break;case"option":null!=o.value&&t.setAttribute("value",""+vt(o.value));break;case"select":t.multiple=!!o.multiple,null!=(n=o.value)?Pt(t,!!o.multiple,n,!1):null!=o.defaultValue&&Pt(t,!!o.multiple,o.defaultValue,!0);break;default:"function"===typeof u.onClick&&(t.onclick=cn)}xn(i,o)&&(e.effectTag|=4)}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)Ks(t,e,t.memoizedProps,o);else{if("string"!==typeof o&&null===e.stateNode)throw Error(s(166));n=ki(Fi.current),ki(Li.current),Ms(e)?(n=e.stateNode,o=e.memoizedProps,n[In]=e,n.nodeValue!==o&&(e.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(o))[In]=e,e.stateNode=n)}return null;case 13:return gr(ji),o=e.memoizedState,0!==(64&e.effectTag)?(e.expirationTime=n,e):(n=null!==o,o=!1,null===t?void 0!==e.memoizedProps.fallback&&Ms(e):(o=null!==(i=t.memoizedState),n||null===i||null!==(i=t.child.sibling)&&(null!==(a=e.firstEffect)?(e.firstEffect=i,i.nextEffect=a):(e.firstEffect=e.lastEffect=i,i.nextEffect=null),i.effectTag=8)),n&&!o&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&ji.current)?Ha===Ma&&(Ha=Fa):(Ha!==Ma&&Ha!==Fa||(Ha=ka),0!==Ya&&null!==Va&&(Zl(Va,ja),Jl(Va,Ya)))),(n||o)&&(e.effectTag|=4),null);case 4:return Bi(),Xs(e),null;case 10:return ai(e),null;case 19:if(gr(ji),null===(o=e.memoizedState))return null;if(i=0!==(64&e.effectTag),null===(a=o.rendering)){if(i)na(o,!1);else if(Ha!==Ma||null!==t&&0!==(64&t.effectTag))for(a=e.child;null!==a;){if(null!==(t=Hi(a))){for(e.effectTag|=64,na(o,!1),null!==(i=t.updateQueue)&&(e.updateQueue=i,e.effectTag|=4),null===o.lastEffect&&(e.firstEffect=null),e.lastEffect=o.lastEffect,o=e.child;null!==o;)a=n,(i=o).effectTag&=2,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,null===(t=i.alternate)?(i.childExpirationTime=0,i.expirationTime=a,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null):(i.childExpirationTime=t.childExpirationTime,i.expirationTime=t.expirationTime,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,a=t.dependencies,i.dependencies=null===a?null:{expirationTime:a.expirationTime,firstContext:a.firstContext,responders:a.responders}),o=o.sibling;return mr(ji,1&ji.current|2),e.child}a=a.sibling}}else{if(!i)if(null!==(t=Hi(a))){if(e.effectTag|=64,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.effectTag|=4),na(o,!0),null===o.tail&&"hidden"===o.tailMode&&!a.alternate)return null!==(e=e.lastEffect=o.lastEffect)&&(e.nextEffect=null),null}else 2*qr()-o.renderingStartTime>o.tailExpiration&&1<n&&(e.effectTag|=64,i=!0,na(o,!1),e.expirationTime=e.childExpirationTime=n-1);o.isBackwards?(a.sibling=e.child,e.child=a):(null!==(n=o.last)?n.sibling=a:e.child=a,o.last=a)}return null!==o.tail?(0===o.tailExpiration&&(o.tailExpiration=qr()+500),n=o.tail,o.rendering=n,o.tail=n.sibling,o.lastEffect=e.lastEffect,o.renderingStartTime=qr(),n.sibling=null,e=ji.current,mr(ji,i?1&e|2:1&e),n):null}throw Error(s(156,e.tag))}function ra(t){switch(t.tag){case 1:br(t.type)&&xr();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(Bi(),gr(_r),gr(vr),0!==(64&(e=t.effectTag)))throw Error(s(285));return t.effectTag=-4097&e|64,t;case 5:return zi(t),null;case 13:return gr(ji),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return gr(ji),null;case 4:return Bi(),null;case 10:return ai(t),null;default:return null}}function ia(t,e){return{value:t,source:e,stack:yt(e)}}qs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Xs=function(){},Ys=function(t,e,n,o,i){var s=t.memoizedProps;if(s!==o){var a,l,u=e.stateNode;switch(ki(Li.current),t=null,n){case"input":s=bt(u,s),o=bt(u,o),t=[];break;case"option":s=Ot(u,s),o=Ot(u,o),t=[];break;case"select":s=r({},s,{value:void 0}),o=r({},o,{value:void 0}),t=[];break;case"textarea":s=It(u,s),o=It(u,o),t=[];break;default:"function"!==typeof s.onClick&&"function"===typeof o.onClick&&(u.onclick=cn)}for(a in sn(n,o),n=null,s)if(!o.hasOwnProperty(a)&&s.hasOwnProperty(a)&&null!=s[a])if("style"===a)for(l in u=s[a])u.hasOwnProperty(l)&&(n||(n={}),n[l]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(E.hasOwnProperty(a)?t||(t=[]):(t=t||[]).push(a,null));for(a in o){var c=o[a];if(u=null!=s?s[a]:void 0,o.hasOwnProperty(a)&&c!==u&&(null!=c||null!=u))if("style"===a)if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(t||(t=[]),t.push(a,n)),n=c;else"dangerouslySetInnerHTML"===a?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(t=t||[]).push(a,c)):"children"===a?u===c||"string"!==typeof c&&"number"!==typeof c||(t=t||[]).push(a,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&(E.hasOwnProperty(a)?(null!=c&&un(i,a),t||u===c||(t=[])):(t=t||[]).push(a,c))}n&&(t=t||[]).push("style",n),i=t,(e.updateQueue=i)&&(e.effectTag|=4)}},Ks=function(t,e,n,o){n!==o&&(e.effectTag|=4)};var sa="function"===typeof WeakSet?WeakSet:Set;function aa(t,e){var n=e.source,o=e.stack;null===o&&null!==n&&(o=yt(n)),null!==n&&mt(n.type),e=e.value,null!==t&&1===t.tag&&mt(t.type);try{console.error(e)}catch(r){setTimeout((function(){throw r}))}}function la(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){Nl(t,n)}else e.current=null}function ua(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,o=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:ei(e.type,n),o),t.__reactInternalSnapshotBeforeUpdate=e}return}throw Error(s(163))}function ca(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var o=n.destroy;n.destroy=void 0,void 0!==o&&o()}n=n.next}while(n!==e)}}function pa(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var o=n.create;n.destroy=o()}n=n.next}while(n!==e)}}function ha(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:return void pa(3,n);case 1:if(t=n.stateNode,4&n.effectTag)if(null===e)t.componentDidMount();else{var o=n.elementType===n.type?e.memoizedProps:ei(n.type,e.memoizedProps);t.componentDidUpdate(o,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}return void(null!==(e=n.updateQueue)&&vi(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}vi(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.effectTag&&xn(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&ke(n)))))}throw Error(s(163))}function da(t,e,n){switch("function"===typeof Bl&&Bl(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var o=t.next;Kr(97<n?97:n,(function(){var t=o;do{var n=t.destroy;if(void 0!==n){var r=e;try{n()}catch(i){Nl(r,i)}}t=t.next}while(t!==o)}))}break;case 1:la(e),"function"===typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(n){Nl(t,n)}}(e,n);break;case 5:la(e);break;case 4:_a(t,e,n)}}function fa(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,null!==e&&fa(e)}function ga(t){return 5===t.tag||3===t.tag||4===t.tag}function ma(t){t:{for(var e=t.return;null!==e;){if(ga(e)){var n=e;break t}e=e.return}throw Error(s(160))}switch(e=n.stateNode,n.tag){case 5:var o=!1;break;case 3:case 4:e=e.containerInfo,o=!0;break;default:throw Error(s(161))}16&n.effectTag&&(zt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ga(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}o?ya(t,n,e):va(t,n,e)}function ya(t,e,n){var o=t.tag,r=5===o||6===o;if(r)t=r?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=cn));else if(4!==o&&null!==(t=t.child))for(ya(t,e,n),t=t.sibling;null!==t;)ya(t,e,n),t=t.sibling}function va(t,e,n){var o=t.tag,r=5===o||6===o;if(r)t=r?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==o&&null!==(t=t.child))for(va(t,e,n),t=t.sibling;null!==t;)va(t,e,n),t=t.sibling}function _a(t,e,n){for(var o,r,i=e,a=!1;;){if(!a){a=i.return;t:for(;;){if(null===a)throw Error(s(160));switch(o=a.stateNode,a.tag){case 5:r=!1;break t;case 3:case 4:o=o.containerInfo,r=!0;break t}a=a.return}a=!0}if(5===i.tag||6===i.tag){t:for(var l=t,u=i,c=n,p=u;;)if(da(l,p,c),null!==p.child&&4!==p.tag)p.child.return=p,p=p.child;else{if(p===u)break t;for(;null===p.sibling;){if(null===p.return||p.return===u)break t;p=p.return}p.sibling.return=p.return,p=p.sibling}r?(l=o,u=i.stateNode,8===l.nodeType?l.parentNode.removeChild(u):l.removeChild(u)):o.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){o=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(da(t,i,n),null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function Ca(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:return void ca(3,e);case 1:case 12:case 17:return;case 5:var n=e.stateNode;if(null!=n){var o=e.memoizedProps,r=null!==t?t.memoizedProps:o;t=e.type;var i=e.updateQueue;if(e.updateQueue=null,null!==i){for(n[An]=o,"input"===t&&"radio"===o.type&&null!=o.name&&Et(n,o),an(t,r),e=an(t,o),r=0;r<i.length;r+=2){var a=i[r],l=i[r+1];"style"===a?on(n,l):"dangerouslySetInnerHTML"===a?Vt(n,l):"children"===a?zt(n,l):J(n,a,l,e)}switch(t){case"input":St(n,o);break;case"textarea":Dt(n,o);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!o.multiple,null!=(t=o.value)?Pt(n,!!o.multiple,t,!1):e!==!!o.multiple&&(null!=o.defaultValue?Pt(n,!!o.multiple,o.defaultValue,!0):Pt(n,!!o.multiple,o.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(s(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((e=e.stateNode).hydrate&&(e.hydrate=!1,ke(e.containerInfo)));case 13:if(n=e,null===e.memoizedState?o=!1:(o=!0,n=e.child,Za=qr()),null!==n)t:for(t=n;;){if(5===t.tag)i=t.stateNode,o?"function"===typeof(i=i.style).setProperty?i.setProperty("display","none","important"):i.display="none":(i=t.stateNode,r=void 0!==(r=t.memoizedProps.style)&&null!==r&&r.hasOwnProperty("display")?r.display:null,i.style.display=nn("display",r));else if(6===t.tag)t.stateNode.nodeValue=o?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(i=t.child.sibling).return=t,t=i;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}return void wa(e);case 19:return void wa(e)}throw Error(s(163))}function wa(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new sa),e.forEach((function(e){var o=kl.bind(null,t,e);n.has(e)||(n.add(e),e.then(o,o))}))}}var ba="function"===typeof WeakMap?WeakMap:Map;function xa(t,e,n){(n=fi(n,null)).tag=3,n.payload={element:null};var o=e.value;return n.callback=function(){$a||($a=!0,tl=o),aa(t,e)},n}function Ea(t,e,n){(n=fi(n,null)).tag=3;var o=t.type.getDerivedStateFromError;if("function"===typeof o){var r=e.value;n.payload=function(){return aa(t,e),o(r)}}var i=t.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof o&&(null===el?el=new Set([this]):el.add(this),aa(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var Sa,Ta=Math.ceil,Ra=Z.ReactCurrentDispatcher,Oa=Z.ReactCurrentOwner,Pa=0,Ia=8,Aa=16,Da=32,Ma=0,La=1,Na=2,Fa=3,ka=4,Ga=5,Ba=Pa,Va=null,za=null,ja=0,Ha=Ma,Ua=null,Wa=1073741823,qa=1073741823,Xa=null,Ya=0,Ka=!1,Za=0,Ja=500,Qa=null,$a=!1,tl=null,el=null,nl=!1,ol=null,rl=90,il=null,sl=0,al=null,ll=0;function ul(){return(Ba&(Aa|Da))!==Pa?1073741821-(qr()/10|0):0!==ll?ll:ll=1073741821-(qr()/10|0)}function cl(t,e,n){if(0===(2&(e=e.mode)))return 1073741823;var o=Xr();if(0===(4&e))return 99===o?1073741823:1073741822;if((Ba&Aa)!==Pa)return ja;if(null!==n)t=ti(t,0|n.timeoutMs||5e3,250);else switch(o){case 99:t=1073741823;break;case 98:t=ti(t,150,100);break;case 97:case 96:t=ti(t,5e3,250);break;case 95:t=2;break;default:throw Error(s(326))}return null!==Va&&t===ja&&--t,t}function pl(t,e){if(50<sl)throw sl=0,al=null,Error(s(185));if(null!==(t=hl(t,e))){var n=Xr();1073741823===e?(Ba&Ia)!==Pa&&(Ba&(Aa|Da))===Pa?ml(t):(fl(t),Ba===Pa&&Qr()):fl(t),(4&Ba)===Pa||98!==n&&99!==n||(null===il?il=new Map([[t,e]]):(void 0===(n=il.get(t))||n>e)&&il.set(t,e))}}function hl(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var o=t.return,r=null;if(null===o&&3===t.tag)r=t.stateNode;else for(;null!==o;){if(n=o.alternate,o.childExpirationTime<e&&(o.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===o.return&&3===o.tag){r=o.stateNode;break}o=o.return}return null!==r&&(Va===r&&(xl(e),Ha===ka&&Zl(r,ja)),Jl(r,e)),r}function dl(t){var e=t.lastExpiredTime;if(0!==e)return e;if(!Kl(t,e=t.firstPendingTime))return e;var n=t.lastPingedTime;return 2>=(t=n>(t=t.nextKnownPendingLevel)?n:t)&&e!==t?0:t}function fl(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Jr(ml.bind(null,t));else{var e=dl(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var o=ul();if(1073741823===e?o=99:1===e||2===e?o=95:o=0>=(o=10*(1073741821-e)-10*(1073741821-o))?99:250>=o?98:5250>=o?97:95,null!==n){var r=t.callbackPriority;if(t.callbackExpirationTime===e&&r>=o)return;n!==Br&&Ir(n)}t.callbackExpirationTime=e,t.callbackPriority=o,e=1073741823===e?Jr(ml.bind(null,t)):Zr(o,gl.bind(null,t),{timeout:10*(1073741821-e)-qr()}),t.callbackNode=e}}}function gl(t,e){if(ll=0,e)return Ql(t,e=ul()),fl(t),null;var n=dl(t);if(0!==n){if(e=t.callbackNode,(Ba&(Aa|Da))!==Pa)throw Error(s(327));if(Dl(),t===Va&&n===ja||_l(t,n),null!==za){var o=Ba;Ba|=Aa;for(var r=wl();;)try{Sl();break}catch(l){Cl(t,l)}if(si(),Ba=o,Ra.current=r,Ha===La)throw e=Ua,_l(t,n),Zl(t,n),fl(t),e;if(null===za)switch(r=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,o=Ha,Va=null,o){case Ma:case La:throw Error(s(345));case Na:Ql(t,2<n?2:n);break;case Fa:if(Zl(t,n),n===(o=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Ol(r)),1073741823===Wa&&10<(r=Za+Ja-qr())){if(Ka){var i=t.lastPingedTime;if(0===i||i>=n){t.lastPingedTime=n,_l(t,n);break}}if(0!==(i=dl(t))&&i!==n)break;if(0!==o&&o!==n){t.lastPingedTime=o;break}t.timeoutHandle=Sn(Pl.bind(null,t),r);break}Pl(t);break;case ka:if(Zl(t,n),n===(o=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Ol(r)),Ka&&(0===(r=t.lastPingedTime)||r>=n)){t.lastPingedTime=n,_l(t,n);break}if(0!==(r=dl(t))&&r!==n)break;if(0!==o&&o!==n){t.lastPingedTime=o;break}if(1073741823!==qa?o=10*(1073741821-qa)-qr():1073741823===Wa?o=0:(o=10*(1073741821-Wa)-5e3,0>(o=(r=qr())-o)&&(o=0),(n=10*(1073741821-n)-r)<(o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Ta(o/1960))-o)&&(o=n)),10<o){t.timeoutHandle=Sn(Pl.bind(null,t),o);break}Pl(t);break;case Ga:if(1073741823!==Wa&&null!==Xa){i=Wa;var a=Xa;if(0>=(o=0|a.busyMinDurationMs)?o=0:(r=0|a.busyDelayMs,o=(i=qr()-(10*(1073741821-i)-(0|a.timeoutMs||5e3)))<=r?0:r+o-i),10<o){Zl(t,n),t.timeoutHandle=Sn(Pl.bind(null,t),o);break}}Pl(t);break;default:throw Error(s(329))}if(fl(t),t.callbackNode===e)return gl.bind(null,t)}}return null}function ml(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,(Ba&(Aa|Da))!==Pa)throw Error(s(327));if(Dl(),t===Va&&e===ja||_l(t,e),null!==za){var n=Ba;Ba|=Aa;for(var o=wl();;)try{El();break}catch(r){Cl(t,r)}if(si(),Ba=n,Ra.current=o,Ha===La)throw n=Ua,_l(t,e),Zl(t,e),fl(t),n;if(null!==za)throw Error(s(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Va=null,Pl(t),fl(t)}return null}function yl(t,e){var n=Ba;Ba|=1;try{return t(e)}finally{(Ba=n)===Pa&&Qr()}}function vl(t,e){var n=Ba;Ba&=-2,Ba|=Ia;try{return t(e)}finally{(Ba=n)===Pa&&Qr()}}function _l(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,Tn(n)),null!==za)for(n=za.return;null!==n;){var o=n;switch(o.tag){case 1:null!==(o=o.type.childContextTypes)&&void 0!==o&&xr();break;case 3:Bi(),gr(_r),gr(vr);break;case 5:zi(o);break;case 4:Bi();break;case 13:case 19:gr(ji);break;case 10:ai(o)}n=n.return}Va=t,za=Hl(t.current,null),ja=e,Ha=Ma,Ua=null,qa=Wa=1073741823,Xa=null,Ya=0,Ka=!1}function Cl(t,e){for(;;){try{if(si(),Wi.current=bs,Ji)for(var n=Yi.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}if(Xi=0,Zi=Ki=Yi=null,Ji=!1,null===za||null===za.return)return Ha=La,Ua=e,za=null;t:{var r=t,i=za.return,s=za,a=e;if(e=ja,s.effectTag|=2048,s.firstEffect=s.lastEffect=null,null!==a&&"object"===typeof a&&"function"===typeof a.then){var l=a;if(0===(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.expirationTime=u.expirationTime):(s.updateQueue=null,s.memoizedState=null)}var c=0!==(1&ji.current),p=i;do{var h;if(h=13===p.tag){var d=p.memoizedState;if(null!==d)h=null!==d.dehydrated;else{var f=p.memoizedProps;h=void 0!==f.fallback&&(!0!==f.unstable_avoidThisFallback||!c)}}if(h){var g=p.updateQueue;if(null===g){var m=new Set;m.add(l),p.updateQueue=m}else g.add(l);if(0===(2&p.mode)){if(p.effectTag|=64,s.effectTag&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=fi(1073741823,null);y.tag=2,gi(s,y)}s.expirationTime=1073741823;break t}a=void 0,s=e;var v=r.pingCache;if(null===v?(v=r.pingCache=new ba,a=new Set,v.set(l,a)):void 0===(a=v.get(l))&&(a=new Set,v.set(l,a)),!a.has(s)){a.add(s);var _=Fl.bind(null,r,l,s);l.then(_,_)}p.effectTag|=4096,p.expirationTime=e;break t}p=p.return}while(null!==p);a=Error((mt(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+yt(s))}Ha!==Ga&&(Ha=Na),a=ia(a,s),p=i;do{switch(p.tag){case 3:l=a,p.effectTag|=4096,p.expirationTime=e,mi(p,xa(p,l,e));break t;case 1:l=a;var C=p.type,w=p.stateNode;if(0===(64&p.effectTag)&&("function"===typeof C.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===el||!el.has(w)))){p.effectTag|=4096,p.expirationTime=e,mi(p,Ea(p,l,e));break t}}p=p.return}while(null!==p)}za=Rl(za)}catch(b){e=b;continue}break}}function wl(){var t=Ra.current;return Ra.current=bs,null===t?bs:t}function bl(t,e){t<Wa&&2<t&&(Wa=t),null!==e&&t<qa&&2<t&&(qa=t,Xa=e)}function xl(t){t>Ya&&(Ya=t)}function El(){for(;null!==za;)za=Tl(za)}function Sl(){for(;null!==za&&!Vr();)za=Tl(za)}function Tl(t){var e=Sa(t.alternate,t,ja);return t.memoizedProps=t.pendingProps,null===e&&(e=Rl(t)),Oa.current=null,e}function Rl(t){za=t;do{var e=za.alternate;if(t=za.return,0===(2048&za.effectTag)){if(e=oa(e,za,ja),1===ja||1!==za.childExpirationTime){for(var n=0,o=za.child;null!==o;){var r=o.expirationTime,i=o.childExpirationTime;r>n&&(n=r),i>n&&(n=i),o=o.sibling}za.childExpirationTime=n}if(null!==e)return e;null!==t&&0===(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=za.firstEffect),null!==za.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=za.firstEffect),t.lastEffect=za.lastEffect),1<za.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=za:t.firstEffect=za,t.lastEffect=za))}else{if(null!==(e=ra(za)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=za.sibling))return e;za=t}while(null!==za);return Ha===Ma&&(Ha=Ga),null}function Ol(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function Pl(t){var e=Xr();return Kr(99,Il.bind(null,t,e)),null}function Il(t,e){do{Dl()}while(null!==ol);if((Ba&(Aa|Da))!==Pa)throw Error(s(327));var n=t.finishedWork,o=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(s(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var r=Ol(n);if(t.firstPendingTime=r,o<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:o<=t.firstSuspendedTime&&(t.firstSuspendedTime=o-1),o<=t.lastPingedTime&&(t.lastPingedTime=0),o<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Va&&(za=Va=null,ja=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){var i=Ba;Ba|=Da,Oa.current=null,wn=Xe;var a=gn();if(mn(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else t:{var u=(l=(l=a.ownerDocument)&&l.defaultView||window).getSelection&&l.getSelection();if(u&&0!==u.rangeCount){l=u.anchorNode;var c=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch(T){l=null;break t}var h=0,d=-1,f=-1,g=0,m=0,y=a,v=null;e:for(;;){for(var _;y!==l||0!==c&&3!==y.nodeType||(d=h+c),y!==p||0!==u&&3!==y.nodeType||(f=h+u),3===y.nodeType&&(h+=y.nodeValue.length),null!==(_=y.firstChild);)v=y,y=_;for(;;){if(y===a)break e;if(v===l&&++g===c&&(d=h),v===p&&++m===u&&(f=h),null!==(_=y.nextSibling))break;v=(y=v).parentNode}y=_}l=-1===d||-1===f?null:{start:d,end:f}}else l=null}l=l||{start:0,end:0}}else l=null;bn={activeElementDetached:null,focusedElem:a,selectionRange:l},Xe=!1,Qa=r;do{try{Al()}catch(T){if(null===Qa)throw Error(s(330));Nl(Qa,T),Qa=Qa.nextEffect}}while(null!==Qa);Qa=r;do{try{for(a=t,l=e;null!==Qa;){var C=Qa.effectTag;if(16&C&&zt(Qa.stateNode,""),128&C){var w=Qa.alternate;if(null!==w){var b=w.ref;null!==b&&("function"===typeof b?b(null):b.current=null)}}switch(1038&C){case 2:ma(Qa),Qa.effectTag&=-3;break;case 6:ma(Qa),Qa.effectTag&=-3,Ca(Qa.alternate,Qa);break;case 1024:Qa.effectTag&=-1025;break;case 1028:Qa.effectTag&=-1025,Ca(Qa.alternate,Qa);break;case 4:Ca(Qa.alternate,Qa);break;case 8:_a(a,c=Qa,l),fa(c)}Qa=Qa.nextEffect}}catch(T){if(null===Qa)throw Error(s(330));Nl(Qa,T),Qa=Qa.nextEffect}}while(null!==Qa);if(b=bn,w=gn(),C=b.focusedElem,l=b.selectionRange,w!==C&&C&&C.ownerDocument&&fn(C.ownerDocument.documentElement,C)){null!==l&&mn(C)&&(w=l.start,void 0===(b=l.end)&&(b=w),"selectionStart"in C?(C.selectionStart=w,C.selectionEnd=Math.min(b,C.value.length)):(b=(w=C.ownerDocument||document)&&w.defaultView||window).getSelection&&(b=b.getSelection(),c=C.textContent.length,a=Math.min(l.start,c),l=void 0===l.end?a:Math.min(l.end,c),!b.extend&&a>l&&(c=l,l=a,a=c),c=dn(C,a),p=dn(C,l),c&&p&&(1!==b.rangeCount||b.anchorNode!==c.node||b.anchorOffset!==c.offset||b.focusNode!==p.node||b.focusOffset!==p.offset)&&((w=w.createRange()).setStart(c.node,c.offset),b.removeAllRanges(),a>l?(b.addRange(w),b.extend(p.node,p.offset)):(w.setEnd(p.node,p.offset),b.addRange(w))))),w=[];for(b=C;b=b.parentNode;)1===b.nodeType&&w.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"===typeof C.focus&&C.focus(),C=0;C<w.length;C++)(b=w[C]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Xe=!!wn,bn=wn=null,t.current=n,Qa=r;do{try{for(C=t;null!==Qa;){var x=Qa.effectTag;if(36&x&&ha(C,Qa.alternate,Qa),128&x){w=void 0;var E=Qa.ref;if(null!==E){var S=Qa.stateNode;Qa.tag,w=S,"function"===typeof E?E(w):E.current=w}}Qa=Qa.nextEffect}}catch(T){if(null===Qa)throw Error(s(330));Nl(Qa,T),Qa=Qa.nextEffect}}while(null!==Qa);Qa=null,zr(),Ba=i}else t.current=n;if(nl)nl=!1,ol=t,rl=e;else for(Qa=r;null!==Qa;)e=Qa.nextEffect,Qa.nextEffect=null,Qa=e;if(0===(e=t.firstPendingTime)&&(el=null),1073741823===e?t===al?sl++:(sl=0,al=t):sl=0,"function"===typeof Gl&&Gl(n.stateNode,o),fl(t),$a)throw $a=!1,t=tl,tl=null,t;return(Ba&Ia)!==Pa||Qr(),null}function Al(){for(;null!==Qa;){var t=Qa.effectTag;0!==(256&t)&&ua(Qa.alternate,Qa),0===(512&t)||nl||(nl=!0,Zr(97,(function(){return Dl(),null}))),Qa=Qa.nextEffect}}function Dl(){if(90!==rl){var t=97<rl?97:rl;return rl=90,Kr(t,Ml)}}function Ml(){if(null===ol)return!1;var t=ol;if(ol=null,(Ba&(Aa|Da))!==Pa)throw Error(s(331));var e=Ba;for(Ba|=Da,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:ca(5,n),pa(5,n)}}catch(o){if(null===t)throw Error(s(330));Nl(t,o)}n=t.nextEffect,t.nextEffect=null,t=n}return Ba=e,Qr(),!0}function Ll(t,e,n){gi(t,e=xa(t,e=ia(n,e),1073741823)),null!==(t=hl(t,1073741823))&&fl(t)}function Nl(t,e){if(3===t.tag)Ll(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Ll(n,t,e);break}if(1===n.tag){var o=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof o.componentDidCatch&&(null===el||!el.has(o))){gi(n,t=Ea(n,t=ia(e,t),1073741823)),null!==(n=hl(n,1073741823))&&fl(n);break}}n=n.return}}function Fl(t,e,n){var o=t.pingCache;null!==o&&o.delete(e),Va===t&&ja===n?Ha===ka||Ha===Fa&&1073741823===Wa&&qr()-Za<Ja?_l(t,ja):Ka=!0:Kl(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,fl(t)))}function kl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=cl(e=ul(),t,null)),null!==(t=hl(t,e))&&fl(t)}Sa=function(t,e,n){var o=e.expirationTime;if(null!==t){var r=e.pendingProps;if(t.memoizedProps!==r||_r.current)Fs=!0;else{if(o<n){switch(Fs=!1,e.tag){case 3:Ws(e),Ls();break;case 5:if(Vi(e),4&e.mode&&1!==n&&r.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:br(e.type)&&Tr(e);break;case 4:Gi(e,e.stateNode.containerInfo);break;case 10:o=e.memoizedProps.value,r=e.type._context,mr(ni,r._currentValue),r._currentValue=o;break;case 13:if(null!==e.memoizedState)return 0!==(o=e.child.childExpirationTime)&&o>=n?Js(t,e,n):(mr(ji,1&ji.current),null!==(e=ea(t,e,n))?e.sibling:null);mr(ji,1&ji.current);break;case 19:if(o=e.childExpirationTime>=n,0!==(64&t.effectTag)){if(o)return ta(t,e,n);e.effectTag|=64}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null),mr(ji,ji.current),!o)return null}return ea(t,e,n)}Fs=!1}}else Fs=!1;switch(e.expirationTime=0,e.tag){case 2:if(o=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,r=wr(e,vr.current),ui(e,n),r=ts(null,e,o,t,r,n),e.effectTag|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,br(o)){var i=!0;Tr(e)}else i=!1;e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,hi(e);var a=o.getDerivedStateFromProps;"function"===typeof a&&wi(e,o,a,t),r.updater=bi,e.stateNode=r,r._reactInternalFiber=e,Ti(e,o,t,n),e=Us(null,e,o,!0,i,n)}else e.tag=0,ks(null,e,r,n),e=e.child;return e;case 16:t:{if(r=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(r),1!==r._status)throw r._result;switch(r=r._result,e.type=r,i=e.tag=function(t){if("function"===typeof t)return jl(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===lt)return 11;if(t===pt)return 14}return 2}(r),t=ei(r,t),i){case 0:e=js(null,e,r,t,n);break t;case 1:e=Hs(null,e,r,t,n);break t;case 11:e=Gs(null,e,r,t,n);break t;case 14:e=Bs(null,e,r,ei(r.type,t),o,n);break t}throw Error(s(306,r,""))}return e;case 0:return o=e.type,r=e.pendingProps,js(t,e,o,r=e.elementType===o?r:ei(o,r),n);case 1:return o=e.type,r=e.pendingProps,Hs(t,e,o,r=e.elementType===o?r:ei(o,r),n);case 3:if(Ws(e),o=e.updateQueue,null===t||null===o)throw Error(s(282));if(o=e.pendingProps,r=null!==(r=e.memoizedState)?r.element:null,di(t,e),yi(e,o,null,n),(o=e.memoizedState.element)===r)Ls(),e=ea(t,e,n);else{if((r=e.stateNode.hydrate)&&(Rs=Rn(e.stateNode.containerInfo.firstChild),Ts=e,r=Os=!0),r)for(n=Di(e,null,o,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else ks(t,e,o,n),Ls();e=e.child}return e;case 5:return Vi(e),null===t&&As(e),o=e.type,r=e.pendingProps,i=null!==t?t.memoizedProps:null,a=r.children,En(o,r)?a=null:null!==i&&En(o,i)&&(e.effectTag|=16),zs(t,e),4&e.mode&&1!==n&&r.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(ks(t,e,a,n),e=e.child),e;case 6:return null===t&&As(e),null;case 13:return Js(t,e,n);case 4:return Gi(e,e.stateNode.containerInfo),o=e.pendingProps,null===t?e.child=Ai(e,null,o,n):ks(t,e,o,n),e.child;case 11:return o=e.type,r=e.pendingProps,Gs(t,e,o,r=e.elementType===o?r:ei(o,r),n);case 7:return ks(t,e,e.pendingProps,n),e.child;case 8:case 12:return ks(t,e,e.pendingProps.children,n),e.child;case 10:t:{o=e.type._context,r=e.pendingProps,a=e.memoizedProps,i=r.value;var l=e.type._context;if(mr(ni,l._currentValue),l._currentValue=i,null!==a)if(l=a.value,0===(i=Uo(l,i)?0:0|("function"===typeof o._calculateChangedBits?o._calculateChangedBits(l,i):1073741823))){if(a.children===r.children&&!_r.current){e=ea(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){a=l.child;for(var c=u.firstContext;null!==c;){if(c.context===o&&0!==(c.observedBits&i)){1===l.tag&&((c=fi(n,null)).tag=2,gi(l,c)),l.expirationTime<n&&(l.expirationTime=n),null!==(c=l.alternate)&&c.expirationTime<n&&(c.expirationTime=n),li(l.return,n),u.expirationTime<n&&(u.expirationTime=n);break}c=c.next}}else a=10===l.tag&&l.type===e.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===e){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}ks(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,o=(i=e.pendingProps).children,ui(e,n),o=o(r=ci(r,i.unstable_observedBits)),e.effectTag|=1,ks(t,e,o,n),e.child;case 14:return i=ei(r=e.type,e.pendingProps),Bs(t,e,r,i=ei(r.type,i),o,n);case 15:return Vs(t,e,e.type,e.pendingProps,o,n);case 17:return o=e.type,r=e.pendingProps,r=e.elementType===o?r:ei(o,r),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,br(o)?(t=!0,Tr(e)):t=!1,ui(e,n),Ei(e,o,r),Ti(e,o,r,n),Us(null,e,o,!0,t,n);case 19:return ta(t,e,n)}throw Error(s(156,e.tag))};var Gl=null,Bl=null;function Vl(t,e,n,o){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function zl(t,e,n,o){return new Vl(t,e,n,o)}function jl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Hl(t,e){var n=t.alternate;return null===n?((n=zl(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ul(t,e,n,o,r,i){var a=2;if(o=t,"function"===typeof t)jl(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case nt:return Wl(n.children,r,i,e);case at:a=8,r|=7;break;case ot:a=8,r|=1;break;case rt:return(t=zl(12,n,e,8|r)).elementType=rt,t.type=rt,t.expirationTime=i,t;case ut:return(t=zl(13,n,e,r)).type=ut,t.elementType=ut,t.expirationTime=i,t;case ct:return(t=zl(19,n,e,r)).elementType=ct,t.expirationTime=i,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case it:a=10;break t;case st:a=9;break t;case lt:a=11;break t;case pt:a=14;break t;case ht:a=16,o=null;break t;case dt:a=22;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=zl(a,n,e,r)).elementType=t,e.type=o,e.expirationTime=i,e}function Wl(t,e,n,o){return(t=zl(7,t,o,e)).expirationTime=n,t}function ql(t,e,n){return(t=zl(6,t,null,e)).expirationTime=n,t}function Xl(t,e,n){return(e=zl(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Yl(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kl(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function Zl(t,e){var n=t.firstSuspendedTime,o=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(o>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Jl(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function Ql(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function $l(t,e,n,o){var r=e.current,i=ul(),a=_i.suspense;i=cl(i,r,a);t:if(n){e:{if(te(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(br(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var u=n.type;if(br(u)){n=Sr(n,u,l);break t}}n=l}else n=yr;return null===e.context?e.context=n:e.pendingContext=n,(e=fi(i,a)).payload={element:t},null!==(o=void 0===o?null:o)&&(e.callback=o),gi(r,e),pl(r,i),i}function tu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function eu(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function nu(t,e){eu(t,e),(t=t.alternate)&&eu(t,e)}function ou(t,e,n){var o=new Yl(t,e,n=null!=n&&!0===n.hydrate),r=zl(3,null,null,2===e?7:1===e?3:0);o.current=r,r.stateNode=o,hi(r),t[Dn]=o.current,n&&0!==e&&function(t,e){var n=$t(e);Re.forEach((function(t){ge(t,e,n)})),Oe.forEach((function(t){ge(t,e,n)}))}(0,9===t.nodeType?t:t.ownerDocument),this._internalRoot=o}function ru(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function iu(t,e,n,o,r){var i=n._reactRootContainer;if(i){var s=i._internalRoot;if("function"===typeof r){var a=r;r=function(){var t=tu(s);a.call(t)}}$l(e,s,t,r)}else{if(i=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new ou(t,0,e?{hydrate:!0}:void 0)}(n,o),s=i._internalRoot,"function"===typeof r){var l=r;r=function(){var t=tu(s);l.call(t)}}vl((function(){$l(e,s,t,r)}))}return tu(s)}function su(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ru(e))throw Error(s(200));return function(t,e,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:et,key:null==o?null:""+o,children:t,containerInfo:e,implementation:n}}(t,e,null,n)}ou.prototype.render=function(t){$l(t,this._internalRoot,null,null)},ou.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;$l(null,t,null,(function(){e[Dn]=null}))},me=function(t){if(13===t.tag){var e=ti(ul(),150,100);pl(t,e),nu(t,e)}},ye=function(t){13===t.tag&&(pl(t,3),nu(t,3))},ve=function(t){if(13===t.tag){var e=ul();pl(t,e=cl(e,t,null)),nu(t,e)}},O=function(t,e,n){switch(e){case"input":if(St(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var o=n[e];if(o!==t&&o.form===t.form){var r=Fn(o);if(!r)throw Error(s(90));wt(o),St(o,r)}}}break;case"textarea":Dt(t,n);break;case"select":null!=(e=n.value)&&Pt(t,!!n.multiple,e,!1)}},L=yl,N=function(t,e,n,o,r){var i=Ba;Ba|=4;try{return Kr(98,t.bind(null,e,n,o,r))}finally{(Ba=i)===Pa&&Qr()}},F=function(){(Ba&(1|Aa|Da))===Pa&&(function(){if(null!==il){var t=il;il=null,t.forEach((function(t,e){Ql(e,t),fl(e)})),Qr()}}(),Dl())},k=function(t,e){var n=Ba;Ba|=2;try{return t(e)}finally{(Ba=n)===Pa&&Qr()}};var au={Events:[Ln,Nn,Fn,T,x,Hn,function(t){ie(t,jn)},D,M,Qe,le,Dl,{current:!1}]};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);Gl=function(t){try{e.onCommitFiberRoot(n,t,void 0,64===(64&t.current.effectTag))}catch(o){}},Bl=function(t){try{e.onCommitFiberUnmount(n,t)}catch(o){}}}catch(o){}})(r({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Z.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=oe(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Mn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=au,e.createPortal=su,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw Error(s(268,Object.keys(t)))}return t=null===(t=oe(e))?null:t.stateNode},e.flushSync=function(t,e){if((Ba&(Aa|Da))!==Pa)throw Error(s(187));var n=Ba;Ba|=1;try{return Kr(99,t.bind(null,e))}finally{Ba=n,Qr()}},e.hydrate=function(t,e,n){if(!ru(e))throw Error(s(200));return iu(null,t,e,!0,n)},e.render=function(t,e,n){if(!ru(e))throw Error(s(200));return iu(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!ru(t))throw Error(s(40));return!!t._reactRootContainer&&(vl((function(){iu(null,null,t,!1,(function(){t._reactRootContainer=null,t[Dn]=null}))})),!0)},e.unstable_batchedUpdates=yl,e.unstable_createPortal=function(t,e){return su(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,o){if(!ru(n))throw Error(s(200));if(null==t||void 0===t._reactInternalFiber)throw Error(s(38));return iu(t,e,n,!1,o)},e.version="16.14.0"},4164:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(4463)},8340:(t,e,n)=>{"use strict";t.exports=n(4424)},6374:(t,e,n)=>{"use strict";var o=n(2791),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var o,i={},u=null,c=null;for(o in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)s.call(e,o)&&!l.hasOwnProperty(o)&&(i[o]=e[o]);if(t&&t.defaultProps)for(o in e=t.defaultProps)void 0===i[o]&&(i[o]=e[o]);return{$$typeof:r,type:t,key:u,ref:c,props:i,_owner:a.current}}e.jsx=u,e.jsxs=u},9117:(t,e)=>{"use strict";var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||f}function v(){}function _(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var C=_.prototype=new v;C.constructor=_,g(C,y.prototype),C.isPureReactComponent=!0;var w=Array.isArray,b=Object.prototype.hasOwnProperty,x={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,o){var r,i={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)b.call(e,r)&&!E.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(1===l)i.children=o;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:n,type:t,key:s,ref:a,props:i,_owner:x.current}}function T(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var R=/\/+/g;function O(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function P(t,e,r,i,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case o:l=!0}}if(l)return s=s(l=t),t=""===i?"."+O(l,0):i,w(s)?(r="",null!=t&&(r=t.replace(R,"$&/")+"/"),P(s,e,r,"",(function(t){return t}))):null!=s&&(T(s)&&(s=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(R,"$&/")+"/")+t)),e.push(s)),1;if(l=0,i=""===i?".":i+":",w(t))for(var u=0;u<t.length;u++){var c=i+O(a=t[u],u);l+=P(a,e,r,c,s)}else if(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"===typeof c)for(t=c.call(t),u=0;!(a=t.next()).done;)l+=P(a=a.value,e,r,c=i+O(a,u++),s);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function I(t,e,n){if(null==t)return t;var o=[],r=0;return P(t,o,"","",(function(t){return e.call(n,t,r++)})),o}function A(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var D={current:null},M={transition:null},L={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:M,ReactCurrentOwner:x};e.Children={map:I,forEach:function(t,e,n){I(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return I(t,(function(){e++})),e},toArray:function(t){return I(t,(function(t){return t}))||[]},only:function(t){if(!T(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=r,e.Profiler=s,e.PureComponent=_,e.StrictMode=i,e.Suspense=c,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,e.cloneElement=function(t,e,o){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=g({},t.props),i=t.key,s=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,a=x.current),void 0!==e.key&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)b.call(e,u)&&!E.hasOwnProperty(u)&&(r[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)r.children=o;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:n,type:t.type,key:i,ref:s,props:r,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=T,e.lazy=function(t){return{$$typeof:h,_payload:{_status:-1,_result:t},_init:A}},e.memo=function(t,e){return{$$typeof:p,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return D.current.useCallback(t,e)},e.useContext=function(t){return D.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return D.current.useDeferredValue(t)},e.useEffect=function(t,e){return D.current.useEffect(t,e)},e.useId=function(){return D.current.useId()},e.useImperativeHandle=function(t,e,n){return D.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return D.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return D.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return D.current.useMemo(t,e)},e.useReducer=function(t,e,n){return D.current.useReducer(t,e,n)},e.useRef=function(t){return D.current.useRef(t)},e.useState=function(t){return D.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return D.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return D.current.useTransition()},e.version="18.2.0"},2791:(t,e,n)=>{"use strict";t.exports=n(9117)},184:(t,e,n)=>{"use strict";t.exports=n(6374)},5844:(t,e,n)=>{"use strict";var o=n(2422),r=Object,i=TypeError;t.exports=o((function(){if(null!=this&&this!==r(this))throw new i("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t}),"get flags",!0)},3535:(t,e,n)=>{"use strict";var o=n(9396),r=n(9722),i=n(5844),s=n(1334),a=n(7888),l=r(s());o(l,{getPolyfill:s,implementation:i,shim:a}),t.exports=l},1334:(t,e,n)=>{"use strict";var o=n(5844),r=n(9396).supportsDescriptors,i=Object.getOwnPropertyDescriptor;t.exports=function(){if(r&&"gim"===/a/gim.flags){var t=i(RegExp.prototype,"flags");if(t&&"function"===typeof t.get&&"boolean"===typeof RegExp.prototype.dotAll&&"boolean"===typeof RegExp.prototype.hasIndices){var e="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){e+="d"}}),Object.defineProperty(n,"sticky",{get:function(){e+="y"}}),"dy"===e)return t.get}}return o}},7888:(t,e,n)=>{"use strict";var o=n(9396).supportsDescriptors,r=n(1334),i=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!o||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=r(),e=l(u),n=i(e,"flags");return n&&n.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},4460:function(t,e){!function(t){"use strict";const e=134217729,n=33306690738754706e-32;function o(t,e,n,o,r){let i,s,a,l,u=e[0],c=o[0],p=0,h=0;c>u==c>-u?(i=u,u=e[++p]):(i=c,c=o[++h]);let d=0;if(p<t&&h<n)for(c>u==c>-u?(a=i-((s=u+i)-u),u=e[++p]):(a=i-((s=c+i)-c),c=o[++h]),i=s,0!==a&&(r[d++]=a);p<t&&h<n;)c>u==c>-u?(a=i-((s=i+u)-(l=s-i))+(u-l),u=e[++p]):(a=i-((s=i+c)-(l=s-i))+(c-l),c=o[++h]),i=s,0!==a&&(r[d++]=a);for(;p<t;)a=i-((s=i+u)-(l=s-i))+(u-l),u=e[++p],i=s,0!==a&&(r[d++]=a);for(;h<n;)a=i-((s=i+c)-(l=s-i))+(c-l),c=o[++h],i=s,0!==a&&(r[d++]=a);return 0===i&&0!==d||(r[d++]=i),d}function r(t){return new Float64Array(t)}const i=33306690738754716e-32,s=22204460492503146e-32,a=11093356479670487e-47,l=r(4),u=r(8),c=r(12),p=r(16),h=r(4);t.orient2d=function(t,r,d,f,g,m){const y=(r-m)*(d-g),v=(t-g)*(f-m),_=y-v;if(0===y||0===v||y>0!=v>0)return _;const C=Math.abs(y+v);return Math.abs(_)>=i*C?_:-function(t,r,i,d,f,g,m){let y,v,_,C,w,b,x,E,S,T,R,O,P,I,A,D,M,L;const N=t-f,F=i-f,k=r-g,G=d-g;w=(A=(E=N-(x=(b=e*N)-(b-N)))*(T=G-(S=(b=e*G)-(b-G)))-((I=N*G)-x*S-E*S-x*T))-(R=A-(M=(E=k-(x=(b=e*k)-(b-k)))*(T=F-(S=(b=e*F)-(b-F)))-((D=k*F)-x*S-E*S-x*T))),l[0]=A-(R+w)+(w-M),w=(P=I-((O=I+R)-(w=O-I))+(R-w))-(R=P-D),l[1]=P-(R+w)+(w-D),w=(L=O+R)-O,l[2]=O-(L-w)+(R-w),l[3]=L;let B=function(t,e){let n=e[0];for(let o=1;o<t;o++)n+=e[o];return n}(4,l),V=s*m;if(B>=V||-B>=V)return B;if(y=t-(N+(w=t-N))+(w-f),_=i-(F+(w=i-F))+(w-f),v=r-(k+(w=r-k))+(w-g),C=d-(G+(w=d-G))+(w-g),0===y&&0===v&&0===_&&0===C)return B;if(V=a*m+n*Math.abs(B),(B+=N*C+G*y-(k*_+F*v))>=V||-B>=V)return B;w=(A=(E=y-(x=(b=e*y)-(b-y)))*(T=G-(S=(b=e*G)-(b-G)))-((I=y*G)-x*S-E*S-x*T))-(R=A-(M=(E=v-(x=(b=e*v)-(b-v)))*(T=F-(S=(b=e*F)-(b-F)))-((D=v*F)-x*S-E*S-x*T))),h[0]=A-(R+w)+(w-M),w=(P=I-((O=I+R)-(w=O-I))+(R-w))-(R=P-D),h[1]=P-(R+w)+(w-D),w=(L=O+R)-O,h[2]=O-(L-w)+(R-w),h[3]=L;const z=o(4,l,4,h,u);w=(A=(E=N-(x=(b=e*N)-(b-N)))*(T=C-(S=(b=e*C)-(b-C)))-((I=N*C)-x*S-E*S-x*T))-(R=A-(M=(E=k-(x=(b=e*k)-(b-k)))*(T=_-(S=(b=e*_)-(b-_)))-((D=k*_)-x*S-E*S-x*T))),h[0]=A-(R+w)+(w-M),w=(P=I-((O=I+R)-(w=O-I))+(R-w))-(R=P-D),h[1]=P-(R+w)+(w-D),w=(L=O+R)-O,h[2]=O-(L-w)+(R-w),h[3]=L;const j=o(z,u,4,h,c);w=(A=(E=y-(x=(b=e*y)-(b-y)))*(T=C-(S=(b=e*C)-(b-C)))-((I=y*C)-x*S-E*S-x*T))-(R=A-(M=(E=v-(x=(b=e*v)-(b-v)))*(T=_-(S=(b=e*_)-(b-_)))-((D=v*_)-x*S-E*S-x*T))),h[0]=A-(R+w)+(w-M),w=(P=I-((O=I+R)-(w=O-I))+(R-w))-(R=P-D),h[1]=P-(R+w)+(w-D),w=(L=O+R)-O,h[2]=O-(L-w)+(R-w),h[3]=L;const H=o(j,c,4,h,p);return p[H-1]}(t,r,d,f,g,m,C)},t.orient2dfast=function(t,e,n,o,r,i){return(e-i)*(n-r)-(t-r)*(o-i)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},6813:(t,e)=>{"use strict";var n,o,r,i,s;if("undefined"===typeof window||"function"!==typeof MessageChannel){var a=null,l=null,u=function(){if(null!==a)try{var t=e.unstable_now();a(!0,t),a=null}catch(n){throw setTimeout(u,0),n}},c=Date.now();e.unstable_now=function(){return Date.now()-c},n=function(t){null!==a?setTimeout(n,0,t):(a=t,setTimeout(u,0))},o=function(t,e){l=setTimeout(t,e)},r=function(){clearTimeout(l)},i=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var p=window.performance,h=window.Date,d=window.setTimeout,f=window.clearTimeout;if("undefined"!==typeof console){var g=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof p&&"function"===typeof p.now)e.unstable_now=function(){return p.now()};else{var m=h.now();e.unstable_now=function(){return h.now()-m}}var y=!1,v=null,_=-1,C=5,w=0;i=function(){return e.unstable_now()>=w},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):C=0<t?Math.floor(1e3/t):5};var b=new MessageChannel,x=b.port2;b.port1.onmessage=function(){if(null!==v){var t=e.unstable_now();w=t+C;try{v(!0,t)?x.postMessage(null):(y=!1,v=null)}catch(n){throw x.postMessage(null),n}}else y=!1},n=function(t){v=t,y||(y=!0,x.postMessage(null))},o=function(t,n){_=d((function(){t(e.unstable_now())}),n)},r=function(){f(_),_=-1}}function E(t,e){var n=t.length;t.push(e);t:for(;;){var o=n-1>>>1,r=t[o];if(!(void 0!==r&&0<R(r,e)))break t;t[o]=e,t[n]=r,n=o}}function S(t){return void 0===(t=t[0])?null:t}function T(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var o=0,r=t.length;o<r;){var i=2*(o+1)-1,s=t[i],a=i+1,l=t[a];if(void 0!==s&&0>R(s,n))void 0!==l&&0>R(l,s)?(t[o]=l,t[a]=n,o=a):(t[o]=s,t[i]=n,o=i);else{if(!(void 0!==l&&0>R(l,n)))break t;t[o]=l,t[a]=n,o=a}}}return e}return null}function R(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var O=[],P=[],I=1,A=null,D=3,M=!1,L=!1,N=!1;function F(t){for(var e=S(P);null!==e;){if(null===e.callback)T(P);else{if(!(e.startTime<=t))break;T(P),e.sortIndex=e.expirationTime,E(O,e)}e=S(P)}}function k(t){if(N=!1,F(t),!L)if(null!==S(O))L=!0,n(G);else{var e=S(P);null!==e&&o(k,e.startTime-t)}}function G(t,n){L=!1,N&&(N=!1,r()),M=!0;var s=D;try{for(F(n),A=S(O);null!==A&&(!(A.expirationTime>n)||t&&!i());){var a=A.callback;if(null!==a){A.callback=null,D=A.priorityLevel;var l=a(A.expirationTime<=n);n=e.unstable_now(),"function"===typeof l?A.callback=l:A===S(O)&&T(O),F(n)}else T(O);A=S(O)}if(null!==A)var u=!0;else{var c=S(P);null!==c&&o(k,c.startTime-n),u=!1}return u}finally{A=null,D=s,M=!1}}function B(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var V=s;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){L||M||(L=!0,n(G))},e.unstable_getCurrentPriorityLevel=function(){return D},e.unstable_getFirstCallbackNode=function(){return S(O)},e.unstable_next=function(t){switch(D){case 1:case 2:case 3:var e=3;break;default:e=D}var n=D;D=e;try{return t()}finally{D=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=V,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=D;D=t;try{return e()}finally{D=n}},e.unstable_scheduleCallback=function(t,i,s){var a=e.unstable_now();if("object"===typeof s&&null!==s){var l=s.delay;l="number"===typeof l&&0<l?a+l:a,s="number"===typeof s.timeout?s.timeout:B(t)}else s=B(t),l=a;return t={id:I++,callback:i,priorityLevel:t,startTime:l,expirationTime:s=l+s,sortIndex:-1},l>a?(t.sortIndex=l,E(P,t),null===S(O)&&t===S(P)&&(N?r():N=!0,o(k,l-a))):(t.sortIndex=s,E(O,t),L||M||(L=!0,n(G))),t},e.unstable_shouldYield=function(){var t=e.unstable_now();F(t);var n=S(O);return n!==A&&null!==A&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<A.expirationTime||i()},e.unstable_wrapCallback=function(t){var e=D;return function(){var n=D;D=e;try{return t.apply(this,arguments)}finally{D=n}}}},5296:(t,e,n)=>{"use strict";t.exports=n(6813)},2422:(t,e,n)=>{"use strict";var o=n(2651),r=n(4510)(),i=n(4583).functionsHaveConfigurableNames(),s=TypeError;t.exports=function(t,e){if("function"!==typeof t)throw new s("`fn` is not a function");return arguments.length>2&&!!arguments[2]&&!i||(r?o(t,"name",e,!0,!0):o(t,"name",e)),t}},1848:t=>{"use strict";t.exports={eudist:function(t,e,n){for(var o=t.length,r=0,i=0;i<o;i++){var s=(t[i]||0)-(e[i]||0);r+=s*s}return n?Math.sqrt(r):r},mandist:function(t,e,n){for(var o=t.length,r=0,i=0;i<o;i++)r+=Math.abs((t[i]||0)-(e[i]||0));return n?Math.sqrt(r):r},dist:function(t,e,n){var o=Math.abs(t-e);return n?o:o*o}}},3556:(t,e,n)=>{"use strict";var o=n(1848),r=o.eudist,i=o.dist;t.exports={kmrand:function(t,e){for(var n={},o=[],r=e<<2,i=t.length,s=t[0].length>0;o.length<e&&r-- >0;){var a=t[Math.floor(Math.random()*i)],l=s?a.join("_"):""+a;n[l]||(n[l]=!0,o.push(a))}if(o.length<e)throw new Error("Error initializating clusters");return o},kmpp:function(t,e){var n=t[0].length?r:i,o=[],s=t.length,a=t[0].length>0,l=t[Math.floor(Math.random()*s)];a&&l.join("_");for(o.push(l);o.length<e;){for(var u=[],c=o.length,p=0,h=[],d=0;d<s;d++){for(var f=1/0,g=0;g<c;g++){var m=n(t[d],o[g]);m<=f&&(f=m)}u[d]=f}for(var y=0;y<s;y++)p+=u[y];for(var v=0;v<s;v++)h[v]={i:v,v:t[v],pr:u[v]/p,cs:0};h.sort((function(t,e){return t.pr-e.pr})),h[0].cs=h[0].pr;for(var _=1;_<s;_++)h[_].cs=h[_-1].cs+h[_].pr;for(var C=Math.random(),w=0;w<s-1&&h[w++].cs<C;);o.push(h[w-1].v)}return o}}},6530:(t,e,n)=>{"use strict";var o=n(1848),r=n(3556),i=o.eudist,s=(o.mandist,o.dist,r.kmrand),a=r.kmpp;function l(t,e,n){n=n||[];for(var o=0;o<t;o++)n[o]=e;return n}t.exports=function(t,e,n,o){var r=[],u=[],c=[],p=[],h=!1,d=o||1e4,f=t.length,g=t[0].length,m=g>0,y=[];if(n)r="kmrand"==n?s(t,e):"kmpp"==n?a(t,e):n;else for(var v={};r.length<e;){var _=Math.floor(Math.random()*f);v[_]||(v[_]=!0,r.push(t[_]))}do{l(e,0,y);for(var C=0;C<f;C++){for(var w=1/0,b=0,x=0;x<e;x++){(p=m?i(t[C],r[x]):Math.abs(t[C]-r[x]))<=w&&(w=p,b=x)}c[C]=b,y[b]++}for(var E=[],S=(u=[],0);S<e;S++)E[S]=m?l(g,0,E[S]):0,u[S]=r[S];if(m){for(var T=0;T<e;T++)r[T]=[];for(var R=0;R<f;R++)for(var O=E[c[R]],P=t[R],I=0;I<g;I++)O[I]+=P[I];h=!0;for(var A=0;A<e;A++){for(var D=r[A],M=E[A],L=u[A],N=y[A],F=0;F<g;F++)D[F]=M[F]/N||0;if(h)for(var k=0;k<g;k++)if(L[k]!=D[k]){h=!1;break}}}else{for(var G=0;G<f;G++){E[c[G]]+=t[G]}for(var B=0;B<e;B++)r[B]=E[B]/y[B]||0;h=!0;for(var V=0;V<e;V++)if(u[V]!=r[V]){h=!1;break}}h=h||--d<=0}while(!h);return{it:1e4-d,k:e,idxs:c,centroids:r}}},4613:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});class o{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,o=e[t];for(;t>0;){const r=t-1>>1,i=e[r];if(n(o,i)>=0)break;e[t]=i,t=r}e[t]=o}_down(t){const{data:e,compare:n}=this,o=this.length>>1,r=e[t];for(;t<o;){let o=1+(t<<1),i=e[o];const s=o+1;if(s<this.length&&n(e[s],i)<0&&(o=s,i=e[s]),n(i,r)>=0)break;e[t]=i,t=o}e[t]=r}}function r(t,e){return t<e?-1:t>e?1:0}},4035:function(t,e){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function o(t){this.message=t||""}function r(t){this.message=t||""}function i(){}function s(t){return null===t?Lt:t.color}function a(t){return null===t?null:t.parent}function l(t,e){null!==t&&(t.color=e)}function u(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function p(){this.root_=null,this.size_=0}function h(){}function d(){this.array_=[],arguments[0]instanceof Ct&&this.addAll(arguments[0])}function f(){}function g(t){this.message=t||""}function m(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(void 0===this||null===this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(arguments[1]),10)||0;o=o<0?Math.max(n+o,0):Math.min(o,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);o<r;)e[o]=t,++o;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var y=function(){};y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var v=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),_=function(){},C={MAX_VALUE:{configurable:!0}};_.isNaN=function(t){return Number.isNaN(t)},_.doubleToLongBits=function(t){return t},_.longBitsToDouble=function(t){return t},_.isInfinite=function(t){return!Number.isFinite(t)},C.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(_,C);var w=function(){},b=function(){},x=function(){},E=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},S={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};E.prototype.setOrdinate=function(t,e){switch(t){case E.X:this.x=e;break;case E.Y:this.y=e;break;case E.Z:this.z=e;break;default:throw new v("Invalid ordinate index: "+t)}},E.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!y.equalsWithTolerance(this.x,e.x,n)&&!!y.equalsWithTolerance(this.y,e.y,n)}},E.prototype.getOrdinate=function(t){switch(t){case E.X:return this.x;case E.Y:return this.y;case E.Z:return this.z}throw new v("Invalid ordinate index: "+t)},E.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||_.isNaN(this.z))&&_.isNaN(t.z)},E.prototype.equals=function(t){return t instanceof E&&this.equals2D(t)},E.prototype.equalInZ=function(t,e){return y.equalsWithTolerance(this.z,t.z,e)},E.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},E.prototype.clone=function(){},E.prototype.copy=function(){return new E(this)},E.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},E.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,o=this.z-t.z;return Math.sqrt(e*e+n*n+o*o)},E.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},E.prototype.hashCode=function(){var t=17;return 37*(t=37*t+E.hashCode(this.x))+E.hashCode(this.y)},E.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},E.prototype.interfaces_=function(){return[w,b,e]},E.prototype.getClass=function(){return E},E.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=_.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},S.DimensionalComparator.get=function(){return T},S.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},S.NULL_ORDINATE.get=function(){return _.NaN},S.X.get=function(){return 0},S.Y.get=function(){return 1},S.Z.get=function(){return 2},Object.defineProperties(E,S);var T=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new v("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};T.prototype.compare=function(t,e){var n=t,o=e,r=T.compare(n.x,o.x);if(0!==r)return r;var i=T.compare(n.y,o.y);return 0!==i?i:this._dimensionsToTest<=2?0:T.compare(n.z,o.z)},T.prototype.interfaces_=function(){return[x]},T.prototype.getClass=function(){return T},T.compare=function(t,e){return t<e?-1:t>e?1:_.isNaN(t)?_.isNaN(e)?0:-1:_.isNaN(e)?1:0};var R=function(){};R.prototype.create=function(){},R.prototype.interfaces_=function(){return[]},R.prototype.getClass=function(){return R};var O=function(){},P={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};O.prototype.interfaces_=function(){return[]},O.prototype.getClass=function(){return O},O.toLocationSymbol=function(t){switch(t){case O.EXTERIOR:return"e";case O.BOUNDARY:return"b";case O.INTERIOR:return"i";case O.NONE:return"-"}throw new v("Unknown location value: "+t)},P.INTERIOR.get=function(){return 0},P.BOUNDARY.get=function(){return 1},P.EXTERIOR.get=function(){return 2},P.NONE.get=function(){return-1},Object.defineProperties(O,P);var I=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},A=function(){},D={LOG_10:{configurable:!0}};A.prototype.interfaces_=function(){return[]},A.prototype.getClass=function(){return A},A.log10=function(t){var e=Math.log(t);return _.isInfinite(e)||_.isNaN(e)?e:e/A.LOG_10},A.min=function(t,e,n,o){var r=t;return e<r&&(r=e),n<r&&(r=n),o<r&&(r=o),r},A.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],r=arguments[1],i=arguments[2];return o<r?r:o>i?i:o}},A.wrap=function(t,e){return t<0?e- -t%e:t%e},A.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var o=arguments[1],r=arguments[2],i=arguments[3],s=arguments[0];return o>s&&(s=o),r>s&&(s=r),i>s&&(s=i),s}},A.average=function(t,e){return(t+e)/2},D.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(A,D);var M=function(t){this.str=t};M.prototype.append=function(t){this.str+=t},M.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},M.prototype.toString=function(t){return this.str};var L=function(t){this.value=t};L.prototype.intValue=function(){return this.value},L.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},L.isNaN=function(t){return Number.isNaN(t)};var N=function(){};N.isWhitespace=function(t){return t<=32&&t>=0||127===t},N.toUpperCase=function(t){return t.toUpperCase()};var F=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var o=arguments[0],r=arguments[1];this.init(o,r)}},k={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};F.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},F.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),o=F.magnitude(n._hi),r=F.TEN.pow(o);(n=n.divide(r)).gt(F.TEN)?(n=n.divide(F.TEN),o+=1):n.lt(F.ONE)&&(n=n.multiply(F.TEN),o-=1);for(var i=o+1,s=new M,a=F.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===i&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,p=0;u>9?(c=!0,p="9"):p="0"+u,s.append(p),n=n.subtract(F.valueOf(u)).multiply(F.TEN),c&&n.selfAdd(F.TEN);var h=!0,d=F.magnitude(n._hi);if(d<0&&Math.abs(d)>=a-l&&(h=!1),!h)break}return e[0]=o,s.toString()},F.prototype.sqr=function(){return this.multiply(this)},F.prototype.doubleValue=function(){return this._hi+this._lo},F.prototype.subtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},F.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},F.prototype.isZero=function(){return 0===this._hi&&0===this._lo},F.prototype.selfSubtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},F.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},F.prototype.min=function(t){return this.le(t)?this:t},F.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],o=arguments[1],r=null,i=null,s=null,a=null,l=null,u=null,c=null,p=null;return l=this._hi/n,p=(r=(u=F.SPLIT*l)-(r=u-l))*(s=(p=F.SPLIT*n)-(s=p-n))-(c=l*n)+r*(a=n-s)+(i=l-r)*s+i*a,p=l+(u=(this._hi-c-p+this._lo-l*o)/n),this._hi=p,this._lo=l-p+u,this}},F.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},F.prototype.divide=function(){if(arguments[0]instanceof F){var t=arguments[0],e=null,n=null,o=null,r=null,i=null,s=null,a=null,l=null;return n=(i=this._hi/t._hi)-(e=(s=F.SPLIT*i)-(e=s-i)),l=e*(o=(l=F.SPLIT*t._hi)-(o=l-t._hi))-(a=i*t._hi)+e*(r=t._hi-o)+n*o+n*r,s=(this._hi-a-l+this._lo-i*t._lo)/t._hi,new F(l=i+s,i-l+s)}if("number"==typeof arguments[0]){var u=arguments[0];return _.isNaN(u)?F.createNaN():F.copy(this).selfDivide(u,0)}},F.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},F.prototype.pow=function(t){if(0===t)return F.valueOf(1);var e=new F(this),n=F.valueOf(1),o=Math.abs(t);if(o>1)for(;o>0;)o%2==1&&n.selfMultiply(e),(o/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},F.prototype.ceil=function(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)},F.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},F.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},F.prototype.setValue=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},F.prototype.max=function(t){return this.ge(t)?this:t},F.prototype.sqrt=function(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=F.valueOf(e),o=this.subtract(n.sqr())._hi*(.5*t);return n.add(o)},F.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,o=null,r=null,i=null,s=null,a=null;return i=(r=this._hi+e)-(s=r-this._hi),o=(a=(i=e-s+(this._hi-i))+this._lo)+(r-(n=r+a)),this._hi=n+o,this._lo=o+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,p=null,h=null,d=null,f=null,g=null,m=null;d=this._hi+l,p=this._lo+u,f=d-(g=d-this._hi),h=p-(m=p-this._lo);var y=(c=d+(g=(f=l-g+(this._hi-f))+p))+(g=(h=u-m+(this._lo-h))+(g+(d-c))),v=g+(c-y);return this._hi=y,this._lo=v,this}},F.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],o=arguments[1],r=null,i=null,s=null,a=null,l=null,u=null;r=(l=F.SPLIT*this._hi)-this._hi,u=F.SPLIT*n,r=l-r,i=this._hi-r,s=u-n;var c=(l=this._hi*n)+(u=r*(s=u-s)-l+r*(a=n-s)+i*s+i*a+(this._hi*o+this._lo*n)),p=u+(r=l-c);return this._hi=c,this._lo=p,this}},F.prototype.selfSqr=function(){return this.selfMultiply(this)},F.prototype.floor=function(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)},F.prototype.negate=function(){return this.isNaN()?this:new F(-this._hi,-this._lo)},F.prototype.clone=function(){},F.prototype.multiply=function(){if(arguments[0]instanceof F){var t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return _.isNaN(e)?F.createNaN():F.copy(this).selfMultiply(e,0)}},F.prototype.isNaN=function(){return _.isNaN(this._hi)},F.prototype.intValue=function(){return Math.trunc(this._hi)},F.prototype.toString=function(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},F.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),o=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(o<0)r="0."+F.stringOfChar("0",-o)+n;else if(-1===n.indexOf(".")){var i=o-n.length;r=n+F.stringOfChar("0",i)+".0"}return this.isNegative()?"-"+r:r},F.prototype.reciprocal=function(){var t=null,e=null,n=null,o=null,r=null,i=null,s=null,a=null;e=(r=1/this._hi)-(t=(i=F.SPLIT*r)-(t=i-r)),n=(a=F.SPLIT*this._hi)-this._hi;var l=r+(i=(1-(s=r*this._hi)-(a=t*(n=a-n)-s+t*(o=this._hi-n)+e*n+e*o)-r*this._lo)/this._hi);return new F(l,r-l+i)},F.prototype.toSciNotation=function(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),o=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var i=n.charAt(0)+"."+r;return this.isNegative()?"-"+i+o:i+o},F.prototype.abs=function(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)},F.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},F.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},F.prototype.add=function(){if(arguments[0]instanceof F){var t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return F.copy(this).selfAdd(e)}},F.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],o=arguments[1];this._hi=n,this._lo=o}},F.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},F.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},F.prototype.trunc=function(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()},F.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},F.prototype.interfaces_=function(){return[e,w,b]},F.prototype.getClass=function(){return F},F.sqr=function(t){return F.valueOf(t).selfMultiply(t)},F.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0])return new F(arguments[0])},F.sqrt=function(t){return F.valueOf(t).sqrt()},F.parse=function(t){for(var e=0,n=t.length;N.isWhitespace(t.charAt(e));)e++;var o=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(o=!0))}for(var i=new F,s=0,a=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,N.isDigit(u)){var c=u-"0";i.selfMultiply(F.TEN),i.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var p=t.substring(e);try{l=L.parseInt(p)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+p+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var h=i,d=s-a-l;if(0===d)h=i;else if(d>0){var f=F.TEN.pow(d);h=i.divide(f)}else if(d<0){var g=F.TEN.pow(-d);h=i.multiply(g)}return o?h.negate():h},F.createNaN=function(){return new F(_.NaN,_.NaN)},F.copy=function(t){return new F(t)},F.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),o=Math.trunc(Math.floor(n));return 10*Math.pow(10,o)<=e&&(o+=1),o},F.stringOfChar=function(t,e){for(var n=new M,o=0;o<e;o++)n.append(t);return n.toString()},k.PI.get=function(){return new F(3.141592653589793,12246467991473532e-32)},k.TWO_PI.get=function(){return new F(6.283185307179586,24492935982947064e-32)},k.PI_2.get=function(){return new F(1.5707963267948966,6123233995736766e-32)},k.E.get=function(){return new F(2.718281828459045,14456468917292502e-32)},k.NaN.get=function(){return new F(_.NaN,_.NaN)},k.EPS.get=function(){return 123259516440783e-46},k.SPLIT.get=function(){return 134217729},k.MAX_PRINT_DIGITS.get=function(){return 32},k.TEN.get=function(){return F.valueOf(10)},k.ONE.get=function(){return F.valueOf(1)},k.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},k.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(F,k);var G=function(){},B={DP_SAFE_EPSILON:{configurable:!0}};G.prototype.interfaces_=function(){return[]},G.prototype.getClass=function(){return G},G.orientationIndex=function(t,e,n){var o=G.orientationIndexFilter(t,e,n);if(o<=1)return o;var r=F.valueOf(e.x).selfAdd(-t.x),i=F.valueOf(e.y).selfAdd(-t.y),s=F.valueOf(n.x).selfAdd(-e.x),a=F.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(i.selfMultiply(s)).signum()},G.signOfDet2x2=function(t,e,n,o){return t.multiply(o).selfSubtract(e.multiply(n)).signum()},G.intersection=function(t,e,n,o){var r=F.valueOf(o.y).selfSubtract(n.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),i=F.valueOf(o.x).selfSubtract(n.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(i),a=F.valueOf(o.x).selfSubtract(n.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),l=F.valueOf(o.y).selfSubtract(n.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),p=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),h=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),d=p.subtract(h).selfDivide(s).doubleValue(),f=F.valueOf(n.y).selfAdd(F.valueOf(o.y).selfSubtract(n.y).selfMultiply(d)).doubleValue();return new E(c,f)},G.orientationIndexFilter=function(t,e,n){var o=null,r=(t.x-n.x)*(e.y-n.y),i=(t.y-n.y)*(e.x-n.x),s=r-i;if(r>0){if(i<=0)return G.signum(s);o=r+i}else{if(!(r<0))return G.signum(s);if(i>=0)return G.signum(s);o=-r-i}var a=G.DP_SAFE_EPSILON*o;return s>=a||-s>=a?G.signum(s):2},G.signum=function(t){return t>0?1:t<0?-1:0},B.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(G,B);var V=function(){},z={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};z.X.get=function(){return 0},z.Y.get=function(){return 1},z.Z.get=function(){return 2},z.M.get=function(){return 3},V.prototype.setOrdinate=function(t,e,n){},V.prototype.size=function(){},V.prototype.getOrdinate=function(t,e){},V.prototype.getCoordinate=function(){},V.prototype.getCoordinateCopy=function(t){},V.prototype.getDimension=function(){},V.prototype.getX=function(t){},V.prototype.clone=function(){},V.prototype.expandEnvelope=function(t){},V.prototype.copy=function(){},V.prototype.getY=function(t){},V.prototype.toCoordinateArray=function(){},V.prototype.interfaces_=function(){return[b]},V.prototype.getClass=function(){return V},Object.defineProperties(V,z);var j=function(){},H=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(j),U=function(){};U.arraycopy=function(t,e,n,o,r){for(var i=0,s=e;s<e+r;s++)n[o+i]=t[s],i++},U.getProperty=function(t){return{"line.separator":"\n"}[t]};var W=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],o=arguments[1];this.x=n,this.y=o,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],i=arguments[1];this.x=r.y*i.w-i.y*r.w,this.y=i.x*r.w-r.x*i.w,this.w=r.x*i.y-i.x*r.y}else if(arguments[0]instanceof E&&arguments[1]instanceof E){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var p=arguments[0],h=arguments[1],d=arguments[2],f=arguments[3],g=p.y-h.y,m=h.x-p.x,y=p.x*h.y-h.x*p.y,v=d.y-f.y,_=f.x-d.x,C=d.x*f.y-f.x*d.y;this.x=m*C-_*y,this.y=v*y-g*C,this.w=g*_-v*m}};W.prototype.getY=function(){var t=this.y/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new H;return t},W.prototype.getX=function(){var t=this.x/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new H;return t},W.prototype.getCoordinate=function(){var t=new E;return t.x=this.getX(),t.y=this.getY(),t},W.prototype.interfaces_=function(){return[]},W.prototype.getClass=function(){return W},W.intersection=function(t,e,n,o){var r=t.y-e.y,i=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-o.y,l=o.x-n.x,u=n.x*o.y-o.x*n.y,c=r*l-a*i,p=(i*u-l*s)/c,h=(a*s-r*u)/c;if(_.isNaN(p)||_.isInfinite(p)||_.isNaN(h)||_.isInfinite(h))throw new H;return new E(p,h)};var q=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof E){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var o=arguments[0],r=arguments[1];this.init(o.x,r.x,o.y,r.y)}else if(4===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(i,s,a,l)}},X={serialVersionUID:{configurable:!0}};q.prototype.getArea=function(){return this.getWidth()*this.getHeight()},q.prototype.equals=function(t){if(!(t instanceof q))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},q.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new q;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,o=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new q(e,o,n,r)},q.prototype.isNull=function(){return this._maxx<this._minx},q.prototype.getMaxX=function(){return this._maxx},q.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof q){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],o=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&o>=this._miny&&o<=this._maxy}},q.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof q){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof E){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],o=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||o>this._maxy||o<this._miny)}},q.prototype.getMinY=function(){return this._miny},q.prototype.getMinX=function(){return this._minx},q.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof q){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],o=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=o,this._maxy=o):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}},q.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},q.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},q.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},q.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},q.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},q.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},q.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},q.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},q.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},q.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof q){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof E){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],o=arguments[1];return this.covers(n,o)}},q.prototype.centre=function(){return this.isNull()?null:new E((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},q.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof q){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],o=arguments[1];this.init(n.x,o.x,n.y,o.y)}else if(4===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3];r<i?(this._minx=r,this._maxx=i):(this._minx=i,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},q.prototype.getMaxY=function(){return this._maxy},q.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},q.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+E.hashCode(this._minx))+E.hashCode(this._maxx))+E.hashCode(this._miny))+E.hashCode(this._maxy)},q.prototype.interfaces_=function(){return[w,e]},q.prototype.getClass=function(){return q},q.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var o=arguments[0],r=arguments[1],i=arguments[2],s=arguments[3],a=Math.min(i.x,s.x),l=Math.max(i.x,s.x),u=Math.min(o.x,r.x),c=Math.max(o.x,r.x);return!(u>l)&&!(c<a)&&(a=Math.min(i.y,s.y),l=Math.max(i.y,s.y),u=Math.min(o.y,r.y),c=Math.max(o.y,r.y),!(u>l)&&!(c<a))}},X.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(q,X);var Y={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},K=function(t){this.geometryFactory=t||new ye};K.prototype.read=function(t){var e,n,o;t=t.replace(/[\n\r]/g," ");var r=Y.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Y.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),o=r[2],J[n]&&(e=J[n].apply(this,[o]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},K.prototype.write=function(t){return this.extractGeometry(t)},K.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Z[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Z[e].apply(this,[t])+")"};var Z={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Z.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,o=t._geometries.length;n<o;++n)e.push("("+Z.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,o=t._points._coordinates.length;n<o;++n)e.push(Z.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,o=t._points._coordinates.length;n<o;++n)e.push(Z.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,o=t._geometries.length;n<o;++n)e.push("("+Z.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Z.linestring.apply(this,[t._shell])+")");for(var n=0,o=t._holes.length;n<o;++n)e.push("("+Z.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,o=t._geometries.length;n<o;++n)e.push("("+Z.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,o=t._geometries.length;n<o;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},J={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Y.spaces);return this.geometryFactory.createPoint(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),o=[],r=0,i=n.length;r<i;++r)e=n[r].replace(Y.trimParens,"$1"),o.push(J.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(o)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),o=[],r=0,i=n.length;r<i;++r)e=n[r].trim().split(Y.spaces),o.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(o)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),o=[],r=0,i=n.length;r<i;++r)e=n[r].trim().split(Y.spaces),o.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(o)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(Y.parenComma),o=[],r=0,i=n.length;r<i;++r)e=n[r].replace(Y.trimParens,"$1"),o.push(J.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(o)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,o,r,i=t.trim().split(Y.parenComma),s=[],a=0,l=i.length;a<l;++a)e=i[a].replace(Y.trimParens,"$1"),n=J.linestring.apply(this,[e]),o=this.geometryFactory.createLinearRing(n._points),0===a?r=o:s.push(o);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(Y.doubleParenComma),o=[],r=0,i=n.length;r<i;++r)e=n[r].replace(Y.trimParens,"$1"),o.push(J.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(o)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],o=0,r=e.length;o<r;++o)n.push(this.read(e[o]));return this.geometryFactory.createGeometryCollection(n)}},Q=function(t){this.parser=new K(t)};Q.prototype.write=function(t){return this.parser.write(t)},Q.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],et.isTrue(t,null);else if(2===arguments.length&&(e=arguments[1],!(t=arguments[0])))throw null===e?new tt:new tt(e)},et.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],et.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new E,this._intPt[1]=new E,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ot={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new M;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,o){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=o,this._result=this.computeIntersect(t,e,n,o)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return Q.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Q.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var o=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),i=-1;if(t.equals(e))i=0;else if(t.equals(n))i=o>r?o:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(i=o>r?s:a)||t.equals(e)||(i=Math.max(s,a))}return et.isTrue(!(0===i&&!t.equals(e)),"Bad distance calculation"),i},nt.nonRobustComputeEdgeDistance=function(t,e,n){var o=t.x-e.x,r=t.y-e.y,i=Math.sqrt(o*o+r*r);return et.isTrue(!(0===i&&!t.equals(e)),"Invalid distance calculation"),i},ot.DONT_INTERSECT.get=function(){return 0},ot.DO_INTERSECT.get=function(){return 1},ot.COLLINEAR.get=function(){return 2},ot.NO_INTERSECTION.get=function(){return 0},ot.POINT_INTERSECTION.get=function(){return 1},ot.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,ot);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new q(this._inputLines[0][0],this._inputLines[0][1]),n=new q(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],o=arguments[2];if(this._isProper=!1,q.intersects(n,o,e)&&0===at.orientationIndex(n,o,e)&&0===at.orientationIndex(o,n,e))return this._isProper=!0,(e.equals(n)||e.equals(o))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,o,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,o.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,o.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,o.x-=r.x,o.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,o,r){var i=null;try{i=W.intersection(t,n,o,r)}catch(s){if(!(s instanceof H))throw s;i=e.nearestEndpoint(t,n,o,r)}return i},e.prototype.intersection=function(t,n,o,r){var i=this.intersectionWithNormalization(t,n,o,r);return this.isInSegmentEnvelopes(i)||(i=new E(e.nearestEndpoint(t,n,o,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(i),i},e.prototype.smallestInAbsValue=function(t,e,n,o){var r=t,i=Math.abs(r);return Math.abs(e)<i&&(r=e,i=Math.abs(e)),Math.abs(n)<i&&(r=n,i=Math.abs(n)),Math.abs(o)<i&&(r=o),r},e.prototype.checkDD=function(t,e,n,o,r){var i=G.intersection(t,e,n,o),s=this.isInSegmentEnvelopes(i);U.out.println("DD in env = "+s+"  --------------------- "+i),r.distance(i)>1e-4&&U.out.println("Distance = "+r.distance(i))},e.prototype.intersectionWithNormalization=function(t,e,n,o){var r=new E(t),i=new E(e),s=new E(n),a=new E(o),l=new E;this.normalizeToEnvCentre(r,i,s,a,l);var u=this.safeHCoordinateIntersection(r,i,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,o,r){var i=q.intersects(e,n,o),s=q.intersects(e,n,r),a=q.intersects(o,r,e),l=q.intersects(o,r,n);return i&&s?(this._intPt[0]=o,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):i&&a?(this._intPt[0]=o,this._intPt[1]=e,!o.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):i&&l?(this._intPt[0]=o,this._intPt[1]=n,!o.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||i||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||i||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,o,r){var i=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<o.x?n.x:o.x,c=n.y<o.y?n.y:o.y,p=n.x>o.x?n.x:o.x,h=n.y>o.y?n.y:o.y,d=((i>u?i:u)+(a<p?a:p))/2,f=((s>c?s:c)+(l<h?l:h))/2;r.x=d,r.y=f,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,o.x-=r.x,o.y-=r.y},e.prototype.computeIntersect=function(e,n,o,r){if(this._isProper=!1,!q.intersects(e,n,o,r))return t.NO_INTERSECTION;var i=at.orientationIndex(e,n,o),s=at.orientationIndex(e,n,r);if(i>0&&s>0||i<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(o,r,e),l=at.orientationIndex(o,r,n);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===i&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,n,o,r):(0===i||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(o)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(o)||n.equals2D(r)?this._intPt[0]=n:0===i?this._intPt[0]=new E(o):0===s?this._intPt[0]=new E(r):0===a?this._intPt[0]=new E(e):0===l&&(this._intPt[0]=new E(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,o,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,o){var r=t,i=at.distancePointLine(t,n,o),s=at.distancePointLine(e,n,o);return s<i&&(i=s,r=e),(s=at.distancePointLine(n,t,e))<i&&(i=s,r=n),(s=at.distancePointLine(o,t,e))<i&&(i=s,r=o),r},e}(nt),it=function(){};it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.orientationIndex=function(t,e,n){var o=e.x-t.x,r=e.y-t.y,i=n.x-e.x,s=n.y-e.y;return it.signOfDet2x2(o,r,i,s)},it.signOfDet2x2=function(t,e,n,o){var r=null,i=null,s=null;if(r=1,0===t||0===o)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return o>0?t>0?r:-r:t>0?-r:r;if(e>0?o>0?e<=o||(r=-r,i=t,t=n,n=i,i=e,e=o,o=i):e<=-o?(r=-r,n=-n,o=-o):(i=t,t=-n,n=i,i=e,e=-o,o=i):o>0?-e<=o?(r=-r,t=-t,e=-e):(i=-t,t=n,n=i,i=-e,e=o,o=i):e>=o?(t=-t,e=-e,n=-n,o=-o):(r=-r,i=-t,t=-n,n=i,i=-e,e=-o,o=i),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((o-=(s=Math.floor(n/t))*e)<0)return-r;if(o>e)return r;if(t>(n-=s*t)+n){if(e<o+o)return r}else{if(e>o+o)return-r;n=t-n,o=e-o,r=-r}if(0===o)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*o)<0)return r;if(e>o)return-r;if(n>(t-=s*n)+t){if(o<e+e)return-r}else{if(o>e+e)return r;t=n-t,e=o-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,o=e.x;return n>o&&(n=e.x,o=t.x),this._p.x>=n&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,i=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=it.signOfDet2x2(r,i,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<i&&(l=-l),l>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==O.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?O.BOUNDARY:this._crossingCount%2==1?O.INTERIOR:O.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof E&&I(arguments[1],V)){for(var t=arguments[1],e=new st(arguments[0]),n=new E,o=new E,r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,o),e.countSegment(n,o),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof E&&arguments[1]instanceof Array){for(var i=arguments[1],s=new st(arguments[0]),a=1;a<i.length;a++){var l=i[a],u=i[a-1];if(s.countSegment(l,u),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var at=function(){},lt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return G.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,o=1;o<t.length-1;o++){var r=t[o].x-n,i=t[o+1].y;e+=r*(t[o-1].y-i)}return e/2}if(I(arguments[0],V)){var s=arguments[0],a=s.size();if(a<3)return 0;var l=new E,u=new E,c=new E;s.getCoordinate(0,u),s.getCoordinate(1,c);var p=u.x;c.x-=p;for(var h=0,d=1;d<a-1;d++)l.y=u.y,u.x=c.x,u.y=c.y,s.getCoordinate(d+1,c),c.x-=p,h+=u.x*(l.y-c.y);return h/2}},at.distanceLineLine=function(t,e,n,o){if(t.equals(e))return at.distancePointLine(t,n,o);if(n.equals(o))return at.distancePointLine(o,t,e);var r=!1;if(q.intersects(t,e,n,o)){var i=(e.x-t.x)*(o.y-n.y)-(e.y-t.y)*(o.x-n.x);if(0===i)r=!0;else{var s=(t.y-n.y)*(o.x-n.x)-(t.x-n.x)*(o.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/i,l=s/i;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?A.min(at.distancePointLine(t,n,o),at.distancePointLine(e,n,o),at.distancePointLine(n,t,e),at.distancePointLine(o,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==O.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,o=new E;t.getCoordinate(0,o);for(var r=o.x,i=o.y,s=1;s<e;s++){t.getCoordinate(s,o);var a=o.x,l=o.y,u=a-r,c=l-i;n+=Math.sqrt(u*u+c*c),r=a,i=l}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new v("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],o=0,r=1;r<=e;r++){var i=t[r];i.y>n.y&&(n=i,o=r)}var s=o;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==o);var a=o;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==o);var l=t[s],u=t[a];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=at.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var o=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/o;return Math.abs(r)*Math.sqrt(o)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new v("Line array must contain at least one vertex");for(var n=t.distance(e[0]),o=0;o<e.length-1;o++){var r=at.distancePointLine(t,e[o],e[o+1]);r<n&&(n=r)}return n}if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return i.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((i.x-s.x)*(a.x-s.x)+(i.y-s.y)*(a.y-s.y))/l;if(u<=0)return i.distance(s);if(u>=1)return i.distance(a);var c=((s.y-i.y)*(a.x-s.x)-(s.x-i.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},at.isOnLine=function(t,e){for(var n=new rt,o=1;o<e.length;o++){var r=e[o-1],i=e[o];if(n.computeIntersection(t,r,i),n.hasIntersection())return!0}return!1},lt.CLOCKWISE.get=function(){return-1},lt.RIGHT.get=function(){return at.CLOCKWISE},lt.COUNTERCLOCKWISE.get=function(){return 1},lt.LEFT.get=function(){return at.COUNTERCLOCKWISE},lt.COLLINEAR.get=function(){return 0},lt.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,lt);var ut=function(){};ut.prototype.filter=function(t){},ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},pt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var n=e;return this.equalsExact(n)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],o=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,o)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new v("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new q(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var n=t.iterator(),o=e.iterator();n.hasNext()&&o.hasNext();){var r=n.next(),i=o.next(),s=r.compareTo(i);if(0!==s)return s}return n.hasNext()?1:o.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[b,w,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},pt.serialVersionUID.get=function(){return 0x799ea46522854c00},pt.SORTINDEX_POINT.get=function(){return 0},pt.SORTINDEX_MULTIPOINT.get=function(){return 1},pt.SORTINDEX_LINESTRING.get=function(){return 2},pt.SORTINDEX_LINEARRING.get=function(){return 3},pt.SORTINDEX_MULTILINESTRING.get=function(){return 4},pt.SORTINDEX_POLYGON.get=function(){return 5},pt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},pt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},pt.geometryChangedFilter.get=function(){return ht},Object.defineProperties(ct,pt);var ht=function(){};ht.interfaces_=function(){return[ut]},ht.filter=function(t){t.geometryChangedAction()};var dt=function(){};dt.prototype.filter=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt};var ft=function(){},gt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};ft.prototype.isInBoundary=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft},gt.Mod2BoundaryNodeRule.get=function(){return mt},gt.EndPointBoundaryNodeRule.get=function(){return yt},gt.MultiValentEndPointBoundaryNodeRule.get=function(){return vt},gt.MonoValentEndPointBoundaryNodeRule.get=function(){return _t},gt.MOD2_BOUNDARY_RULE.get=function(){return new mt},gt.ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},gt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},gt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},gt.OGC_SFS_BOUNDARY_RULE.get=function(){return ft.MOD2_BOUNDARY_RULE},Object.defineProperties(ft,gt);var mt=function(){};mt.prototype.isInBoundary=function(t){return t%2==1},mt.prototype.interfaces_=function(){return[ft]},mt.prototype.getClass=function(){return mt};var yt=function(){};yt.prototype.isInBoundary=function(t){return t>0},yt.prototype.interfaces_=function(){return[ft]},yt.prototype.getClass=function(){return yt};var vt=function(){};vt.prototype.isInBoundary=function(t){return t>1},vt.prototype.interfaces_=function(){return[ft]},vt.prototype.getClass=function(){return vt};var _t=function(){};_t.prototype.isInBoundary=function(t){return 1===t},_t.prototype.interfaces_=function(){return[ft]},_t.prototype.getClass=function(){return _t};var Ct=function(){};Ct.prototype.add=function(){},Ct.prototype.addAll=function(){},Ct.prototype.isEmpty=function(){},Ct.prototype.iterator=function(){},Ct.prototype.size=function(){},Ct.prototype.toArray=function(){},Ct.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var wt=function(){};wt.prototype.hasNext=function(){},wt.prototype.next=function(){},wt.prototype.remove=function(){};var bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ct);(o.prototype=new Error).name="NoSuchElementException";var xt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ct&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ct]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Et(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,o=this.array_.length;n<o;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(bt),Et=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new o;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(wt),St=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],o=arguments[1];this.ensureCapacity(n.length),this.add(n,o)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],n=!1,o=arguments[0].iterator();o.hasNext();)this.add(o.next(),e),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],o=arguments[1];return this.add(n,o,!0),!0}if(arguments[0]instanceof E&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var i=arguments[0],s=arguments[1];return this.add(i,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<a.length;u++)this.add(a[u],l);else for(var c=a.length-1;c>=0;c--)this.add(a[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof E){var p=arguments[0],h=arguments[1];if(!arguments[2]){var d=this.size();if(d>0){if(p>0&&this.get(p-1).equals2D(h))return null;if(p<d&&this.get(p).equals2D(h))return null}}t.prototype.add.call(this,p,h)}}else if(4===arguments.length){var f=arguments[0],g=arguments[1],m=arguments[2],y=arguments[3],v=1;m>y&&(v=-1);for(var _=m;_!==y;_+=v)this.add(f[_],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new E(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(xt),Tt=function(){},Rt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Rt.ForwardComparator.get=function(){return Ot},Rt.BidirectionalComparator.get=function(){return Pt},Rt.coordArrayType.get=function(){return new Array(0).fill(null)},Tt.prototype.interfaces_=function(){return[]},Tt.prototype.getClass=function(){return Tt},Tt.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Tt.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(Tt.indexOf(o,e)<0)return o}return null},Tt.scroll=function(t,e){var n=Tt.indexOf(e,t);if(n<0)return null;var o=new Array(t.length).fill(null);U.arraycopy(t,n,o,0,t.length-n),U.arraycopy(t,0,o,t.length-n,n),U.arraycopy(o,0,t,0,t.length)},Tt.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var o=arguments[0],r=arguments[1],i=arguments[2];if(o===r)return!0;if(null===o||null===r)return!1;if(o.length!==r.length)return!1;for(var s=0;s<o.length;s++)if(0!==i.compare(o[s],r[s]))return!1;return!0}},Tt.intersection=function(t,e){for(var n=new St,o=0;o<t.length;o++)e.intersects(t[o])&&n.add(t[o],!0);return n.toCoordinateArray()},Tt.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Tt.removeRepeatedPoints=function(t){return Tt.hasRepeatedPoints(t)?new St(t,!1).toCoordinateArray():t},Tt.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),o=0;o<=n;o++){var r=t[o];t[o]=t[e-o],t[e-o]=r}},Tt.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var o=new Array(e).fill(null);if(0===e)return o;for(var r=0,i=0;i<t.length;i++)null!==t[i]&&(o[r++]=t[i]);return o},Tt.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new E(t[n]);return e}if(5===arguments.length)for(var o=arguments[0],r=arguments[1],i=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)i[s+l]=new E(o[r+l])},Tt.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=e[t.length-n-1];if(0!==o.compareTo(r))return!1}return!0},Tt.envelope=function(t){for(var e=new q,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Tt.toCoordinateArray=function(t){return t.toArray(Tt.coordArrayType)},Tt.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Tt.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Tt.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,o=t[e].compareTo(t[n]);if(0!==o)return o}return 1},Tt.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var o=t[n].compareTo(e[n]);if(0!==o)return o;n++}return n<e.length?-1:n<t.length?1:0},Tt.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Tt.extract=function(t,e,n){e=A.clamp(e,0,t.length);var o=(n=A.clamp(n,-1,t.length))-e+1;n<0&&(o=0),e>=t.length&&(o=0),n<e&&(o=0);var r=new Array(o).fill(null);if(0===o)return r;for(var i=0,s=e;s<=n;s++)r[i++]=t[s];return r},Object.defineProperties(Tt,Rt);var Ot=function(){};Ot.prototype.compare=function(t,e){return Tt.compare(t,e)},Ot.prototype.interfaces_=function(){return[x]},Ot.prototype.getClass=function(){return Ot};var Pt=function(){};Pt.prototype.compare=function(t,e){var n=t,o=e;if(n.length<o.length)return-1;if(n.length>o.length)return 1;if(0===n.length)return 0;var r=Tt.compare(n,o);return Tt.isEqualReversed(n,o)?0:r},Pt.prototype.OLDcompare=function(t,e){var n=t,o=e;if(n.length<o.length)return-1;if(n.length>o.length)return 1;if(0===n.length)return 0;for(var r=Tt.increasingDirection(n),i=Tt.increasingDirection(o),s=r>0?0:n.length-1,a=i>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(o[a]);if(0!==u)return u;s+=r,a+=i}return 0},Pt.prototype.interfaces_=function(){return[x]},Pt.prototype.getClass=function(){return Pt};var It=function(){};It.prototype.get=function(){},It.prototype.put=function(){},It.prototype.size=function(){},It.prototype.values=function(){},It.prototype.entrySet=function(){};var At=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(It);(r.prototype=new Error).name="OperationNotSupported",(i.prototype=new Ct).contains=function(){};var Dt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ct&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Mt(this)},e}(i),Mt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new o;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(wt),Lt=0;(p.prototype=new At).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},p.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Lt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,o,r=this.root_;do{if(n=r,(o=t.compareTo(r.key))<0)r=r.left;else{if(!(o>0)){var i=r.value;return r.value=e,i}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Lt,getValue:function(){return this.value},getKey:function(){return this.key}};return o<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},p.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===u(a(a(t)))){var e=c(a(a(t)));1===s(e)?(l(a(t),Lt),l(e,Lt),l(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateLeft(t)),l(a(t),Lt),l(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=u(a(a(t)));1===s(n)?(l(a(t),Lt),l(n,Lt),l(a(a(t)),1),t=a(a(t))):(t===u(a(t))&&(t=a(t),this.rotateRight(t)),l(a(t),Lt),l(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Lt},p.prototype.values=function(){var t=new xt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=p.successor(e));)t.add(e.value);return t},p.prototype.entrySet=function(){var t=new Dt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=p.successor(e));)t.add(e);return t},p.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},p.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},p.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},p.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,o=t;null!==n&&o===n.right;)o=n,n=n.parent;return n},p.prototype.size=function(){return this.size_};var Nt=function(){};Nt.prototype.interfaces_=function(){return[]},Nt.prototype.getClass=function(){return Nt},h.prototype=new i,(d.prototype=new h).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},d.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},d.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},d.prototype.remove=function(t){throw new r},d.prototype.size=function(){return this.array_.length},d.prototype.isEmpty=function(){return 0===this.array_.length},d.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},d.prototype.iterator=function(){return new Ft(this)};var Ft=function(t){this.treeSet_=t,this.position_=0};Ft.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new o;return this.treeSet_.array_[this.position_++]},Ft.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ft.prototype.remove=function(){throw new r};var kt=function(){};kt.sort=function(){var t,e,n,o,r=arguments[0];if(1===arguments.length)o=function(t,e){return t.compareTo(e)},r.sort(o);else if(2===arguments.length)n=arguments[1],o=function(t,e){return n.compare(t,e)},r.sort(o);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var i=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<i.length;t++)r.push(i[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],o=function(t,e){return n.compare(t,e)},e.sort(o),i=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<i.length;t++)r.push(i[t])},kt.asList=function(t){for(var e=new xt,n=0,o=t.length;n<o;n++)e.add(t[n]);return e};var Gt=function(){},Bt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bt.P.get=function(){return 0},Bt.L.get=function(){return 1},Bt.A.get=function(){return 2},Bt.FALSE.get=function(){return-1},Bt.TRUE.get=function(){return-2},Bt.DONTCARE.get=function(){return-3},Bt.SYM_FALSE.get=function(){return"F"},Bt.SYM_TRUE.get=function(){return"T"},Bt.SYM_DONTCARE.get=function(){return"*"},Bt.SYM_P.get=function(){return"0"},Bt.SYM_L.get=function(){return"1"},Bt.SYM_A.get=function(){return"2"},Gt.prototype.interfaces_=function(){return[]},Gt.prototype.getClass=function(){return Gt},Gt.toDimensionSymbol=function(t){switch(t){case Gt.FALSE:return Gt.SYM_FALSE;case Gt.TRUE:return Gt.SYM_TRUE;case Gt.DONTCARE:return Gt.SYM_DONTCARE;case Gt.P:return Gt.SYM_P;case Gt.L:return Gt.SYM_L;case Gt.A:return Gt.SYM_A}throw new v("Unknown dimension value: "+t)},Gt.toDimensionValue=function(t){switch(N.toUpperCase(t)){case Gt.SYM_FALSE:return Gt.FALSE;case Gt.SYM_TRUE:return Gt.TRUE;case Gt.SYM_DONTCARE:return Gt.DONTCARE;case Gt.SYM_P:return Gt.P;case Gt.SYM_L:return Gt.L;case Gt.SYM_A:return Gt.A}throw new v("Unknown dimension symbol: "+t)},Object.defineProperties(Gt,Bt);var Vt=function(){};Vt.prototype.filter=function(t){},Vt.prototype.interfaces_=function(){return[]},Vt.prototype.getClass=function(){return Vt};var zt=function(){};zt.prototype.filter=function(t,e){},zt.prototype.isDone=function(){},zt.prototype.isGeometryChanged=function(){},zt.prototype.interfaces_=function(){return[]},zt.prototype.getClass=function(){return zt};var jt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new v("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new q,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var o=this._geometries[n].getCoordinates(),r=0;r<o.length;r++)t[++e]=o[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var o=e;if(this._geometries.length!==o._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(o._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();kt.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Gt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Gt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new d(kt.asList(this._geometries)),n=new d(kt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var o=arguments[1],r=arguments[0],i=this.getNumGeometries(),s=r.getNumGeometries(),a=0;a<i&&a<s;){var l=this.getGeometryN(a),u=r.getGeometryN(a),c=l.compareToSameClass(u,o);if(0!==c)return c;a++}return a<i?1:a<s?-1:0}},e.prototype.apply=function(){if(I(arguments[0],dt))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(I(arguments[0],zt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var o=0;o<this._geometries.length&&(this._geometries[o].apply(n),!n.isDone());o++);n.isGeometryChanged()&&this.geometryChanged()}else if(I(arguments[0],Vt)){var r=arguments[0];r.filter(this);for(var i=0;i<this._geometries.length;i++)this._geometries[i].apply(r)}else if(I(arguments[0],ut)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ct),Ht=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Gt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Ut(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Nt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(jt),Ut=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=ft.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],o=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=o}};Ut.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Ut.prototype.getBoundary=function(){return this._geom instanceof Kt?this.boundaryLineString(this._geom):this._geom instanceof Ht?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Ut.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Ut.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Ut.prototype.computeBoundaryCoordinates=function(t){var e=new xt;this._endpointMap=new p;for(var n=0;n<t.getNumGeometries();n++){var o=t.getGeometryN(n);0!==o.getNumPoints()&&(this.addEndpoint(o.getCoordinateN(0)),this.addEndpoint(o.getCoordinateN(o.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var i=r.next(),s=i.getValue().count;this._bnRule.isInBoundary(s)&&e.add(i.getKey())}return Tt.toCoordinateArray(e)},Ut.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Wt,this._endpointMap.put(t,e)),e.count++},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut},Ut.getBoundary=function(){return 1===arguments.length?new Ut(arguments[0]).getBoundary():2===arguments.length?new Ut(arguments[0],arguments[1]).getBoundary():void 0};var Wt=function(){this.count=null};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt};var qt=function(){},Xt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.chars=function(t,e){for(var n=new Array(e).fill(null),o=0;o<e;o++)n[o]=t;return String(n)},qt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var o=arguments[0],r=arguments[1],i="",s=new function(){}(new function(){}(qt.getStackTrace(o))),a=0;a<r;a++)try{i+=s.readLine()+qt.NEWLINE}catch(t){if(!(t instanceof f))throw t;et.shouldNeverReachHere()}return i}},qt.split=function(t,e){for(var n=e.length,o=new xt,r=""+t,i=r.indexOf(e);i>=0;){var s=r.substring(0,i);o.add(s),i=(r=r.substring(i+n)).indexOf(e)}r.length>0&&o.add(r);for(var a=new Array(o.size()).fill(null),l=0;l<a.length;l++)a[l]=o.get(l);return a},qt.toString=function(){if(1===arguments.length){var t=arguments[0];return qt.SIMPLE_ORDINATE_FORMAT.format(t)}},qt.spaces=function(t){return qt.chars(" ",t)},Xt.NEWLINE.get=function(){return U.getProperty("line.separator")},Xt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(qt,Xt);var Yt=function(){};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt},Yt.copyCoord=function(t,e,n,o){for(var r=Math.min(t.getDimension(),n.getDimension()),i=0;i<r;i++)n.setOrdinate(o,i,t.getOrdinate(e,i))},Yt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,V.X)===t.getOrdinate(e-1,V.X)&&t.getOrdinate(0,V.Y)===t.getOrdinate(e-1,V.Y)},Yt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var o=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var i=0;i<o;i++){var s=t.getOrdinate(r,i),a=e.getOrdinate(r,i);if(t.getOrdinate(r,i)!==e.getOrdinate(r,i)&&(!_.isNaN(s)||!_.isNaN(a)))return!1}return!0},Yt.extend=function(t,e,n){var o=t.create(n,e.getDimension()),r=e.size();if(Yt.copy(e,0,o,0,r),r>0)for(var i=r;i<n;i++)Yt.copy(e,r-1,o,i,1);return o},Yt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),o=0;o<=n;o++)Yt.swap(t,o,e-o)},Yt.swap=function(t,e,n){if(e===n)return null;for(var o=0;o<t.getDimension();o++){var r=t.getOrdinate(e,o);t.setOrdinate(e,o,t.getOrdinate(n,o)),t.setOrdinate(n,o,r)}},Yt.copy=function(t,e,n,o,r){for(var i=0;i<r;i++)Yt.copyCoord(t,e+i,n,o+i)},Yt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),o=new M;o.append("(");for(var r=0;r<e;r++){r>0&&o.append(" ");for(var i=0;i<n;i++)i>0&&o.append(","),o.append(qt.toString(t.getOrdinate(r,i)))}return o.append(")"),o.toString()}},Yt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Yt.createClosedRing(t,e,4):e.getOrdinate(0,V.X)===e.getOrdinate(n-1,V.X)&&e.getOrdinate(0,V.Y)===e.getOrdinate(n-1,V.Y)?e:Yt.createClosedRing(t,e,n+1)},Yt.createClosedRing=function(t,e,n){var o=t.create(n,e.getDimension()),r=e.size();Yt.copy(e,0,o,0,r);for(var i=r;i<n;i++)Yt.copy(e,0,o,i,1);return o};var Kt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new q:this._points.expandEnvelope(new q)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var o=e;if(this._points.size()!==o._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),o._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Yt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Gt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Yt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var o=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==o)return o;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(I(arguments[0],dt))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(I(arguments[0],zt)){var n=arguments[0];if(0===this._points.size())return null;for(var o=0;o<this._points.size()&&(n.filter(this._points,o),!n.isDone());o++);n.isGeometryChanged()&&this.geometryChanged()}else(I(arguments[0],Vt)||I(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Ut(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new v("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Nt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ct),Zt=function(){};Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt};var Jt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new q;var t=new q;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Gt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(I(arguments[0],dt)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(I(arguments[0],zt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(I(arguments[0],Vt)||I(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ct),Qt=function(){};Qt.prototype.interfaces_=function(){return[]},Qt.prototype.getClass=function(){return Qt};var $t=function(t){function e(e,n,o){if(t.call(this,o),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new v("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new v("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),o=0;o<n.length;o++)t[++e]=n[o];for(var r=0;r<this._holes.length;r++)for(var i=this._holes[r].getCoordinates(),s=0;s<i.length;s++)t[++e]=i[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var o=t.getX(n);if(o!==e.getMinX()&&o!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var i=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==i===(u!==s))return!1;i=l,s=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var o=e,r=this._shell,i=o._shell;if(!r.equalsExact(i,n))return!1;if(this._holes.length!==o._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(o._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);kt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var o=new Array(e.getCoordinates().length-1).fill(null);U.arraycopy(e.getCoordinates(),0,o,0,o.length);var r=Tt.minCoordinate(e.getCoordinates());Tt.scroll(o,r),U.arraycopy(o,0,e.getCoordinates(),0,o.length),e.getCoordinates()[o.length]=o[0],at.isCCW(e.getCoordinates())===n&&Tt.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var o=arguments[1],r=arguments[0],i=this._shell,s=r._shell,a=i.compareToSameClass(s,o);if(0!==a)return a;for(var l=this.getNumInteriorRing(),u=r.getNumInteriorRing(),c=0;c<l&&c<u;){var p=this.getInteriorRingN(c),h=r.getInteriorRingN(c),d=p.compareToSameClass(h,o);if(0!==d)return d;c++}return c<l?1:c<u?-1:0}},e.prototype.apply=function(t){if(I(t,dt)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(I(t,zt)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(I(t,Vt))t.filter(this);else if(I(t,ut)){t.filter(this),this._shell.apply(t);for(var o=0;o<this._holes.length;o++)this._holes[o].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),o=0;o<n.length;o++)n[o]=this._holes[o].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Gt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(jt),ee=function(t){function e(e,n){e instanceof E&&n instanceof ye&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Gt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Yt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new v("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new v("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Kt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new xt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),o=0;o<n.getNumGeometries();o++)t.add(n.getGeometryN(o));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(jt),oe=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};oe.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},oe.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},oe.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof jt?this.editGeometryCollection(t,e):t instanceof $t?this.editPolygon(t,e):t instanceof Jt||t instanceof Kt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},oe.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),o=new xt,r=0;r<n.getNumGeometries();r++){var i=this.edit(n.getGeometryN(r),e);null===i||i.isEmpty()||o.add(i)}return n.getClass()===te?this._factory.createMultiPoint(o.toArray([])):n.getClass()===Ht?this._factory.createMultiLineString(o.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(o.toArray([])):this._factory.createGeometryCollection(o.toArray([]))},oe.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var o=this.edit(n.getExteriorRing(),e);if(null===o||o.isEmpty())return this._factory.createPolygon();for(var r=new xt,i=0;i<n.getNumInteriorRing();i++){var s=this.edit(n.getInteriorRingN(i),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(o,r.toArray([]))},oe.prototype.interfaces_=function(){return[]},oe.prototype.getClass=function(){return oe},oe.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return ie},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(oe,re);var ie=function(){};ie.prototype.edit=function(t,e){return t},ie.prototype.interfaces_=function(){return[oe.GeometryEditorOperation]},ie.prototype.getClass=function(){return ie};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Kt?e.createLineString(n):t instanceof Jt?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[oe.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Kt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Jt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[oe.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var le=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new E}else if(I(arguments[0],V)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var o=0;o<this._coordinates.length;o++)this._coordinates[o]=n.getCoordinateCopy(o)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1];this._coordinates=r,this._dimension=i,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var l=0;l<s;l++)this._coordinates[l]=new E}},ue={serialVersionUID:{configurable:!0}};le.prototype.setOrdinate=function(t,e,n){switch(e){case V.X:this._coordinates[t].x=n;break;case V.Y:this._coordinates[t].y=n;break;case V.Z:this._coordinates[t].z=n;break;default:throw new v("invalid ordinateIndex")}},le.prototype.size=function(){return this._coordinates.length},le.prototype.getOrdinate=function(t,e){switch(e){case V.X:return this._coordinates[t].x;case V.Y:return this._coordinates[t].y;case V.Z:return this._coordinates[t].z}return _.NaN},le.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},le.prototype.getCoordinateCopy=function(t){return new E(this._coordinates[t])},le.prototype.getDimension=function(){return this._dimension},le.prototype.getX=function(t){return this._coordinates[t].x},le.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new le(t,this._dimension)},le.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},le.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new le(t,this._dimension)},le.prototype.toString=function(){if(this._coordinates.length>0){var t=new M(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},le.prototype.getY=function(t){return this._coordinates[t].y},le.prototype.toCoordinateArray=function(){return this._coordinates},le.prototype.interfaces_=function(){return[V,e]},le.prototype.getClass=function(){return le},ue.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(le,ue);var ce=function(){},pe={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new le(arguments[0]);if(I(arguments[0],V))return new le(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new le(t):new le(t,e)}},ce.prototype.interfaces_=function(){return[R,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},pe.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},pe.instanceObject.get=function(){return new ce},Object.defineProperties(ce,pe);var he=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new xt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Dt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(It),de=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ge){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var o=arguments[0];this._modelType=o._modelType,this._scale=o._scale}},fe={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};de.prototype.equals=function(t){if(!(t instanceof de))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},de.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),o=e.getMaximumSignificantDigits();return new L(n).compareTo(new L(o))},de.prototype.getScale=function(){return this._scale},de.prototype.isFloating=function(){return this._modelType===de.FLOATING||this._modelType===de.FLOATING_SINGLE},de.prototype.getType=function(){return this._modelType},de.prototype.toString=function(){var t="UNKNOWN";return this._modelType===de.FLOATING?t="Floating":this._modelType===de.FLOATING_SINGLE?t="Floating-Single":this._modelType===de.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},de.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return _.isNaN(t)||this._modelType===de.FLOATING_SINGLE?t:this._modelType===de.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof E){var e=arguments[0];if(this._modelType===de.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},de.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===de.FLOATING?t=16:this._modelType===de.FLOATING_SINGLE?t=6:this._modelType===de.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},de.prototype.setScale=function(t){this._scale=Math.abs(t)},de.prototype.interfaces_=function(){return[e,w]},de.prototype.getClass=function(){return de},de.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},fe.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},fe.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(de,fe);var ge=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},me={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ge.prototype.readResolve=function(){return ge.nameToTypeMap.get(this._name)},ge.prototype.toString=function(){return this._name},ge.prototype.interfaces_=function(){return[e]},ge.prototype.getClass=function(){return ge},me.serialVersionUID.get=function(){return-552860263173159e4},me.nameToTypeMap.get=function(){return new he},Object.defineProperties(ge,me),de.Type=ge,de.FIXED=new ge("FIXED"),de.FLOATING=new ge("FLOATING"),de.FLOATING_SINGLE=new ge("FLOATING SINGLE");var ye=function t(){this._precisionModel=new de,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?I(arguments[0],R)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof de&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},ve={serialVersionUID:{configurable:!0}};ye.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new E(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new E(t.getMinX(),t.getMinY()),new E(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new E(t.getMinX(),t.getMinY()),new E(t.getMinX(),t.getMaxY()),new E(t.getMaxX(),t.getMaxY()),new E(t.getMaxX(),t.getMinY()),new E(t.getMinX(),t.getMinY())]),null)},ye.prototype.createLineString=function(t){return t?t instanceof Array?new Kt(this.getCoordinateSequenceFactory().create(t),this):I(t,V)?new Kt(t,this):void 0:new Kt(this.getCoordinateSequenceFactory().create([]),this)},ye.prototype.createMultiLineString=function(){return 0===arguments.length?new Ht(null,this):1===arguments.length?new Ht(arguments[0],this):void 0},ye.prototype.buildGeometry=function(t){for(var e=null,n=!1,o=!1,r=t.iterator();r.hasNext();){var i=r.next(),s=i.getClass();null===e&&(e=s),s!==e&&(n=!0),i.isGeometryCollectionOrDerived()&&(o=!0)}if(null===e)return this.createGeometryCollection();if(n||o)return this.createGeometryCollection(ye.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof $t)return this.createMultiPolygon(ye.toPolygonArray(t));if(a instanceof Kt)return this.createMultiLineString(ye.toLineStringArray(t));if(a instanceof Jt)return this.createMultiPoint(ye.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},ye.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},ye.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(I(arguments[0],V))return new Jt(arguments[0],this)}},ye.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},ye.prototype.createPolygon=function(){if(0===arguments.length)return new $t(null,null,this);if(1===arguments.length){if(I(arguments[0],V)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new $t(arguments[0],arguments[1],this)},ye.prototype.getSRID=function(){return this._SRID},ye.prototype.createGeometryCollection=function(){return 0===arguments.length?new jt(null,this):1===arguments.length?new jt(arguments[0],this):void 0},ye.prototype.createGeometry=function(t){return new oe(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},ye.prototype.getPrecisionModel=function(){return this._precisionModel},ye.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(I(arguments[0],V))return new ee(arguments[0],this)}},ye.prototype.createMultiPolygon=function(){return 0===arguments.length?new ne(null,this):1===arguments.length?new ne(arguments[0],this):void 0},ye.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(I(arguments[0],V)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),o=0;o<e.size();o++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());Yt.copy(e,o,r,0,1),n[o]=this.createPoint(r)}return this.createMultiPoint(n)}}},ye.prototype.interfaces_=function(){return[e]},ye.prototype.getClass=function(){return ye},ye.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},ye.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},ve.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(ye,ve);var _e=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ce=function(t){this.geometryFactory=t||new ye};Ce.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!we[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==_e.indexOf(n)?we[n].apply(this,[e.coordinates]):"GeometryCollection"===n?we[n].apply(this,[e.geometries]):we[n].apply(this,[e])},Ce.prototype.write=function(t){var e=t.getGeometryType();if(!be[e])throw new Error("Geometry is not supported");return be[e].apply(this,[t])};var we={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var o=t.geometry.type;if(!we[o])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=we.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var o=t[n];e.push(new E(o[0],o[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new E(t[0],t[1]),new E(t[2],t[1]),new E(t[2],t[3]),new E(t[0],t[3]),new E(t[0],t[1])])},Point:function(t){var e=new E(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(we.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=we.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(we.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=we.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),o=[],r=1;r<t.length;++r){var i=t[r],s=we.coordinates.apply(this,[i]),a=this.geometryFactory.createLinearRing(s);o.push(a)}return this.geometryFactory.createPolygon(n,o)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var o=t[n];e.push(we.Polygon.apply(this,[o]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var o=t[n];e.push(this.read(o))}return this.geometryFactory.createGeometryCollection(e)}},be={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:be.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var o=t._geometries[n],r=be.Point.apply(this,[o]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),o=0;o<n.length;++o){var r=n[o];e.push(be.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var o=t._geometries[n],r=be.LineString.apply(this,[o]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=be.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var o=0;o<t._holes.length;++o){var r=t._holes[o],i=be.LineString.apply(this,[r]);e.push(i.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var o=t._geometries[n],r=be.Polygon.apply(this,[o]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var o=t._geometries[n],r=o.getGeometryType();e.push(be[r].apply(this,[o]))}return{type:"GeometryCollection",geometries:e}}},xe=function(t){this.geometryFactory=t||new ye,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ce(this.geometryFactory)};xe.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===de.FIXED&&this.reducePrecision(e),e},xe.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ee=function(){this.parser=new Ce(this.geometryFactory)};Ee.prototype.write=function(t){return this.parser.write(t)};var Se=function(){},Te={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Se.prototype.interfaces_=function(){return[]},Se.prototype.getClass=function(){return Se},Se.opposite=function(t){return t===Se.LEFT?Se.RIGHT:t===Se.RIGHT?Se.LEFT:t},Te.ON.get=function(){return 0},Te.LEFT.get=function(){return 1},Te.RIGHT.get=function(){return 2},Object.defineProperties(Se,Te),(g.prototype=new Error).name="EmptyStackException",(m.prototype=new bt).add=function(t){return this.array_.push(t),!0},m.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},m.prototype.push=function(t){return this.array_.push(t),t},m.prototype.pop=function(t){if(0===this.array_.length)throw new g;return this.array_.pop()},m.prototype.peek=function(){if(0===this.array_.length)throw new g;return this.array_[this.array_.length-1]},m.prototype.empty=function(){return 0===this.array_.length},m.prototype.isEmpty=function(){return this.empty()},m.prototype.search=function(t){return this.array_.indexOf(t)},m.prototype.size=function(){return this.array_.length},m.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Re=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Re.prototype.getCoordinate=function(){return this._minCoord},Re.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Re.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],o=at.computeOrientation(this._minCoord,n,e),r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&o===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&o===at.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Re.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var o=Se.LEFT;return n[e].y<n[e+1].y&&(o=Se.RIGHT),o},Re.prototype.getEdge=function(){return this._orientedDe},Re.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Re.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Re.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Se.LEFT&&(this._orientedDe=this._minDe.getSym())},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re};var Oe=function(t){function e(n,o){t.call(this,e.msgWithCoord(n,o)),this.pt=o?new E(o):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}($),Pe=function(){this.array_=[]};Pe.prototype.addLast=function(t){this.array_.push(t)},Pe.prototype.removeFirst=function(){return this.array_.shift()},Pe.prototype.isEmpty=function(){return 0===this.array_.length};var Ie=function(){this._finder=null,this._dirEdgeList=new xt,this._nodes=new xt,this._rightMostCoord=null,this._env=null,this._finder=new Re};Ie.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Ie.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ie.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var o=n.next();if(o.isVisited()||o.getSym().isVisited()){e=o;break}}if(null===e)throw new Oe("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var i=r.next();i.setVisited(!0),this.copySymDepths(i)}},Ie.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Se.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Ie.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ie.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Se.RIGHT)>=1&&e.getDepth(Se.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Ie.prototype.computeDepths=function(t){var e=new Dt,n=new Pe,o=t.getNode();for(n.addLast(o),e.add(o),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var i=r.getEdges().iterator();i.hasNext();){var s=i.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Ie.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ie.prototype.getEnvelope=function(){if(null===this._env){for(var t=new q,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),o=0;o<n.length-1;o++)t.expandToInclude(n[o]);this._env=t}return this._env},Ie.prototype.addReachable=function(t){var e=new m;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Ie.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Se.LEFT,t.getDepth(Se.RIGHT)),e.setDepth(Se.RIGHT,t.getDepth(Se.LEFT))},Ie.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var o=n.next();this._dirEdgeList.add(o);var r=o.getSym().getNode();r.isVisited()||e.push(r)}},Ie.prototype.getNodes=function(){return this._nodes},Ie.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ie.prototype.interfaces_=function(){return[w]},Ie.prototype.getClass=function(){return Ie};var Ae=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Se.ON]=n}else if(arguments[0]instanceof t){var o=arguments[0];if(this.init(o.location.length),null!==o)for(var r=0;r<this.location.length;r++)this.location[r]=o.location[r]}}else if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Se.ON]=i,this.location[Se.LEFT]=s,this.location[Se.RIGHT]=a}};Ae.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Ae.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==O.NONE)return!1;return!0},Ae.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===O.NONE&&(this.location[e]=t)},Ae.prototype.isLine=function(){return 1===this.location.length},Ae.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Se.ON]=this.location[Se.ON],e[Se.LEFT]=O.NONE,e[Se.RIGHT]=O.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===O.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Ae.prototype.getLocations=function(){return this.location},Ae.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Se.LEFT];this.location[Se.LEFT]=this.location[Se.RIGHT],this.location[Se.RIGHT]=t},Ae.prototype.toString=function(){var t=new M;return this.location.length>1&&t.append(O.toLocationSymbol(this.location[Se.LEFT])),t.append(O.toLocationSymbol(this.location[Se.ON])),this.location.length>1&&t.append(O.toLocationSymbol(this.location[Se.RIGHT])),t.toString()},Ae.prototype.setLocations=function(t,e,n){this.location[Se.ON]=t,this.location[Se.LEFT]=e,this.location[Se.RIGHT]=n},Ae.prototype.get=function(t){return t<this.location.length?this.location[t]:O.NONE},Ae.prototype.isArea=function(){return this.location.length>1},Ae.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===O.NONE)return!0;return!1},Ae.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Se.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Ae.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(O.NONE)},Ae.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Ae.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae};var De=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Ae(e),this.elt[1]=new Ae(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Ae(n.elt[0]),this.elt[1]=new Ae(n.elt[1])}}else if(2===arguments.length){var o=arguments[0],r=arguments[1];this.elt[0]=new Ae(O.NONE),this.elt[1]=new Ae(O.NONE),this.elt[o].setLocation(r)}else if(3===arguments.length){var i=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Ae(i,s,a),this.elt[1]=new Ae(i,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],p=arguments[3];this.elt[0]=new Ae(O.NONE,O.NONE,O.NONE),this.elt[1]=new Ae(O.NONE,O.NONE,O.NONE),this.elt[l].setLocations(u,c,p)}};De.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},De.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},De.prototype.isNull=function(t){return this.elt[t].isNull()},De.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},De.prototype.isLine=function(t){return this.elt[t].isLine()},De.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Ae(t.elt[e]):this.elt[e].merge(t.elt[e])},De.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},De.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Se.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},De.prototype.toString=function(){var t=new M;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},De.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},De.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},De.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Se.ON,e)}else if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2];this.elt[n].setLocation(o,r)}},De.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},De.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},De.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Ae(this.elt[t].location[0]))},De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De},De.toLineLabel=function(t){for(var e=new De(O.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Me=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new xt,this._pts=new xt,this._label=new De(O.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new xt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Me.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Me.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Me.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Oe("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Oe("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var o=e.getLabel();et.isTrue(o.isArea()),this.mergeLabel(o),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Me.prototype.getLinearRing=function(){return this._ring},Me.prototype.getCoordinate=function(t){return this._pts.get(t)},Me.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Me.prototype.addPoints=function(t,e,n){var o=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var i=r;i<o.length;i++)this._pts.add(o[i])}else{var s=o.length-2;n&&(s=o.length-1);for(var a=s;a>=0;a--)this._pts.add(o[a])}},Me.prototype.isHole=function(){return this._isHole},Me.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Me.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Me.prototype.addHole=function(t){this._holes.add(t)},Me.prototype.isShell=function(){return null===this._shell},Me.prototype.getLabel=function(){return this._label},Me.prototype.getEdges=function(){return this._edges},Me.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Me.prototype.getShell=function(){return this._shell},Me.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Se.RIGHT);if(n===O.NONE)return null;if(this._label.getLocation(e)===O.NONE)return this._label.setLocation(e,n),null}},Me.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Me.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me};var Le=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Me),Ne=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new xt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Le(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Me),Fe=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Fe.prototype.setVisited=function(t){this._isVisited=t},Fe.prototype.setInResult=function(t){this._isInResult=t},Fe.prototype.isCovered=function(){return this._isCovered},Fe.prototype.isCoveredSet=function(){return this._isCoveredSet},Fe.prototype.setLabel=function(t){this._label=t},Fe.prototype.getLabel=function(){return this._label},Fe.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Fe.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Fe.prototype.isInResult=function(){return this._isInResult},Fe.prototype.isVisited=function(){return this._isVisited},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var ke=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new De(0,O.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=O.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var o=t.getLocation(e);n!==O.BOUNDARY&&(n=o)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new De(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof De)for(var n=arguments[0],o=0;o<2;o++){var r=this.computeMergedLocation(n,o);this._label.getLocation(o)===O.NONE&&this._label.setLocation(o,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=O.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case O.BOUNDARY:n=O.INTERIOR;break;case O.INTERIOR:default:n=O.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fe),Ge=function(){this.nodeMap=new p,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Ge.prototype.find=function(t){return this.nodeMap.get(t)},Ge.prototype.addNode=function(){if(arguments[0]instanceof E){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof ke){var n=arguments[0],o=this.nodeMap.get(n.getCoordinate());return null===o?(this.nodeMap.put(n.getCoordinate(),n),n):(o.mergeLabel(n),o)}},Ge.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Ge.prototype.iterator=function(){return this.nodeMap.values().iterator()},Ge.prototype.values=function(){return this.nodeMap.values()},Ge.prototype.getBoundaryNodes=function(t){for(var e=new xt,n=this.iterator();n.hasNext();){var o=n.next();o.getLabel().getLocation(t)===O.BOUNDARY&&e.add(o)}return e},Ge.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge};var Be=function(){},Ve={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be},Be.isNorthern=function(t){return t===Be.NE||t===Be.NW},Be.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},Be.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},Be.isInHalfPlane=function(t,e){return e===Be.SE?t===Be.SE||t===Be.SW:t===e||t===e+1},Be.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new v("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Be.NE:Be.SE:e>=0?Be.NW:Be.SW}if(arguments[0]instanceof E&&arguments[1]instanceof E){var n=arguments[0],o=arguments[1];if(o.x===n.x&&o.y===n.y)throw new v("Cannot compute the quadrant for two identical points "+n);return o.x>=n.x?o.y>=n.y?Be.NE:Be.SE:o.y>=n.y?Be.NW:Be.SW}},Ve.NE.get=function(){return 0},Ve.NW.get=function(){return 1},Ve.SW.get=function(){return 2},Ve.SE.get=function(){return 3},Object.defineProperties(Be,Ve);var ze=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],o=arguments[2];this._edge=e,this.init(n,o),this._label=null}else if(4===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(i,s),this._label=a}};ze.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},ze.prototype.getDy=function(){return this._dy},ze.prototype.getCoordinate=function(){return this._p0},ze.prototype.setNode=function(t){this._node=t},ze.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),o=n.lastIndexOf("."),r=n.substring(o+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},ze.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},ze.prototype.getDirectedCoordinate=function(){return this._p1},ze.prototype.getDx=function(){return this._dx},ze.prototype.getLabel=function(){return this._label},ze.prototype.getEdge=function(){return this._edge},ze.prototype.getQuadrant=function(){return this._quadrant},ze.prototype.getNode=function(){return this._node},ze.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},ze.prototype.computeLabel=function(t){},ze.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Be.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},ze.prototype.interfaces_=function(){return[w]},ze.prototype.getClass=function(){return ze};var je=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var o=e.getNumPoints()-1;this.init(e.getCoordinate(o),e.getCoordinate(o-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new De(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Oe("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Se.LEFT)===O.INTERIOR&&this._label.getLocation(e,Se.RIGHT)===O.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Se.LEFT]+"/"+this._depth[Se.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,O.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,O.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var o=1;t===Se.LEFT&&(o=-1);var r=Se.opposite(t),i=e+n*o;this.setDepth(t,e),this.setDepth(r,i)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===O.EXTERIOR&&e===O.INTERIOR?1:t===O.INTERIOR&&e===O.EXTERIOR?-1:0},e}(ze),He=function(){};He.prototype.createNode=function(t){return new ke(t,null)},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var Ue=function(){if(this._edges=new xt,this._nodes=null,this._edgeEndList=new xt,0===arguments.length)this._nodes=new Ge(new He);else if(1===arguments.length){var t=arguments[0];this._nodes=new Ge(t)}};Ue.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ue.prototype.find=function(t){return this._nodes.find(t)},Ue.prototype.addNode=function(){if(arguments[0]instanceof ke){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof E){var e=arguments[0];return this._nodes.addNode(e)}},Ue.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ue.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ue.prototype.debugPrintln=function(t){U.out.println(t)},Ue.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var o=n.getLabel();return null!==o&&o.getLocation(t)===O.BOUNDARY},Ue.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ue.prototype.matchInSameDirection=function(t,e,n,o){return!!t.equals(n)&&at.computeOrientation(t,e,o)===at.COLLINEAR&&Be.quadrant(t,e)===Be.quadrant(n,o)},Ue.prototype.getEdgeEnds=function(){return this._edgeEndList},Ue.prototype.debugPrint=function(t){U.out.print(t)},Ue.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ue.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var o=this._edges.get(n),r=o.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return o;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return o}return null},Ue.prototype.insertEdge=function(t){this._edges.add(t)},Ue.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ue.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var o=new je(n,!0),r=new je(n,!1);o.setSym(r),r.setSym(o),this.add(o),this.add(r)}},Ue.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ue.prototype.getNodes=function(){return this._nodes.values()},Ue.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var o=this._edges.get(n),r=o.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return o}return null},Ue.prototype.interfaces_=function(){return[]},Ue.prototype.getClass=function(){return Ue},Ue.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var We=function(){this._geometryFactory=null,this._shellList=new xt;var t=arguments[0];this._geometryFactory=t};We.prototype.sortShellsAndHoles=function(t,e,n){for(var o=t.iterator();o.hasNext();){var r=o.next();r.isHole()?n.add(r):e.add(r)}},We.prototype.computePolygons=function(t){for(var e=new xt,n=t.iterator();n.hasNext();){var o=n.next().toPolygon(this._geometryFactory);e.add(o)}return e},We.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var o=n.next();if(null===o.getShell()){var r=this.findEdgeRingContaining(o,t);if(null===r)throw new Oe("unable to assign hole to a shell",o.getCoordinate(0));o.setShell(r)}}},We.prototype.buildMinimalEdgeRings=function(t,e,n){for(var o=new xt,r=t.iterator();r.hasNext();){var i=r.next();if(i.getMaxNodeDegree()>2){i.linkDirectedEdgesForMinimalEdgeRings();var s=i.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else o.add(i)}return o},We.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},We.prototype.buildMaximalEdgeRings=function(t){for(var e=new xt,n=t.iterator();n.hasNext();){var o=n.next();if(o.isInResult()&&o.getLabel().isArea()&&null===o.getEdgeRing()){var r=new Ne(o,this._geometryFactory);e.add(r),r.setInResult()}}return e},We.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var o=n.next();o.isHole()&&o.setShell(t)}},We.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},We.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),o=n.getEnvelopeInternal(),r=n.getCoordinateN(0),i=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==i&&(s=i.getLinearRing().getEnvelopeInternal());var p=!1;c.contains(o)&&at.isPointInRing(r,u.getCoordinates())&&(p=!0),p&&(null===i||s.contains(c))&&(i=l)}return i},We.prototype.findShell=function(t){for(var e=0,n=null,o=t.iterator();o.hasNext();){var r=o.next();r.isHole()||(n=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},We.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Ue.linkResultDirectedEdges(n);var o=this.buildMaximalEdgeRings(e),r=new xt,i=this.buildMinimalEdgeRings(o,this._shellList,r);this.sortShellsAndHoles(i,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var qe=function(){};qe.prototype.getBounds=function(){},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var Xe=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Xe.prototype.getItem=function(){return this._item},Xe.prototype.getBounds=function(){return this._bounds},Xe.prototype.interfaces_=function(){return[qe,e]},Xe.prototype.getClass=function(){return Xe};var Ye=function(){this._size=null,this._items=null,this._size=0,this._items=new xt,this._items.add(null)};Ye.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Ye.prototype.size=function(){return this._size},Ye.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Ye.prototype.clear=function(){this._size=0,this._items.clear()},Ye.prototype.isEmpty=function(){return 0===this._size},Ye.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var Ke=function(){};Ke.prototype.visitItem=function(t){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Ze=function(){};Ze.prototype.insert=function(t,e){},Ze.prototype.remove=function(t,e){},Ze.prototype.query=function(){},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};var Je=function(){if(this._childBoundables=new xt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Qe={serialVersionUID:{configurable:!0}};Je.prototype.getLevel=function(){return this._level},Je.prototype.size=function(){return this._childBoundables.size()},Je.prototype.getChildBoundables=function(){return this._childBoundables},Je.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Je.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Je.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Je.prototype.interfaces_=function(){return[qe,e]},Je.prototype.getClass=function(){return Je},Qe.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Je,Qe);var $e=function(){};$e.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},$e.min=function(t){return $e.sort(t),t.get(0)},$e.sort=function(t,e){var n=t.toArray();e?kt.sort(n,e):kt.sort(n);for(var o=t.iterator(),r=0,i=n.length;r<i;r++)o.next(),o.set(n[r])},$e.singletonList=function(t){var e=new xt;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),o=tn.isComposite(this._boundable2);if(n&&o)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(o)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new v("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,o){for(var r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next(),s=new tn(i,e,this._itemDistance);s.getDistance()<o&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[w]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Je};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new xt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Je?t+=this.size(n):n instanceof Xe&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,o=t.getChildBoundables().iterator();o.hasNext();){var r=o.next();r instanceof Xe&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new xt:t}if(1===arguments.length){for(var e=arguments[0],n=new xt,o=e.getChildBoundables().iterator();o.hasNext();){var r=o.next();if(r instanceof Je){var i=this.itemsTree(r);null!==i&&n.add(i)}else r instanceof Xe?n.add(r.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Xe(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new xt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2];if(et.isTrue(n>-2),o.getLevel()===n)return r.add(o),null;for(var i=o.getChildBoundables().iterator();i.hasNext();){var s=i.next();s instanceof Je?this.boundablesAtLevel(n,s,r):(et.isTrue(s instanceof Xe),-1===n&&r.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new xt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],o=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,o)}else if(3===arguments.length)if(I(arguments[2],Ke)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var r=arguments[0],i=arguments[2],s=arguments[1].getChildBoundables(),a=0;a<s.size();a++){var l=s.get(a);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Je?this.query(r,l,i):l instanceof Xe?i.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(I(arguments[2],bt)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var u=arguments[0],c=arguments[2],p=arguments[1].getChildBoundables(),h=0;h<p.size();h++){var d=p.get(h);this.getIntersectsOp().intersects(d.getBounds(),u)&&(d instanceof Je?this.query(u,d,c):d instanceof Xe?c.add(d.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2],i=this.removeItem(o,r);if(i)return!0;for(var s=null,a=o.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Je&&(i=this.remove(n,l,r))){s=l;break}}return null!==s&&s.getChildBoundables().isEmpty()&&o.getChildBoundables().remove(s),i}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Je){var o=this.depth(n);o>t&&(t=o)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new xt;n.add(this.createNode(e));var o=new xt(t);$e.sort(o,this.getComparator());for(var r=o.iterator();r.hasNext();){var i=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(i)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return on},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var on=function(){},rn=function(){};rn.prototype.distance=function(t,e){},rn.prototype.interfaces_=function(){return[]},rn.prototype.getClass=function(){return rn};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var o={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new xt,o=0;o<t.length;o++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[o],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),o=new Array(e).fill(null),r=t.iterator(),i=0;i<e;i++){o[i]=new xt;for(var s=0;r.hasNext()&&s<n;){var a=r.next();o[i].add(a),s++}}return o},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],o=arguments[1];t.prototype.query.call(this,n,o)}else if(3===arguments.length)if(I(arguments[2],Ke)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var r=arguments[0],i=arguments[1],s=arguments[2];t.prototype.query.call(this,r,i,s)}else if(I(arguments[2],bt)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var o=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new xt(t);$e.sort(r,n.xComparator);var i=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(o))));return this.createParentBoundablesFromVerticalSlices(i,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(I(arguments[0],rn)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var o=arguments[0];return this.nearestNeighbour(o,_.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&I(arguments[1],rn)){var r=arguments[0],i=arguments[1],s=new tn(this.getRoot(),r.getRoot(),i);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=null,c=new Ye;for(c.add(a);!c.isEmpty()&&l>0;){var p=c.poll(),h=p.getDistance();if(h>=l)break;p.isLeaves()?(l=h,u=p):p.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var d=arguments[2],f=new Xe(arguments[0],arguments[1]),g=new tn(this.getRoot(),f,d);return this.nearestNeighbour(g)[0]}},n.prototype.interfaces_=function(){return[Ze,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},o.STRtreeNode.get=function(){return an},o.serialVersionUID.get=function(){return 0x39920f7d5f261e0},o.xComparator.get=function(){return{interfaces_:function(){return[x]},compare:function(e,o){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(o.getBounds()))}}},o.yComparator.get=function(){return{interfaces_:function(){return[x]},compare:function(e,o){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(o.getBounds()))}}},o.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},o.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,o),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new q(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Je),ln=function(){};ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ln.compare=function(t,e,n){if(e.equals2D(n))return 0;var o=ln.relativeSign(e.x,n.x),r=ln.relativeSign(e.y,n.y);switch(t){case 0:return ln.compareValue(o,r);case 1:return ln.compareValue(r,o);case 2:return ln.compareValue(r,-o);case 3:return ln.compareValue(-o,r);case 4:return ln.compareValue(-o,-r);case 5:return ln.compareValue(-r,-o);case 6:return ln.compareValue(-r,o);case 7:return ln.compareValue(o,-r)}return et.shouldNeverReachHere("invalid octant value"),0},ln.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var un=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],o=arguments[3];this._segString=t,this.coord=new E(e),this.segmentIndex=n,this._segmentOctant=o,this._isInterior=!e.equals2D(t.getCoordinate(n))};un.prototype.getCoordinate=function(){return this.coord},un.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},un.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ln.compare(this._segmentOctant,this.coord,e.coord)},un.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},un.prototype.isInterior=function(){return this._isInterior},un.prototype.interfaces_=function(){return[w]},un.prototype.getClass=function(){return un};var cn=function(){this._nodeMap=new p,this._edge=null;var t=arguments[0];this._edge=t};cn.prototype.getSplitCoordinates=function(){var t=new St;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var o=e.next();this.addEdgeCoordinates(n,o,t),n=o}return t.toCoordinateArray()},cn.prototype.addCollapsedNodes=function(){var t=new xt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},cn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},cn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),o=this._edge.getCoordinate(e+2);n.equals2D(o)&&t.add(new L(e+1))}},cn.prototype.addEdgeCoordinates=function(t,e,n){var o=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(o);n.add(new E(t.coord),!1);for(var i=t.segmentIndex+1;i<=e.segmentIndex;i++)n.add(this._edge.getCoordinate(i));r&&n.add(new E(e.coord))},cn.prototype.iterator=function(){return this._nodeMap.values().iterator()},cn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var o=e.next(),r=this.createSplitEdge(n,o);t.add(r),n=o}},cn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var o=e.segmentIndex-t.segmentIndex;return e.isInterior()||o--,1===o&&(n[0]=t.segmentIndex+1,!0)},cn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),o=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(o,r,e)&&t.add(new L(e[0])),o=r}},cn.prototype.getEdge=function(){return this._edge},cn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},cn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,o=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(o);r||n--;var i=new Array(n).fill(null),s=0;i[s++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)i[s++]=this._edge.getCoordinate(a);return r&&(i[s]=new E(e.coord)),new fn(i,this._edge.getData())},cn.prototype.add=function(t,e){var n=new un(this._edge,t,e,this._edge.getSegmentOctant(e)),o=this._nodeMap.get(n);return null!==o?(et.isTrue(o.coord.equals2D(t),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(n,n),n)},cn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new $("bad split edge start point at "+n);var o=t.get(t.size()-1).getCoordinates(),r=o[o.length-1];if(!r.equals2D(e[e.length-1]))throw new $("bad split edge end point at "+r)},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var pn=function(){};pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn},pn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new v("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),o=Math.abs(e);return t>=0?e>=0?n>=o?0:1:n>=o?7:6:e>=0?n>=o?3:2:n>=o?4:5}if(arguments[0]instanceof E&&arguments[1]instanceof E){var r=arguments[0],i=arguments[1],s=i.x-r.x,a=i.y-r.y;if(0===s&&0===a)throw new v("Cannot compute the octant for two identical points "+r);return pn.octant(s,a)}};var hn=function(){};hn.prototype.getCoordinates=function(){},hn.prototype.size=function(){},hn.prototype.getCoordinate=function(t){},hn.prototype.isClosed=function(){},hn.prototype.setData=function(t){},hn.prototype.getData=function(){},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn};var dn=function(){};dn.prototype.addIntersection=function(t,e){},dn.prototype.interfaces_=function(){return[hn]},dn.prototype.getClass=function(){return dn};var fn=function(){this._nodeList=new cn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};fn.prototype.getCoordinates=function(){return this._pts},fn.prototype.size=function(){return this._pts.length},fn.prototype.getCoordinate=function(t){return this._pts[t]},fn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},fn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},fn.prototype.setData=function(t){this._data=t},fn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:pn.octant(t,e)},fn.prototype.getData=function(){return this._data},fn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],o=arguments[3],r=new E(arguments[0].getIntersection(o));this.addIntersection(r,n)}},fn.prototype.toString=function(){return Q.toLineString(new le(this._pts))},fn.prototype.getNodeList=function(){return this._nodeList},fn.prototype.addIntersectionNode=function(t,e){var n=e,o=n+1;if(o<this._pts.length){var r=this._pts[o];t.equals2D(r)&&(n=o)}return this._nodeList.add(t,n)},fn.prototype.addIntersections=function(t,e,n){for(var o=0;o<t.getIntersectionNum();o++)this.addIntersection(t,e,n,o)},fn.prototype.interfaces_=function(){return[dn]},fn.prototype.getClass=function(){return fn},fn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new xt;return fn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],o=arguments[0].iterator();o.hasNext();)o.next().getNodeList().addSplitEdges(n)};var gn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new E,this.p1=new E;else if(1===arguments.length){var t=arguments[0];this.p0=new E(t.p0),this.p1=new E(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],o=arguments[2],r=arguments[3];this.p0=new E(e,n),this.p1=new E(o,r)}},mn={serialVersionUID:{configurable:!0}};gn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},gn.prototype.orientationIndex=function(){if(arguments[0]instanceof gn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof E){var o=arguments[0];return at.orientationIndex(this.p0,this.p1,o)}},gn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},gn.prototype.isVertical=function(){return this.p0.x===this.p1.x},gn.prototype.equals=function(t){if(!(t instanceof gn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},gn.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},gn.prototype.project=function(){if(arguments[0]instanceof E){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new E(t);var e=this.projectionFactor(t),n=new E;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof gn){var o=arguments[0],r=this.projectionFactor(o.p0),i=this.projectionFactor(o.p1);if(r>=1&&i>=1)return null;if(r<=0&&i<=0)return null;var s=this.project(o.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(o.p1);return i<0&&(a=this.p0),i>1&&(a=this.p1),new gn(s,a)}},gn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},gn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},gn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},gn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},gn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},gn.prototype.midPoint=function(){return gn.midPoint(this.p0,this.p1)},gn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,o=e*e+n*n;return o<=0?_.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/o},gn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),o=_.MAX_VALUE,r=null,i=this.closestPoint(t.p0);o=i.distance(t.p0),n[0]=i,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<o&&(o=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<o&&(o=r,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<o&&(o=r,n[0]=this.p1,n[1]=l),n},gn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},gn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},gn.prototype.getLength=function(){return this.p0.distance(this.p1)},gn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},gn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},gn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},gn.prototype.lineIntersection=function(t){try{return W.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof H))throw t}return null},gn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},gn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),o=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,s=Math.sqrt(r*r+i*i),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,l=e*i/s}return new E(n-l,o+a)},gn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},gn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||_.isNaN(e))&&(e=1),e},gn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},gn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},gn.prototype.distance=function(){if(arguments[0]instanceof gn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof E){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},gn.prototype.pointAlong=function(t){var e=new E;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},gn.prototype.hashCode=function(){var t=_.doubleToLongBits(this.p0.x);t^=31*_.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=_.doubleToLongBits(this.p1.x);return n^=31*_.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},gn.prototype.interfaces_=function(){return[w,e]},gn.prototype.getClass=function(){return gn},gn.midPoint=function(t,e){return new E((t.x+e.x)/2,(t.y+e.y)/2)},mn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(gn,mn);var yn=function(){this.tempEnv1=new q,this.tempEnv2=new q,this._overlapSeg1=new gn,this._overlapSeg2=new gn};yn.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn};var vn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],o=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=o};vn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},vn.prototype.computeSelect=function(t,e,n,o){var r=this._pts[e],i=this._pts[n];if(o.tempEnv1.init(r,i),n-e==1)return o.select(this,e),null;if(!t.intersects(o.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,o),s<n&&this.computeSelect(t,s,n,o)},vn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},vn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},vn.prototype.setId=function(t){this._id=t},vn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},vn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new q(t,e)}return this._env},vn.prototype.getEndIndex=function(){return this._end},vn.prototype.getStartIndex=function(){return this._start},vn.prototype.getContext=function(){return this._context},vn.prototype.getId=function(){return this._id},vn.prototype.computeOverlapsInternal=function(t,e,n,o,r,i){var s=this._pts[t],a=this._pts[e],l=n._pts[o],u=n._pts[r];if(e-t==1&&r-o==1)return i.overlap(this,t,n,o),null;if(i.tempEnv1.init(s,a),i.tempEnv2.init(l,u),!i.tempEnv1.intersects(i.tempEnv2))return null;var c=Math.trunc((t+e)/2),p=Math.trunc((o+r)/2);t<c&&(o<p&&this.computeOverlapsInternal(t,c,n,o,p,i),p<r&&this.computeOverlapsInternal(t,c,n,p,r,i)),c<e&&(o<p&&this.computeOverlapsInternal(c,e,n,o,p,i),p<r&&this.computeOverlapsInternal(c,e,n,p,r,i))},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.getChainStartIndices=function(t){var e=0,n=new xt;n.add(new L(e));do{var o=_n.findChainEnd(t,e);n.add(new L(o)),e=o}while(e<t.length-1);return _n.toIntArray(n)},_n.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var o=Be.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Be.quadrant(t[r-1],t[r])===o);)r++;return r-1},_n.getChains=function(){if(1===arguments.length){var t=arguments[0];return _n.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],o=new xt,r=_n.getChainStartIndices(e),i=0;i<r.length-1;i++){var s=new vn(e,r[i],r[i+1],n);o.add(s)}return o}},_n.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Cn=function(){};Cn.prototype.computeNodes=function(t){},Cn.prototype.getNodedSubstrings=function(){},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn};var wn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};wn.prototype.setSegmentIntersector=function(t){this._segInt=t},wn.prototype.interfaces_=function(){return[Cn]},wn.prototype.getClass=function(){return wn};var bn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new xt,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return fn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=_n.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new xn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),o=this._index.query(n.getEnvelope()).iterator();o.hasNext();){var r=o.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return xn},Object.defineProperties(e,n),e}(wn),xn=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],n=arguments[2],o=arguments[3],r=arguments[0].getContext(),i=n.getContext();this._si.processIntersections(r,e,i,o)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(yn),En=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],o=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(o)}else if(4===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(i),this.setJoinStyle(s),this.setMitreLimit(a)}},Sn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};En.prototype.getEndCapStyle=function(){return this._endCapStyle},En.prototype.isSingleSided=function(){return this._isSingleSided},En.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=En.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=En.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==En.JOIN_ROUND&&(this._quadrantSegments=En.DEFAULT_QUADRANT_SEGMENTS)},En.prototype.getJoinStyle=function(){return this._joinStyle},En.prototype.setJoinStyle=function(t){this._joinStyle=t},En.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},En.prototype.getSimplifyFactor=function(){return this._simplifyFactor},En.prototype.getQuadrantSegments=function(){return this._quadrantSegments},En.prototype.setEndCapStyle=function(t){this._endCapStyle=t},En.prototype.getMitreLimit=function(){return this._mitreLimit},En.prototype.setMitreLimit=function(t){this._mitreLimit=t},En.prototype.setSingleSided=function(t){this._isSingleSided=t},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En},En.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Sn.CAP_ROUND.get=function(){return 1},Sn.CAP_FLAT.get=function(){return 2},Sn.CAP_SQUARE.get=function(){return 3},Sn.JOIN_ROUND.get=function(){return 1},Sn.JOIN_MITRE.get=function(){return 2},Sn.JOIN_BEVEL.get=function(){return 3},Sn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Sn.DEFAULT_MITRE_LIMIT.get=function(){return 5},Sn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(En,Sn);var Tn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Rn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Tn.prototype.isDeletable=function(t,e,n,o){var r=this._inputLine[t],i=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,i,s)&&!!this.isShallow(r,i,s,o)&&this.isShallowSampled(r,i,t,n,o)},Tn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),o=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Tn.DELETE,r=!0,o=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return o},Tn.prototype.isShallowConcavity=function(t,e,n,o){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<o},Tn.prototype.isShallowSampled=function(t,e,n,o,r){var i=Math.trunc((o-n)/Tn.NUM_PTS_TO_CHECK);i<=0&&(i=1);for(var s=n;s<o;s+=i)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Tn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Tn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Tn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Tn.DELETE;)e++;return e},Tn.prototype.isShallow=function(t,e,n,o){return at.distancePointLine(e,t,n)<o},Tn.prototype.collapseLine=function(){for(var t=new St,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Tn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Tn.simplify=function(t,e){return new Tn(t).simplify(e)},Rn.INIT.get=function(){return 0},Rn.DELETE.get=function(){return 1},Rn.KEEP.get=function(){return 1},Rn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Tn,Rn);var On=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new xt},Pn={COORDINATE_ARRAY_TYPE:{configurable:!0}};On.prototype.getCoordinates=function(){return this._ptList.toArray(On.COORDINATE_ARRAY_TYPE)},On.prototype.setPrecisionModel=function(t){this._precisionModel=t},On.prototype.addPt=function(t){var e=new E(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},On.prototype.revere=function(){},On.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var o=t.length-1;o>=0;o--)this.addPt(t[o])},On.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},On.prototype.toString=function(){return(new ye).createLineString(this.getCoordinates()).toString()},On.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new E(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},On.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On},Pn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(On,Pn);var In=function(){},An={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In},In.toDegrees=function(t){return 180*t/Math.PI},In.normalize=function(t){for(;t>Math.PI;)t-=In.PI_TIMES_2;for(;t<=-Math.PI;)t+=In.PI_TIMES_2;return t},In.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],o=n.x-e.x,r=n.y-e.y;return Math.atan2(r,o)}},In.isAcute=function(t,e,n){var o=t.x-e.x,r=t.y-e.y;return o*(n.x-e.x)+r*(n.y-e.y)>0},In.isObtuse=function(t,e,n){var o=t.x-e.x,r=t.y-e.y;return o*(n.x-e.x)+r*(n.y-e.y)<0},In.interiorAngle=function(t,e,n){var o=In.angle(e,t),r=In.angle(e,n);return Math.abs(r-o)},In.normalizePositive=function(t){if(t<0){for(;t<0;)t+=In.PI_TIMES_2;t>=In.PI_TIMES_2&&(t=0)}else{for(;t>=In.PI_TIMES_2;)t-=In.PI_TIMES_2;t<0&&(t=0)}return t},In.angleBetween=function(t,e,n){var o=In.angle(e,t),r=In.angle(e,n);return In.diff(o,r)},In.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},In.toRadians=function(t){return t*Math.PI/180},In.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?In.COUNTERCLOCKWISE:n<0?In.CLOCKWISE:In.NONE},In.angleBetweenOriented=function(t,e,n){var o=In.angle(e,t),r=In.angle(e,n)-o;return r<=-Math.PI?r+In.PI_TIMES_2:r>Math.PI?r-In.PI_TIMES_2:r},An.PI_TIMES_2.get=function(){return 2*Math.PI},An.PI_OVER_2.get=function(){return Math.PI/2},An.PI_OVER_4.get=function(){return Math.PI/4},An.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},An.CLOCKWISE.get=function(){return at.CLOCKWISE},An.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(In,An);var Dn=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gn,this._seg1=new gn,this._offset0=new gn,this._offset1=new gn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],o=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new rt,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===En.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(o)},Mn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Dn.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),o=n===at.CLOCKWISE&&this._side===Se.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Se.RIGHT;0===n?this.addCollinear(e):o?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Dn.prototype.addLineEndCap=function(t,e){var n=new gn(t,e),o=new gn;this.computeOffsetSegment(n,Se.LEFT,this._distance,o);var r=new gn;this.computeOffsetSegment(n,Se.RIGHT,this._distance,r);var i=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,i);switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:this._segList.addPt(o.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case En.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(r.p1);break;case En.CAP_SQUARE:var l=new E;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new E(o.p1.x+l.x,o.p1.y+l.y),c=new E(r.p1.x+l.x,r.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},Dn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Dn.prototype.addMitreJoin=function(t,e,n,o){var r=!0,i=null;try{i=W.intersection(e.p0,e.p1,n.p0,n.p1),(o<=0?1:i.distance(t)/Math.abs(o))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof H))throw t;i=new E(0,0),r=!1}r?this._segList.addPt(i):this.addLimitedMitreJoin(e,n,o,this._bufParams.getMitreLimit())},Dn.prototype.addFilletCorner=function(t,e,n,o,r){var i=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,i),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);o===at.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,o,r),this._segList.addPt(n)},Dn.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Dn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===En.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===En.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Dn.prototype.createSquare=function(t){this._segList.addPt(new E(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new E(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Dn.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Dn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Dn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Dn.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Dn.prototype.addLimitedMitreJoin=function(t,e,n,o){var r=this._seg0.p1,i=In.angle(r,this._seg0.p0),s=In.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=In.normalize(i+s),l=In.normalize(a+Math.PI),u=o*n,c=n-u*Math.abs(Math.sin(s)),p=r.x+u*Math.cos(l),h=r.y+u*Math.sin(l),d=new E(p,h),f=new gn(r,d),g=f.pointAlongOffset(1,c),m=f.pointAlongOffset(1,-c);this._side===Se.LEFT?(this._segList.addPt(g),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(g))},Dn.prototype.computeOffsetSegment=function(t,e,n,o){var r=e===Se.LEFT?1:-1,i=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(i*i+s*s),l=r*n*i/a,u=r*n*s/a;o.p0.x=t.p0.x-u,o.p0.y=t.p0.y+l,o.p1.x=t.p1.x-u,o.p1.y=t.p1.y+l},Dn.prototype.addFilletArc=function(t,e,n,o,r){var i=o===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new E;u<s;){var p=e+i*u;c.x=t.x+r*Math.cos(p),c.y=t.y+r*Math.sin(p),this._segList.addPt(c),u+=l}},Dn.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Dn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new E((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var o=new E((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Dn.prototype.createCircle=function(t){var e=new E(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Dn.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Dn.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new On,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Dn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Dn.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===En.JOIN_BEVEL||this._bufParams.getJoinStyle()===En.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Dn.prototype.closeRing=function(){this._segList.closeRing()},Dn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Mn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Mn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Mn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Mn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Dn,Mn);var Ln=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Ln.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,o=Math.abs(e),r=this.getSegGen(o);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var i=r.getCoordinates();return n&&Tt.reverse(i),i},Ln.prototype.computeSingleSidedBufferCurve=function(t,e,n){var o=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Tn.simplify(t,-o),i=r.length-1;n.initSideSegments(r[i],r[i-1],Se.LEFT),n.addFirstSegment();for(var s=i-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Tn.simplify(t,o),l=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},Ln.prototype.computeRingBufferCurve=function(t,e,n){var o=this.simplifyTolerance(this._distance);e===Se.RIGHT&&(o=-o);var r=Tn.simplify(t,o),i=r.length-1;n.initSideSegments(r[i-1],r[0],e);for(var s=1;s<=i;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},Ln.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),o=Tn.simplify(t,n),r=o.length-1;e.initSideSegments(o[0],o[1],Se.LEFT);for(var i=2;i<=r;i++)e.addNextSegment(o[i],!0);e.addLastSegment(),e.addLineEndCap(o[r-1],o[r]);var s=Tn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Se.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Ln.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:e.createCircle(t);break;case En.CAP_SQUARE:e.createSquare(t)}},Ln.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),o=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],o);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,o)}else this.computeLineBufferCurve(t,o);return o.getCoordinates()},Ln.prototype.getBufferParameters=function(){return this._bufParams},Ln.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Ln.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Ln.copyCoordinates(t);var o=this.getSegGen(n);return this.computeRingBufferCurve(t,e,o),o.getCoordinates()},Ln.prototype.computeOffsetCurve=function(t,e,n){var o=this.simplifyTolerance(this._distance);if(e){var r=Tn.simplify(t,-o),i=r.length-1;n.initSideSegments(r[i],r[i-1],Se.LEFT),n.addFirstSegment();for(var s=i-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=Tn.simplify(t,o),l=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},Ln.prototype.getSegGen=function(t){return new Dn(this._precisionModel,this._bufParams,t)},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new E(t[n]);return e};var Nn=function(){this._subgraphs=null,this._seg=new gn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Fn={DepthSegment:{configurable:!0}};Nn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new xt,n=this._subgraphs.iterator();n.hasNext();){var o=n.next(),r=o.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,o.getDirectedEdges(),e)}return e}if(3===arguments.length)if(I(arguments[2],bt)&&arguments[0]instanceof E&&arguments[1]instanceof je){for(var i=arguments[0],s=arguments[1],a=arguments[2],l=s.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<i.x)&&!(this._seg.isHorizontal()||i.y<this._seg.p0.y||i.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,i)===at.RIGHT)){var c=s.getDepth(Se.LEFT);this._seg.p0.equals(l[u])||(c=s.getDepth(Se.RIGHT));var p=new kn(this._seg,c);a.add(p)}}else if(I(arguments[2],bt)&&arguments[0]instanceof E&&I(arguments[1],bt))for(var h=arguments[0],d=arguments[2],f=arguments[1].iterator();f.hasNext();){var g=f.next();g.isForward()&&this.findStabbedSegments(h,g,d)}},Nn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:$e.min(e)._leftDepth},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Fn.DepthSegment.get=function(){return kn},Object.defineProperties(Nn,Fn);var kn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new gn(t),this._leftDepth=e};kn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},kn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},kn.prototype.toString=function(){return this._upwardSeg.toString()},kn.prototype.interfaces_=function(){return[w]},kn.prototype.getClass=function(){return kn};var Gn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Gn.prototype.area=function(){return Gn.area(this.p0,this.p1,this.p2)},Gn.prototype.signedArea=function(){return Gn.signedArea(this.p0,this.p1,this.p2)},Gn.prototype.interpolateZ=function(t){if(null===t)throw new v("Supplied point is null.");return Gn.interpolateZ(t,this.p0,this.p1,this.p2)},Gn.prototype.longestSideLength=function(){return Gn.longestSideLength(this.p0,this.p1,this.p2)},Gn.prototype.isAcute=function(){return Gn.isAcute(this.p0,this.p1,this.p2)},Gn.prototype.circumcentre=function(){return Gn.circumcentre(this.p0,this.p1,this.p2)},Gn.prototype.area3D=function(){return Gn.area3D(this.p0,this.p1,this.p2)},Gn.prototype.centroid=function(){return Gn.centroid(this.p0,this.p1,this.p2)},Gn.prototype.inCentre=function(){return Gn.inCentre(this.p0,this.p1,this.p2)},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn},Gn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Gn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Gn.det=function(t,e,n,o){return t*o-e*n},Gn.interpolateZ=function(t,e,n,o){var r=e.x,i=e.y,s=n.x-r,a=o.x-r,l=n.y-i,u=o.y-i,c=s*u-a*l,p=t.x-r,h=t.y-i,d=(u*p-a*h)/c,f=(-l*p+s*h)/c;return e.z+d*(n.z-e.z)+f*(o.z-e.z)},Gn.longestSideLength=function(t,e,n){var o=t.distance(e),r=e.distance(n),i=n.distance(t),s=o;return r>s&&(s=r),i>s&&(s=i),s},Gn.isAcute=function(t,e,n){return!!In.isAcute(t,e,n)&&!!In.isAcute(e,n,t)&&!!In.isAcute(n,t,e)},Gn.circumcentre=function(t,e,n){var o=n.x,r=n.y,i=t.x-o,s=t.y-r,a=e.x-o,l=e.y-r,u=2*Gn.det(i,s,a,l),c=Gn.det(s,i*i+s*s,l,a*a+l*l),p=Gn.det(i,i*i+s*s,a,a*a+l*l);return new E(o-c/u,r+p/u)},Gn.perpendicularBisector=function(t,e){var n=e.x-t.x,o=e.y-t.y,r=new W(t.x+n/2,t.y+o/2,1),i=new W(t.x-o+n/2,t.y+n+o/2,1);return new W(r,i)},Gn.angleBisector=function(t,e,n){var o=e.distance(t),r=o/(o+e.distance(n)),i=n.x-t.x,s=n.y-t.y;return new E(t.x+r*i,t.y+r*s)},Gn.area3D=function(t,e,n){var o=e.x-t.x,r=e.y-t.y,i=e.z-t.z,s=n.x-t.x,a=n.y-t.y,l=n.z-t.z,u=r*l-i*a,c=i*s-o*l,p=o*a-r*s,h=u*u+c*c+p*p;return Math.sqrt(h)/2},Gn.centroid=function(t,e,n){var o=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new E(o,r)},Gn.inCentre=function(t,e,n){var o=e.distance(n),r=t.distance(n),i=t.distance(e),s=o+r+i,a=(o*t.x+r*e.x+i*n.x)/s,l=(o*t.y+r*e.y+i*n.y)/s;return new E(a,l)};var Bn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new xt;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Bn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,O.EXTERIOR,O.INTERIOR)},Bn.prototype.addPolygon=function(t){var e=this._distance,n=Se.LEFT;this._distance<0&&(e=-this._distance,n=Se.RIGHT);var o=t.getExteriorRing(),r=Tt.removeRepeatedPoints(o.getCoordinates());if(this._distance<0&&this.isErodedCompletely(o,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,O.EXTERIOR,O.INTERIOR);for(var i=0;i<t.getNumInteriorRing();i++){var s=t.getInteriorRingN(i),a=Tt.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Se.opposite(n),O.INTERIOR,O.EXTERIOR)}},Bn.prototype.isTriangleErodedCompletely=function(t,e){var n=new Gn(t[0],t[1],t[2]),o=n.inCentre();return at.distancePointLine(o,n.p0,n.p1)<Math.abs(e)},Bn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Tt.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,O.EXTERIOR,O.INTERIOR)},Bn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var o=new fn(t,new De(0,O.BOUNDARY,e,n));this._curveList.add(o)},Bn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Bn.prototype.addPolygonRing=function(t,e,n,o,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var i=o,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(i=r,s=o,n=Se.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,i,s)},Bn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof $t?this.addPolygon(t):t instanceof Kt?this.addLineString(t):t instanceof Jt?this.addPoint(t):(t instanceof te||t instanceof Ht||t instanceof ne||t instanceof jt)&&this.addCollection(t)},Bn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var o=t.getEnvelopeInternal(),r=Math.min(o.getHeight(),o.getWidth());return e<0&&2*Math.abs(e)>r},Bn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};var Vn=function(){};Vn.prototype.locate=function(t){},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn};var zn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};zn.prototype.next=function(){if(this._atStart)return this._atStart=!1,zn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new o;var t=this._parent.getGeometryN(this._index++);return t instanceof jt?(this._subcollectionIterator=new zn(t),this._subcollectionIterator.next()):t},zn.prototype.remove=function(){throw new Error(this.getClass().getName())},zn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},zn.prototype.interfaces_=function(){return[wt]},zn.prototype.getClass=function(){return zn},zn.isAtomic=function(t){return!(t instanceof jt)};var jn=function(){this._geom=null;var t=arguments[0];this._geom=t};jn.prototype.locate=function(t){return jn.locate(t,this._geom)},jn.prototype.interfaces_=function(){return[Vn]},jn.prototype.getClass=function(){return jn},jn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},jn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!jn.isPointInRing(t,n))return!1;for(var o=0;o<e.getNumInteriorRing();o++){var r=e.getInteriorRingN(o);if(jn.isPointInRing(t,r))return!1}return!0},jn.containsPoint=function(t,e){if(e instanceof $t)return jn.containsPointInPolygon(t,e);if(e instanceof jt)for(var n=new zn(e);n.hasNext();){var o=n.next();if(o!==e&&jn.containsPoint(t,o))return!0}return!1},jn.locate=function(t,e){return e.isEmpty()?O.EXTERIOR:jn.containsPoint(t,e)?O.INTERIOR:O.EXTERIOR};var Hn=function(){this._edgeMap=new p,this._edgeList=null,this._ptInAreaLocation=[O.NONE,O.NONE]};Hn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Hn.prototype.propagateSideLabels=function(t){for(var e=O.NONE,n=this.iterator();n.hasNext();){var o=n.next().getLabel();o.isArea(t)&&o.getLocation(t,Se.LEFT)!==O.NONE&&(e=o.getLocation(t,Se.LEFT))}if(e===O.NONE)return null;for(var r=e,i=this.iterator();i.hasNext();){var s=i.next(),a=s.getLabel();if(a.getLocation(t,Se.ON)===O.NONE&&a.setLocation(t,Se.ON,r),a.isArea(t)){var l=a.getLocation(t,Se.LEFT),u=a.getLocation(t,Se.RIGHT);if(u!==O.NONE){if(u!==r)throw new Oe("side location conflict",s.getCoordinate());l===O.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=l}else et.isTrue(a.getLocation(t,Se.LEFT)===O.NONE,"found single null side"),a.setLocation(t,Se.RIGHT,r),a.setLocation(t,Se.LEFT,r)}}},Hn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Hn.prototype.print=function(t){U.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Hn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Hn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,o=e.get(n).getLabel().getLocation(t,Se.LEFT);et.isTrue(o!==O.NONE,"Found unlabelled area edge");for(var r=o,i=this.iterator();i.hasNext();){var s=i.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Se.LEFT),l=s.getLocation(t,Se.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},Hn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Hn.prototype.iterator=function(){return this.getEdges().iterator()},Hn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new xt(this._edgeMap.values())),this._edgeList},Hn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===O.NONE&&(this._ptInAreaLocation[t]=jn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Hn.prototype.toString=function(){var t=new M;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Hn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Hn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var o=n.next().getLabel(),r=0;r<2;r++)o.isLine(r)&&o.getLocation(r)===O.BOUNDARY&&(e[r]=!0);for(var i=this.iterator();i.hasNext();)for(var s=i.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=O.NONE;if(e[l])u=O.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},Hn.prototype.getDegree=function(){return this._edgeMap.size()},Hn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn};var Un=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,o=0;o<this._resultAreaEdgeList.size();o++){var r=this._resultAreaEdgeList.get(o),i=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!i.isInResult())continue;e=i,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Oe("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var o=t.get(e-1),r=n.getQuadrant(),i=o.getQuadrant();return Be.isNorthern(r)&&Be.isNorthern(i)?n:Be.isNorthern(r)||Be.isNorthern(i)?0!==n.getDy()?n:0!==o.getDy()?o:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):o},e.prototype.print=function(t){U.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new xt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var o=this._edgeList.get(n),r=o.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=o}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Se.LEFT),o=t.getDepth(Se.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==o)throw new Oe("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var i=arguments[1],s=arguments[2],a=arguments[0];a<i;a++){var l=this._edgeList.get(a);l.setEdgeDepths(Se.RIGHT,s),s=l.getDepth(Se.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,o=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var i=this._resultAreaEdgeList.get(r),s=i.getSym();switch(null===e&&i.getEdgeRing()===t&&(e=i),o){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,o=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(i.getEdgeRing()!==t)continue;n.setNextMin(i),o=this._SCANNING_FOR_INCOMING}}o===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],o=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&o++;return o}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=O.NONE,e=this.iterator();e.hasNext();){var n=e.next(),o=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=O.INTERIOR;break}if(o.isInResult()){t=O.EXTERIOR;break}}}if(t===O.NONE)return null;for(var r=t,i=this.iterator();i.hasNext();){var s=i.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===O.INTERIOR):(s.isInResult()&&(r=O.EXTERIOR),a.isInResult()&&(r=O.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new De(O.NONE);for(var n=this.iterator();n.hasNext();)for(var o=n.next().getEdge().getLabel(),r=0;r<2;r++){var i=o.getLocation(r);i!==O.INTERIOR&&i!==O.BOUNDARY||this._label.setLocation(r,O.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Hn),Wn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new ke(t,new Un)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(He),qn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};qn.prototype.compareTo=function(t){var e=t;return qn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},qn.prototype.interfaces_=function(){return[w]},qn.prototype.getClass=function(){return qn},qn.orientation=function(t){return 1===Tt.increasingDirection(t)},qn.compareOriented=function(t,e,n,o){for(var r=e?1:-1,i=o?1:-1,s=e?t.length:-1,a=o?n.length:-1,l=e?0:t.length-1,u=o?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var p=(l+=r)===s,h=(u+=i)===a;if(p&&!h)return-1;if(!p&&h)return 1;if(p&&h)return 0}};var Xn=function(){this._edges=new xt,this._ocaMap=new p};Xn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var o=n.getCoordinates(),r=0;r<o.length;r++)r>0&&t.print(","),t.print(o[r].x+" "+o[r].y);t.println(")")}t.print(")  ")},Xn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Xn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Xn.prototype.iterator=function(){return this._edges.iterator()},Xn.prototype.getEdges=function(){return this._edges},Xn.prototype.get=function(t){return this._edges.get(t)},Xn.prototype.findEqualEdge=function(t){var e=new qn(t.getCoordinates());return this._ocaMap.get(e)},Xn.prototype.add=function(t){this._edges.add(t);var e=new qn(t.getCoordinates());this._ocaMap.put(e,t)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Yn=function(){};Yn.prototype.processIntersections=function(t,e,n,o){},Yn.prototype.isDone=function(){},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn};var Kn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Kn.prototype.isTrivialIntersection=function(t,e,n,o){if(t===n&&1===this._li.getIntersectionNum()){if(Kn.isAdjacentSegments(e,o))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&o===r||0===o&&e===r)return!0}}return!1},Kn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Kn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Kn.prototype.getLineIntersector=function(){return this._li},Kn.prototype.hasProperIntersection=function(){return this._hasProper},Kn.prototype.processIntersections=function(t,e,n,o){if(t===n&&e===o)return null;this.numTests++;var r=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[o],a=n.getCoordinates()[o+1];this._li.computeIntersection(r,i,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,o)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Kn.prototype.hasIntersection=function(){return this._hasIntersection},Kn.prototype.isDone=function(){return!1},Kn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Kn.prototype.interfaces_=function(){return[Yn]},Kn.prototype.getClass=function(){return Kn},Kn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Zn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new E(t),this.segmentIndex=e,this.dist=n};Zn.prototype.getSegmentIndex=function(){return this.segmentIndex},Zn.prototype.getCoordinate=function(){return this.coord},Zn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Zn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Zn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Zn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Zn.prototype.getDistance=function(){return this.dist},Zn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Zn.prototype.interfaces_=function(){return[w]},Zn.prototype.getClass=function(){return Zn};var Jn=function(){this._nodeMap=new p,this.edge=null;var t=arguments[0];this.edge=t};Jn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Jn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Jn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var o=e.next(),r=this.createSplitEdge(n,o);t.add(r),n=o}},Jn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Jn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,o=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(o);r||n--;var i=new Array(n).fill(null),s=0;i[s++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)i[s++]=this.edge.pts[a];return r&&(i[s]=e.coord),new no(i,new De(this.edge._label))},Jn.prototype.add=function(t,e,n){var o=new Zn(t,e,n),r=this._nodeMap.get(o);return null!==r?r:(this._nodeMap.put(o,o),o)},Jn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var Qn=function(){};Qn.prototype.getChainStartIndices=function(t){var e=0,n=new xt;n.add(new L(e));do{var o=this.findChainEnd(t,e);n.add(new L(o)),e=o}while(e<t.length-1);return Qn.toIntArray(n)},Qn.prototype.findChainEnd=function(t,e){for(var n=Be.quadrant(t[e],t[e+1]),o=e+1;o<t.length&&Be.quadrant(t[o-1],t[o])===n;)o++;return o-1},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Qn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var $n=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new q,this.env2=new q;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Qn;this.startIndex=e.getChainStartIndices(this.pts)};$n.prototype.getCoordinates=function(){return this.pts},$n.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},$n.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},$n.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],o)}else if(6===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[r],p=this.pts[i],h=s.pts[a],d=s.pts[l];if(i-r==1&&l-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,p),this.env2.init(h,d),!this.env1.intersects(this.env2))return null;var f=Math.trunc((r+i)/2),g=Math.trunc((a+l)/2);r<f&&(a<g&&this.computeIntersectsForChain(r,f,s,a,g,u),g<l&&this.computeIntersectsForChain(r,f,s,g,l,u)),f<i&&(a<g&&this.computeIntersectsForChain(f,i,s,a,g,u),g<l&&this.computeIntersectsForChain(f,i,s,g,l,u))}},$n.prototype.getStartIndexes=function(){return this.startIndex},$n.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var o=0;o<t.startIndex.length-1;o++)this.computeIntersectsForChain(n,t,o,e)},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n};var to=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},eo={NULL_VALUE:{configurable:!0}};to.prototype.getDepth=function(t,e){return this._depth[t][e]},to.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},to.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==to.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===to.NULL_VALUE}if(2===arguments.length){var o=arguments[0],r=arguments[1];return this._depth[o][r]===to.NULL_VALUE}},to.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var o=0;this._depth[t][n]>e&&(o=1),this._depth[t][n]=o}}},to.prototype.getDelta=function(t){return this._depth[t][Se.RIGHT]-this._depth[t][Se.LEFT]},to.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?O.EXTERIOR:O.INTERIOR},to.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},to.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var o=t.getLocation(e,n);o!==O.EXTERIOR&&o!==O.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=to.depthAtLocation(o):this._depth[e][n]+=to.depthAtLocation(o))}else if(3===arguments.length){var r=arguments[0],i=arguments[1];arguments[2]===O.INTERIOR&&this._depth[r][i]++}},to.prototype.interfaces_=function(){return[]},to.prototype.getClass=function(){return to},to.depthAtLocation=function(t){return t===O.EXTERIOR?0:t===O.INTERIOR?1:to.NULL_VALUE},eo.NULL_VALUE.get=function(){return-1},Object.defineProperties(to,eo);var no=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Jn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new to,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var o=arguments[0],r=arguments[1];this.pts=o,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,De.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var o=!0,r=!0,i=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(o=!1),this.pts[s].equals2D(n.pts[--i])||(r=!1),!o&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new $n(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new q;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,o){var r=new E(t.getIntersection(o)),i=e,s=t.getEdgeDistance(n,o),a=i+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(i=a,s=0)}this.eiList.add(r,i,s)},e.prototype.toString=function(){var t=new M;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var o=0;o<t.getIntersectionNum();o++)this.addIntersection(t,e,n,o)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Se.ON),e.getLocation(1,Se.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Se.LEFT),e.getLocation(1,Se.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Se.RIGHT),e.getLocation(1,Se.RIGHT),2))},e}(Fe),oo=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Xn,this._bufParams=t||null};oo.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},oo.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),o=t.getLabel();e.isPointwiseEqual(t)||(o=new De(t.getLabel())).flip(),n.merge(o);var r=oo.depthDelta(o),i=e.getDepthDelta()+r;e.setDepthDelta(i)}else this._edgeList.add(t),t.setDepthDelta(oo.depthDelta(t.getLabel()))},oo.prototype.buildSubgraphs=function(t,e){for(var n=new xt,o=t.iterator();o.hasNext();){var r=o.next(),i=r.getRightmostCoordinate(),s=new Nn(n).getDepth(i);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},oo.prototype.createSubgraphs=function(t){for(var e=new xt,n=t.getNodes().iterator();n.hasNext();){var o=n.next();if(!o.isVisited()){var r=new Ie;r.create(o),e.add(r)}}return $e.sort(e,$e.reverseOrder()),e},oo.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},oo.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new bn,n=new rt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Kn(n)),e},oo.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var o=new Ln(n,this._bufParams),r=new Bn(t,e,o).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new Ue(new Wn),this._graph.addEdges(this._edgeList.getEdges());var i=this.createSubgraphs(this._graph),s=new We(this._geomFact);this.buildSubgraphs(i,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},oo.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var o=n.getNodedSubstrings().iterator();o.hasNext();){var r=o.next(),i=r.getCoordinates();if(2!==i.length||!i[0].equals2D(i[1])){var s=r.getData(),a=new no(r.getCoordinates(),new De(s));this.insertUniqueEdge(a)}}},oo.prototype.setNoder=function(t){this._workingNoder=t},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo},oo.depthDelta=function(t){var e=t.getLocation(0,Se.LEFT),n=t.getLocation(0,Se.RIGHT);return e===O.INTERIOR&&n===O.EXTERIOR?1:e===O.EXTERIOR&&n===O.INTERIOR?-1:0},oo.convertSegStrings=function(t){for(var e=new ye,n=new xt;t.hasNext();){var o=t.next(),r=e.createLineString(o.getCoordinates());n.add(r)}return e.buildGeometry(n)};var ro=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2],i=arguments[3];this._noder=n,this._scaleFactor=o,this._offsetX=r,this._offsetY=i,this._isScaled=!this.isIntegerPrecision()}};ro.prototype.rescale=function(){if(I(arguments[0],Ct))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],o=0;o<n.length;o++)n[o].x=n[o].x/this._scaleFactor+this._offsetX,n[o].y=n[o].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&U.out.println(n)}},ro.prototype.scale=function(){if(I(arguments[0],Ct)){for(var t=arguments[0],e=new xt,n=t.iterator();n.hasNext();){var o=n.next();e.add(new fn(this.scale(o.getCoordinates()),o.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],i=new Array(r.length).fill(null),s=0;s<r.length;s++)i[s]=new E(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Tt.removeRepeatedPoints(i)}},ro.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ro.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ro.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ro.prototype.interfaces_=function(){return[Cn]},ro.prototype.getClass=function(){return ro};var io=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},so={fact:{configurable:!0}};io.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],o=arguments[1].iterator();o.hasNext();)for(var r=o.next().getCoordinates(),i=1;i<r.length-1;i++)if(r[i].equals(n))throw new $("found endpt/interior pt intersection at index "+i+" :pt "+n)},io.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var o=n.next();this.checkInteriorIntersections(e,o)}else if(2===arguments.length)for(var r=arguments[0],i=arguments[1],s=r.getCoordinates(),a=i.getCoordinates(),l=0;l<s.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(r,l,i,u);else if(4===arguments.length){var c=arguments[0],p=arguments[1],h=arguments[2],d=arguments[3];if(c===h&&p===d)return null;var f=c.getCoordinates()[p],g=c.getCoordinates()[p+1],m=h.getCoordinates()[d],y=h.getCoordinates()[d+1];if(this._li.computeIntersection(f,g,m,y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,f,g)||this.hasInteriorIntersection(this._li,m,y)))throw new $("found non-noded intersection at "+f+"-"+g+" and "+m+"-"+y)}},io.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},io.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),o=0;o<n.length-2;o++)this.checkCollapse(n[o],n[o+1],n[o+2])},io.prototype.hasInteriorIntersection=function(t,e,n){for(var o=0;o<t.getIntersectionNum();o++){var r=t.getIntersection(o);if(!r.equals(e)&&!r.equals(n))return!0}return!1},io.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new $("found non-noded collapse at "+io.fact.createLineString([t,e,n]))},io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io},so.fact.get=function(){return new ye},Object.defineProperties(io,so);var ao=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new v("Scale factor must be non-zero");1!==e&&(this._pt=new E(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new E,this._p1Scaled=new E),this.initCorners(this._pt)},lo={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ao.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),o=Math.max(t.x,e.x),r=Math.min(t.y,e.y),i=Math.max(t.y,e.y),s=this._maxx<n||this._minx>o||this._maxy<r||this._miny>i;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ao.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new E(this._maxx,this._maxy),this._corner[1]=new E(this._minx,this._maxy),this._corner[2]=new E(this._minx,this._miny),this._corner[3]=new E(this._maxx,this._miny)},ao.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ao.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ao.prototype.getCoordinate=function(){return this._originalPt},ao.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ao.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ao.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new q(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ao.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},ao.prototype.intersectsToleranceSquare=function(t,e){var n=!1,o=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!o)||!!t.equals(this._pt)||!!e.equals(this._pt))))},ao.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),o=t.getCoordinate(e+1);return!!this.intersects(n,o)&&(t.addIntersection(this.getCoordinate(),e),!0)},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao},lo.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ao,lo);var uo=function(){this.tempEnv1=new q,this.selectedSegment=new gn};uo.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},uo.prototype.interfaces_=function(){return[]},uo.prototype.getClass=function(){return uo};var co=function(){this._index=null;var t=arguments[0];this._index=t},po={HotPixelSnapAction:{configurable:!0}};co.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],o=arguments[2],r=e.getSafeEnvelope(),i=new ho(e,n,o);return this._index.query(r,{interfaces_:function(){return[Ke]},visitItem:function(t){t.select(r,i)}}),i.isNodeAdded()}},co.prototype.interfaces_=function(){return[]},co.prototype.getClass=function(){return co},po.HotPixelSnapAction.get=function(){return ho},Object.defineProperties(co,po);var ho=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],o=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],n=arguments[0].getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(uo),fo=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new xt};fo.prototype.processIntersections=function(t,e,n,o){if(t===n&&e===o)return null;var r=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[o],a=n.getCoordinates()[o+1];if(this._li.computeIntersection(r,i,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,o,1)}},fo.prototype.isDone=function(){return!1},fo.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fo.prototype.interfaces_=function(){return[Yn]},fo.prototype.getClass=function(){return fo};var go=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};go.prototype.checkCorrectness=function(t){var e=fn.getNodedSubstrings(t),n=new io(e);try{n.checkValid()}catch(t){if(!(t instanceof j))throw t;t.printStackTrace()}},go.prototype.getNodedSubstrings=function(){return fn.getNodedSubstrings(this._nodedSegStrings)},go.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},go.prototype.findInteriorIntersections=function(t,e){var n=new fo(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},go.prototype.computeVertexSnaps=function(){if(I(arguments[0],Ct))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof fn)for(var n=arguments[0],o=n.getCoordinates(),r=0;r<o.length;r++){var i=new ao(o[r],this._scaleFactor,this._li);this._pointSnapper.snap(i,n,r)&&n.addIntersection(o[r],r)}},go.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new bn,this._pointSnapper=new co(this._noder.getIndex()),this.snapRound(t,this._li)},go.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),o=new ao(n,this._scaleFactor,this._li);this._pointSnapper.snap(o)}},go.prototype.interfaces_=function(){return[Cn]},go.prototype.getClass=function(){return go};var mo=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new En,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},yo={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};mo.prototype.bufferFixedPrecision=function(t){var e=new ro(new go(new de(1)),t.getScale()),n=new oo(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},mo.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=mo.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Oe))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],o=mo.precisionScaleFactor(this._argGeom,this._distance,n),r=new de(o);this.bufferFixedPrecision(r)}},mo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===de.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},mo.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},mo.prototype.bufferOriginalPrecision=function(){try{var t=new oo(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $))throw t;this._saveException=t}},mo.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},mo.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},mo.prototype.interfaces_=function(){return[]},mo.prototype.getClass=function(){return mo},mo.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new mo(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],o=new mo(arguments[0]);return o.setQuadrantSegments(n),o.getResultGeometry(e)}if(arguments[2]instanceof En&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var r=arguments[1];return new mo(arguments[0],arguments[2]).getResultGeometry(r)}}else if(4===arguments.length){var i=arguments[1],s=arguments[2],a=arguments[3],l=new mo(arguments[0]);return l.setQuadrantSegments(s),l.setEndCapStyle(a),l.getResultGeometry(i)}},mo.precisionScaleFactor=function(t,e,n){var o=t.getEnvelopeInternal(),r=A.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY()))+2*(e>0?e:0),i=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,i)},yo.CAP_ROUND.get=function(){return En.CAP_ROUND},yo.CAP_BUTT.get=function(){return En.CAP_FLAT},yo.CAP_FLAT.get=function(){return En.CAP_FLAT},yo.CAP_SQUARE.get=function(){return En.CAP_SQUARE},yo.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(mo,yo);var vo=function(){this._pt=[new E,new E],this._distance=_.NaN,this._isNull=!0};vo.prototype.getCoordinates=function(){return this._pt},vo.prototype.getCoordinate=function(t){return this._pt[t]},vo.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var o=e.distance(n);o<this._distance&&this.initialize(e,n,o)}},vo.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(o),this._distance=r,this._isNull=!1}},vo.prototype.getDistance=function(){return this._distance},vo.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var o=e.distance(n);o>this._distance&&this.initialize(e,n,o)}},vo.prototype.interfaces_=function(){return[]},vo.prototype.getClass=function(){return vo};var _o=function(){};_o.prototype.interfaces_=function(){return[]},_o.prototype.getClass=function(){return _o},_o.computeDistance=function(){if(arguments[2]instanceof vo&&arguments[0]instanceof Kt&&arguments[1]instanceof E)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),o=new gn,r=0;r<n.length-1;r++){o.setCoordinates(n[r],n[r+1]);var i=o.closestPoint(t);e.setMinimum(i,t)}else if(arguments[2]instanceof vo&&arguments[0]instanceof $t&&arguments[1]instanceof E){var s=arguments[0],a=arguments[1],l=arguments[2];_o.computeDistance(s.getExteriorRing(),a,l);for(var u=0;u<s.getNumInteriorRing();u++)_o.computeDistance(s.getInteriorRingN(u),a,l)}else if(arguments[2]instanceof vo&&arguments[0]instanceof ct&&arguments[1]instanceof E){var c=arguments[0],p=arguments[1],h=arguments[2];if(c instanceof Kt)_o.computeDistance(c,p,h);else if(c instanceof $t)_o.computeDistance(c,p,h);else if(c instanceof jt)for(var d=c,f=0;f<d.getNumGeometries();f++){var g=d.getGeometryN(f);_o.computeDistance(g,p,h)}else h.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof vo&&arguments[0]instanceof gn&&arguments[1]instanceof E){var m=arguments[1],y=arguments[2],v=arguments[0].closestPoint(m);y.setMinimum(v,m)}};var Co=function(t){this._maxPtDist=new vo,this._inputGeom=t||null},wo={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Co.prototype.computeMaxMidpointDistance=function(t){var e=new xo(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Co.prototype.computeMaxVertexDistance=function(t){var e=new bo(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Co.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},Co.prototype.getDistancePoints=function(){return this._maxPtDist},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co},wo.MaxPointDistanceFilter.get=function(){return bo},wo.MaxMidpointDistanceFilter.get=function(){return xo},Object.defineProperties(Co,wo);var bo=function(t){this._maxPtDist=new vo,this._minPtDist=new vo,this._geom=t||null};bo.prototype.filter=function(t){this._minPtDist.initialize(),_o.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},bo.prototype.getMaxPointDistance=function(){return this._maxPtDist},bo.prototype.interfaces_=function(){return[dt]},bo.prototype.getClass=function(){return bo};var xo=function(t){this._maxPtDist=new vo,this._minPtDist=new vo,this._geom=t||null};xo.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),o=t.getCoordinate(e),r=new E((n.x+o.x)/2,(n.y+o.y)/2);this._minPtDist.initialize(),_o.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xo.prototype.isDone=function(){return!1},xo.prototype.isGeometryChanged=function(){return!1},xo.prototype.getMaxPointDistance=function(){return this._maxPtDist},xo.prototype.interfaces_=function(){return[zt]},xo.prototype.getClass=function(){return xo};var Eo=function(t){this._comps=t||null};Eo.prototype.filter=function(t){t instanceof $t&&this._comps.add(t)},Eo.prototype.interfaces_=function(){return[Vt]},Eo.prototype.getClass=function(){return Eo},Eo.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Eo.getPolygons(t,new xt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof $t?n.add(e):e instanceof jt&&e.apply(new Eo(n)),n}};var So=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};So.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Kt&&this._lines.add(t)},So.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},So.prototype.interfaces_=function(){return[ut]},So.prototype.getClass=function(){return So},So.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(So.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(So.getLines(e,n))}},So.getLines=function(){if(1===arguments.length){var t=arguments[0];return So.getLines(t,!1)}if(2===arguments.length){if(I(arguments[0],Ct)&&I(arguments[1],Ct)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var o=n.next();So.getLines(o,e)}return e}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var r=arguments[0],i=arguments[1],s=new xt;return r.apply(new So(s,i)),s}if(arguments[0]instanceof ct&&I(arguments[1],Ct)){var a=arguments[0],l=arguments[1];return a instanceof Kt?l.add(a):a.apply(new So(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&I(arguments[0],Ct)&&I(arguments[1],Ct)){for(var u=arguments[1],c=arguments[2],p=arguments[0].iterator();p.hasNext();){var h=p.next();So.getLines(h,u,c)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&I(arguments[1],Ct)){var d=arguments[1],f=arguments[2];return arguments[0].apply(new So(d,f)),d}}};var To=function(){if(this._boundaryRule=ft.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new v("Rule must be non-null");this._boundaryRule=t}};To.prototype.locateInternal=function(){if(arguments[0]instanceof E&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];if(e.isEmpty())return O.EXTERIOR;var n=e.getExteriorRing(),o=this.locateInPolygonRing(t,n);if(o===O.EXTERIOR)return O.EXTERIOR;if(o===O.BOUNDARY)return O.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,i);if(s===O.INTERIOR)return O.EXTERIOR;if(s===O.BOUNDARY)return O.BOUNDARY}return O.INTERIOR}if(arguments[0]instanceof E&&arguments[1]instanceof Kt){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return O.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?at.isOnLine(a,u)?O.INTERIOR:O.EXTERIOR:O.BOUNDARY}if(arguments[0]instanceof E&&arguments[1]instanceof Jt){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?O.INTERIOR:O.EXTERIOR}},To.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):O.EXTERIOR},To.prototype.intersects=function(t,e){return this.locate(t,e)!==O.EXTERIOR},To.prototype.updateLocationInfo=function(t){t===O.INTERIOR&&(this._isIn=!0),t===O.BOUNDARY&&this._numBoundaries++},To.prototype.computeLocation=function(t,e){if(e instanceof Jt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Kt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ht)for(var n=e,o=0;o<n.getNumGeometries();o++){var r=n.getGeometryN(o);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ne)for(var i=e,s=0;s<i.getNumGeometries();s++){var a=i.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof jt)for(var l=new zn(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},To.prototype.locate=function(t,e){return e.isEmpty()?O.EXTERIOR:e instanceof Kt||e instanceof $t?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?O.BOUNDARY:this._numBoundaries>0||this._isIn?O.INTERIOR:O.EXTERIOR)},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To};var Ro=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],n=arguments[1],o=arguments[2];this._component=e,this._segIndex=n,this._pt=o}},Oo={INSIDE_AREA:{configurable:!0}};Ro.prototype.isInsideArea=function(){return this._segIndex===Ro.INSIDE_AREA},Ro.prototype.getCoordinate=function(){return this._pt},Ro.prototype.getGeometryComponent=function(){return this._component},Ro.prototype.getSegmentIndex=function(){return this._segIndex},Ro.prototype.interfaces_=function(){return[]},Ro.prototype.getClass=function(){return Ro},Oo.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Ro,Oo);var Po=function(t){this._pts=t||null};Po.prototype.filter=function(t){t instanceof Jt&&this._pts.add(t)},Po.prototype.interfaces_=function(){return[Vt]},Po.prototype.getClass=function(){return Po},Po.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Jt?$e.singletonList(t):Po.getPoints(t,new xt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Jt?n.add(e):e instanceof jt&&e.apply(new Po(n)),n}};var Io=function(){this._locations=null;var t=arguments[0];this._locations=t};Io.prototype.filter=function(t){(t instanceof Jt||t instanceof Kt||t instanceof $t)&&this._locations.add(new Ro(t,0,t.getCoordinate()))},Io.prototype.interfaces_=function(){return[Vt]},Io.prototype.getClass=function(){return Io},Io.getLocations=function(t){var e=new xt;return t.apply(new Io(e)),e};var Ao=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new To,this._minDistanceLocation=null,this._minDistance=_.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=o,this._terminateDistance=r}};Ao.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],o=1-e,r=Eo.getPolygons(this._geom[e]);if(r.size()>0){var i=Io.getLocations(this._geom[o]);if(this.computeContainmentDistance(i,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[o]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&I(arguments[0],bt)&&I(arguments[1],bt)){for(var s=arguments[0],a=arguments[1],l=arguments[2],u=0;u<s.size();u++)for(var c=s.get(u),p=0;p<a.size();p++)if(this.computeContainmentDistance(c,a.get(p),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ro&&arguments[1]instanceof $t){var h=arguments[0],d=arguments[1],f=arguments[2],g=h.getCoordinate();if(O.EXTERIOR!==this._ptLocator.locate(g,d))return this._minDistance=0,f[0]=h,f[1]=new Ro(d,g),null}},Ao.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var o=0;o<t.size();o++)for(var r=t.get(o),i=0;i<e.size();i++){var s=e.get(i);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Ao.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=So.getLines(this._geom[0]),n=So.getLines(this._geom[1]),o=Po.getPoints(this._geom[0]),r=Po.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,o,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(o,r,t),void this.updateMinDistance(t,!1))))},Ao.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ao.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Ao.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ao.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Kt&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var o=t.getCoordinates(),r=e.getCoordinate(),i=0;i<o.length-1;i++){var s=at.distancePointLine(r,o[i],o[i+1]);if(s<this._minDistance){this._minDistance=s;var a=new gn(o[i],o[i+1]).closestPoint(r);n[0]=new Ro(t,i,a),n[1]=new Ro(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Kt&&arguments[1]instanceof Kt){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var p=l.getCoordinates(),h=u.getCoordinates(),d=0;d<p.length-1;d++)for(var f=0;f<h.length-1;f++){var g=at.distanceLineLine(p[d],p[d+1],h[f],h[f+1]);if(g<this._minDistance){this._minDistance=g;var m=new gn(p[d],p[d+1]),y=new gn(h[f],h[f+1]),v=m.closestPoints(y);c[0]=new Ro(l,d,v[0]),c[1]=new Ro(u,f,v[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ao.prototype.computeMinDistancePoints=function(t,e,n){for(var o=0;o<t.size();o++)for(var r=t.get(o),i=0;i<e.size();i++){var s=e.get(i),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Ro(r,0,r.getCoordinate()),n[1]=new Ro(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ao.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new v("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ao.prototype.computeMinDistanceLines=function(t,e,n){for(var o=0;o<t.size();o++)for(var r=t.get(o),i=0;i<e.size();i++){var s=e.get(i);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Ao.prototype.interfaces_=function(){return[]},Ao.prototype.getClass=function(){return Ao},Ao.distance=function(t,e){return new Ao(t,e).distance()},Ao.isWithinDistance=function(t,e,n){return new Ao(t,e,n).distance()<=n},Ao.nearestPoints=function(t,e){return new Ao(t,e).nearestPoints()};var Do=function(){this._pt=[new E,new E],this._distance=_.NaN,this._isNull=!0};Do.prototype.getCoordinates=function(){return this._pt},Do.prototype.getCoordinate=function(t){return this._pt[t]},Do.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var o=e.distance(n);o<this._distance&&this.initialize(e,n,o)}},Do.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(o),this._distance=r,this._isNull=!1}},Do.prototype.toString=function(){return Q.toLineString(this._pt[0],this._pt[1])},Do.prototype.getDistance=function(){return this._distance},Do.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var o=e.distance(n);o>this._distance&&this.initialize(e,n,o)}},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do};var Mo=function(){};Mo.prototype.interfaces_=function(){return[]},Mo.prototype.getClass=function(){return Mo},Mo.computeDistance=function(){if(arguments[2]instanceof Do&&arguments[0]instanceof Kt&&arguments[1]instanceof E)for(var t=arguments[0],e=arguments[1],n=arguments[2],o=new gn,r=t.getCoordinates(),i=0;i<r.length-1;i++){o.setCoordinates(r[i],r[i+1]);var s=o.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Do&&arguments[0]instanceof $t&&arguments[1]instanceof E){var a=arguments[0],l=arguments[1],u=arguments[2];Mo.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Mo.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Do&&arguments[0]instanceof ct&&arguments[1]instanceof E){var p=arguments[0],h=arguments[1],d=arguments[2];if(p instanceof Kt)Mo.computeDistance(p,h,d);else if(p instanceof $t)Mo.computeDistance(p,h,d);else if(p instanceof jt)for(var f=p,g=0;g<f.getNumGeometries();g++){var m=f.getGeometryN(g);Mo.computeDistance(m,h,d)}else d.setMinimum(p.getCoordinate(),h)}else if(arguments[2]instanceof Do&&arguments[0]instanceof gn&&arguments[1]instanceof E){var y=arguments[1],v=arguments[2],_=arguments[0].closestPoint(y);v.setMinimum(_,y)}};var Lo=function(){this._g0=null,this._g1=null,this._ptDist=new Do,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},No={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Lo.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Lo.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new v("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Lo.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Lo.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Lo.prototype.computeOrientedDistance=function(t,e,n){var o=new Fo(e);if(t.apply(o),n.setMaximum(o.getMaxPointDistance()),this._densifyFrac>0){var r=new ko(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Lo.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo},Lo.distance=function(){if(2===arguments.length)return new Lo(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Lo(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},No.MaxPointDistanceFilter.get=function(){return Fo},No.MaxDensifiedByFractionDistanceFilter.get=function(){return ko},Object.defineProperties(Lo,No);var Fo=function(){this._maxPtDist=new Do,this._minPtDist=new Do,this._euclideanDist=new Mo,this._geom=null;var t=arguments[0];this._geom=t};Fo.prototype.filter=function(t){this._minPtDist.initialize(),Mo.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Fo.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fo.prototype.interfaces_=function(){return[dt]},Fo.prototype.getClass=function(){return Fo};var ko=function(){this._maxPtDist=new Do,this._minPtDist=new Do,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};ko.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),o=t.getCoordinate(e),r=(o.x-n.x)/this._numSubSegs,i=(o.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,l=n.y+s*i,u=new E(a,l);this._minPtDist.initialize(),Mo.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},ko.prototype.isDone=function(){return!1},ko.prototype.isGeometryChanged=function(){return!1},ko.prototype.getMaxPointDistance=function(){return this._maxPtDist},ko.prototype.interfaces_=function(){return[zt]},ko.prototype.getClass=function(){return ko};var Go=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Bo={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Go.prototype.checkMaximumDistance=function(t,e,n){var o=new Lo(e,t);if(o.setDensifyFraction(.25),this._maxDistanceFound=o.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=o.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Q.toLineString(r[0],r[1])+")"}},Go.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Go.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Go.VERBOSE&&U.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Go.prototype.checkNegativeValid=function(){if(!(this._input instanceof $t||this._input instanceof ne||this._input instanceof jt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Go.prototype.getErrorIndicator=function(){return this._errorIndicator},Go.prototype.checkMinimumDistance=function(t,e,n){var o=new Ao(t,e,n);if(this._minDistanceFound=o.distance(),this._minDistanceFound<n){this._isValid=!1;var r=o.nearestPoints();this._errorLocation=o.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Q.toLineString(r[0],r[1])+" )"}},Go.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Go.prototype.getErrorLocation=function(){return this._errorLocation},Go.prototype.getPolygonLines=function(t){for(var e=new xt,n=new So(e),o=Eo.getPolygons(t).iterator();o.hasNext();)o.next().apply(n);return t.getFactory().buildGeometry(e)},Go.prototype.getErrorMessage=function(){return this._errMsg},Go.prototype.interfaces_=function(){return[]},Go.prototype.getClass=function(){return Go},Bo.VERBOSE.get=function(){return!1},Bo.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Go,Bo);var Vo=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},zo={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Vo.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Vo.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Vo.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new q(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new q(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Vo.prototype.checkDistance=function(){var t=new Go(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Vo.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Vo.prototype.checkPolygonal=function(){this._result instanceof $t||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Vo.prototype.getErrorIndicator=function(){return this._errorIndicator},Vo.prototype.getErrorLocation=function(){return this._errorLocation},Vo.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Vo.prototype.report=function(t){if(!Vo.VERBOSE)return null;U.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Vo.prototype.getErrorMessage=function(){return this._errorMsg},Vo.prototype.interfaces_=function(){return[]},Vo.prototype.getClass=function(){return Vo},Vo.isValidMsg=function(t,e,n){var o=new Vo(t,e,n);return o.isValid()?null:o.getErrorMessage()},Vo.isValid=function(t,e,n){return!!new Vo(t,e,n).isValid()},zo.VERBOSE.get=function(){return!1},zo.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Vo,zo);var jo=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};jo.prototype.getCoordinates=function(){return this._pts},jo.prototype.size=function(){return this._pts.length},jo.prototype.getCoordinate=function(t){return this._pts[t]},jo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},jo.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:pn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},jo.prototype.setData=function(t){this._data=t},jo.prototype.getData=function(){return this._data},jo.prototype.toString=function(){return Q.toLineString(new le(this._pts))},jo.prototype.interfaces_=function(){return[hn]},jo.prototype.getClass=function(){return jo};var Ho=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new xt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Ho.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Ho.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Ho.prototype.getIntersectionSegments=function(){return this._intSegments},Ho.prototype.count=function(){return this._intersectionCount},Ho.prototype.getIntersections=function(){return this._intersections},Ho.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Ho.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Ho.prototype.processIntersections=function(t,e,n,o){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===o)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,o))return null;var r=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[o],a=n.getCoordinates()[o+1];this._li.computeIntersection(r,i,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=i,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Ho.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Ho.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Ho.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Ho.prototype.interfaces_=function(){return[Yn]},Ho.prototype.getClass=function(){return Ho},Ho.createAllIntersectionsFinder=function(t){var e=new Ho(t);return e.setFindAllIntersections(!0),e},Ho.createAnyIntersectionFinder=function(t){return new Ho(t)},Ho.createIntersectionCounter=function(t){var e=new Ho(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Uo=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Uo.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Uo.prototype.getIntersections=function(){return this._segInt.getIntersections()},Uo.prototype.isValid=function(){return this.execute(),this._isValid},Uo.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Uo.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ho(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new bn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Uo.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Oe(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Uo.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Q.toLineString(t[0],t[1])+" and "+Q.toLineString(t[2],t[3])},Uo.prototype.interfaces_=function(){return[]},Uo.prototype.getClass=function(){return Uo},Uo.computeIntersections=function(t){var e=new Uo(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Wo=function t(){this._nv=null;var e=arguments[0];this._nv=new Uo(t.toSegmentStrings(e))};Wo.prototype.checkValid=function(){this._nv.checkValid()},Wo.prototype.interfaces_=function(){return[]},Wo.prototype.getClass=function(){return Wo},Wo.toSegmentStrings=function(t){for(var e=new xt,n=t.iterator();n.hasNext();){var o=n.next();e.add(new jo(o.getCoordinates(),o))}return e},Wo.checkValid=function(t){new Wo(t).checkValid()};var qo=function(t){this._mapOp=t};qo.prototype.map=function(t){for(var e=new xt,n=0;n<t.getNumGeometries();n++){var o=this._mapOp.map(t.getGeometryN(n));o.isEmpty()||e.add(o)}return t.getFactory().createGeometryCollection(ye.toGeometryArray(e))},qo.prototype.interfaces_=function(){return[]},qo.prototype.getClass=function(){return qo},qo.map=function(t,e){return new qo(e).map(t)};var Xo=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new xt,this._resultLineList=new xt;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Xo.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Xo.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Xo.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Xo.prototype.collectLineEdge=function(t,e,n){var o=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Rr.isResultOfOp(o,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Xo.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),o=n.getEdge();if(n.isLineEdge()&&!o.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());o.setCovered(r)}}},Xo.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),o=n.getLabel();n.isIsolated()&&(o.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Xo.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),o=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(o),n.setInResult(!0)}},Xo.prototype.collectBoundaryTouchEdge=function(t,e,n){var o=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Rr.isResultOfOp(o,e)&&e===Rr.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Xo.prototype.interfaces_=function(){return[]},Xo.prototype.getClass=function(){return Xo};var Yo=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new xt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Yo.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Yo.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!n.isInResult()&&!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===Rr.INTERSECTION)){var o=n.getLabel();Rr.isResultOfOp(o,t)&&this.filterCoveredNodeToPoint(n)}}},Yo.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Yo.prototype.interfaces_=function(){return[]},Yo.prototype.getClass=function(){return Yo};var Ko=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Ko.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Ko.prototype.transformPolygon=function(t,e){var n=!0,o=this.transformLinearRing(t.getExteriorRing(),t);null!==o&&o instanceof ee&&!o.isEmpty()||(n=!1);for(var r=new xt,i=0;i<t.getNumInteriorRing();i++){var s=this.transformLinearRing(t.getInteriorRingN(i),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(o,r.toArray([]));var a=new xt;return null!==o&&a.add(o),a.addAll(r),this._factory.buildGeometry(a)},Ko.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Ko.prototype.getInputGeometry=function(){return this._inputGeom},Ko.prototype.transformMultiLineString=function(t,e){for(var n=new xt,o=0;o<t.getNumGeometries();o++){var r=this.transformLineString(t.getGeometryN(o),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Ko.prototype.transformCoordinates=function(t,e){return this.copy(t)},Ko.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Ko.prototype.transformMultiPoint=function(t,e){for(var n=new xt,o=0;o<t.getNumGeometries();o++){var r=this.transformPoint(t.getGeometryN(o),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Ko.prototype.transformMultiPolygon=function(t,e){for(var n=new xt,o=0;o<t.getNumGeometries();o++){var r=this.transformPolygon(t.getGeometryN(o),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Ko.prototype.copy=function(t){return t.copy()},Ko.prototype.transformGeometryCollection=function(t,e){for(var n=new xt,o=0;o<t.getNumGeometries();o++){var r=this.transform(t.getGeometryN(o));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(ye.toGeometryArray(n)):this._factory.buildGeometry(n)},Ko.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Jt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Kt)return this.transformLineString(t,null);if(t instanceof Ht)return this.transformMultiLineString(t,null);if(t instanceof $t)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof jt)return this.transformGeometryCollection(t,null);throw new v("Unknown Geometry subtype: "+t.getClass().getName())},Ko.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var o=n.size();return o>0&&o<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Ko.prototype.interfaces_=function(){return[]},Ko.prototype.getClass=function(){return Ko};var Zo=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Kt&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],o=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=o}};Zo.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),o=0;o<n;o++){var r=t.get(o),i=this.findSnapForVertex(r,e);null!==i&&(t.set(o,new E(i)),0===o&&this._isClosed&&t.set(t.size()-1,new E(i)))}},Zo.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Zo.prototype.snapTo=function(t){var e=new St(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Zo.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var o=0;o<n;o++){var r=e[o],i=this.findSegmentIndexToSnap(r,t);i>=0&&t.add(i+1,new E(r),!1)}},Zo.prototype.findSegmentIndexToSnap=function(t,e){for(var n=_.MAX_VALUE,o=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var i=this._seg.distance(t);i<this._snapTolerance&&i<n&&(n=i,o=r)}return o},Zo.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo},Zo.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Jo=function(t){this._srcGeom=t||null},Qo={SNAP_PRECISION_FACTOR:{configurable:!0}};Jo.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new $o(e,n).transform(this._srcGeom)},Jo.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),o=new $o(t,n,!0).transform(this._srcGeom),r=o;return e&&I(r,Qt)&&(r=o.buffer(0)),r},Jo.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Jo.prototype.extractTargetCoordinates=function(t){for(var e=new d,n=t.getCoordinates(),o=0;o<n.length;o++)e.add(n[o]);return e.toArray(new Array(0).fill(null))},Jo.prototype.computeMinimumSegmentLength=function(t){for(var e=_.MAX_VALUE,n=0;n<t.length-1;n++){var o=t[n].distance(t[n+1]);o<e&&(e=o)}return e},Jo.prototype.interfaces_=function(){return[]},Jo.prototype.getClass=function(){return Jo},Jo.snap=function(t,e,n){var o=new Array(2).fill(null),r=new Jo(t);o[0]=r.snapTo(e,n);var i=new Jo(e);return o[1]=i.snapTo(o[0],n),o},Jo.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Jo.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===de.FIXED){var o=1/n.getScale()*2/1.415;o>e&&(e=o)}return e}if(2===arguments.length){var r=arguments[0],i=arguments[1];return Math.min(Jo.computeOverlaySnapTolerance(r),Jo.computeOverlaySnapTolerance(i))}},Jo.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Jo.SNAP_PRECISION_FACTOR},Jo.snapToSelf=function(t,e,n){return new Jo(t).snapToSelf(e,n)},Qo.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Jo,Qo);var $o=function(t){function e(e,n,o){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==o&&o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Zo(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),o=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(o)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ko),tr=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};tr.prototype.getCommon=function(){return _.longBitsToDouble(this._commonBits)},tr.prototype.add=function(t){var e=_.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=tr.signExpBits(this._commonBits),this._isFirst=!1,null):tr.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=tr.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=tr.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},tr.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=_.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+_.toBinaryString(t),o=n.substring(n.length-64);return o.substring(0,1)+"  "+o.substring(1,12)+"(exp) "+o.substring(12)+" [ "+e+" ]"}},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},tr.getBit=function(t,e){return 0!=(t&1<<e)?1:0},tr.signExpBits=function(t){return t>>52},tr.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},tr.numCommonMostSigMantissaBits=function(t,e){for(var n=0,o=52;o>=0;o--){if(tr.getBit(t,o)!==tr.getBit(e,o))return n;n++}return 52};var er=function(){this._commonCoord=null,this._ccFilter=new or},nr={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};er.prototype.addCommonBits=function(t){var e=new rr(this._commonCoord);t.apply(e),t.geometryChanged()},er.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new E(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new rr(e);return t.apply(n),t.geometryChanged(),t},er.prototype.getCommonCoordinate=function(){return this._commonCoord},er.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},er.prototype.interfaces_=function(){return[]},er.prototype.getClass=function(){return er},nr.CommonCoordinateFilter.get=function(){return or},nr.Translater.get=function(){return rr},Object.defineProperties(er,nr);var or=function(){this._commonBitsX=new tr,this._commonBitsY=new tr};or.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},or.prototype.getCommonCoordinate=function(){return new E(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},or.prototype.interfaces_=function(){return[dt]},or.prototype.getClass=function(){return or};var rr=function(){this.trans=null;var t=arguments[0];this.trans=t};rr.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,o=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,o)},rr.prototype.isDone=function(){return!1},rr.prototype.isGeometryChanged=function(){return!0},rr.prototype.interfaces_=function(){return[zt]},rr.prototype.getClass=function(){return rr};var ir=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};ir.prototype.selfSnap=function(t){return new Jo(t).snapTo(t,this._snapTolerance)},ir.prototype.removeCommonBits=function(t){this._cbr=new er,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},ir.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},ir.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Rr.overlayOp(e[0],e[1],t);return this.prepareResult(n)},ir.prototype.checkValid=function(t){t.isValid()||U.out.println("Snapped geometry is invalid")},ir.prototype.computeSnapTolerance=function(){this._snapTolerance=Jo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},ir.prototype.snap=function(t){var e=this.removeCommonBits(t);return Jo.snap(e[0],e[1],this._snapTolerance)},ir.prototype.interfaces_=function(){return[]},ir.prototype.getClass=function(){return ir},ir.overlayOp=function(t,e,n){return new ir(t,e).getResultGeometry(n)},ir.union=function(t,e){return ir.overlayOp(t,e,Rr.UNION)},ir.intersection=function(t,e){return ir.overlayOp(t,e,Rr.INTERSECTION)},ir.symDifference=function(t,e){return ir.overlayOp(t,e,Rr.SYMDIFFERENCE)},ir.difference=function(t,e){return ir.overlayOp(t,e,Rr.DIFFERENCE)};var sr=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};sr.prototype.getResultGeometry=function(t){var e=null,n=!1,o=null;try{e=Rr.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof $))throw t;o=t}if(!n)try{e=ir.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $?o:t}return e},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr},sr.overlayOp=function(t,e,n){return new sr(t,e).getResultGeometry(n)},sr.union=function(t,e){return sr.overlayOp(t,e,Rr.UNION)},sr.intersection=function(t,e){return sr.overlayOp(t,e,Rr.INTERSECTION)},sr.symDifference=function(t,e){return sr.overlayOp(t,e,Rr.SYMDIFFERENCE)},sr.difference=function(t,e){return sr.overlayOp(t,e,Rr.DIFFERENCE)};var ar=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};ar.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},ar.prototype.interfaces_=function(){return[]},ar.prototype.getClass=function(){return ar};var lr=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var o=arguments[0],r=arguments[1],i=arguments[2];this._eventType=t.INSERT,this._label=o,this._xValue=r,this._obj=i}},ur={INSERT:{configurable:!0},DELETE:{configurable:!0}};lr.prototype.isDelete=function(){return this._eventType===lr.DELETE},lr.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},lr.prototype.getObject=function(){return this._obj},lr.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},lr.prototype.getInsertEvent=function(){return this._insertEvent},lr.prototype.isInsert=function(){return this._eventType===lr.INSERT},lr.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},lr.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},lr.prototype.interfaces_=function(){return[w]},lr.prototype.getClass=function(){return lr},ur.INSERT.get=function(){return 1},ur.DELETE.get=function(){return 2},Object.defineProperties(lr,ur);var cr=function(){};cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr};var pr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};pr.prototype.isTrivialIntersection=function(t,e,n,o){if(t===n&&1===this._li.getIntersectionNum()){if(pr.isAdjacentSegments(e,o))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&o===r||0===o&&e===r)return!0}}return!1},pr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},pr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},pr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},pr.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var o=n.next().getCoordinate();if(t.isIntersection(o))return!0}return!1},pr.prototype.hasProperIntersection=function(){return this._hasProper},pr.prototype.hasIntersection=function(){return this._hasIntersection},pr.prototype.isDone=function(){return this._isDone},pr.prototype.isBoundaryPoint=function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},pr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},pr.prototype.addIntersections=function(t,e,n,o){if(t===n&&e===o)return null;this.numTests++;var r=t.getCoordinates()[e],i=t.getCoordinates()[e+1],s=n.getCoordinates()[o],a=n.getCoordinates()[o+1];this._li.computeIntersection(r,i,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,o)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,o,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr},pr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hr=function(t){function e(){t.call(this),this.events=new xt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){$e.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof pr&&I(arguments[0],bt)&&I(arguments[1],bt)){var o=arguments[0],r=arguments[1],i=arguments[2];this.addEdges(o,o),this.addEdges(r,r),this.computeIntersections(i)}else if("boolean"==typeof arguments[2]&&I(arguments[0],bt)&&arguments[1]instanceof pr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),o=n.getStartIndexes(),r=0;r<o.length-1;r++){var i=new ar(n,r),s=new lr(e,n.getMinX(r),i);this.events.add(s),this.events.add(new lr(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,o){for(var r=n.getObject(),i=t;i<e;i++){var s=this.events.get(i);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,o),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],o=arguments[0].iterator();o.hasNext();){var r=o.next();this.addEdge(r,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(cr),dr=function(){this._min=_.POSITIVE_INFINITY,this._max=_.NEGATIVE_INFINITY},fr={NodeComparator:{configurable:!0}};dr.prototype.getMin=function(){return this._min},dr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},dr.prototype.getMax=function(){return this._max},dr.prototype.toString=function(){return Q.toLineString(new E(this._min,0),new E(this._max,0))},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},fr.NodeComparator.get=function(){return gr},Object.defineProperties(dr,fr);var gr=function(){};gr.prototype.compare=function(t,e){var n=t,o=e,r=(n._min+n._max)/2,i=(o._min+o._max)/2;return r<i?-1:r>i?1:0},gr.prototype.interfaces_=function(){return[x]},gr.prototype.getClass=function(){return gr};var mr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],o=arguments[2];this._min=e,this._max=n,this._item=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(dr),yr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(dr),vr=function(){this._leaves=new xt,this._root=null,this._level=0};vr.prototype.buildTree=function(){$e.sort(this._leaves,new dr.NodeComparator);for(var t=this._leaves,e=null,n=new xt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},vr.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new mr(t,e,n))},vr.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},vr.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},vr.prototype.printNode=function(t){U.out.println(Q.toLineString(new E(t._min,this._level),new E(t._max,this._level)))},vr.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},vr.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var o=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(o);else{var r=new yr(t.get(n),t.get(n+1));e.add(r)}}},vr.prototype.interfaces_=function(){return[]},vr.prototype.getClass=function(){return vr};var _r=function(){this._items=new xt};_r.prototype.visitItem=function(t){this._items.add(t)},_r.prototype.getItems=function(){return this._items},_r.prototype.interfaces_=function(){return[Ke]},_r.prototype.getClass=function(){return _r};var Cr=function(){this._index=null;var t=arguments[0];if(!I(t,Qt))throw new v("Argument must be Polygonal");this._index=new xr(t)},wr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Cr.prototype.locate=function(t){var e=new st(t),n=new br(e);return this._index.query(t.y,t.y,n),e.getLocation()},Cr.prototype.interfaces_=function(){return[Vn]},Cr.prototype.getClass=function(){return Cr},wr.SegmentVisitor.get=function(){return br},wr.IntervalIndexedGeometry.get=function(){return xr},Object.defineProperties(Cr,wr);var br=function(){this._counter=null;var t=arguments[0];this._counter=t};br.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},br.prototype.interfaces_=function(){return[Ke]},br.prototype.getClass=function(){return br};var xr=function(){this._index=new vr;var t=arguments[0];this.init(t)};xr.prototype.init=function(t){for(var e=So.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},xr.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new gn(t[e-1],t[e]),o=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(o,r,n)}},xr.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new _r;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var o=arguments[0],r=arguments[1],i=arguments[2];this._index.query(o,r,i)}},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var Er=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new he,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new To,2===arguments.length){var e=arguments[0],n=arguments[1],o=ft.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=o,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=i,this._boundaryNodeRule=s,null!==i&&this.add(i)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var o=this._nodes.addNode(n).getLabel(),r=1;O.NONE,o.getLocation(t,Se.ON)===O.BOUNDARY&&r++;var i=e.determineBoundary(this._boundaryNodeRule,r);o.setLocation(t,i)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],o=arguments[2],r=new pr(arguments[0],!0,!1);r.setIsDoneIfProperInt(o);var i=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ee||this._parentGeom instanceof $t||this._parentGeom instanceof ne,a=n||!s;return i.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var o=new pr(e,n,!0);return o.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,o),o},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Jt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,O.INTERIOR)}else if(arguments[0]instanceof E){var e=arguments[0];this.insertPoint(this._argIndex,e,O.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),O.EXTERIOR,O.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,O.INTERIOR,O.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],O.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],O.BOUNDARY)},e.prototype.addLineString=function(t){var e=Tt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new no(e,new De(this._argIndex,O.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,o=t.iterator();o.hasNext();){var r=o.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===O.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var o=Tt.removeRepeatedPoints(t.getCoordinates());if(o.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=o[0],null;var r=e,i=n;at.isCCW(o)&&(r=n,i=e);var s=new no(o,new De(this._argIndex,O.BOUNDARY,r,i));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,o[0],O.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var o=this._nodes.addNode(e),r=o.getLabel();null===r?o._label=new De(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hr},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),o=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var i=r.next();this.addSelfIntersectionNode(t,i.coord,o)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof $t)this.addPolygon(e);else if(e instanceof Kt)this.addLineString(e);else if(e instanceof Jt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Ht)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof jt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return I(this._parentGeom,Qt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Cr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?O.BOUNDARY:O.INTERIOR},e}(Ue),Sr=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Er(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],o=ft.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Er(0,e,o),this._arg[1]=new Er(1,n,o)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Er(0,r,s),this._arg[1]=new Er(1,i,s)}};Sr.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Sr.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr};var Tr=function(){};Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Tr.map=function(){if(arguments[0]instanceof ct&&I(arguments[1],Tr.MapOp)){for(var t=arguments[0],e=arguments[1],n=new xt,o=0;o<t.getNumGeometries();o++){var r=e.map(t.getGeometryN(o));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(I(arguments[0],Ct)&&I(arguments[1],Tr.MapOp)){for(var i=arguments[0],s=arguments[1],a=new xt,l=i.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},Tr.MapOp=function(){};var Rr=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new To,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Xn,this._resultPolyList=new xt,this._resultLineList=new xt,this._resultPointList=new xt,this._graph=new Ue(new Wn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),o=t.getLabel();e.isPointwiseEqual(t)||(o=new De(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(o),n.merge(o)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,o,r){var i=new xt;return i.addAll(t),i.addAll(n),i.addAll(o),i.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(i)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var o=n.next();if(this._ptLocator.locate(t,o)!==O.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new xt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new xt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Wo.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new We(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var o=new Xo(this,this._geomFact,this._ptLocator);this._resultLineList=o.build(t);var r=new Yo(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var o=n.next(),r=o.getLabel();r.isArea()&&!o.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Se.RIGHT),r.getLocation(1,Se.RIGHT),t)&&o.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),o=e.getDepth();if(!o.isNull()){o.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||o.isNull(r)||(0===o.getDelta(r)?n.toLine(r):(et.isTrue(!o.isNull(r,Se.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Se.LEFT,o.getLocation(r,Se.LEFT)),et.isTrue(!o.isNull(r,Se.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Se.RIGHT,o.getLocation(r,Se.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Sr);Rr.overlayOp=function(t,e,n){return new Rr(t,e).getResultGeometry(n)},Rr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Rr.createEmptyResult(Rr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return qo.map(t,{interfaces_:function(){return[Tr.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Rr.INTERSECTION)},Rr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Rr.createEmptyResult(Rr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Rr.SYMDIFFERENCE)},Rr.resultDimension=function(t,e,n){var o=e.getDimension(),r=n.getDimension(),i=-1;switch(t){case Rr.INTERSECTION:i=Math.min(o,r);break;case Rr.UNION:i=Math.max(o,r);break;case Rr.DIFFERENCE:i=o;break;case Rr.SYMDIFFERENCE:i=Math.max(o,r)}return i},Rr.createEmptyResult=function(t,e,n,o){var r=null;switch(Rr.resultDimension(t,e,n)){case-1:r=o.createGeometryCollection(new Array(0).fill(null));break;case 0:r=o.createPoint();break;case 1:r=o.createLineString();break;case 2:r=o.createPolygon()}return r},Rr.difference=function(t,e){return t.isEmpty()?Rr.createEmptyResult(Rr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Rr.DIFFERENCE))},Rr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),o=t.getLocation(1);return Rr.isResultOfOp(n,o,e)}if(3===arguments.length){var r=arguments[0],i=arguments[1],s=arguments[2];switch(r===O.BOUNDARY&&(r=O.INTERIOR),i===O.BOUNDARY&&(i=O.INTERIOR),s){case Rr.INTERSECTION:return r===O.INTERIOR&&i===O.INTERIOR;case Rr.UNION:return r===O.INTERIOR||i===O.INTERIOR;case Rr.DIFFERENCE:return r===O.INTERIOR&&i!==O.INTERIOR;case Rr.SYMDIFFERENCE:return r===O.INTERIOR&&i!==O.INTERIOR||r!==O.INTERIOR&&i===O.INTERIOR}return!1}},Rr.INTERSECTION=1,Rr.UNION=2,Rr.DIFFERENCE=3,Rr.SYMDIFFERENCE=4;var Or=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new To,this._seg=new gn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Or.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),o=0;o<n.size()-1;o++)if(n.getCoordinate(o,this._seg.p0),n.getCoordinate(o+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Or.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?O.BOUNDARY:this._ptLocator.locate(t,this._g)},Or.prototype.extractLinework=function(t){var e=new Pr;t.apply(e);var n=e.getLinework(),o=ye.toLineStringArray(n);return t.getFactory().createMultiLineString(o)},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or};var Pr=function(){this._linework=null,this._linework=new xt};Pr.prototype.getLinework=function(){return this._linework},Pr.prototype.filter=function(t){if(t instanceof $t){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Pr.prototype.interfaces_=function(){return[Vt]},Pr.prototype.getClass=function(){return Pr};var Ir=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Ir.prototype.extractPoints=function(t,e,n){for(var o=t.getCoordinates(),r=0;r<o.length-1;r++)this.computeOffsetPoints(o[r],o[r+1],e,n)},Ir.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Ir.prototype.getPoints=function(t){for(var e=new xt,n=So.getLines(this._g).iterator();n.hasNext();){var o=n.next();this.extractPoints(o,t,e)}return e},Ir.prototype.computeOffsetPoints=function(t,e,n,o){var r=e.x-t.x,i=e.y-t.y,s=Math.sqrt(r*r+i*i),a=n*r/s,l=n*i/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var p=new E(u-l,c+a);o.add(p)}if(this._doRight){var h=new E(u+l,c-a);o.add(h)}},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir};var Ar=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new xt;var e=arguments[0],n=arguments[1],o=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,o],this._locFinder=[new Or(this._geom[0],this._boundaryDistanceTolerance),new Or(this._geom[1],this._boundaryDistanceTolerance),new Or(this._geom[2],this._boundaryDistanceTolerance)]},Dr={TOLERANCE:{configurable:!0}};Ar.prototype.reportResult=function(t,e,n){U.out.println("Overlay result invalid - A:"+O.toLocationSymbol(e[0])+" B:"+O.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+O.toLocationSymbol(e[2]))},Ar.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Ar.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var o=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Ar.hasLocation(this._location,O.BOUNDARY)||this.isValidResult(o,this._location)}},Ar.prototype.addTestPts=function(t){var e=new Ir(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Ar.prototype.isValidResult=function(t,e){var n=Rr.isResultOfOp(e[0],e[1],t),o=!(n^e[2]===O.INTERIOR);return o||this.reportResult(t,e,n),o},Ar.prototype.getInvalidLocation=function(){return this._invalidLocation},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar},Ar.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Ar.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Jo.computeSizeBasedSnapTolerance(t),Jo.computeSizeBasedSnapTolerance(e))},Ar.isValid=function(t,e,n,o){return new Ar(t,e,o).isValid(n)},Dr.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Ar,Dr);var Mr=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Mr.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var o=t.getGeometryN(n);this._skipEmpty&&o.isEmpty()||e.add(o)}},Mr.prototype.combine=function(){for(var t=new xt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Mr.prototype.interfaces_=function(){return[]},Mr.prototype.getClass=function(){return Mr},Mr.combine=function(){if(1===arguments.length)return new Mr(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Mr(Mr.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],o=arguments[1],r=arguments[2];return new Mr(Mr.createList(n,o,r)).combine()}},Mr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Mr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new xt;return n.add(t),n.add(e),n}if(3===arguments.length){var o=arguments[0],r=arguments[1],i=arguments[2],s=new xt;return s.add(o),s.add(r),s.add(i),s}};var Lr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new xt)},Nr={STRTREE_NODE_CAPACITY:{configurable:!0}};Lr.prototype.reduceToGeometries=function(t){for(var e=new xt,n=t.iterator();n.hasNext();){var o=n.next(),r=null;I(o,bt)?r=this.unionTree(o):o instanceof ct&&(r=o),e.add(r)}return e},Lr.prototype.extractByEnvelope=function(t,e,n){for(var o=new xt,r=0;r<e.getNumGeometries();r++){var i=e.getGeometryN(r);i.getEnvelopeInternal().intersects(t)?o.add(i):n.add(i)}return this._geomFactory.buildGeometry(o)},Lr.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),o=e.getEnvelopeInternal();if(!n.intersects(o))return Mr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(o);return this.unionUsingEnvelopeIntersection(t,e,r)},Lr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Lr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var o=t.itemsTree();return this.unionTree(o)},Lr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],o=arguments[2];if(o-n<=1){var r=Lr.getGeometry(e,n);return this.unionSafe(r,null)}if(o-n==2)return this.unionSafe(Lr.getGeometry(e,n),Lr.getGeometry(e,n+1));var i=Math.trunc((o+n)/2),s=this.binaryUnion(e,n,i),a=this.binaryUnion(e,i,o);return this.unionSafe(s,a)}},Lr.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var o=n.next();e=null===e?o.copy():e.union(o)}return e},Lr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Lr.prototype.unionActual=function(t,e){return Lr.restrictToPolygons(t.union(e))},Lr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Lr.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var o=new xt,r=this.extractByEnvelope(n,t,o),i=this.extractByEnvelope(n,e,o),s=this.unionActual(r,i);return o.add(s),Mr.combine(o)},Lr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.restrictToPolygons=function(t){if(I(t,Qt))return t;var e=Eo.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(ye.toPolygonArray(e))},Lr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Lr.union=function(t){return new Lr(t).union()},Nr.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Lr,Nr);var Fr=function(){};Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr},Fr.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Rr.createEmptyResult(Rr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),sr.overlayOp(t,e,Rr.UNION)},t.GeoJSONReader=xe,t.GeoJSONWriter=Ee,t.OverlayOp=Rr,t.UnionOp=Fr,t.BufferOp=mo,Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=n(2791),e=n(4164);function o(t,e){return function(){return t.apply(e,arguments)}}const{toString:r}=Object.prototype,{getPrototypeOf:i}=Object,s=(a=Object.create(null),t=>{const e=r.call(t);return a[e]||(a[e]=e.slice(8,-1).toLowerCase())});var a;const l=t=>(t=t.toLowerCase(),e=>s(e)===t),u=t=>e=>typeof e===t,{isArray:c}=Array,p=u("undefined");const h=l("ArrayBuffer");const d=u("string"),f=u("function"),g=u("number"),m=t=>null!==t&&"object"===typeof t,y=t=>{if("object"!==s(t))return!1;const e=i(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},v=l("Date"),_=l("File"),C=l("Blob"),w=l("FileList"),b=l("URLSearchParams");function x(t,e){let n,o,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),c(t))for(n=0,o=t.length;n<o;n++)e.call(null,t[n],n,t);else{const o=r?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length;let s;for(n=0;n<i;n++)s=o[n],e.call(null,t[s],s,t)}}function E(t,e){e=e.toLowerCase();const n=Object.keys(t);let o,r=n.length;for(;r-- >0;)if(o=n[r],e===o.toLowerCase())return o;return null}const S="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,T=t=>!p(t)&&t!==S;const R=(O="undefined"!==typeof Uint8Array&&i(Uint8Array),t=>O&&t instanceof O);var O;const P=l("HTMLFormElement"),I=(t=>{let{hasOwnProperty:e}=t;return(t,n)=>e.call(t,n)})(Object.prototype),A=l("RegExp"),D=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),o={};x(n,((n,r)=>{let i;!1!==(i=e(n,r,t))&&(o[r]=i||n)})),Object.defineProperties(t,o)},M="abcdefghijklmnopqrstuvwxyz",L="0123456789",N={DIGIT:L,ALPHA:M,ALPHA_DIGIT:M+M.toUpperCase()+L};const F=l("AsyncFunction"),k={isArray:c,isArrayBuffer:h,isBuffer:function(t){return null!==t&&!p(t)&&null!==t.constructor&&!p(t.constructor)&&f(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||f(t.append)&&("formdata"===(e=s(t))||"object"===e&&f(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&h(t.buffer),e},isString:d,isNumber:g,isBoolean:t=>!0===t||!1===t,isObject:m,isPlainObject:y,isUndefined:p,isDate:v,isFile:_,isBlob:C,isRegExp:A,isFunction:f,isStream:t=>m(t)&&f(t.pipe),isURLSearchParams:b,isTypedArray:R,isFileList:w,forEach:x,merge:function t(){const{caseless:e}=T(this)&&this||{},n={},o=(o,r)=>{const i=e&&E(n,r)||r;y(n[i])&&y(o)?n[i]=t(n[i],o):y(o)?n[i]=t({},o):c(o)?n[i]=o.slice():n[i]=o};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&x(arguments[r],o);return n},extend:function(t,e,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return x(e,((e,r)=>{n&&f(e)?t[r]=o(e,n):t[r]=e}),{allOwnKeys:r}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,o)=>{t.prototype=Object.create(e.prototype,o),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,o)=>{let r,s,a;const l={};if(e=e||{},null==t)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)a=r[s],o&&!o(a,t,e)||l[a]||(e[a]=t[a],l[a]=!0);t=!1!==n&&i(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:s,kindOfTest:l,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const o=t.indexOf(e,n);return-1!==o&&o===n},toArray:t=>{if(!t)return null;if(c(t))return t;let e=t.length;if(!g(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let o;for(;(o=n.next())&&!o.done;){const n=o.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const o=[];for(;null!==(n=t.exec(e));)o.push(n);return o},isHTMLForm:P,hasOwnProperty:I,hasOwnProp:I,reduceDescriptors:D,freezeMethods:t=>{D(t,((e,n)=>{if(f(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const o=t[n];f(o)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(t,e)=>{const n={},o=t=>{t.forEach((t=>{n[t]=!0}))};return c(t)?o(t):o(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,n){return e.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(t,e)=>(t=+t,Number.isFinite(t)?t:e),findKey:E,global:S,isContextDefined:T,ALPHABET:N,generateString:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.ALPHA_DIGIT,n="";const{length:o}=e;for(;t--;)n+=e[Math.random()*o|0];return n},isSpecCompliantForm:function(t){return!!(t&&f(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),n=(t,o)=>{if(m(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[o]=t;const r=c(t)?[]:{};return x(t,((t,e)=>{const i=n(t,o+1);!p(i)&&(r[e]=i)})),e[o]=void 0,r}}return t};return n(t,0)},isAsyncFn:F,isThenable:t=>t&&(m(t)||f(t))&&f(t.then)&&f(t.catch)};function G(t,e,n,o,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),o&&(this.request=o),r&&(this.response=r)}k.inherits(G,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:k.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const B=G.prototype,V={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{V[t]={value:t}})),Object.defineProperties(G,V),Object.defineProperty(B,"isAxiosError",{value:!0}),G.from=(t,e,n,o,r,i)=>{const s=Object.create(B);return k.toFlatObject(t,s,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),G.call(s,t.message,e,n,o,r),s.cause=t,s.name=t.name,i&&Object.assign(s,i),s};const z=G;function j(t){return k.isPlainObject(t)||k.isArray(t)}function H(t){return k.endsWith(t,"[]")?t.slice(0,-2):t}function U(t,e,n){return t?t.concat(e).map((function(t,e){return t=H(t),!n&&e?"["+t+"]":t})).join(n?".":""):e}const W=k.toFlatObject(k,{},null,(function(t){return/^is[A-Z]/.test(t)}));const q=function(t,e,n){if(!k.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const o=(n=k.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!k.isUndefined(e[t])}))).metaTokens,r=n.visitor||u,i=n.dots,s=n.indexes,a=(n.Blob||"undefined"!==typeof Blob&&Blob)&&k.isSpecCompliantForm(e);if(!k.isFunction(r))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(k.isDate(t))return t.toISOString();if(!a&&k.isBlob(t))throw new z("Blob is not supported. Use a Buffer instead.");return k.isArrayBuffer(t)||k.isTypedArray(t)?a&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function u(t,n,r){let a=t;if(t&&!r&&"object"===typeof t)if(k.endsWith(n,"{}"))n=o?n:n.slice(0,-2),t=JSON.stringify(t);else if(k.isArray(t)&&function(t){return k.isArray(t)&&!t.some(j)}(t)||(k.isFileList(t)||k.endsWith(n,"[]"))&&(a=k.toArray(t)))return n=H(n),a.forEach((function(t,o){!k.isUndefined(t)&&null!==t&&e.append(!0===s?U([n],o,i):null===s?n:n+"[]",l(t))})),!1;return!!j(t)||(e.append(U(r,n,i),l(t)),!1)}const c=[],p=Object.assign(W,{defaultVisitor:u,convertValue:l,isVisitable:j});if(!k.isObject(t))throw new TypeError("data must be an object");return function t(n,o){if(!k.isUndefined(n)){if(-1!==c.indexOf(n))throw Error("Circular reference detected in "+o.join("."));c.push(n),k.forEach(n,(function(n,i){!0===(!(k.isUndefined(n)||null===n)&&r.call(e,n,k.isString(i)?i.trim():i,o,p))&&t(n,o?o.concat(i):[i])})),c.pop()}}(t),e};function X(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function Y(t,e){this._pairs=[],t&&q(t,this,e)}const K=Y.prototype;K.append=function(t,e){this._pairs.push([t,e])},K.toString=function(t){const e=t?function(e){return t.call(this,e,X)}:X;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const Z=Y;function J(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Q(t,e,n){if(!e)return t;const o=n&&n.encode||J,r=n&&n.serialize;let i;if(i=r?r(e,n):k.isURLSearchParams(e)?e.toString():new Z(e,n).toString(o),i){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}const $=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){k.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},tt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},et={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Z,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let t;return("undefined"===typeof navigator||"ReactNative"!==(t=navigator.product)&&"NativeScript"!==t&&"NS"!==t)&&("undefined"!==typeof window&&"undefined"!==typeof document)})(),isStandardBrowserWebWorkerEnv:"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};const nt=function(t){function e(t,n,o,r){let i=t[r++];const s=Number.isFinite(+i),a=r>=t.length;if(i=!i&&k.isArray(o)?o.length:i,a)return k.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!s;o[i]&&k.isObject(o[i])||(o[i]=[]);return e(t,n,o[i],r)&&k.isArray(o[i])&&(o[i]=function(t){const e={},n=Object.keys(t);let o;const r=n.length;let i;for(o=0;o<r;o++)i=n[o],e[i]=t[i];return e}(o[i])),!s}if(k.isFormData(t)&&k.isFunction(t.entries)){const n={};return k.forEachEntry(t,((t,o)=>{e(function(t){return k.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),o,n,0)})),n}return null};const ot={transitional:tt,adapter:["xhr","http"],transformRequest:[function(t,e){const n=e.getContentType()||"",o=n.indexOf("application/json")>-1,r=k.isObject(t);r&&k.isHTMLForm(t)&&(t=new FormData(t));if(k.isFormData(t))return o&&o?JSON.stringify(nt(t)):t;if(k.isArrayBuffer(t)||k.isBuffer(t)||k.isStream(t)||k.isFile(t)||k.isBlob(t))return t;if(k.isArrayBufferView(t))return t.buffer;if(k.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return q(t,new et.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,o){return et.isNode&&k.isBuffer(t)?(this.append(e,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((i=k.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return q(i?{"files[]":t}:t,e&&new e,this.formSerializer)}}return r||o?(e.setContentType("application/json",!1),function(t,e,n){if(k.isString(t))try{return(e||JSON.parse)(t),k.trim(t)}catch(o){if("SyntaxError"!==o.name)throw o}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||ot.transitional,n=e&&e.forcedJSONParsing,o="json"===this.responseType;if(t&&k.isString(t)&&(n&&!this.responseType||o)){const n=!(e&&e.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(r){if(n){if("SyntaxError"===r.name)throw z.from(r,z.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:et.classes.FormData,Blob:et.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};k.forEach(["delete","get","head","post","put","patch"],(t=>{ot.headers[t]={}}));const rt=ot,it=k.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),st=Symbol("internals");function at(t){return t&&String(t).trim().toLowerCase()}function lt(t){return!1===t||null==t?t:k.isArray(t)?t.map(lt):String(t)}function ut(t,e,n,o,r){return k.isFunction(o)?o.call(this,e,n):(r&&(e=n),k.isString(e)?k.isString(o)?-1!==e.indexOf(o):k.isRegExp(o)?o.test(e):void 0:void 0)}class ct{constructor(t){t&&this.set(t)}set(t,e,n){const o=this;function r(t,e,n){const r=at(e);if(!r)throw new Error("header name must be a non-empty string");const i=k.findKey(o,r);(!i||void 0===o[i]||!0===n||void 0===n&&!1!==o[i])&&(o[i||e]=lt(t))}const i=(t,e)=>k.forEach(t,((t,n)=>r(t,n,e)));return k.isPlainObject(t)||t instanceof this.constructor?i(t,e):k.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim())?i((t=>{const e={};let n,o,r;return t&&t.split("\n").forEach((function(t){r=t.indexOf(":"),n=t.substring(0,r).trim().toLowerCase(),o=t.substring(r+1).trim(),!n||e[n]&&it[n]||("set-cookie"===n?e[n]?e[n].push(o):e[n]=[o]:e[n]=e[n]?e[n]+", "+o:o)})),e})(t),e):null!=t&&r(e,t,n),this}get(t,e){if(t=at(t)){const n=k.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(t);)e[o[1]]=o[2];return e}(t);if(k.isFunction(e))return e.call(this,t,n);if(k.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=at(t)){const n=k.findKey(this,t);return!(!n||void 0===this[n]||e&&!ut(0,this[n],n,e))}return!1}delete(t,e){const n=this;let o=!1;function r(t){if(t=at(t)){const r=k.findKey(n,t);!r||e&&!ut(0,n[r],r,e)||(delete n[r],o=!0)}}return k.isArray(t)?t.forEach(r):r(t),o}clear(t){const e=Object.keys(this);let n=e.length,o=!1;for(;n--;){const r=e[n];t&&!ut(0,this[r],r,t,!0)||(delete this[r],o=!0)}return o}normalize(t){const e=this,n={};return k.forEach(this,((o,r)=>{const i=k.findKey(n,r);if(i)return e[i]=lt(o),void delete e[r];const s=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,n)=>e.toUpperCase()+n))}(r):String(r).trim();s!==r&&delete e[r],e[s]=lt(o),n[s]=!0})),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return k.forEach(this,((n,o)=>{null!=n&&!1!==n&&(e[o]=t&&k.isArray(n)?n.join(", "):n)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((t=>{let[e,n]=t;return e+": "+n})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return o.forEach((t=>e.set(t))),e}static accessor(t){const e=(this[st]=this[st]={accessors:{}}).accessors,n=this.prototype;function o(t){const o=at(t);e[o]||(!function(t,e){const n=k.toCamelCase(" "+e);["get","set","has"].forEach((o=>{Object.defineProperty(t,o+n,{value:function(t,n,r){return this[o].call(this,e,t,n,r)},configurable:!0})}))}(n,t),e[o]=!0)}return k.isArray(t)?t.forEach(o):o(t),this}}ct.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),k.reduceDescriptors(ct.prototype,((t,e)=>{let{value:n}=t,o=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(t){this[o]=t}}})),k.freezeMethods(ct);const pt=ct;function ht(t,e){const n=this||rt,o=e||n,r=pt.from(o.headers);let i=o.data;return k.forEach(t,(function(t){i=t.call(n,i,r.normalize(),e?e.status:void 0)})),r.normalize(),i}function dt(t){return!(!t||!t.__CANCEL__)}function ft(t,e,n){z.call(this,null==t?"canceled":t,z.ERR_CANCELED,e,n),this.name="CanceledError"}k.inherits(ft,z,{__CANCEL__:!0});const gt=ft;const mt=et.isStandardBrowserEnv?{write:function(t,e,n,o,r,i){const s=[];s.push(t+"="+encodeURIComponent(e)),k.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),k.isString(o)&&s.push("path="+o),k.isString(r)&&s.push("domain="+r),!0===i&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function yt(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const vt=et.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function o(n){let o=n;return t&&(e.setAttribute("href",o),o=e.href),e.setAttribute("href",o),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return n=o(window.location.href),function(t){const e=k.isString(t)?o(t):t;return e.protocol===n.protocol&&e.host===n.host}}():function(){return!0};const _t=function(t,e){t=t||10;const n=new Array(t),o=new Array(t);let r,i=0,s=0;return e=void 0!==e?e:1e3,function(a){const l=Date.now(),u=o[s];r||(r=l),n[i]=a,o[i]=l;let c=s,p=0;for(;c!==i;)p+=n[c++],c%=t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),l-r<e)return;const h=u&&l-u;return h?Math.round(1e3*p/h):void 0}};function Ct(t,e){let n=0;const o=_t(50,250);return r=>{const i=r.loaded,s=r.lengthComputable?r.total:void 0,a=i-n,l=o(a);n=i;const u={loaded:i,total:s,progress:s?i/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&i<=s?(s-i)/l:void 0,event:r};u[e?"download":"upload"]=!0,t(u)}}const wt={http:null,xhr:"undefined"!==typeof XMLHttpRequest&&function(t){return new Promise((function(e,n){let o=t.data;const r=pt.from(t.headers).normalize(),i=t.responseType;let s,a;function l(){t.cancelToken&&t.cancelToken.unsubscribe(s),t.signal&&t.signal.removeEventListener("abort",s)}k.isFormData(o)&&(et.isStandardBrowserEnv||et.isStandardBrowserWebWorkerEnv?r.setContentType(!1):r.getContentType(/^\s*multipart\/form-data/)?k.isString(a=r.getContentType())&&r.setContentType(a.replace(/^\s*(multipart\/form-data);+/,"$1")):r.setContentType("multipart/form-data"));let u=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",n=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";r.set("Authorization","Basic "+btoa(e+":"+n))}const c=yt(t.baseURL,t.url);function p(){if(!u)return;const o=pt.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());!function(t,e,n){const o=n.config.validateStatus;n.status&&o&&!o(n.status)?e(new z("Request failed with status code "+n.status,[z.ERR_BAD_REQUEST,z.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}((function(t){e(t),l()}),(function(t){n(t),l()}),{data:i&&"text"!==i&&"json"!==i?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:o,config:t,request:u}),u=null}if(u.open(t.method.toUpperCase(),Q(c,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,"onloadend"in u?u.onloadend=p:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(p)},u.onabort=function(){u&&(n(new z("Request aborted",z.ECONNABORTED,t,u)),u=null)},u.onerror=function(){n(new z("Network Error",z.ERR_NETWORK,t,u)),u=null},u.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const o=t.transitional||tt;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(new z(e,o.clarifyTimeoutError?z.ETIMEDOUT:z.ECONNABORTED,t,u)),u=null},et.isStandardBrowserEnv){const e=(t.withCredentials||vt(c))&&t.xsrfCookieName&&mt.read(t.xsrfCookieName);e&&r.set(t.xsrfHeaderName,e)}void 0===o&&r.setContentType(null),"setRequestHeader"in u&&k.forEach(r.toJSON(),(function(t,e){u.setRequestHeader(e,t)})),k.isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),i&&"json"!==i&&(u.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&u.addEventListener("progress",Ct(t.onDownloadProgress,!0)),"function"===typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",Ct(t.onUploadProgress)),(t.cancelToken||t.signal)&&(s=e=>{u&&(n(!e||e.type?new gt(null,t,u):e),u.abort(),u=null)},t.cancelToken&&t.cancelToken.subscribe(s),t.signal&&(t.signal.aborted?s():t.signal.addEventListener("abort",s)));const h=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(c);h&&-1===et.protocols.indexOf(h)?n(new z("Unsupported protocol "+h+":",z.ERR_BAD_REQUEST,t)):u.send(o||null)}))}};k.forEach(wt,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}}));const bt=t=>"- ".concat(t),xt=t=>k.isFunction(t)||null===t||!1===t,Et=t=>{t=k.isArray(t)?t:[t];const{length:e}=t;let n,o;const r={};for(let i=0;i<e;i++){let e;if(n=t[i],o=n,!xt(n)&&(o=wt[(e=String(n)).toLowerCase()],void 0===o))throw new z("Unknown adapter '".concat(e,"'"));if(o)break;r[e||"#"+i]=o}if(!o){const t=Object.entries(r).map((t=>{let[e,n]=t;return"adapter ".concat(e," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=e?t.length>1?"since :\n"+t.map(bt).join("\n"):" "+bt(t[0]):"as no adapter specified";throw new z("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return o};function St(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new gt(null,t)}function Tt(t){St(t),t.headers=pt.from(t.headers),t.data=ht.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return Et(t.adapter||rt.adapter)(t).then((function(e){return St(t),e.data=ht.call(t,t.transformResponse,e),e.headers=pt.from(e.headers),e}),(function(e){return dt(e)||(St(t),e&&e.response&&(e.response.data=ht.call(t,t.transformResponse,e.response),e.response.headers=pt.from(e.response.headers))),Promise.reject(e)}))}const Rt=t=>t instanceof pt?t.toJSON():t;function Ot(t,e){e=e||{};const n={};function o(t,e,n){return k.isPlainObject(t)&&k.isPlainObject(e)?k.merge.call({caseless:n},t,e):k.isPlainObject(e)?k.merge({},e):k.isArray(e)?e.slice():e}function r(t,e,n){return k.isUndefined(e)?k.isUndefined(t)?void 0:o(void 0,t,n):o(t,e,n)}function i(t,e){if(!k.isUndefined(e))return o(void 0,e)}function s(t,e){return k.isUndefined(e)?k.isUndefined(t)?void 0:o(void 0,t):o(void 0,e)}function a(n,r,i){return i in e?o(n,r):i in t?o(void 0,n):void 0}const l={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(t,e)=>r(Rt(t),Rt(e),!0)};return k.forEach(Object.keys(Object.assign({},t,e)),(function(o){const i=l[o]||r,s=i(t[o],e[o],o);k.isUndefined(s)&&i!==a||(n[o]=s)})),n}const Pt="1.5.1",It={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{It[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));const At={};It.transitional=function(t,e,n){function o(t,e){return"[Axios v1.5.1] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,r,i)=>{if(!1===t)throw new z(o(r," has been removed"+(e?" in "+e:"")),z.ERR_DEPRECATED);return e&&!At[r]&&(At[r]=!0,console.warn(o(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,r,i)}};const Dt={assertOptions:function(t,e,n){if("object"!==typeof t)throw new z("options must be an object",z.ERR_BAD_OPTION_VALUE);const o=Object.keys(t);let r=o.length;for(;r-- >0;){const i=o[r],s=e[i];if(s){const e=t[i],n=void 0===e||s(e,i,t);if(!0!==n)throw new z("option "+i+" must be "+n,z.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new z("Unknown option "+i,z.ERR_BAD_OPTION)}},validators:It},Mt=Dt.validators;class Lt{constructor(t){this.defaults=t,this.interceptors={request:new $,response:new $}}request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=Ot(this.defaults,e);const{transitional:n,paramsSerializer:o,headers:r}=e;void 0!==n&&Dt.assertOptions(n,{silentJSONParsing:Mt.transitional(Mt.boolean),forcedJSONParsing:Mt.transitional(Mt.boolean),clarifyTimeoutError:Mt.transitional(Mt.boolean)},!1),null!=o&&(k.isFunction(o)?e.paramsSerializer={serialize:o}:Dt.assertOptions(o,{encode:Mt.function,serialize:Mt.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let i=r&&k.merge(r.common,r[e.method]);r&&k.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete r[t]})),e.headers=pt.concat(i,r);const s=[];let a=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,s.unshift(t.fulfilled,t.rejected))}));const l=[];let u;this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)}));let c,p=0;if(!a){const t=[Tt.bind(this),void 0];for(t.unshift.apply(t,s),t.push.apply(t,l),c=t.length,u=Promise.resolve(e);p<c;)u=u.then(t[p++],t[p++]);return u}c=s.length;let h=e;for(p=0;p<c;){const t=s[p++],e=s[p++];try{h=t(h)}catch(d){e.call(this,d);break}}try{u=Tt.call(this,h)}catch(d){return Promise.reject(d)}for(p=0,c=l.length;p<c;)u=u.then(l[p++],l[p++]);return u}getUri(t){return Q(yt((t=Ot(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}k.forEach(["delete","get","head","options"],(function(t){Lt.prototype[t]=function(e,n){return this.request(Ot(n||{},{method:t,url:e,data:(n||{}).data}))}})),k.forEach(["post","put","patch"],(function(t){function e(e){return function(n,o,r){return this.request(Ot(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}Lt.prototype[t]=e(),Lt.prototype[t+"Form"]=e(!0)}));const Nt=Lt;class Ft{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const n=this;this.promise.then((t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null})),this.promise.then=t=>{let e;const o=new Promise((t=>{n.subscribe(t),e=t})).then(t);return o.cancel=function(){n.unsubscribe(e)},o},t((function(t,o,r){n.reason||(n.reason=new gt(t,o,r),e(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;return{token:new Ft((function(e){t=e})),cancel:t}}}const kt=Ft;const Gt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Gt).forEach((t=>{let[e,n]=t;Gt[n]=e}));const Bt=Gt;const Vt=function t(e){const n=new Nt(e),r=o(Nt.prototype.request,n);return k.extend(r,Nt.prototype,n,{allOwnKeys:!0}),k.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return t(Ot(e,n))},r}(rt);Vt.Axios=Nt,Vt.CanceledError=gt,Vt.CancelToken=kt,Vt.isCancel=dt,Vt.VERSION=Pt,Vt.toFormData=q,Vt.AxiosError=z,Vt.Cancel=Vt.CanceledError,Vt.all=function(t){return Promise.all(t)},Vt.spread=function(t){return function(e){return t.apply(null,e)}},Vt.isAxiosError=function(t){return k.isObject(t)&&!0===t.isAxiosError},Vt.mergeConfig=Ot,Vt.AxiosHeaders=pt,Vt.formToJSON=t=>nt(k.isHTMLForm(t)?new FormData(t):t),Vt.getAdapter=Et,Vt.HttpStatusCode=Bt,Vt.default=Vt;const zt=Vt;var jt=n(5483),Ht=n.n(jt),Ut=n(184);const Wt=function(){const t=["#53ca57","#ffe252","#fa890f","#eb3333","#900101e3","#ffffff"];return(0,Ut.jsx)("nav",{className:"legend",children:(0,Ut.jsxs)("div",{className:"legend-container",children:[["Phase 1","Phase 2","Phase 3","Phase 4","Phase 5","No data"].map(((e,n)=>(0,Ut.jsxs)("div",{className:"legend-item",children:[(0,Ut.jsx)("span",{className:"legend-key",style:{backgroundColor:t[n]}}),(0,Ut.jsx)("span",{className:"legend-value",children:e})]},n))),(0,Ut.jsxs)("div",{className:"legend-item",children:[(0,Ut.jsx)("img",{className:"legend-image",src:"/food-security2/images/stripes2.jpg",alt:"stripes",width:"20",height:"20"}),(0,Ut.jsx)("span",{className:"legend-value",children:"Inaccessible Protocole"})]})]})})};function qt(t){return t?t.toLocaleString("en-US",{maximumFractionDigits:0}):""}function Xt(t,e){return(e?(t||0)/e*100:0).toFixed(2)}const Yt=function(e){let{countryData:n,level1Data:o,level2Data:r,regionInfo:i,selectedYear:s,selectedMonth:a}=e;const[l,u]=(0,t.useState)([]);if((0,t.useEffect)((()=>{if(n&&o&&r){const t=[...n.features,...o.features,...r.features];u(t)}}),[i]),!i)return null;const c=i.key;let p=null;l&&(p=l.find((t=>t.properties.Key===c)));const h=p?p.properties:{};let d;d=11==a?"11":"0".concat(a);const f=h.Name_2,g=qt(h["POP-".concat(s,"-").concat(d)]),m=qt(h["PH1-".concat(s,"-").concat(d)]),y=Xt(parseFloat(h["PH1-".concat(s,"-").concat(d)]),parseFloat(h["POP-".concat(s,"-").concat(d)])),v=qt(h["PH2-".concat(s,"-").concat(d)]),_=Xt(parseFloat(h["PH2-".concat(s,"-").concat(d)]),parseFloat(h["POP-".concat(s,"-").concat(d)])),C=qt(h["PH3-".concat(s,"-").concat(d)]),w=Xt(parseFloat(h["PH3-".concat(s,"-").concat(d)]),parseFloat(h["POP-".concat(s,"-").concat(d)])),b=qt(h["PH4-".concat(s,"-").concat(d)]),x=Xt(parseFloat(h["PH4-".concat(s,"-").concat(d)]),parseFloat(h["POP-".concat(s,"-").concat(d)])),E=qt(h["PH5-".concat(s,"-").concat(d)]),S=Xt(parseFloat(h["PH5-".concat(s,"-").concat(d)]),parseFloat(h["POP-".concat(s,"-").concat(d)]));return(0,Ut.jsx)("nav",{className:"sidebar",children:(0,Ut.jsxs)("div",{className:"sidebar-container",children:[(0,Ut.jsxs)("div",{className:"logo",children:[(0,Ut.jsx)("img",{src:"/food-security2/images/family_icon.jpg",alt:"Family Icon"}),(0,Ut.jsxs)("span",{className:"logo-text",children:["Food and nutrition situation ",s," "]})]}),(0,Ut.jsxs)("div",{className:"region-info",children:[(0,Ut.jsx)("h2",{children:(0,Ut.jsx)("div",{children:(0,Ut.jsx)("p",{children:f})})}),(0,Ut.jsxs)("div",{className:"info-row",children:[(0,Ut.jsx)("h4",{children:"Total population:"}),(0,Ut.jsx)("p",{children:g})]}),(0,Ut.jsxs)("div",{className:"info-row",children:[(0,Ut.jsx)("h4",{children:"Phase 1:"}),(0,Ut.jsx)("p",{children:m}),(0,Ut.jsxs)("p",{children:[y,"%"]})]}),(0,Ut.jsxs)("div",{className:"info-row",children:[(0,Ut.jsx)("h4",{children:"Phase 2:"}),(0,Ut.jsx)("p",{children:v}),(0,Ut.jsxs)("p",{children:[_,"%"]})]}),(0,Ut.jsxs)("div",{className:"info-row",children:[(0,Ut.jsx)("h4",{children:"Phase 3:"}),(0,Ut.jsx)("p",{children:C}),(0,Ut.jsxs)("p",{children:[w,"%"]})]}),(0,Ut.jsxs)("div",{className:"info-row",children:[(0,Ut.jsx)("h4",{children:"Phase 4:"}),(0,Ut.jsx)("p",{children:b}),(0,Ut.jsxs)("p",{children:[x,"%"]})]}),(0,Ut.jsxs)("div",{className:"info-row",children:[(0,Ut.jsx)("h4",{children:"Phase 5:"}),(0,Ut.jsx)("p",{children:E}),(0,Ut.jsxs)("p",{children:[S,"%"]})]})]})]})})};Ht().accessToken="pk.eyJ1IjoibWFyaWFuYWp2LSIsImEiOiJjbGs3eXJmbzEwYXR3M2RxbnRuOHVkaHV3In0.rVa0wb_O5OTeuk07J90w5A";const Kt=function(e){let{selectedYear:n,selectedMonth:o,onChangeRegion:r,countryData:i,protocoleData:s}=e;const a=(0,t.useRef)(null),l=(0,t.useRef)(null),[u,c]=(0,t.useState)(0),[p,h]=(0,t.useState)(17),[d,f]=(0,t.useState)(3.4),[g,m]=(0,t.useState)(null),y=()=>{c(l.current.getCenter().lng.toFixed(4)),h(l.current.getCenter().lat.toFixed(4)),f(l.current.getZoom().toFixed(2))},v=["output_country-2uwmmy","output_level1-5iewsu","output_level2-8nur76"],_=t=>{const e=t.features[0],n=t.lngLat,o={name:e.properties.Name_2,key:e.properties.Key};let i=null;i&&i.remove(),i=new(Ht().Popup)({maxWidth:"100px",maxHeight:"50px",className:"custom-popup"}).setLngLat(n).setHTML("<h5>".concat(e.properties.Name_2,"</h5>")).addTo(l.current),r(o)};return(0,t.useEffect)((()=>{let t=!0;if(l.current){v.forEach((t=>{l.current.getLayer(t)&&l.current.setPaintProperty(t,"fill-color",function(t,e,n){const o=parseInt(t),r=parseInt(e),i=n.features.some((t=>{let e;return e=11===r?"CLAS-".concat(o,"-").concat(r):"CLAS-".concat(o,"-0").concat(r),console.log(e),e in t.properties}));if(i){let t;return t=11===r?"CLAS-".concat(o,"-").concat(r):"CLAS-".concat(o,"-0").concat(r),["case",["==",["number",["get",t]],1],"#53ca57",["==",["number",["get",t]],2],"#ffe252",["==",["number",["get",t]],3],"#fa890f",["==",["number",["get",t]],4],"#eb3333","#ffffff"]}return"#ffffff"}(n,o,i))}));const t="output-protocol-7nndf6";l.current.getLayer(t)&&l.current.setPaintProperty(t,"fill-pattern",function(t,e,n){const o=parseInt(t),r=parseInt(e),i=n.features.some((t=>{let e;return e=11===r?"PROT-".concat(o,"-").concat(r):"PROT-".concat(o,"-0").concat(r),console.log(e),e in t.properties}));if(i){let t;return t=11===r?"PROT-".concat(o,"-").concat(r):"PROT-".concat(o,"-0").concat(r),console.log(t,"stripes function"),["case",["==",["number",["get",t]],1],"stripes","transparent"]}return"transparent"}(n,o,s))}else l.current=new(Ht().Map)({container:a.current,style:"mapbox://styles/marianajv-/cllf4b5be012q01pb6nqq4k5x",center:[u,p],zoom:d,sources:{stripes:{type:"image",url:"/images/stripes2.jpg",coordinates:[[0,0],[1,0],[1,1],[0,1]]}}}),l.current.on("move",y),v.forEach((t=>{l.current.on("click",t,_)}));return()=>{t=!1}}),[n,o]),(0,t.useEffect)((()=>{let t=!0;return l.current&&l.current.on("move",y),()=>{t=!1}}),[p,u,d]),(0,Ut.jsxs)("div",{className:"view-container",children:[(0,Ut.jsx)("div",{ref:a,className:"map-container"}),(0,Ut.jsx)(Wt,{})]})},Zt=e=>{let{onChangeYear:n,onChangeMonth:o}=e;const r=2014,i=2023,[s,a]=(0,t.useState)(i),[l,u]=(0,t.useState)(null),c=t=>{const e={March:3,June:6,November:11}[t];void 0!==e&&(u(e),o&&o(e))};return(0,Ut.jsxs)("div",{className:"timebar",children:[(0,Ut.jsxs)("div",{className:"year-bar",children:[(0,Ut.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:(s-r)/9,onChange:t=>{const e=parseFloat(t.target.value),o=Math.round(r+9*e);a(o),n&&n(o)},className:"slider"}),(0,Ut.jsx)("div",{className:"year-indicator",children:s})]}),(0,Ut.jsxs)("div",{className:"month-buttons",children:[(0,Ut.jsx)("button",{className:3===l?"selected":"",onClick:()=>c("March"),children:"March"}),(0,Ut.jsx)("button",{className:6===l?"selected":"",onClick:()=>c("June"),children:"June"}),(0,Ut.jsx)("button",{className:11===l?"selected":"",onClick:()=>c("November"),children:"November"})]})]})};var Jt=n(4340);function Qt(t){return null===t?"0":t.toLocaleString("en-US",{maximumFractionDigits:0})}function $t(t,e){return(t/e*100).toFixed(2)}function te(t,e){return e.reduce(((e,n)=>e+!n.excludeFromTotals?parseFloat(n[t].replace(/,/g,"")):0),0)}function ee(t,e,n){let o;o=11==n?"11":"0".concat(n);const r=t.properties["POP-".concat(e,"-").concat(o)];if(console.log(o),void 0===r){let e;return e=11==n?"11":"0".concat(n),{Country:t.properties.Country,Level1:t.properties.Name_1,Level2:t.properties.Name_2,Population:"Data not available","Phase 1":"Data not available","Phase 2":"Data not available","Phase 3":"Data not available","Phase 4":"Data not available","Phase 5":"Data not available","Phase 3-5":"Data not available","%":"Data not available"}}return{Country:ne(t,0),Level1:ne(t,1),Level2:ne(t,2),Population:Qt(r),"Phase 1":Qt(t.properties["PH1-".concat(e,"-").concat(o)]),"Phase 2":Qt(t.properties["PH2-".concat(e,"-").concat(o)]),"Phase 3":Qt(t.properties["PH3-".concat(e,"-").concat(o)]),"Phase 4":Qt(t.properties["PH4-".concat(e,"-").concat(o)]),"Phase 5":Qt(t.properties["PH5-".concat(e,"-").concat(o)]),"Phase 3-5":Qt(t.properties["PH3:5-".concat(e,"-").concat(o)]),"%":$t(t.properties["PH3:5-".concat(e,"-").concat(o)],r),Key:t.properties.Key}}function ne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=["Country","Name_1","Name_2"],o=n[e],r=t.properties[o];return e>0&&r===t.properties[n[e-1]]?"":r}const oe=e=>{let{countryData:n,level1Data:o,level2Data:r,selectedYear:i,selectedMonth:s}=e;console.log("table",n);const[a,l]=(0,t.useState)([{field:"Country",rowgroup:!0,hide:!1,headerClass:"custom-header",cellClass:"custom-cell-bold",width:100},{field:"Level1",rowgroup:!0,hide:!1,headerClass:"custom-header",width:100},{field:"Level2",rowgroup:!0,hide:!1,headerClass:"custom-header",width:100},{field:"Population",headerClass:"custom-header",width:120},{field:"Phase 1",headerClass:"custom-header1",width:90},{field:"Phase 2",headerClass:"custom-header2",width:90},{field:"Phase 3",headerClass:"custom-header3",width:90},{field:"Phase 4",headerClass:"custom-header4",width:90},{field:"Phase 5",headerClass:"custom-header5",width:90},{field:"Phase 3-5",headerClass:"custom-header5",width:100},{field:"%",headerClass:"custom-header5",width:60}]),[u,c]=(0,t.useState)([]),[p,h]=(0,t.useState)(null);(0,t.useEffect)((()=>{if(!n||!n.features)return;const t=n.features.map((t=>ee(t,i,s))).filter((t=>"Data not available"!==t.Population)),e={Country:"Total",Population:Qt(te("Population",t)),"Phase 1":Qt(te("Phase 1",t)),"Phase 2":Qt(te("Phase 2",t)),"Phase 3":Qt(te("Phase 3",t)),"Phase 4":Qt(te("Phase 4",t)),"Phase 5":Qt(te("Phase 5",t)),"Phase 3-5":Qt(te("Phase 3-5",t)),"%":$t(te("Phase 3-5",t),te("Population",t)),rowClass:"total-row"},o=[...t,e];c(o)}),[n,i,s]);return(0,Ut.jsx)("div",{className:"ag-theme-alpine",children:(0,Ut.jsx)(Jt.AgGridReact,{rowData:u,groupDisplayType:"groupRows",columnDefs:a,onRowClicked:function(t){const e=t.data,n=t.api,a=e.level||0;if(2===a)return;const l=["Country","Level1"][a],u=e[l],c=[o.features,r.features].map((t=>t.map((t=>ee(t,i,s)))))[a].filter((t=>t[l]===u));e.expanded?(e.expanded=!1,n.applyTransaction({remove:c.map((t=>({Key:t.Key})))})):(e.expanded=!0,n.applyTransaction({add:c.map((t=>({...t,excludeFromTotals:!0,level:a+1,expanded:!1}))),addIndex:t.rowIndex+1}))},getRowId:t=>t.data.Key})})},re=e=>{let{title:n,options:o,selectedOptions:r,setSelectedOptions:i}=e;const[s,a]=(0,t.useState)(!1),[l,u]=(0,t.useState)(""),c=(0,t.useRef)(null),p=t=>{c.current.contains(t.target)||a(!1)};(0,t.useEffect)((()=>(document.addEventListener("click",p),()=>{document.removeEventListener("click",p)})),[]);const h=o.filter((t=>null!=t)).filter((t=>t.toLowerCase().includes(l.toLowerCase())));return(0,Ut.jsxs)("div",{className:"filter-container",children:[(0,Ut.jsxs)("label",{children:[n,":"]}),(0,Ut.jsxs)("div",{className:"search-dropdown",ref:c,children:[(0,Ut.jsx)("input",{type:"text",placeholder:"Search by ".concat(n),value:l,onChange:t=>{u(t.target.value)},onClick:()=>a(!0)}),s&&(0,Ut.jsxs)("div",{className:"checkbox-list",children:[(0,Ut.jsxs)("div",{children:[(0,Ut.jsx)("input",{type:"checkbox",id:"selectAll".concat(n),value:"selectAll".concat(n),checked:r.length===o.length,onChange:()=>{r.length===o.length?i([]):i(o)}}),(0,Ut.jsx)("label",{htmlFor:"selectAll".concat(n),children:"Select All"})]}),h.map((t=>(0,Ut.jsxs)("div",{children:[(0,Ut.jsx)("input",{type:"checkbox",id:t,value:t,checked:r.includes(t),onChange:()=>(t=>{r.includes(t)?i(r.filter((e=>e!==t))):i([...r,t])})(t)}),(0,Ut.jsx)("label",{htmlFor:t,children:(0,Ut.jsx)("span",{children:t})})]},t)))]})]})]})};function ie(t,e,n){void 0===n&&(n={});var o={type:"Feature"};return(0===n.id||n.id)&&(o.id=n.id),n.bbox&&(o.bbox=n.bbox),o.properties=e||{},o.geometry=t,o}function se(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ce(t[0])||!ce(t[1]))throw new Error("coordinates must contain numbers");return ie({type:"Point",coordinates:t},e,n)}function ae(t,e,n){void 0===n&&(n={});for(var o=0,r=t;o<r.length;o++){var i=r[o];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}return ie({type:"Polygon",coordinates:t},e,n)}function le(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return ie({type:"LineString",coordinates:t},e,n)}function ue(t,e,n){return void 0===n&&(n={}),ie({type:"MultiPoint",coordinates:t},e,n)}function ce(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function pe(t,e,n){if(null!==t)for(var o,r,i,s,a,l,u,c,p=0,h=0,d=t.type,f="FeatureCollection"===d,g="Feature"===d,m=f?t.features.length:1,y=0;y<m;y++){a=(c=!!(u=f?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var _=0,C=0;if(null!==(s=c?u.geometries[v]:u)){l=s.coordinates;var w=s.type;switch(p=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(l,h,y,_,C))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(o=0;o<l.length;o++){if(!1===e(l[o],h,y,_,C))return!1;h++,"MultiPoint"===w&&_++}"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(o=0;o<l.length;o++){for(r=0;r<l[o].length-p;r++){if(!1===e(l[o][r],h,y,_,C))return!1;h++}"MultiLineString"===w&&_++,"Polygon"===w&&C++}"Polygon"===w&&_++;break;case"MultiPolygon":for(o=0;o<l.length;o++){for(C=0,r=0;r<l[o].length;r++){for(i=0;i<l[o][r].length-p;i++){if(!1===e(l[o][r][i],h,y,_,C))return!1;h++}C++}_++}break;case"GeometryCollection":for(o=0;o<s.geometries.length;o++)if(!1===pe(s.geometries[o],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function he(t,e){var n,o,r,i,s,a,l,u,c,p,h=0,d="FeatureCollection"===t.type,f="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:f?t.geometry:t,u=d?t.features[n].properties:f?t.properties:{},c=d?t.features[n].bbox:f?t.bbox:void 0,p=d?t.features[n].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(i=l?a.geometries[r]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,h,u,c,p))return!1;break;case"GeometryCollection":for(o=0;o<i.geometries.length;o++)if(!1===e(i.geometries[o],h,u,c,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,u,c,p))return!1;h++}}function de(t,e){he(t,(function(t,n,o,r,i){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(ie(t,o,{bbox:r,id:i}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(ie({type:s,coordinates:u},o),n,l))return!1}}))}function fe(t){var e=[1/0,1/0,-1/0,-1/0];return pe(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}fe.default=fe;const ge=fe;n(1725);n(4161);function me(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var o,r=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),i="Feature"===(o=e).type?o.geometry:o,s=i.type,a=e.bbox,l=i.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,a))return!1;"Polygon"===s&&(l=[l]);for(var u=!1,c=0;c<l.length&&!u;c++)if(ye(r,l[c][0],n.ignoreBoundary)){for(var p=!1,h=1;h<l[c].length&&!p;)ye(r,l[c][h],!n.ignoreBoundary)&&(p=!0),h++;p||(u=!0)}return u}function ye(t,e,n){var o=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,i=e.length-1;r<e.length;i=r++){var s=e[r][0],a=e[r][1],l=e[i][0],u=e[i][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)===0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!==u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(o=!o)}return o}Object.prototype.hasOwnProperty;var ve=new ArrayBuffer(16);new Float64Array(ve),new Uint32Array(ve);n(1977);!function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],o=this.points[e+1];this.centers.push({x:(n.x+o.x)/2,y:(n.y+o.y)/2,z:(n.z+o.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,i=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+i),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+i),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}t.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var o=0;o<this.duration;o+=10){var r=this.pos(o);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(o),n=r)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var o=Math.floor((this.points.length-1)*n);return function(t,e,n,o,r){var i=function(t){var e=t*t,n=e*t;return[n,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*i[0]+o.x*i[1]+n.x*i[2]+e.x*i[3],y:r.y*i[0]+o.y*i[1]+n.y*i[2]+e.y*i[3],z:r.z*i[0]+o.z*i[1]+n.z*i[2]+e.z*i[3]}}((this.length-1)*n-o,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])}}();const _e=function(t){return function(t,e){void 0===e&&(e={});var n=Number(t[0]),o=Number(t[1]),r=Number(t[2]),i=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[n,o];return ae([[s,[r,o],[r,i],[n,i],s]],e.properties,{bbox:t,id:e.id})}(ge(t))};n(7089);n(9234);var Ce=Math.PI/180,we=180/Math.PI,be=function(t,e){this.lon=t,this.lat=e,this.x=Ce*t,this.y=Ce*e};be.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},be.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new be(e,t)};var xe=function(){this.coords=[],this.length=0};xe.prototype.move_to=function(t){this.length++,this.coords.push(t)};var Ee=function(t){this.properties=t||{},this.geometries=[]};Ee.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},Ee.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},o=0;o<this.geometries.length;o++){if(0===this.geometries[o].coords.length)return"LINESTRING(empty)";this.geometries[o].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var Se=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new be(t.x,t.y),this.end=new be(e.x,e.y),this.properties=n||{};var o=this.start.x-this.end.x,r=this.start.y-this.end.y,i=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(o/2),2);if(this.g=2*Math.asin(Math.sqrt(i)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};Se.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),o=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),i=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=we*Math.atan2(i,Math.sqrt(Math.pow(o,2)+Math.pow(r,2)));return[we*Math.atan2(r,o),s]},Se.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var o=1/(t-1),r=0;r<t;++r){var i=o*r,s=this.interpolate(i);n.push(s)}for(var a=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,p=-180+u,h=360-u,d=1;d<n.length;++d){var f=n[d-1][0],g=n[d][0],m=Math.abs(g-f);m>h&&(g>c&&f<p||f>c&&g<p)?a=!0:m>l&&(l=m)}var y=[];if(a&&l<u){var v=[];y.push(v);for(var _=0;_<n.length;++_){var C=parseFloat(n[_][0]);if(_>0&&Math.abs(C-n[_-1][0])>h){var w=parseFloat(n[_-1][0]),b=parseFloat(n[_-1][1]),x=parseFloat(n[_][0]),E=parseFloat(n[_][1]);if(w>-180&&w<p&&180===x&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<p){v.push([-180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(w>c&&w<180&&-180===x&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){v.push([180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(w<p&&x>c){var S=w;w=x,x=S;var T=b;b=E,E=T}if(w>c&&x<p&&(x+=360),w<=180&&x>=180&&w<x){var R=(180-w)/(x-w),O=R*E+(1-R)*b;v.push([n[_-1][0]>c?180:-180,O]),(v=[]).push([n[_-1][0]>c?-180:180,O]),y.push(v)}else v=[],y.push(v);v.push([C,n[_][1]])}else v.push([n[_][0],n[_][1]])}}else{var P=[];y.push(P);for(var I=0;I<n.length;++I)P.push([n[I][0],n[I][1]])}for(var A=new Ee(this.properties),D=0;D<y.length;++D){var M=new xe;A.geometries.push(M);for(var L=y[D],N=0;N<L.length;++N)M.move_to(L[N])}return A};n(4058);var Te=[],Re=[],Oe=[],Pe=[],Ie=[],Ae=[],De=[],Me=[],Le=[],Ne=[],Fe=[],ke=[],Ge=[],Be=[],Ve=[],ze=[],je=[],He=[],Ue=[],We=[],qe=[],Xe=[],Ye=[],Ke=[];De[85]=Ne[85]=-1,Me[85]=Fe[85]=0,Le[85]=ke[85]=1,Ue[85]=Xe[85]=1,We[85]=Ye[85]=0,qe[85]=Ke[85]=1,Te[85]=Pe[85]=0,Re[85]=Ie[85]=-1,Oe[85]=Ve[85]=0,ze[85]=Ge[85]=0,je[85]=Be[85]=1,Ae[85]=He[85]=1,Xe[1]=Xe[169]=0,Ye[1]=Ye[169]=-1,Ke[1]=Ke[169]=0,Ge[1]=Ge[169]=-1,Be[1]=Be[169]=0,Ve[1]=Ve[169]=0,Ne[4]=Ne[166]=0,Fe[4]=Fe[166]=-1,ke[4]=ke[166]=1,ze[4]=ze[166]=1,je[4]=je[166]=0,He[4]=He[166]=0,De[16]=De[154]=0,Me[16]=Me[154]=1,Le[16]=Le[154]=1,Pe[16]=Pe[154]=1,Ie[16]=Ie[154]=0,Ae[16]=Ae[154]=1,Ue[64]=Ue[106]=0,We[64]=We[106]=1,qe[64]=qe[106]=0,Te[64]=Te[106]=-1,Re[64]=Re[106]=0,Oe[64]=Oe[106]=1,Ue[2]=Ue[168]=0,We[2]=We[168]=-1,qe[2]=qe[168]=1,Xe[2]=Xe[168]=0,Ye[2]=Ye[168]=-1,Ke[2]=Ke[168]=0,Ge[2]=Ge[168]=-1,Be[2]=Be[168]=0,Ve[2]=Ve[168]=0,ze[2]=ze[168]=-1,je[2]=je[168]=0,He[2]=He[168]=1,De[8]=De[162]=0,Me[8]=Me[162]=-1,Le[8]=Le[162]=0,Ne[8]=Ne[162]=0,Fe[8]=Fe[162]=-1,ke[8]=ke[162]=1,Ge[8]=Ge[162]=1,Be[8]=Be[162]=0,Ve[8]=Ve[162]=1,ze[8]=ze[162]=1,je[8]=je[162]=0,He[8]=He[162]=0,De[32]=De[138]=0,Me[32]=Me[138]=1,Le[32]=Le[138]=1,Ne[32]=Ne[138]=0,Fe[32]=Fe[138]=1,ke[32]=ke[138]=0,Te[32]=Te[138]=1,Re[32]=Re[138]=0,Oe[32]=Oe[138]=0,Pe[32]=Pe[138]=1,Ie[32]=Ie[138]=0,Ae[32]=Ae[138]=1,Xe[128]=Xe[42]=0,Ye[128]=Ye[42]=1,Ke[128]=Ke[42]=1,Ue[128]=Ue[42]=0,We[128]=We[42]=1,qe[128]=qe[42]=0,Te[128]=Te[42]=-1,Re[128]=Re[42]=0,Oe[128]=Oe[42]=1,Pe[128]=Pe[42]=-1,Ie[128]=Ie[42]=0,Ae[128]=Ae[42]=0,Ne[5]=Ne[165]=-1,Fe[5]=Fe[165]=0,ke[5]=ke[165]=0,Xe[5]=Xe[165]=1,Ye[5]=Ye[165]=0,Ke[5]=Ke[165]=0,ze[20]=ze[150]=0,je[20]=je[150]=1,He[20]=He[150]=1,Pe[20]=Pe[150]=0,Ie[20]=Ie[150]=-1,Ae[20]=Ae[150]=1,De[80]=De[90]=-1,Me[80]=Me[90]=0,Le[80]=Le[90]=1,Ue[80]=Ue[90]=1,We[80]=We[90]=0,qe[80]=qe[90]=1,Ge[65]=Ge[105]=0,Be[65]=Be[105]=1,Ve[65]=Ve[105]=0,Te[65]=Te[105]=0,Re[65]=Re[105]=-1,Oe[65]=Oe[105]=0,De[160]=De[10]=-1,Me[160]=Me[10]=0,Le[160]=Le[10]=1,Ne[160]=Ne[10]=-1,Fe[160]=Fe[10]=0,ke[160]=ke[10]=0,Xe[160]=Xe[10]=1,Ye[160]=Ye[10]=0,Ke[160]=Ke[10]=0,Ue[160]=Ue[10]=1,We[160]=We[10]=0,qe[160]=qe[10]=1,ze[130]=ze[40]=0,je[130]=je[40]=1,He[130]=He[40]=1,Ge[130]=Ge[40]=0,Be[130]=Be[40]=1,Ve[130]=Ve[40]=0,Te[130]=Te[40]=0,Re[130]=Re[40]=-1,Oe[130]=Oe[40]=0,Pe[130]=Pe[40]=0,Ie[130]=Ie[40]=-1,Ae[130]=Ae[40]=1,Ne[37]=Ne[133]=0,Fe[37]=Fe[133]=1,ke[37]=ke[133]=1,Xe[37]=Xe[133]=0,Ye[37]=Ye[133]=1,Ke[37]=Ke[133]=0,Te[37]=Te[133]=-1,Re[37]=Re[133]=0,Oe[37]=Oe[133]=0,Pe[37]=Pe[133]=1,Ie[37]=Ie[133]=0,Ae[37]=Ae[133]=0,ze[148]=ze[22]=-1,je[148]=je[22]=0,He[148]=He[22]=0,Xe[148]=Xe[22]=0,Ye[148]=Ye[22]=-1,Ke[148]=Ke[22]=1,Ue[148]=Ue[22]=0,We[148]=We[22]=1,qe[148]=qe[22]=1,Pe[148]=Pe[22]=-1,Ie[148]=Ie[22]=0,Ae[148]=Ae[22]=1,De[82]=De[88]=0,Me[82]=Me[88]=-1,Le[82]=Le[88]=1,ze[82]=ze[88]=1,je[82]=je[88]=0,He[82]=He[88]=1,Ge[82]=Ge[88]=-1,Be[82]=Be[88]=0,Ve[82]=Ve[88]=1,Ue[82]=Ue[88]=0,We[82]=We[88]=-1,qe[82]=qe[88]=0,De[73]=De[97]=0,Me[73]=Me[97]=1,Le[73]=Le[97]=0,Ne[73]=Ne[97]=0,Fe[73]=Fe[97]=-1,ke[73]=ke[97]=0,Ge[73]=Ge[97]=1,Be[73]=Be[97]=0,Ve[73]=Ve[97]=0,Te[73]=Te[97]=1,Re[73]=Re[97]=0,Oe[73]=Oe[97]=1,De[145]=De[25]=0,Me[145]=Me[25]=-1,Le[145]=Le[25]=0,Ge[145]=Ge[25]=1,Be[145]=Be[25]=0,Ve[145]=Ve[25]=1,Xe[145]=Xe[25]=0,Ye[145]=Ye[25]=1,Ke[145]=Ke[25]=1,Pe[145]=Pe[25]=-1,Ie[145]=Ie[25]=0,Ae[145]=Ae[25]=0,Ne[70]=Ne[100]=0,Fe[70]=Fe[100]=1,ke[70]=ke[100]=0,ze[70]=ze[100]=-1,je[70]=je[100]=0,He[70]=He[100]=1,Ue[70]=Ue[100]=0,We[70]=We[100]=-1,qe[70]=qe[100]=1,Te[70]=Te[100]=1,Re[70]=Re[100]=0,Oe[70]=Oe[100]=0,Ne[101]=Ne[69]=0,Fe[101]=Fe[69]=1,ke[101]=ke[69]=0,Te[101]=Te[69]=1,Re[101]=Re[69]=0,Oe[101]=Oe[69]=0,Xe[149]=Xe[21]=0,Ye[149]=Ye[21]=1,Ke[149]=Ke[21]=1,Pe[149]=Pe[21]=-1,Ie[149]=Ie[21]=0,Ae[149]=Ae[21]=0,ze[86]=ze[84]=-1,je[86]=je[84]=0,He[86]=He[84]=1,Ue[86]=Ue[84]=0,We[86]=We[84]=-1,qe[86]=qe[84]=1,De[89]=De[81]=0,Me[89]=Me[81]=-1,Le[89]=Le[81]=0,Ge[89]=Ge[81]=1,Be[89]=Be[81]=0,Ve[89]=Ve[81]=1,De[96]=De[74]=0,Me[96]=Me[74]=1,Le[96]=Le[74]=0,Ne[96]=Ne[74]=-1,Fe[96]=Fe[74]=0,ke[96]=ke[74]=1,Ue[96]=Ue[74]=1,We[96]=We[74]=0,qe[96]=qe[74]=0,Te[96]=Te[74]=1,Re[96]=Re[74]=0,Oe[96]=Oe[74]=1,De[24]=De[146]=0,Me[24]=Me[146]=-1,Le[24]=Le[146]=1,ze[24]=ze[146]=1,je[24]=je[146]=0,He[24]=He[146]=1,Ge[24]=Ge[146]=0,Be[24]=Be[146]=1,Ve[24]=Ve[146]=1,Pe[24]=Pe[146]=0,Ie[24]=Ie[146]=-1,Ae[24]=Ae[146]=0,Ne[6]=Ne[164]=-1,Fe[6]=Fe[164]=0,ke[6]=ke[164]=1,ze[6]=ze[164]=-1,je[6]=je[164]=0,He[6]=He[164]=0,Xe[6]=Xe[164]=0,Ye[6]=Ye[164]=-1,Ke[6]=Ke[164]=1,Ue[6]=Ue[164]=1,We[6]=We[164]=0,qe[6]=qe[164]=0,Ge[129]=Ge[41]=0,Be[129]=Be[41]=1,Ve[129]=Ve[41]=1,Xe[129]=Xe[41]=0,Ye[129]=Ye[41]=1,Ke[129]=Ke[41]=0,Te[129]=Te[41]=-1,Re[129]=Re[41]=0,Oe[129]=Oe[41]=0,Pe[129]=Pe[41]=0,Ie[129]=Ie[41]=-1,Ae[129]=Ae[41]=0,ze[66]=ze[104]=0,je[66]=je[104]=1,He[66]=He[104]=0,Ge[66]=Ge[104]=-1,Be[66]=Be[104]=0,Ve[66]=Ve[104]=1,Ue[66]=Ue[104]=0,We[66]=We[104]=-1,qe[66]=qe[104]=0,Te[66]=Te[104]=0,Re[66]=Re[104]=-1,Oe[66]=Oe[104]=1,De[144]=De[26]=-1,Me[144]=Me[26]=0,Le[144]=Le[26]=0,Xe[144]=Xe[26]=1,Ye[144]=Ye[26]=0,Ke[144]=Ke[26]=1,Ue[144]=Ue[26]=0,We[144]=We[26]=1,qe[144]=qe[26]=1,Pe[144]=Pe[26]=-1,Ie[144]=Ie[26]=0,Ae[144]=Ae[26]=1,Ne[36]=Ne[134]=0,Fe[36]=Fe[134]=1,ke[36]=ke[134]=1,ze[36]=ze[134]=0,je[36]=je[134]=1,He[36]=He[134]=0,Te[36]=Te[134]=0,Re[36]=Re[134]=-1,Oe[36]=Oe[134]=1,Pe[36]=Pe[134]=1,Ie[36]=Ie[134]=0,Ae[36]=Ae[134]=0,De[9]=De[161]=-1,Me[9]=Me[161]=0,Le[9]=Le[161]=0,Ne[9]=Ne[161]=0,Fe[9]=Fe[161]=-1,ke[9]=ke[161]=0,Ge[9]=Ge[161]=1,Be[9]=Be[161]=0,Ve[9]=Ve[161]=0,Xe[9]=Xe[161]=1,Ye[9]=Ye[161]=0,Ke[9]=Ke[161]=1,De[136]=0,Me[136]=1,Le[136]=1,Ne[136]=0,Fe[136]=1,ke[136]=0,ze[136]=-1,je[136]=0,He[136]=1,Ge[136]=-1,Be[136]=0,Ve[136]=0,Xe[136]=0,Ye[136]=-1,Ke[136]=0,Ue[136]=0,We[136]=-1,qe[136]=1,Te[136]=1,Re[136]=0,Oe[136]=0,Pe[136]=1,Ie[136]=0,Ae[136]=1,De[34]=0,Me[34]=-1,Le[34]=0,Ne[34]=0,Fe[34]=-1,ke[34]=1,ze[34]=1,je[34]=0,He[34]=0,Ge[34]=1,Be[34]=0,Ve[34]=1,Xe[34]=0,Ye[34]=1,Ke[34]=1,Ue[34]=0,We[34]=1,qe[34]=0,Te[34]=-1,Re[34]=0,Oe[34]=1,Pe[34]=-1,Ie[34]=0,Ae[34]=0,De[35]=0,Me[35]=1,Le[35]=1,Ne[35]=0,Fe[35]=-1,ke[35]=1,ze[35]=1,je[35]=0,He[35]=0,Ge[35]=-1,Be[35]=0,Ve[35]=0,Xe[35]=0,Ye[35]=-1,Ke[35]=0,Ue[35]=0,We[35]=1,qe[35]=0,Te[35]=-1,Re[35]=0,Oe[35]=1,Pe[35]=1,Ie[35]=0,Ae[35]=1,De[153]=0,Me[153]=1,Le[153]=1,Ge[153]=-1,Be[153]=0,Ve[153]=0,Xe[153]=0,Ye[153]=-1,Ke[153]=0,Pe[153]=1,Ie[153]=0,Ae[153]=1,Ne[102]=0,Fe[102]=-1,ke[102]=1,ze[102]=1,je[102]=0,He[102]=0,Ue[102]=0,We[102]=1,qe[102]=0,Te[102]=-1,Re[102]=0,Oe[102]=1,De[155]=0,Me[155]=-1,Le[155]=0,Ge[155]=1,Be[155]=0,Ve[155]=1,Xe[155]=0,Ye[155]=1,Ke[155]=1,Pe[155]=-1,Ie[155]=0,Ae[155]=0,Ne[103]=0,Fe[103]=1,ke[103]=0,ze[103]=-1,je[103]=0,He[103]=1,Ue[103]=0,We[103]=-1,qe[103]=1,Te[103]=1,Re[103]=0,Oe[103]=0,De[152]=0,Me[152]=1,Le[152]=1,ze[152]=-1,je[152]=0,He[152]=1,Ge[152]=-1,Be[152]=0,Ve[152]=0,Xe[152]=0,Ye[152]=-1,Ke[152]=0,Ue[152]=0,We[152]=-1,qe[152]=1,Pe[152]=1,Ie[152]=0,Ae[152]=1,De[156]=0,Me[156]=-1,Le[156]=1,ze[156]=1,je[156]=0,He[156]=1,Ge[156]=-1,Be[156]=0,Ve[156]=0,Xe[156]=0,Ye[156]=-1,Ke[156]=0,Ue[156]=0,We[156]=1,qe[156]=1,Pe[156]=-1,Ie[156]=0,Ae[156]=1,De[137]=0,Me[137]=1,Le[137]=1,Ne[137]=0,Fe[137]=1,ke[137]=0,Ge[137]=-1,Be[137]=0,Ve[137]=0,Xe[137]=0,Ye[137]=-1,Ke[137]=0,Te[137]=1,Re[137]=0,Oe[137]=0,Pe[137]=1,Ie[137]=0,Ae[137]=1,De[139]=0,Me[139]=1,Le[139]=1,Ne[139]=0,Fe[139]=-1,ke[139]=0,Ge[139]=1,Be[139]=0,Ve[139]=0,Xe[139]=0,Ye[139]=1,Ke[139]=0,Te[139]=-1,Re[139]=0,Oe[139]=0,Pe[139]=1,Ie[139]=0,Ae[139]=1,De[98]=0,Me[98]=-1,Le[98]=0,Ne[98]=0,Fe[98]=-1,ke[98]=1,ze[98]=1,je[98]=0,He[98]=0,Ge[98]=1,Be[98]=0,Ve[98]=1,Ue[98]=0,We[98]=1,qe[98]=0,Te[98]=-1,Re[98]=0,Oe[98]=1,De[99]=0,Me[99]=1,Le[99]=0,Ne[99]=0,Fe[99]=-1,ke[99]=1,ze[99]=1,je[99]=0,He[99]=0,Ge[99]=-1,Be[99]=0,Ve[99]=1,Ue[99]=0,We[99]=-1,qe[99]=0,Te[99]=1,Re[99]=0,Oe[99]=1,Ne[38]=0,Fe[38]=-1,ke[38]=1,ze[38]=1,je[38]=0,He[38]=0,Xe[38]=0,Ye[38]=1,Ke[38]=1,Ue[38]=0,We[38]=1,qe[38]=0,Te[38]=-1,Re[38]=0,Oe[38]=1,Pe[38]=-1,Ie[38]=0,Ae[38]=0,Ne[39]=0,Fe[39]=1,ke[39]=1,ze[39]=-1,je[39]=0,He[39]=0,Xe[39]=0,Ye[39]=-1,Ke[39]=1,Ue[39]=0,We[39]=1,qe[39]=0,Te[39]=-1,Re[39]=0,Oe[39]=1,Pe[39]=1,Ie[39]=0,Ae[39]=0;var Ze=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Je=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},Qe=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},$e=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},tn=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},en=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},nn=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},on=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},rn=[],sn=[],an=[],ln=[],un=[],cn=[],pn=[],hn=[];ln[1]=un[1]=18,ln[169]=un[169]=18,an[4]=sn[4]=12,an[166]=sn[166]=12,rn[16]=hn[16]=4,rn[154]=hn[154]=4,cn[64]=pn[64]=22,cn[106]=pn[106]=22,an[2]=cn[2]=17,ln[2]=un[2]=18,an[168]=cn[168]=17,ln[168]=un[168]=18,rn[8]=ln[8]=9,sn[8]=an[8]=12,rn[162]=ln[162]=9,sn[162]=an[162]=12,rn[32]=hn[32]=4,sn[32]=pn[32]=1,rn[138]=hn[138]=4,sn[138]=pn[138]=1,un[128]=hn[128]=21,cn[128]=pn[128]=22,un[42]=hn[42]=21,cn[42]=pn[42]=22,sn[5]=un[5]=14,sn[165]=un[165]=14,an[20]=hn[20]=6,an[150]=hn[150]=6,rn[80]=cn[80]=11,rn[90]=cn[90]=11,ln[65]=pn[65]=3,ln[105]=pn[105]=3,rn[160]=cn[160]=11,sn[160]=un[160]=14,rn[10]=cn[10]=11,sn[10]=un[10]=14,an[130]=hn[130]=6,ln[130]=pn[130]=3,an[40]=hn[40]=6,ln[40]=pn[40]=3,sn[101]=pn[101]=1,sn[69]=pn[69]=1,un[149]=hn[149]=21,un[21]=hn[21]=21,an[86]=cn[86]=17,an[84]=cn[84]=17,rn[89]=ln[89]=9,rn[81]=ln[81]=9,rn[96]=pn[96]=0,sn[96]=cn[96]=15,rn[74]=pn[74]=0,sn[74]=cn[74]=15,rn[24]=an[24]=8,ln[24]=hn[24]=7,rn[146]=an[146]=8,ln[146]=hn[146]=7,sn[6]=cn[6]=15,an[6]=un[6]=16,sn[164]=cn[164]=15,an[164]=un[164]=16,ln[129]=hn[129]=7,un[129]=pn[129]=20,ln[41]=hn[41]=7,un[41]=pn[41]=20,an[66]=pn[66]=2,ln[66]=cn[66]=19,an[104]=pn[104]=2,ln[104]=cn[104]=19,rn[144]=un[144]=10,cn[144]=hn[144]=23,rn[26]=un[26]=10,cn[26]=hn[26]=23,sn[36]=hn[36]=5,an[36]=pn[36]=2,sn[134]=hn[134]=5,an[134]=pn[134]=2,rn[9]=un[9]=10,sn[9]=ln[9]=13,rn[161]=un[161]=10,sn[161]=ln[161]=13,sn[37]=hn[37]=5,un[37]=pn[37]=20,sn[133]=hn[133]=5,un[133]=pn[133]=20,an[148]=un[148]=16,cn[148]=hn[148]=23,an[22]=un[22]=16,cn[22]=hn[22]=23,rn[82]=an[82]=8,ln[82]=cn[82]=19,rn[88]=an[88]=8,ln[88]=cn[88]=19,rn[73]=pn[73]=0,sn[73]=ln[73]=13,rn[97]=pn[97]=0,sn[97]=ln[97]=13,rn[145]=ln[145]=9,un[145]=hn[145]=21,rn[25]=ln[25]=9,un[25]=hn[25]=21,sn[70]=pn[70]=1,an[70]=cn[70]=17,sn[100]=pn[100]=1,an[100]=cn[100]=17,rn[34]=ln[34]=9,sn[34]=an[34]=12,un[34]=hn[34]=21,cn[34]=pn[34]=22,rn[136]=hn[136]=4,sn[136]=pn[136]=1,an[136]=cn[136]=17,ln[136]=un[136]=18,rn[35]=hn[35]=4,sn[35]=an[35]=12,ln[35]=un[35]=18,cn[35]=pn[35]=22,rn[153]=hn[153]=4,ln[153]=un[153]=18,sn[102]=an[102]=12,cn[102]=pn[102]=22,rn[155]=ln[155]=9,un[155]=hn[155]=23,sn[103]=pn[103]=1,an[103]=cn[103]=17,rn[152]=hn[152]=4,an[152]=cn[152]=17,ln[152]=un[152]=18,rn[156]=an[156]=8,ln[156]=un[156]=18,cn[156]=hn[156]=23,rn[137]=hn[137]=4,sn[137]=pn[137]=1,ln[137]=un[137]=18,rn[139]=hn[139]=4,sn[139]=ln[139]=13,un[139]=pn[139]=20,rn[98]=ln[98]=9,sn[98]=an[98]=12,cn[98]=pn[98]=22,rn[99]=pn[99]=0,sn[99]=an[99]=12,ln[99]=cn[99]=19,sn[38]=an[38]=12,un[38]=hn[38]=21,cn[38]=pn[38]=22,sn[39]=hn[39]=5,an[39]=un[39]=16,cn[39]=pn[39]=22;var dn=[];dn[1]=dn[169]=Ze,dn[4]=dn[166]=Je,dn[16]=dn[154]=Qe,dn[64]=dn[106]=$e,dn[168]=dn[2]=tn,dn[162]=dn[8]=en,dn[138]=dn[32]=nn,dn[42]=dn[128]=on,dn[5]=dn[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},dn[20]=dn[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},dn[80]=dn[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},dn[65]=dn[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},dn[160]=dn[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},dn[130]=dn[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},dn[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},dn[101]=dn[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},dn[149]=dn[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},dn[86]=dn[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},dn[89]=dn[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},dn[96]=dn[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},dn[24]=dn[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},dn[6]=dn[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},dn[129]=dn[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},dn[66]=dn[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},dn[144]=dn[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},dn[36]=dn[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},dn[9]=dn[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},dn[37]=dn[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},dn[148]=dn[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},dn[82]=dn[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},dn[73]=dn[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},dn[145]=dn[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},dn[70]=dn[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},dn[34]=function(t){return[on(t),en(t)]},dn[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},dn[136]=function(t){return[nn(t),tn(t)]},dn[153]=function(t){return[Qe(t),Ze(t)]},dn[102]=function(t){return[Je(t),$e(t)]},dn[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},dn[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},dn[152]=function(t){return[Qe(t),tn(t)]},dn[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},dn[137]=function(t){return[nn(t),Ze(t)]},dn[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},dn[98]=function(t){return[en(t),$e(t)]},dn[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},dn[38]=function(t){return[Je(t),on(t)]},dn[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};function fn(t,e,n){var o,r=e[0]-t[0],i=e[1]-t[1],s=n[0]-e[0],a=n[1]-e[1];return((o=r*a-s*i)>0)-(o<0)||+o}function gn(t,e){return e.geometry.coordinates[0].every((function(e){return me(se(e),t)}))}var mn=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var o=e.to,r=n.to;if(o.coordinates[0]-t.coordinates[0]>=0&&r.coordinates[0]-t.coordinates[0]<0)return 1;if(o.coordinates[0]-t.coordinates[0]<0&&r.coordinates[0]-t.coordinates[0]>=0)return-1;if(o.coordinates[0]-t.coordinates[0]===0&&r.coordinates[0]-t.coordinates[0]===0)return o.coordinates[1]-t.coordinates[1]>=0||r.coordinates[1]-t.coordinates[1]>=0?o.coordinates[1]-r.coordinates[1]:r.coordinates[1]-o.coordinates[1];var i=fn(t.coordinates,o.coordinates,r.coordinates);return i<0?1:i>0?-1:Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2)-(Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}();const yn=mn;const vn=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return le([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return fn(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}();var _n=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,o){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=o),e}),0),n=(0===e?this.length:e)-1,o=(e+1)%this.length,r=fn(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[o].from.coordinates);return 0===r?this.edges[n].from.coordinates[0]>this.edges[o].from.coordinates[0]:r>0},t.prototype.toMultiPoint=function(){return ue(this.edges.map((function(t){return t.from.coordinates})))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=ae([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=_e(this.toPolygon())},t.findEdgeRingContaining=function(t,e){var n,o,r=t.getEnvelope();return e.forEach((function(e){var i=e.getEnvelope();if(o&&(n=o.getEnvelope()),!function(t,e){var n=t.geometry.coordinates[0].map((function(t){return t[0]})),o=t.geometry.coordinates[0].map((function(t){return t[1]})),r=e.geometry.coordinates[0].map((function(t){return t[0]})),i=e.geometry.coordinates[0].map((function(t){return t[1]}));return Math.max.apply(null,n)===Math.max.apply(null,r)&&Math.max.apply(null,o)===Math.max.apply(null,i)&&Math.min.apply(null,n)===Math.min.apply(null,r)&&Math.min.apply(null,o)===Math.min.apply(null,i)}(i,r)&&gn(i,r)){for(var s=t.map((function(t){return t.from.coordinates})),a=void 0,l=function(t){e.some((function(e){return n=t,o=e.from.coordinates,n[0]===o[0]&&n[1]===o[1];var n,o}))||(a=t)},u=0,c=s;u<c.length;u++){l(c[u])}a&&e.inside(se(a))&&(o&&!gn(n,i)||(o=e))}})),o},t.prototype.inside=function(t){return me(t,this.toPolygon())},t}();const Cn=_n;!function(){function t(){this.edges=[],this.nodes={}}t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var n=new t;return de(e,(function(t){!function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}(t,"LineString","Graph::fromGeoJson"),function(t,e,n,o){var r=n;pe(t,(function(t,o,i,s,a){r=0===o&&void 0===n?t:e(r,t,o,i,s,a)}),o)}(t,(function(t,e){if(t){var o=n.getNode(t),r=n.getNode(e);n.addEdge(o,r)}return e}))})),n},t.prototype.getNode=function(t){var e=yn.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new yn(t)),n},t.prototype.addEdge=function(t,e){var n=new vn(t,e),o=n.getSymetric();this.edges.push(n),this.edges.push(o)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;"undefined"===typeof t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var n,o,r=t.getOuterEdges(),i=r.length-1;i>=0;--i){var s=r[i],a=s.symetric,l=void 0,u=void 0;s.label===e&&(l=s),a.label===e&&(u=a),l&&u&&(u&&(o=u),l&&(o&&(o.next=l,o=void 0),n||(n=l)))}o&&(o.next=n)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var o=n;do{o.label=e,o=o.next}while(!n.isEqual(o));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],n=t,o=function(){var o=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++o})),o>1&&e.push(n.from),n=n.next};do{o()}while(!t.isEqual(n));return e},t.prototype._findEdgeRing=function(t){var e=t,n=new Cn;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()}}();n(4042);n(5107);n(6530);function wn(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var bn={search:function(t,e,n,o){t.cleanDirty();var r=(o=o||{}).heuristic||bn.heuristics.manhattan,i=o.closest||!1,s=new Sn((function(t){return t.f})),a=e;for(e.h=r(e,n),s.push(e);s.size()>0;){var l=s.pop();if(l===n)return wn(l);l.closed=!0;for(var u=t.neighbors(l),c=0,p=u.length;c<p;++c){var h=u[c];if(!h.closed&&!h.isWall()){var d=l.g+h.getCost(l),f=h.visited;(!f||d<h.g)&&(h.visited=!0,h.parent=l,h.h=h.h||r(h,n),h.g=d,h.f=h.g+h.h,t.markDirty(h),i&&(h.h<a.h||h.h===a.h&&h.g<a.g)&&(a=h),f?s.rescoreElement(h):s.push(h))}}}return i?wn(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),o=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(o+r)+(n-2)*Math.min(o,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function xn(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var o=0,r=t[n];o<r.length;o++){var i=new En(n,o,r[o]);this.grid[n][o]=i,this.nodes.push(i)}}this.init()}function En(t,e,n){this.x=t,this.y=e,this.weight=n}function Sn(t){this.content=[],this.scoreFunction=t}xn.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)bn.cleanNode(this.nodes[t])},xn.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)bn.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},xn.prototype.markDirty=function(t){this.dirtyNodes.push(t)},xn.prototype.neighbors=function(t){var e=[],n=t.x,o=t.y,r=this.grid;return r[n-1]&&r[n-1][o]&&e.push(r[n-1][o]),r[n+1]&&r[n+1][o]&&e.push(r[n+1][o]),r[n]&&r[n][o-1]&&e.push(r[n][o-1]),r[n]&&r[n][o+1]&&e.push(r[n][o+1]),this.diagonal&&(r[n-1]&&r[n-1][o-1]&&e.push(r[n-1][o-1]),r[n+1]&&r[n+1][o-1]&&e.push(r[n+1][o-1]),r[n-1]&&r[n-1][o+1]&&e.push(r[n-1][o+1]),r[n+1]&&r[n+1][o+1]&&e.push(r[n+1][o+1])),e},xn.prototype.toString=function(){for(var t,e,n,o,r=[],i=this.grid,s=0,a=i.length;s<a;s++){for(t=[],n=0,o=(e=i[s]).length;n<o;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},En.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},En.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},En.prototype.isWall=function(){return 0===this.weight},Sn.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,o=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(o)))break;this.content[n]=e,this.content[t]=o,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],o=this.scoreFunction(n);;){var r,i=t+1<<1,s=i-1,a=null;if(s<e){var l=this.content[s];(r=this.scoreFunction(l))<o&&(a=s)}if(i<e){var u=this.content[i];this.scoreFunction(u)<(null===a?o:r)&&(a=i)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}};function Tn(){this._=null}function Rn(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function On(t,e){var n=e,o=e.R,r=n.U;r?r.L===n?r.L=o:r.R=o:t._=o,o.U=r,n.U=o,n.R=o.L,n.R&&(n.R.U=n),o.L=n}function Pn(t,e){var n=e,o=e.L,r=n.U;r?r.L===n?r.L=o:r.R=o:t._=o,o.U=r,n.U=o,n.L=o.R,n.L&&(n.L.U=n),o.R=n}function In(t){for(;t.L;)t=t.L;return t}Tn.prototype={constructor:Tn,insert:function(t,e){var n,o,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=In(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(o=n.U).L?(r=o.R)&&r.C?(n.C=r.C=!1,o.C=!0,t=o):(t===n.R&&(On(this,n),n=(t=n).U),n.C=!1,o.C=!0,Pn(this,o)):(r=o.L)&&r.C?(n.C=r.C=!1,o.C=!0,t=o):(t===n.L&&(Pn(this,n),n=(t=n).U),n.C=!1,o.C=!0,On(this,o)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,o,r=t.U,i=t.L,s=t.R;if(n=i?s?In(s):i:s,r?r.L===t?r.L=n:r.R=n:this._=n,i&&s?(o=n.C,n.C=t.C,n.L=i,i.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(o=t.C,t=n),t&&(t.U=r),!o)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,On(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Pn(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,On(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Pn(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,On(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Pn(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};const An=Tn;function Dn(t,e,n,o){var r=[null,null],i=no.push(r)-1;return r.left=t,r.right=e,n&&Ln(r,t,e,n),o&&Ln(r,e,t,o),to[t.index].halfedges.push(i),to[e.index].halfedges.push(i),r}function Mn(t,e,n){var o=[e,n];return o.left=t,o}function Ln(t,e,n,o){t[0]||t[1]?t.left===n?t[1]=o:t[0]=o:(t[0]=o,t.left=e,t.right=n)}function Nn(t,e,n,o,r){var i,s=t[0],a=t[1],l=s[0],u=s[1],c=0,p=1,h=a[0]-l,d=a[1]-u;if(i=e-l,h||!(i>0)){if(i/=h,h<0){if(i<c)return;i<p&&(p=i)}else if(h>0){if(i>p)return;i>c&&(c=i)}if(i=o-l,h||!(i<0)){if(i/=h,h<0){if(i>p)return;i>c&&(c=i)}else if(h>0){if(i<c)return;i<p&&(p=i)}if(i=n-u,d||!(i>0)){if(i/=d,d<0){if(i<c)return;i<p&&(p=i)}else if(d>0){if(i>p)return;i>c&&(c=i)}if(i=r-u,d||!(i<0)){if(i/=d,d<0){if(i>p)return;i>c&&(c=i)}else if(d>0){if(i<c)return;i<p&&(p=i)}return!(c>0||p<1)||(c>0&&(t[0]=[l+c*h,u+c*d]),p<1&&(t[1]=[l+p*h,u+p*d]),!0)}}}}}function Fn(t,e,n,o,r){var i=t[1];if(i)return!0;var s,a,l=t[0],u=t.left,c=t.right,p=u[0],h=u[1],d=c[0],f=c[1],g=(p+d)/2,m=(h+f)/2;if(f===h){if(g<e||g>=o)return;if(p>d){if(l){if(l[1]>=r)return}else l=[g,n];i=[g,r]}else{if(l){if(l[1]<n)return}else l=[g,r];i=[g,n]}}else if(a=m-(s=(p-d)/(f-h))*g,s<-1||s>1)if(p>d){if(l){if(l[1]>=r)return}else l=[(n-a)/s,n];i=[(r-a)/s,r]}else{if(l){if(l[1]<n)return}else l=[(r-a)/s,r];i=[(n-a)/s,n]}else if(h<f){if(l){if(l[0]>=o)return}else l=[e,s*e+a];i=[o,s*o+a]}else{if(l){if(l[0]<e)return}else l=[o,s*o+a];i=[e,s*e+a]}return t[0]=l,t[1]=i,!0}function kn(t,e){var n=t.site,o=e.left,r=e.right;return n===r&&(r=o,o=n),r?Math.atan2(r[1]-o[1],r[0]-o[0]):(n===o?(o=e[1],r=e[0]):(o=e[0],r=e[1]),Math.atan2(o[0]-r[0],r[1]-o[1]))}function Gn(t,e){return e[+(e.left!==t.site)]}function Bn(t,e){return e[+(e.left===t.site)]}var Vn,zn=[];function jn(){Rn(this),this.x=this.y=this.arc=this.site=this.cy=null}function Hn(t){var e=t.P,n=t.N;if(e&&n){var o=e.site,r=t.site,i=n.site;if(o!==i){var s=r[0],a=r[1],l=o[0]-s,u=o[1]-a,c=i[0]-s,p=i[1]-a,h=2*(l*p-u*c);if(!(h>=-ro)){var d=l*l+u*u,f=c*c+p*p,g=(p*d-u*f)/h,m=(l*f-c*d)/h,y=zn.pop()||new jn;y.arc=t,y.site=r,y.x=g+s,y.y=(y.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=y;for(var v=null,_=eo._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}eo.insert(v,y),v||(Vn=y)}}}}function Un(t){var e=t.circle;e&&(e.P||(Vn=e.N),eo.remove(e),zn.push(e),Rn(e),t.circle=null)}var Wn=[];function qn(){Rn(this),this.edge=this.site=this.circle=null}function Xn(t){var e=Wn.pop()||new qn;return e.site=t,e}function Yn(t){Un(t),$n.remove(t),Wn.push(t),Rn(t)}function Kn(t){var e=t.circle,n=e.x,o=e.cy,r=[n,o],i=t.P,s=t.N,a=[t];Yn(t);for(var l=i;l.circle&&Math.abs(n-l.circle.x)<oo&&Math.abs(o-l.circle.cy)<oo;)i=l.P,a.unshift(l),Yn(l),l=i;a.unshift(l),Un(l);for(var u=s;u.circle&&Math.abs(n-u.circle.x)<oo&&Math.abs(o-u.circle.cy)<oo;)s=u.N,a.push(u),Yn(u),u=s;a.push(u),Un(u);var c,p=a.length;for(c=1;c<p;++c)u=a[c],l=a[c-1],Ln(u.edge,l.site,u.site,r);l=a[0],(u=a[p-1]).edge=Dn(l.site,u.site,null,r),Hn(l),Hn(u)}function Zn(t){for(var e,n,o,r,i=t[0],s=t[1],a=$n._;a;)if((o=Jn(a,s)-i)>oo)a=a.L;else{if(!((r=i-Qn(a,s))>oo)){o>-oo?(e=a.P,n=a):r>-oo?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){to[t.index]={site:t,halfedges:[]}}(t);var l=Xn(t);if($n.insert(e,l),e||n){if(e===n)return Un(e),n=Xn(e.site),$n.insert(l,n),l.edge=n.edge=Dn(e.site,l.site),Hn(e),void Hn(n);if(n){Un(e),Un(n);var u=e.site,c=u[0],p=u[1],h=t[0]-c,d=t[1]-p,f=n.site,g=f[0]-c,m=f[1]-p,y=2*(h*m-d*g),v=h*h+d*d,_=g*g+m*m,C=[(m*v-d*_)/y+c,(h*_-g*v)/y+p];Ln(n.edge,u,f,C),l.edge=Dn(u,t,null,C),n.edge=Dn(t,f,null,C),Hn(e),Hn(n)}else l.edge=Dn(e.site,l.site)}}function Jn(t,e){var n=t.site,o=n[0],r=n[1],i=r-e;if(!i)return o;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],u=l-e;if(!u)return a;var c=a-o,p=1/i-1/u,h=c/u;return p?(-h+Math.sqrt(h*h-2*p*(c*c/(-2*u)-l+u/2+r-i/2)))/p+o:(o+a)/2}function Qn(t,e){var n=t.N;if(n)return Jn(n,e);var o=t.site;return o[1]===e?o[0]:1/0}var $n,to,eo,no,oo=1e-6,ro=1e-12;function io(t,e){return e[1]-t[1]||e[0]-t[0]}function so(t,e){var n,o,r,i=t.sort(io).pop();for(no=[],to=new Array(t.length),$n=new An,eo=new An;;)if(r=Vn,i&&(!r||i[1]<r.y||i[1]===r.y&&i[0]<r.x))i[0]===n&&i[1]===o||(Zn(i),n=i[0],o=i[1]),i=t.pop();else{if(!r)break;Kn(r.arc)}if(function(){for(var t,e,n,o,r=0,i=to.length;r<i;++r)if((t=to[r])&&(o=(e=t.halfedges).length)){var s=new Array(o),a=new Array(o);for(n=0;n<o;++n)s[n]=n,a[n]=kn(t,no[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<o;++n)a[n]=e[s[n]];for(n=0;n<o;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,o){for(var r,i=no.length;i--;)Fn(r=no[i],t,e,n,o)&&Nn(r,t,e,n,o)&&(Math.abs(r[0][0]-r[1][0])>oo||Math.abs(r[0][1]-r[1][1])>oo)||delete no[i]}(s,a,l,u),function(t,e,n,o){var r,i,s,a,l,u,c,p,h,d,f,g,m=to.length,y=!0;for(r=0;r<m;++r)if(i=to[r]){for(s=i.site,a=(l=i.halfedges).length;a--;)no[l[a]]||l.splice(a,1);for(a=0,u=l.length;a<u;)f=(d=Bn(i,no[l[a]]))[0],g=d[1],p=(c=Gn(i,no[l[++a%u]]))[0],h=c[1],(Math.abs(f-p)>oo||Math.abs(g-h)>oo)&&(l.splice(a,0,no.push(Mn(s,d,Math.abs(f-t)<oo&&o-g>oo?[t,Math.abs(p-t)<oo?h:o]:Math.abs(g-o)<oo&&n-f>oo?[Math.abs(h-o)<oo?p:n,o]:Math.abs(f-n)<oo&&g-e>oo?[n,Math.abs(p-n)<oo?h:e]:Math.abs(g-e)<oo&&f-t>oo?[Math.abs(h-e)<oo?p:t,e]:null))-1),++u);u&&(y=!1)}if(y){var v,_,C,w=1/0;for(r=0,y=null;r<m;++r)(i=to[r])&&(C=(v=(s=i.site)[0]-t)*v+(_=s[1]-e)*_)<w&&(w=C,y=i);if(y){var b=[t,e],x=[t,o],E=[n,o],S=[n,e];y.halfedges.push(no.push(Mn(s=y.site,b,x))-1,no.push(Mn(s,x,E))-1,no.push(Mn(s,E,S))-1,no.push(Mn(s,S,b))-1)}}for(r=0;r<m;++r)(i=to[r])&&(i.halfedges.length||delete to[r])}(s,a,l,u)}this.edges=no,this.cells=to,$n=eo=no=to=null}so.prototype={constructor:so,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Gn(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,o){if(i=(r=n.halfedges).length)for(var r,i,s,a,l,u,c=n.site,p=-1,h=e[r[i-1]],d=h.left===c?h.right:h.left;++p<i;)s=d,d=(h=e[r[p]]).left===c?h.right:h.left,s&&d&&o<s.index&&o<d.index&&(l=s,u=d,((a=c)[0]-u[0])*(l[1]-a[1])-(a[0]-l[0])*(u[1]-a[1])<0)&&t.push([c.data,s.data,d.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var o,r,i=this,s=i._found||0,a=i.cells.length;!(r=i.cells[s]);)if(++s>=a)return null;var l=t-r.site[0],u=e-r.site[1],c=l*l+u*u;do{r=i.cells[o=s],s=null,r.halfedges.forEach((function(n){var o=i.edges[n],a=o.left;if(a!==r.site&&a||(a=o.right)){var l=t-a[0],u=e-a[1],p=l*l+u*u;p<c&&(c=p,s=a.index)}}))}while(null!==s);return i._found=o,null==n||c<=n*n?r.site:null}};n(9056);n(4035);function ao(){return new lo}function lo(){this.reset()}lo.prototype={constructor:lo,reset:function(){this.s=this.t=0},add:function(t){co(uo,t,this.t),co(this,uo.s,this.s),this.s?this.t+=uo.t:this.s=uo.t},valueOf:function(){return this.s}};var uo=new lo;function co(t,e,n){var o=t.s=e+n,r=o-e,i=o-r;t.t=e-i+(n-r)}var po=1e-6,ho=Math.PI,fo=ho/2,go=ho/4,mo=2*ho,yo=ho/180,vo=Math.abs,_o=Math.atan,Co=Math.atan2,wo=Math.cos,bo=(Math.ceil,Math.exp),xo=(Math.floor,Math.log),Eo=(Math.pow,Math.sin),So=(Math.sign,Math.sqrt),To=Math.tan;function Ro(t){return t>1?fo:t<-1?-fo:Math.asin(t)}function Oo(){}ao(),ao();function Po(t){var e=t[0],n=t[1],o=wo(n);return[o*wo(e),o*Eo(e),Eo(n)]}function Io(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ao(t){var e=So(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}ao();function Do(t,e){return[t>ho?t-mo:t<-ho?t+mo:t,e]}function Mo(t,e,n,o){this.x=t,this.z=e,this.o=n,this.e=o,this.v=!1,this.n=this.p=null}function Lo(t,e,n,o,r){var i,s,a=[],l=[];if(t.forEach((function(t){if(!(t.length-1<=0)){var e,n,o=t[0],s=t[e];if(s,vo(o[0]-c[0])<po&&vo(u[1]-c[1])<po){for(r.lineStart(),0;i<e;++i)r.point(t[i][0],o[1]);r.lineEnd()}else{var u,c;a.push(new Mo(o,t,null,!0)),l.push(n.o=new Mo(o,null,n,!1)),a.push(new Mo(s,t,null,!1)),l.push(n.o=new Mo(s,null,n,!0))}}})),a.length){for(l.sort(e),No(a),No(l),0,l.length;i<s;++i)l[i].e=!n;for(var u,c,p=a[0];;){for(var h=p,d=!0;h.v;)if(h.n===p)return;h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(0,u.length;i<s;++i)r.point(u[i][0],c[1]);else o(h.x,h.n.x,1,r);h.n}else{if(d)for(h.p.z,u.length-1;i>=0;--i)r.point(u[i][0],c[1]);else o(h.x,h.p.x,-1,r);h.p}h.o.z,!d}while(!h.v);r.lineEnd()}}}function No(t){if(t.length){for(var e,n,o=0,r=t[0];++o<e;)r.n=t[o],n.p=r,n;r.n=t[0],n.p=r}}function Fo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Do.invert=Do;var ko=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Fo(e(t),n)}),{left:function(e,n,o,r){for(null==o&&(o=0),null==r&&(r=e.length);o<r;){var i=o+r>>>1;t(e[i],n)<0?o=i+1:r=i}return o},right:function(e,n,o,r){for(null==o&&(o=0),null==r&&(r=e.length);o<r;){var i=o+r>>>1;t(e[i],n)>0?r=i:o=i+1}return o}}}(Fo);ko.right,ko.left;var Go=Array.prototype;Go.slice,Go.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var Bo=ao();function Vo(t,e){var n=e[0],o=e[1],r=[Eo(n),-wo(n),0],i=0,s=0;Bo.reset();for(var a=0,l=t.length;a<l;++a)if(t[a].length)for(var u,c,p=u[c-1],h=p[0],d=p[1]/2+go,f=Eo(d),g=wo(d),m=0;m<c;v,C,w,y){var y=u[m],v=y[0],_=y[1]/2+go,C=Eo(_),w=wo(_),b=v-h,x=b>=0?1:-1,E=x*b,S=E>ho,T=f*C;if(Bo.add(Co(T*x*Eo(E),g*w+T*wo(E))),S?b+x*mo:b,S^h>=n^v>=n){var R=Io(Po(p),Po(y));Ao(R);var O=Io(r,R);Ao(O);var P=(S^b>=0?-1:1)*Ro(O[2]);(o>P||o===P&&(R[0]||R[1]))&&(S^b>=0?1:-1)}}return(i<-po||i<po&&Bo<-po)^1&s}ao();ao(),ao();ao();function zo(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function jo(t){return t.length>1}function Ho(t,e){return(t.x[0]<0?t[1]-fo-po:fo-t[1])-(e.x[0]<0?e[1]-fo-po:fo-e[1])}zo(4.5);function Uo(t){return function(e){var n=new Wo;for(var o in t)n[o]=t[o];return n.stream=e,n}}function Wo(){}Wo.prototype={constructor:Wo,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};wo(30*yo);Uo({point:function(t,e){this.stream.point(t*yo,e*yo)}});function qo(t){return function(e,n){var o=wo(e),r=wo(n),i=t(o*r);return[i*r*Eo(e),i*Eo(n)]}}function Xo(t){return function(e,n){var o=So(e*e+n*n),r=t(o),i=Eo(r),s=wo(r);return[Co(e*i,o*s),Ro(o&&n*i/o)]}}var Yo=qo((function(t){return So(2/(1+t))}));Yo.invert=Xo((function(t){return 2*Ro(t/2)}));var Ko=qo((function(t){return(t=(e=t)>1?0:e<-1?ho:Math.acos(e))&&t/Eo(t);var e}));function Zo(t,e){return[t,xo(To((fo+e)/2))]}function Jo(t,e){return[t,e]}function Qo(t,e){var n=wo(e),o=wo(t)*n;return[n*Eo(t)/o,Eo(e)/o]}function $o(t,e){var n=e*e,o=n*n;return[t*(.8707-.131979*n+o*(o*(.003971*n-.001529*o)-.013791)),e*(1.007226+n*(.015085+o*(.028874*n-.044475-.005916*o)))]}function tr(t,e){return[wo(e)*Eo(t),Eo(e)]}function er(t,e){var n=wo(e),o=1+wo(t)*n;return[n*Eo(t)/o,Eo(e)/o]}function nr(t,e){return[xo(To((fo+e)/2)),-t]}Ko.invert=Xo((function(t){return t})),Zo.invert=function(t,e){return[t,2*_o(bo(e))-fo]},Jo.invert=Jo,Qo.invert=Xo(_o),$o.invert=function(t,e){var n,o=e,r=25;do{var i=o*o,s=i*i;o-=n=(o*(1.007226+i*(.015085+s*(.028874*i-.044475-.005916*s)))-e)/(1.007226+i*(.045255+s*(.259866*i-.311325-.005916*11*s)))}while(vo(n)>po&&--r>0);return[t/(.8707+(i=o*o)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),o]},tr.invert=Xo(Ro),er.invert=Xo((function(t){return 2*_o(t)})),nr.invert=function(t,e){return[-e,2*_o(bo(t))-fo]};const or=e=>{let{handleFilteredDataChange:n,countryData:o,level1Data:r,level2Data:i}=e;const[s,a]=(0,t.useState)([]),[l,u]=(0,t.useState)([]),[c,p]=(0,t.useState)([]),[h,d]=(0,t.useState)([]),[f,g]=(0,t.useState)([]),[m,y]=(0,t.useState)([]),[v,_]=(0,t.useState)([]),[C,w]=(0,t.useState)([]),[b,x]=(0,t.useState)([]);return(0,t.useEffect)((()=>{zt.get("./data/output_country.geojson").then((t=>{_(t.data.features);const e=t.data.features.map((t=>t.properties.Country));d(e)})).catch((t=>{console.error("Error loading output_country.geojson:",t)})),zt.get("./data/output_level1.geojson").then((t=>{w(t.data.features);const e=t.data.features.map((t=>t.properties.Name_1));g(e)})).catch((t=>{console.error("Error loading output_level1.geojson:",t)})),zt.get("./data/output_level2.geojson").then((t=>{x(t.data.features);const e=t.data.features.map((t=>t.properties.Name_2));y(e)})).catch((t=>{console.error("Error loading output_level2.geojson:",t)}))}),[]),(0,t.useEffect)((()=>{const t=C.filter((t=>s.includes(t.properties.Country))).map((t=>t.properties.Name_1));g(t)}),[s,C]),(0,t.useEffect)((()=>{const t=b.filter((t=>s.includes(t.properties.Country)&&l.includes(t.properties.Name_1))).map((t=>t.properties.Name_2));y(t)}),[s,l,b]),(0,t.useEffect)((()=>{console.log("Filtering data...");const t=[],e=[],o=[];s.length>0||l.length>0||c.length>0?(console.log("Applying filters..."),t.push(...v.filter((t=>0===l.length&&0===c.length&&0===s.length||s.includes(t.properties.Country))).map((t=>({type:"Feature",properties:t.properties,geometry:t.geometry})))),e.push(...C.filter((t=>(console.log("Filtering level 1 data..."),(0===l.length||l.includes(t.properties.Name_1))&&(0===s.length||s.includes(t.properties.Country))))).map((t=>({type:"Feature",properties:t.properties,geometry:t.geometry})))),o.push(...b.filter((t=>(console.log("Filtering level 2 data..."),(0===l.length||l.includes(t.properties.Name_1))&&(0===c.length||c.includes(t.properties.Name_2))&&(0===s.length||s.includes(t.properties.Country))))).map((t=>({type:"Feature",properties:t.properties,geometry:t.geometry}))))):(t.push(...v.map((t=>({type:"Feature",properties:t.properties,geometry:t.geometry})))),e.push(...C.map((t=>({type:"Feature",properties:t.properties,geometry:t.geometry})))),o.push(...b.map((t=>({type:"Feature",properties:t.properties,geometry:t.geometry})))));const r={filteredCountryData:{type:"FeatureCollection",features:t},filteredLevel1Data:{type:"FeatureCollection",features:e},filteredLevel2Data:{type:"FeatureCollection",features:o}};console.log("Filtered Country data:",r.filteredCountryData),console.log("Filtered Lv1 data:",r.filteredLevel1Data),console.log("Filtered Lv2 data:",r.filteredLevel2Data),n(r)}),[s,l,c,v,C,b]),(0,Ut.jsxs)("div",{children:[(0,Ut.jsx)("h1",{}),(0,Ut.jsx)("div",{className:"filter-section",children:(0,Ut.jsx)(re,{title:"Country",options:h,selectedOptions:s,setSelectedOptions:a})}),(0,Ut.jsx)("div",{className:"filter-section",children:(0,Ut.jsx)(re,{title:"Level 1 Name",options:f,selectedOptions:l,setSelectedOptions:u})}),(0,Ut.jsx)("div",{className:"filter-section",children:(0,Ut.jsx)(re,{title:"Level 2 Name",options:m,selectedOptions:c,setSelectedOptions:p})})]})};function rr(){const[e,n]=(0,t.useState)(null),[o,r]=(0,t.useState)(null),[i,s]=(0,t.useState)(null),[a,l]=(0,t.useState)(null),[u,c]=(0,t.useState)(2023),[p,h]=(0,t.useState)(3),[d,f]=(0,t.useState)(null),[g,m]=(0,t.useState)({filteredCountryData:[],filteredLevel1Data:[],filteredLevel2Data:[]}),y=t=>{c(t)},v=t=>{h(t)};return(0,t.useEffect)((()=>{!async function(){try{const t=await zt.get("./data/output_country.geojson");n(t.data);const e=await zt.get("./data/output_level1.geojson");r(e.data);const o=await zt.get("./data/output_level2.geojson");s(o.data);const i=await zt.get("./data/output_protocol.geojson");l(i.data)}catch(t){console.error("Error fetching data:",t)}}()}),[]),(0,Ut.jsxs)("div",{children:[(0,Ut.jsxs)("div",{className:"container",children:[(0,Ut.jsx)(Kt,{protocoleData:a,countryData:e,regionInfo:d,onChangeYear:y,onChangeRegion:t=>{f(t)},selectedYear:u,onChangeMonth:v,selectedMonth:p}),(0,Ut.jsxs)("div",{children:[(0,Ut.jsx)(Zt,{onChangeYear:y,selectedYear:u,onChangeMonth:v,selectedMonth:p}),(0,Ut.jsx)(Yt,{countryData:e,level1Data:o,level2Data:i,regionInfo:d,onChangeYear:y,selectedYear:u,onChangeMonth:v,selectedMonth:p})]})]}),(0,Ut.jsxs)("div",{className:"container",children:[(0,Ut.jsx)(or,{handleFilteredDataChange:t=>{m(t)}}),(0,Ut.jsx)(oe,{countryData:g.filteredCountryData,level1Data:g.filteredLevel1Data,level2Data:g.filteredLevel2Data,onChangeYear:y,selectedYear:u,onChangeMonth:v,selectedMonth:p})]}),(0,Ut.jsx)("div",{})]})}e.render((0,Ut.jsx)(t.StrictMode,{children:(0,Ut.jsx)(rr,{})}),document.getElementById("root"))})()})();
//# sourceMappingURL=main.e2c50be1.js.map