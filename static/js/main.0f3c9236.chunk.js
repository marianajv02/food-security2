(this["webpackJsonpmapbox-react2"]=this["webpackJsonpmapbox-react2"]||[]).push([[0],{32:function(e,t,a){e.exports=a(90)},37:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(7),r=a.n(c),o=(a(13),a(37),a(5)),s=a.n(o),i=a(9),u=a.n(i);a(55);var p=function(){const e=["#53ca57","#ffe252","#fa890f","#eb3333","#900101e3","#ffffff"];return l.a.createElement("nav",{className:"legend"},l.a.createElement("div",{className:"legend-container"},["Phase 1","Phase 2","Phase 3","Phase 4","Phase 5","No data"].map((t,a)=>l.a.createElement("div",{key:a,className:"legend-item"},l.a.createElement("span",{className:"legend-key",style:{backgroundColor:e[a]}}),l.a.createElement("span",{className:"legend-value"},t)))))};a(56),a(57);function m(e){return e?e.toLocaleString("en-US",{maximumFractionDigits:0}):""}function d(e,t){return(t?(e||0)/t*100:0).toFixed(2)}var h=function(e){let{countryData:t,level1Data:a,level2Data:c,regionInfo:r,selectedYear:o,selectedMonth:s}=e;const[i,u]=Object(n.useState)([]);if(Object(n.useEffect)(()=>{if(t&&a&&c){const e=[...t.features,...a.features,...c.features];u(e)}},[r]),!r)return null;const p=r.key;let h=null;i&&(h=i.find(e=>e.properties.Key===p));const f=h?h.properties:{},g=f.Name_2,E=m(f["POP-".concat(o,"-0").concat(s)]),v=m(f["PH1-".concat(o,"-0").concat(s)]),b=d(parseFloat(f["PH1-".concat(o,"-0").concat(s)]),parseFloat(f["POP-".concat(o,"-0").concat(s)])),P=m(f["PH2-".concat(o,"-0").concat(s)]),y=d(parseFloat(f["PH2-".concat(o,"-0").concat(s)]),parseFloat(f["POP-".concat(o,"-0").concat(s)])),C=m(f["PH3-".concat(o,"-0").concat(s)]),O=d(parseFloat(f["PH3-".concat(o,"-0").concat(s)]),parseFloat(f["POP-".concat(o,"-0").concat(s)])),j=m(f["PH4-".concat(o,"-0").concat(s)]),N=d(parseFloat(f["PH4-".concat(o,"-0").concat(s)]),parseFloat(f["POP-".concat(o,"-0").concat(s)])),F=m(f["PH5-".concat(o,"-0").concat(s)]),S=d(parseFloat(f["PH5-".concat(o,"-0").concat(s)]),parseFloat(f["POP-".concat(o,"-0").concat(s)]));return l.a.createElement("nav",{className:"sidebar"},l.a.createElement("div",{className:"sidebar-container"},l.a.createElement("div",{className:"logo"},l.a.createElement("img",{src:"/images/family_icon.jpg",alt:"Family Icon"}),l.a.createElement("span",{className:"logo-text"},"Food and nutrition situation ",o," ")," "),l.a.createElement("div",{className:"region-info"},l.a.createElement("h2",null,l.a.createElement("div",null,l.a.createElement("p",null,g))),l.a.createElement("div",{className:"info-row"},l.a.createElement("h4",null,"Total population:"),l.a.createElement("p",null,E)),l.a.createElement("div",{className:"info-row"},l.a.createElement("h4",null,"Phase 1:"),l.a.createElement("p",null,v),l.a.createElement("p",null,b,"%")),l.a.createElement("div",{className:"info-row"},l.a.createElement("h4",null,"Phase 2:"),l.a.createElement("p",null,P),l.a.createElement("p",null,y,"%")),l.a.createElement("div",{className:"info-row"},l.a.createElement("h4",null,"Phase 3:"),l.a.createElement("p",null,C),l.a.createElement("p",null,O,"%")),l.a.createElement("div",{className:"info-row"},l.a.createElement("h4",null,"Phase 4:"),l.a.createElement("p",null,j),l.a.createElement("p",null,N,"%")),l.a.createElement("div",{className:"info-row"},l.a.createElement("h4",null,"Phase 5:"),l.a.createElement("p",null,F),l.a.createElement("p",null,S,"%")))))};u.a.accessToken="pk.eyJ1IjoibWFyaWFuYWp2LSIsImEiOiJjbGs3eXJmbzEwYXR3M2RxbnRuOHVkaHV3In0.rVa0wb_O5OTeuk07J90w5A";var f=function(e){let{selectedYear:t,selectedMonth:a,onChangeRegion:c}=e;const r=Object(n.useRef)(null),o=Object(n.useRef)(null),[s,i]=Object(n.useState)(0),[m,d]=Object(n.useState)(17),[h,f]=Object(n.useState)(3.4),[g,E]=Object(n.useState)(null),v=()=>{i(o.current.getCenter().lng.toFixed(4)),d(o.current.getCenter().lat.toFixed(4)),f(o.current.getZoom().toFixed(2))},b=["output_country-2uwmmy","output_level1-5iewsu","output_level2-8nur76"],P=e=>{console.log("clickhandler ran",e.features);const t=e.features[0],a=e.lngLat,n={name:t.properties.Name_2,key:t.properties.Key};let l=null;l&&l.remove(),l=new u.a.Popup({maxWidth:"100px",maxHeight:"50px",className:"custom-popup"}).setLngLat(a).setHTML("<h5>".concat(t.properties.Name_2,"</h5>")).addTo(o.current),c(n)};return Object(n.useEffect)(()=>{let e=!0;return o.current?b.forEach(e=>{o.current.getLayer(e)&&o.current.setPaintProperty(e,"fill-color",function(e,t){const a=parseInt(e),n=parseInt(t);return["case",["==",["number",["get","CLAS-".concat(a,"-0").concat(n)]],1],"#53ca57",["==",["number",["get","CLAS-".concat(a,"-0").concat(n)]],2],"#ffe252",["==",["number",["get","CLAS-".concat(a,"-0").concat(n)]],3],"#fa890f",["==",["number",["get","CLAS-".concat(a,"-0").concat(n)]],4],"#eb3333","#ffffff"]}(t,a))}):(o.current=new u.a.Map({container:r.current,style:"mapbox://styles/marianajv-/cllf4b5be012q01pb6nqq4k5x",center:[s,m],zoom:h}),o.current.on("move",v),b.forEach(e=>{o.current.on("click",e,P)})),()=>{e=!1}},[t,a]),Object(n.useEffect)(()=>{let e=!0;return o.current&&o.current.on("move",v),()=>{e=!1}},[m,s,h]),l.a.createElement("div",{className:"view-container"},l.a.createElement("div",{ref:r,className:"map-container"}),l.a.createElement(p,null))};a(58),a(60),a(61);var g=e=>{let{onChangeYear:t,onChangeMonth:a}=e;const[c,r]=Object(n.useState)(2023),[o,s]=Object(n.useState)(null),i=e=>{const t={March:3,June:6,November:11}[e];void 0!==t&&(s(t),a&&a(t))};return l.a.createElement("div",{className:"timebar"},l.a.createElement("div",{className:"year-bar"},l.a.createElement("input",{type:"range",min:"0",max:"1",step:"0.01",value:(c-2014)/9,onChange:e=>{const a=parseFloat(e.target.value),n=Math.round(2014+9*a);r(n),t&&t(n)},className:"slider"}),l.a.createElement("div",{className:"year-indicator"},c)),l.a.createElement("div",{className:"month-buttons"},l.a.createElement("button",{className:3===o?"selected":"",onClick:()=>i("March")},"March"),l.a.createElement("button",{className:6===o?"selected":"",onClick:()=>i("June")},"June"),l.a.createElement("button",{className:11===o?"selected":"",onClick:()=>i("November")},"November")))};var E=a(8);a(30),a(31),a(86);function v(e){return null===e?"0":e.toLocaleString("en-US",{maximumFractionDigits:0})}function b(e,t){return(e/t*100).toFixed(2)}function P(e,t){return t.reduce((t,a)=>t+parseFloat(a[e].replace(/,/g,""))||0,0)}var y=e=>{let{countryData:t,selectedYear:a,selectedMonth:c}=e;const[r,o]=Object(n.useState)([{field:"Country",rowgroup:!0,hide:!1,headerClass:"custom-header",width:100},{field:"L1",headerClass:"custom-header",width:100},{field:"L2",headerClass:"custom-header",width:100},{field:"Population",headerClass:"custom-header",width:120},{field:"Phase 1",headerClass:"custom-header1",width:90},{field:"Phase 2",headerClass:"custom-header2",width:90},{field:"Phase 3",headerClass:"custom-header3",width:90},{field:"Phase 4",headerClass:"custom-header4",width:90},{field:"Phase 5",headerClass:"custom-header5",width:90},{field:"Phase 3-5",headerClass:"custom-header5",width:100},{field:"%",headerClass:"custom-header5",width:60}]);if(!t)return null;const s=t.features.map(e=>{const t=e.properties["POP-".concat(a,"-0").concat(c)];return void 0===t?{Country:e.properties.Country,L1:"",L2:"",Population:"Data not available","Phase 1":"Data not available","Phase 2":"Data not available","Phase 3":"Data not available","Phase 4":"Data not available","Phase 5":"Data not available","Phase 3-5":"Data not available","%":"Data not available"}:{Country:e.properties.Country,L1:e.properties[""],L2:e.properties[""],Population:v(t),"Phase 1":v(e.properties["PH1-".concat(a,"-0").concat(c)]),"Phase 2":v(e.properties["PH2-".concat(a,"-0").concat(c)]),"Phase 3":v(e.properties["PH3-".concat(a,"-0").concat(c)]),"Phase 4":v(e.properties["PH4-".concat(a,"-0").concat(c)]),"Phase 5":v(e.properties["PH5-".concat(a,"-0").concat(c)]),"Phase 3-5":v(e.properties["PH3:5-".concat(a,"-0").concat(c)]),"%":b(e.properties["PH3:5-".concat(a,"-0").concat(c)],t)}}),i={Country:"Total",L1:"",L2:"",Population:v(P("Population",s)),"Phase 1":v(P("Phase 1",s)),"Phase 2":v(P("Phase 2",s)),"Phase 3":v(P("Phase 3",s)),"Phase 4":v(P("Phase 4",s)),"Phase 5":v(P("Phase 5",s)),"Phase 3-5":v(P("Phase 3-5",s)),"%":b(P("Phase 3-5",s),P("Population",s)),rowClass:"total-row"},u=[...s,i];return l.a.createElement("div",{className:"ag-theme-alpine"},l.a.createElement(E.AgGridReact,{rowData:u,groupDisplayType:"groupRows",columnDefs:r}))};a(87);var C=e=>{let{title:t,options:a,selectedOptions:c,setSelectedOptions:r}=e;const[o,s]=Object(n.useState)(!1),[i,u]=Object(n.useState)(""),p=Object(n.useRef)(null),m=e=>{p.current.contains(e.target)||s(!1)};Object(n.useEffect)(()=>(document.addEventListener("click",m),()=>{document.removeEventListener("click",m)}),[]);const d=a.filter(e=>null!=e).filter(e=>e.toLowerCase().includes(i.toLowerCase()));return l.a.createElement("div",{className:"filter-container"},l.a.createElement("label",null,t,":"),l.a.createElement("div",{className:"search-dropdown",ref:p},l.a.createElement("input",{type:"text",placeholder:"Search by ".concat(t),value:i,onChange:e=>{u(e.target.value)},onClick:()=>s(!0)}),o&&l.a.createElement("div",{className:"checkbox-list"},l.a.createElement("div",null,l.a.createElement("input",{type:"checkbox",id:"selectAll".concat(t),value:"selectAll".concat(t),checked:c.length===a.length,onChange:()=>{c.length===a.length?r([]):r(a)}}),l.a.createElement("label",{htmlFor:"selectAll".concat(t)},"Select All")),d.map(e=>l.a.createElement("div",{key:e},l.a.createElement("input",{type:"checkbox",id:e,value:e,checked:c.includes(e),onChange:()=>(e=>{c.includes(e)?r(c.filter(t=>t!==e)):r([...c,e])})(e)}),l.a.createElement("label",{htmlFor:e},l.a.createElement("span",null,e)))))))};a(88);var O=e=>{let{handleFilteredDataChange:t,countryData:a,level1Data:c,level2Data:r}=e;const[o,i]=Object(n.useState)([]),[u,p]=Object(n.useState)([]),[m,d]=Object(n.useState)([]),[h,f]=Object(n.useState)([]),[g,E]=Object(n.useState)([]),[v,b]=Object(n.useState)([]),[P,y]=Object(n.useState)([]),[O,j]=Object(n.useState)([]),[N,F]=Object(n.useState)([]);return Object(n.useEffect)(()=>{s.a.get("./data/output_country.geojson").then(e=>{y(e.data.features);const t=e.data.features.map(e=>e.properties.Country);f(t)}).catch(e=>{console.error("Error loading output_country.geojson:",e)}),s.a.get("./data/output_level1.geojson").then(e=>{j(e.data.features);const t=e.data.features.map(e=>e.properties.Name_1);E(t)}).catch(e=>{console.error("Error loading output_level1.geojson:",e)}),s.a.get("./data/output_level2.geojson").then(e=>{F(e.data.features);const t=e.data.features.map(e=>e.properties.Name_2);b(t)}).catch(e=>{console.error("Error loading output_level2.geojson:",e)})},[]),Object(n.useEffect)(()=>{const e=O.filter(e=>o.includes(e.properties.Country)).map(e=>e.properties.Name_1);E(e)},[o,O]),Object(n.useEffect)(()=>{const e=N.filter(e=>o.includes(e.properties.Country)&&u.includes(e.properties.Name_1)).map(e=>e.properties.Name_2);b(e)},[o,u,N]),Object(n.useEffect)(()=>{console.log("Filtering data...");const e=[],a=[],n=[];o.length>0||u.length>0||m.length>0?(console.log("Applying filters..."),e.push(...P.filter(e=>0===u.length&&0===m.length&&0===o.length||o.includes(e.properties.Country)).map(e=>({type:"Feature",properties:e.properties,geometry:e.geometry}))),a.push(...O.filter(e=>(console.log("Filtering level 1 data..."),(0===u.length||u.includes(e.properties.Name_1))&&(0===o.length||o.includes(e.properties.Country)))).map(e=>({type:"Feature",properties:e.properties,geometry:e.geometry}))),n.push(...N.filter(e=>(console.log("Filtering level 2 data..."),(0===u.length||u.includes(e.properties.Name_1))&&(0===m.length||m.includes(e.properties.Name_2))&&(0===o.length||o.includes(e.properties.Country)))).map(e=>({type:"Feature",properties:e.properties,geometry:e.geometry})))):(e.push(...P.map(e=>({type:"Feature",properties:e.properties,geometry:e.geometry}))),a.push(...O.map(e=>({type:"Feature",properties:e.properties,geometry:e.geometry}))),n.push(...N.map(e=>({type:"Feature",properties:e.properties,geometry:e.geometry}))));const l={filteredCountryData:{type:"FeatureCollection",features:e},filteredLevel1Data:{type:"FeatureCollection",features:a},filteredLevel2Data:{type:"FeatureCollection",features:n}};console.log("Filtered Country data:",l.filteredCountryData),console.log("Filtered Lv1 data:",l.filteredLevel1Data),console.log("Filtered Lv2 data:",l.filteredLevel2Data),t(l)},[o,u,m,P,O,N]),l.a.createElement("div",null,l.a.createElement("h1",null),l.a.createElement("div",{className:"filter-section"},l.a.createElement(C,{title:"Country",options:h,selectedOptions:o,setSelectedOptions:i})),l.a.createElement("div",{className:"filter-section"},l.a.createElement(C,{title:"Level 1 Name",options:g,selectedOptions:u,setSelectedOptions:p})),l.a.createElement("div",{className:"filter-section"},l.a.createElement(C,{title:"Level 2 Name",options:v,selectedOptions:m,setSelectedOptions:d})))};a(89);function j(){const[e,t]=Object(n.useState)(null),[a,c]=Object(n.useState)(null),[r,o]=Object(n.useState)(null),[i,u]=Object(n.useState)(2023),[p,m]=Object(n.useState)(3),[d,E]=Object(n.useState)(null),[v,b]=Object(n.useState)({filteredCountryData:[],filteredLevel1Data:[],filteredLevel2Data:[]}),P=e=>{u(e)},C=e=>{m(e)};return Object(n.useEffect)(()=>{!async function(){try{const e=await s.a.get("/data/output_country.geojson");t(e.data);const a=await s.a.get("/data/output_level1.geojson");c(a.data);const n=await s.a.get("/data/output_level2.geojson");o(n.data),console.log(a,n,"response levels")}catch(e){console.error("Error fetching data:",e)}}()},[]),l.a.createElement("div",null,l.a.createElement(f,{regionInfo:d,onChangeYear:P,onChangeRegion:e=>{E(e)},selectedYear:i,onChangeMonth:C,selectedMonth:p}),l.a.createElement(g,{onChangeYear:P,selectedYear:i,onChangeMonth:C,selectedMonth:p}),l.a.createElement(h,{countryData:e,level1Data:a,level2Data:r,regionInfo:d,onChangeYear:P,selectedYear:i,onChangeMonth:C,selectedMonth:p}),l.a.createElement(O,{handleFilteredDataChange:e=>{b(e)}}),l.a.createElement("div",null,l.a.createElement(y,{countryData:e,level1Data:a,level2Data:r,onChangeYear:P,selectedYear:i,onChangeMonth:C,selectedMonth:p})))}r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(j,null)),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.0f3c9236.chunk.js.map